import{G as r,a as S}from"./Game1LogicSchema-SHqVCG07.js";import{B as H}from"./BaseViewLogic-fTOOk9Vw.js";const e={HERO_X:0,HERO_Y:1,HERO_ROTATION:2,HERO_SCALE:3,HERO_HP_DISPLAY:4,HERO_FRAME:5,ACTIVE_ROCK_COUNT:6},l={STRIDE:3};class p extends H{heroRotation=0;globalRockRotation=0;heroFrame=0;update(o,k){const i=this.logicViews.get("main"),s=this.logicViews.get("rocks"),t=this.outputViews.get("main"),a=this.outputViews.get("rocks");if(!i||!s||!t||!a)return;const c=i[r.ENTITY_COUNT],R=Math.floor(a.length/l.STRIDE);c>R?this._outResizePending!==R&&(self.postMessage({type:"REQUEST_RESIZE_OUTPUT",payload:{bufferName:"rocks",newSize:(c+1e3)*l.STRIDE}}),this._outResizePending=R):this._outResizePending=0;const _=i[r.HERO_HP];this.heroRotation+=.03*(o/16.67),this.heroFrame+=.15*(o/16.67),t[e.HERO_X]=i[r.HERO_X],t[e.HERO_Y]=i[r.HERO_Y],t[e.HERO_ROTATION]=this.heroRotation,t[e.HERO_SCALE]=.5+_/100,t[e.HERO_HP_DISPLAY]=_,t[e.HERO_FRAME]=this.heroFrame;const m=Math.min(c,R);t[e.ACTIVE_ROCK_COUNT]=m,this.globalRockRotation+=.02*(o/16.67);for(let n=0;n<m;n++){const h=n*S.STRIDE,E=n*l.STRIDE;if(h+2>=s.length)break;a[E]=s[h],a[E+1]=s[h+1];const O=s[h+2],g=(Math.floor(O)%5+1)*.5;a[E+2]=this.globalRockRotation*g+O}}getSnapshot(){return{heroRotation:this.heroRotation,globalRockRotation:this.globalRockRotation,heroFrame:this.heroFrame}}loadSnapshot(o){o&&(this.heroRotation=o.heroRotation??0,this.globalRockRotation=o.globalRockRotation??0,this.heroFrame=o.heroFrame??0)}}export{p as Game1ViewLogic};
//# sourceMappingURL=Game1ViewLogic-C-yug3dU.js.map
