import{a as BasePresenter,B as BaseController,b as BaseGameState,G as GLOBAL_SESSION_MAP}from"./BasePresenter-1Bp8xzT5.js";import{j as jsxRuntimeExports,r as reactExports,m as SCALE_MODES,s as settings,R as React,n as Game3Level,F as FeatureEnum,I as InputManager,S as StateRegistry,a as StateManager,C as CampaignManager,o as getGame3Config,f as SharedSession}from"./index-_DKrE1GQ.js";import{m as moduleExports,G as GameSprite}from"./GameSprite-BZwYSXzk.js";import{S as SaveManager}from"./SaveManager-Ch1OEj4Z.js";const Game3MainSchema={REVISION:1,FRAME_COUNT:2,FPS:3,HERO_X:10,HERO_Y:11,HERO_VX:12,HERO_VY:13,HERO_HP:14,HERO_WIDTH:15,HERO_HEIGHT:16,WORLD_SCALE:20,PLAYER_SCALE:21,PLAYER_OFFSET_Y:22,IS_ON_GROUND:30,IS_WALL_SLIDING:31,WALL_JUMP_TIMER:32,WALL_JUMP_DIRECTION:33,SPIKE_DAMAGE_TIMER:34,WAS_IN_SPIKE:35,PORTAL_COOLDOWN:36,IS_JUMPING_FROM_GROUND:37,HAS_COMPLETED_LEVEL:38,SPAWN_X:39,SPAWN_Y:40,MOVE_SPEED:50,JUMP_POWER:51,GRAVITY:52,FRICTION:53,OBJ_COUNT:60,BUFFER_SIZE:256},Game3PlatformsSchema={START_INDEX:0,STRIDE:5,BUFFER_SIZE:5e3},Game3LogicSchema={main:Game3MainSchema,platforms:Game3PlatformsSchema},Game3ViewMainSchema={HERO_X:0,HERO_Y:1,HERO_HP:2,HERO_ANIM_FRAME:5,HERO_FLIP:6,HERO_WIDTH:7,HERO_HEIGHT:8,HERO_ANIM_STATE:9,WORLD_SCALE:10,PLAYER_SCALE:11,PLAYER_OFFSET_Y:12,UI_BOUNCE:20,GLITCH_INTENSITY:21,VIGNETTE_PULSE:22,OBJ_COUNT:30,BUFFER_SIZE:128},Game3ViewPlatformsSchema={START_INDEX:0,STRIDE:5,BUFFER_SIZE:5e3},Game3ViewSchema={main:Game3ViewMainSchema,platforms:Game3ViewPlatformsSchema},Game3HUD=({stats:d,onAction:m,onLevel1:g,onLevel2:w,onLevel3:I,onLevel4:P,onLevel5:F,onQuickLoad:D})=>{const $={padding:"1.5cqw",border:"0.1cqw solid",borderRadius:"0.5cqw",display:"flex",flexDirection:"column",gap:"1cqh"},U={padding:"0.5cqw 1cqw",cursor:"pointer",background:"#222",color:"#eee",border:"0.1cqw solid #444",fontSize:"0.8cqw",pointerEvents:"auto"};return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none",containerType:"size",padding:"2cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"#ffcc00",fontFamily:"monospace"},children:[jsxRuntimeExports.jsx("h2",{style:{fontSize:"1.5cqw",margin:0},children:"PLATFORMER_PROTOTYPE"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqh",alignItems:"flex-end"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:g,style:{...U,background:"#1b4d1b"},children:"LVL 1"}),jsxRuntimeExports.jsx("button",{onClick:w,style:{...U,background:"#4d431b"},children:"LVL 2"}),jsxRuntimeExports.jsx("button",{onClick:I,style:{...U,background:"#4d1b1b"},children:"LVL 3"}),jsxRuntimeExports.jsx("button",{onClick:P,style:{...U,background:"#1b1b4d"},children:"LVL 4"}),jsxRuntimeExports.jsx("button",{onClick:F,style:{...U,background:"#1b1b4d"},children:"LVL 5"})]}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"0.5cqw"},children:jsxRuntimeExports.jsx("button",{onClick:D,style:{...U,borderColor:"#c0392b"},children:"RELOAD"})})]})]}),jsxRuntimeExports.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"2cqw",marginTop:"2cqh",pointerEvents:"auto"},children:jsxRuntimeExports.jsxs("div",{style:{...$,borderColor:"#ff3333",color:"#ff3333"},children:[jsxRuntimeExports.jsx("span",{children:"HERO_HP"}),jsxRuntimeExports.jsx("b",{style:{fontSize:"2cqw"},children:d.hp.toFixed(1)}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>m("MOD_HP",10),style:U,children:"+10"}),jsxRuntimeExports.jsx("button",{onClick:()=>m("MOD_HP",-10),style:U,children:"-10"})]})]})}),jsxRuntimeExports.jsx("div",{style:{position:"absolute",bottom:"2cqh",left:"2cqw",color:"#fff",fontSize:"0.8cqw",opacity:.7},children:"Controls: A/D/Arrows - Move, Space/W/Up - Jump"})]})},Game3Background=()=>jsxRuntimeExports.jsx(moduleExports.Container,{name:"background"}),Game3Foreground=({vm:d,heroSprRef:m})=>jsxRuntimeExports.jsxs(moduleExports.Container,{name:"foreground",children:[d.objects.map((g,w)=>{let I="";switch(g.type){case 0:I="Platform Floor";break;case 1:I="Platform Length";break;case 2:I="Void Pit";break;case 3:I="Spike Trap";break;case 4:I="Portal Gate";break;case 5:I="Exit Door";break;case 6:I="Platform Floor";break}return I?jsxRuntimeExports.jsx(moduleExports.Container,{x:g.x+g.width/2,y:g.y+g.height,children:jsxRuntimeExports.jsx(GameSprite,{imageName:I,anchor:[.5,1],scale:1/32})},`sprite-${w}`):null}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:m,children:jsxRuntimeExports.jsx(GameSprite,{sheetName:d.heroVisuals?.assetKey||"hero_idle",animationName:d.heroVisuals?.animationName||"idle",currentFrame:d.heroVisuals?.frame||0,anchor:[.5,1],scale:1/32})})]}),Game3Hitboxes=({vm:d,levelRef:m,heroRef:g})=>(reactExports.useEffect(()=>{const w=m.current;if(w){w.clear();for(const I of d.objects){let P=2899536;switch(I.type){case 0:P=5859233;break;case 1:P=8388736;break;case 2:P=0;break;case 3:P=901050;break;case 4:P=1835263;break;case 5:P=16711680;break;case 6:P=8014605;break;default:P=16711935}w.beginFill(P,1),w.drawRect(I.x,I.y,I.width,I.height),w.endFill()}}},[d.objects]),jsxRuntimeExports.jsxs(moduleExports.Container,{name:"hitboxes",alpha:.5,children:[jsxRuntimeExports.jsx(moduleExports.Graphics,{ref:m}),jsxRuntimeExports.jsx(moduleExports.Graphics,{ref:g})]})),PixiForceResizer=({w:d,h:m})=>{const g=moduleExports.useApp();return reactExports.useEffect(()=>{g?.renderer&&(g.renderer.resize(d,m),settings.SCALE_MODE=SCALE_MODES.NEAREST,settings.ROUND_PIXELS=!0,g.view instanceof HTMLCanvasElement&&(g.view.width=d,g.view.height=m,g.view.style.imageRendering="pixelated"))},[g,d,m]),null},Game3Simulation=({vm:d,width:m,height:g})=>{const w=reactExports.useRef(null),I=reactExports.useRef(null),P=reactExports.useRef(null),F=reactExports.useRef(null),D=g/256,$=d.worldScale*D;return moduleExports.useTick(()=>{const U=d.heroVisuals,j=w.current,Z=I.current,G=F.current;if(!j||!U||!Z)return;Z.x=U.x,Z.y=U.y;const H=Math.round(U.width*$),W=Math.round(U.height*$),Q=H/$,q=W/$;Z.clear();let rt=2600544;U.animState===1&&(rt=2719929),U.animState===2&&(rt=12597547),Z.beginFill(rt,1),Z.drawRect(0,0,Q,q),Z.endFill();const et=Math.round(U.width*.3*$)/$,X=Math.round(U.height*.2*$)/$,J=U.flipX?0:Q-et;Z.beginFill(16777215,.5),Z.drawRect(J,q*.1,et,X),Z.endFill(),G&&(G.x=U.x+U.width/2,G.y=U.y+U.height,G.scale.x=U.flipX?-1:1);const tt=(U.x+U.width/2)*$,st=(U.y+U.height/2)*$;j.x=m/2-tt,j.y=g/2-st}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(PixiForceResizer,{w:m,h:g}),jsxRuntimeExports.jsxs(moduleExports.Container,{ref:w,scale:$,children:[jsxRuntimeExports.jsx(Game3Background,{}),jsxRuntimeExports.jsx(Game3Foreground,{vm:d,heroSprRef:F}),jsxRuntimeExports.jsx(Game3Hitboxes,{vm:d,levelRef:P,heroRef:I})]})]})},Game3Minimap=({vm:d,size:m=160})=>{const g=reactExports.useRef(null);return reactExports.useEffect(()=>{const w=g.current;if(!w)return;const I=w.getContext("2d");if(!I)return;const P=d.objects,F=d.heroVisuals;if(I.clearRect(0,0,w.width,w.height),P.length===0)return;let D=1/0,$=1/0,U=-1/0,j=-1/0;for(const X of P)X.x<D&&(D=X.x),X.y<$&&($=X.y),X.x+X.width>U&&(U=X.x+X.width),X.y+X.height>j&&(j=X.y+X.height);F&&(F.x<D&&(D=F.x),F.y<$&&($=F.y),F.x+F.width>U&&(U=F.x+F.width),F.y+F.height>j&&(j=F.y+F.height));const Z=U-D,G=j-$;if(Z<=0||G<=0)return;const H=2,W=w.width-H*2,Q=w.height-H*2,q=Math.min(W/Z,Q/G),rt=H+(W-Z*q)/2,et=H+(Q-G*q)/2;I.fillStyle="rgba(0, 0, 0, 0.7)",I.fillRect(0,0,w.width,w.height);for(const X of P){I.fillStyle=getColorForType(X.type);const J=rt+(X.x-D)*q,tt=et+(X.y-$)*q,st=Math.max(X.width*q,1),nt=Math.max(X.height*q,1);I.fillRect(J,tt,st,nt)}if(F){const X=rt+(F.x-D)*q,J=et+(F.y-$)*q,tt=Math.max(F.width*q,3),st=Math.max(F.height*q,3);I.fillStyle="#ff2222",I.fillRect(X,J,tt,st),I.strokeStyle="#ffffff",I.lineWidth=1,I.strokeRect(X,J,tt,st)}}),jsxRuntimeExports.jsx("canvas",{ref:g,width:m,height:m,style:{position:"absolute",bottom:"1cqw",right:"1cqw",width:`${m}px`,height:`${m}px`,borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)",pointerEvents:"none",imageRendering:"pixelated",zIndex:10}})};function getColorForType(d){switch(d){case 0:return"#5967a1";case 1:return"#800080";case 2:return"#111111";case 3:return"#0dbfba";case 4:return"#1c00ff";case 5:return"#ff4444";case 6:return"#7a4b0d";default:return"#333333"}}const Game3View=({vm:d,controller:m,width:g=960,height:w=540})=>{const[I,P]=React.useState(0);React.useEffect(()=>{const j=d.subscribe(()=>P(Z=>Z+1));return()=>j()},[d]);const F=d.stats,D=d.visualEffects,$=reactExports.useMemo(()=>({backgroundColor:0,backgroundAlpha:0,antialias:!1,roundPixels:!0,resolution:1,autoDensity:!1}),[]),U=reactExports.useMemo(()=>({position:"absolute",inset:0,width:"100%",height:"100%",display:"block",imageRendering:"pixelated"}),[]);return jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:jsxRuntimeExports.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",background:"#050508",overflow:"hidden"},children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"radial-gradient(circle at center, #1a1a2e 0%, #050508 100%)",opacity:.6}}),jsxRuntimeExports.jsx(moduleExports.Stage,{width:g,height:w,options:$,style:U,children:jsxRuntimeExports.jsx(Game3Simulation,{vm:d,width:g,height:w})},`game3-stage-${g}-${w}`),jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,pointerEvents:"none",boxShadow:`inset 0 0 ${120+D.vignettePulse*40}px rgba(0,0,0,0.9)`,mixBlendMode:"multiply"}}),jsxRuntimeExports.jsx(Game3Minimap,{vm:d,size:250}),jsxRuntimeExports.jsx(Game3HUD,{stats:F,onAction:(j,Z)=>{j==="MOD_HP"&&m.modifyHP(Z||0)},onLevel1:()=>m.loadLevel(Game3Level.Level1),onLevel2:()=>m.loadLevel(Game3Level.Level2),onLevel3:()=>m.loadLevel(Game3Level.Level3),onLevel4:()=>m.loadLevel(Game3Level.Level4),onLevel5:()=>m.loadLevel(Game3Level.Level5),onQuickLoad:()=>m.resetLevel()})]})})};class Game3Presenter extends BasePresenter{get objects(){const m=this._sharedViews.get("main"),g=this._sharedViews.get("platforms");if(!m||!g)return[];const w=m[Game3ViewMainSchema.OBJ_COUNT],I=Game3ViewPlatformsSchema.STRIDE,P=[];for(let F=0;F<w;F++){const D=F*I;P.push({x:g[D],y:g[D+1],width:g[D+2],height:g[D+3],type:g[D+4]})}return P}get heroVisuals(){const m=Game3ViewMainSchema,g=this._sharedViews.get("main");if(!g)return null;const w=g[m.HERO_ANIM_STATE];let I="hero_idle",P="idle";switch(w){case 1:I="gol_sheet",P="walk";break;case 2:I="gol_sheet",P="jump";break;case 3:I="gol_sheet",P="slide";break;default:I="gol_sheet",P="idle";break}return{x:g[m.HERO_X]||0,y:g[m.HERO_Y]||0,frame:Math.floor(g[m.HERO_ANIM_FRAME]||0),flipX:g[m.HERO_FLIP]>.5,width:g[m.HERO_WIDTH]||1,height:g[m.HERO_HEIGHT]||1,playerScale:g[m.PLAYER_SCALE]||1,playerOffsetY:g[m.PLAYER_OFFSET_Y]||0,assetKey:I,animationName:P,animState:w}}get worldScale(){const m=this._sharedViews.get("main");return m?m[Game3ViewMainSchema.WORLD_SCALE]:32}get stats(){const m=this._sharedViews.get("main");return{hp:m?m[Game3ViewMainSchema.HERO_HP]:0}}get visualEffects(){const m=this._sharedViews.get("main"),g=Game3ViewMainSchema;return m?{uiOffset:m[g.UI_BOUNCE]||0,glitchIntensity:m[g.GLITCH_INTENSITY]||0,vignettePulse:m[g.VIGNETTE_PULSE]||0}:{uiOffset:0,glitchIntensity:0,vignettePulse:0}}get hp(){const m=this._sharedViews.get("main");return m?m[Game3ViewMainSchema.HERO_HP]:0}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function getAugmentedNamespace(d){if(d.__esModule)return d;var m=d.default;if(typeof m=="function"){var g=function w(){return this instanceof w?Reflect.construct(m,arguments,this.constructor):m.apply(this,arguments)};g.prototype=m.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(d).forEach((function(w){var I=Object.getOwnPropertyDescriptor(d,w);Object.defineProperty(g,w,I.get?I:{enumerable:!0,get:function(){return d[w]}})})),g}typeof self>"u"&&typeof commonjsGlobal=="object"&&(commonjsGlobal.self=commonjsGlobal);var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0;m<64;++m)lookup[m]=d[m],revLookup[d.charCodeAt(m)]=m;revLookup[45]=62,revLookup[95]=63}function toByteArray(d){var m,g,w,I,P,F;inited||init();var D=d.length;if(D%4>0)throw new Error("Invalid string. Length must be a multiple of 4");P=d[D-2]==="="?2:d[D-1]==="="?1:0,F=new Arr(3*D/4-P),w=P>0?D-4:D;var $=0;for(m=0,g=0;m<w;m+=4,g+=3)I=revLookup[d.charCodeAt(m)]<<18|revLookup[d.charCodeAt(m+1)]<<12|revLookup[d.charCodeAt(m+2)]<<6|revLookup[d.charCodeAt(m+3)],F[$++]=I>>16&255,F[$++]=I>>8&255,F[$++]=255&I;return P===2?(I=revLookup[d.charCodeAt(m)]<<2|revLookup[d.charCodeAt(m+1)]>>4,F[$++]=255&I):P===1&&(I=revLookup[d.charCodeAt(m)]<<10|revLookup[d.charCodeAt(m+1)]<<4|revLookup[d.charCodeAt(m+2)]>>2,F[$++]=I>>8&255,F[$++]=255&I),F}function tripletToBase64(d){return lookup[d>>18&63]+lookup[d>>12&63]+lookup[d>>6&63]+lookup[63&d]}function encodeChunk(d,m,g){for(var w,I=[],P=m;P<g;P+=3)w=(d[P]<<16)+(d[P+1]<<8)+d[P+2],I.push(tripletToBase64(w));return I.join("")}function fromByteArray(d){var m;inited||init();for(var g=d.length,w=g%3,I="",P=[],F=16383,D=0,$=g-w;D<$;D+=F)P.push(encodeChunk(d,D,D+F>$?$:D+F));return w===1?(m=d[g-1],I+=lookup[m>>2],I+=lookup[m<<4&63],I+="=="):w===2&&(m=(d[g-2]<<8)+d[g-1],I+=lookup[m>>10],I+=lookup[m>>4&63],I+=lookup[m<<2&63],I+="="),P.push(I),P.join("")}function read(d,m,g,w,I){var P,F,D=8*I-w-1,$=(1<<D)-1,U=$>>1,j=-7,Z=g?I-1:0,G=g?-1:1,H=d[m+Z];for(Z+=G,P=H&(1<<-j)-1,H>>=-j,j+=D;j>0;P=256*P+d[m+Z],Z+=G,j-=8);for(F=P&(1<<-j)-1,P>>=-j,j+=w;j>0;F=256*F+d[m+Z],Z+=G,j-=8);if(P===0)P=1-U;else{if(P===$)return F?NaN:1/0*(H?-1:1);F+=Math.pow(2,w),P-=U}return(H?-1:1)*F*Math.pow(2,P-w)}function write(d,m,g,w,I,P){var F,D,$,U=8*P-I-1,j=(1<<U)-1,Z=j>>1,G=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=w?0:P-1,W=w?1:-1,Q=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(D=isNaN(m)?1:0,F=j):(F=Math.floor(Math.log(m)/Math.LN2),m*($=Math.pow(2,-F))<1&&(F--,$*=2),(m+=F+Z>=1?G/$:G*Math.pow(2,1-Z))*$>=2&&(F++,$/=2),F+Z>=j?(D=0,F=j):F+Z>=1?(D=(m*$-1)*Math.pow(2,I),F+=Z):(D=m*Math.pow(2,Z-1)*Math.pow(2,I),F=0));I>=8;d[g+H]=255&D,H+=W,D/=256,I-=8);for(F=F<<I|D,U+=I;U>0;d[g+H]=255&F,H+=W,F/=256,U-=8);d[g+H-W]|=128*Q}var toString={}.toString,isArray=Array.isArray||function(d){return toString.call(d)=="[object Array]"},INSPECT_MAX_BYTES=50;function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(d,m){if(kMaxLength()<m)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(d=new Uint8Array(m)).__proto__=Buffer.prototype:(d===null&&(d=new Buffer(m)),d.length=m),d}function Buffer(d,m,g){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(d,m,g);if(typeof d=="number"){if(typeof m=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,d)}return from(this,d,m,g)}function from(d,m,g,w){if(typeof m=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&m instanceof ArrayBuffer?fromArrayBuffer(d,m,g,w):typeof m=="string"?fromString(d,m,g):fromObject(d,m)}function assertSize(d){if(typeof d!="number")throw new TypeError('"size" argument must be a number');if(d<0)throw new RangeError('"size" argument must not be negative')}function alloc(d,m,g,w){return assertSize(m),m<=0?createBuffer(d,m):g!==void 0?typeof w=="string"?createBuffer(d,m).fill(g,w):createBuffer(d,m).fill(g):createBuffer(d,m)}function allocUnsafe(d,m){if(assertSize(m),d=createBuffer(d,m<0?0:0|checked(m)),!Buffer.TYPED_ARRAY_SUPPORT)for(var g=0;g<m;++g)d[g]=0;return d}function fromString(d,m,g){if(typeof g=="string"&&g!==""||(g="utf8"),!Buffer.isEncoding(g))throw new TypeError('"encoding" must be a valid string encoding');var w=0|byteLength(m,g),I=(d=createBuffer(d,w)).write(m,g);return I!==w&&(d=d.slice(0,I)),d}function fromArrayLike(d,m){var g=m.length<0?0:0|checked(m.length);d=createBuffer(d,g);for(var w=0;w<g;w+=1)d[w]=255&m[w];return d}function fromArrayBuffer(d,m,g,w){if(m.byteLength,g<0||m.byteLength<g)throw new RangeError("'offset' is out of bounds");if(m.byteLength<g+(w||0))throw new RangeError("'length' is out of bounds");return m=g===void 0&&w===void 0?new Uint8Array(m):w===void 0?new Uint8Array(m,g):new Uint8Array(m,g,w),Buffer.TYPED_ARRAY_SUPPORT?(d=m).__proto__=Buffer.prototype:d=fromArrayLike(d,m),d}function fromObject(d,m){if(internalIsBuffer(m)){var g=0|checked(m.length);return(d=createBuffer(d,g)).length===0||m.copy(d,0,0,g),d}if(m){if(typeof ArrayBuffer<"u"&&m.buffer instanceof ArrayBuffer||"length"in m)return typeof m.length!="number"||isnan(m.length)?createBuffer(d,0):fromArrayLike(d,m);if(m.type==="Buffer"&&isArray(m.data))return fromArrayLike(d,m.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(d){if(d>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|d}function internalIsBuffer(d){return!(d==null||!d._isBuffer)}function byteLength(d,m){if(internalIsBuffer(d))return d.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(d)||d instanceof ArrayBuffer))return d.byteLength;typeof d!="string"&&(d=""+d);var g=d.length;if(g===0)return 0;for(var w=!1;;)switch(m){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":case void 0:return utf8ToBytes(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*g;case"hex":return g>>>1;case"base64":return base64ToBytes(d).length;default:if(w)return utf8ToBytes(d).length;m=(""+m).toLowerCase(),w=!0}}function slowToString(d,m,g){var w=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0)<=(m>>>=0))return"";for(d||(d="utf8");;)switch(d){case"hex":return hexSlice(this,m,g);case"utf8":case"utf-8":return utf8Slice(this,m,g);case"ascii":return asciiSlice(this,m,g);case"latin1":case"binary":return latin1Slice(this,m,g);case"base64":return base64Slice(this,m,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,m,g);default:if(w)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),w=!0}}function swap(d,m,g){var w=d[m];d[m]=d[g],d[g]=w}function bidirectionalIndexOf(d,m,g,w,I){if(d.length===0)return-1;if(typeof g=="string"?(w=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,isNaN(g)&&(g=I?0:d.length-1),g<0&&(g=d.length+g),g>=d.length){if(I)return-1;g=d.length-1}else if(g<0){if(!I)return-1;g=0}if(typeof m=="string"&&(m=Buffer.from(m,w)),internalIsBuffer(m))return m.length===0?-1:arrayIndexOf(d,m,g,w,I);if(typeof m=="number")return m&=255,Buffer.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?I?Uint8Array.prototype.indexOf.call(d,m,g):Uint8Array.prototype.lastIndexOf.call(d,m,g):arrayIndexOf(d,[m],g,w,I);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(d,m,g,w,I){var P,F=1,D=d.length,$=m.length;if(w!==void 0&&((w=String(w).toLowerCase())==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(d.length<2||m.length<2)return-1;F=2,D/=2,$/=2,g/=2}function U(H,W){return F===1?H[W]:H.readUInt16BE(W*F)}if(I){var j=-1;for(P=g;P<D;P++)if(U(d,P)===U(m,j===-1?0:P-j)){if(j===-1&&(j=P),P-j+1===$)return j*F}else j!==-1&&(P-=P-j),j=-1}else for(g+$>D&&(g=D-$),P=g;P>=0;P--){for(var Z=!0,G=0;G<$;G++)if(U(d,P+G)!==U(m,G)){Z=!1;break}if(Z)return P}return-1}function hexWrite(d,m,g,w){g=Number(g)||0;var I=d.length-g;w?(w=Number(w))>I&&(w=I):w=I;var P=m.length;if(P%2!=0)throw new TypeError("Invalid hex string");w>P/2&&(w=P/2);for(var F=0;F<w;++F){var D=parseInt(m.substr(2*F,2),16);if(isNaN(D))return F;d[g+F]=D}return F}function utf8Write(d,m,g,w){return blitBuffer(utf8ToBytes(m,d.length-g),d,g,w)}function asciiWrite(d,m,g,w){return blitBuffer(asciiToBytes(m),d,g,w)}function latin1Write(d,m,g,w){return asciiWrite(d,m,g,w)}function base64Write(d,m,g,w){return blitBuffer(base64ToBytes(m),d,g,w)}function ucs2Write(d,m,g,w){return blitBuffer(utf16leToBytes(m,d.length-g),d,g,w)}function base64Slice(d,m,g){return m===0&&g===d.length?fromByteArray(d):fromByteArray(d.slice(m,g))}function utf8Slice(d,m,g){g=Math.min(d.length,g);for(var w=[],I=m;I<g;){var P,F,D,$,U=d[I],j=null,Z=U>239?4:U>223?3:U>191?2:1;if(I+Z<=g)switch(Z){case 1:U<128&&(j=U);break;case 2:(192&(P=d[I+1]))==128&&($=(31&U)<<6|63&P)>127&&(j=$);break;case 3:P=d[I+1],F=d[I+2],(192&P)==128&&(192&F)==128&&($=(15&U)<<12|(63&P)<<6|63&F)>2047&&($<55296||$>57343)&&(j=$);break;case 4:P=d[I+1],F=d[I+2],D=d[I+3],(192&P)==128&&(192&F)==128&&(192&D)==128&&($=(15&U)<<18|(63&P)<<12|(63&F)<<6|63&D)>65535&&$<1114112&&(j=$)}j===null?(j=65533,Z=1):j>65535&&(j-=65536,w.push(j>>>10&1023|55296),j=56320|1023&j),w.push(j),I+=Z}return decodeCodePointsArray(w)}Buffer.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT===void 0||global$1.TYPED_ARRAY_SUPPORT,kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(d){return d.__proto__=Buffer.prototype,d},Buffer.from=function(d,m,g){return from(null,d,m,g)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&Buffer[Symbol.species]),Buffer.alloc=function(d,m,g){return alloc(null,d,m,g)},Buffer.allocUnsafe=function(d){return allocUnsafe(null,d)},Buffer.allocUnsafeSlow=function(d){return allocUnsafe(null,d)},Buffer.isBuffer=isBuffer,Buffer.compare=function(d,m){if(!internalIsBuffer(d)||!internalIsBuffer(m))throw new TypeError("Arguments must be Buffers");if(d===m)return 0;for(var g=d.length,w=m.length,I=0,P=Math.min(g,w);I<P;++I)if(d[I]!==m[I]){g=d[I],w=m[I];break}return g<w?-1:w<g?1:0},Buffer.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(d,m){if(!isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return Buffer.alloc(0);var g;if(m===void 0)for(m=0,g=0;g<d.length;++g)m+=d[g].length;var w=Buffer.allocUnsafe(m),I=0;for(g=0;g<d.length;++g){var P=d[g];if(!internalIsBuffer(P))throw new TypeError('"list" argument must be an Array of Buffers');P.copy(w,I),I+=P.length}return w},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var d=this.length;if(d%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<d;m+=2)swap(this,m,m+1);return this},Buffer.prototype.swap32=function(){var d=this.length;if(d%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<d;m+=4)swap(this,m,m+3),swap(this,m+1,m+2);return this},Buffer.prototype.swap64=function(){var d=this.length;if(d%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<d;m+=8)swap(this,m,m+7),swap(this,m+1,m+6),swap(this,m+2,m+5),swap(this,m+3,m+4);return this},Buffer.prototype.toString=function(){var d=0|this.length;return d===0?"":arguments.length===0?utf8Slice(this,0,d):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(d){if(!internalIsBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d||Buffer.compare(this,d)===0},Buffer.prototype.inspect=function(){var d="",m=INSPECT_MAX_BYTES;return this.length>0&&(d=this.toString("hex",0,m).match(/.{2}/g).join(" "),this.length>m&&(d+=" ... ")),"<Buffer "+d+">"},Buffer.prototype.compare=function(d,m,g,w,I){if(!internalIsBuffer(d))throw new TypeError("Argument must be a Buffer");if(m===void 0&&(m=0),g===void 0&&(g=d?d.length:0),w===void 0&&(w=0),I===void 0&&(I=this.length),m<0||g>d.length||w<0||I>this.length)throw new RangeError("out of range index");if(w>=I&&m>=g)return 0;if(w>=I)return-1;if(m>=g)return 1;if(this===d)return 0;for(var P=(I>>>=0)-(w>>>=0),F=(g>>>=0)-(m>>>=0),D=Math.min(P,F),$=this.slice(w,I),U=d.slice(m,g),j=0;j<D;++j)if($[j]!==U[j]){P=$[j],F=U[j];break}return P<F?-1:F<P?1:0},Buffer.prototype.includes=function(d,m,g){return this.indexOf(d,m,g)!==-1},Buffer.prototype.indexOf=function(d,m,g){return bidirectionalIndexOf(this,d,m,g,!0)},Buffer.prototype.lastIndexOf=function(d,m,g){return bidirectionalIndexOf(this,d,m,g,!1)},Buffer.prototype.write=function(d,m,g,w){if(m===void 0)w="utf8",g=this.length,m=0;else if(g===void 0&&typeof m=="string")w=m,g=this.length,m=0;else{if(!isFinite(m))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");m|=0,isFinite(g)?(g|=0,w===void 0&&(w="utf8")):(w=g,g=void 0)}var I=this.length-m;if((g===void 0||g>I)&&(g=I),d.length>0&&(g<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");for(var P=!1;;)switch(w){case"hex":return hexWrite(this,d,m,g);case"utf8":case"utf-8":return utf8Write(this,d,m,g);case"ascii":return asciiWrite(this,d,m,g);case"latin1":case"binary":return latin1Write(this,d,m,g);case"base64":return base64Write(this,d,m,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,d,m,g);default:if(P)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),P=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(d){var m=d.length;if(m<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,d);for(var g="",w=0;w<m;)g+=String.fromCharCode.apply(String,d.slice(w,w+=MAX_ARGUMENTS_LENGTH));return g}function asciiSlice(d,m,g){var w="";g=Math.min(d.length,g);for(var I=m;I<g;++I)w+=String.fromCharCode(127&d[I]);return w}function latin1Slice(d,m,g){var w="";g=Math.min(d.length,g);for(var I=m;I<g;++I)w+=String.fromCharCode(d[I]);return w}function hexSlice(d,m,g){var w=d.length;(!m||m<0)&&(m=0),(!g||g<0||g>w)&&(g=w);for(var I="",P=m;P<g;++P)I+=toHex(d[P]);return I}function utf16leSlice(d,m,g){for(var w=d.slice(m,g),I="",P=0;P<w.length;P+=2)I+=String.fromCharCode(w[P]+256*w[P+1]);return I}function checkOffset(d,m,g){if(d%1!=0||d<0)throw new RangeError("offset is not uint");if(d+m>g)throw new RangeError("Trying to access beyond buffer length")}function checkInt(d,m,g,w,I,P){if(!internalIsBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>I||m<P)throw new RangeError('"value" argument is out of bounds');if(g+w>d.length)throw new RangeError("Index out of range")}function objectWriteUInt16(d,m,g,w){m<0&&(m=65535+m+1);for(var I=0,P=Math.min(d.length-g,2);I<P;++I)d[g+I]=(m&255<<8*(w?I:1-I))>>>8*(w?I:1-I)}function objectWriteUInt32(d,m,g,w){m<0&&(m=4294967295+m+1);for(var I=0,P=Math.min(d.length-g,4);I<P;++I)d[g+I]=m>>>8*(w?I:3-I)&255}function checkIEEE754(d,m,g,w,I,P){if(g+w>d.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function writeFloat(d,m,g,w,I){return I||checkIEEE754(d,m,g,4),write(d,m,g,w,23,4),g+4}function writeDouble(d,m,g,w,I){return I||checkIEEE754(d,m,g,8),write(d,m,g,w,52,8),g+8}Buffer.prototype.slice=function(d,m){var g,w=this.length;if((d=~~d)<0?(d+=w)<0&&(d=0):d>w&&(d=w),(m=m===void 0?w:~~m)<0?(m+=w)<0&&(m=0):m>w&&(m=w),m<d&&(m=d),Buffer.TYPED_ARRAY_SUPPORT)(g=this.subarray(d,m)).__proto__=Buffer.prototype;else{var I=m-d;g=new Buffer(I,void 0);for(var P=0;P<I;++P)g[P]=this[P+d]}return g},Buffer.prototype.readUIntLE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d],I=1,P=0;++P<m&&(I*=256);)w+=this[d+P]*I;return w},Buffer.prototype.readUIntBE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d+--m],I=1;m>0&&(I*=256);)w+=this[d+--m]*I;return w},Buffer.prototype.readUInt8=function(d,m){return m||checkOffset(d,1,this.length),this[d]},Buffer.prototype.readUInt16LE=function(d,m){return m||checkOffset(d,2,this.length),this[d]|this[d+1]<<8},Buffer.prototype.readUInt16BE=function(d,m){return m||checkOffset(d,2,this.length),this[d]<<8|this[d+1]},Buffer.prototype.readUInt32LE=function(d,m){return m||checkOffset(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+16777216*this[d+3]},Buffer.prototype.readUInt32BE=function(d,m){return m||checkOffset(d,4,this.length),16777216*this[d]+(this[d+1]<<16|this[d+2]<<8|this[d+3])},Buffer.prototype.readIntLE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d],I=1,P=0;++P<m&&(I*=256);)w+=this[d+P]*I;return w>=(I*=128)&&(w-=Math.pow(2,8*m)),w},Buffer.prototype.readIntBE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=m,I=1,P=this[d+--w];w>0&&(I*=256);)P+=this[d+--w]*I;return P>=(I*=128)&&(P-=Math.pow(2,8*m)),P},Buffer.prototype.readInt8=function(d,m){return m||checkOffset(d,1,this.length),128&this[d]?-1*(255-this[d]+1):this[d]},Buffer.prototype.readInt16LE=function(d,m){m||checkOffset(d,2,this.length);var g=this[d]|this[d+1]<<8;return 32768&g?4294901760|g:g},Buffer.prototype.readInt16BE=function(d,m){m||checkOffset(d,2,this.length);var g=this[d+1]|this[d]<<8;return 32768&g?4294901760|g:g},Buffer.prototype.readInt32LE=function(d,m){return m||checkOffset(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},Buffer.prototype.readInt32BE=function(d,m){return m||checkOffset(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},Buffer.prototype.readFloatLE=function(d,m){return m||checkOffset(d,4,this.length),read(this,d,!0,23,4)},Buffer.prototype.readFloatBE=function(d,m){return m||checkOffset(d,4,this.length),read(this,d,!1,23,4)},Buffer.prototype.readDoubleLE=function(d,m){return m||checkOffset(d,8,this.length),read(this,d,!0,52,8)},Buffer.prototype.readDoubleBE=function(d,m){return m||checkOffset(d,8,this.length),read(this,d,!1,52,8)},Buffer.prototype.writeUIntLE=function(d,m,g,w){d=+d,m|=0,g|=0,w||checkInt(this,d,m,g,Math.pow(2,8*g)-1,0);var I=1,P=0;for(this[m]=255&d;++P<g&&(I*=256);)this[m+P]=d/I&255;return m+g},Buffer.prototype.writeUIntBE=function(d,m,g,w){d=+d,m|=0,g|=0,w||checkInt(this,d,m,g,Math.pow(2,8*g)-1,0);var I=g-1,P=1;for(this[m+I]=255&d;--I>=0&&(P*=256);)this[m+I]=d/P&255;return m+g},Buffer.prototype.writeUInt8=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(d=Math.floor(d)),this[m]=255&d,m+1},Buffer.prototype.writeUInt16LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8):objectWriteUInt16(this,d,m,!0),m+2},Buffer.prototype.writeUInt16BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>8,this[m+1]=255&d):objectWriteUInt16(this,d,m,!1),m+2},Buffer.prototype.writeUInt32LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m+3]=d>>>24,this[m+2]=d>>>16,this[m+1]=d>>>8,this[m]=255&d):objectWriteUInt32(this,d,m,!0),m+4},Buffer.prototype.writeUInt32BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=255&d):objectWriteUInt32(this,d,m,!1),m+4},Buffer.prototype.writeIntLE=function(d,m,g,w){if(d=+d,m|=0,!w){var I=Math.pow(2,8*g-1);checkInt(this,d,m,g,I-1,-I)}var P=0,F=1,D=0;for(this[m]=255&d;++P<g&&(F*=256);)d<0&&D===0&&this[m+P-1]!==0&&(D=1),this[m+P]=(d/F|0)-D&255;return m+g},Buffer.prototype.writeIntBE=function(d,m,g,w){if(d=+d,m|=0,!w){var I=Math.pow(2,8*g-1);checkInt(this,d,m,g,I-1,-I)}var P=g-1,F=1,D=0;for(this[m+P]=255&d;--P>=0&&(F*=256);)d<0&&D===0&&this[m+P+1]!==0&&(D=1),this[m+P]=(d/F|0)-D&255;return m+g},Buffer.prototype.writeInt8=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(d=Math.floor(d)),d<0&&(d=255+d+1),this[m]=255&d,m+1},Buffer.prototype.writeInt16LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8):objectWriteUInt16(this,d,m,!0),m+2},Buffer.prototype.writeInt16BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>8,this[m+1]=255&d):objectWriteUInt16(this,d,m,!1),m+2},Buffer.prototype.writeInt32LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8,this[m+2]=d>>>16,this[m+3]=d>>>24):objectWriteUInt32(this,d,m,!0),m+4},Buffer.prototype.writeInt32BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=255&d):objectWriteUInt32(this,d,m,!1),m+4},Buffer.prototype.writeFloatLE=function(d,m,g){return writeFloat(this,d,m,!0,g)},Buffer.prototype.writeFloatBE=function(d,m,g){return writeFloat(this,d,m,!1,g)},Buffer.prototype.writeDoubleLE=function(d,m,g){return writeDouble(this,d,m,!0,g)},Buffer.prototype.writeDoubleBE=function(d,m,g){return writeDouble(this,d,m,!1,g)},Buffer.prototype.copy=function(d,m,g,w){if(g||(g=0),w||w===0||(w=this.length),m>=d.length&&(m=d.length),m||(m=0),w>0&&w<g&&(w=g),w===g||d.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("sourceStart out of bounds");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),d.length-m<w-g&&(w=d.length-m+g);var I,P=w-g;if(this===d&&g<m&&m<w)for(I=P-1;I>=0;--I)d[I+m]=this[I+g];else if(P<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(I=0;I<P;++I)d[I+m]=this[I+g];else Uint8Array.prototype.set.call(d,this.subarray(g,g+P),m);return P},Buffer.prototype.fill=function(d,m,g,w){if(typeof d=="string"){if(typeof m=="string"?(w=m,m=0,g=this.length):typeof g=="string"&&(w=g,g=this.length),d.length===1){var I=d.charCodeAt(0);I<256&&(d=I)}if(w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!Buffer.isEncoding(w))throw new TypeError("Unknown encoding: "+w)}else typeof d=="number"&&(d&=255);if(m<0||this.length<m||this.length<g)throw new RangeError("Out of range index");if(g<=m)return this;var P;if(m>>>=0,g=g===void 0?this.length:g>>>0,d||(d=0),typeof d=="number")for(P=m;P<g;++P)this[P]=d;else{var F=internalIsBuffer(d)?d:utf8ToBytes(new Buffer(d,w).toString()),D=F.length;for(P=0;P<g-m;++P)this[P+m]=F[P%D]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g,HeaderTypes;function base64clean(d){if((d=stringtrim(d).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;d.length%4!=0;)d+="=";return d}function stringtrim(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function toHex(d){return d<16?"0"+d.toString(16):d.toString(16)}function utf8ToBytes(d,m){var g;m=m||1/0;for(var w=d.length,I=null,P=[],F=0;F<w;++F){if((g=d.charCodeAt(F))>55295&&g<57344){if(!I){if(g>56319){(m-=3)>-1&&P.push(239,191,189);continue}if(F+1===w){(m-=3)>-1&&P.push(239,191,189);continue}I=g;continue}if(g<56320){(m-=3)>-1&&P.push(239,191,189),I=g;continue}g=65536+(I-55296<<10|g-56320)}else I&&(m-=3)>-1&&P.push(239,191,189);if(I=null,g<128){if((m-=1)<0)break;P.push(g)}else if(g<2048){if((m-=2)<0)break;P.push(g>>6|192,63&g|128)}else if(g<65536){if((m-=3)<0)break;P.push(g>>12|224,g>>6&63|128,63&g|128)}else{if(!(g<1114112))throw new Error("Invalid code point");if((m-=4)<0)break;P.push(g>>18|240,g>>12&63|128,g>>6&63|128,63&g|128)}}return P}function asciiToBytes(d){for(var m=[],g=0;g<d.length;++g)m.push(255&d.charCodeAt(g));return m}function utf16leToBytes(d,m){for(var g,w,I,P=[],F=0;F<d.length&&!((m-=2)<0);++F)w=(g=d.charCodeAt(F))>>8,I=g%256,P.push(I),P.push(w);return P}function base64ToBytes(d){return toByteArray(base64clean(d))}function blitBuffer(d,m,g,w){for(var I=0;I<w&&!(I+g>=m.length||I>=d.length);++I)m[I+g]=d[I];return I}function isnan(d){return d!=d}function isBuffer(d){return d!=null&&(!!d._isBuffer||isFastBuffer(d)||isSlowBuffer(d))}function isFastBuffer(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}function isSlowBuffer(d){return typeof d.readFloatLE=="function"&&typeof d.slice=="function"&&isFastBuffer(d.slice(0,0))}(function(d){d[d.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",d[d.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",d[d.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",d[d.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",d[d.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"})(HeaderTypes||(HeaderTypes={}));var HeaderTypes$1=HeaderTypes,BmpCompression;function maskColor(d,m,g,w){const I=1+~d&d,P=1+~m&m,F=1+~g&g,D=1+~w&w,$=d/I+1,U=m/P+1,j=g/F+1,Z=w/D+1;return{shiftRed:G=>(G&d)/I*256/$,shiftGreen:G=>(G&m)/P*256/U,shiftBlue:G=>(G&g)/F*256/j,shiftAlpha:w!==0?G=>(G&w)/D*256/Z:()=>255}}(function(d){d[d.NONE=0]="NONE",d[d.BI_RLE8=1]="BI_RLE8",d[d.BI_RLE4=2]="BI_RLE4",d[d.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",d[d.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"})(BmpCompression||(BmpCompression={}));class BmpDecoder{flag;fileSize;reserved1;reserved2;offset;headerSize;width;height;planes;bitPP;compression;rawSize;hr;vr;colors;importantColors;palette;data;maskRed;maskGreen;maskBlue;maskAlpha;toRGBA;pos;bottomUp;buffer;locRed;locGreen;locBlue;locAlpha;shiftRed;shiftGreen;shiftBlue;shiftAlpha;constructor(m,{toRGBA:g}={toRGBA:!1}){if(this.buffer=m,this.toRGBA=!!g,this.pos=0,this.bottomUp=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!=="BM")throw new Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.reserved2=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in HeaderTypes$1))throw new Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.height=this.height>2147483647?this.height-4294967296:this.height,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),this.bitPP===32?(this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255):this.bitPP===16&&(this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31),(this.headerSize>HeaderTypes$1.BITMAP_INFO_HEADER||this.compression===BmpCompression.BI_BIT_FIELDS||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE()),(this.headerSize>HeaderTypes$1.BITMAP_V2_INFO_HEADER||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskAlpha=this.readUInt32LE()),this.headerSize>HeaderTypes$1.BITMAP_V3_INFO_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V4_HEADER-HeaderTypes$1.BITMAP_V3_INFO_HEADER),this.headerSize>HeaderTypes$1.BITMAP_V4_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V5_HEADER-HeaderTypes$1.BITMAP_V4_HEADER),this.bitPP<=8||this.colors>0){const g=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(g);for(let w=0;w<g;w++){const I=this.buffer.readUInt8(this.pos++),P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++),D=this.buffer.readUInt8(this.pos++);this.palette[w]={red:F,green:P,blue:I,quad:D}}}this.height<0&&(this.height*=-1,this.bottomUp=!1);const m=maskColor(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=m.shiftRed,this.shiftGreen=m.shiftGreen,this.shiftBlue=m.shiftBlue,this.shiftAlpha=m.shiftAlpha}parseRGBA(){switch(this.data=Buffer.alloc(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){const m=Math.ceil(this.width/8),g=m%4,w=g!==0?4-g:0;this.scanImage(w,m,((I,P)=>{const F=this.buffer.readUInt8(this.pos++),D=P*this.width*4+8*I*4;for(let $=0;$<8&&8*I+$<this.width;$++){const U=this.palette[F>>7-$&1];this.data[D+$*this.locAlpha]=0,this.data[D+4*$+this.locBlue]=U.blue,this.data[D+4*$+this.locGreen]=U.green,this.data[D+4*$+this.locRed]=U.red}}))}bit4(){if(this.compression===BmpCompression.BI_RLE4){this.data.fill(0);let m=!1,g=this.bottomUp?this.height-1:0,w=0;for(;w<this.data.length;){const I=this.buffer.readUInt8(this.pos++),P=this.buffer.readUInt8(this.pos++);if(I===0){if(P===0){g+=this.bottomUp?-1:1,w=g*this.width*4,m=!1;continue}if(P===1)break;if(P===2){const F=this.buffer.readUInt8(this.pos++),D=this.buffer.readUInt8(this.pos++);g+=this.bottomUp?-D:D,w+=D*this.width*4+4*F}else{let F=this.buffer.readUInt8(this.pos++);for(let D=0;D<P;D++)w=this.setPixelData(w,m?15&F:(240&F)>>4),1&D&&D+1<P&&(F=this.buffer.readUInt8(this.pos++)),m=!m;(P+1>>1&1)==1&&this.pos++}}else for(let F=0;F<I;F++)w=this.setPixelData(w,m?15&P:(240&P)>>4),m=!m}}else{const m=Math.ceil(this.width/2),g=m%4,w=g!==0?4-g:0;this.scanImage(w,m,((I,P)=>{const F=this.buffer.readUInt8(this.pos++),D=P*this.width*4+2*I*4,$=F>>4;let U=this.palette[$];if(this.data[D]=0,this.data[D+1]=U.blue,this.data[D+2]=U.green,this.data[D+3]=U.red,2*I+1>=this.width)return!1;const j=15&F;U=this.palette[j],this.data[D+4]=0,this.data[D+4+1]=U.blue,this.data[D+4+2]=U.green,this.data[D+4+3]=U.red}))}}bit8(){if(this.compression===BmpCompression.BI_RLE8){this.data.fill(0);let m=this.bottomUp?this.height-1:0,g=0;for(;g<this.data.length;){const w=this.buffer.readUInt8(this.pos++),I=this.buffer.readUInt8(this.pos++);if(w===0){if(I===0){m+=this.bottomUp?-1:1,g=m*this.width*4;continue}if(I===1)break;if(I===2){const P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++);m+=this.bottomUp?-F:F,g+=F*this.width*4+4*P}else{for(let P=0;P<I;P++){const F=this.buffer.readUInt8(this.pos++);g=this.setPixelData(g,F)}!0&I&&this.pos++}}else for(let P=0;P<w;P++)g=this.setPixelData(g,I)}}else{const m=this.width%4,g=m!==0?4-m:0;this.scanImage(g,this.width,((w,I)=>{const P=this.buffer.readUInt8(this.pos++),F=I*this.width*4+4*w;if(P<this.palette.length){const D=this.palette[P];this.data[F]=0,this.data[F+1]=D.blue,this.data[F+2]=D.green,this.data[F+3]=D.red}else this.data[F]=0,this.data[F+1]=255,this.data[F+2]=255,this.data[F+3]=255}))}}bit16(){const m=this.width%2*2;this.scanImage(m,this.width,((g,w)=>{const I=w*this.width*4+4*g,P=this.buffer.readUInt16LE(this.pos);this.pos+=2,this.data[I+this.locRed]=this.shiftRed(P),this.data[I+this.locGreen]=this.shiftGreen(P),this.data[I+this.locBlue]=this.shiftBlue(P),this.data[I+this.locAlpha]=this.shiftAlpha(P)}))}bit24(){const m=this.width%4;this.scanImage(m,this.width,((g,w)=>{const I=w*this.width*4+4*g,P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++),D=this.buffer.readUInt8(this.pos++);this.data[I+this.locRed]=D,this.data[I+this.locGreen]=F,this.data[I+this.locBlue]=P,this.data[I+this.locAlpha]=0}))}bit32(){this.scanImage(0,this.width,((m,g)=>{const w=g*this.width*4+4*m,I=this.readUInt32LE();this.data[w+this.locRed]=this.shiftRed(I),this.data[w+this.locGreen]=this.shiftGreen(I),this.data[w+this.locBlue]=this.shiftBlue(I),this.data[w+this.locAlpha]=this.shiftAlpha(I)}))}scanImage(m=0,g=this.width,w){for(let I=this.height-1;I>=0;I--){const P=this.bottomUp?I:this.height-1-I;for(let F=0;F<g;F++)if(w.call(this,F,P)===!1)return;this.pos+=m}}readUInt32LE(){const m=this.buffer.readUInt32LE(this.pos);return this.pos+=4,m}setPixelData(m,g){const{blue:w,green:I,red:P}=this.palette[g];return this.data[m+this.locAlpha]=0,this.data[m+1+this.locBlue]=w,this.data[m+2+this.locGreen]=I,this.data[m+3+this.locRed]=P,m+4}}function createInteger(d){return d.reduce(((m,g)=>m<<1|g),0)}function createColor(d){return d.quad<<24|d.red<<16|d.green<<8|d.blue}class BmpEncoder{fileSize;reserved1;reserved2;offset;width;flag;height;planes;bitPP;compress;hr;vr;colors;importantColors;rawSize;headerSize;data;palette;extraBytes;buffer;bytesInColor;pos;constructor(m){switch(this.buffer=m.data,this.width=m.width,this.height=m.height,this.headerSize=HeaderTypes$1.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=m.bitPP||24,this.offset=54,this.reserved1=m.reserved1||0,this.reserved2=m.reserved2||0,this.planes=1,this.compress=0,this.hr=m.hr||0,this.vr=m.vr||0,this.importantColors=m.importantColors||0,this.colors=Math.min(2**(this.bitPP-1||1),m.colors||1/0),this.palette=m.palette||[],this.colors&&this.bitPP<16?this.offset+=4*this.colors:this.colors=0,this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=.5;break;case 1:this.bytesInColor=1/8;break;default:this.bytesInColor=3,this.bitPP=24}const g=this.width*this.bitPP/32,w=Math.ceil(g);this.extraBytes=4*(w-g),this.rawSize=this.height*w*4+2,this.fileSize=this.rawSize+this.offset,this.data=Buffer.alloc(this.fileSize,1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data.write(this.flag,this.pos,2),this.pos+=2,this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.data.writeUInt16LE(this.planes,this.pos),this.pos+=2,this.data.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){this.palette.length&&this.colors===2?this.initColors(1):(this.writeUInt32LE(16777215),this.writeUInt32LE(0)),this.pos+=1;let m=[];this.writeImage(((g,w,I)=>{let P=w;P++;const F=this.buffer[P++],D=this.buffer[P++],$=.2126*this.buffer[P++]+.7152*D+.0722*F;return m.push($>127?0:1),(I+1)%8==0?(this.data[g-1]=createInteger(m),m=[]):I===this.width-1&&m.length>0&&(this.data[g-1]=createInteger(m)<<4,m=[]),P}))}bit4(){const m=this.initColors(4);let g=[];this.writeImage(((w,I,P)=>{let F=I;const D=createColor({quad:this.buffer[F++],blue:this.buffer[F++],green:this.buffer[F++],red:this.buffer[F++]}),$=m.findIndex((U=>U===D));return $!==-1?g.push($):g.push(0),(P+1)%2==0&&(this.data[w]=g[0]<<4|g[1],g=[]),F}))}bit8(){const m=this.initColors(8);this.writeImage(((g,w)=>{let I=w;const P=createColor({quad:this.buffer[I++],blue:this.buffer[I++],green:this.buffer[I++],red:this.buffer[I++]}),F=m.findIndex((D=>D===P));return this.data[g]=F!==-1?F:0,I}))}bit16(){this.writeImage(((m,g)=>{let w=g+1;const I=this.buffer[w++]/8,P=this.buffer[w++]/8,F=this.buffer[w++]/8<<10|P<<5|I;return this.data[m]=255&F,this.data[m+1]=(65280&F)>>8,w}))}bit24(){this.writeImage(((m,g)=>{let w=g+1;return this.data[m]=this.buffer[w++],this.data[m+1]=this.buffer[w++],this.data[m+2]=this.buffer[w++],w}))}bit32(){this.writeImage(((m,g)=>{let w=g;return this.data[m+3]=this.buffer[w++],this.data[m]=this.buffer[w++],this.data[m+1]=this.buffer[w++],this.data[m+2]=this.buffer[w++],w}))}writeImage(m){const g=this.extraBytes+this.width*this.bytesInColor;let w=0;for(let I=0;I<this.height;I++)for(let P=0;P<this.width;P++){const F=Math.floor(this.pos+(this.height-1-I)*g+P*this.bytesInColor);w=m.call(this,F,w,P,I)}}initColors(m){const g=[];if(!this.palette.length)throw new Error(`To encode ${m}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);for(let w=0;w<this.colors;w++){const I=createColor(this.palette[w]);this.writeUInt32LE(I),g.push(I)}return g}writeUInt32LE(m){this.data.writeUInt32LE(m,this.pos),this.pos+=4}}function decode$2(d,m){return new BmpDecoder(d,m)}function encode$2(d){return new BmpEncoder(d)}function _typeof(d){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},_typeof(d)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(d,m){if(m=m||{},(d=d||"")instanceof tinycolor)return d;if(!(this instanceof tinycolor))return new tinycolor(d,m);var g=inputToRGB(d);this._originalInput=d,this._r=g.r,this._g=g.g,this._b=g.b,this._a=g.a,this._roundA=Math.round(100*this._a)/100,this._format=m.format||g.format,this._gradientType=m.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=g.ok}function inputToRGB(d){var m={r:0,g:0,b:0},g=1,w=null,I=null,P=null,F=!1,D=!1;return typeof d=="string"&&(d=stringInputToObject(d)),_typeof(d)=="object"&&(isValidCSSUnit(d.r)&&isValidCSSUnit(d.g)&&isValidCSSUnit(d.b)?(m=rgbToRgb(d.r,d.g,d.b),F=!0,D=String(d.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(d.h)&&isValidCSSUnit(d.s)&&isValidCSSUnit(d.v)?(w=convertToPercentage(d.s),I=convertToPercentage(d.v),m=hsvToRgb(d.h,w,I),F=!0,D="hsv"):isValidCSSUnit(d.h)&&isValidCSSUnit(d.s)&&isValidCSSUnit(d.l)&&(w=convertToPercentage(d.s),P=convertToPercentage(d.l),m=hslToRgb(d.h,w,P),F=!0,D="hsl"),d.hasOwnProperty("a")&&(g=d.a)),g=boundAlpha(g),{ok:F,format:d.format||D,r:Math.min(255,Math.max(m.r,0)),g:Math.min(255,Math.max(m.g,0)),b:Math.min(255,Math.max(m.b,0)),a:g}}function rgbToRgb(d,m,g){return{r:255*bound01(d,255),g:255*bound01(m,255),b:255*bound01(g,255)}}function rgbToHsl(d,m,g){d=bound01(d,255),m=bound01(m,255),g=bound01(g,255);var w,I,P=Math.max(d,m,g),F=Math.min(d,m,g),D=(P+F)/2;if(P==F)w=I=0;else{var $=P-F;switch(I=D>.5?$/(2-P-F):$/(P+F),P){case d:w=(m-g)/$+(m<g?6:0);break;case m:w=(g-d)/$+2;break;case g:w=(d-m)/$+4}w/=6}return{h:w,s:I,l:D}}function hslToRgb(d,m,g){var w,I,P;function F(U,j,Z){return Z<0&&(Z+=1),Z>1&&(Z-=1),Z<1/6?U+6*(j-U)*Z:Z<.5?j:Z<2/3?U+(j-U)*(2/3-Z)*6:U}if(d=bound01(d,360),m=bound01(m,100),g=bound01(g,100),m===0)w=I=P=g;else{var D=g<.5?g*(1+m):g+m-g*m,$=2*g-D;w=F($,D,d+1/3),I=F($,D,d),P=F($,D,d-1/3)}return{r:255*w,g:255*I,b:255*P}}function rgbToHsv(d,m,g){d=bound01(d,255),m=bound01(m,255),g=bound01(g,255);var w,I,P=Math.max(d,m,g),F=Math.min(d,m,g),D=P,$=P-F;if(I=P===0?0:$/P,P==F)w=0;else{switch(P){case d:w=(m-g)/$+(m<g?6:0);break;case m:w=(g-d)/$+2;break;case g:w=(d-m)/$+4}w/=6}return{h:w,s:I,v:D}}function hsvToRgb(d,m,g){d=6*bound01(d,360),m=bound01(m,100),g=bound01(g,100);var w=Math.floor(d),I=d-w,P=g*(1-m),F=g*(1-I*m),D=g*(1-(1-I)*m),$=w%6;return{r:255*[g,F,P,P,D,g][$],g:255*[D,g,g,F,P,P][$],b:255*[P,P,D,g,g,F][$]}}function rgbToHex(d,m,g,w){var I=[pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16))];return w&&I[0].charAt(0)==I[0].charAt(1)&&I[1].charAt(0)==I[1].charAt(1)&&I[2].charAt(0)==I[2].charAt(1)?I[0].charAt(0)+I[1].charAt(0)+I[2].charAt(0):I.join("")}function rgbaToHex(d,m,g,w,I){var P=[pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16)),pad2(convertDecimalToHex(w))];return I&&P[0].charAt(0)==P[0].charAt(1)&&P[1].charAt(0)==P[1].charAt(1)&&P[2].charAt(0)==P[2].charAt(1)&&P[3].charAt(0)==P[3].charAt(1)?P[0].charAt(0)+P[1].charAt(0)+P[2].charAt(0)+P[3].charAt(0):P.join("")}function rgbaToArgbHex(d,m,g,w){return[pad2(convertDecimalToHex(w)),pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16))].join("")}function _desaturate(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.s-=m/100,g.s=clamp01(g.s),tinycolor(g)}function _saturate(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.s+=m/100,g.s=clamp01(g.s),tinycolor(g)}function _greyscale(d){return tinycolor(d).desaturate(100)}function _lighten(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.l+=m/100,g.l=clamp01(g.l),tinycolor(g)}function _brighten(d,m){m=m===0?0:m||10;var g=tinycolor(d).toRgb();return g.r=Math.max(0,Math.min(255,g.r-Math.round(-m/100*255))),g.g=Math.max(0,Math.min(255,g.g-Math.round(-m/100*255))),g.b=Math.max(0,Math.min(255,g.b-Math.round(-m/100*255))),tinycolor(g)}function _darken(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.l-=m/100,g.l=clamp01(g.l),tinycolor(g)}function _spin(d,m){var g=tinycolor(d).toHsl(),w=(g.h+m)%360;return g.h=w<0?360+w:w,tinycolor(g)}function _complement(d){var m=tinycolor(d).toHsl();return m.h=(m.h+180)%360,tinycolor(m)}function polyad(d,m){if(isNaN(m)||m<=0)throw new Error("Argument to polyad must be a positive number");for(var g=tinycolor(d).toHsl(),w=[tinycolor(d)],I=360/m,P=1;P<m;P++)w.push(tinycolor({h:(g.h+P*I)%360,s:g.s,l:g.l}));return w}function _splitcomplement(d){var m=tinycolor(d).toHsl(),g=m.h;return[tinycolor(d),tinycolor({h:(g+72)%360,s:m.s,l:m.l}),tinycolor({h:(g+216)%360,s:m.s,l:m.l})]}function _analogous(d,m,g){m=m||6,g=g||30;var w=tinycolor(d).toHsl(),I=360/g,P=[tinycolor(d)];for(w.h=(w.h-(I*m>>1)+720)%360;--m;)w.h=(w.h+I)%360,P.push(tinycolor(w));return P}function _monochromatic(d,m){m=m||6;for(var g=tinycolor(d).toHsv(),w=g.h,I=g.s,P=g.v,F=[],D=1/m;m--;)F.push(tinycolor({h:w,s:I,v:P})),P=(P+D)%1;return F}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var d=this.toRgb();return(299*d.r+587*d.g+114*d.b)/1e3},getLuminance:function(){var d,m,g,w=this.toRgb();return d=w.r/255,m=w.g/255,g=w.b/255,.2126*(d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4))+.7152*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.0722*(g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4))},setAlpha:function(d){return this._a=boundAlpha(d),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var d=rgbToHsv(this._r,this._g,this._b);return{h:360*d.h,s:d.s,v:d.v,a:this._a}},toHsvString:function(){var d=rgbToHsv(this._r,this._g,this._b),m=Math.round(360*d.h),g=Math.round(100*d.s),w=Math.round(100*d.v);return this._a==1?"hsv("+m+", "+g+"%, "+w+"%)":"hsva("+m+", "+g+"%, "+w+"%, "+this._roundA+")"},toHsl:function(){var d=rgbToHsl(this._r,this._g,this._b);return{h:360*d.h,s:d.s,l:d.l,a:this._a}},toHslString:function(){var d=rgbToHsl(this._r,this._g,this._b),m=Math.round(360*d.h),g=Math.round(100*d.s),w=Math.round(100*d.l);return this._a==1?"hsl("+m+", "+g+"%, "+w+"%)":"hsla("+m+", "+g+"%, "+w+"%, "+this._roundA+")"},toHex:function(d){return rgbToHex(this._r,this._g,this._b,d)},toHexString:function(d){return"#"+this.toHex(d)},toHex8:function(d){return rgbaToHex(this._r,this._g,this._b,this._a,d)},toHex8String:function(d){return"#"+this.toHex8(d)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*bound01(this._r,255))+"%",g:Math.round(100*bound01(this._g,255))+"%",b:Math.round(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%)":"rgba("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(d){var m="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),g=m,w=this._gradientType?"GradientType = 1, ":"";if(d){var I=tinycolor(d);g="#"+rgbaToArgbHex(I._r,I._g,I._b,I._a)}return"progid:DXImageTransform.Microsoft.gradient("+w+"startColorstr="+m+",endColorstr="+g+")"},toString:function(d){var m=!!d;d=d||this._format;var g=!1,w=this._a<1&&this._a>=0;return m||!w||d!=="hex"&&d!=="hex6"&&d!=="hex3"&&d!=="hex4"&&d!=="hex8"&&d!=="name"?(d==="rgb"&&(g=this.toRgbString()),d==="prgb"&&(g=this.toPercentageRgbString()),d!=="hex"&&d!=="hex6"||(g=this.toHexString()),d==="hex3"&&(g=this.toHexString(!0)),d==="hex4"&&(g=this.toHex8String(!0)),d==="hex8"&&(g=this.toHex8String()),d==="name"&&(g=this.toName()),d==="hsl"&&(g=this.toHslString()),d==="hsv"&&(g=this.toHsvString()),g||this.toHexString()):d==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(d,m){var g=d.apply(null,[this].concat([].slice.call(m)));return this._r=g._r,this._g=g._g,this._b=g._b,this.setAlpha(g._a),this},lighten:function(){return this._applyModification(_lighten,arguments)},brighten:function(){return this._applyModification(_brighten,arguments)},darken:function(){return this._applyModification(_darken,arguments)},desaturate:function(){return this._applyModification(_desaturate,arguments)},saturate:function(){return this._applyModification(_saturate,arguments)},greyscale:function(){return this._applyModification(_greyscale,arguments)},spin:function(){return this._applyModification(_spin,arguments)},_applyCombination:function(d,m){return d.apply(null,[this].concat([].slice.call(m)))},analogous:function(){return this._applyCombination(_analogous,arguments)},complement:function(){return this._applyCombination(_complement,arguments)},monochromatic:function(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(_splitcomplement,arguments)},triad:function(){return this._applyCombination(polyad,[3])},tetrad:function(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(d,m){if(_typeof(d)=="object"){var g={};for(var w in d)d.hasOwnProperty(w)&&(g[w]=w==="a"?d[w]:convertToPercentage(d[w]));d=g}return tinycolor(d,m)},tinycolor.equals=function(d,m){return!(!d||!m)&&tinycolor(d).toRgbString()==tinycolor(m).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},tinycolor.mix=function(d,m,g){g=g===0?0:g||50;var w=tinycolor(d).toRgb(),I=tinycolor(m).toRgb(),P=g/100;return tinycolor({r:(I.r-w.r)*P+w.r,g:(I.g-w.g)*P+w.g,b:(I.b-w.b)*P+w.b,a:(I.a-w.a)*P+w.a})},tinycolor.readability=function(d,m){var g=tinycolor(d),w=tinycolor(m);return(Math.max(g.getLuminance(),w.getLuminance())+.05)/(Math.min(g.getLuminance(),w.getLuminance())+.05)},tinycolor.isReadable=function(d,m,g){var w,I,P=tinycolor.readability(d,m);switch(I=!1,(w=validateWCAG2Parms(g)).level+w.size){case"AAsmall":case"AAAlarge":I=P>=4.5;break;case"AAlarge":I=P>=3;break;case"AAAsmall":I=P>=7}return I},tinycolor.mostReadable=function(d,m,g){var w,I,P,F,D=null,$=0;I=(g=g||{}).includeFallbackColors,P=g.level,F=g.size;for(var U=0;U<m.length;U++)(w=tinycolor.readability(d,m[U]))>$&&($=w,D=tinycolor(m[U]));return tinycolor.isReadable(d,D,{level:P,size:F})||!I?D:(g.includeFallbackColors=!1,tinycolor.mostReadable(d,["#fff","#000"],g))};var names$1=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names$1);function flip(d){var m={};for(var g in d)d.hasOwnProperty(g)&&(m[d[g]]=g);return m}function boundAlpha(d){return d=parseFloat(d),(isNaN(d)||d<0||d>1)&&(d=1),d}function bound01(d,m){isOnePointZero(d)&&(d="100%");var g=isPercentage(d);return d=Math.min(m,Math.max(0,parseFloat(d))),g&&(d=parseInt(d*m,10)/100),Math.abs(d-m)<1e-6?1:d%m/parseFloat(m)}function clamp01(d){return Math.min(1,Math.max(0,d))}function parseIntFromHex(d){return parseInt(d,16)}function isOnePointZero(d){return typeof d=="string"&&d.indexOf(".")!=-1&&parseFloat(d)===1}function isPercentage(d){return typeof d=="string"&&d.indexOf("%")!=-1}function pad2(d){return d.length==1?"0"+d:""+d}function convertToPercentage(d){return d<=1&&(d=100*d+"%"),d}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(d){return parseIntFromHex(d)/255}var matchers=(CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}),CSS_UNIT,PERMISSIVE_MATCH3,PERMISSIVE_MATCH4;function isValidCSSUnit(d){return!!matchers.CSS_UNIT.exec(d)}function stringInputToObject(d){d=d.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var m,g=!1;if(names$1[d])d=names$1[d],g=!0;else if(d=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(m=matchers.rgb.exec(d))?{r:m[1],g:m[2],b:m[3]}:(m=matchers.rgba.exec(d))?{r:m[1],g:m[2],b:m[3],a:m[4]}:(m=matchers.hsl.exec(d))?{h:m[1],s:m[2],l:m[3]}:(m=matchers.hsla.exec(d))?{h:m[1],s:m[2],l:m[3],a:m[4]}:(m=matchers.hsv.exec(d))?{h:m[1],s:m[2],v:m[3]}:(m=matchers.hsva.exec(d))?{h:m[1],s:m[2],v:m[3],a:m[4]}:(m=matchers.hex8.exec(d))?{r:parseIntFromHex(m[1]),g:parseIntFromHex(m[2]),b:parseIntFromHex(m[3]),a:convertHexToDecimal(m[4]),format:g?"name":"hex8"}:(m=matchers.hex6.exec(d))?{r:parseIntFromHex(m[1]),g:parseIntFromHex(m[2]),b:parseIntFromHex(m[3]),format:g?"name":"hex"}:(m=matchers.hex4.exec(d))?{r:parseIntFromHex(m[1]+""+m[1]),g:parseIntFromHex(m[2]+""+m[2]),b:parseIntFromHex(m[3]+""+m[3]),a:convertHexToDecimal(m[4]+""+m[4]),format:g?"name":"hex8"}:!!(m=matchers.hex3.exec(d))&&{r:parseIntFromHex(m[1]+""+m[1]),g:parseIntFromHex(m[2]+""+m[2]),b:parseIntFromHex(m[3]+""+m[3]),format:g?"name":"hex"}}function validateWCAG2Parms(d){var m,g;return(m=((d=d||{level:"AA",size:"small"}).level||"AA").toUpperCase())!=="AA"&&m!=="AAA"&&(m="AA"),(g=(d.size||"small").toLowerCase())!=="small"&&g!=="large"&&(g="small"),{level:m,size:g}}function clone(d){const m={width:d.bitmap.width,height:d.bitmap.height,data:Buffer.from(d.bitmap.data)};return new d.constructor(m)}function scan(d,m,g,w,I,P){let F,D,$,U,j;if(typeof m=="function")j=m,F=0,D=0,$=d.bitmap.width,U=d.bitmap.height;else{if(F=m,typeof g!="number")throw new Error("y must be a number");if(D=g,typeof w!="number")throw new Error("w must be a number");if($=w,typeof I!="number")throw new Error("h must be a number");if(U=I,typeof P!="function")throw new Error("cb must be a function");j=P}F=Math.round(F),D=Math.round(D),$=Math.round($),U=Math.round(U);const Z=j.bind(d);for(let G=D;G<D+U;G++)for(let H=F;H<F+$;H++)Z(H,G,d.bitmap.width*G+H<<2);return d}function*scanIterator(d,m,g,w,I){m=Math.round(m),g=Math.round(g),w=Math.round(w),I=Math.round(I);for(let P=g;P<g+I;P++)for(let F=m;F<m+w;F++){const D=d.bitmap.width*P+F<<2;yield{x:F,y:P,idx:D,image:d}}}function intToRGBA$1(d){if(typeof d!="number")throw new Error("i must be a number");const m={r:0,g:0,b:0,a:0};return m.r=Math.floor(d/Math.pow(256,3)),m.g=Math.floor((d-m.r*Math.pow(256,3))/Math.pow(256,2)),m.b=Math.floor((d-m.r*Math.pow(256,3)-m.g*Math.pow(256,2))/Math.pow(256,1)),m.a=Math.floor((d-m.r*Math.pow(256,3)-m.g*Math.pow(256,2)-m.b*Math.pow(256,1))/Math.pow(256,0)),m}function colorDiff(d,m){const g=F=>Math.pow(F,2),{max:w}=Math,I="a"in d?d.a:255,P="a"in m?m.a:255;return(w(g(d.r-m.r),g(d.r-m.r-I+P))+w(g(d.g-m.g),g(d.g-m.g-I+P))+w(g(d.b-m.b),g(d.b-m.b-I+P)))/195075}function limit255(d){return d=Math.max(d,0),d=Math.min(d,255)}function cssColorToHex(d){return typeof d=="number"?d:parseInt(tinycolor(d).toHex8(),16)}function encode$1(d,m={}){return scan({bitmap:d},0,0,d.width,d.height,(function(g,w,I){const P=d.data[I+0],F=d.data[I+1],D=d.data[I+2],$=d.data[I+3];d.data[I+0]=$,d.data[I+1]=D,d.data[I+2]=F,d.data[I+3]=P})),encode$2({...d,...m}).data}function decode$1(d,m){const g=decode$2(d,m);return scan({bitmap:g},0,0,g.width,g.height,(function(w,I,P){const F=g.data[P+1],D=g.data[P+2],$=g.data[P+3];g.data[P+0]=$,g.data[P+1]=D,g.data[P+2]=F,g.data[P+3]=255})),g}function msBmp(){return{mime:"image/x-ms-bmp",encode:encode$1,decode:decode$1}}function bmp(){return{mime:"image/bmp",encode:encode$1,decode:decode$1}}var omggif={},GifReader_1,GifWriter_1;function GifWriter(d,m,g,w){var I=0,P=(w=w===void 0?{}:w).loop===void 0?null:w.loop,F=w.palette===void 0?null:w.palette;if(m<=0||g<=0||m>65535||g>65535)throw new Error("Width/Height invalid.");function D(Q){var q=Q.length;if(q<2||q>256||q&q-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return q}d[I++]=71,d[I++]=73,d[I++]=70,d[I++]=56,d[I++]=57,d[I++]=97;var $=0,U=0;if(F!==null){for(var j=D(F);j>>=1;)++$;if(j=1<<$,--$,w.background!==void 0){if((U=w.background)>=j)throw new Error("Background index out of range.");if(U===0)throw new Error("Background index explicitly passed as 0.")}}if(d[I++]=255&m,d[I++]=m>>8&255,d[I++]=255&g,d[I++]=g>>8&255,d[I++]=(F!==null?128:0)|$,d[I++]=U,d[I++]=0,F!==null)for(var Z=0,G=F.length;Z<G;++Z){var H=F[Z];d[I++]=H>>16&255,d[I++]=H>>8&255,d[I++]=255&H}if(P!==null){if(P<0||P>65535)throw new Error("Loop count invalid.");d[I++]=33,d[I++]=255,d[I++]=11,d[I++]=78,d[I++]=69,d[I++]=84,d[I++]=83,d[I++]=67,d[I++]=65,d[I++]=80,d[I++]=69,d[I++]=50,d[I++]=46,d[I++]=48,d[I++]=3,d[I++]=1,d[I++]=255&P,d[I++]=P>>8&255,d[I++]=0}var W=!1;this.addFrame=function(Q,q,rt,et,X,J){if(W===!0&&(--I,W=!1),J=J===void 0?{}:J,Q<0||q<0||Q>65535||q>65535)throw new Error("x/y invalid.");if(rt<=0||et<=0||rt>65535||et>65535)throw new Error("Width/Height invalid.");if(X.length<rt*et)throw new Error("Not enough pixels for the frame size.");var tt=!0,st=J.palette;if(st==null&&(tt=!1,st=F),st==null)throw new Error("Must supply either a local or global palette.");for(var nt=D(st),lt=0;nt>>=1;)++lt;nt=1<<lt;var at=J.delay===void 0?0:J.delay,ct=J.disposal===void 0?0:J.disposal;if(ct<0||ct>3)throw new Error("Disposal out of range.");var V=!1,ut=0;if(J.transparent!==void 0&&J.transparent!==null&&(V=!0,(ut=J.transparent)<0||ut>=nt))throw new Error("Transparent color index.");if((ct!==0||V||at!==0)&&(d[I++]=33,d[I++]=249,d[I++]=4,d[I++]=ct<<2|(V===!0?1:0),d[I++]=255&at,d[I++]=at>>8&255,d[I++]=ut,d[I++]=0),d[I++]=44,d[I++]=255&Q,d[I++]=Q>>8&255,d[I++]=255&q,d[I++]=q>>8&255,d[I++]=255&rt,d[I++]=rt>>8&255,d[I++]=255&et,d[I++]=et>>8&255,d[I++]=tt===!0?128|lt-1:0,tt===!0)for(var wt=0,dt=st.length;wt<dt;++wt){var ft=st[wt];d[I++]=ft>>16&255,d[I++]=ft>>8&255,d[I++]=255&ft}return I=GifWriterOutputLZWCodeStream(d,I,lt<2?2:lt,X)},this.end=function(){return W===!1&&(d[I++]=59,W=!0),I},this.getOutputBuffer=function(){return d},this.setOutputBuffer=function(Q){d=Q},this.getOutputBufferPosition=function(){return I},this.setOutputBufferPosition=function(Q){I=Q}}function GifWriterOutputLZWCodeStream(d,m,g,w){d[m++]=g;var I=m++,P=1<<g,F=P-1,D=P+1,$=D+1,U=g+1,j=0,Z=0;function G(tt){for(;j>=tt;)d[m++]=255&Z,Z>>=8,j-=8,m===I+256&&(d[I]=255,I=m++)}function H(tt){Z|=tt<<j,j+=U,G(8)}var W=w[0]&F,Q={};H(P);for(var q=1,rt=w.length;q<rt;++q){var et=w[q]&F,X=W<<8|et,J=Q[X];if(J===void 0){for(Z|=W<<j,j+=U;j>=8;)d[m++]=255&Z,Z>>=8,j-=8,m===I+256&&(d[I]=255,I=m++);$===4096?(H(P),$=D+1,U=g+1,Q={}):($>=1<<U&&++U,Q[X]=$++),W=et}else W=J}return H(W),H(D),G(1),I+1===m?d[I]=0:(d[I]=m-I-1,d[m++]=0),m}function GifReader(d){var m=0;if(d[m++]!==71||d[m++]!==73||d[m++]!==70||d[m++]!==56||(d[m++]+1&253)!=56||d[m++]!==97)throw new Error("Invalid GIF 87a/89a header.");var g=d[m++]|d[m++]<<8,w=d[m++]|d[m++]<<8,I=d[m++],P=I>>7,F=1<<(7&I)+1;d[m++],d[m++];var D=null,$=null;P&&(D=m,$=F,m+=3*F);var U=!0,j=[],Z=0,G=null,H=0,W=null;for(this.width=g,this.height=w;U&&m<d.length;)switch(d[m++]){case 33:switch(d[m++]){case 255:if(d[m]!==11||d[m+1]==78&&d[m+2]==69&&d[m+3]==84&&d[m+4]==83&&d[m+5]==67&&d[m+6]==65&&d[m+7]==80&&d[m+8]==69&&d[m+9]==50&&d[m+10]==46&&d[m+11]==48&&d[m+12]==3&&d[m+13]==1&&d[m+16]==0)m+=14,W=d[m++]|d[m++]<<8,m++;else for(m+=12;;){if(!((V=d[m++])>=0))throw Error("Invalid block size");if(V===0)break;m+=V}break;case 249:if(d[m++]!==4||d[m+4]!==0)throw new Error("Invalid graphics extension block.");var Q=d[m++];Z=d[m++]|d[m++]<<8,G=d[m++],1&Q||(G=null),H=Q>>2&7,m++;break;case 254:for(;;){if(!((V=d[m++])>=0))throw Error("Invalid block size");if(V===0)break;m+=V}break;default:throw new Error("Unknown graphic control label: 0x"+d[m-1].toString(16))}break;case 44:var q=d[m++]|d[m++]<<8,rt=d[m++]|d[m++]<<8,et=d[m++]|d[m++]<<8,X=d[m++]|d[m++]<<8,J=d[m++],tt=J>>6&1,st=1<<(7&J)+1,nt=D,lt=$,at=!1;J>>7&&(at=!0,nt=m,lt=st,m+=3*st);var ct=m;for(m++;;){var V;if(!((V=d[m++])>=0))throw Error("Invalid block size");if(V===0)break;m+=V}j.push({x:q,y:rt,width:et,height:X,has_local_palette:at,palette_offset:nt,palette_size:lt,data_offset:ct,data_length:m-ct,transparent_index:G,interlaced:!!tt,delay:Z,disposal:H});break;case 59:U=!1;break;default:throw new Error("Unknown gif block: 0x"+d[m-1].toString(16))}this.numFrames=function(){return j.length},this.loopCount=function(){return W},this.frameInfo=function(ut){if(ut<0||ut>=j.length)throw new Error("Frame index out of range.");return j[ut]},this.decodeAndBlitFrameBGRA=function(ut,wt){var dt=this.frameInfo(ut),ft=dt.width*dt.height,pt=new Uint8Array(ft);GifReaderLZWOutputIndexStream(d,dt.data_offset,pt,ft);var Pt=dt.palette_offset,It=dt.transparent_index;It===null&&(It=256);var xt=dt.width,Ft=g-xt,Et=xt,Ct=4*(dt.y*g+dt.x),Ot=4*((dt.y+dt.height)*g+dt.x),Rt=Ct,St=4*Ft;dt.interlaced===!0&&(St+=4*g*7);for(var At=8,Nt=0,Ut=pt.length;Nt<Ut;++Nt){var jt=pt[Nt];if(Et===0&&(Et=xt,(Rt+=St)>=Ot&&(St=4*Ft+4*g*(At-1),Rt=Ct+(xt+Ft)*(At<<1),At>>=1)),jt===It)Rt+=4;else{var Tt=d[Pt+3*jt],it=d[Pt+3*jt+1],Mt=d[Pt+3*jt+2];wt[Rt++]=Mt,wt[Rt++]=it,wt[Rt++]=Tt,wt[Rt++]=255}--Et}},this.decodeAndBlitFrameRGBA=function(ut,wt){var dt=this.frameInfo(ut),ft=dt.width*dt.height,pt=new Uint8Array(ft);GifReaderLZWOutputIndexStream(d,dt.data_offset,pt,ft);var Pt=dt.palette_offset,It=dt.transparent_index;It===null&&(It=256);var xt=dt.width,Ft=g-xt,Et=xt,Ct=4*(dt.y*g+dt.x),Ot=4*((dt.y+dt.height)*g+dt.x),Rt=Ct,St=4*Ft;dt.interlaced===!0&&(St+=4*g*7);for(var At=8,Nt=0,Ut=pt.length;Nt<Ut;++Nt){var jt=pt[Nt];if(Et===0&&(Et=xt,(Rt+=St)>=Ot&&(St=4*Ft+4*g*(At-1),Rt=Ct+(xt+Ft)*(At<<1),At>>=1)),jt===It)Rt+=4;else{var Tt=d[Pt+3*jt],it=d[Pt+3*jt+1],Mt=d[Pt+3*jt+2];wt[Rt++]=Tt,wt[Rt++]=it,wt[Rt++]=Mt,wt[Rt++]=255}--Et}}}function GifReaderLZWOutputIndexStream(d,m,g,w){for(var I=d[m++],P=1<<I,F=P+1,D=F+1,$=I+1,U=(1<<$)-1,j=0,Z=0,G=0,H=d[m++],W=new Int32Array(4096),Q=null;;){for(;j<16&&H!==0;)Z|=d[m++]<<j,j+=8,H===1?H=d[m++]:--H;if(j<$)break;var q=Z&U;if(Z>>=$,j-=$,q!==P){if(q===F)break;for(var rt=q<D?q:Q,et=0,X=rt;X>P;)X=W[X]>>8,++et;var J=X;if(G+et+(rt!==q?1:0)>w)return void console.log("Warning, gif stream longer than expected.");g[G++]=J;var tt=G+=et;for(rt!==q&&(g[G++]=J),X=rt;et--;)X=W[X],g[--tt]=255&X,X>>=8;Q!==null&&D<4096&&(W[D++]=Q<<8|J,D>=U+1&&$<12&&(++$,U=U<<1|1)),Q=q}else D=F+1,U=(1<<($=I+1))-1,Q=null}return G!==w&&console.log("Warning, gif stream shorter than expected."),g}try{GifWriter_1=omggif.GifWriter=GifWriter,GifReader_1=omggif.GifReader=GifReader}catch{}let BitmapImage$2=class Me{constructor(...m){if(m.length===0)throw new Error("constructor requires parameters");const g=m[0];if(g!==null&&typeof g=="object")if(g instanceof Me){const w=g.bitmap;this.bitmap={width:w.width,height:w.height,data:new Buffer(w.width*w.height*4)},w.data.copy(this.bitmap.data)}else{if(!(g.width&&g.height&&g.data))throw new Error("unrecognized constructor parameters");this.bitmap=g}else{if(typeof g!="number"||typeof m[1]!="number")throw new Error("unrecognized constructor parameters");{const w=g,I=m[1],P=m[2];this.bitmap={width:w,height:I},Buffer.isBuffer(P)?this.bitmap.data=P:(this.bitmap.data=new Buffer(w*I*4),typeof P=="number"&&this.fillRGBA(P))}}}blit(m,g,w,I,P,F,D){if(I+F>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(g+F>m.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(P+D>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(w+D>m.bitmap.height)throw new Erro("copy exceeds height of target bitmap");const $=this.bitmap.data,U=m.bitmap.data,j=4*this.bitmap.width,Z=4*m.bitmap.width,G=4*F;let H=P*j+4*I,W=w*Z+4*g;for(;--D>=0;)$.copy(U,W,H,H+G),H+=j,W+=Z;return this}fillRGBA(m){const g=this.bitmap.data,w=4*this.bitmap.height;let I=0;for(;I<w;)g.writeUInt32BE(m,I),I+=4;for(;I<g.length;)g.copy(g,I,0,w),I+=w;return this}getRGBA(m,g){const w=4*(g*this.bitmap.width+m);return this.bitmap.data.readUInt32BE(w)}getRGBASet(){const m=new Set,g=this.bitmap.data;for(let w=0;w<g.length;w+=4)m.add(g.readUInt32BE(w,!0));return m}greyscale(){const m=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,((g,w,I)=>{const P=Math.round(.299*m[I]+.587*m[I+1]+.114*m[I+2]);m[I]=P,m[I+1]=P,m[I+2]=P})),this}reframe(m,g,w,I,P){const F=m<0?0:m,D=g<0?0:g,$=w+F>this.bitmap.width?this.bitmap.width-F:w,U=I+D>this.bitmap.height?this.bitmap.height-D:I,j=m<0?-m:0,Z=g<0?-g:0;let G;if(P===void 0){if(F!==m||D!=g||$!==w||U!==I)throw new GifError("fillRGBA required for this reframing");G=new Me(w,I)}else G=new Me(w,I,P);return this.blit(G,j,Z,F,D,$,U),this.bitmap=G.bitmap,this}scale(m){if(m===1)return;if(!Number.isInteger(m)||m<1)throw new Error("the scale must be an integer >= 1");const g=this.bitmap.width,w=this.bitmap.height,I=g*m*4,P=this.bitmap.data,F=new Buffer(w*I*m);let D,$=0,U=0;for(let j=0;j<w;++j){D=U;for(let Z=0;Z<g;++Z){const G=P.readUInt32BE($,!0);for(let H=0;H<m;++H)F.writeUInt32BE(G,U),U+=4;$+=4}for(let Z=1;Z<m;++Z)F.copy(F,U,D,U),U+=I,D+=I}return this.bitmap={width:g*m,height:w*m,data:F},this}scanAllCoords(m){const g=this.bitmap.width,w=this.bitmap.data.length;let I=0,P=0;for(let F=0;F<w;F+=4)m(I,P,F),++I===g&&(I=0,++P)}scanAllIndexes(m){const g=this.bitmap.data.length;for(let w=0;w<g;w+=4)m(w)}};var bitmapimage=BitmapImage$2,gif$1={};let Gif$1=class{constructor(d,m,g){this.width=g.width,this.height=g.height,this.loops=g.loops,this.usesTransparency=g.usesTransparency,this.colorScope=g.colorScope,this.frames=m,this.buffer=d}};Gif$1.GlobalColorsPreferred=0,Gif$1.GlobalColorsOnly=1,Gif$1.LocalColorsOnly=2;let GifError$2=class extends Error{constructor(d){super(d),d instanceof Error&&(this.stack="Gif"+d.stack)}};gif$1.Gif=Gif$1,gif$1.GifError=GifError$2;var gifcodec={},gifutil={},_polyfillNode_fs={},_polyfillNode_fs$1=Object.freeze({__proto__:null,default:_polyfillNode_fs}),require$$0=getAugmentedNamespace(_polyfillNode_fs$1),__defProp$3=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__defNormalProp$3=(d,m,g)=>m in d?__defProp$3(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__markAsModule=d=>__defProp$3(d,"__esModule",{value:!0}),__export$1=(d,m)=>{for(var g in m)__defProp$3(d,g,{get:m[g],enumerable:!0})},__reExport=(d,m,g,w)=>{if(m&&typeof m=="object"||typeof m=="function")for(let I of __getOwnPropNames(m))!__hasOwnProp.call(d,I)&&g&&__defProp$3(d,I,{get:()=>m[I],enumerable:!(w=__getOwnPropDesc(m,I))||w.enumerable});return d},__toCommonJS=(d=>(m,g)=>d&&d.get(m)||(g=__reExport(__markAsModule({}),m,1),d&&d.set(m,g),g))(typeof WeakMap<"u"?new WeakMap:0),__publicField$3=(d,m,g)=>(__defNormalProp$3(d,typeof m!="symbol"?m+"":m,g),g),src_exports={};__export$1(src_exports,{applyPalette:()=>applyPalette,applyPaletteSync:()=>applyPaletteSync$1,buildPalette:()=>buildPalette,buildPaletteSync:()=>buildPaletteSync$1,constants:()=>constants_exports$1,conversion:()=>conversion_exports$1,distance:()=>distance_exports$1,image:()=>image_exports$1,palette:()=>palette_exports$1,quality:()=>quality_exports$1,utils:()=>utils_exports$1});var constants_exports$1={};__export$1(constants_exports$1,{bt709:()=>bt709_exports$1});var bt709_exports$1={};__export$1(bt709_exports$1,{Y:()=>Y$1,x:()=>x$2,y:()=>y$2});var Y$1=(d=>(d[d.RED=.2126]="RED",d[d.GREEN=.7152]="GREEN",d[d.BLUE=.0722]="BLUE",d[d.WHITE=1]="WHITE",d))(Y$1||{}),x$2=(d=>(d[d.RED=.64]="RED",d[d.GREEN=.3]="GREEN",d[d.BLUE=.15]="BLUE",d[d.WHITE=.3127]="WHITE",d))(x$2||{}),y$2=(d=>(d[d.RED=.33]="RED",d[d.GREEN=.6]="GREEN",d[d.BLUE=.06]="BLUE",d[d.WHITE=.329]="WHITE",d))(y$2||{}),conversion_exports$1={};function correctGamma$1(d){return d>.04045?((d+.055)/1.055)**2.4:d/12.92}function rgb2xyz$1(d,m,g){return{x:.4124*(d=correctGamma$1(d/255))+.3576*(m=correctGamma$1(m/255))+.1805*(g=correctGamma$1(g/255)),y:.2126*d+.7152*m+.0722*g,z:.0193*d+.1192*m+.9505*g}}__export$1(conversion_exports$1,{lab2rgb:()=>lab2rgb$1,lab2xyz:()=>lab2xyz$1,rgb2hsl:()=>rgb2hsl$1,rgb2lab:()=>rgb2lab$1,rgb2xyz:()=>rgb2xyz$1,xyz2lab:()=>xyz2lab$1,xyz2rgb:()=>xyz2rgb$1});var arithmetic_exports$1={};function degrees2radians$1(d){return d*(Math.PI/180)}function max3$1(d,m,g){let w=d;return w<m&&(w=m),w<g&&(w=g),w}function min3$1(d,m,g){let w=d;return w>m&&(w=m),w>g&&(w=g),w}function intInRange$1(d,m,g){return d>g&&(d=g),d<m&&(d=m),0|d}function inRange0to255Rounded$1(d){return(d=Math.round(d))>255?d=255:d<0&&(d=0),d}function inRange0to255$1(d){return d>255?d=255:d<0&&(d=0),d}function stableSort$1(d,m){const g=typeof d[0];let w;if(g==="number"||g==="string"){const I=Object.create(null);for(let P=0,F=d.length;P<F;P++){const D=d[P];I[D]||I[D]===0||(I[D]=P)}w=d.sort(((P,F)=>m(P,F)||I[P]-I[F]))}else{const I=d.slice(0);w=d.sort(((P,F)=>m(P,F)||I.indexOf(P)-I.indexOf(F)))}return w}function rgb2hsl$1(d,m,g){const w=min3$1(d,m,g),I=max3$1(d,m,g),P=I-w,F=(w+I)/510;let D=0;F>0&&F<1&&(D=P/(F<.5?I+w:510-I-w));let $=0;return P>0&&($=I===d?(m-g)/P:I===m?2+(g-d)/P:4+(d-m)/P,$*=60,$<0&&($+=360)),{h:$,s:D,l:F}}__export$1(arithmetic_exports$1,{degrees2radians:()=>degrees2radians$1,inRange0to255:()=>inRange0to255$1,inRange0to255Rounded:()=>inRange0to255Rounded$1,intInRange:()=>intInRange$1,max3:()=>max3$1,min3:()=>min3$1,stableSort:()=>stableSort$1});var refX$1=.95047,refY$1=1,refZ$1=1.08883;function pivot$1(d){return d>.008856?d**(1/3):7.787*d+16/116}function xyz2lab$1(d,m,g){if(d=pivot$1(d/refX$1),m=pivot$1(m/refY$1),g=pivot$1(g/refZ$1),116*m-16<0)throw new Error("xxx");return{L:Math.max(0,116*m-16),a:500*(d-m),b:200*(m-g)}}function rgb2lab$1(d,m,g){const w=rgb2xyz$1(d,m,g);return xyz2lab$1(w.x,w.y,w.z)}var refX2$1=.95047,refY2$1=1,refZ2$1=1.08883;function pivot2$1(d){return d>.206893034?d**3:(d-16/116)/7.787}function lab2xyz$1(d,m,g){const w=(d+16)/116,I=w-g/200;return{x:refX2$1*pivot2$1(m/500+w),y:refY2$1*pivot2$1(w),z:refZ2$1*pivot2$1(I)}}function correctGamma2$1(d){return d>.0031308?1.055*d**(1/2.4)-.055:12.92*d}function xyz2rgb$1(d,m,g){const w=correctGamma2$1(3.2406*d+-1.5372*m+-.4986*g),I=correctGamma2$1(-.9689*d+1.8758*m+.0415*g),P=correctGamma2$1(.0557*d+-.204*m+1.057*g);return{r:inRange0to255Rounded$1(255*w),g:inRange0to255Rounded$1(255*I),b:inRange0to255Rounded$1(255*P)}}function lab2rgb$1(d,m,g){const w=lab2xyz$1(d,m,g);return xyz2rgb$1(w.x,w.y,w.z)}var distance_exports$1={};__export$1(distance_exports$1,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator$1,AbstractEuclidean:()=>AbstractEuclidean$1,AbstractManhattan:()=>AbstractManhattan$1,CIE94GraphicArts:()=>CIE94GraphicArts$1,CIE94Textiles:()=>CIE94Textiles$1,CIEDE2000:()=>CIEDE2000$1,CMetric:()=>CMetric$1,Euclidean:()=>Euclidean$1,EuclideanBT709:()=>EuclideanBT709$1,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha$1,Manhattan:()=>Manhattan$1,ManhattanBT709:()=>ManhattanBT709$1,ManhattanNommyde:()=>ManhattanNommyde$1,PNGQuant:()=>PNGQuant$1});var AbstractDistanceCalculator$1=class{constructor(){__publicField$3(this,"_maxDistance"),__publicField$3(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(d,m,g,w){this._whitePoint={r:d>0?255/d:0,g:m>0?255/m:0,b:g>0?255/g:0,a:w>0?255/w:0},this._maxDistance=this.calculateRaw(d,m,g,w,0,0,0,0)}calculateNormalized(d,m){return this.calculateRaw(d.r,d.g,d.b,d.a,m.r,m.g,m.b,m.a)/this._maxDistance}},AbstractCIE94$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const $=rgb2lab$1(inRange0to255$1(d*this._whitePoint.r),inRange0to255$1(m*this._whitePoint.g),inRange0to255$1(g*this._whitePoint.b)),U=rgb2lab$1(inRange0to255$1(I*this._whitePoint.r),inRange0to255$1(P*this._whitePoint.g),inRange0to255$1(F*this._whitePoint.b)),j=$.L-U.L,Z=$.a-U.a,G=$.b-U.b,H=Math.sqrt($.a*$.a+$.b*$.b),W=H-Math.sqrt(U.a*U.a+U.b*U.b);let Q=Z*Z+G*G-W*W;Q=Q<0?0:Math.sqrt(Q);const q=(D-w)*this._whitePoint.a*this._kA;return Math.sqrt((j/this._Kl)**2+(W/(1+this._K1*H))**2+(Q/(1+this._K2*H))**2+q**2)}},CIE94Textiles$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000$1=class extends AbstractDistanceCalculator$1{_setDefaults(){}static _calculatehp(d,m){const g=Math.atan2(d,m);return g>=0?g:g+_CIEDE2000$1._deg360InRad}static _calculateRT(d,m){const g=m**7,w=2*Math.sqrt(g/(g+_CIEDE2000$1._pow25to7)),I=_CIEDE2000$1._deg30InRad*Math.exp(-(((d-_CIEDE2000$1._deg275InRad)/_CIEDE2000$1._deg25InRad)**2));return-Math.sin(2*I)*w}static _calculateT(d){return 1-.17*Math.cos(d-_CIEDE2000$1._deg30InRad)+.24*Math.cos(2*d)+.32*Math.cos(3*d+_CIEDE2000$1._deg6InRad)-.2*Math.cos(4*d-_CIEDE2000$1._deg63InRad)}static _calculate_ahp(d,m,g,w){const I=g+w;return d===0?I:m<=_CIEDE2000$1._deg180InRad?I/2:I<_CIEDE2000$1._deg360InRad?(I+_CIEDE2000$1._deg360InRad)/2:(I-_CIEDE2000$1._deg360InRad)/2}static _calculate_dHp(d,m,g,w){let I;return I=d===0?0:m<=_CIEDE2000$1._deg180InRad?g-w:g<=w?g-w+_CIEDE2000$1._deg360InRad:g-w-_CIEDE2000$1._deg360InRad,2*Math.sqrt(d)*Math.sin(I/2)}calculateRaw(d,m,g,w,I,P,F,D){const $=rgb2lab$1(inRange0to255$1(d*this._whitePoint.r),inRange0to255$1(m*this._whitePoint.g),inRange0to255$1(g*this._whitePoint.b)),U=rgb2lab$1(inRange0to255$1(I*this._whitePoint.r),inRange0to255$1(P*this._whitePoint.g),inRange0to255$1(F*this._whitePoint.b)),j=(D-w)*this._whitePoint.a*_CIEDE2000$1._kA,Z=this.calculateRawInLab($,U);return Math.sqrt(Z+j*j)}calculateRawInLab(d,m){const g=d.L,w=d.a,I=d.b,P=m.L,F=m.a,D=m.b,$=((Math.sqrt(w*w+I*I)+Math.sqrt(F*F+D*D))/2)**7,U=.5*(1-Math.sqrt($/($+_CIEDE2000$1._pow25to7))),j=(1+U)*w,Z=(1+U)*F,G=Math.sqrt(j*j+I*I),H=Math.sqrt(Z*Z+D*D),W=G*H,Q=_CIEDE2000$1._calculatehp(I,j),q=_CIEDE2000$1._calculatehp(D,Z),rt=Math.abs(Q-q),et=P-g,X=H-G,J=_CIEDE2000$1._calculate_dHp(W,rt,q,Q),tt=_CIEDE2000$1._calculate_ahp(W,rt,Q,q),st=(G+H)/2,nt=((g+P)/2-50)**2,lt=X/(1+.045*st),at=J/(1+.015*_CIEDE2000$1._calculateT(tt)*st);return(et/(1+.015*nt/Math.sqrt(20+nt)))**2+lt**2+at**2+_CIEDE2000$1._calculateRT(tt,st)*lt*at}},CIEDE2000$1=_CIEDE2000$1;__publicField$3(CIEDE2000$1,"_kA",25/255),__publicField$3(CIEDE2000$1,"_pow25to7",25**7),__publicField$3(CIEDE2000$1,"_deg360InRad",degrees2radians$1(360)),__publicField$3(CIEDE2000$1,"_deg180InRad",degrees2radians$1(180)),__publicField$3(CIEDE2000$1,"_deg30InRad",degrees2radians$1(30)),__publicField$3(CIEDE2000$1,"_deg6InRad",degrees2radians$1(6)),__publicField$3(CIEDE2000$1,"_deg63InRad",degrees2radians$1(63)),__publicField$3(CIEDE2000$1,"_deg275InRad",degrees2radians$1(275)),__publicField$3(CIEDE2000$1,"_deg25InRad",degrees2radians$1(25));var CMetric$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const $=(d+I)/2*this._whitePoint.r,U=(d-I)*this._whitePoint.r,j=(m-P)*this._whitePoint.g,Z=(g-F)*this._whitePoint.b,G=((512+$)*U*U>>8)+4*j*j+((767-$)*Z*Z>>8),H=(D-w)*this._whitePoint.a;return Math.sqrt(G+H*H)}_setDefaults(){}},AbstractEuclidean$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const $=I-d,U=P-m,j=F-g,Z=D-w;return Math.sqrt(this._kR*$*$+this._kG*U*U+this._kB*j*j+this._kA*Z*Z)}},Euclidean$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){let $=I-d,U=P-m,j=F-g,Z=D-w;return $<0&&($=0-$),U<0&&(U=0-U),j<0&&(j=0-j),Z<0&&(Z=0-Z),this._kR*$+this._kG*U+this._kB*j+this._kA*Z}},Manhattan$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const $=(D-w)*this._whitePoint.a;return this._colordifferenceCh(d*this._whitePoint.r,I*this._whitePoint.r,$)+this._colordifferenceCh(m*this._whitePoint.g,P*this._whitePoint.g,$)+this._colordifferenceCh(g*this._whitePoint.b,F*this._whitePoint.b,$)}_colordifferenceCh(d,m,g){const w=d-m,I=w+g;return w*w+I*I}_setDefaults(){}},palette_exports$1={};__export$1(palette_exports$1,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer$1,ColorHistogram:()=>ColorHistogram$1,NeuQuant:()=>NeuQuant$1,NeuQuantFloat:()=>NeuQuantFloat$1,RGBQuant:()=>RGBQuant$1,WuColorCube:()=>WuColorCube$1,WuQuant:()=>WuQuant$1});var AbstractPaletteQuantizer$1=class{quantizeSync(){for(const d of this.quantize())if(d.palette)return d.palette;throw new Error("unreachable")}},Point$1=class{constructor(){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),__publicField$3(this,"uint32"),__publicField$3(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(d){const m=new Point$1;return m.r=0|d[0],m.g=0|d[1],m.b=0|d[2],m.a=0|d[3],m._loadUINT32(),m._loadQuadruplet(),m}static createByRGBA(d,m,g,w){const I=new Point$1;return I.r=0|d,I.g=0|m,I.b=0|g,I.a=0|w,I._loadUINT32(),I._loadQuadruplet(),I}static createByUint32(d){const m=new Point$1;return m.uint32=d>>>0,m._loadRGBA(),m._loadQuadruplet(),m}from(d){this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.uint32=d.uint32,this.rgba[0]=d.r,this.rgba[1]=d.g,this.rgba[2]=d.b,this.rgba[3]=d.a}getLuminosity(d){let m=this.r,g=this.g,w=this.b;return d&&(m=Math.min(255,255-this.a+this.a*m/255),g=Math.min(255,255-this.a+this.a*g/255),w=Math.min(255,255-this.a+this.a*w/255)),.2126*m+.7152*g+.0722*w}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer$1=class{constructor(){__publicField$3(this,"_pointArray"),__publicField$3(this,"_width"),__publicField$3(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(d){this._width=d}setHeight(d){this._height=d}getPointArray(){return this._pointArray}clone(){const d=new PointContainer$1;d._width=this._width,d._height=this._height;for(let m=0,g=this._pointArray.length;m<g;m++)d._pointArray[m]=Point$1.createByUint32(0|this._pointArray[m].uint32);return d}toUint32Array(){const d=this._pointArray.length,m=new Uint32Array(d);for(let g=0;g<d;g++)m[g]=this._pointArray[g].uint32;return m}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(d){const m=d.naturalWidth,g=d.naturalHeight,w=document.createElement("canvas");return w.width=m,w.height=g,w.getContext("2d").drawImage(d,0,0,m,g,0,0,m,g),PointContainer$1.fromHTMLCanvasElement(w)}static fromHTMLCanvasElement(d){const m=d.width,g=d.height,w=d.getContext("2d").getImageData(0,0,m,g);return PointContainer$1.fromImageData(w)}static fromImageData(d){const m=d.width,g=d.height;return PointContainer$1.fromUint8Array(d.data,m,g)}static fromUint8Array(d,m,g){switch(Object.prototype.toString.call(d)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:d=new Uint8Array(d)}const w=new Uint32Array(d.buffer);return PointContainer$1.fromUint32Array(w,m,g)}static fromUint32Array(d,m,g){const w=new PointContainer$1;w._width=m,w._height=g;for(let I=0,P=d.length;I<P;I++)w._pointArray[I]=Point$1.createByUint32(0|d[I]);return w}static fromBuffer(d,m,g){const w=new Uint32Array(d.buffer,d.byteOffset,d.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer$1.fromUint32Array(w,m,g)}},hueGroups$1=10;function hueGroup$1(d,m){const g=360/m;for(let w=1,I=g-g/2;w<m;w++,I+=g)if(d>=I&&d<I+g)return w;return 0}var Palette$1=class{constructor(){__publicField$3(this,"_pointContainer"),__publicField$3(this,"_pointArray",[]),__publicField$3(this,"_i32idx",{}),this._pointContainer=new PointContainer$1,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(d){this._pointArray.push(d),this._pointContainer.setWidth(this._pointArray.length)}has(d){for(let m=this._pointArray.length-1;m>=0;m--)if(d.uint32===this._pointArray[m].uint32)return!0;return!1}getNearestColor(d,m){return this._pointArray[0|this._getNearestIndex(d,m)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(d){return typeof this._i32idx[d]=="number"?this._i32idx[d]:-1}_getNearestIndex(d,m){let g=this._nearestPointFromCache(""+m.uint32);if(g>=0)return g;let w=Number.MAX_VALUE;g=0;for(let I=0,P=this._pointArray.length;I<P;I++){const F=this._pointArray[I],D=d.calculateRaw(m.r,m.g,m.b,m.a,F.r,F.g,F.b,F.a);D<w&&(w=D,g=I)}return this._i32idx[m.uint32]=g,g}sort(){this._i32idx={},this._pointArray.sort(((d,m)=>{const g=rgb2hsl$1(d.r,d.g,d.b),w=rgb2hsl$1(m.r,m.g,m.b),I=d.r===d.g&&d.g===d.b?0:1+hueGroup$1(g.h,hueGroups$1),P=(m.r===m.g&&m.g===m.b?0:1+hueGroup$1(w.h,hueGroups$1))-I;if(P)return-P;const F=d.getLuminosity(!0),D=m.getLuminosity(!0);if(D-F!=0)return D-F;const $=(100*w.s|0)-(100*g.s|0);return $?-$:0}))}},utils_exports$1={};__export$1(utils_exports$1,{HueStatistics:()=>HueStatistics$1,Palette:()=>Palette$1,Point:()=>Point$1,PointContainer:()=>PointContainer$1,ProgressTracker:()=>ProgressTracker$1,arithmetic:()=>arithmetic_exports$1});var HueGroup$1=class{constructor(){__publicField$3(this,"num",0),__publicField$3(this,"cols",[])}},HueStatistics$1=class{constructor(d,m){__publicField$3(this,"_numGroups"),__publicField$3(this,"_minCols"),__publicField$3(this,"_stats"),__publicField$3(this,"_groupsFull"),this._numGroups=d,this._minCols=m,this._stats=[];for(let g=0;g<=d;g++)this._stats[g]=new HueGroup$1;this._groupsFull=0}check(d){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const m=255&d,g=d>>>8&255,w=d>>>16&255,I=m===g&&g===w?0:1+hueGroup$1(rgb2hsl$1(m,g,w).h,this._numGroups),P=this._stats[I],F=this._minCols;P.num++,P.num>F||(P.num===F&&this._groupsFull++,P.num<=F&&this._stats[I].cols.push(d))}injectIntoDictionary(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach((g=>{d[g]?d[g]++:d[g]=1}))}injectIntoArray(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach((g=>{d.indexOf(g)===-1&&d.push(g)}))}},_ProgressTracker$1=class{constructor(d,m){__publicField$3(this,"progress"),__publicField$3(this,"_step"),__publicField$3(this,"_range"),__publicField$3(this,"_last"),__publicField$3(this,"_progressRange"),this._range=d,this._progressRange=m,this._step=Math.max(1,this._range/(_ProgressTracker$1.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(d){return d-this._last>=this._step&&(this._last=d,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker$1=_ProgressTracker$1;__publicField$3(ProgressTracker$1,"steps",100);var networkBiasShift$1=3,Neuron$1=class{constructor(d){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift$1,this.g>>networkBiasShift$1,this.b>>networkBiasShift$1,this.a>>networkBiasShift$1)}subtract(d,m,g,w){this.r-=0|d,this.g-=0|m,this.b-=0|g,this.a-=0|w}},_NeuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new Neuron$1((d<<networkBiasShift$1+8)/this._networkSize|0),this._freq[d]=_NeuQuant$1._initialBias/this._networkSize|0,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuant$1._minpicturebytes&&(d=1);const g=30+(d-1)/3|0,w=m/d|0;let I,P=w/_NeuQuant$1._nCycles|0,F=_NeuQuant$1._initAlpha,D=(this._networkSize>>3)*_NeuQuant$1._radiusBias,$=D>>_NeuQuant$1._radiusBiasShift;$<=1&&($=0);for(let j=0;j<$;j++)this._radPower[j]=F*(($*$-j*j)*_NeuQuant$1._radBias/($*$))>>>0;I=m<_NeuQuant$1._minpicturebytes?1:m%_NeuQuant$1._prime1!=0?_NeuQuant$1._prime1:m%_NeuQuant$1._prime2!=0?_NeuQuant$1._prime2:m%_NeuQuant$1._prime3!=0?_NeuQuant$1._prime3:_NeuQuant$1._prime4;const U=new ProgressTracker$1(w,99);for(let j=0,Z=0;j<w;){U.shouldNotify(j)&&(yield{progress:U.progress});const G=this._pointArray[Z],H=G.b<<networkBiasShift$1,W=G.g<<networkBiasShift$1,Q=G.r<<networkBiasShift$1,q=G.a<<networkBiasShift$1,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),$!==0&&this._alterNeighbour($,rt,H,W,Q,q),Z+=I,Z>=m&&(Z-=m),j++,P===0&&(P=1),j%P==0){F-=F/g|0,D-=D/_NeuQuant$1._radiusDecrease|0,$=D>>_NeuQuant$1._radiusBiasShift,$<=1&&($=0);for(let et=0;et<$;et++)this._radPower[et]=F*(($*$-et*et)*_NeuQuant$1._radBias/($*$))>>>0}}}_buildPalette(){const d=new Palette$1;return this._network.forEach((m=>{d.add(m.toPoint())})),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let $=m+1,U=m-1,j=1;for(;$<D||U>F;){const Z=this._radPower[j++]/_NeuQuant$1._alphaRadBias;if($<D){const G=this._network[$++];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuant$1._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift$1;let P=2147483647,F=P,D=-1,$=D;for(let U=0;U<this._networkSize;U++){const j=this._network[U],Z=this._distance.calculateNormalized(j,{r:g,g:m,b:d,a:w})*I|0;Z<P&&(P=Z,D=U);const G=Z-(this._bias[U]>>_NeuQuant$1._initialBiasShift-networkBiasShift$1);G<F&&(F=G,$=U);const H=this._freq[U]>>_NeuQuant$1._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuant$1._gammaShift}return this._freq[D]+=_NeuQuant$1._beta,this._bias[D]-=_NeuQuant$1._betaGamma,$}},NeuQuant$1=_NeuQuant$1;__publicField$3(NeuQuant$1,"_prime1",499),__publicField$3(NeuQuant$1,"_prime2",491),__publicField$3(NeuQuant$1,"_prime3",487),__publicField$3(NeuQuant$1,"_prime4",503),__publicField$3(NeuQuant$1,"_minpicturebytes",_NeuQuant$1._prime4),__publicField$3(NeuQuant$1,"_nCycles",100),__publicField$3(NeuQuant$1,"_initialBiasShift",16),__publicField$3(NeuQuant$1,"_initialBias",1<<_NeuQuant$1._initialBiasShift),__publicField$3(NeuQuant$1,"_gammaShift",10),__publicField$3(NeuQuant$1,"_betaShift",10),__publicField$3(NeuQuant$1,"_beta",_NeuQuant$1._initialBias>>_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_betaGamma",_NeuQuant$1._initialBias<<_NeuQuant$1._gammaShift-_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_radiusBiasShift",6),__publicField$3(NeuQuant$1,"_radiusBias",1<<_NeuQuant$1._radiusBiasShift),__publicField$3(NeuQuant$1,"_radiusDecrease",30),__publicField$3(NeuQuant$1,"_alphaBiasShift",10),__publicField$3(NeuQuant$1,"_initAlpha",1<<_NeuQuant$1._alphaBiasShift),__publicField$3(NeuQuant$1,"_radBiasShift",8),__publicField$3(NeuQuant$1,"_radBias",1<<_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBiasShift",_NeuQuant$1._alphaBiasShift+_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBias",1<<_NeuQuant$1._alphaRadBiasShift);var networkBiasShift2$1=3,NeuronFloat$1=class{constructor(d){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift2$1,this.g>>networkBiasShift2$1,this.b>>networkBiasShift2$1,this.a>>networkBiasShift2$1)}subtract(d,m,g,w){this.r-=d,this.g-=m,this.b-=g,this.a-=w}},_NeuQuantFloat$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new NeuronFloat$1((d<<networkBiasShift2$1+8)/this._networkSize),this._freq[d]=_NeuQuantFloat$1._initialBias/this._networkSize,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuantFloat$1._minpicturebytes&&(d=1);const g=30+(d-1)/3,w=m/d;let I,P=w/_NeuQuantFloat$1._nCycles|0,F=_NeuQuantFloat$1._initAlpha,D=(this._networkSize>>3)*_NeuQuantFloat$1._radiusBias,$=D>>_NeuQuantFloat$1._radiusBiasShift;$<=1&&($=0);for(let j=0;j<$;j++)this._radPower[j]=F*(($*$-j*j)*_NeuQuantFloat$1._radBias/($*$));I=m<_NeuQuantFloat$1._minpicturebytes?1:m%_NeuQuantFloat$1._prime1!=0?_NeuQuantFloat$1._prime1:m%_NeuQuantFloat$1._prime2!=0?_NeuQuantFloat$1._prime2:m%_NeuQuantFloat$1._prime3!=0?_NeuQuantFloat$1._prime3:_NeuQuantFloat$1._prime4;const U=new ProgressTracker$1(w,99);for(let j=0,Z=0;j<w;){U.shouldNotify(j)&&(yield{progress:U.progress});const G=this._pointArray[Z],H=G.b<<networkBiasShift2$1,W=G.g<<networkBiasShift2$1,Q=G.r<<networkBiasShift2$1,q=G.a<<networkBiasShift2$1,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),$!==0&&this._alterNeighbour($,rt,H,W,Q,q),Z+=I,Z>=m&&(Z-=m),j++,P===0&&(P=1),j%P==0){F-=F/g,D-=D/_NeuQuantFloat$1._radiusDecrease,$=D>>_NeuQuantFloat$1._radiusBiasShift,$<=1&&($=0);for(let et=0;et<$;et++)this._radPower[et]=F*(($*$-et*et)*_NeuQuantFloat$1._radBias/($*$))}}}_buildPalette(){const d=new Palette$1;return this._network.forEach((m=>{d.add(m.toPoint())})),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let $=m+1,U=m-1,j=1;for(;$<D||U>F;){const Z=this._radPower[j++]/_NeuQuantFloat$1._alphaRadBias;if($<D){const G=this._network[$++];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuantFloat$1._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift2$1;let P=2147483647,F=P,D=-1,$=D;for(let U=0;U<this._networkSize;U++){const j=this._network[U],Z=this._distance.calculateNormalized(j,{r:g,g:m,b:d,a:w})*I;Z<P&&(P=Z,D=U);const G=Z-(this._bias[U]>>_NeuQuantFloat$1._initialBiasShift-networkBiasShift2$1);G<F&&(F=G,$=U);const H=this._freq[U]>>_NeuQuantFloat$1._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuantFloat$1._gammaShift}return this._freq[D]+=_NeuQuantFloat$1._beta,this._bias[D]-=_NeuQuantFloat$1._betaGamma,$}},NeuQuantFloat$1=_NeuQuantFloat$1;__publicField$3(NeuQuantFloat$1,"_prime1",499),__publicField$3(NeuQuantFloat$1,"_prime2",491),__publicField$3(NeuQuantFloat$1,"_prime3",487),__publicField$3(NeuQuantFloat$1,"_prime4",503),__publicField$3(NeuQuantFloat$1,"_minpicturebytes",_NeuQuantFloat$1._prime4),__publicField$3(NeuQuantFloat$1,"_nCycles",100),__publicField$3(NeuQuantFloat$1,"_initialBiasShift",16),__publicField$3(NeuQuantFloat$1,"_initialBias",1<<_NeuQuantFloat$1._initialBiasShift),__publicField$3(NeuQuantFloat$1,"_gammaShift",10),__publicField$3(NeuQuantFloat$1,"_betaShift",10),__publicField$3(NeuQuantFloat$1,"_beta",_NeuQuantFloat$1._initialBias>>_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_betaGamma",_NeuQuantFloat$1._initialBias<<_NeuQuantFloat$1._gammaShift-_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_radiusBiasShift",6),__publicField$3(NeuQuantFloat$1,"_radiusBias",1<<_NeuQuantFloat$1._radiusBiasShift),__publicField$3(NeuQuantFloat$1,"_radiusDecrease",30),__publicField$3(NeuQuantFloat$1,"_alphaBiasShift",10),__publicField$3(NeuQuantFloat$1,"_initAlpha",1<<_NeuQuantFloat$1._alphaBiasShift),__publicField$3(NeuQuantFloat$1,"_radBiasShift",8),__publicField$3(NeuQuantFloat$1,"_radBias",1<<_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBiasShift",_NeuQuantFloat$1._alphaBiasShift+_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBias",1<<_NeuQuantFloat$1._alphaRadBiasShift);var _ColorHistogram$1=class{constructor(d,m){__publicField$3(this,"_method"),__publicField$3(this,"_hueStats"),__publicField$3(this,"_histogram"),__publicField$3(this,"_initColors"),__publicField$3(this,"_minHueCols"),this._method=d,this._minHueCols=m<<2,this._initColors=m<<2,this._hueStats=new HueStatistics$1(_ColorHistogram$1._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(d){switch(this._method){case 1:this._colorStats1D(d);break;case 2:this._colorStats2D(d)}}getImportanceSortedColorsIDXI32(){const d=stableSort$1(Object.keys(this._histogram),((g,w)=>this._histogram[w]-this._histogram[g]));if(d.length===0)return[];let m;switch(this._method){case 1:const g=Math.min(d.length,this._initColors),w=d[g-1],I=this._histogram[w];m=d.slice(0,g);let P=g;const F=d.length;for(;P<F&&this._histogram[d[P]]===I;)m.push(d[P++]);this._hueStats.injectIntoArray(m);break;case 2:m=d;break;default:throw new Error("Incorrect method")}return m.map((g=>+g))}_colorStats1D(d){const m=this._histogram,g=d.getPointArray(),w=g.length;for(let I=0;I<w;I++){const P=g[I].uint32;this._hueStats.check(P),P in m?m[P]++:m[P]=1}}_colorStats2D(d){const m=d.getWidth(),g=d.getHeight(),w=d.getPointArray(),I=_ColorHistogram$1._boxSize[0],P=_ColorHistogram$1._boxSize[1],F=I*P,D=this._makeBoxes(m,g,I,P),$=this._histogram;D.forEach((U=>{let j=Math.round(U.w*U.h/F)*_ColorHistogram$1._boxPixels;j<2&&(j=2);const Z={};this._iterateBox(U,m,(G=>{const H=w[G].uint32;this._hueStats.check(H),H in $?$[H]++:H in Z?++Z[H]>=j&&($[H]=Z[H]):Z[H]=1}))})),this._hueStats.injectIntoDictionary($)}_iterateBox(d,m,g){const w=d,I=w.y*m+w.x,P=(w.y+w.h-1)*m+(w.x+w.w-1),F=m-w.w+1;let D=0,$=I;do g.call(this,$),$+=++D%w.w==0?F:1;while($<=P)}_makeBoxes(d,m,g,w){const I=d%g,P=m%w,F=d-I,D=m-P,$=[];for(let U=0;U<m;U+=w)for(let j=0;j<d;j+=g)$.push({x:j,y:U,w:j===F?I:g,h:U===D?P:w});return $}},ColorHistogram$1=_ColorHistogram$1;__publicField$3(ColorHistogram$1,"_boxSize",[64,64]),__publicField$3(ColorHistogram$1,"_boxPixels",2),__publicField$3(ColorHistogram$1,"_hueGroups",10);var RemovedColor$1=class{constructor(d,m,g){__publicField$3(this,"index"),__publicField$3(this,"color"),__publicField$3(this,"distance"),this.index=d,this.color=m,this.distance=g}},RGBQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256,g=2){super(),__publicField$3(this,"_colors"),__publicField$3(this,"_initialDistance"),__publicField$3(this,"_distanceIncrement"),__publicField$3(this,"_histogram"),__publicField$3(this,"_distance"),this._distance=d,this._colors=m,this._histogram=new ColorHistogram$1(g,m),this._initialDistance=.01,this._distanceIncrement=.005}sample(d){this._histogram.sample(d)}*quantize(){const d=this._histogram.getImportanceSortedColorsIDXI32();if(d.length===0)throw new Error("No colors in image");yield*this._buildPalette(d)}*_buildPalette(d){const m=new Palette$1,g=m.getPointContainer().getPointArray(),w=new Array(d.length);for(let j=0;j<d.length;j++)g.push(Point$1.createByUint32(d[j])),w[j]=1;const I=g.length,P=[];let F=I,D=this._initialDistance;const $=new ProgressTracker$1(F-this._colors,99);for(;F>this._colors;){P.length=0;for(let j=0;j<I;j++){if($.shouldNotify(I-F)&&(yield{progress:$.progress}),w[j]===0)continue;const Z=g[j];for(let G=j+1;G<I;G++){if(w[G]===0)continue;const H=g[G],W=this._distance.calculateNormalized(Z,H);W<D&&(P.push(new RemovedColor$1(G,H,W)),w[G]=0,F--)}}D+=F>3*this._colors?this._initialDistance:this._distanceIncrement}if(F<this._colors){stableSort$1(P,((Z,G)=>G.distance-Z.distance));let j=0;for(;F<this._colors&&j<P.length;)w[P[j].index]=1,F++,j++}let U=g.length;for(let j=U-1;j>=0;j--)w[j]===0&&(j!==U-1&&(g[j]=g[U-1]),--U);g.length=U,m.sort(),yield{palette:m,progress:100}}};function createArray1D$1(d){const m=[];for(let g=0;g<d;g++)m[g]=0;return m}function createArray4D$1(d,m,g,w){const I=new Array(d);for(let P=0;P<d;P++){I[P]=new Array(m);for(let F=0;F<m;F++){I[P][F]=new Array(g);for(let D=0;D<g;D++){I[P][F][D]=new Array(w);for(let $=0;$<w;$++)I[P][F][D][$]=0}}}return I}function createArray3D$1(d,m,g){const w=new Array(d);for(let I=0;I<d;I++){w[I]=new Array(m);for(let P=0;P<m;P++){w[I][P]=new Array(g);for(let F=0;F<g;F++)w[I][P][F]=0}}return w}function fillArray3D$1(d,m,g,w,I){for(let P=0;P<m;P++){d[P]=[];for(let F=0;F<g;F++){d[P][F]=[];for(let D=0;D<w;D++)d[P][F][D]=I}}}function fillArray1D$1(d,m,g){for(let w=0;w<m;w++)d[w]=g}var WuColorCube$1=class{constructor(){__publicField$3(this,"redMinimum"),__publicField$3(this,"redMaximum"),__publicField$3(this,"greenMinimum"),__publicField$3(this,"greenMaximum"),__publicField$3(this,"blueMinimum"),__publicField$3(this,"blueMaximum"),__publicField$3(this,"volume"),__publicField$3(this,"alphaMinimum"),__publicField$3(this,"alphaMaximum")}},_WuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256,g=5){super(),__publicField$3(this,"_reds"),__publicField$3(this,"_greens"),__publicField$3(this,"_blues"),__publicField$3(this,"_alphas"),__publicField$3(this,"_sums"),__publicField$3(this,"_weights"),__publicField$3(this,"_momentsRed"),__publicField$3(this,"_momentsGreen"),__publicField$3(this,"_momentsBlue"),__publicField$3(this,"_momentsAlpha"),__publicField$3(this,"_moments"),__publicField$3(this,"_table"),__publicField$3(this,"_pixels"),__publicField$3(this,"_cubes"),__publicField$3(this,"_colors"),__publicField$3(this,"_significantBitsPerChannel"),__publicField$3(this,"_maxSideIndex"),__publicField$3(this,"_alphaMaxSideIndex"),__publicField$3(this,"_sideSize"),__publicField$3(this,"_alphaSideSize"),__publicField$3(this,"_distance"),this._distance=d,this._setQuality(g),this._initialize(m)}sample(d){const m=d.getPointArray();for(let g=0,w=m.length;g<w;g++)this._addColor(m[g]);this._pixels=this._pixels.concat(m)}*quantize(){yield*this._preparePalette();const d=new Palette$1;for(let m=0;m<this._colors;m++)if(this._sums[m]>0){const g=this._sums[m],w=this._reds[m]/g,I=this._greens[m]/g,P=this._blues[m]/g,F=this._alphas[m]/g,D=Point$1.createByRGBA(0|w,0|I,0|P,0|F);d.add(D)}d.sort(),yield{palette:d,progress:100}}*_preparePalette(){yield*this._calculateMoments();let d=0;const m=createArray1D$1(this._colors);for(let F=1;F<this._colors;++F){this._cut(this._cubes[d],this._cubes[F])?(m[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0,m[F]=this._cubes[F].volume>1?this._calculateVariance(this._cubes[F]):0):(m[d]=0,F--),d=0;let D=m[0];for(let $=1;$<=F;++$)m[$]>D&&(D=m[$],d=$);if(D<=0){this._colors=F+1;break}}const g=[],w=[],I=[],P=[];for(let F=0;F<this._colors;++F){const D=_WuQuant$1._volume(this._cubes[F],this._weights);D>0?(g[F]=_WuQuant$1._volume(this._cubes[F],this._momentsRed)/D|0,w[F]=_WuQuant$1._volume(this._cubes[F],this._momentsGreen)/D|0,I[F]=_WuQuant$1._volume(this._cubes[F],this._momentsBlue)/D|0,P[F]=_WuQuant$1._volume(this._cubes[F],this._momentsAlpha)/D|0):(g[F]=0,w[F]=0,I[F]=0,P[F]=0)}this._reds=createArray1D$1(this._colors+1),this._greens=createArray1D$1(this._colors+1),this._blues=createArray1D$1(this._colors+1),this._alphas=createArray1D$1(this._colors+1),this._sums=createArray1D$1(this._colors+1);for(let F=0,D=this._pixels.length;F<D;F++){const $=this._pixels[F];let U=-1,j=Number.MAX_VALUE;for(let Z=0;Z<this._colors;Z++){const G=g[Z],H=w[Z],W=I[Z],Q=P[Z],q=this._distance.calculateRaw(G,H,W,Q,$.r,$.g,$.b,$.a);q<j&&(j=q,U=Z)}this._reds[U]+=$.r,this._greens[U]+=$.g,this._blues[U]+=$.b,this._alphas[U]+=$.a,this._sums[U]++}}_addColor(d){const m=8-this._significantBitsPerChannel,g=1+(d.r>>m),w=1+(d.g>>m),I=1+(d.b>>m),P=1+(d.a>>m);this._weights[P][g][w][I]++,this._momentsRed[P][g][w][I]+=d.r,this._momentsGreen[P][g][w][I]+=d.g,this._momentsBlue[P][g][w][I]+=d.b,this._momentsAlpha[P][g][w][I]+=d.a,this._moments[P][g][w][I]+=this._table[d.r]+this._table[d.g]+this._table[d.b]+this._table[d.a]}*_calculateMoments(){const d=[],m=[],g=[],w=[],I=[],P=[],F=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),D=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),$=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),U=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),j=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),Z=createArray3D$1(this._sideSize,this._sideSize,this._sideSize);let G=0;const H=new ProgressTracker$1(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let W=1;W<=this._alphaMaxSideIndex;++W){fillArray3D$1(F,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(D,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(U,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(j,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(Z,this._sideSize,this._sideSize,this._sideSize,0);for(let Q=1;Q<=this._maxSideIndex;++Q,++G){H.shouldNotify(G)&&(yield{progress:H.progress}),fillArray1D$1(d,this._sideSize,0),fillArray1D$1(m,this._sideSize,0),fillArray1D$1(g,this._sideSize,0),fillArray1D$1(w,this._sideSize,0),fillArray1D$1(I,this._sideSize,0),fillArray1D$1(P,this._sideSize,0);for(let q=1;q<=this._maxSideIndex;++q){let rt=0,et=0,X=0,J=0,tt=0,st=0;for(let nt=1;nt<=this._maxSideIndex;++nt)rt+=this._weights[W][Q][q][nt],et+=this._momentsRed[W][Q][q][nt],X+=this._momentsGreen[W][Q][q][nt],J+=this._momentsBlue[W][Q][q][nt],tt+=this._momentsAlpha[W][Q][q][nt],st+=this._moments[W][Q][q][nt],d[nt]+=rt,m[nt]+=et,g[nt]+=X,w[nt]+=J,I[nt]+=tt,P[nt]+=st,F[Q][q][nt]=F[Q-1][q][nt]+d[nt],D[Q][q][nt]=D[Q-1][q][nt]+m[nt],$[Q][q][nt]=$[Q-1][q][nt]+g[nt],U[Q][q][nt]=U[Q-1][q][nt]+w[nt],j[Q][q][nt]=j[Q-1][q][nt]+I[nt],Z[Q][q][nt]=Z[Q-1][q][nt]+P[nt],this._weights[W][Q][q][nt]=this._weights[W-1][Q][q][nt]+F[Q][q][nt],this._momentsRed[W][Q][q][nt]=this._momentsRed[W-1][Q][q][nt]+D[Q][q][nt],this._momentsGreen[W][Q][q][nt]=this._momentsGreen[W-1][Q][q][nt]+$[Q][q][nt],this._momentsBlue[W][Q][q][nt]=this._momentsBlue[W-1][Q][q][nt]+U[Q][q][nt],this._momentsAlpha[W][Q][q][nt]=this._momentsAlpha[W-1][Q][q][nt]+j[Q][q][nt],this._moments[W][Q][q][nt]=this._moments[W-1][Q][q][nt]+Z[Q][q][nt]}}}}static _volumeFloat(d,m){return m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMaximum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum])}static _volume(d,m){return 0|_WuQuant$1._volumeFloat(d,m)}static _top(d,m,g,w){let I;switch(m){case _WuQuant$1._alpha:I=w[g][d.redMaximum][d.greenMaximum][d.blueMaximum]-w[g][d.redMaximum][d.greenMinimum][d.blueMaximum]-w[g][d.redMinimum][d.greenMaximum][d.blueMaximum]+w[g][d.redMinimum][d.greenMinimum][d.blueMaximum]-(w[g][d.redMaximum][d.greenMaximum][d.blueMinimum]-w[g][d.redMaximum][d.greenMinimum][d.blueMinimum]-w[g][d.redMinimum][d.greenMaximum][d.blueMinimum]+w[g][d.redMinimum][d.greenMinimum][d.blueMinimum]);break;case _WuQuant$1._red:I=w[d.alphaMaximum][g][d.greenMaximum][d.blueMaximum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMaximum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMaximum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMaximum]-(w[d.alphaMaximum][g][d.greenMaximum][d.blueMinimum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMinimum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMinimum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMinimum]);break;case _WuQuant$1._green:I=w[d.alphaMaximum][d.redMaximum][g][d.blueMaximum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMaximum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMaximum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMaximum]-(w[d.alphaMaximum][d.redMaximum][g][d.blueMinimum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMinimum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMinimum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMinimum]);break;case _WuQuant$1._blue:I=w[d.alphaMaximum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMaximum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMaximum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMaximum][d.redMinimum][d.greenMinimum][g]-(w[d.alphaMinimum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMinimum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMinimum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMinimum][d.redMinimum][d.greenMinimum][g]);break;default:throw new Error("impossible")}return 0|I}static _bottom(d,m,g){switch(m){case _WuQuant$1._alpha:return-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._red:return-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._green:return-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._blue:return-g[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);default:return 0}}_calculateVariance(d){const m=_WuQuant$1._volume(d,this._momentsRed),g=_WuQuant$1._volume(d,this._momentsGreen),w=_WuQuant$1._volume(d,this._momentsBlue),I=_WuQuant$1._volume(d,this._momentsAlpha);return _WuQuant$1._volumeFloat(d,this._moments)-(m*m+g*g+w*w+I*I)/_WuQuant$1._volume(d,this._weights)}_maximize(d,m,g,w,I,P,F,D,$){const U=0|_WuQuant$1._bottom(d,m,this._momentsRed),j=0|_WuQuant$1._bottom(d,m,this._momentsGreen),Z=0|_WuQuant$1._bottom(d,m,this._momentsBlue),G=0|_WuQuant$1._bottom(d,m,this._momentsAlpha),H=0|_WuQuant$1._bottom(d,m,this._weights);let W=0,Q=-1;for(let q=g;q<w;++q){let rt=U+_WuQuant$1._top(d,m,q,this._momentsRed),et=j+_WuQuant$1._top(d,m,q,this._momentsGreen),X=Z+_WuQuant$1._top(d,m,q,this._momentsBlue),J=G+_WuQuant$1._top(d,m,q,this._momentsAlpha),tt=H+_WuQuant$1._top(d,m,q,this._weights);if(tt!==0){let st=rt*rt+et*et+X*X+J*J,nt=st/tt;rt=I-rt,et=P-et,X=F-X,J=D-J,tt=$-tt,tt!==0&&(st=rt*rt+et*et+X*X+J*J,nt+=st/tt,nt>W&&(W=nt,Q=q))}}return{max:W,position:Q}}_cut(d,m){let g;const w=_WuQuant$1._volume(d,this._momentsRed),I=_WuQuant$1._volume(d,this._momentsGreen),P=_WuQuant$1._volume(d,this._momentsBlue),F=_WuQuant$1._volume(d,this._momentsAlpha),D=_WuQuant$1._volume(d,this._weights),$=this._maximize(d,_WuQuant$1._red,d.redMinimum+1,d.redMaximum,w,I,P,F,D),U=this._maximize(d,_WuQuant$1._green,d.greenMinimum+1,d.greenMaximum,w,I,P,F,D),j=this._maximize(d,_WuQuant$1._blue,d.blueMinimum+1,d.blueMaximum,w,I,P,F,D),Z=this._maximize(d,_WuQuant$1._alpha,d.alphaMinimum+1,d.alphaMaximum,w,I,P,F,D);if(Z.max>=$.max&&Z.max>=U.max&&Z.max>=j.max){if(g=_WuQuant$1._alpha,Z.position<0)return!1}else g=$.max>=Z.max&&$.max>=U.max&&$.max>=j.max?_WuQuant$1._red:U.max>=Z.max&&U.max>=$.max&&U.max>=j.max?_WuQuant$1._green:_WuQuant$1._blue;switch(m.redMaximum=d.redMaximum,m.greenMaximum=d.greenMaximum,m.blueMaximum=d.blueMaximum,m.alphaMaximum=d.alphaMaximum,g){case _WuQuant$1._red:m.redMinimum=d.redMaximum=$.position,m.greenMinimum=d.greenMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._green:m.greenMinimum=d.greenMaximum=U.position,m.redMinimum=d.redMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._blue:m.blueMinimum=d.blueMaximum=j.position,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._alpha:m.alphaMinimum=d.alphaMaximum=Z.position,m.blueMinimum=d.blueMinimum,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum}return d.volume=(d.redMaximum-d.redMinimum)*(d.greenMaximum-d.greenMinimum)*(d.blueMaximum-d.blueMinimum)*(d.alphaMaximum-d.alphaMinimum),m.volume=(m.redMaximum-m.redMinimum)*(m.greenMaximum-m.greenMinimum)*(m.blueMaximum-m.blueMinimum)*(m.alphaMaximum-m.alphaMinimum),!0}_initialize(d){this._colors=d,this._cubes=[];for(let m=0;m<d;m++)this._cubes[m]=new WuColorCube$1;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let m=0;m<256;++m)this._table[m]=m*m;this._pixels=[]}_setQuality(d=5){this._significantBitsPerChannel=d,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant$1=_WuQuant$1;__publicField$3(WuQuant$1,"_alpha",3),__publicField$3(WuQuant$1,"_red",2),__publicField$3(WuQuant$1,"_green",1),__publicField$3(WuQuant$1,"_blue",0);var image_exports$1={};__export$1(image_exports$1,{AbstractImageQuantizer:()=>AbstractImageQuantizer$1,ErrorDiffusionArray:()=>ErrorDiffusionArray$1,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel$1,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma$1,NearestColor:()=>NearestColor$1});var AbstractImageQuantizer$1=class{quantizeSync(d,m){for(const g of this.quantize(d,m))if(g.pointContainer)return g.pointContainer;throw new Error("unreachable")}},NearestColor$1=class extends AbstractImageQuantizer$1{constructor(d){super(),__publicField$3(this,"_distance"),this._distance=d}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=new ProgressTracker$1(I,99);for(let F=0;F<I;F++){P.shouldNotify(F)&&(yield{progress:P.progress});for(let D=0,$=F*w;D<w;D++,$++){const U=g[$];U.from(m.getNearestColor(this._distance,U))}}yield{pointContainer:d,progress:100}}},ErrorDiffusionArrayKernel$1=(d=>(d[d.FloydSteinberg=0]="FloydSteinberg",d[d.FalseFloydSteinberg=1]="FalseFloydSteinberg",d[d.Stucki=2]="Stucki",d[d.Atkinson=3]="Atkinson",d[d.Jarvis=4]="Jarvis",d[d.Burkes=5]="Burkes",d[d.Sierra=6]="Sierra",d[d.TwoSierra=7]="TwoSierra",d[d.SierraLite=8]="SierraLite",d))(ErrorDiffusionArrayKernel$1||{}),ErrorDiffusionArray$1=class extends AbstractImageQuantizer$1{constructor(d,m,g=!0,w=0,I=!1){super(),__publicField$3(this,"_minColorDistance"),__publicField$3(this,"_serpentine"),__publicField$3(this,"_kernel"),__publicField$3(this,"_calculateErrorLikeGIMP"),__publicField$3(this,"_distance"),this._setKernel(m),this._distance=d,this._minColorDistance=w,this._serpentine=g,this._calculateErrorLikeGIMP=I}*quantize(d,m){const g=d.getPointArray(),w=new Point$1,I=d.getWidth(),P=d.getHeight(),F=[];let D=1,$=1;for(const j of this._kernel){const Z=j[2]+1;$<Z&&($=Z)}for(let j=0;j<$;j++)this._fillErrorLine(F[j]=[],I);const U=new ProgressTracker$1(P,99);for(let j=0;j<P;j++){U.shouldNotify(j)&&(yield{progress:U.progress}),this._serpentine&&(D*=-1);const Z=j*I,G=D===1?0:I-1,H=D===1?I:-1;this._fillErrorLine(F[0],I),F.push(F.shift());const W=F[0];for(let Q=G,q=Z+G;Q!==H;Q+=D,q+=D){const rt=g[q],et=W[Q];w.from(rt);const X=Point$1.createByRGBA(inRange0to255Rounded$1(rt.r+et[0]),inRange0to255Rounded$1(rt.g+et[1]),inRange0to255Rounded$1(rt.b+et[2]),inRange0to255Rounded$1(rt.a+et[3])),J=m.getNearestColor(this._distance,X);if(rt.from(J),this._minColorDistance&&this._distance.calculateNormalized(w,J)<this._minColorDistance)continue;let tt,st,nt,lt;this._calculateErrorLikeGIMP?(tt=X.r-J.r,st=X.g-J.g,nt=X.b-J.b,lt=X.a-J.a):(tt=w.r-J.r,st=w.g-J.g,nt=w.b-J.b,lt=w.a-J.a);const at=D===1?0:this._kernel.length-1,ct=D===1?this._kernel.length:-1;for(let V=at;V!==ct;V+=D){const ut=this._kernel[V][1]*D,wt=this._kernel[V][2];if(ut+Q>=0&&ut+Q<I&&wt+j>=0&&wt+j<P){const dt=this._kernel[V][0],ft=F[wt][ut+Q];ft[0]+=tt*dt,ft[1]+=st*dt,ft[2]+=nt*dt,ft[3]+=lt*dt}}}}yield{pointContainer:d,progress:100}}_fillErrorLine(d,m){d.length>m&&(d.length=m);const g=d.length;for(let w=0;w<g;w++){const I=d[w];I[0]=I[1]=I[2]=I[3]=0}for(let w=g;w<m;w++)d[w]=[0,0,0,0]}_setKernel(d){switch(d){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${d}`)}}};function*hilbertCurve$1(d,m,g){const w=Math.max(d,m),I={width:d,height:m,level:Math.floor(Math.log(w)/Math.log(2)+1),callback:g,tracker:new ProgressTracker$1(d*m,99),index:0,x:0,y:0};yield*walkHilbert$1(I,1),visit$1(I,0)}function*walkHilbert$1(d,m){if(!(d.level<1)){switch(d.tracker.shouldNotify(d.index)&&(yield{progress:d.tracker.progress}),d.level--,m){case 2:yield*walkHilbert$1(d,1),visit$1(d,3),yield*walkHilbert$1(d,2),visit$1(d,4),yield*walkHilbert$1(d,2),visit$1(d,2),yield*walkHilbert$1(d,4);break;case 3:yield*walkHilbert$1(d,4),visit$1(d,2),yield*walkHilbert$1(d,3),visit$1(d,1),yield*walkHilbert$1(d,3),visit$1(d,3),yield*walkHilbert$1(d,1);break;case 1:yield*walkHilbert$1(d,2),visit$1(d,4),yield*walkHilbert$1(d,1),visit$1(d,3),yield*walkHilbert$1(d,1),visit$1(d,1),yield*walkHilbert$1(d,3);break;case 4:yield*walkHilbert$1(d,3),visit$1(d,1),yield*walkHilbert$1(d,4),visit$1(d,2),yield*walkHilbert$1(d,4),visit$1(d,4),yield*walkHilbert$1(d,2)}d.level++}}function visit$1(d,m){switch(d.x>=0&&d.x<d.width&&d.y>=0&&d.y<d.height&&(d.callback(d.x,d.y),d.index++),m){case 2:d.x--;break;case 3:d.x++;break;case 1:d.y--;break;case 4:d.y++}}var ErrorDiffusionRiemersma$1=class extends AbstractImageQuantizer$1{constructor(d,m=16,g=1){super(),__publicField$3(this,"_distance"),__publicField$3(this,"_weights"),__publicField$3(this,"_errorQueueSize"),this._distance=d,this._errorQueueSize=m,this._weights=ErrorDiffusionRiemersma$1._createWeights(g,m)}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=[];let F=0;for(let D=0;D<this._errorQueueSize;D++)P[D]={r:0,g:0,b:0,a:0};yield*hilbertCurve$1(w,I,((D,$)=>{const U=g[D+$*w];let{r:j,g:Z,b:G,a:H}=U;for(let rt=0;rt<this._errorQueueSize;rt++){const et=this._weights[rt],X=P[(rt+F)%this._errorQueueSize];j+=X.r*et,Z+=X.g*et,G+=X.b*et,H+=X.a*et}const W=Point$1.createByRGBA(inRange0to255Rounded$1(j),inRange0to255Rounded$1(Z),inRange0to255Rounded$1(G),inRange0to255Rounded$1(H)),Q=m.getNearestColor(this._distance,W);F=(F+1)%this._errorQueueSize;const q=(F+this._errorQueueSize-1)%this._errorQueueSize;P[q].r=U.r-Q.r,P[q].g=U.g-Q.g,P[q].b=U.b-Q.b,P[q].a=U.a-Q.a,U.from(Q)})),yield{pointContainer:d,progress:100}}static _createWeights(d,m){const g=[],w=Math.exp(Math.log(m)/(m-1));for(let I=0,P=1;I<m;I++)g[I]=(P+.5|0)/m*d,P*=w;return g}},quality_exports$1={};__export$1(quality_exports$1,{ssim:()=>ssim$1});var K1$1=.01,K2$1=.03;function ssim$1(d,m){if(d.getHeight()!==m.getHeight()||d.getWidth()!==m.getWidth())throw new Error("Images have different sizes!");const g=(255*K1$1)**2,w=(255*K2$1)**2;let I=0,P=0;return iterate$1(d,m,((F,D,$,U)=>{let j=0,Z=0,G=0;for(let W=0;W<F.length;W++)Z+=(F[W]-$)**2,G+=(D[W]-U)**2,j+=(F[W]-$)*(D[W]-U);const H=F.length-1;Z/=H,G/=H,j/=H,P+=(2*$*U+g)*(2*j+w)/(($**2+U**2+g)*(Z+G+w)),I++})),P/I}function iterate$1(d,m,g){const w=d.getWidth(),I=d.getHeight();for(let P=0;P<I;P+=8)for(let F=0;F<w;F+=8){const D=Math.min(8,w-F),$=Math.min(8,I-P),U=calculateLumaValuesForWindow$1(d,F,P,D,$),j=calculateLumaValuesForWindow$1(m,F,P,D,$);g(U,j,calculateAverageLuma$1(U),calculateAverageLuma$1(j))}}function calculateLumaValuesForWindow$1(d,m,g,w,I){const P=d.getPointArray(),F=[];let D=0;for(let $=g;$<g+I;$++){const U=$*d.getWidth();for(let j=m;j<m+w;j++){const Z=P[U+j];F[D]=.2126*Z.r+.7152*Z.g+.0722*Z.b,D++}}return F}function calculateAverageLuma$1(d){let m=0;for(const g of d)m+=g;return m/d.length}var setImmediateImpl=typeof setImmediate=="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)=="function"?d=>process.nextTick(d):d=>setTimeout(d,0);function buildPaletteSync$1(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w}={}){const I=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(m),g,w);return d.forEach((P=>I.sample(P))),I.quantizeSync()}async function buildPalette(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w,onProgress:I}={}){return new Promise(((P,F)=>{const D=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(m),g,w);let $;d.forEach((Z=>D.sample(Z)));const U=D.quantize(),j=()=>{try{const Z=U.next();Z.done?P($):(Z.value.palette&&($=Z.value.palette),I&&I(Z.value.progress),setImmediateImpl(j))}catch(Z){F(Z)}};setImmediateImpl(j)}))}function applyPaletteSync$1(d,m,{colorDistanceFormula:g,imageQuantization:w}={}){return imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(g),w).quantizeSync(d,m)}async function applyPalette(d,m,{colorDistanceFormula:g,imageQuantization:w,onProgress:I}={}){return new Promise(((P,F)=>{let D;const $=imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(g),w).quantize(d,m),U=()=>{try{const j=$.next();j.done?P(D):(j.value.pointContainer&&(D=j.value.pointContainer),I&&I(j.value.progress),setImmediateImpl(U))}catch(j){F(j)}};setImmediateImpl(U)}))}function colorDistanceFormulaToColorDistance$1(d="euclidean-bt709"){switch(d){case"cie94-graphic-arts":return new CIE94GraphicArts$1;case"cie94-textiles":return new CIE94Textiles$1;case"ciede2000":return new CIEDE2000$1;case"color-metric":return new CMetric$1;case"euclidean":return new Euclidean$1;case"euclidean-bt709":return new EuclideanBT709$1;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha$1;case"manhattan":return new Manhattan$1;case"manhattan-bt709":return new ManhattanBT709$1;case"manhattan-nommyde":return new ManhattanNommyde$1;case"pngquant":return new PNGQuant$1;default:throw new Error(`Unknown colorDistanceFormula ${d}`)}}function imageQuantizationToImageQuantizer$1(d,m="floyd-steinberg"){switch(m){case"nearest":return new NearestColor$1(d);case"riemersma":return new ErrorDiffusionRiemersma$1(d);case"floyd-steinberg":return new ErrorDiffusionArray$1(d,0);case"false-floyd-steinberg":return new ErrorDiffusionArray$1(d,1);case"stucki":return new ErrorDiffusionArray$1(d,2);case"atkinson":return new ErrorDiffusionArray$1(d,3);case"jarvis":return new ErrorDiffusionArray$1(d,4);case"burkes":return new ErrorDiffusionArray$1(d,5);case"sierra":return new ErrorDiffusionArray$1(d,6);case"two-sierra":return new ErrorDiffusionArray$1(d,7);case"sierra-lite":return new ErrorDiffusionArray$1(d,8);default:throw new Error(`Unknown imageQuantization ${m}`)}}function paletteQuantizationToPaletteQuantizer$1(d,m="wuquant",g=256){switch(m){case"neuquant":return new NeuQuant$1(d,g);case"rgbquant":return new RGBQuant$1(d,g);case"wuquant":return new WuQuant$1(d,g);case"neuquant-float":return new NeuQuantFloat$1(d,g);default:throw new Error(`Unknown paletteQuantization ${m}`)}}var imageQ=__toCommonJS(src_exports),gifframe={};const BitmapImage$1=bitmapimage;let GifFrame$1=class Ie extends BitmapImage$1{constructor(...m){if(super(...m),m[0]instanceof Ie){const g=m[0];this.xOffset=g.xOffset,this.yOffset=g.yOffset,this.disposalMethod=g.disposalMethod,this.delayCentisecs=g.delayCentisecs,this.interlaced=g.interlaced}else{const g=m[m.length-1];let w={};typeof g!="object"||g instanceof BitmapImage$1||(w=g),this.xOffset=w.xOffset||0,this.yOffset=w.yOffset||0,this.disposalMethod=w.disposalMethod!==void 0?w.disposalMethod:Ie.DisposeToBackgroundColor,this.delayCentisecs=w.delayCentisecs||8,this.interlaced=w.interlaced||!1}}getPalette(){const m=new Set,g=this.bitmap.data;let w=0,I=!1;for(;w<g.length;){if(g[w+3]===0)I=!0;else{const $=g.readUInt32BE(w,!0)>>8&16777215;m.add($)}w+=4}const P=new Array(m.size),F=m.values();for(w=0;w<P.length;++w)P[w]=F.next().value;P.sort((($,U)=>$-U));let D=P.length;return I&&++D,{colors:P,usesTransparency:I,indexCount:D}}};var hasRequiredGifutil,hasRequiredGifcodec;function requireGifutil(){return hasRequiredGifutil||(hasRequiredGifutil=1,(function(d){const m=require$$0,g=imageQ,w=bitmapimage,{GifFrame:I}=gifframe,{GifError:P}=gif$1,{GifCodec:F}=requireGifcodec(),D=[".jpg",".jpeg",".png",".bmp"],$=new F;function U(j,Z,G,H,W){const Q=Array.isArray(j)?j:[j];if(W){if(["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"].indexOf(W.ditherAlgorithm)<0)throw new Error(`Invalid ditherAlgorithm '${W.ditherAlgorithm}'`);W.serpentine===void 0&&(W.serpentine=!0),W.minimumColorDistanceToDither===void 0&&(W.minimumColorDistanceToDither=0),W.calculateErrorLikeGIMP===void 0&&(W.calculateErrorLikeGIMP=!1)}const q=new g.distance.Euclidean,rt=new g.palette[Z](q,G,H);let et;et=W?new g.image.ErrorDiffusionArray(q,g.image.ErrorDiffusionArrayKernel[W.ditherAlgorithm],W.serpentine,W.minimumColorDistanceToDither,W.calculateErrorLikeGIMP):new g.image.NearestColor(q);const X=[];Q.forEach((tt=>{const st=tt.bitmap.data,nt=new ArrayBuffer(st.length),lt=new Uint32Array(nt);for(let ct=0,V=0;ct<st.length;ct+=4,++V)lt[V]=st.readUInt32LE(ct,!0);const at=g.utils.PointContainer.fromUint32Array(lt,tt.bitmap.width,tt.bitmap.height);rt.sample(at),X.push(at)}));const J=rt.quantizeSync();for(let tt=0;tt<Q.length;++tt){const st=Q[tt].bitmap.data,nt=et.quantizeSync(X[tt],J).toUint32Array();for(let lt=0,at=0;lt<st.length;lt+=4,++at)st.writeUInt32LE(nt[at],lt)}}d.cloneFrames=function(j){let Z=[];return j.forEach((G=>{Z.push(new I(G))})),Z},d.getColorInfo=function(j,Z){let G=!1;const H=[];for(let et=0;et<j.length;++et){let X=j[et].getPalette();if(X.usesTransparency&&(G=!0),X.indexCount>256)throw new P(`Frame ${et} uses more than 256 color indexes`);H.push(X)}if(Z===0)return{usesTransparency:G,palettes:H};const W=new Set;H.forEach((et=>{et.colors.forEach((X=>{W.add(X)}))}));let Q=W.size;if(G&&++Q,Z&&Q>Z)return{usesTransparency:G,palettes:H};const q=new Array(W.size),rt=W.values();for(let et=0;et<q.length;++et)q[et]=rt.next().value;return q.sort(((et,X)=>et-X)),{colors:q,indexCount:Q,usesTransparency:G,palettes:H}},d.copyAsJimp=function(j,Z){return d.shareAsJimp(j,new w(Z))},d.getMaxDimensions=function(j){let Z=0,G=0;return j.forEach((H=>{const W=H.xOffset+H.bitmap.width;W>Z&&(Z=W);const Q=H.yOffset+H.bitmap.height;Q>G&&(G=Q)})),{maxWidth:Z,maxHeight:G}},d.quantizeDekker=function(j,Z,G){U(j,"NeuQuantFloat",Z=Z||256,0,G)},d.quantizeSorokin=function(j,Z,G,H){let W;switch(Z=Z||256,G=G||"min-pop"){case"min-pop":W=2;break;case"top-pop":W=1;break;default:throw new Error(`Invalid quantizeSorokin histogram '${G}'`)}U(j,"RGBQuant",Z,W,H)},d.quantizeWu=function(j,Z,G,H){if(Z=Z||256,(G=G||5)<1||G>8)throw new Error("Invalid quantization quality");U(j,"WuQuant",Z,G,H)},d.read=function(j,Z){return Z=Z||$,Buffer.isBuffer(j)?Z.decodeGif(j):(function(G){return new Promise(((H,W)=>{m.readFile(G,((Q,q)=>Q?W(Q):H(q)))}))})(j).then((G=>Z.decodeGif(G)))},d.shareAsJimp=function(j,Z){const G=new j(Z.bitmap.width,Z.bitmap.height,0);return G.bitmap.data=Z.bitmap.data,G},d.write=function(j,Z,G,H){H=H||$;const W=j.match(/\.[a-zA-Z]+$/);if(W!==null&&D.includes(W[0].toLowerCase()))throw new Error(`GIF '${j}' has an unexpected suffix`);return H.encodeGif(Z,G).then((Q=>(function(q,rt){return new Promise(((et,X)=>{m.writeFile(q,rt,(J=>J?X(J):et()))}))})(j,Q.buffer).then((()=>Q))))}})(gifutil)),gifutil}function requireGifcodec(){if(hasRequiredGifcodec)return gifcodec;hasRequiredGifcodec=1;const d=omggif,{Gif:m,GifError:g}=gif$1;function w(){const Z=requireGifutil();return w=function(){return Z},Z}const{GifFrame:I}=gifframe;function P(Z,G){const H=Z.indexOf(G);return H===-1?null:H}function F(Z,G){for(var H,W=0,Q=Z.length-1;W<=Q;)if(Z[H=Math.floor((W+Q)/2)]>G)Q=H-1;else{if(!(Z[H]<G))return H;W=H+1}return null}function D(Z){const G=Z.colors;Z.usesTransparency&&G.push(0);const H=G.length;let W=2;for(;H>W;)W<<=1;G.length=W,G.fill(0,H)}function $(Z,G){let H=Z.bitmap.width*Z.bitmap.height;return H=Math.ceil(H*G/8),H+=Math.ceil(H/255),100+H+768}function U(Z){let G=Z.indexCount,H=0;for(--G;G;)++H,G>>=1;return H>0?H:1}function j(Z,G,H,W,Q){if(H.interlaced)throw new g("writing interlaced GIFs is not supported");const q=(function(et,X,J){const tt=J.colors,st=tt.length<=8?P:F,nt=X.bitmap.data,lt=new Buffer(nt.length/4);let at=tt.length,ct=0,V=0;for(;ct<nt.length;){if(nt[ct+3]!==0){const ut=nt.readUInt32BE(ct,!0)>>8&16777215;lt[V]=st(tt,ut)}else lt[V]=at;ct+=4,++V}if(J.usesTransparency){if(at===256)throw new g(`Frame ${et} already has 256 colorsand so can't use transparency`)}else at=null;return{buffer:lt,transparentIndex:at}})(G,H,W),rt={delay:H.delayCentisecs,disposal:H.disposalMethod,transparent:q.transparentIndex};Q&&(D(W),rt.palette=W.colors);try{let et,X=Z.getOutputBuffer(),J=Z.getOutputBufferPosition(),tt=!0;for(;tt;)if(et=Z.addFrame(H.xOffset,H.yOffset,H.bitmap.width,H.bitmap.height,q.buffer,rt),tt=!1,et>=X.length-1){const st=new Buffer(1.5*X.length);X.copy(st),Z.setOutputBuffer(st),Z.setOutputBufferPosition(J),X=st,tt=!0}return X}catch(et){throw new g(et)}}return gifcodec.GifCodec=class{constructor(Z={}){this._transparentRGB=null,typeof Z.transparentRGB=="number"&&Z.transparentRGB!==0&&(this._transparentRGBA=256*Z.transparentRGB),this._testInitialBufferSize=0}decodeGif(Z){try{let G;try{G=new d.GifReader(Z)}catch(q){throw new g(q)}const H=G.numFrames(),W=[],Q={width:G.width,height:G.height,loops:G.loopCount(),usesTransparency:!1};for(let q=0;q<H;++q){const rt=this._decodeFrame(G,q,Q.usesTransparency);W.push(rt.frame),rt.usesTransparency&&(Q.usesTransparency=!0)}return Promise.resolve(new m(Z,W,Q))}catch(G){return Promise.reject(G)}}encodeGif(Z,G={}){try{if(Z===null||Z.length===0)throw new g("there are no frames");const H=w().getMaxDimensions(Z);return(G=Object.assign({},G)).width=H.maxWidth,G.height=H.maxHeight,G.loops===void 0&&(G.loops=0),G.colorScope=G.colorScope||m.GlobalColorsPreferred,Promise.resolve(this._encodeGif(Z,G))}catch(H){return Promise.reject(H)}}_decodeFrame(Z,G,H){let W,Q;try{if(W=Z.frameInfo(G),Q=new Buffer(Z.width*Z.height*4),Z.decodeAndBlitFrameRGBA(G,Q),W.width!==Z.width||W.height!==Z.height){if(W.y&&(Q=Q.slice(W.y*Z.width*4)),Z.width>W.width)for(let rt=0;rt<W.height;++rt)Q.copy(Q,rt*W.width*4,4*(W.x+rt*Z.width),4*(W.x+rt*Z.width)+4*W.width);Q=Q.slice(0,W.width*W.height*4)}}catch(rt){throw new g(rt)}let q=!1;if(this._transparentRGBA===null){if(!H)for(let rt=3;rt<Q.length;rt+=4)Q[rt]===0&&(q=!0,rt=Q.length)}else for(let rt=3;rt<Q.length;rt+=4)Q[rt]===0&&(Q.writeUInt32BE(this._transparentRGBA,rt-3),q=!0);return{frame:new I(W.width,W.height,Q,{xOffset:W.x,yOffset:W.y,disposalMethod:W.disposal,interlaced:W.interlaced,delayCentisecs:W.delay}),usesTransparency:q}}_encodeGif(Z,G){let H;if(G.colorScope===m.LocalColorsOnly)H=w().getColorInfo(Z,0);else if(H=w().getColorInfo(Z,256),!H.colors){if(G.colorScope===m.GlobalColorsOnly)throw new g("Too many color indexes for global color table");G.colorScope=m.LocalColorsOnly}G.usesTransparency=H.usesTransparency;const W=H.palettes;return G.colorScope===m.LocalColorsOnly?(function(Q,q,rt,et){const X={loop:q.loops};let J,tt=new Buffer(rt);try{J=new d.GifWriter(tt,q.width,q.height,X)}catch(st){throw new g(st)}for(let st=0;st<Q.length;++st)tt=j(J,st,Q[st],et[st],!0);return new m(tt.slice(0,J.end()),Q,q)})(Z,G,2e3,W):(function(Q,q,rt,et){const X={colors:et.colors.slice(),usesTransparency:et.usesTransparency};D(X);const J={palette:X.colors,loop:q.loops};let tt,st=new Buffer(rt);try{tt=new d.GifWriter(st,q.width,q.height,J)}catch(nt){throw new g(nt)}for(let nt=0;nt<Q.length;++nt)st=j(tt,nt,Q[nt],et,!1);return new m(st.slice(0,tt.end()),Q,q)})(Z,G,2e3,H)}_getSizeEstimateGlobal(Z,G){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let H=968;const W=U(Z);return G.forEach((Q=>{H+=$(Q,W)})),H}_getSizeEstimateLocal(Z,G){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let H=200;for(let W=0;W<G.length;++W){const Q=U(Z[W]);H+=$(G[W],Q)}return H}},gifcodec}GifFrame$1.DisposeToAnything=0,GifFrame$1.DisposeNothing=1,GifFrame$1.DisposeToBackgroundColor=2,GifFrame$1.DisposeToPrevious=3,gifframe.GifFrame=GifFrame$1;const BitmapImage=bitmapimage,{GifCodec}=requireGifcodec(),{GifFrame}=gifframe,GifUtil=requireGifutil();var src={BitmapImage,GifCodec,GifFrame,GifUtil};function gif(){return{mime:"image/gif",encode:async d=>{const m=new src.BitmapImage(d);src.GifUtil.quantizeDekker(m,256);const g=new src.GifFrame(d);return(await new src.GifCodec().encodeGif([g],{})).buffer},decode:d=>{const m=new omggif.GifReader(d),g=Buffer.alloc(m.width*m.height*4);return m.decodeAndBlitFrameRGBA(0,g),{data:g,width:m.width,height:m.height}}}}var encoder={exports:{}};(function(d){function m(g){var w,I,P,F,D,$=Math.floor,U=new Array(64),j=new Array(64),Z=new Array(64),G=new Array(64),H=new Array(65535),W=new Array(65535),Q=new Array(64),q=new Array(64),rt=[],et=0,X=7,J=new Array(64),tt=new Array(64),st=new Array(64),nt=new Array(256),lt=new Array(2048),at=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ct=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],ut=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],wt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],dt=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ft=[0,1,2,3,4,5,6,7,8,9,10,11],pt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Pt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function It(Rt,St){for(var At=0,Nt=0,Ut=new Array,jt=1;jt<=16;jt++){for(var Tt=1;Tt<=Rt[jt];Tt++)Ut[St[Nt]]=[],Ut[St[Nt]][0]=At,Ut[St[Nt]][1]=jt,Nt++,At++;At*=2}return Ut}function xt(Rt){for(var St=Rt[0],At=Rt[1]-1;At>=0;)St&1<<At&&(et|=1<<X),At--,--X<0&&(et==255?(Ft(255),Ft(0)):Ft(et),X=7,et=0)}function Ft(Rt){rt.push(Rt)}function Et(Rt){Ft(Rt>>8&255),Ft(255&Rt)}function Ct(Rt,St,At,Nt,Ut){for(var jt,Tt=Ut[0],it=Ut[240],Mt=(function(yt,$t){var Zt,Kt,te,Vt,ee,Xt,oe,ne,ae,he,ie=0;for(ae=0;ae<8;++ae){Zt=yt[ie],Kt=yt[ie+1],te=yt[ie+2],Vt=yt[ie+3],ee=yt[ie+4],Xt=yt[ie+5],oe=yt[ie+6];var zt=Zt+(ne=yt[ie+7]),Jt=Zt-ne,Lt=Kt+oe,Qt=Kt-oe,kt=te+Xt,Yt=te-Xt,ue=Vt+ee,ht=Vt-ee,qt=zt+ue,Gt=zt-ue,Dt=Lt+kt,Ht=Lt-kt;yt[ie]=qt+Dt,yt[ie+4]=qt-Dt;var Wt=.707106781*(Ht+Gt);yt[ie+2]=Gt+Wt,yt[ie+6]=Gt-Wt;var le=.382683433*((qt=ht+Yt)-(Ht=Qt+Jt)),re=.5411961*qt+le,se=1.306562965*Ht+le,ce=.707106781*(Dt=Yt+Qt),ve=Jt+ce,fe=Jt-ce;yt[ie+5]=fe+re,yt[ie+3]=fe-re,yt[ie+1]=ve+se,yt[ie+7]=ve-se,ie+=8}for(ie=0,ae=0;ae<8;++ae){Zt=yt[ie],Kt=yt[ie+8],te=yt[ie+16],Vt=yt[ie+24],ee=yt[ie+32],Xt=yt[ie+40],oe=yt[ie+48];var de=Zt+(ne=yt[ie+56]),_e=Zt-ne,ge=Kt+oe,Ee=Kt-oe,ke=te+Xt,pe=te-Xt,ye=Vt+ee,xe=Vt-ee,we=de+ye,be=de-ye,me=ge+ke,Se=ge-ke;yt[ie]=we+me,yt[ie+32]=we-me;var Ae=.707106781*(Se+be);yt[ie+16]=be+Ae,yt[ie+48]=be-Ae;var Te=.382683433*((we=xe+pe)-(Se=Ee+_e)),Pe=.5411961*we+Te,Ce=1.306562965*Se+Te,Re=.707106781*(me=pe+Ee),Be=_e+Re,ze=_e-Re;yt[ie+40]=ze+Pe,yt[ie+24]=ze-Pe,yt[ie+8]=Be+Ce,yt[ie+56]=Be-Ce,ie++}for(ae=0;ae<64;++ae)he=yt[ae]*$t[ae],Q[ae]=he>0?he+.5|0:he-.5|0;return Q})(Rt,St),mt=0;mt<64;++mt)q[at[mt]]=Mt[mt];var gt=q[0]-At;At=q[0],gt==0?xt(Nt[0]):(xt(Nt[W[jt=32767+gt]]),xt(H[jt]));for(var _t=63;_t>0&&q[_t]==0;_t--);if(_t==0)return xt(Tt),At;for(var vt,Bt=1;Bt<=_t;){for(var K=Bt;q[Bt]==0&&Bt<=_t;++Bt);var ot=Bt-K;if(ot>=16){vt=ot>>4;for(var bt=1;bt<=vt;++bt)xt(it);ot&=15}jt=32767+q[Bt],xt(Ut[(ot<<4)+W[jt]]),xt(H[jt]),Bt++}return _t!=63&&xt(Tt),At}function Ot(Rt){Rt<=0&&(Rt=1),Rt>100&&(Rt=100),D!=Rt&&((function(St){for(var At=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Nt=0;Nt<64;Nt++){var Ut=$((At[Nt]*St+50)/100);Ut<1?Ut=1:Ut>255&&(Ut=255),U[at[Nt]]=Ut}for(var jt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Tt=0;Tt<64;Tt++){var it=$((jt[Tt]*St+50)/100);it<1?it=1:it>255&&(it=255),j[at[Tt]]=it}for(var Mt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],mt=0,gt=0;gt<8;gt++)for(var _t=0;_t<8;_t++)Z[mt]=1/(U[at[mt]]*Mt[gt]*Mt[_t]*8),G[mt]=1/(j[at[mt]]*Mt[gt]*Mt[_t]*8),mt++})(Rt<50?Math.floor(5e3/Rt):Math.floor(200-2*Rt)),D=Rt)}this.encode=function(Rt,St){var At;new Date().getTime(),St&&Ot(St),rt=new Array,et=0,X=7,Et(65496),Et(65504),Et(16),Ft(74),Ft(70),Ft(73),Ft(70),Ft(0),Ft(1),Ft(1),Ft(0),Et(1),Et(1),Ft(0),Ft(0),(At=Rt.comments)!==void 0&&At.constructor===Array&&At.forEach((te=>{if(typeof te=="string"){Et(65534);var Vt,ee=te.length;for(Et(ee+2),Vt=0;Vt<ee;Vt++)Ft(te.charCodeAt(Vt))}})),(function(te){if(te){Et(65505),te[0]===69&&te[1]===120&&te[2]===105&&te[3]===102?Et(te.length+2):(Et(te.length+5+2),Ft(69),Ft(120),Ft(105),Ft(102),Ft(0));for(var Vt=0;Vt<te.length;Vt++)Ft(te[Vt])}})(Rt.exifBuffer),(function(){Et(65499),Et(132),Ft(0);for(var te=0;te<64;te++)Ft(U[te]);Ft(1);for(var Vt=0;Vt<64;Vt++)Ft(j[Vt])})(),(function(te,Vt){Et(65472),Et(17),Ft(8),Et(Vt),Et(te),Ft(3),Ft(1),Ft(17),Ft(0),Ft(2),Ft(17),Ft(1),Ft(3),Ft(17),Ft(1)})(Rt.width,Rt.height),(function(){Et(65476),Et(418),Ft(0);for(var te=0;te<16;te++)Ft(ct[te+1]);for(var Vt=0;Vt<=11;Vt++)Ft(V[Vt]);Ft(16);for(var ee=0;ee<16;ee++)Ft(ut[ee+1]);for(var Xt=0;Xt<=161;Xt++)Ft(wt[Xt]);Ft(1);for(var oe=0;oe<16;oe++)Ft(dt[oe+1]);for(var ne=0;ne<=11;ne++)Ft(ft[ne]);Ft(17);for(var ae=0;ae<16;ae++)Ft(pt[ae+1]);for(var he=0;he<=161;he++)Ft(Pt[he])})(),Et(65498),Et(12),Ft(3),Ft(1),Ft(0),Ft(2),Ft(17),Ft(3),Ft(17),Ft(0),Ft(63),Ft(0);var Nt=0,Ut=0,jt=0;et=0,X=7,this.encode.displayName="_encode_";for(var Tt,it,Mt,mt,gt,_t,vt,Bt,K,ot=Rt.data,bt=Rt.width,yt=Rt.height,$t=4*bt,Zt=0;Zt<yt;){for(Tt=0;Tt<$t;){for(_t=gt=$t*Zt+Tt,vt=-1,Bt=0,K=0;K<64;K++)_t=gt+(Bt=K>>3)*$t+(vt=4*(7&K)),Zt+Bt>=yt&&(_t-=$t*(Zt+1+Bt-yt)),Tt+vt>=$t&&(_t-=Tt+vt-$t+4),it=ot[_t++],Mt=ot[_t++],mt=ot[_t++],J[K]=(lt[it]+lt[Mt+256|0]+lt[mt+512|0]>>16)-128,tt[K]=(lt[it+768|0]+lt[Mt+1024|0]+lt[mt+1280|0]>>16)-128,st[K]=(lt[it+1280|0]+lt[Mt+1536|0]+lt[mt+1792|0]>>16)-128;Nt=Ct(J,Z,Nt,w,P),Ut=Ct(tt,G,Ut,I,F),jt=Ct(st,G,jt,I,F),Tt+=32}Zt+=8}if(X>=0){var Kt=[];Kt[1]=X+1,Kt[0]=(1<<X+1)-1,xt(Kt)}return Et(65497),Buffer.from(rt)},new Date().getTime(),g||(g=50),(function(){for(var Rt=String.fromCharCode,St=0;St<256;St++)nt[St]=Rt(St)})(),w=It(ct,V),I=It(dt,ft),P=It(ut,wt),F=It(pt,Pt),(function(){for(var Rt=1,St=2,At=1;At<=15;At++){for(var Nt=Rt;Nt<St;Nt++)W[32767+Nt]=At,H[32767+Nt]=[],H[32767+Nt][1]=At,H[32767+Nt][0]=Nt;for(var Ut=-(St-1);Ut<=-Rt;Ut++)W[32767+Ut]=At,H[32767+Ut]=[],H[32767+Ut][1]=At,H[32767+Ut][0]=St-1+Ut;Rt<<=1,St<<=1}})(),(function(){for(var Rt=0;Rt<256;Rt++)lt[Rt]=19595*Rt,lt[Rt+256|0]=38470*Rt,lt[Rt+512|0]=7471*Rt+32768,lt[Rt+768|0]=-11059*Rt,lt[Rt+1024|0]=-21709*Rt,lt[Rt+1280|0]=32768*Rt+8421375,lt[Rt+1536|0]=-27439*Rt,lt[Rt+1792|0]=-5329*Rt})(),Ot(g),new Date().getTime()}encoder.exports=function(g,w){w===void 0&&(w=50);var I=new m(w),P=I.encode(g,w);return{data:P,width:g.width,height:g.height}}})();var encoderExports=encoder.exports,decoder={exports:{}},module$1,JpegImage;module$1=decoder,JpegImage=(function(){var d=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),m=4017,g=799,w=3406,I=2276,P=1567,F=3784,D=5793,$=2896;function U(){}function j(rt,et){for(var X,J,tt=0,st=[],nt=16;nt>0&&!rt[nt-1];)nt--;st.push({children:[],index:0});var lt,at=st[0];for(X=0;X<nt;X++){for(J=0;J<rt[X];J++){for((at=st.pop()).children[at.index]=et[tt];at.index>0;){if(st.length===0)throw new Error("Could not recreate Huffman Table");at=st.pop()}for(at.index++,st.push(at);st.length<=X;)st.push(lt={children:[],index:0}),at.children[at.index]=lt.children,at=lt;tt++}X+1<nt&&(st.push(lt={children:[],index:0}),at.children[at.index]=lt.children,at=lt)}return st[0].children}function Z(rt,et,X,J,tt,st,nt,lt,at,ct){X.precision,X.samplesPerLine,X.scanLines;var V=X.mcusPerLine,ut=X.progressive;X.maxH,X.maxV;var wt=et,dt=0,ft=0;function pt(){if(ft>0)return ft--,dt>>ft&1;if((dt=rt[et++])==255){var Bt=rt[et++];if(Bt)throw new Error("unexpected marker: "+(dt<<8|Bt).toString(16))}return ft=7,dt>>>7}function Pt(Bt){for(var K,ot=Bt;(K=pt())!==null;){if(typeof(ot=ot[K])=="number")return ot;if(typeof ot!="object")throw new Error("invalid huffman sequence")}return null}function It(Bt){for(var K=0;Bt>0;){var ot=pt();if(ot===null)return;K=K<<1|ot,Bt--}return K}function xt(Bt){var K=It(Bt);return K>=1<<Bt-1?K:K+(-1<<Bt)+1}var Ft,Et=0,Ct=0;function Ot(Bt,K,ot,bt,yt){var $t=ot%V,Zt=(ot/V|0)*Bt.v+bt,Kt=$t*Bt.h+yt;Bt.blocks[Zt]===void 0&&ct.tolerantDecoding||K(Bt,Bt.blocks[Zt][Kt])}function Rt(Bt,K,ot){var bt=ot/Bt.blocksPerLine|0,yt=ot%Bt.blocksPerLine;Bt.blocks[bt]===void 0&&ct.tolerantDecoding||K(Bt,Bt.blocks[bt][yt])}var St,At,Nt,Ut,jt,Tt,it=J.length;Tt=ut?st===0?lt===0?function(Bt,K){var ot=Pt(Bt.huffmanTableDC),bt=ot===0?0:xt(ot)<<at;K[0]=Bt.pred+=bt}:function(Bt,K){K[0]|=pt()<<at}:lt===0?function(Bt,K){if(Et>0)Et--;else for(var ot=st,bt=nt;ot<=bt;){var yt=Pt(Bt.huffmanTableAC),$t=15&yt,Zt=yt>>4;if($t!==0)K[d[ot+=Zt]]=xt($t)*(1<<at),ot++;else{if(Zt<15){Et=It(Zt)+(1<<Zt)-1;break}ot+=16}}}:function(Bt,K){for(var ot=st,bt=nt,yt=0;ot<=bt;){var $t=d[ot],Zt=K[$t]<0?-1:1;switch(Ct){case 0:var Kt=Pt(Bt.huffmanTableAC),te=15&Kt;if(yt=Kt>>4,te===0)yt<15?(Et=It(yt)+(1<<yt),Ct=4):(yt=16,Ct=1);else{if(te!==1)throw new Error("invalid ACn encoding");Ft=xt(te),Ct=yt?2:3}continue;case 1:case 2:K[$t]?K[$t]+=(pt()<<at)*Zt:--yt==0&&(Ct=Ct==2?3:0);break;case 3:K[$t]?K[$t]+=(pt()<<at)*Zt:(K[$t]=Ft<<at,Ct=0);break;case 4:K[$t]&&(K[$t]+=(pt()<<at)*Zt)}ot++}Ct===4&&--Et==0&&(Ct=0)}:function(Bt,K){var ot=Pt(Bt.huffmanTableDC),bt=ot===0?0:xt(ot);K[0]=Bt.pred+=bt;for(var yt=1;yt<64;){var $t=Pt(Bt.huffmanTableAC),Zt=15&$t,Kt=$t>>4;if(Zt!==0)K[d[yt+=Kt]]=xt(Zt),yt++;else{if(Kt<15)break;yt+=16}}};var Mt,mt,gt,_t,vt=0;for(mt=it==1?J[0].blocksPerLine*J[0].blocksPerColumn:V*X.mcusPerColumn,tt||(tt=mt);vt<mt;){for(At=0;At<it;At++)J[At].pred=0;if(Et=0,it==1)for(St=J[0],jt=0;jt<tt;jt++)Rt(St,Tt,vt),vt++;else for(jt=0;jt<tt;jt++){for(At=0;At<it;At++)for(gt=(St=J[At]).h,_t=St.v,Nt=0;Nt<_t;Nt++)for(Ut=0;Ut<gt;Ut++)Ot(St,Tt,vt,Nt,Ut);if(++vt===mt)break}if(vt===mt)do{if(rt[et]===255&&rt[et+1]!==0)break;et+=1}while(et<rt.length-2);if(ft=0,(Mt=rt[et]<<8|rt[et+1])<65280)throw new Error("marker was not found");if(!(Mt>=65488&&Mt<=65495))break;et+=2}return et-wt}function G(rt,et){var X,J,tt=[],st=et.blocksPerLine,nt=et.blocksPerColumn,lt=st<<3,at=new Int32Array(64),ct=new Uint8Array(64);function V(It,xt,Ft){var Et,Ct,Ot,Rt,St,At,Nt,Ut,jt,Tt,it=et.quantizationTable,Mt=Ft;for(Tt=0;Tt<64;Tt++)Mt[Tt]=It[Tt]*it[Tt];for(Tt=0;Tt<8;++Tt){var mt=8*Tt;Mt[1+mt]!=0||Mt[2+mt]!=0||Mt[3+mt]!=0||Mt[4+mt]!=0||Mt[5+mt]!=0||Mt[6+mt]!=0||Mt[7+mt]!=0?(Et=D*Mt[0+mt]+128>>8,Ct=D*Mt[4+mt]+128>>8,Ot=Mt[2+mt],Rt=Mt[6+mt],St=$*(Mt[1+mt]-Mt[7+mt])+128>>8,Ut=$*(Mt[1+mt]+Mt[7+mt])+128>>8,At=Mt[3+mt]<<4,Nt=Mt[5+mt]<<4,jt=Et-Ct+1>>1,Et=Et+Ct+1>>1,Ct=jt,jt=Ot*F+Rt*P+128>>8,Ot=Ot*P-Rt*F+128>>8,Rt=jt,jt=St-Nt+1>>1,St=St+Nt+1>>1,Nt=jt,jt=Ut+At+1>>1,At=Ut-At+1>>1,Ut=jt,jt=Et-Rt+1>>1,Et=Et+Rt+1>>1,Rt=jt,jt=Ct-Ot+1>>1,Ct=Ct+Ot+1>>1,Ot=jt,jt=St*I+Ut*w+2048>>12,St=St*w-Ut*I+2048>>12,Ut=jt,jt=At*g+Nt*m+2048>>12,At=At*m-Nt*g+2048>>12,Nt=jt,Mt[0+mt]=Et+Ut,Mt[7+mt]=Et-Ut,Mt[1+mt]=Ct+Nt,Mt[6+mt]=Ct-Nt,Mt[2+mt]=Ot+At,Mt[5+mt]=Ot-At,Mt[3+mt]=Rt+St,Mt[4+mt]=Rt-St):(jt=D*Mt[0+mt]+512>>10,Mt[0+mt]=jt,Mt[1+mt]=jt,Mt[2+mt]=jt,Mt[3+mt]=jt,Mt[4+mt]=jt,Mt[5+mt]=jt,Mt[6+mt]=jt,Mt[7+mt]=jt)}for(Tt=0;Tt<8;++Tt){var gt=Tt;Mt[8+gt]!=0||Mt[16+gt]!=0||Mt[24+gt]!=0||Mt[32+gt]!=0||Mt[40+gt]!=0||Mt[48+gt]!=0||Mt[56+gt]!=0?(Et=D*Mt[0+gt]+2048>>12,Ct=D*Mt[32+gt]+2048>>12,Ot=Mt[16+gt],Rt=Mt[48+gt],St=$*(Mt[8+gt]-Mt[56+gt])+2048>>12,Ut=$*(Mt[8+gt]+Mt[56+gt])+2048>>12,At=Mt[24+gt],Nt=Mt[40+gt],jt=Et-Ct+1>>1,Et=Et+Ct+1>>1,Ct=jt,jt=Ot*F+Rt*P+2048>>12,Ot=Ot*P-Rt*F+2048>>12,Rt=jt,jt=St-Nt+1>>1,St=St+Nt+1>>1,Nt=jt,jt=Ut+At+1>>1,At=Ut-At+1>>1,Ut=jt,jt=Et-Rt+1>>1,Et=Et+Rt+1>>1,Rt=jt,jt=Ct-Ot+1>>1,Ct=Ct+Ot+1>>1,Ot=jt,jt=St*I+Ut*w+2048>>12,St=St*w-Ut*I+2048>>12,Ut=jt,jt=At*g+Nt*m+2048>>12,At=At*m-Nt*g+2048>>12,Nt=jt,Mt[0+gt]=Et+Ut,Mt[56+gt]=Et-Ut,Mt[8+gt]=Ct+Nt,Mt[48+gt]=Ct-Nt,Mt[16+gt]=Ot+At,Mt[40+gt]=Ot-At,Mt[24+gt]=Rt+St,Mt[32+gt]=Rt-St):(jt=D*Ft[Tt+0]+8192>>14,Mt[0+gt]=jt,Mt[8+gt]=jt,Mt[16+gt]=jt,Mt[24+gt]=jt,Mt[32+gt]=jt,Mt[40+gt]=jt,Mt[48+gt]=jt,Mt[56+gt]=jt)}for(Tt=0;Tt<64;++Tt){var _t=128+(Mt[Tt]+8>>4);xt[Tt]=_t<0?0:_t>255?255:_t}}q(lt*nt*8);for(var ut=0;ut<nt;ut++){var wt=ut<<3;for(X=0;X<8;X++)tt.push(new Uint8Array(lt));for(var dt=0;dt<st;dt++){V(et.blocks[ut][dt],ct,at);var ft=0,pt=dt<<3;for(J=0;J<8;J++){var Pt=tt[wt+J];for(X=0;X<8;X++)Pt[pt+X]=ct[ft++]}}}return tt}function H(rt){return rt<0?0:rt>255?255:rt}U.prototype={load:function(rt){var et=new XMLHttpRequest;et.open("GET",rt,!0),et.responseType="arraybuffer",et.onload=function(){var X=new Uint8Array(et.response||et.mozResponseArrayBuffer);this.parse(X),this.onload&&this.onload()}.bind(this),et.send(null)},parse:function(rt){var et=1e3*this.opts.maxResolutionInMP*1e3,X=0;function J(){var Vt=rt[X]<<8|rt[X+1];return X+=2,Vt}function tt(Vt){var ee,Xt,oe=1,ne=1;for(Xt in Vt.components)Vt.components.hasOwnProperty(Xt)&&(oe<(ee=Vt.components[Xt]).h&&(oe=ee.h),ne<ee.v&&(ne=ee.v));var ae=Math.ceil(Vt.samplesPerLine/8/oe),he=Math.ceil(Vt.scanLines/8/ne);for(Xt in Vt.components)if(Vt.components.hasOwnProperty(Xt)){ee=Vt.components[Xt];var ie=Math.ceil(Math.ceil(Vt.samplesPerLine/8)*ee.h/oe),zt=Math.ceil(Math.ceil(Vt.scanLines/8)*ee.v/ne),Jt=ae*ee.h,Lt=he*ee.v,Qt=[];q(Lt*Jt*256);for(var kt=0;kt<Lt;kt++){for(var Yt=[],ue=0;ue<Jt;ue++)Yt.push(new Int32Array(64));Qt.push(Yt)}ee.blocksPerLine=ie,ee.blocksPerColumn=zt,ee.blocks=Qt}Vt.maxH=oe,Vt.maxV=ne,Vt.mcusPerLine=ae,Vt.mcusPerColumn=he}rt.length;var st,nt,lt,at,ct=null,V=null,ut=[],wt=[],dt=[],ft=[],pt=J(),Pt=-1;if(this.comments=[],pt!=65496)throw new Error("SOI not found");for(pt=J();pt!=65497;){switch(pt){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var It=(lt=void 0,at=void 0,lt=J(),at=rt.subarray(X,X+lt-2),X+=at.length,at);if(pt===65534){var xt=String.fromCharCode.apply(null,It);this.comments.push(xt)}pt===65504&&It[0]===74&&It[1]===70&&It[2]===73&&It[3]===70&&It[4]===0&&(ct={version:{major:It[5],minor:It[6]},densityUnits:It[7],xDensity:It[8]<<8|It[9],yDensity:It[10]<<8|It[11],thumbWidth:It[12],thumbHeight:It[13],thumbData:It.subarray(14,14+3*It[12]*It[13])}),pt===65505&&It[0]===69&&It[1]===120&&It[2]===105&&It[3]===102&&It[4]===0&&(this.exifBuffer=It.subarray(5,It.length)),pt===65518&&It[0]===65&&It[1]===100&&It[2]===111&&It[3]===98&&It[4]===101&&It[5]===0&&(V={version:It[6],flags0:It[7]<<8|It[8],flags1:It[9]<<8|It[10],transformCode:It[11]});break;case 65499:for(var Ft=J()+X-2;X<Ft;){var Et=rt[X++];q(256);var Ct=new Int32Array(64);if(Et>>4){if(Et>>4!=1)throw new Error("DQT: invalid table spec");for(Kt=0;Kt<64;Kt++)Ct[d[Kt]]=J()}else for(Kt=0;Kt<64;Kt++)Ct[d[Kt]]=rt[X++];ut[15&Et]=Ct}break;case 65472:case 65473:case 65474:J(),(st={}).extended=pt===65473,st.progressive=pt===65474,st.precision=rt[X++],st.scanLines=J(),st.samplesPerLine=J(),st.components={},st.componentsOrder=[];var Ot=st.scanLines*st.samplesPerLine;if(Ot>et){var Rt=Math.ceil((Ot-et)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Rt}MP`)}var St,At=rt[X++];for($t=0;$t<At;$t++){St=rt[X];var Nt=rt[X+1]>>4,Ut=15&rt[X+1],jt=rt[X+2];if(Nt<=0||Ut<=0)throw new Error("Invalid sampling factor, expected values above 0");st.componentsOrder.push(St),st.components[St]={h:Nt,v:Ut,quantizationIdx:jt},X+=3}tt(st),wt.push(st);break;case 65476:var Tt=J();for($t=2;$t<Tt;){var it=rt[X++],Mt=new Uint8Array(16),mt=0;for(Kt=0;Kt<16;Kt++,X++)mt+=Mt[Kt]=rt[X];q(16+mt);var gt=new Uint8Array(mt);for(Kt=0;Kt<mt;Kt++,X++)gt[Kt]=rt[X];$t+=17+mt,(it>>4?dt:ft)[15&it]=j(Mt,gt)}break;case 65501:J(),nt=J();break;case 65500:J(),J();break;case 65498:J();var _t=rt[X++],vt=[];for($t=0;$t<_t;$t++){te=st.components[rt[X++]];var Bt=rt[X++];te.huffmanTableDC=ft[Bt>>4],te.huffmanTableAC=dt[15&Bt],vt.push(te)}var K=rt[X++],ot=rt[X++],bt=rt[X++],yt=Z(rt,X,st,vt,nt,K,ot,bt>>4,15&bt,this.opts);X+=yt;break;case 65535:rt[X]!==255&&X--;break;default:if(rt[X-3]==255&&rt[X-2]>=192&&rt[X-2]<=254){X-=3;break}if(pt===224||pt==225){if(Pt!==-1)throw new Error(`first unknown JPEG marker at offset ${Pt.toString(16)}, second unknown JPEG marker ${pt.toString(16)} at offset ${(X-1).toString(16)}`);Pt=X-1;const Vt=J();if(rt[X+Vt-2]===255){X+=Vt-2;break}}throw new Error("unknown JPEG marker "+pt.toString(16))}pt=J()}if(wt.length!=1)throw new Error("only single frame JPEGs supported");for(var $t=0;$t<wt.length;$t++){var Zt=wt[$t].components;for(var Kt in Zt)Zt[Kt].quantizationTable=ut[Zt[Kt].quantizationIdx],delete Zt[Kt].quantizationIdx}for(this.width=st.samplesPerLine,this.height=st.scanLines,this.jfif=ct,this.adobe=V,this.components=[],$t=0;$t<st.componentsOrder.length;$t++){var te=st.components[st.componentsOrder[$t]];this.components.push({lines:G(0,te),scaleX:te.h/st.maxH,scaleY:te.v/st.maxV})}},getData:function(rt,et){var X,J,tt,st,nt,lt,at,ct,V,ut,wt,dt,ft,pt,Pt,It,xt,Ft,Et,Ct,Ot,Rt=this.width/rt,St=this.height/et,At=0,Nt=rt*et*this.components.length;q(Nt);var Ut=new Uint8Array(Nt);switch(this.components.length){case 1:for(X=this.components[0],ut=0;ut<et;ut++)for(nt=X.lines[0|ut*X.scaleY*St],V=0;V<rt;V++)wt=nt[0|V*X.scaleX*Rt],Ut[At++]=wt;break;case 2:for(X=this.components[0],J=this.components[1],ut=0;ut<et;ut++)for(nt=X.lines[0|ut*X.scaleY*St],lt=J.lines[0|ut*J.scaleY*St],V=0;V<rt;V++)wt=nt[0|V*X.scaleX*Rt],Ut[At++]=wt,wt=lt[0|V*J.scaleX*Rt],Ut[At++]=wt;break;case 3:for(Ot=!0,this.adobe&&this.adobe.transformCode?Ot=!0:this.opts.colorTransform!==void 0&&(Ot=!!this.opts.colorTransform),X=this.components[0],J=this.components[1],tt=this.components[2],ut=0;ut<et;ut++)for(nt=X.lines[0|ut*X.scaleY*St],lt=J.lines[0|ut*J.scaleY*St],at=tt.lines[0|ut*tt.scaleY*St],V=0;V<rt;V++)Ot?(wt=nt[0|V*X.scaleX*Rt],dt=lt[0|V*J.scaleX*Rt],Ft=H(wt+1.402*((ft=at[0|V*tt.scaleX*Rt])-128)),Et=H(wt-.3441363*(dt-128)-.71413636*(ft-128)),Ct=H(wt+1.772*(dt-128))):(Ft=nt[0|V*X.scaleX*Rt],Et=lt[0|V*J.scaleX*Rt],Ct=at[0|V*tt.scaleX*Rt]),Ut[At++]=Ft,Ut[At++]=Et,Ut[At++]=Ct;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(Ot=!1,this.adobe&&this.adobe.transformCode?Ot=!0:this.opts.colorTransform!==void 0&&(Ot=!!this.opts.colorTransform),X=this.components[0],J=this.components[1],tt=this.components[2],st=this.components[3],ut=0;ut<et;ut++)for(nt=X.lines[0|ut*X.scaleY*St],lt=J.lines[0|ut*J.scaleY*St],at=tt.lines[0|ut*tt.scaleY*St],ct=st.lines[0|ut*st.scaleY*St],V=0;V<rt;V++)Ot?(wt=nt[0|V*X.scaleX*Rt],dt=lt[0|V*J.scaleX*Rt],ft=at[0|V*tt.scaleX*Rt],pt=ct[0|V*st.scaleX*Rt],Pt=255-H(wt+1.402*(ft-128)),It=255-H(wt-.3441363*(dt-128)-.71413636*(ft-128)),xt=255-H(wt+1.772*(dt-128))):(Pt=nt[0|V*X.scaleX*Rt],It=lt[0|V*J.scaleX*Rt],xt=at[0|V*tt.scaleX*Rt],pt=ct[0|V*st.scaleX*Rt]),Ut[At++]=255-Pt,Ut[At++]=255-It,Ut[At++]=255-xt,Ut[At++]=255-pt;break;default:throw new Error("Unsupported color mode")}return Ut},copyToImageData:function(rt,et){var X,J,tt,st,nt,lt,at,ct,V,ut=rt.width,wt=rt.height,dt=rt.data,ft=this.getData(ut,wt),pt=0,Pt=0;switch(this.components.length){case 1:for(J=0;J<wt;J++)for(X=0;X<ut;X++)tt=ft[pt++],dt[Pt++]=tt,dt[Pt++]=tt,dt[Pt++]=tt,et&&(dt[Pt++]=255);break;case 3:for(J=0;J<wt;J++)for(X=0;X<ut;X++)at=ft[pt++],ct=ft[pt++],V=ft[pt++],dt[Pt++]=at,dt[Pt++]=ct,dt[Pt++]=V,et&&(dt[Pt++]=255);break;case 4:for(J=0;J<wt;J++)for(X=0;X<ut;X++)nt=ft[pt++],lt=ft[pt++],tt=ft[pt++],at=255-H(nt*(1-(st=ft[pt++])/255)+st),ct=255-H(lt*(1-st/255)+st),V=255-H(tt*(1-st/255)+st),dt[Pt++]=at,dt[Pt++]=ct,dt[Pt++]=V,et&&(dt[Pt++]=255);break;default:throw new Error("Unsupported color mode")}}};var W=0,Q=0;function q(rt=0){var et=W+rt;if(et>Q){var X=Math.ceil((et-Q)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${X}MB`)}W=et}return U.resetMaxMemoryUsage=function(rt){W=0,Q=rt},U.getBytesAllocated=function(){return W},U.requestMemoryAllocation=q,U})(),module$1.exports=function(d,m={}){var g={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...m},w=new Uint8Array(d),I=new JpegImage;I.opts=g,JpegImage.resetMaxMemoryUsage(1024*g.maxMemoryUsageInMB*1024),I.parse(w);var P=g.formatAsRGBA?4:3,F=I.width*I.height*P;try{JpegImage.requestMemoryAllocation(F);var D={width:I.width,height:I.height,exifBuffer:I.exifBuffer,data:g.useTArray?new Uint8Array(F):Buffer.alloc(F)};I.comments.length>0&&(D.comments=I.comments)}catch($){throw $ instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+F):$ instanceof ReferenceError&&$.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):$}return I.copyToImageData(D,g.formatAsRGBA),D};var decoderExports=decoder.exports,encode=encoderExports,decode=decoderExports,jpegJs={encode,decode},JPEG=getDefaultExportFromCjs(jpegJs);function jpeg$2(){return{mime:"image/jpeg",encode:(d,{quality:m=100}={})=>JPEG.encode(d,m).data,decode:(d,m)=>JPEG.decode(d,m)}}function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browser$1={exports:{}};browser$1.exports=(function(){function d(m,g,w){function I(D,$){if(!g[D]){if(!m[D]){var U=typeof commonjsRequire=="function"&&commonjsRequire;if(!$&&U)return U(D,!0);if(P)return P(D,!0);var j=new Error("Cannot find module '"+D+"'");throw j.code="MODULE_NOT_FOUND",j}var Z=g[D]={exports:{}};m[D][0].call(Z.exports,(function(G){return I(m[D][1][G]||G)}),Z,Z.exports,d,m,g,w)}return g[D].exports}for(var P=typeof commonjsRequire=="function"&&commonjsRequire,F=0;F<w.length;F++)I(w[F]);return I}return d})()({1:[function(d,m,g){(function(w){(function(){let I=d("./interlace"),P=[function(){},function(j,Z,G,H){if(H===Z.length)throw new Error("Ran out of data");let W=Z[H];j[G]=W,j[G+1]=W,j[G+2]=W,j[G+3]=255},function(j,Z,G,H){if(H+1>=Z.length)throw new Error("Ran out of data");let W=Z[H];j[G]=W,j[G+1]=W,j[G+2]=W,j[G+3]=Z[H+1]},function(j,Z,G,H){if(H+2>=Z.length)throw new Error("Ran out of data");j[G]=Z[H],j[G+1]=Z[H+1],j[G+2]=Z[H+2],j[G+3]=255},function(j,Z,G,H){if(H+3>=Z.length)throw new Error("Ran out of data");j[G]=Z[H],j[G+1]=Z[H+1],j[G+2]=Z[H+2],j[G+3]=Z[H+3]}],F=[function(){},function(j,Z,G,H){let W=Z[0];j[G]=W,j[G+1]=W,j[G+2]=W,j[G+3]=H},function(j,Z,G){let H=Z[0];j[G]=H,j[G+1]=H,j[G+2]=H,j[G+3]=Z[1]},function(j,Z,G,H){j[G]=Z[0],j[G+1]=Z[1],j[G+2]=Z[2],j[G+3]=H},function(j,Z,G){j[G]=Z[0],j[G+1]=Z[1],j[G+2]=Z[2],j[G+3]=Z[3]}];function D(j,Z){let G=[],H=0;function W(){if(H===j.length)throw new Error("Ran out of data");let Q,q,rt,et,X,J,tt,st,nt=j[H];switch(H++,Z){default:throw new Error("unrecognised depth");case 16:tt=j[H],H++,G.push((nt<<8)+tt);break;case 4:tt=15&nt,st=nt>>4,G.push(st,tt);break;case 2:X=3&nt,J=nt>>2&3,tt=nt>>4&3,st=nt>>6&3,G.push(st,tt,J,X);break;case 1:Q=1&nt,q=nt>>1&1,rt=nt>>2&1,et=nt>>3&1,X=nt>>4&1,J=nt>>5&1,tt=nt>>6&1,st=nt>>7&1,G.push(st,tt,J,X,et,rt,q,Q)}}return{get:function(Q){for(;G.length<Q;)W();let q=G.slice(0,Q);return G=G.slice(Q),q},resetAfterLine:function(){G.length=0},end:function(){if(H!==j.length)throw new Error("extra data found")}}}function $(j,Z,G,H,W,Q){let q=j.width,rt=j.height,et=j.index;for(let X=0;X<rt;X++)for(let J=0;J<q;J++){let tt=G(J,X,et);P[H](Z,W,tt,Q),Q+=H}return Q}function U(j,Z,G,H,W,Q){let q=j.width,rt=j.height,et=j.index;for(let X=0;X<rt;X++){for(let J=0;J<q;J++){let tt=W.get(H),st=G(J,X,et);F[H](Z,tt,st,Q)}W.resetAfterLine()}}g.dataToBitMap=function(j,Z){let G,H,W=Z.width,Q=Z.height,q=Z.depth,rt=Z.bpp,et=Z.interlace;q!==8&&(G=D(j,q)),H=q<=8?w.alloc(W*Q*4):new Uint16Array(W*Q*4);let X,J,tt=Math.pow(2,q)-1,st=0;if(et)X=I.getImagePasses(W,Q),J=I.getInterlaceIterator(W,Q);else{let nt=0;J=function(){let lt=nt;return nt+=4,lt},X=[{width:W,height:Q}]}for(let nt=0;nt<X.length;nt++)q===8?st=$(X[nt],H,J,rt,j,st):U(X[nt],H,J,rt,G,tt);if(q===8){if(st!==j.length)throw new Error("extra data found")}else G.end();return H}}).call(this)}).call(this,d("buffer").Buffer)},{"./interlace":11,buffer:32}],2:[function(d,m,g){(function(w){(function(){let I=d("./constants");m.exports=function(P,F,D,$){let U=[I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf($.colorType)!==-1;if($.colorType===$.inputColorType){let X=(function(){let J=new ArrayBuffer(2);return new DataView(J).setInt16(0,256,!0),new Int16Array(J)[0]!==256})();if($.bitDepth===8||$.bitDepth===16&&X)return P}let j=$.bitDepth!==16?P:new Uint16Array(P.buffer),Z=255,G=I.COLORTYPE_TO_BPP_MAP[$.inputColorType];G!==4||$.inputHasAlpha||(G=3);let H=I.COLORTYPE_TO_BPP_MAP[$.colorType];$.bitDepth===16&&(Z=65535,H*=2);let W=w.alloc(F*D*H),Q=0,q=0,rt=$.bgColor||{};function et(){let X,J,tt,st=Z;switch($.inputColorType){case I.COLORTYPE_COLOR_ALPHA:st=j[Q+3],X=j[Q],J=j[Q+1],tt=j[Q+2];break;case I.COLORTYPE_COLOR:X=j[Q],J=j[Q+1],tt=j[Q+2];break;case I.COLORTYPE_ALPHA:st=j[Q+1],X=j[Q],J=X,tt=X;break;case I.COLORTYPE_GRAYSCALE:X=j[Q],J=X,tt=X;break;default:throw new Error("input color type:"+$.inputColorType+" is not supported at present")}return $.inputHasAlpha&&(U||(st/=Z,X=Math.min(Math.max(Math.round((1-st)*rt.red+st*X),0),Z),J=Math.min(Math.max(Math.round((1-st)*rt.green+st*J),0),Z),tt=Math.min(Math.max(Math.round((1-st)*rt.blue+st*tt),0),Z))),{red:X,green:J,blue:tt,alpha:st}}rt.red===void 0&&(rt.red=Z),rt.green===void 0&&(rt.green=Z),rt.blue===void 0&&(rt.blue=Z);for(let X=0;X<D;X++)for(let J=0;J<F;J++){let tt=et();switch($.colorType){case I.COLORTYPE_COLOR_ALPHA:case I.COLORTYPE_COLOR:$.bitDepth===8?(W[q]=tt.red,W[q+1]=tt.green,W[q+2]=tt.blue,U&&(W[q+3]=tt.alpha)):(W.writeUInt16BE(tt.red,q),W.writeUInt16BE(tt.green,q+2),W.writeUInt16BE(tt.blue,q+4),U&&W.writeUInt16BE(tt.alpha,q+6));break;case I.COLORTYPE_ALPHA:case I.COLORTYPE_GRAYSCALE:{let st=(tt.red+tt.green+tt.blue)/3;$.bitDepth===8?(W[q]=st,U&&(W[q+1]=tt.alpha)):(W.writeUInt16BE(st,q),U&&W.writeUInt16BE(tt.alpha,q+2));break}default:throw new Error("unrecognised color Type "+$.colorType)}Q+=G,q+=H}return W}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,buffer:32}],3:[function(d,m,g){(function(w,I){(function(){let P=d("util"),F=d("stream"),D=m.exports=function(){F.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};P.inherits(D,F),D.prototype.read=function($,U){this._reads.push({length:Math.abs($),allowLess:$<0,func:U}),w.nextTick(function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},D.prototype.write=function($,U){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let j;return j=I.isBuffer($)?$:I.from($,U||this._encoding),this._buffers.push(j),this._buffered+=j.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},D.prototype.end=function($,U){$&&this.write($,U),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},D.prototype.destroySoon=D.prototype.end,D.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},D.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},D.prototype._processReadAllowingLess=function($){this._reads.shift();let U=this._buffers[0];U.length>$.length?(this._buffered-=$.length,this._buffers[0]=U.slice($.length),$.func.call(this,U.slice(0,$.length))):(this._buffered-=U.length,this._buffers.shift(),$.func.call(this,U))},D.prototype._processRead=function($){this._reads.shift();let U=0,j=0,Z=I.alloc($.length);for(;U<$.length;){let G=this._buffers[j++],H=Math.min(G.length,$.length-U);G.copy(Z,U,0,H),U+=H,H!==G.length&&(this._buffers[--j]=G.slice(H))}j>0&&this._buffers.splice(0,j),this._buffered-=$.length,$.func.call(this,Z)},D.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let $=this._reads[0];if($.allowLess)this._processReadAllowingLess($);else{if(!(this._buffered>=$.length))break;this._processRead($)}}this._buffers&&!this.writable&&this._end()}catch($){this.emit("error",$)}}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,buffer:32,stream:65,util:84}],4:[function(d,m,g){m.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],5:[function(d,m,g){let w=[];(function(){for(let P=0;P<256;P++){let F=P;for(let D=0;D<8;D++)1&F?F=3988292384^F>>>1:F>>>=1;w[P]=F}})();let I=m.exports=function(){this._crc=-1};I.prototype.write=function(P){for(let F=0;F<P.length;F++)this._crc=w[255&(this._crc^P[F])]^this._crc>>>8;return!0},I.prototype.crc32=function(){return~this._crc},I.crc32=function(P){let F=-1;for(let D=0;D<P.length;D++)F=w[255&(F^P[D])]^F>>>8;return~F}},{}],6:[function(d,m,g){(function(w){(function(){let I=d("./paeth-predictor");function P(rt,et,X,J,tt){for(let st=0;st<X;st++)J[tt+st]=rt[et+st]}function F(rt,et,X){let J=0,tt=et+X;for(let st=et;st<tt;st++)J+=Math.abs(rt[st]);return J}function D(rt,et,X,J,tt,st){for(let nt=0;nt<X;nt++){let lt=nt>=st?rt[et+nt-st]:0,at=rt[et+nt]-lt;J[tt+nt]=at}}function $(rt,et,X,J){let tt=0;for(let st=0;st<X;st++){let nt=st>=J?rt[et+st-J]:0,lt=rt[et+st]-nt;tt+=Math.abs(lt)}return tt}function U(rt,et,X,J,tt){for(let st=0;st<X;st++){let nt=et>0?rt[et+st-X]:0,lt=rt[et+st]-nt;J[tt+st]=lt}}function j(rt,et,X){let J=0,tt=et+X;for(let st=et;st<tt;st++){let nt=et>0?rt[st-X]:0,lt=rt[st]-nt;J+=Math.abs(lt)}return J}function Z(rt,et,X,J,tt,st){for(let nt=0;nt<X;nt++){let lt=nt>=st?rt[et+nt-st]:0,at=et>0?rt[et+nt-X]:0,ct=rt[et+nt]-(lt+at>>1);J[tt+nt]=ct}}function G(rt,et,X,J){let tt=0;for(let st=0;st<X;st++){let nt=st>=J?rt[et+st-J]:0,lt=et>0?rt[et+st-X]:0,at=rt[et+st]-(nt+lt>>1);tt+=Math.abs(at)}return tt}function H(rt,et,X,J,tt,st){for(let nt=0;nt<X;nt++){let lt=nt>=st?rt[et+nt-st]:0,at=et>0?rt[et+nt-X]:0,ct=et>0&&nt>=st?rt[et+nt-(X+st)]:0,V=rt[et+nt]-I(lt,at,ct);J[tt+nt]=V}}function W(rt,et,X,J){let tt=0;for(let st=0;st<X;st++){let nt=st>=J?rt[et+st-J]:0,lt=et>0?rt[et+st-X]:0,at=et>0&&st>=J?rt[et+st-(X+J)]:0,ct=rt[et+st]-I(nt,lt,at);tt+=Math.abs(ct)}return tt}let Q={0:P,1:D,2:U,3:Z,4:H},q={0:F,1:$,2:j,3:G,4:W};m.exports=function(rt,et,X,J,tt){let st;if("filterType"in J&&J.filterType!==-1){if(typeof J.filterType!="number")throw new Error("unrecognised filter types");st=[J.filterType]}else st=[0,1,2,3,4];J.bitDepth===16&&(tt*=2);let nt=et*tt,lt=0,at=0,ct=w.alloc((nt+1)*X),V=st[0];for(let ut=0;ut<X;ut++){if(st.length>1){let wt=1/0;for(let dt=0;dt<st.length;dt++){let ft=q[st[dt]](rt,at,nt,tt);ft<wt&&(V=st[dt],wt=ft)}}ct[lt]=V,lt++,Q[V](rt,at,nt,ct,lt,tt),lt+=nt,at+=nt}return ct}}).call(this)}).call(this,d("buffer").Buffer)},{"./paeth-predictor":15,buffer:32}],7:[function(d,m,g){(function(w){(function(){let I=d("util"),P=d("./chunkstream"),F=d("./filter-parse"),D=m.exports=function($){P.call(this);let U=[],j=this;this._filter=new F($,{read:this.read.bind(this),write:function(Z){U.push(Z)},complete:function(){j.emit("complete",w.concat(U))}}),this._filter.start()};I.inherits(D,P)}).call(this)}).call(this,d("buffer").Buffer)},{"./chunkstream":3,"./filter-parse":9,buffer:32,util:84}],8:[function(d,m,g){(function(w){(function(){let I=d("./sync-reader"),P=d("./filter-parse");g.process=function(F,D){let $=[],U=new I(F);return new P(D,{read:U.read.bind(U),write:function(j){$.push(j)},complete:function(){}}).start(),U.process(),w.concat($)}}).call(this)}).call(this,d("buffer").Buffer)},{"./filter-parse":9,"./sync-reader":22,buffer:32}],9:[function(d,m,g){(function(w){(function(){let I=d("./interlace"),P=d("./paeth-predictor");function F($,U,j){let Z=$*U;return j!==8&&(Z=Math.ceil(Z/(8/j))),Z}let D=m.exports=function($,U){let j=$.width,Z=$.height,G=$.interlace,H=$.bpp,W=$.depth;if(this.read=U.read,this.write=U.write,this.complete=U.complete,this._imageIndex=0,this._images=[],G){let Q=I.getImagePasses(j,Z);for(let q=0;q<Q.length;q++)this._images.push({byteWidth:F(Q[q].width,H,W),height:Q[q].height,lineIndex:0})}else this._images.push({byteWidth:F(j,H,W),height:Z,lineIndex:0});this._xComparison=W===8?H:W===16?2*H:1};D.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},D.prototype._unFilterType1=function($,U,j){let Z=this._xComparison,G=Z-1;for(let H=0;H<j;H++){let W=$[1+H],Q=H>G?U[H-Z]:0;U[H]=W+Q}},D.prototype._unFilterType2=function($,U,j){let Z=this._lastLine;for(let G=0;G<j;G++){let H=$[1+G],W=Z?Z[G]:0;U[G]=H+W}},D.prototype._unFilterType3=function($,U,j){let Z=this._xComparison,G=Z-1,H=this._lastLine;for(let W=0;W<j;W++){let Q=$[1+W],q=H?H[W]:0,rt=W>G?U[W-Z]:0,et=Math.floor((rt+q)/2);U[W]=Q+et}},D.prototype._unFilterType4=function($,U,j){let Z=this._xComparison,G=Z-1,H=this._lastLine;for(let W=0;W<j;W++){let Q=$[1+W],q=H?H[W]:0,rt=W>G?U[W-Z]:0,et=W>G&&H?H[W-Z]:0,X=P(rt,q,et);U[W]=Q+X}},D.prototype._reverseFilterLine=function($){let U,j=$[0],Z=this._images[this._imageIndex],G=Z.byteWidth;if(j===0)U=$.slice(1,G+1);else switch(U=w.alloc(G),j){case 1:this._unFilterType1($,U,G);break;case 2:this._unFilterType2($,U,G);break;case 3:this._unFilterType3($,U,G);break;case 4:this._unFilterType4($,U,G);break;default:throw new Error("Unrecognised filter type - "+j)}this.write(U),Z.lineIndex++,Z.lineIndex>=Z.height?(this._lastLine=null,this._imageIndex++,Z=this._images[this._imageIndex]):this._lastLine=U,Z?this.read(Z.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this)}).call(this,d("buffer").Buffer)},{"./interlace":11,"./paeth-predictor":15,buffer:32}],10:[function(d,m,g){(function(w){(function(){function I(D,$,U,j,Z){let G=0;for(let H=0;H<j;H++)for(let W=0;W<U;W++){let Q=Z[D[G]];if(!Q)throw new Error("index "+D[G]+" not in palette");for(let q=0;q<4;q++)$[G+q]=Q[q];G+=4}}function P(D,$,U,j,Z){let G=0;for(let H=0;H<j;H++)for(let W=0;W<U;W++){let Q=!1;if(Z.length===1?Z[0]===D[G]&&(Q=!0):Z[0]===D[G]&&Z[1]===D[G+1]&&Z[2]===D[G+2]&&(Q=!0),Q)for(let q=0;q<4;q++)$[G+q]=0;G+=4}}function F(D,$,U,j,Z){let G=255,H=Math.pow(2,Z)-1,W=0;for(let Q=0;Q<j;Q++)for(let q=0;q<U;q++){for(let rt=0;rt<4;rt++)$[W+rt]=Math.floor(D[W+rt]*G/H+.5);W+=4}}m.exports=function(D,$,U=!1){let j=$.depth,Z=$.width,G=$.height,H=$.colorType,W=$.transColor,Q=$.palette,q=D;return H===3?I(D,q,Z,G,Q):(W&&P(D,q,Z,G,W),j===8||U||(j===16&&(q=w.alloc(Z*G*4)),F(D,q,Z,G,j))),q}}).call(this)}).call(this,d("buffer").Buffer)},{buffer:32}],11:[function(d,m,g){let w=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];g.getImagePasses=function(I,P){let F=[],D=I%8,$=P%8,U=(I-D)/8,j=(P-$)/8;for(let Z=0;Z<w.length;Z++){let G=w[Z],H=U*G.x.length,W=j*G.y.length;for(let Q=0;Q<G.x.length&&G.x[Q]<D;Q++)H++;for(let Q=0;Q<G.y.length&&G.y[Q]<$;Q++)W++;H>0&&W>0&&F.push({width:H,height:W,index:Z})}return F},g.getInterlaceIterator=function(I){return function(P,F,D){let $=P%w[D].x.length,U=(P-$)/w[D].x.length*8+w[D].x[$],j=F%w[D].y.length;return 4*U+((F-j)/w[D].y.length*8+w[D].y[j])*I*4}}},{}],12:[function(d,m,g){(function(w){(function(){let I=d("util"),P=d("stream"),F=d("./constants"),D=d("./packer"),$=m.exports=function(U){P.call(this);let j=U||{};this._packer=new D(j),this._deflate=this._packer.createDeflate(),this.readable=!0};I.inherits($,P),$.prototype.pack=function(U,j,Z,G){this.emit("data",w.from(F.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(j,Z)),G&&this.emit("data",this._packer.packGAMA(G));let H=this._packer.filterData(U,j,Z);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(W){this.emit("data",this._packer.packIDAT(W))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(H)}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,stream:65,util:84}],13:[function(d,m,g){(function(w){(function(){let I=!0,P=d("zlib");P.deflateSync||(I=!1);let F=d("./constants"),D=d("./packer");m.exports=function($,U){if(!I)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let j=new D(U||{}),Z=[];Z.push(w.from(F.PNG_SIGNATURE)),Z.push(j.packIHDR($.width,$.height)),$.gamma&&Z.push(j.packGAMA($.gamma));let G=j.filterData($.data,$.width,$.height),H=P.deflateSync(G,j.getDeflateOptions());if(G=null,!H||!H.length)throw new Error("bad png - invalid compressed data response");return Z.push(j.packIDAT(H)),Z.push(j.packIEND()),w.concat(Z)}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,zlib:31}],14:[function(d,m,g){(function(w){(function(){let I=d("./constants"),P=d("./crc"),F=d("./bitpacker"),D=d("./filter-pack"),$=d("zlib"),U=m.exports=function(j){if(this._options=j,j.deflateChunkSize=j.deflateChunkSize||32768,j.deflateLevel=j.deflateLevel!=null?j.deflateLevel:9,j.deflateStrategy=j.deflateStrategy!=null?j.deflateStrategy:3,j.inputHasAlpha=j.inputHasAlpha==null||j.inputHasAlpha,j.deflateFactory=j.deflateFactory||$.createDeflate,j.bitDepth=j.bitDepth||8,j.colorType=typeof j.colorType=="number"?j.colorType:I.COLORTYPE_COLOR_ALPHA,j.inputColorType=typeof j.inputColorType=="number"?j.inputColorType:I.COLORTYPE_COLOR_ALPHA,[I.COLORTYPE_GRAYSCALE,I.COLORTYPE_COLOR,I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf(j.colorType)===-1)throw new Error("option color type:"+j.colorType+" is not supported at present");if([I.COLORTYPE_GRAYSCALE,I.COLORTYPE_COLOR,I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf(j.inputColorType)===-1)throw new Error("option input color type:"+j.inputColorType+" is not supported at present");if(j.bitDepth!==8&&j.bitDepth!==16)throw new Error("option bit depth:"+j.bitDepth+" is not supported at present")};U.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},U.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},U.prototype.filterData=function(j,Z,G){let H=F(j,Z,G,this._options),W=I.COLORTYPE_TO_BPP_MAP[this._options.colorType];return D(H,Z,G,this._options,W)},U.prototype._packChunk=function(j,Z){let G=Z?Z.length:0,H=w.alloc(G+12);return H.writeUInt32BE(G,0),H.writeUInt32BE(j,4),Z&&Z.copy(H,8),H.writeInt32BE(P.crc32(H.slice(4,H.length-4)),H.length-4),H},U.prototype.packGAMA=function(j){let Z=w.alloc(4);return Z.writeUInt32BE(Math.floor(j*I.GAMMA_DIVISION),0),this._packChunk(I.TYPE_gAMA,Z)},U.prototype.packIHDR=function(j,Z){let G=w.alloc(13);return G.writeUInt32BE(j,0),G.writeUInt32BE(Z,4),G[8]=this._options.bitDepth,G[9]=this._options.colorType,G[10]=0,G[11]=0,G[12]=0,this._packChunk(I.TYPE_IHDR,G)},U.prototype.packIDAT=function(j){return this._packChunk(I.TYPE_IDAT,j)},U.prototype.packIEND=function(){return this._packChunk(I.TYPE_IEND,null)}}).call(this)}).call(this,d("buffer").Buffer)},{"./bitpacker":2,"./constants":4,"./crc":5,"./filter-pack":6,buffer:32,zlib:31}],15:[function(d,m,g){m.exports=function(w,I,P){let F=w+I-P,D=Math.abs(F-w),$=Math.abs(F-I),U=Math.abs(F-P);return D<=$&&D<=U?w:$<=U?I:P}},{}],16:[function(d,m,g){let w=d("util"),I=d("zlib"),P=d("./chunkstream"),F=d("./filter-parse-async"),D=d("./parser"),$=d("./bitmapper"),U=d("./format-normaliser"),j=m.exports=function(Z){P.call(this),this._parser=new D(Z,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=Z,this.writable=!0,this._parser.start()};w.inherits(j,P),j.prototype._handleError=function(Z){this.emit("error",Z),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},j.prototype._inflateData=function(Z){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=I.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let G=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,H=Math.max(G,I.Z_MIN_CHUNK);this._inflate=I.createInflate({chunkSize:H});let W=G,Q=this.emit.bind(this,"error");this._inflate.on("error",(function(rt){W&&Q(rt)})),this._filter.on("complete",this._complete.bind(this));let q=this._filter.write.bind(this._filter);this._inflate.on("data",(function(rt){W&&(rt.length>W&&(rt=rt.slice(0,W)),W-=rt.length,q(rt))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(Z)},j.prototype._handleMetaData=function(Z){this._metaData=Z,this._bitmapInfo=Object.create(Z),this._filter=new F(this._bitmapInfo)},j.prototype._handleTransColor=function(Z){this._bitmapInfo.transColor=Z},j.prototype._handlePalette=function(Z){this._bitmapInfo.palette=Z},j.prototype._simpleTransparency=function(){this._metaData.alpha=!0},j.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},j.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},j.prototype._complete=function(Z){if(this.errord)return;let G;try{let H=$.dataToBitMap(Z,this._bitmapInfo);G=U(H,this._bitmapInfo,this._options.skipRescale),H=null}catch(H){return void this._handleError(H)}this.emit("parsed",G)}},{"./bitmapper":1,"./chunkstream":3,"./filter-parse-async":7,"./format-normaliser":10,"./parser":18,util:84,zlib:31}],17:[function(d,m,g){(function(w){(function(){let I=!0,P=d("zlib"),F=d("./sync-inflate");P.deflateSync||(I=!1);let D=d("./sync-reader"),$=d("./filter-parse-sync"),U=d("./parser"),j=d("./bitmapper"),Z=d("./format-normaliser");m.exports=function(G,H){if(!I)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let W,Q,q;function rt(ft){W=ft}function et(ft){Q=ft}function X(ft){Q.transColor=ft}function J(ft){Q.palette=ft}function tt(){Q.alpha=!0}function st(ft){q=ft}let nt=[];function lt(ft){nt.push(ft)}let at=new D(G);if(new U(H,{read:at.read.bind(at),error:rt,metadata:et,gamma:st,palette:J,transColor:X,inflateData:lt,simpleTransparency:tt}).start(),at.process(),W)throw W;let ct,V=w.concat(nt);if(nt.length=0,Q.interlace)ct=P.inflateSync(V);else{let ft=(1+(Q.width*Q.bpp*Q.depth+7>>3))*Q.height;ct=F(V,{chunkSize:ft,maxLength:ft})}if(V=null,!ct||!ct.length)throw new Error("bad png - invalid inflate data response");let ut=$.process(ct,Q);V=null;let wt=j.dataToBitMap(ut,Q);ut=null;let dt=Z(wt,Q,H.skipRescale);return Q.data=dt,Q.gamma=q||0,Q}}).call(this)}).call(this,d("buffer").Buffer)},{"./bitmapper":1,"./filter-parse-sync":8,"./format-normaliser":10,"./parser":18,"./sync-inflate":21,"./sync-reader":22,buffer:32,zlib:31}],18:[function(d,m,g){(function(w){(function(){let I=d("./constants"),P=d("./crc"),F=m.exports=function(D,$){this._options=D,D.checkCRC=D.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[I.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[I.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[I.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[I.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[I.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[I.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=$.read,this.error=$.error,this.metadata=$.metadata,this.gamma=$.gamma,this.transColor=$.transColor,this.palette=$.palette,this.parsed=$.parsed,this.inflateData=$.inflateData,this.finished=$.finished,this.simpleTransparency=$.simpleTransparency,this.headersFinished=$.headersFinished||function(){}};F.prototype.start=function(){this.read(I.PNG_SIGNATURE.length,this._parseSignature.bind(this))},F.prototype._parseSignature=function(D){let $=I.PNG_SIGNATURE;for(let U=0;U<$.length;U++)if(D[U]!==$[U])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},F.prototype._parseChunkBegin=function(D){let $=D.readUInt32BE(0),U=D.readUInt32BE(4),j="";for(let G=4;G<8;G++)j+=String.fromCharCode(D[G]);let Z=!!(32&D[4]);if(this._hasIHDR||U===I.TYPE_IHDR){if(this._crc=new P,this._crc.write(w.from(j)),this._chunks[U])return this._chunks[U]($);Z?this.read($+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+j))}else this.error(new Error("Expected IHDR on beggining"))},F.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},F.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},F.prototype._parseChunkEnd=function(D){let $=D.readInt32BE(0),U=this._crc.crc32();this._options.checkCRC&&U!==$?this.error(new Error("Crc error - "+$+" - "+U)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},F.prototype._handleIHDR=function(D){this.read(D,this._parseIHDR.bind(this))},F.prototype._parseIHDR=function(D){this._crc.write(D);let $=D.readUInt32BE(0),U=D.readUInt32BE(4),j=D[8],Z=D[9],G=D[10],H=D[11],W=D[12];if(j!==8&&j!==4&&j!==2&&j!==1&&j!==16)return void this.error(new Error("Unsupported bit depth "+j));if(!(Z in I.COLORTYPE_TO_BPP_MAP))return void this.error(new Error("Unsupported color type"));if(G!==0)return void this.error(new Error("Unsupported compression method"));if(H!==0)return void this.error(new Error("Unsupported filter method"));if(W!==0&&W!==1)return void this.error(new Error("Unsupported interlace method"));this._colorType=Z;let Q=I.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:$,height:U,depth:j,interlace:!!W,palette:!!(Z&I.COLORTYPE_PALETTE),color:!!(Z&I.COLORTYPE_COLOR),alpha:!!(Z&I.COLORTYPE_ALPHA),bpp:Q,colorType:Z}),this._handleChunkEnd()},F.prototype._handlePLTE=function(D){this.read(D,this._parsePLTE.bind(this))},F.prototype._parsePLTE=function(D){this._crc.write(D);let $=Math.floor(D.length/3);for(let U=0;U<$;U++)this._palette.push([D[3*U],D[3*U+1],D[3*U+2],255]);this.palette(this._palette),this._handleChunkEnd()},F.prototype._handleTRNS=function(D){this.simpleTransparency(),this.read(D,this._parseTRNS.bind(this))},F.prototype._parseTRNS=function(D){if(this._crc.write(D),this._colorType===I.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0)return void this.error(new Error("Transparency chunk must be after palette"));if(D.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(let $=0;$<D.length;$++)this._palette[$][3]=D[$];this.palette(this._palette)}this._colorType===I.COLORTYPE_GRAYSCALE&&this.transColor([D.readUInt16BE(0)]),this._colorType===I.COLORTYPE_COLOR&&this.transColor([D.readUInt16BE(0),D.readUInt16BE(2),D.readUInt16BE(4)]),this._handleChunkEnd()},F.prototype._handleGAMA=function(D){this.read(D,this._parseGAMA.bind(this))},F.prototype._parseGAMA=function(D){this._crc.write(D),this.gamma(D.readUInt32BE(0)/I.GAMMA_DIVISION),this._handleChunkEnd()},F.prototype._handleIDAT=function(D){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-D,this._parseIDAT.bind(this,D))},F.prototype._parseIDAT=function(D,$){if(this._crc.write($),this._colorType===I.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData($);let U=D-$.length;U>0?this._handleIDAT(U):this._handleChunkEnd()},F.prototype._handleIEND=function(D){this.read(D,this._parseIEND.bind(this))},F.prototype._parseIEND=function(D){this._crc.write(D),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./crc":5,buffer:32}],19:[function(d,m,g){let w=d("./parser-sync"),I=d("./packer-sync");g.read=function(P,F){return w(P,F||{})},g.write=function(P,F){return I(P,F)}},{"./packer-sync":13,"./parser-sync":17}],20:[function(d,m,g){(function(w,I){(function(){let P=d("util"),F=d("stream"),D=d("./parser-async"),$=d("./packer-async"),U=d("./png-sync"),j=g.PNG=function(Z){F.call(this),Z=Z||{},this.width=0|Z.width,this.height=0|Z.height,this.data=this.width>0&&this.height>0?I.alloc(4*this.width*this.height):null,Z.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new D(Z),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(G){this.data=G,this.emit("parsed",G)}.bind(this)),this._packer=new $(Z),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};P.inherits(j,F),j.sync=U,j.prototype.pack=function(){return this.data&&this.data.length?(w.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},j.prototype.parse=function(Z,G){if(G){let H,W;H=function(Q){this.removeListener("error",W),this.data=Q,G(null,this)}.bind(this),W=function(Q){this.removeListener("parsed",H),G(Q,null)}.bind(this),this.once("parsed",H),this.once("error",W)}return this.end(Z),this},j.prototype.write=function(Z){return this._parser.write(Z),!0},j.prototype.end=function(Z){this._parser.end(Z)},j.prototype._metadata=function(Z){this.width=Z.width,this.height=Z.height,this.emit("metadata",Z)},j.prototype._gamma=function(Z){this.gamma=Z},j.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},j.bitblt=function(Z,G,H,W,Q,q,rt,et){if(W|=0,Q|=0,q|=0,rt|=0,et|=0,(H|=0)>Z.width||W>Z.height||H+Q>Z.width||W+q>Z.height)throw new Error("bitblt reading outside image");if(rt>G.width||et>G.height||rt+Q>G.width||et+q>G.height)throw new Error("bitblt writing outside image");for(let X=0;X<q;X++)Z.data.copy(G.data,(et+X)*G.width+rt<<2,(W+X)*Z.width+H<<2,(W+X)*Z.width+H+Q<<2)},j.prototype.bitblt=function(Z,G,H,W,Q,q,rt){return j.bitblt(this,Z,G,H,W,Q,q,rt),this},j.adjustGamma=function(Z){if(Z.gamma){for(let G=0;G<Z.height;G++)for(let H=0;H<Z.width;H++){let W=Z.width*G+H<<2;for(let Q=0;Q<3;Q++){let q=Z.data[W+Q]/255;q=Math.pow(q,1/2.2/Z.gamma),Z.data[W+Q]=Math.round(255*q)}}Z.gamma=0}},j.prototype.adjustGamma=function(){j.adjustGamma(this)}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{"./packer-async":12,"./parser-async":16,"./png-sync":19,_process:63,buffer:32,stream:65,util:84}],21:[function(d,m,g){(function(w,I){(function(){let P=d("assert").ok,F=d("zlib"),D=d("util"),$=d("buffer").kMaxLength;function U(W){if(!(this instanceof U))return new U(W);W&&W.chunkSize<F.Z_MIN_CHUNK&&(W.chunkSize=F.Z_MIN_CHUNK),F.Inflate.call(this,W),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,W&&W.maxLength!=null&&(this._maxLength=W.maxLength)}function j(W){return new U(W)}function Z(W,Q){W._handle&&(W._handle.close(),W._handle=null)}function G(W,Q){if(typeof Q=="string"&&(Q=I.from(Q)),!(Q instanceof I))throw new TypeError("Not a string or buffer");let q=W._finishFlushFlag;return q==null&&(q=F.Z_FINISH),W._processChunk(Q,q)}function H(W,Q){return G(new U(Q),W)}U.prototype._processChunk=function(W,Q,q){if(typeof q=="function")return F.Inflate._processChunk.call(this,W,Q,q);let rt,et,X=this,J=W&&W.length,tt=this._chunkSize-this._offset,st=this._maxLength,nt=0,lt=[],at=0;function ct(ut,wt){if(X._hadError)return;let dt=tt-wt;if(P(dt>=0,"have should not go down"),dt>0){let ft=X._buffer.slice(X._offset,X._offset+dt);if(X._offset+=dt,ft.length>st&&(ft=ft.slice(0,st)),lt.push(ft),at+=ft.length,st-=ft.length,st===0)return!1}return(wt===0||X._offset>=X._chunkSize)&&(tt=X._chunkSize,X._offset=0,X._buffer=I.allocUnsafe(X._chunkSize)),wt===0&&(nt+=J-ut,J=ut,!0)}this.on("error",(function(ut){rt=ut})),P(this._handle,"zlib binding closed");do et=this._handle.writeSync(Q,W,nt,J,this._buffer,this._offset,tt),et=et||this._writeState;while(!this._hadError&&ct(et[0],et[1]));if(this._hadError)throw rt;if(at>=$)throw Z(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+$.toString(16)+" bytes");let V=I.concat(lt,at);return Z(this),V},D.inherits(U,F.Inflate),m.exports=g=H,g.Inflate=U,g.createInflate=j,g.inflateSync=H}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,assert:23,buffer:32,util:84,zlib:31}],22:[function(d,m,g){let w=m.exports=function(I){this._buffer=I,this._reads=[]};w.prototype.read=function(I,P){this._reads.push({length:Math.abs(I),allowLess:I<0,func:P})},w.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let I=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=I.length||I.allowLess))break;{this._reads.shift();let P=this._buffer;this._buffer=P.slice(I.length),I.func.call(this,P.slice(0,I.length))}}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}},{}],23:[function(d,m,g){(function(w){(function(){var I=d("object-assign");function P(dt,ft){if(dt===ft)return 0;for(var pt=dt.length,Pt=ft.length,It=0,xt=Math.min(pt,Pt);It<xt;++It)if(dt[It]!==ft[It]){pt=dt[It],Pt=ft[It];break}return pt<Pt?-1:Pt<pt?1:0}function F(dt){return w.Buffer&&typeof w.Buffer.isBuffer=="function"?w.Buffer.isBuffer(dt):!(dt==null||!dt._isBuffer)}var D=d("util/"),$=Object.prototype.hasOwnProperty,U=Array.prototype.slice,j=function(){}.name==="foo";function Z(dt){return Object.prototype.toString.call(dt)}function G(dt){return!F(dt)&&typeof w.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(dt):!!dt&&(dt instanceof DataView||!!(dt.buffer&&dt.buffer instanceof ArrayBuffer)))}var H=m.exports=J,W=/\s*function\s+([^\(\s]*)\s*/;function Q(dt){if(D.isFunction(dt)){if(j)return dt.name;var ft=dt.toString().match(W);return ft&&ft[1]}}function q(dt,ft){return typeof dt=="string"?dt.length<ft?dt:dt.slice(0,ft):dt}function rt(dt){if(j||!D.isFunction(dt))return D.inspect(dt);var ft=Q(dt);return"[Function"+(ft?": "+ft:"")+"]"}function et(dt){return q(rt(dt.actual),128)+" "+dt.operator+" "+q(rt(dt.expected),128)}function X(dt,ft,pt,Pt,It){throw new H.AssertionError({message:pt,actual:dt,expected:ft,operator:Pt,stackStartFunction:It})}function J(dt,ft){dt||X(dt,!0,ft,"==",H.ok)}function tt(dt,ft,pt,Pt){if(dt===ft)return!0;if(F(dt)&&F(ft))return P(dt,ft)===0;if(D.isDate(dt)&&D.isDate(ft))return dt.getTime()===ft.getTime();if(D.isRegExp(dt)&&D.isRegExp(ft))return dt.source===ft.source&&dt.global===ft.global&&dt.multiline===ft.multiline&&dt.lastIndex===ft.lastIndex&&dt.ignoreCase===ft.ignoreCase;if(dt!==null&&typeof dt=="object"||ft!==null&&typeof ft=="object"){if(G(dt)&&G(ft)&&Z(dt)===Z(ft)&&!(dt instanceof Float32Array||dt instanceof Float64Array))return P(new Uint8Array(dt.buffer),new Uint8Array(ft.buffer))===0;if(F(dt)!==F(ft))return!1;var It=(Pt=Pt||{actual:[],expected:[]}).actual.indexOf(dt);return It!==-1&&It===Pt.expected.indexOf(ft)||(Pt.actual.push(dt),Pt.expected.push(ft),nt(dt,ft,pt,Pt))}return pt?dt===ft:dt==ft}function st(dt){return Object.prototype.toString.call(dt)=="[object Arguments]"}function nt(dt,ft,pt,Pt){if(dt==null||ft==null)return!1;if(D.isPrimitive(dt)||D.isPrimitive(ft))return dt===ft;if(pt&&Object.getPrototypeOf(dt)!==Object.getPrototypeOf(ft))return!1;var It=st(dt),xt=st(ft);if(It&&!xt||!It&&xt)return!1;if(It)return tt(dt=U.call(dt),ft=U.call(ft),pt);var Ft,Et,Ct=wt(dt),Ot=wt(ft);if(Ct.length!==Ot.length)return!1;for(Ct.sort(),Ot.sort(),Et=Ct.length-1;Et>=0;Et--)if(Ct[Et]!==Ot[Et])return!1;for(Et=Ct.length-1;Et>=0;Et--)if(!tt(dt[Ft=Ct[Et]],ft[Ft],pt,Pt))return!1;return!0}function lt(dt,ft,pt){tt(dt,ft,!0)&&X(dt,ft,pt,"notDeepStrictEqual",lt)}function at(dt,ft){if(!dt||!ft)return!1;if(Object.prototype.toString.call(ft)=="[object RegExp]")return ft.test(dt);try{if(dt instanceof ft)return!0}catch{}return!Error.isPrototypeOf(ft)&&ft.call({},dt)===!0}function ct(dt){var ft;try{dt()}catch(pt){ft=pt}return ft}function V(dt,ft,pt,Pt){var It;if(typeof ft!="function")throw new TypeError('"block" argument must be a function');typeof pt=="string"&&(Pt=pt,pt=null),It=ct(ft),Pt=(pt&&pt.name?" ("+pt.name+").":".")+(Pt?" "+Pt:"."),dt&&!It&&X(It,pt,"Missing expected exception"+Pt);var xt=typeof Pt=="string",Ft=!dt&&It&&!pt;if((!dt&&D.isError(It)&&xt&&at(It,pt)||Ft)&&X(It,pt,"Got unwanted exception"+Pt),dt&&It&&pt&&!at(It,pt)||!dt&&It)throw It}function ut(dt,ft){dt||X(dt,!0,ft,"==",ut)}H.AssertionError=function(dt){this.name="AssertionError",this.actual=dt.actual,this.expected=dt.expected,this.operator=dt.operator,dt.message?(this.message=dt.message,this.generatedMessage=!1):(this.message=et(this),this.generatedMessage=!0);var ft=dt.stackStartFunction||X;if(Error.captureStackTrace)Error.captureStackTrace(this,ft);else{var pt=new Error;if(pt.stack){var Pt=pt.stack,It=Q(ft),xt=Pt.indexOf(`
`+It);if(xt>=0){var Ft=Pt.indexOf(`
`,xt+1);Pt=Pt.substring(Ft+1)}this.stack=Pt}}},D.inherits(H.AssertionError,Error),H.fail=X,H.ok=J,H.equal=function(dt,ft,pt){dt!=ft&&X(dt,ft,pt,"==",H.equal)},H.notEqual=function(dt,ft,pt){dt==ft&&X(dt,ft,pt,"!=",H.notEqual)},H.deepEqual=function(dt,ft,pt){tt(dt,ft,!1)||X(dt,ft,pt,"deepEqual",H.deepEqual)},H.deepStrictEqual=function(dt,ft,pt){tt(dt,ft,!0)||X(dt,ft,pt,"deepStrictEqual",H.deepStrictEqual)},H.notDeepEqual=function(dt,ft,pt){tt(dt,ft,!1)&&X(dt,ft,pt,"notDeepEqual",H.notDeepEqual)},H.notDeepStrictEqual=lt,H.strictEqual=function(dt,ft,pt){dt!==ft&&X(dt,ft,pt,"===",H.strictEqual)},H.notStrictEqual=function(dt,ft,pt){dt===ft&&X(dt,ft,pt,"!==",H.notStrictEqual)},H.throws=function(dt,ft,pt){V(!0,dt,ft,pt)},H.doesNotThrow=function(dt,ft,pt){V(!1,dt,ft,pt)},H.ifError=function(dt){if(dt)throw dt},H.strict=I(ut,H,{equal:H.strictEqual,deepEqual:H.deepStrictEqual,notEqual:H.notStrictEqual,notDeepEqual:H.notDeepStrictEqual}),H.strict.strict=H.strict;var wt=Object.keys||function(dt){var ft=[];for(var pt in dt)$.call(dt,pt)&&ft.push(pt);return ft}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":51,"util/":26}],24:[function(d,m,g){typeof Object.create=="function"?m.exports=function(w,I){w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}})}:m.exports=function(w,I){w.super_=I;var P=function(){};P.prototype=I.prototype,w.prototype=new P,w.prototype.constructor=w}},{}],25:[function(d,m,g){m.exports=function(w){return w&&typeof w=="object"&&typeof w.copy=="function"&&typeof w.fill=="function"&&typeof w.readUInt8=="function"}},{}],26:[function(d,m,g){(function(w,I){(function(){var P=/%[sdj%]/g;g.format=function(Et){if(!nt(Et)){for(var Ct=[],Ot=0;Ot<arguments.length;Ot++)Ct.push($(arguments[Ot]));return Ct.join(" ")}Ot=1;for(var Rt=arguments,St=Rt.length,At=String(Et).replace(P,(function(Ut){if(Ut==="%%")return"%";if(Ot>=St)return Ut;switch(Ut){case"%s":return String(Rt[Ot++]);case"%d":return Number(Rt[Ot++]);case"%j":try{return JSON.stringify(Rt[Ot++])}catch{return"[Circular]"}default:return Ut}})),Nt=Rt[Ot];Ot<St;Nt=Rt[++Ot])J(Nt)||!V(Nt)?At+=" "+Nt:At+=" "+$(Nt);return At},g.deprecate=function(Et,Ct){if(at(I.process))return function(){return g.deprecate(Et,Ct).apply(this,arguments)};if(w.noDeprecation===!0)return Et;var Ot=!1;function Rt(){if(!Ot){if(w.throwDeprecation)throw new Error(Ct);w.traceDeprecation?console.trace(Ct):console.error(Ct),Ot=!0}return Et.apply(this,arguments)}return Rt};var F,D={};function $(Et,Ct){var Ot={seen:[],stylize:j};return arguments.length>=3&&(Ot.depth=arguments[2]),arguments.length>=4&&(Ot.colors=arguments[3]),X(Ct)?Ot.showHidden=Ct:Ct&&g._extend(Ot,Ct),at(Ot.showHidden)&&(Ot.showHidden=!1),at(Ot.depth)&&(Ot.depth=2),at(Ot.colors)&&(Ot.colors=!1),at(Ot.customInspect)&&(Ot.customInspect=!0),Ot.colors&&(Ot.stylize=U),G(Ot,Et,Ot.depth)}function U(Et,Ct){var Ot=$.styles[Ct];return Ot?"\x1B["+$.colors[Ot][0]+"m"+Et+"\x1B["+$.colors[Ot][1]+"m":Et}function j(Et,Ct){return Et}function Z(Et){var Ct={};return Et.forEach((function(Ot,Rt){Ct[Ot]=!0})),Ct}function G(Et,Ct,Ot){if(Et.customInspect&&Ct&&dt(Ct.inspect)&&Ct.inspect!==g.inspect&&(!Ct.constructor||Ct.constructor.prototype!==Ct)){var Rt=Ct.inspect(Ot,Et);return nt(Rt)||(Rt=G(Et,Rt,Ot)),Rt}var St=H(Et,Ct);if(St)return St;var At=Object.keys(Ct),Nt=Z(At);if(Et.showHidden&&(At=Object.getOwnPropertyNames(Ct)),wt(Ct)&&(At.indexOf("message")>=0||At.indexOf("description")>=0))return W(Ct);if(At.length===0){if(dt(Ct)){var Ut=Ct.name?": "+Ct.name:"";return Et.stylize("[Function"+Ut+"]","special")}if(ct(Ct))return Et.stylize(RegExp.prototype.toString.call(Ct),"regexp");if(ut(Ct))return Et.stylize(Date.prototype.toString.call(Ct),"date");if(wt(Ct))return W(Ct)}var jt,Tt="",it=!1,Mt=["{","}"];return et(Ct)&&(it=!0,Mt=["[","]"]),dt(Ct)&&(Tt=" [Function"+(Ct.name?": "+Ct.name:"")+"]"),ct(Ct)&&(Tt=" "+RegExp.prototype.toString.call(Ct)),ut(Ct)&&(Tt=" "+Date.prototype.toUTCString.call(Ct)),wt(Ct)&&(Tt=" "+W(Ct)),At.length!==0||it&&Ct.length!=0?Ot<0?ct(Ct)?Et.stylize(RegExp.prototype.toString.call(Ct),"regexp"):Et.stylize("[Object]","special"):(Et.seen.push(Ct),jt=it?Q(Et,Ct,Ot,Nt,At):At.map((function(mt){return q(Et,Ct,Ot,Nt,mt,it)})),Et.seen.pop(),rt(jt,Tt,Mt)):Mt[0]+Tt+Mt[1]}function H(Et,Ct){if(at(Ct))return Et.stylize("undefined","undefined");if(nt(Ct)){var Ot="'"+JSON.stringify(Ct).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Et.stylize(Ot,"string")}return st(Ct)?Et.stylize(""+Ct,"number"):X(Ct)?Et.stylize(""+Ct,"boolean"):J(Ct)?Et.stylize("null","null"):void 0}function W(Et){return"["+Error.prototype.toString.call(Et)+"]"}function Q(Et,Ct,Ot,Rt,St){for(var At=[],Nt=0,Ut=Ct.length;Nt<Ut;++Nt)Ft(Ct,String(Nt))?At.push(q(Et,Ct,Ot,Rt,String(Nt),!0)):At.push("");return St.forEach((function(jt){jt.match(/^\d+$/)||At.push(q(Et,Ct,Ot,Rt,jt,!0))})),At}function q(Et,Ct,Ot,Rt,St,At){var Nt,Ut,jt;if((jt=Object.getOwnPropertyDescriptor(Ct,St)||{value:Ct[St]}).get?Ut=jt.set?Et.stylize("[Getter/Setter]","special"):Et.stylize("[Getter]","special"):jt.set&&(Ut=Et.stylize("[Setter]","special")),Ft(Rt,St)||(Nt="["+St+"]"),Ut||(Et.seen.indexOf(jt.value)<0?(Ut=J(Ot)?G(Et,jt.value,null):G(Et,jt.value,Ot-1)).indexOf(`
`)>-1&&(Ut=At?Ut.split(`
`).map((function(Tt){return"  "+Tt})).join(`
`).substr(2):`
`+Ut.split(`
`).map((function(Tt){return"   "+Tt})).join(`
`)):Ut=Et.stylize("[Circular]","special")),at(Nt)){if(At&&St.match(/^\d+$/))return Ut;(Nt=JSON.stringify(""+St)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Nt=Nt.substr(1,Nt.length-2),Nt=Et.stylize(Nt,"name")):(Nt=Nt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Nt=Et.stylize(Nt,"string"))}return Nt+": "+Ut}function rt(Et,Ct,Ot){return Et.reduce((function(Rt,St){return St.indexOf(`
`),Rt+St.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?Ot[0]+(Ct===""?"":Ct+`
 `)+" "+Et.join(`,
  `)+" "+Ot[1]:Ot[0]+Ct+" "+Et.join(", ")+" "+Ot[1]}function et(Et){return Array.isArray(Et)}function X(Et){return typeof Et=="boolean"}function J(Et){return Et===null}function tt(Et){return Et==null}function st(Et){return typeof Et=="number"}function nt(Et){return typeof Et=="string"}function lt(Et){return typeof Et=="symbol"}function at(Et){return Et===void 0}function ct(Et){return V(Et)&&pt(Et)==="[object RegExp]"}function V(Et){return typeof Et=="object"&&Et!==null}function ut(Et){return V(Et)&&pt(Et)==="[object Date]"}function wt(Et){return V(Et)&&(pt(Et)==="[object Error]"||Et instanceof Error)}function dt(Et){return typeof Et=="function"}function ft(Et){return Et===null||typeof Et=="boolean"||typeof Et=="number"||typeof Et=="string"||typeof Et=="symbol"||Et===void 0}function pt(Et){return Object.prototype.toString.call(Et)}function Pt(Et){return Et<10?"0"+Et.toString(10):Et.toString(10)}g.debuglog=function(Et){if(at(F)&&(F=w.env.NODE_DEBUG||""),Et=Et.toUpperCase(),!D[Et])if(new RegExp("\\b"+Et+"\\b","i").test(F)){var Ct=w.pid;D[Et]=function(){var Ot=g.format.apply(g,arguments);console.error("%s %d: %s",Et,Ct,Ot)}}else D[Et]=function(){};return D[Et]},g.inspect=$,$.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},$.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},g.isArray=et,g.isBoolean=X,g.isNull=J,g.isNullOrUndefined=tt,g.isNumber=st,g.isString=nt,g.isSymbol=lt,g.isUndefined=at,g.isRegExp=ct,g.isObject=V,g.isDate=ut,g.isError=wt,g.isFunction=dt,g.isPrimitive=ft,g.isBuffer=d("./support/isBuffer");var It=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function xt(){var Et=new Date,Ct=[Pt(Et.getHours()),Pt(Et.getMinutes()),Pt(Et.getSeconds())].join(":");return[Et.getDate(),It[Et.getMonth()],Ct].join(" ")}function Ft(Et,Ct){return Object.prototype.hasOwnProperty.call(Et,Ct)}g.log=function(){console.log("%s - %s",xt(),g.format.apply(g,arguments))},g.inherits=d("inherits"),g._extend=function(Et,Ct){if(!Ct||!V(Ct))return Et;for(var Ot=Object.keys(Ct),Rt=Ot.length;Rt--;)Et[Ot[Rt]]=Ct[Ot[Rt]];return Et}}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":25,_process:63,inherits:24}],27:[function(d,m,g){(function(w){(function(){var I=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],P=typeof globalThis>"u"?w:globalThis;m.exports=function(){for(var F=[],D=0;D<I.length;D++)typeof P[I[D]]=="function"&&(F[F.length]=I[D]);return F}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(d,m,g){g.byteLength=j,g.toByteArray=G,g.fromByteArray=Q;for(var w=[],I=[],P=typeof Uint8Array<"u"?Uint8Array:Array,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D=0,$=F.length;D<$;++D)w[D]=F[D],I[F.charCodeAt(D)]=D;function U(q){var rt=q.length;if(rt%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var et=q.indexOf("=");return et===-1&&(et=rt),[et,et===rt?0:4-et%4]}function j(q){var rt=U(q),et=rt[0],X=rt[1];return 3*(et+X)/4-X}function Z(q,rt,et){return 3*(rt+et)/4-et}function G(q){var rt,et,X=U(q),J=X[0],tt=X[1],st=new P(Z(q,J,tt)),nt=0,lt=tt>0?J-4:J;for(et=0;et<lt;et+=4)rt=I[q.charCodeAt(et)]<<18|I[q.charCodeAt(et+1)]<<12|I[q.charCodeAt(et+2)]<<6|I[q.charCodeAt(et+3)],st[nt++]=rt>>16&255,st[nt++]=rt>>8&255,st[nt++]=255&rt;return tt===2&&(rt=I[q.charCodeAt(et)]<<2|I[q.charCodeAt(et+1)]>>4,st[nt++]=255&rt),tt===1&&(rt=I[q.charCodeAt(et)]<<10|I[q.charCodeAt(et+1)]<<4|I[q.charCodeAt(et+2)]>>2,st[nt++]=rt>>8&255,st[nt++]=255&rt),st}function H(q){return w[q>>18&63]+w[q>>12&63]+w[q>>6&63]+w[63&q]}function W(q,rt,et){for(var X,J=[],tt=rt;tt<et;tt+=3)X=(q[tt]<<16&16711680)+(q[tt+1]<<8&65280)+(255&q[tt+2]),J.push(H(X));return J.join("")}function Q(q){for(var rt,et=q.length,X=et%3,J=[],tt=16383,st=0,nt=et-X;st<nt;st+=tt)J.push(W(q,st,st+tt>nt?nt:st+tt));return X===1?(rt=q[et-1],J.push(w[rt>>2]+w[rt<<4&63]+"==")):X===2&&(rt=(q[et-2]<<8)+q[et-1],J.push(w[rt>>10]+w[rt>>4&63]+w[rt<<2&63]+"=")),J.join("")}I[45]=62,I[95]=63},{}],29:[function(d,m,g){},{}],30:[function(d,m,g){(function(w,I){(function(){var P=d("assert"),F=d("pako/lib/zlib/zstream"),D=d("pako/lib/zlib/deflate.js"),$=d("pako/lib/zlib/inflate.js"),U=d("pako/lib/zlib/constants");for(var j in U)g[j]=U[j];g.NONE=0,g.DEFLATE=1,g.INFLATE=2,g.GZIP=3,g.GUNZIP=4,g.DEFLATERAW=5,g.INFLATERAW=6,g.UNZIP=7;var Z=31,G=139;function H(W){if(typeof W!="number"||W<g.DEFLATE||W>g.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=W,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}H.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,P(this.init_done,"close before init"),P(this.mode<=g.UNZIP),this.mode===g.DEFLATE||this.mode===g.GZIP||this.mode===g.DEFLATERAW?D.deflateEnd(this.strm):this.mode!==g.INFLATE&&this.mode!==g.GUNZIP&&this.mode!==g.INFLATERAW&&this.mode!==g.UNZIP||$.inflateEnd(this.strm),this.mode=g.NONE,this.dictionary=null)},H.prototype.write=function(W,Q,q,rt,et,X,J){return this._write(!0,W,Q,q,rt,et,X,J)},H.prototype.writeSync=function(W,Q,q,rt,et,X,J){return this._write(!1,W,Q,q,rt,et,X,J)},H.prototype._write=function(W,Q,q,rt,et,X,J,tt){if(P.equal(arguments.length,8),P(this.init_done,"write before init"),P(this.mode!==g.NONE,"already finalized"),P.equal(!1,this.write_in_progress,"write already in progress"),P.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,P.equal(!1,Q===void 0,"must provide flush value"),this.write_in_progress=!0,Q!==g.Z_NO_FLUSH&&Q!==g.Z_PARTIAL_FLUSH&&Q!==g.Z_SYNC_FLUSH&&Q!==g.Z_FULL_FLUSH&&Q!==g.Z_FINISH&&Q!==g.Z_BLOCK)throw new Error("Invalid flush value");if(q==null&&(q=I.alloc(0),et=0,rt=0),this.strm.avail_in=et,this.strm.input=q,this.strm.next_in=rt,this.strm.avail_out=tt,this.strm.output=X,this.strm.next_out=J,this.flush=Q,!W)return this._process(),this._checkError()?this._afterSync():void 0;var st=this;return w.nextTick((function(){st._process(),st._after()})),this},H.prototype._afterSync=function(){var W=this.strm.avail_out,Q=this.strm.avail_in;return this.write_in_progress=!1,[Q,W]},H.prototype._process=function(){var W=null;switch(this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=D.deflate(this.strm,this.flush);break;case g.UNZIP:switch(this.strm.avail_in>0&&(W=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(W===null)break;if(this.strm.input[W]!==Z){this.mode=g.INFLATE;break}if(this.gzip_id_bytes_read=1,W++,this.strm.avail_in===1)break;case 1:if(W===null)break;this.strm.input[W]===G?(this.gzip_id_bytes_read=2,this.mode=g.GUNZIP):this.mode=g.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:for(this.err=$.inflate(this.strm,this.flush),this.err===g.Z_NEED_DICT&&this.dictionary&&(this.err=$.inflateSetDictionary(this.strm,this.dictionary),this.err===g.Z_OK?this.err=$.inflate(this.strm,this.flush):this.err===g.Z_DATA_ERROR&&(this.err=g.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===g.GUNZIP&&this.err===g.Z_STREAM_END&&this.strm.next_in[0]!==0;)this.reset(),this.err=$.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},H.prototype._checkError=function(){switch(this.err){case g.Z_OK:case g.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===g.Z_FINISH)return this._error("unexpected end of file"),!1;break;case g.Z_STREAM_END:break;case g.Z_NEED_DICT:return this.dictionary==null?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},H.prototype._after=function(){if(this._checkError()){var W=this.strm.avail_out,Q=this.strm.avail_in;this.write_in_progress=!1,this.callback(Q,W),this.pending_close&&this.close()}},H.prototype._error=function(W){this.strm.msg&&(W=this.strm.msg),this.onerror(W,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},H.prototype.init=function(W,Q,q,rt,et){P(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])"),P(W>=8&&W<=15,"invalid windowBits"),P(Q>=-1&&Q<=9,"invalid compression level"),P(q>=1&&q<=9,"invalid memlevel"),P(rt===g.Z_FILTERED||rt===g.Z_HUFFMAN_ONLY||rt===g.Z_RLE||rt===g.Z_FIXED||rt===g.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(Q,W,q,rt,et),this._setDictionary()},H.prototype.params=function(){throw new Error("deflateParams Not supported")},H.prototype.reset=function(){this._reset(),this._setDictionary()},H.prototype._init=function(W,Q,q,rt,et){switch(this.level=W,this.windowBits=Q,this.memLevel=q,this.strategy=rt,this.flush=g.Z_NO_FLUSH,this.err=g.Z_OK,this.mode!==g.GZIP&&this.mode!==g.GUNZIP||(this.windowBits+=16),this.mode===g.UNZIP&&(this.windowBits+=32),this.mode!==g.DEFLATERAW&&this.mode!==g.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new F,this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=D.deflateInit2(this.strm,this.level,g.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:case g.UNZIP:this.err=$.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==g.Z_OK&&this._error("Init error"),this.dictionary=et,this.write_in_progress=!1,this.init_done=!0},H.prototype._setDictionary=function(){if(this.dictionary!=null){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:this.err=D.deflateSetDictionary(this.strm,this.dictionary)}this.err!==g.Z_OK&&this._error("Failed to set dictionary")}},H.prototype._reset=function(){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:case g.GZIP:this.err=D.deflateReset(this.strm);break;case g.INFLATE:case g.INFLATERAW:case g.GUNZIP:this.err=$.inflateReset(this.strm)}this.err!==g.Z_OK&&this._error("Failed to reset stream")},g.Zlib=H}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,assert:23,buffer:32,"pako/lib/zlib/constants":54,"pako/lib/zlib/deflate.js":56,"pako/lib/zlib/inflate.js":58,"pako/lib/zlib/zstream":62}],31:[function(d,m,g){(function(w){(function(){var I=d("buffer").Buffer,P=d("stream").Transform,F=d("./binding"),D=d("util"),$=d("assert").ok,U=d("buffer").kMaxLength,j="Cannot create final Buffer. It would be larger than 0x"+U.toString(16)+" bytes";F.Z_MIN_WINDOWBITS=8,F.Z_MAX_WINDOWBITS=15,F.Z_DEFAULT_WINDOWBITS=15,F.Z_MIN_CHUNK=64,F.Z_MAX_CHUNK=1/0,F.Z_DEFAULT_CHUNK=16384,F.Z_MIN_MEMLEVEL=1,F.Z_MAX_MEMLEVEL=9,F.Z_DEFAULT_MEMLEVEL=8,F.Z_MIN_LEVEL=-1,F.Z_MAX_LEVEL=9,F.Z_DEFAULT_LEVEL=F.Z_DEFAULT_COMPRESSION;for(var Z=Object.keys(F),G=0;G<Z.length;G++){var H=Z[G];H.match(/^Z/)&&Object.defineProperty(g,H,{enumerable:!0,value:F[H],writable:!1})}for(var W={Z_OK:F.Z_OK,Z_STREAM_END:F.Z_STREAM_END,Z_NEED_DICT:F.Z_NEED_DICT,Z_ERRNO:F.Z_ERRNO,Z_STREAM_ERROR:F.Z_STREAM_ERROR,Z_DATA_ERROR:F.Z_DATA_ERROR,Z_MEM_ERROR:F.Z_MEM_ERROR,Z_BUF_ERROR:F.Z_BUF_ERROR,Z_VERSION_ERROR:F.Z_VERSION_ERROR},Q=Object.keys(W),q=0;q<Q.length;q++){var rt=Q[q];W[W[rt]]=rt}function et(ft,pt,Pt){var It=[],xt=0;function Ft(){for(var Ot;(Ot=ft.read())!==null;)It.push(Ot),xt+=Ot.length;ft.once("readable",Ft)}function Et(Ot){ft.removeListener("end",Ct),ft.removeListener("readable",Ft),Pt(Ot)}function Ct(){var Ot,Rt=null;xt>=U?Rt=new RangeError(j):Ot=I.concat(It,xt),It=[],ft.close(),Pt(Rt,Ot)}ft.on("error",Et),ft.on("end",Ct),ft.end(pt),Ft()}function X(ft,pt){if(typeof pt=="string"&&(pt=I.from(pt)),!I.isBuffer(pt))throw new TypeError("Not a string or buffer");var Pt=ft._finishFlushFlag;return ft._processChunk(pt,Pt)}function J(ft){if(!(this instanceof J))return new J(ft);ut.call(this,ft,F.DEFLATE)}function tt(ft){if(!(this instanceof tt))return new tt(ft);ut.call(this,ft,F.INFLATE)}function st(ft){if(!(this instanceof st))return new st(ft);ut.call(this,ft,F.GZIP)}function nt(ft){if(!(this instanceof nt))return new nt(ft);ut.call(this,ft,F.GUNZIP)}function lt(ft){if(!(this instanceof lt))return new lt(ft);ut.call(this,ft,F.DEFLATERAW)}function at(ft){if(!(this instanceof at))return new at(ft);ut.call(this,ft,F.INFLATERAW)}function ct(ft){if(!(this instanceof ct))return new ct(ft);ut.call(this,ft,F.UNZIP)}function V(ft){return ft===F.Z_NO_FLUSH||ft===F.Z_PARTIAL_FLUSH||ft===F.Z_SYNC_FLUSH||ft===F.Z_FULL_FLUSH||ft===F.Z_FINISH||ft===F.Z_BLOCK}function ut(ft,pt){var Pt=this;if(this._opts=ft=ft||{},this._chunkSize=ft.chunkSize||g.Z_DEFAULT_CHUNK,P.call(this,ft),ft.flush&&!V(ft.flush))throw new Error("Invalid flush flag: "+ft.flush);if(ft.finishFlush&&!V(ft.finishFlush))throw new Error("Invalid flush flag: "+ft.finishFlush);if(this._flushFlag=ft.flush||F.Z_NO_FLUSH,this._finishFlushFlag=ft.finishFlush!==void 0?ft.finishFlush:F.Z_FINISH,ft.chunkSize&&(ft.chunkSize<g.Z_MIN_CHUNK||ft.chunkSize>g.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+ft.chunkSize);if(ft.windowBits&&(ft.windowBits<g.Z_MIN_WINDOWBITS||ft.windowBits>g.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+ft.windowBits);if(ft.level&&(ft.level<g.Z_MIN_LEVEL||ft.level>g.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+ft.level);if(ft.memLevel&&(ft.memLevel<g.Z_MIN_MEMLEVEL||ft.memLevel>g.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+ft.memLevel);if(ft.strategy&&ft.strategy!=g.Z_FILTERED&&ft.strategy!=g.Z_HUFFMAN_ONLY&&ft.strategy!=g.Z_RLE&&ft.strategy!=g.Z_FIXED&&ft.strategy!=g.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+ft.strategy);if(ft.dictionary&&!I.isBuffer(ft.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new F.Zlib(pt);var It=this;this._hadError=!1,this._handle.onerror=function(Et,Ct){wt(It),It._hadError=!0;var Ot=new Error(Et);Ot.errno=Ct,Ot.code=g.codes[Ct],It.emit("error",Ot)};var xt=g.Z_DEFAULT_COMPRESSION;typeof ft.level=="number"&&(xt=ft.level);var Ft=g.Z_DEFAULT_STRATEGY;typeof ft.strategy=="number"&&(Ft=ft.strategy),this._handle.init(ft.windowBits||g.Z_DEFAULT_WINDOWBITS,xt,ft.memLevel||g.Z_DEFAULT_MEMLEVEL,Ft,ft.dictionary),this._buffer=I.allocUnsafe(this._chunkSize),this._offset=0,this._level=xt,this._strategy=Ft,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!Pt._handle},configurable:!0,enumerable:!0})}function wt(ft,pt){pt&&w.nextTick(pt),ft._handle&&(ft._handle.close(),ft._handle=null)}function dt(ft){ft.emit("close")}Object.defineProperty(g,"codes",{enumerable:!0,value:Object.freeze(W),writable:!1}),g.Deflate=J,g.Inflate=tt,g.Gzip=st,g.Gunzip=nt,g.DeflateRaw=lt,g.InflateRaw=at,g.Unzip=ct,g.createDeflate=function(ft){return new J(ft)},g.createInflate=function(ft){return new tt(ft)},g.createDeflateRaw=function(ft){return new lt(ft)},g.createInflateRaw=function(ft){return new at(ft)},g.createGzip=function(ft){return new st(ft)},g.createGunzip=function(ft){return new nt(ft)},g.createUnzip=function(ft){return new ct(ft)},g.deflate=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new J(pt),ft,Pt)},g.deflateSync=function(ft,pt){return X(new J(pt),ft)},g.gzip=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new st(pt),ft,Pt)},g.gzipSync=function(ft,pt){return X(new st(pt),ft)},g.deflateRaw=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new lt(pt),ft,Pt)},g.deflateRawSync=function(ft,pt){return X(new lt(pt),ft)},g.unzip=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new ct(pt),ft,Pt)},g.unzipSync=function(ft,pt){return X(new ct(pt),ft)},g.inflate=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new tt(pt),ft,Pt)},g.inflateSync=function(ft,pt){return X(new tt(pt),ft)},g.gunzip=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new nt(pt),ft,Pt)},g.gunzipSync=function(ft,pt){return X(new nt(pt),ft)},g.inflateRaw=function(ft,pt,Pt){return typeof pt=="function"&&(Pt=pt,pt={}),et(new at(pt),ft,Pt)},g.inflateRawSync=function(ft,pt){return X(new at(pt),ft)},D.inherits(ut,P),ut.prototype.params=function(ft,pt,Pt){if(ft<g.Z_MIN_LEVEL||ft>g.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+ft);if(pt!=g.Z_FILTERED&&pt!=g.Z_HUFFMAN_ONLY&&pt!=g.Z_RLE&&pt!=g.Z_FIXED&&pt!=g.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+pt);if(this._level!==ft||this._strategy!==pt){var It=this;this.flush(F.Z_SYNC_FLUSH,(function(){$(It._handle,"zlib binding closed"),It._handle.params(ft,pt),It._hadError||(It._level=ft,It._strategy=pt,Pt&&Pt())}))}else w.nextTick(Pt)},ut.prototype.reset=function(){return $(this._handle,"zlib binding closed"),this._handle.reset()},ut.prototype._flush=function(ft){this._transform(I.alloc(0),"",ft)},ut.prototype.flush=function(ft,pt){var Pt=this,It=this._writableState;(typeof ft=="function"||ft===void 0&&!pt)&&(pt=ft,ft=F.Z_FULL_FLUSH),It.ended?pt&&w.nextTick(pt):It.ending?pt&&this.once("end",pt):It.needDrain?pt&&this.once("drain",(function(){return Pt.flush(ft,pt)})):(this._flushFlag=ft,this.write(I.alloc(0),"",pt))},ut.prototype.close=function(ft){wt(this,ft),w.nextTick(dt,this)},ut.prototype._transform=function(ft,pt,Pt){var It,xt=this._writableState,Ft=(xt.ending||xt.ended)&&(!ft||xt.length===ft.length);return ft===null||I.isBuffer(ft)?this._handle?(Ft?It=this._finishFlushFlag:(It=this._flushFlag,ft.length>=xt.length&&(this._flushFlag=this._opts.flush||F.Z_NO_FLUSH)),void this._processChunk(ft,It,Pt)):Pt(new Error("zlib binding closed")):Pt(new Error("invalid input"))},ut.prototype._processChunk=function(ft,pt,Pt){var It=ft&&ft.length,xt=this._chunkSize-this._offset,Ft=0,Et=this,Ct=typeof Pt=="function";if(!Ct){var Ot,Rt=[],St=0;this.on("error",(function(Tt){Ot=Tt})),$(this._handle,"zlib binding closed");do var At=this._handle.writeSync(pt,ft,Ft,It,this._buffer,this._offset,xt);while(!this._hadError&&jt(At[0],At[1]));if(this._hadError)throw Ot;if(St>=U)throw wt(this),new RangeError(j);var Nt=I.concat(Rt,St);return wt(this),Nt}$(this._handle,"zlib binding closed");var Ut=this._handle.write(pt,ft,Ft,It,this._buffer,this._offset,xt);function jt(Tt,it){if(this&&(this.buffer=null,this.callback=null),!Et._hadError){var Mt=xt-it;if($(Mt>=0,"have should not go down"),Mt>0){var mt=Et._buffer.slice(Et._offset,Et._offset+Mt);Et._offset+=Mt,Ct?Et.push(mt):(Rt.push(mt),St+=mt.length)}if((it===0||Et._offset>=Et._chunkSize)&&(xt=Et._chunkSize,Et._offset=0,Et._buffer=I.allocUnsafe(Et._chunkSize)),it===0){if(Ft+=It-Tt,It=Tt,!Ct)return!0;var gt=Et._handle.write(pt,ft,Ft,It,Et._buffer,Et._offset,Et._chunkSize);return gt.callback=jt,void(gt.buffer=ft)}if(!Ct)return!1;Pt()}}Ut.buffer=ft,Ut.callback=jt},D.inherits(J,ut),D.inherits(tt,ut),D.inherits(st,ut),D.inherits(nt,ut),D.inherits(lt,ut),D.inherits(at,ut),D.inherits(ct,ut)}).call(this)}).call(this,d("_process"))},{"./binding":30,_process:63,assert:23,buffer:32,stream:65,util:84}],32:[function(d,m,g){(function(w){(function(){var I=d("base64-js"),P=d("ieee754");g.Buffer=U,g.SlowBuffer=X,g.INSPECT_MAX_BYTES=50;var F=2147483647;function D(){try{var K=new Uint8Array(1);return K.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},K.foo()===42}catch{return!1}}function $(K){if(K>F)throw new RangeError('The value "'+K+'" is invalid for option "size"');var ot=new Uint8Array(K);return ot.__proto__=U.prototype,ot}function U(K,ot,bt){if(typeof K=="number"){if(typeof ot=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return H(K)}return j(K,ot,bt)}function j(K,ot,bt){if(typeof K=="string")return W(K,ot);if(ArrayBuffer.isView(K))return Q(K);if(K==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K);if(vt(K,ArrayBuffer)||K&&vt(K.buffer,ArrayBuffer))return q(K,ot,bt);if(typeof K=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var yt=K.valueOf&&K.valueOf();if(yt!=null&&yt!==K)return U.from(yt,ot,bt);var $t=rt(K);if($t)return $t;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof K[Symbol.toPrimitive]=="function")return U.from(K[Symbol.toPrimitive]("string"),ot,bt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K)}function Z(K){if(typeof K!="number")throw new TypeError('"size" argument must be of type number');if(K<0)throw new RangeError('The value "'+K+'" is invalid for option "size"')}function G(K,ot,bt){return Z(K),K<=0?$(K):ot!==void 0?typeof bt=="string"?$(K).fill(ot,bt):$(K).fill(ot):$(K)}function H(K){return Z(K),$(K<0?0:0|et(K))}function W(K,ot){if(typeof ot=="string"&&ot!==""||(ot="utf8"),!U.isEncoding(ot))throw new TypeError("Unknown encoding: "+ot);var bt=0|J(K,ot),yt=$(bt),$t=yt.write(K,ot);return $t!==bt&&(yt=yt.slice(0,$t)),yt}function Q(K){for(var ot=K.length<0?0:0|et(K.length),bt=$(ot),yt=0;yt<ot;yt+=1)bt[yt]=255&K[yt];return bt}function q(K,ot,bt){if(ot<0||K.byteLength<ot)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<ot+(bt||0))throw new RangeError('"length" is outside of buffer bounds');var yt;return(yt=ot===void 0&&bt===void 0?new Uint8Array(K):bt===void 0?new Uint8Array(K,ot):new Uint8Array(K,ot,bt)).__proto__=U.prototype,yt}function rt(K){if(U.isBuffer(K)){var ot=0|et(K.length),bt=$(ot);return bt.length===0||K.copy(bt,0,0,ot),bt}return K.length!==void 0?typeof K.length!="number"||Bt(K.length)?$(0):Q(K):K.type==="Buffer"&&Array.isArray(K.data)?Q(K.data):void 0}function et(K){if(K>=F)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+F.toString(16)+" bytes");return 0|K}function X(K){return+K!=K&&(K=0),U.alloc(+K)}function J(K,ot){if(U.isBuffer(K))return K.length;if(ArrayBuffer.isView(K)||vt(K,ArrayBuffer))return K.byteLength;if(typeof K!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof K);var bt=K.length,yt=arguments.length>2&&arguments[2]===!0;if(!yt&&bt===0)return 0;for(var $t=!1;;)switch(ot){case"ascii":case"latin1":case"binary":return bt;case"utf8":case"utf-8":return it(K).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*bt;case"hex":return bt>>>1;case"base64":return gt(K).length;default:if($t)return yt?-1:it(K).length;ot=(""+ot).toLowerCase(),$t=!0}}function tt(K,ot,bt){var yt=!1;if((ot===void 0||ot<0)&&(ot=0),ot>this.length||((bt===void 0||bt>this.length)&&(bt=this.length),bt<=0)||(bt>>>=0)<=(ot>>>=0))return"";for(K||(K="utf8");;)switch(K){case"hex":return Et(this,ot,bt);case"utf8":case"utf-8":return pt(this,ot,bt);case"ascii":return xt(this,ot,bt);case"latin1":case"binary":return Ft(this,ot,bt);case"base64":return ft(this,ot,bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ct(this,ot,bt);default:if(yt)throw new TypeError("Unknown encoding: "+K);K=(K+"").toLowerCase(),yt=!0}}function st(K,ot,bt){var yt=K[ot];K[ot]=K[bt],K[bt]=yt}function nt(K,ot,bt,yt,$t){if(K.length===0)return-1;if(typeof bt=="string"?(yt=bt,bt=0):bt>2147483647?bt=2147483647:bt<-2147483648&&(bt=-2147483648),Bt(bt=+bt)&&(bt=$t?0:K.length-1),bt<0&&(bt=K.length+bt),bt>=K.length){if($t)return-1;bt=K.length-1}else if(bt<0){if(!$t)return-1;bt=0}if(typeof ot=="string"&&(ot=U.from(ot,yt)),U.isBuffer(ot))return ot.length===0?-1:lt(K,ot,bt,yt,$t);if(typeof ot=="number")return ot&=255,typeof Uint8Array.prototype.indexOf=="function"?$t?Uint8Array.prototype.indexOf.call(K,ot,bt):Uint8Array.prototype.lastIndexOf.call(K,ot,bt):lt(K,[ot],bt,yt,$t);throw new TypeError("val must be string, number or Buffer")}function lt(K,ot,bt,yt,$t){var Zt,Kt=1,te=K.length,Vt=ot.length;if(yt!==void 0&&((yt=String(yt).toLowerCase())==="ucs2"||yt==="ucs-2"||yt==="utf16le"||yt==="utf-16le")){if(K.length<2||ot.length<2)return-1;Kt=2,te/=2,Vt/=2,bt/=2}function ee(ae,he){return Kt===1?ae[he]:ae.readUInt16BE(he*Kt)}if($t){var Xt=-1;for(Zt=bt;Zt<te;Zt++)if(ee(K,Zt)===ee(ot,Xt===-1?0:Zt-Xt)){if(Xt===-1&&(Xt=Zt),Zt-Xt+1===Vt)return Xt*Kt}else Xt!==-1&&(Zt-=Zt-Xt),Xt=-1}else for(bt+Vt>te&&(bt=te-Vt),Zt=bt;Zt>=0;Zt--){for(var oe=!0,ne=0;ne<Vt;ne++)if(ee(K,Zt+ne)!==ee(ot,ne)){oe=!1;break}if(oe)return Zt}return-1}function at(K,ot,bt,yt){bt=Number(bt)||0;var $t=K.length-bt;yt?(yt=Number(yt))>$t&&(yt=$t):yt=$t;var Zt=ot.length;yt>Zt/2&&(yt=Zt/2);for(var Kt=0;Kt<yt;++Kt){var te=parseInt(ot.substr(2*Kt,2),16);if(Bt(te))return Kt;K[bt+Kt]=te}return Kt}function ct(K,ot,bt,yt){return _t(it(ot,K.length-bt),K,bt,yt)}function V(K,ot,bt,yt){return _t(Mt(ot),K,bt,yt)}function ut(K,ot,bt,yt){return V(K,ot,bt,yt)}function wt(K,ot,bt,yt){return _t(gt(ot),K,bt,yt)}function dt(K,ot,bt,yt){return _t(mt(ot,K.length-bt),K,bt,yt)}function ft(K,ot,bt){return ot===0&&bt===K.length?I.fromByteArray(K):I.fromByteArray(K.slice(ot,bt))}function pt(K,ot,bt){bt=Math.min(K.length,bt);for(var yt=[],$t=ot;$t<bt;){var Zt,Kt,te,Vt,ee=K[$t],Xt=null,oe=ee>239?4:ee>223?3:ee>191?2:1;if($t+oe<=bt)switch(oe){case 1:ee<128&&(Xt=ee);break;case 2:(192&(Zt=K[$t+1]))==128&&(Vt=(31&ee)<<6|63&Zt)>127&&(Xt=Vt);break;case 3:Zt=K[$t+1],Kt=K[$t+2],(192&Zt)==128&&(192&Kt)==128&&(Vt=(15&ee)<<12|(63&Zt)<<6|63&Kt)>2047&&(Vt<55296||Vt>57343)&&(Xt=Vt);break;case 4:Zt=K[$t+1],Kt=K[$t+2],te=K[$t+3],(192&Zt)==128&&(192&Kt)==128&&(192&te)==128&&(Vt=(15&ee)<<18|(63&Zt)<<12|(63&Kt)<<6|63&te)>65535&&Vt<1114112&&(Xt=Vt)}Xt===null?(Xt=65533,oe=1):Xt>65535&&(Xt-=65536,yt.push(Xt>>>10&1023|55296),Xt=56320|1023&Xt),yt.push(Xt),$t+=oe}return It(yt)}g.kMaxLength=F,U.TYPED_ARRAY_SUPPORT=D(),U.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(U.prototype,"parent",{enumerable:!0,get:function(){if(U.isBuffer(this))return this.buffer}}),Object.defineProperty(U.prototype,"offset",{enumerable:!0,get:function(){if(U.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&U[Symbol.species]===U&&Object.defineProperty(U,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),U.poolSize=8192,U.from=function(K,ot,bt){return j(K,ot,bt)},U.prototype.__proto__=Uint8Array.prototype,U.__proto__=Uint8Array,U.alloc=function(K,ot,bt){return G(K,ot,bt)},U.allocUnsafe=function(K){return H(K)},U.allocUnsafeSlow=function(K){return H(K)},U.isBuffer=function(K){return K!=null&&K._isBuffer===!0&&K!==U.prototype},U.compare=function(K,ot){if(vt(K,Uint8Array)&&(K=U.from(K,K.offset,K.byteLength)),vt(ot,Uint8Array)&&(ot=U.from(ot,ot.offset,ot.byteLength)),!U.isBuffer(K)||!U.isBuffer(ot))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(K===ot)return 0;for(var bt=K.length,yt=ot.length,$t=0,Zt=Math.min(bt,yt);$t<Zt;++$t)if(K[$t]!==ot[$t]){bt=K[$t],yt=ot[$t];break}return bt<yt?-1:yt<bt?1:0},U.isEncoding=function(K){switch(String(K).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},U.concat=function(K,ot){if(!Array.isArray(K))throw new TypeError('"list" argument must be an Array of Buffers');if(K.length===0)return U.alloc(0);var bt;if(ot===void 0)for(ot=0,bt=0;bt<K.length;++bt)ot+=K[bt].length;var yt=U.allocUnsafe(ot),$t=0;for(bt=0;bt<K.length;++bt){var Zt=K[bt];if(vt(Zt,Uint8Array)&&(Zt=U.from(Zt)),!U.isBuffer(Zt))throw new TypeError('"list" argument must be an Array of Buffers');Zt.copy(yt,$t),$t+=Zt.length}return yt},U.byteLength=J,U.prototype._isBuffer=!0,U.prototype.swap16=function(){var K=this.length;if(K%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ot=0;ot<K;ot+=2)st(this,ot,ot+1);return this},U.prototype.swap32=function(){var K=this.length;if(K%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ot=0;ot<K;ot+=4)st(this,ot,ot+3),st(this,ot+1,ot+2);return this},U.prototype.swap64=function(){var K=this.length;if(K%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ot=0;ot<K;ot+=8)st(this,ot,ot+7),st(this,ot+1,ot+6),st(this,ot+2,ot+5),st(this,ot+3,ot+4);return this},U.prototype.toString=function(){var K=this.length;return K===0?"":arguments.length===0?pt(this,0,K):tt.apply(this,arguments)},U.prototype.toLocaleString=U.prototype.toString,U.prototype.equals=function(K){if(!U.isBuffer(K))throw new TypeError("Argument must be a Buffer");return this===K||U.compare(this,K)===0},U.prototype.inspect=function(){var K="",ot=g.INSPECT_MAX_BYTES;return K=this.toString("hex",0,ot).replace(/(.{2})/g,"$1 ").trim(),this.length>ot&&(K+=" ... "),"<Buffer "+K+">"},U.prototype.compare=function(K,ot,bt,yt,$t){if(vt(K,Uint8Array)&&(K=U.from(K,K.offset,K.byteLength)),!U.isBuffer(K))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof K);if(ot===void 0&&(ot=0),bt===void 0&&(bt=K?K.length:0),yt===void 0&&(yt=0),$t===void 0&&($t=this.length),ot<0||bt>K.length||yt<0||$t>this.length)throw new RangeError("out of range index");if(yt>=$t&&ot>=bt)return 0;if(yt>=$t)return-1;if(ot>=bt)return 1;if(this===K)return 0;for(var Zt=($t>>>=0)-(yt>>>=0),Kt=(bt>>>=0)-(ot>>>=0),te=Math.min(Zt,Kt),Vt=this.slice(yt,$t),ee=K.slice(ot,bt),Xt=0;Xt<te;++Xt)if(Vt[Xt]!==ee[Xt]){Zt=Vt[Xt],Kt=ee[Xt];break}return Zt<Kt?-1:Kt<Zt?1:0},U.prototype.includes=function(K,ot,bt){return this.indexOf(K,ot,bt)!==-1},U.prototype.indexOf=function(K,ot,bt){return nt(this,K,ot,bt,!0)},U.prototype.lastIndexOf=function(K,ot,bt){return nt(this,K,ot,bt,!1)},U.prototype.write=function(K,ot,bt,yt){if(ot===void 0)yt="utf8",bt=this.length,ot=0;else if(bt===void 0&&typeof ot=="string")yt=ot,bt=this.length,ot=0;else{if(!isFinite(ot))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");ot>>>=0,isFinite(bt)?(bt>>>=0,yt===void 0&&(yt="utf8")):(yt=bt,bt=void 0)}var $t=this.length-ot;if((bt===void 0||bt>$t)&&(bt=$t),K.length>0&&(bt<0||ot<0)||ot>this.length)throw new RangeError("Attempt to write outside buffer bounds");yt||(yt="utf8");for(var Zt=!1;;)switch(yt){case"hex":return at(this,K,ot,bt);case"utf8":case"utf-8":return ct(this,K,ot,bt);case"ascii":return V(this,K,ot,bt);case"latin1":case"binary":return ut(this,K,ot,bt);case"base64":return wt(this,K,ot,bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dt(this,K,ot,bt);default:if(Zt)throw new TypeError("Unknown encoding: "+yt);yt=(""+yt).toLowerCase(),Zt=!0}},U.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Pt=4096;function It(K){var ot=K.length;if(ot<=Pt)return String.fromCharCode.apply(String,K);for(var bt="",yt=0;yt<ot;)bt+=String.fromCharCode.apply(String,K.slice(yt,yt+=Pt));return bt}function xt(K,ot,bt){var yt="";bt=Math.min(K.length,bt);for(var $t=ot;$t<bt;++$t)yt+=String.fromCharCode(127&K[$t]);return yt}function Ft(K,ot,bt){var yt="";bt=Math.min(K.length,bt);for(var $t=ot;$t<bt;++$t)yt+=String.fromCharCode(K[$t]);return yt}function Et(K,ot,bt){var yt=K.length;(!ot||ot<0)&&(ot=0),(!bt||bt<0||bt>yt)&&(bt=yt);for(var $t="",Zt=ot;Zt<bt;++Zt)$t+=Tt(K[Zt]);return $t}function Ct(K,ot,bt){for(var yt=K.slice(ot,bt),$t="",Zt=0;Zt<yt.length;Zt+=2)$t+=String.fromCharCode(yt[Zt]+256*yt[Zt+1]);return $t}function Ot(K,ot,bt){if(K%1!=0||K<0)throw new RangeError("offset is not uint");if(K+ot>bt)throw new RangeError("Trying to access beyond buffer length")}function Rt(K,ot,bt,yt,$t,Zt){if(!U.isBuffer(K))throw new TypeError('"buffer" argument must be a Buffer instance');if(ot>$t||ot<Zt)throw new RangeError('"value" argument is out of bounds');if(bt+yt>K.length)throw new RangeError("Index out of range")}function St(K,ot,bt,yt,$t,Zt){if(bt+yt>K.length)throw new RangeError("Index out of range");if(bt<0)throw new RangeError("Index out of range")}function At(K,ot,bt,yt,$t){return ot=+ot,bt>>>=0,$t||St(K,ot,bt,4),P.write(K,ot,bt,yt,23,4),bt+4}function Nt(K,ot,bt,yt,$t){return ot=+ot,bt>>>=0,$t||St(K,ot,bt,8),P.write(K,ot,bt,yt,52,8),bt+8}U.prototype.slice=function(K,ot){var bt=this.length;(K=~~K)<0?(K+=bt)<0&&(K=0):K>bt&&(K=bt),(ot=ot===void 0?bt:~~ot)<0?(ot+=bt)<0&&(ot=0):ot>bt&&(ot=bt),ot<K&&(ot=K);var yt=this.subarray(K,ot);return yt.__proto__=U.prototype,yt},U.prototype.readUIntLE=function(K,ot,bt){K>>>=0,ot>>>=0,bt||Ot(K,ot,this.length);for(var yt=this[K],$t=1,Zt=0;++Zt<ot&&($t*=256);)yt+=this[K+Zt]*$t;return yt},U.prototype.readUIntBE=function(K,ot,bt){K>>>=0,ot>>>=0,bt||Ot(K,ot,this.length);for(var yt=this[K+--ot],$t=1;ot>0&&($t*=256);)yt+=this[K+--ot]*$t;return yt},U.prototype.readUInt8=function(K,ot){return K>>>=0,ot||Ot(K,1,this.length),this[K]},U.prototype.readUInt16LE=function(K,ot){return K>>>=0,ot||Ot(K,2,this.length),this[K]|this[K+1]<<8},U.prototype.readUInt16BE=function(K,ot){return K>>>=0,ot||Ot(K,2,this.length),this[K]<<8|this[K+1]},U.prototype.readUInt32LE=function(K,ot){return K>>>=0,ot||Ot(K,4,this.length),(this[K]|this[K+1]<<8|this[K+2]<<16)+16777216*this[K+3]},U.prototype.readUInt32BE=function(K,ot){return K>>>=0,ot||Ot(K,4,this.length),16777216*this[K]+(this[K+1]<<16|this[K+2]<<8|this[K+3])},U.prototype.readIntLE=function(K,ot,bt){K>>>=0,ot>>>=0,bt||Ot(K,ot,this.length);for(var yt=this[K],$t=1,Zt=0;++Zt<ot&&($t*=256);)yt+=this[K+Zt]*$t;return yt>=($t*=128)&&(yt-=Math.pow(2,8*ot)),yt},U.prototype.readIntBE=function(K,ot,bt){K>>>=0,ot>>>=0,bt||Ot(K,ot,this.length);for(var yt=ot,$t=1,Zt=this[K+--yt];yt>0&&($t*=256);)Zt+=this[K+--yt]*$t;return Zt>=($t*=128)&&(Zt-=Math.pow(2,8*ot)),Zt},U.prototype.readInt8=function(K,ot){return K>>>=0,ot||Ot(K,1,this.length),128&this[K]?-1*(255-this[K]+1):this[K]},U.prototype.readInt16LE=function(K,ot){K>>>=0,ot||Ot(K,2,this.length);var bt=this[K]|this[K+1]<<8;return 32768&bt?4294901760|bt:bt},U.prototype.readInt16BE=function(K,ot){K>>>=0,ot||Ot(K,2,this.length);var bt=this[K+1]|this[K]<<8;return 32768&bt?4294901760|bt:bt},U.prototype.readInt32LE=function(K,ot){return K>>>=0,ot||Ot(K,4,this.length),this[K]|this[K+1]<<8|this[K+2]<<16|this[K+3]<<24},U.prototype.readInt32BE=function(K,ot){return K>>>=0,ot||Ot(K,4,this.length),this[K]<<24|this[K+1]<<16|this[K+2]<<8|this[K+3]},U.prototype.readFloatLE=function(K,ot){return K>>>=0,ot||Ot(K,4,this.length),P.read(this,K,!0,23,4)},U.prototype.readFloatBE=function(K,ot){return K>>>=0,ot||Ot(K,4,this.length),P.read(this,K,!1,23,4)},U.prototype.readDoubleLE=function(K,ot){return K>>>=0,ot||Ot(K,8,this.length),P.read(this,K,!0,52,8)},U.prototype.readDoubleBE=function(K,ot){return K>>>=0,ot||Ot(K,8,this.length),P.read(this,K,!1,52,8)},U.prototype.writeUIntLE=function(K,ot,bt,yt){K=+K,ot>>>=0,bt>>>=0,yt||Rt(this,K,ot,bt,Math.pow(2,8*bt)-1,0);var $t=1,Zt=0;for(this[ot]=255&K;++Zt<bt&&($t*=256);)this[ot+Zt]=K/$t&255;return ot+bt},U.prototype.writeUIntBE=function(K,ot,bt,yt){K=+K,ot>>>=0,bt>>>=0,yt||Rt(this,K,ot,bt,Math.pow(2,8*bt)-1,0);var $t=bt-1,Zt=1;for(this[ot+$t]=255&K;--$t>=0&&(Zt*=256);)this[ot+$t]=K/Zt&255;return ot+bt},U.prototype.writeUInt8=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,1,255,0),this[ot]=255&K,ot+1},U.prototype.writeUInt16LE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,2,65535,0),this[ot]=255&K,this[ot+1]=K>>>8,ot+2},U.prototype.writeUInt16BE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,2,65535,0),this[ot]=K>>>8,this[ot+1]=255&K,ot+2},U.prototype.writeUInt32LE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,4,4294967295,0),this[ot+3]=K>>>24,this[ot+2]=K>>>16,this[ot+1]=K>>>8,this[ot]=255&K,ot+4},U.prototype.writeUInt32BE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,4,4294967295,0),this[ot]=K>>>24,this[ot+1]=K>>>16,this[ot+2]=K>>>8,this[ot+3]=255&K,ot+4},U.prototype.writeIntLE=function(K,ot,bt,yt){if(K=+K,ot>>>=0,!yt){var $t=Math.pow(2,8*bt-1);Rt(this,K,ot,bt,$t-1,-$t)}var Zt=0,Kt=1,te=0;for(this[ot]=255&K;++Zt<bt&&(Kt*=256);)K<0&&te===0&&this[ot+Zt-1]!==0&&(te=1),this[ot+Zt]=(K/Kt|0)-te&255;return ot+bt},U.prototype.writeIntBE=function(K,ot,bt,yt){if(K=+K,ot>>>=0,!yt){var $t=Math.pow(2,8*bt-1);Rt(this,K,ot,bt,$t-1,-$t)}var Zt=bt-1,Kt=1,te=0;for(this[ot+Zt]=255&K;--Zt>=0&&(Kt*=256);)K<0&&te===0&&this[ot+Zt+1]!==0&&(te=1),this[ot+Zt]=(K/Kt|0)-te&255;return ot+bt},U.prototype.writeInt8=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,1,127,-128),K<0&&(K=255+K+1),this[ot]=255&K,ot+1},U.prototype.writeInt16LE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,2,32767,-32768),this[ot]=255&K,this[ot+1]=K>>>8,ot+2},U.prototype.writeInt16BE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,2,32767,-32768),this[ot]=K>>>8,this[ot+1]=255&K,ot+2},U.prototype.writeInt32LE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,4,2147483647,-2147483648),this[ot]=255&K,this[ot+1]=K>>>8,this[ot+2]=K>>>16,this[ot+3]=K>>>24,ot+4},U.prototype.writeInt32BE=function(K,ot,bt){return K=+K,ot>>>=0,bt||Rt(this,K,ot,4,2147483647,-2147483648),K<0&&(K=4294967295+K+1),this[ot]=K>>>24,this[ot+1]=K>>>16,this[ot+2]=K>>>8,this[ot+3]=255&K,ot+4},U.prototype.writeFloatLE=function(K,ot,bt){return At(this,K,ot,!0,bt)},U.prototype.writeFloatBE=function(K,ot,bt){return At(this,K,ot,!1,bt)},U.prototype.writeDoubleLE=function(K,ot,bt){return Nt(this,K,ot,!0,bt)},U.prototype.writeDoubleBE=function(K,ot,bt){return Nt(this,K,ot,!1,bt)},U.prototype.copy=function(K,ot,bt,yt){if(!U.isBuffer(K))throw new TypeError("argument should be a Buffer");if(bt||(bt=0),yt||yt===0||(yt=this.length),ot>=K.length&&(ot=K.length),ot||(ot=0),yt>0&&yt<bt&&(yt=bt),yt===bt||K.length===0||this.length===0)return 0;if(ot<0)throw new RangeError("targetStart out of bounds");if(bt<0||bt>=this.length)throw new RangeError("Index out of range");if(yt<0)throw new RangeError("sourceEnd out of bounds");yt>this.length&&(yt=this.length),K.length-ot<yt-bt&&(yt=K.length-ot+bt);var $t=yt-bt;if(this===K&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ot,bt,yt);else if(this===K&&bt<ot&&ot<yt)for(var Zt=$t-1;Zt>=0;--Zt)K[Zt+ot]=this[Zt+bt];else Uint8Array.prototype.set.call(K,this.subarray(bt,yt),ot);return $t},U.prototype.fill=function(K,ot,bt,yt){if(typeof K=="string"){if(typeof ot=="string"?(yt=ot,ot=0,bt=this.length):typeof bt=="string"&&(yt=bt,bt=this.length),yt!==void 0&&typeof yt!="string")throw new TypeError("encoding must be a string");if(typeof yt=="string"&&!U.isEncoding(yt))throw new TypeError("Unknown encoding: "+yt);if(K.length===1){var $t=K.charCodeAt(0);(yt==="utf8"&&$t<128||yt==="latin1")&&(K=$t)}}else typeof K=="number"&&(K&=255);if(ot<0||this.length<ot||this.length<bt)throw new RangeError("Out of range index");if(bt<=ot)return this;var Zt;if(ot>>>=0,bt=bt===void 0?this.length:bt>>>0,K||(K=0),typeof K=="number")for(Zt=ot;Zt<bt;++Zt)this[Zt]=K;else{var Kt=U.isBuffer(K)?K:U.from(K,yt),te=Kt.length;if(te===0)throw new TypeError('The value "'+K+'" is invalid for argument "value"');for(Zt=0;Zt<bt-ot;++Zt)this[Zt+ot]=Kt[Zt%te]}return this};var Ut=/[^+/0-9A-Za-z-_]/g;function jt(K){if((K=(K=K.split("=")[0]).trim().replace(Ut,"")).length<2)return"";for(;K.length%4!=0;)K+="=";return K}function Tt(K){return K<16?"0"+K.toString(16):K.toString(16)}function it(K,ot){var bt;ot=ot||1/0;for(var yt=K.length,$t=null,Zt=[],Kt=0;Kt<yt;++Kt){if((bt=K.charCodeAt(Kt))>55295&&bt<57344){if(!$t){if(bt>56319){(ot-=3)>-1&&Zt.push(239,191,189);continue}if(Kt+1===yt){(ot-=3)>-1&&Zt.push(239,191,189);continue}$t=bt;continue}if(bt<56320){(ot-=3)>-1&&Zt.push(239,191,189),$t=bt;continue}bt=65536+($t-55296<<10|bt-56320)}else $t&&(ot-=3)>-1&&Zt.push(239,191,189);if($t=null,bt<128){if((ot-=1)<0)break;Zt.push(bt)}else if(bt<2048){if((ot-=2)<0)break;Zt.push(bt>>6|192,63&bt|128)}else if(bt<65536){if((ot-=3)<0)break;Zt.push(bt>>12|224,bt>>6&63|128,63&bt|128)}else{if(!(bt<1114112))throw new Error("Invalid code point");if((ot-=4)<0)break;Zt.push(bt>>18|240,bt>>12&63|128,bt>>6&63|128,63&bt|128)}}return Zt}function Mt(K){for(var ot=[],bt=0;bt<K.length;++bt)ot.push(255&K.charCodeAt(bt));return ot}function mt(K,ot){for(var bt,yt,$t,Zt=[],Kt=0;Kt<K.length&&!((ot-=2)<0);++Kt)yt=(bt=K.charCodeAt(Kt))>>8,$t=bt%256,Zt.push($t),Zt.push(yt);return Zt}function gt(K){return I.toByteArray(jt(K))}function _t(K,ot,bt,yt){for(var $t=0;$t<yt&&!($t+bt>=ot.length||$t>=K.length);++$t)ot[$t+bt]=K[$t];return $t}function vt(K,ot){return K instanceof ot||K!=null&&K.constructor!=null&&K.constructor.name!=null&&K.constructor.name===ot.name}function Bt(K){return K!=K}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":28,buffer:32,ieee754:45}],33:[function(d,m,g){var w=d("get-intrinsic"),I=d("./"),P=I(w("String.prototype.indexOf"));m.exports=function(F,D){var $=w(F,!!D);return typeof $=="function"&&P(F,".prototype.")>-1?I($):$}},{"./":34,"get-intrinsic":39}],34:[function(d,m,g){var w=d("function-bind"),I=d("get-intrinsic"),P=I("%Function.prototype.apply%"),F=I("%Function.prototype.call%"),D=I("%Reflect.apply%",!0)||w.call(F,P),$=I("%Object.getOwnPropertyDescriptor%",!0),U=I("%Object.defineProperty%",!0),j=I("%Math.max%");if(U)try{U({},"a",{value:1})}catch{U=null}m.exports=function(G){var H=D(w,F,arguments);return $&&U&&$(H,"length").configurable&&U(H,"length",{value:1+j(0,G.length-(arguments.length-1))}),H};var Z=function(){return D(w,P,arguments)};U?U(m.exports,"apply",{value:Z}):m.exports.apply=Z},{"function-bind":38,"get-intrinsic":39}],35:[function(d,m,g){var w,I=typeof Reflect=="object"?Reflect:null,P=I&&typeof I.apply=="function"?I.apply:function(nt,lt,at){return Function.prototype.apply.call(nt,lt,at)};function F(nt){console&&console.warn&&console.warn(nt)}w=I&&typeof I.ownKeys=="function"?I.ownKeys:Object.getOwnPropertySymbols?function(nt){return Object.getOwnPropertyNames(nt).concat(Object.getOwnPropertySymbols(nt))}:function(nt){return Object.getOwnPropertyNames(nt)};var D=Number.isNaN||function(nt){return nt!=nt};function $(){$.init.call(this)}m.exports=$,m.exports.once=J,$.EventEmitter=$,$.prototype._events=void 0,$.prototype._eventsCount=0,$.prototype._maxListeners=void 0;var U=10;function j(nt){if(typeof nt!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof nt)}function Z(nt){return nt._maxListeners===void 0?$.defaultMaxListeners:nt._maxListeners}function G(nt,lt,at,ct){var V,ut,wt;if(j(at),(ut=nt._events)===void 0?(ut=nt._events=Object.create(null),nt._eventsCount=0):(ut.newListener!==void 0&&(nt.emit("newListener",lt,at.listener?at.listener:at),ut=nt._events),wt=ut[lt]),wt===void 0)wt=ut[lt]=at,++nt._eventsCount;else if(typeof wt=="function"?wt=ut[lt]=ct?[at,wt]:[wt,at]:ct?wt.unshift(at):wt.push(at),(V=Z(nt))>0&&wt.length>V&&!wt.warned){wt.warned=!0;var dt=new Error("Possible EventEmitter memory leak detected. "+wt.length+" "+String(lt)+" listeners added. Use emitter.setMaxListeners() to increase limit");dt.name="MaxListenersExceededWarning",dt.emitter=nt,dt.type=lt,dt.count=wt.length,F(dt)}return nt}function H(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function W(nt,lt,at){var ct={fired:!1,wrapFn:void 0,target:nt,type:lt,listener:at},V=H.bind(ct);return V.listener=at,ct.wrapFn=V,V}function Q(nt,lt,at){var ct=nt._events;if(ct===void 0)return[];var V=ct[lt];return V===void 0?[]:typeof V=="function"?at?[V.listener||V]:[V]:at?X(V):rt(V,V.length)}function q(nt){var lt=this._events;if(lt!==void 0){var at=lt[nt];if(typeof at=="function")return 1;if(at!==void 0)return at.length}return 0}function rt(nt,lt){for(var at=new Array(lt),ct=0;ct<lt;++ct)at[ct]=nt[ct];return at}function et(nt,lt){for(;lt+1<nt.length;lt++)nt[lt]=nt[lt+1];nt.pop()}function X(nt){for(var lt=new Array(nt.length),at=0;at<lt.length;++at)lt[at]=nt[at].listener||nt[at];return lt}function J(nt,lt){return new Promise((function(at,ct){function V(wt){nt.removeListener(lt,ut),ct(wt)}function ut(){typeof nt.removeListener=="function"&&nt.removeListener("error",V),at([].slice.call(arguments))}st(nt,lt,ut,{once:!0}),lt!=="error"&&tt(nt,V,{once:!0})}))}function tt(nt,lt,at){typeof nt.on=="function"&&st(nt,"error",lt,at)}function st(nt,lt,at,ct){if(typeof nt.on=="function")ct.once?nt.once(lt,at):nt.on(lt,at);else{if(typeof nt.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof nt);nt.addEventListener(lt,(function V(ut){ct.once&&nt.removeEventListener(lt,V),at(ut)}))}}Object.defineProperty($,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(nt){if(typeof nt!="number"||nt<0||D(nt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+nt+".");U=nt}}),$.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$.prototype.setMaxListeners=function(nt){if(typeof nt!="number"||nt<0||D(nt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+nt+".");return this._maxListeners=nt,this},$.prototype.getMaxListeners=function(){return Z(this)},$.prototype.emit=function(nt){for(var lt=[],at=1;at<arguments.length;at++)lt.push(arguments[at]);var ct=nt==="error",V=this._events;if(V!==void 0)ct=ct&&V.error===void 0;else if(!ct)return!1;if(ct){var ut;if(lt.length>0&&(ut=lt[0]),ut instanceof Error)throw ut;var wt=new Error("Unhandled error."+(ut?" ("+ut.message+")":""));throw wt.context=ut,wt}var dt=V[nt];if(dt===void 0)return!1;if(typeof dt=="function")P(dt,this,lt);else{var ft=dt.length,pt=rt(dt,ft);for(at=0;at<ft;++at)P(pt[at],this,lt)}return!0},$.prototype.addListener=function(nt,lt){return G(this,nt,lt,!1)},$.prototype.on=$.prototype.addListener,$.prototype.prependListener=function(nt,lt){return G(this,nt,lt,!0)},$.prototype.once=function(nt,lt){return j(lt),this.on(nt,W(this,nt,lt)),this},$.prototype.prependOnceListener=function(nt,lt){return j(lt),this.prependListener(nt,W(this,nt,lt)),this},$.prototype.removeListener=function(nt,lt){var at,ct,V,ut,wt;if(j(lt),(ct=this._events)===void 0)return this;if((at=ct[nt])===void 0)return this;if(at===lt||at.listener===lt)--this._eventsCount==0?this._events=Object.create(null):(delete ct[nt],ct.removeListener&&this.emit("removeListener",nt,at.listener||lt));else if(typeof at!="function"){for(V=-1,ut=at.length-1;ut>=0;ut--)if(at[ut]===lt||at[ut].listener===lt){wt=at[ut].listener,V=ut;break}if(V<0)return this;V===0?at.shift():et(at,V),at.length===1&&(ct[nt]=at[0]),ct.removeListener!==void 0&&this.emit("removeListener",nt,wt||lt)}return this},$.prototype.off=$.prototype.removeListener,$.prototype.removeAllListeners=function(nt){var lt,at,ct;if((at=this._events)===void 0)return this;if(at.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):at[nt]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete at[nt]),this;if(arguments.length===0){var V,ut=Object.keys(at);for(ct=0;ct<ut.length;++ct)(V=ut[ct])!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(lt=at[nt])=="function")this.removeListener(nt,lt);else if(lt!==void 0)for(ct=lt.length-1;ct>=0;ct--)this.removeListener(nt,lt[ct]);return this},$.prototype.listeners=function(nt){return Q(this,nt,!0)},$.prototype.rawListeners=function(nt){return Q(this,nt,!1)},$.listenerCount=function(nt,lt){return typeof nt.listenerCount=="function"?nt.listenerCount(lt):q.call(nt,lt)},$.prototype.listenerCount=q,$.prototype.eventNames=function(){return this._eventsCount>0?w(this._events):[]}},{}],36:[function(d,m,g){var w=d("is-callable"),I=Object.prototype.toString,P=Object.prototype.hasOwnProperty,F=function(j,Z,G){for(var H=0,W=j.length;H<W;H++)P.call(j,H)&&(G==null?Z(j[H],H,j):Z.call(G,j[H],H,j))},D=function(j,Z,G){for(var H=0,W=j.length;H<W;H++)G==null?Z(j.charAt(H),H,j):Z.call(G,j.charAt(H),H,j)},$=function(j,Z,G){for(var H in j)P.call(j,H)&&(G==null?Z(j[H],H,j):Z.call(G,j[H],H,j))},U=function(j,Z,G){if(!w(Z))throw new TypeError("iterator must be a function");var H;arguments.length>=3&&(H=G),I.call(j)==="[object Array]"?F(j,Z,H):typeof j=="string"?D(j,Z,H):$(j,Z,H)};m.exports=U},{"is-callable":48}],37:[function(d,m,g){var w="Function.prototype.bind called on incompatible ",I=Array.prototype.slice,P=Object.prototype.toString,F="[object Function]";m.exports=function(D){var $=this;if(typeof $!="function"||P.call($)!==F)throw new TypeError(w+$);for(var U,j=I.call(arguments,1),Z=function(){if(this instanceof U){var q=$.apply(this,j.concat(I.call(arguments)));return Object(q)===q?q:this}return $.apply(D,j.concat(I.call(arguments)))},G=Math.max(0,$.length-j.length),H=[],W=0;W<G;W++)H.push("$"+W);if(U=Function("binder","return function ("+H.join(",")+"){ return binder.apply(this,arguments); }")(Z),$.prototype){var Q=function(){};Q.prototype=$.prototype,U.prototype=new Q,Q.prototype=null}return U}},{}],38:[function(d,m,g){var w=d("./implementation");m.exports=Function.prototype.bind||w},{"./implementation":37}],39:[function(d,m,g){var w,I=SyntaxError,P=Function,F=TypeError,D=function(dt){try{return P('"use strict"; return ('+dt+").constructor;")()}catch{}},$=Object.getOwnPropertyDescriptor;if($)try{$({},"")}catch{$=null}var U=function(){throw new F},j=$?(function(){try{return U}catch{try{return $(arguments,"callee").get}catch{return U}}})():U,Z=d("has-symbols")(),G=Object.getPrototypeOf||function(dt){return dt.__proto__},H={},W=typeof Uint8Array>"u"?w:G(Uint8Array),Q={"%AggregateError%":typeof AggregateError>"u"?w:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?w:ArrayBuffer,"%ArrayIteratorPrototype%":Z?G([][Symbol.iterator]()):w,"%AsyncFromSyncIteratorPrototype%":w,"%AsyncFunction%":H,"%AsyncGenerator%":H,"%AsyncGeneratorFunction%":H,"%AsyncIteratorPrototype%":H,"%Atomics%":typeof Atomics>"u"?w:Atomics,"%BigInt%":typeof BigInt>"u"?w:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?w:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?w:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?w:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?w:Float32Array,"%Float64Array%":typeof Float64Array>"u"?w:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?w:FinalizationRegistry,"%Function%":P,"%GeneratorFunction%":H,"%Int8Array%":typeof Int8Array>"u"?w:Int8Array,"%Int16Array%":typeof Int16Array>"u"?w:Int16Array,"%Int32Array%":typeof Int32Array>"u"?w:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Z?G(G([][Symbol.iterator]())):w,"%JSON%":typeof JSON=="object"?JSON:w,"%Map%":typeof Map>"u"?w:Map,"%MapIteratorPrototype%":typeof Map<"u"&&Z?G(new Map()[Symbol.iterator]()):w,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?w:Promise,"%Proxy%":typeof Proxy>"u"?w:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?w:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?w:Set,"%SetIteratorPrototype%":typeof Set<"u"&&Z?G(new Set()[Symbol.iterator]()):w,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?w:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Z?G(""[Symbol.iterator]()):w,"%Symbol%":Z?Symbol:w,"%SyntaxError%":I,"%ThrowTypeError%":j,"%TypedArray%":W,"%TypeError%":F,"%Uint8Array%":typeof Uint8Array>"u"?w:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?w:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?w:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?w:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?w:WeakMap,"%WeakRef%":typeof WeakRef>"u"?w:WeakRef,"%WeakSet%":typeof WeakSet>"u"?w:WeakSet};try{null.error}catch(dt){var q=G(G(dt));Q["%Error.prototype%"]=q}var rt=function dt(ft){var pt;if(ft==="%AsyncFunction%")pt=D("async function () {}");else if(ft==="%GeneratorFunction%")pt=D("function* () {}");else if(ft==="%AsyncGeneratorFunction%")pt=D("async function* () {}");else if(ft==="%AsyncGenerator%"){var Pt=dt("%AsyncGeneratorFunction%");Pt&&(pt=Pt.prototype)}else if(ft==="%AsyncIteratorPrototype%"){var It=dt("%AsyncGenerator%");It&&(pt=G(It.prototype))}return Q[ft]=pt,pt},et={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},X=d("function-bind"),J=d("has"),tt=X.call(Function.call,Array.prototype.concat),st=X.call(Function.apply,Array.prototype.splice),nt=X.call(Function.call,String.prototype.replace),lt=X.call(Function.call,String.prototype.slice),at=X.call(Function.call,RegExp.prototype.exec),ct=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,V=/\\(\\)?/g,ut=function(dt){var ft=lt(dt,0,1),pt=lt(dt,-1);if(ft==="%"&&pt!=="%")throw new I("invalid intrinsic syntax, expected closing `%`");if(pt==="%"&&ft!=="%")throw new I("invalid intrinsic syntax, expected opening `%`");var Pt=[];return nt(dt,ct,(function(It,xt,Ft,Et){Pt[Pt.length]=Ft?nt(Et,V,"$1"):xt||It})),Pt},wt=function(dt,ft){var pt,Pt=dt;if(J(et,Pt)&&(Pt="%"+(pt=et[Pt])[0]+"%"),J(Q,Pt)){var It=Q[Pt];if(It===H&&(It=rt(Pt)),It===void 0&&!ft)throw new F("intrinsic "+dt+" exists, but is not available. Please file an issue!");return{alias:pt,name:Pt,value:It}}throw new I("intrinsic "+dt+" does not exist!")};m.exports=function(dt,ft){if(typeof dt!="string"||dt.length===0)throw new F("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ft!="boolean")throw new F('"allowMissing" argument must be a boolean');if(at(/^%?[^%]*%?$/,dt)===null)throw new I("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var pt=ut(dt),Pt=pt.length>0?pt[0]:"",It=wt("%"+Pt+"%",ft),xt=It.name,Ft=It.value,Et=!1,Ct=It.alias;Ct&&(Pt=Ct[0],st(pt,tt([0,1],Ct)));for(var Ot=1,Rt=!0;Ot<pt.length;Ot+=1){var St=pt[Ot],At=lt(St,0,1),Nt=lt(St,-1);if((At==='"'||At==="'"||At==="`"||Nt==='"'||Nt==="'"||Nt==="`")&&At!==Nt)throw new I("property names with quotes must have matching quotes");if(St!=="constructor"&&Rt||(Et=!0),J(Q,xt="%"+(Pt+="."+St)+"%"))Ft=Q[xt];else if(Ft!=null){if(!(St in Ft)){if(!ft)throw new F("base intrinsic for "+dt+" exists, but the property is not available.");return}if($&&Ot+1>=pt.length){var Ut=$(Ft,St);Ft=(Rt=!!Ut)&&"get"in Ut&&!("originalValue"in Ut.get)?Ut.get:Ft[St]}else Rt=J(Ft,St),Ft=Ft[St];Rt&&!Et&&(Q[xt]=Ft)}}return Ft}},{"function-bind":38,has:44,"has-symbols":41}],40:[function(d,m,g){var w=d("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(w)try{w([],"length")}catch{w=null}m.exports=w},{"get-intrinsic":39}],41:[function(d,m,g){var w=typeof Symbol<"u"&&Symbol,I=d("./shams");m.exports=function(){return typeof w=="function"&&typeof Symbol=="function"&&typeof w("foo")=="symbol"&&typeof Symbol("bar")=="symbol"&&I()}},{"./shams":42}],42:[function(d,m,g){m.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var w={},I=Symbol("test"),P=Object(I);if(typeof I=="string"||Object.prototype.toString.call(I)!=="[object Symbol]"||Object.prototype.toString.call(P)!=="[object Symbol]")return!1;var F=42;for(I in w[I]=F,w)return!1;if(typeof Object.keys=="function"&&Object.keys(w).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(w).length!==0)return!1;var D=Object.getOwnPropertySymbols(w);if(D.length!==1||D[0]!==I||!Object.prototype.propertyIsEnumerable.call(w,I))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var $=Object.getOwnPropertyDescriptor(w,I);if($.value!==F||$.enumerable!==!0)return!1}return!0}},{}],43:[function(d,m,g){var w=d("has-symbols/shams");m.exports=function(){return w()&&!!Symbol.toStringTag}},{"has-symbols/shams":42}],44:[function(d,m,g){var w=d("function-bind");m.exports=w.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":38}],45:[function(d,m,g){g.read=function(w,I,P,F,D){var $,U,j=8*D-F-1,Z=(1<<j)-1,G=Z>>1,H=-7,W=P?D-1:0,Q=P?-1:1,q=w[I+W];for(W+=Q,$=q&(1<<-H)-1,q>>=-H,H+=j;H>0;$=256*$+w[I+W],W+=Q,H-=8);for(U=$&(1<<-H)-1,$>>=-H,H+=F;H>0;U=256*U+w[I+W],W+=Q,H-=8);if($===0)$=1-G;else{if($===Z)return U?NaN:1/0*(q?-1:1);U+=Math.pow(2,F),$-=G}return(q?-1:1)*U*Math.pow(2,$-F)},g.write=function(w,I,P,F,D,$){var U,j,Z,G=8*$-D-1,H=(1<<G)-1,W=H>>1,Q=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=F?0:$-1,rt=F?1:-1,et=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(j=isNaN(I)?1:0,U=H):(U=Math.floor(Math.log(I)/Math.LN2),I*(Z=Math.pow(2,-U))<1&&(U--,Z*=2),(I+=U+W>=1?Q/Z:Q*Math.pow(2,1-W))*Z>=2&&(U++,Z/=2),U+W>=H?(j=0,U=H):U+W>=1?(j=(I*Z-1)*Math.pow(2,D),U+=W):(j=I*Math.pow(2,W-1)*Math.pow(2,D),U=0));D>=8;w[P+q]=255&j,q+=rt,j/=256,D-=8);for(U=U<<D|j,G+=D;G>0;w[P+q]=255&U,q+=rt,U/=256,G-=8);w[P+q-rt]|=128*et}},{}],46:[function(d,m,g){typeof Object.create=="function"?m.exports=function(w,I){I&&(w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}))}:m.exports=function(w,I){if(I){w.super_=I;var P=function(){};P.prototype=I.prototype,w.prototype=new P,w.prototype.constructor=w}}},{}],47:[function(d,m,g){var w=d("has-tostringtag/shams")(),I=d("call-bind/callBound")("Object.prototype.toString"),P=function($){return!(w&&$&&typeof $=="object"&&Symbol.toStringTag in $)&&I($)==="[object Arguments]"},F=function($){return!!P($)||$!==null&&typeof $=="object"&&typeof $.length=="number"&&$.length>=0&&I($)!=="[object Array]"&&I($.callee)==="[object Function]"},D=(function(){return P(arguments)})();P.isLegacyArguments=F,m.exports=D?P:F},{"call-bind/callBound":33,"has-tostringtag/shams":43}],48:[function(d,m,g){var w,I,P=Function.prototype.toString,F=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply;if(typeof F=="function"&&typeof Object.defineProperty=="function")try{w=Object.defineProperty({},"length",{get:function(){throw I}}),I={},F((function(){throw 42}),null,w)}catch(tt){tt!==I&&(F=null)}else F=null;var D=/^\s*class\b/,$=function(tt){try{var st=P.call(tt);return D.test(st)}catch{return!1}},U=function(tt){try{return!$(tt)&&(P.call(tt),!0)}catch{return!1}},j=Object.prototype.toString,Z="[object Object]",G="[object Function]",H="[object GeneratorFunction]",W="[object HTMLAllCollection]",Q="[object HTML document.all class]",q="[object HTMLCollection]",rt=typeof Symbol=="function"&&!!Symbol.toStringTag,et=!(0 in[,]),X=function(){return!1};if(typeof document=="object"){var J=document.all;j.call(J)===j.call(document.all)&&(X=function(tt){if((et||!tt)&&(tt===void 0||typeof tt=="object"))try{var st=j.call(tt);return(st===W||st===Q||st===q||st===Z)&&tt("")==null}catch{}return!1})}m.exports=F?function(tt){if(X(tt))return!0;if(!tt||typeof tt!="function"&&typeof tt!="object")return!1;try{F(tt,null,w)}catch(st){if(st!==I)return!1}return!$(tt)&&U(tt)}:function(tt){if(X(tt))return!0;if(!tt||typeof tt!="function"&&typeof tt!="object")return!1;if(rt)return U(tt);if($(tt))return!1;var st=j.call(tt);return!(st!==G&&st!==H&&!/^\[object HTML/.test(st))&&U(tt)}},{}],49:[function(d,m,g){var w,I=Object.prototype.toString,P=Function.prototype.toString,F=/^\s*(?:function)?\*/,D=d("has-tostringtag/shams")(),$=Object.getPrototypeOf,U=function(){if(!D)return!1;try{return Function("return function*() {}")()}catch{}};m.exports=function(j){if(typeof j!="function")return!1;if(F.test(P.call(j)))return!0;if(!D)return I.call(j)==="[object GeneratorFunction]";if(!$)return!1;if(w===void 0){var Z=U();w=!!Z&&$(Z)}return $(j)===w}},{"has-tostringtag/shams":43}],50:[function(d,m,g){(function(w){(function(){var I=d("for-each"),P=d("available-typed-arrays"),F=d("call-bind/callBound"),D=F("Object.prototype.toString"),$=d("has-tostringtag/shams")(),U=d("gopd"),j=typeof globalThis>"u"?w:globalThis,Z=P(),G=F("Array.prototype.indexOf",!0)||function(rt,et){for(var X=0;X<rt.length;X+=1)if(rt[X]===et)return X;return-1},H=F("String.prototype.slice"),W={},Q=Object.getPrototypeOf;$&&U&&Q&&I(Z,(function(rt){var et=new j[rt];if(Symbol.toStringTag in et){var X=Q(et),J=U(X,Symbol.toStringTag);if(!J){var tt=Q(X);J=U(tt,Symbol.toStringTag)}W[rt]=J.get}}));var q=function(rt){var et=!1;return I(W,(function(X,J){if(!et)try{et=X.call(rt)===J}catch{}})),et};m.exports=function(rt){if(!rt||typeof rt!="object")return!1;if(!$||!(Symbol.toStringTag in rt)){var et=H(D(rt),8,-1);return G(Z,et)>-1}return!!U&&q(rt)}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43}],51:[function(d,m,g){var w=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;function F($){if($==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object($)}function D(){try{if(!Object.assign)return!1;var $=new String("abc");if($[5]="de",Object.getOwnPropertyNames($)[0]==="5")return!1;for(var U={},j=0;j<10;j++)U["_"+String.fromCharCode(j)]=j;var Z=Object.getOwnPropertyNames(U).map((function(H){return U[H]}));if(Z.join("")!=="0123456789")return!1;var G={};return"abcdefghijklmnopqrst".split("").forEach((function(H){G[H]=H})),Object.keys(Object.assign({},G)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}m.exports=D()?Object.assign:function($,U){for(var j,Z,G=F($),H=1;H<arguments.length;H++){for(var W in j=Object(arguments[H]))I.call(j,W)&&(G[W]=j[W]);if(w){Z=w(j);for(var Q=0;Q<Z.length;Q++)P.call(j,Z[Q])&&(G[Z[Q]]=j[Z[Q]])}}return G}},{}],52:[function(d,m,g){var w=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function I(D,$){return Object.prototype.hasOwnProperty.call(D,$)}g.assign=function(D){for(var $=Array.prototype.slice.call(arguments,1);$.length;){var U=$.shift();if(U){if(typeof U!="object")throw new TypeError(U+"must be non-object");for(var j in U)I(U,j)&&(D[j]=U[j])}}return D},g.shrinkBuf=function(D,$){return D.length===$?D:D.subarray?D.subarray(0,$):(D.length=$,D)};var P={arraySet:function(D,$,U,j,Z){if($.subarray&&D.subarray)D.set($.subarray(U,U+j),Z);else for(var G=0;G<j;G++)D[Z+G]=$[U+G]},flattenChunks:function(D){var $,U,j,Z,G,H;for(j=0,$=0,U=D.length;$<U;$++)j+=D[$].length;for(H=new Uint8Array(j),Z=0,$=0,U=D.length;$<U;$++)G=D[$],H.set(G,Z),Z+=G.length;return H}},F={arraySet:function(D,$,U,j,Z){for(var G=0;G<j;G++)D[Z+G]=$[U+G]},flattenChunks:function(D){return[].concat.apply([],D)}};g.setTyped=function(D){D?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,P)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,F))},g.setTyped(w)},{}],53:[function(d,m,g){function w(I,P,F,D){for(var $=65535&I,U=I>>>16&65535,j=0;F!==0;){F-=j=F>2e3?2e3:F;do U=U+($=$+P[D++]|0)|0;while(--j);$%=65521,U%=65521}return $|U<<16}m.exports=w},{}],54:[function(d,m,g){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],55:[function(d,m,g){function w(){for(var F,D=[],$=0;$<256;$++){F=$;for(var U=0;U<8;U++)F=1&F?3988292384^F>>>1:F>>>1;D[$]=F}return D}var I=w();function P(F,D,$,U){var j=I,Z=U+$;F^=-1;for(var G=U;G<Z;G++)F=F>>>8^j[255&(F^D[G])];return~F}m.exports=P},{}],56:[function(d,m,g){var w,I=d("../utils/common"),P=d("./trees"),F=d("./adler32"),D=d("./crc32"),$=d("./messages"),U=0,j=1,Z=3,G=4,H=5,W=0,Q=1,q=-2,rt=-3,et=-5,X=-1,J=1,tt=2,st=3,nt=4,lt=0,at=2,ct=8,V=9,ut=15,wt=8,dt=286,ft=30,pt=19,Pt=2*dt+1,It=15,xt=3,Ft=258,Et=Ft+xt+1,Ct=32,Ot=42,Rt=69,St=73,At=91,Nt=103,Ut=113,jt=666,Tt=1,it=2,Mt=3,mt=4,gt=3;function _t(ht,qt){return ht.msg=$[qt],qt}function vt(ht){return(ht<<1)-(ht>4?9:0)}function Bt(ht){for(var qt=ht.length;--qt>=0;)ht[qt]=0}function K(ht){var qt=ht.state,Gt=qt.pending;Gt>ht.avail_out&&(Gt=ht.avail_out),Gt!==0&&(I.arraySet(ht.output,qt.pending_buf,qt.pending_out,Gt,ht.next_out),ht.next_out+=Gt,qt.pending_out+=Gt,ht.total_out+=Gt,ht.avail_out-=Gt,qt.pending-=Gt,qt.pending===0&&(qt.pending_out=0))}function ot(ht,qt){P._tr_flush_block(ht,ht.block_start>=0?ht.block_start:-1,ht.strstart-ht.block_start,qt),ht.block_start=ht.strstart,K(ht.strm)}function bt(ht,qt){ht.pending_buf[ht.pending++]=qt}function yt(ht,qt){ht.pending_buf[ht.pending++]=qt>>>8&255,ht.pending_buf[ht.pending++]=255&qt}function $t(ht,qt,Gt,Dt){var Ht=ht.avail_in;return Ht>Dt&&(Ht=Dt),Ht===0?0:(ht.avail_in-=Ht,I.arraySet(qt,ht.input,ht.next_in,Ht,Gt),ht.state.wrap===1?ht.adler=F(ht.adler,qt,Ht,Gt):ht.state.wrap===2&&(ht.adler=D(ht.adler,qt,Ht,Gt)),ht.next_in+=Ht,ht.total_in+=Ht,Ht)}function Zt(ht,qt){var Gt,Dt,Ht=ht.max_chain_length,Wt=ht.strstart,le=ht.prev_length,re=ht.nice_match,se=ht.strstart>ht.w_size-Et?ht.strstart-(ht.w_size-Et):0,ce=ht.window,ve=ht.w_mask,fe=ht.prev,de=ht.strstart+Ft,_e=ce[Wt+le-1],ge=ce[Wt+le];ht.prev_length>=ht.good_match&&(Ht>>=2),re>ht.lookahead&&(re=ht.lookahead);do if(ce[(Gt=qt)+le]===ge&&ce[Gt+le-1]===_e&&ce[Gt]===ce[Wt]&&ce[++Gt]===ce[Wt+1]){Wt+=2,Gt++;do;while(ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&Wt<de);if(Dt=Ft-(de-Wt),Wt=de-Ft,Dt>le){if(ht.match_start=qt,le=Dt,Dt>=re)break;_e=ce[Wt+le-1],ge=ce[Wt+le]}}while((qt=fe[qt&ve])>se&&--Ht!=0);return le<=ht.lookahead?le:ht.lookahead}function Kt(ht){var qt,Gt,Dt,Ht,Wt,le=ht.w_size;do{if(Ht=ht.window_size-ht.lookahead-ht.strstart,ht.strstart>=le+(le-Et)){I.arraySet(ht.window,ht.window,le,le,0),ht.match_start-=le,ht.strstart-=le,ht.block_start-=le,qt=Gt=ht.hash_size;do Dt=ht.head[--qt],ht.head[qt]=Dt>=le?Dt-le:0;while(--Gt);qt=Gt=le;do Dt=ht.prev[--qt],ht.prev[qt]=Dt>=le?Dt-le:0;while(--Gt);Ht+=le}if(ht.strm.avail_in===0)break;if(Gt=$t(ht.strm,ht.window,ht.strstart+ht.lookahead,Ht),ht.lookahead+=Gt,ht.lookahead+ht.insert>=xt)for(Wt=ht.strstart-ht.insert,ht.ins_h=ht.window[Wt],ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[Wt+1])&ht.hash_mask;ht.insert&&(ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[Wt+xt-1])&ht.hash_mask,ht.prev[Wt&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=Wt,Wt++,ht.insert--,!(ht.lookahead+ht.insert<xt)););}while(ht.lookahead<Et&&ht.strm.avail_in!==0)}function te(ht,qt){var Gt=65535;for(Gt>ht.pending_buf_size-5&&(Gt=ht.pending_buf_size-5);;){if(ht.lookahead<=1){if(Kt(ht),ht.lookahead===0&&qt===U)return Tt;if(ht.lookahead===0)break}ht.strstart+=ht.lookahead,ht.lookahead=0;var Dt=ht.block_start+Gt;if((ht.strstart===0||ht.strstart>=Dt)&&(ht.lookahead=ht.strstart-Dt,ht.strstart=Dt,ot(ht,!1),ht.strm.avail_out===0)||ht.strstart-ht.block_start>=ht.w_size-Et&&(ot(ht,!1),ht.strm.avail_out===0))return Tt}return ht.insert=0,qt===G?(ot(ht,!0),ht.strm.avail_out===0?Mt:mt):(ht.strstart>ht.block_start&&(ot(ht,!1),ht.strm.avail_out),Tt)}function Vt(ht,qt){for(var Gt,Dt;;){if(ht.lookahead<Et){if(Kt(ht),ht.lookahead<Et&&qt===U)return Tt;if(ht.lookahead===0)break}if(Gt=0,ht.lookahead>=xt&&(ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[ht.strstart+xt-1])&ht.hash_mask,Gt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart),Gt!==0&&ht.strstart-Gt<=ht.w_size-Et&&(ht.match_length=Zt(ht,Gt)),ht.match_length>=xt)if(Dt=P._tr_tally(ht,ht.strstart-ht.match_start,ht.match_length-xt),ht.lookahead-=ht.match_length,ht.match_length<=ht.max_lazy_match&&ht.lookahead>=xt){ht.match_length--;do ht.strstart++,ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[ht.strstart+xt-1])&ht.hash_mask,Gt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart;while(--ht.match_length!=0);ht.strstart++}else ht.strstart+=ht.match_length,ht.match_length=0,ht.ins_h=ht.window[ht.strstart],ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[ht.strstart+1])&ht.hash_mask;else Dt=P._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++;if(Dt&&(ot(ht,!1),ht.strm.avail_out===0))return Tt}return ht.insert=ht.strstart<xt-1?ht.strstart:xt-1,qt===G?(ot(ht,!0),ht.strm.avail_out===0?Mt:mt):ht.last_lit&&(ot(ht,!1),ht.strm.avail_out===0)?Tt:it}function ee(ht,qt){for(var Gt,Dt,Ht;;){if(ht.lookahead<Et){if(Kt(ht),ht.lookahead<Et&&qt===U)return Tt;if(ht.lookahead===0)break}if(Gt=0,ht.lookahead>=xt&&(ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[ht.strstart+xt-1])&ht.hash_mask,Gt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart),ht.prev_length=ht.match_length,ht.prev_match=ht.match_start,ht.match_length=xt-1,Gt!==0&&ht.prev_length<ht.max_lazy_match&&ht.strstart-Gt<=ht.w_size-Et&&(ht.match_length=Zt(ht,Gt),ht.match_length<=5&&(ht.strategy===J||ht.match_length===xt&&ht.strstart-ht.match_start>4096)&&(ht.match_length=xt-1)),ht.prev_length>=xt&&ht.match_length<=ht.prev_length){Ht=ht.strstart+ht.lookahead-xt,Dt=P._tr_tally(ht,ht.strstart-1-ht.prev_match,ht.prev_length-xt),ht.lookahead-=ht.prev_length-1,ht.prev_length-=2;do++ht.strstart<=Ht&&(ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[ht.strstart+xt-1])&ht.hash_mask,Gt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart);while(--ht.prev_length!=0);if(ht.match_available=0,ht.match_length=xt-1,ht.strstart++,Dt&&(ot(ht,!1),ht.strm.avail_out===0))return Tt}else if(ht.match_available){if((Dt=P._tr_tally(ht,0,ht.window[ht.strstart-1]))&&ot(ht,!1),ht.strstart++,ht.lookahead--,ht.strm.avail_out===0)return Tt}else ht.match_available=1,ht.strstart++,ht.lookahead--}return ht.match_available&&(Dt=P._tr_tally(ht,0,ht.window[ht.strstart-1]),ht.match_available=0),ht.insert=ht.strstart<xt-1?ht.strstart:xt-1,qt===G?(ot(ht,!0),ht.strm.avail_out===0?Mt:mt):ht.last_lit&&(ot(ht,!1),ht.strm.avail_out===0)?Tt:it}function Xt(ht,qt){for(var Gt,Dt,Ht,Wt,le=ht.window;;){if(ht.lookahead<=Ft){if(Kt(ht),ht.lookahead<=Ft&&qt===U)return Tt;if(ht.lookahead===0)break}if(ht.match_length=0,ht.lookahead>=xt&&ht.strstart>0&&(Dt=le[Ht=ht.strstart-1])===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]){Wt=ht.strstart+Ft;do;while(Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Ht<Wt);ht.match_length=Ft-(Wt-Ht),ht.match_length>ht.lookahead&&(ht.match_length=ht.lookahead)}if(ht.match_length>=xt?(Gt=P._tr_tally(ht,1,ht.match_length-xt),ht.lookahead-=ht.match_length,ht.strstart+=ht.match_length,ht.match_length=0):(Gt=P._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++),Gt&&(ot(ht,!1),ht.strm.avail_out===0))return Tt}return ht.insert=0,qt===G?(ot(ht,!0),ht.strm.avail_out===0?Mt:mt):ht.last_lit&&(ot(ht,!1),ht.strm.avail_out===0)?Tt:it}function oe(ht,qt){for(var Gt;;){if(ht.lookahead===0&&(Kt(ht),ht.lookahead===0)){if(qt===U)return Tt;break}if(ht.match_length=0,Gt=P._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++,Gt&&(ot(ht,!1),ht.strm.avail_out===0))return Tt}return ht.insert=0,qt===G?(ot(ht,!0),ht.strm.avail_out===0?Mt:mt):ht.last_lit&&(ot(ht,!1),ht.strm.avail_out===0)?Tt:it}function ne(ht,qt,Gt,Dt,Ht){this.good_length=ht,this.max_lazy=qt,this.nice_length=Gt,this.max_chain=Dt,this.func=Ht}function ae(ht){ht.window_size=2*ht.w_size,Bt(ht.head),ht.max_lazy_match=w[ht.level].max_lazy,ht.good_match=w[ht.level].good_length,ht.nice_match=w[ht.level].nice_length,ht.max_chain_length=w[ht.level].max_chain,ht.strstart=0,ht.block_start=0,ht.lookahead=0,ht.insert=0,ht.match_length=ht.prev_length=xt-1,ht.match_available=0,ht.ins_h=0}function he(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ct,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new I.Buf16(2*Pt),this.dyn_dtree=new I.Buf16(2*(2*ft+1)),this.bl_tree=new I.Buf16(2*(2*pt+1)),Bt(this.dyn_ltree),Bt(this.dyn_dtree),Bt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new I.Buf16(It+1),this.heap=new I.Buf16(2*dt+1),Bt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new I.Buf16(2*dt+1),Bt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(ht){var qt;return ht&&ht.state?(ht.total_in=ht.total_out=0,ht.data_type=at,(qt=ht.state).pending=0,qt.pending_out=0,qt.wrap<0&&(qt.wrap=-qt.wrap),qt.status=qt.wrap?Ot:Ut,ht.adler=qt.wrap===2?0:1,qt.last_flush=U,P._tr_init(qt),W):_t(ht,q)}function zt(ht){var qt=ie(ht);return qt===W&&ae(ht.state),qt}function Jt(ht,qt){return ht&&ht.state?ht.state.wrap!==2?q:(ht.state.gzhead=qt,W):q}function Lt(ht,qt,Gt,Dt,Ht,Wt){if(!ht)return q;var le=1;if(qt===X&&(qt=6),Dt<0?(le=0,Dt=-Dt):Dt>15&&(le=2,Dt-=16),Ht<1||Ht>V||Gt!==ct||Dt<8||Dt>15||qt<0||qt>9||Wt<0||Wt>nt)return _t(ht,q);Dt===8&&(Dt=9);var re=new he;return ht.state=re,re.strm=ht,re.wrap=le,re.gzhead=null,re.w_bits=Dt,re.w_size=1<<re.w_bits,re.w_mask=re.w_size-1,re.hash_bits=Ht+7,re.hash_size=1<<re.hash_bits,re.hash_mask=re.hash_size-1,re.hash_shift=~~((re.hash_bits+xt-1)/xt),re.window=new I.Buf8(2*re.w_size),re.head=new I.Buf16(re.hash_size),re.prev=new I.Buf16(re.w_size),re.lit_bufsize=1<<Ht+6,re.pending_buf_size=4*re.lit_bufsize,re.pending_buf=new I.Buf8(re.pending_buf_size),re.d_buf=1*re.lit_bufsize,re.l_buf=3*re.lit_bufsize,re.level=qt,re.strategy=Wt,re.method=Gt,zt(ht)}function Qt(ht,qt){return Lt(ht,qt,ct,ut,wt,lt)}function kt(ht,qt){var Gt,Dt,Ht,Wt;if(!ht||!ht.state||qt>H||qt<0)return ht?_t(ht,q):q;if(Dt=ht.state,!ht.output||!ht.input&&ht.avail_in!==0||Dt.status===jt&&qt!==G)return _t(ht,ht.avail_out===0?et:q);if(Dt.strm=ht,Gt=Dt.last_flush,Dt.last_flush=qt,Dt.status===Ot)if(Dt.wrap===2)ht.adler=0,bt(Dt,31),bt(Dt,139),bt(Dt,8),Dt.gzhead?(bt(Dt,(Dt.gzhead.text?1:0)+(Dt.gzhead.hcrc?2:0)+(Dt.gzhead.extra?4:0)+(Dt.gzhead.name?8:0)+(Dt.gzhead.comment?16:0)),bt(Dt,255&Dt.gzhead.time),bt(Dt,Dt.gzhead.time>>8&255),bt(Dt,Dt.gzhead.time>>16&255),bt(Dt,Dt.gzhead.time>>24&255),bt(Dt,Dt.level===9?2:Dt.strategy>=tt||Dt.level<2?4:0),bt(Dt,255&Dt.gzhead.os),Dt.gzhead.extra&&Dt.gzhead.extra.length&&(bt(Dt,255&Dt.gzhead.extra.length),bt(Dt,Dt.gzhead.extra.length>>8&255)),Dt.gzhead.hcrc&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending,0)),Dt.gzindex=0,Dt.status=Rt):(bt(Dt,0),bt(Dt,0),bt(Dt,0),bt(Dt,0),bt(Dt,0),bt(Dt,Dt.level===9?2:Dt.strategy>=tt||Dt.level<2?4:0),bt(Dt,gt),Dt.status=Ut);else{var le=ct+(Dt.w_bits-8<<4)<<8;le|=(Dt.strategy>=tt||Dt.level<2?0:Dt.level<6?1:Dt.level===6?2:3)<<6,Dt.strstart!==0&&(le|=Ct),le+=31-le%31,Dt.status=Ut,yt(Dt,le),Dt.strstart!==0&&(yt(Dt,ht.adler>>>16),yt(Dt,65535&ht.adler)),ht.adler=1}if(Dt.status===Rt)if(Dt.gzhead.extra){for(Ht=Dt.pending;Dt.gzindex<(65535&Dt.gzhead.extra.length)&&(Dt.pending!==Dt.pending_buf_size||(Dt.gzhead.hcrc&&Dt.pending>Ht&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),K(ht),Ht=Dt.pending,Dt.pending!==Dt.pending_buf_size));)bt(Dt,255&Dt.gzhead.extra[Dt.gzindex]),Dt.gzindex++;Dt.gzhead.hcrc&&Dt.pending>Ht&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),Dt.gzindex===Dt.gzhead.extra.length&&(Dt.gzindex=0,Dt.status=St)}else Dt.status=St;if(Dt.status===St)if(Dt.gzhead.name){Ht=Dt.pending;do{if(Dt.pending===Dt.pending_buf_size&&(Dt.gzhead.hcrc&&Dt.pending>Ht&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),K(ht),Ht=Dt.pending,Dt.pending===Dt.pending_buf_size)){Wt=1;break}Wt=Dt.gzindex<Dt.gzhead.name.length?255&Dt.gzhead.name.charCodeAt(Dt.gzindex++):0,bt(Dt,Wt)}while(Wt!==0);Dt.gzhead.hcrc&&Dt.pending>Ht&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),Wt===0&&(Dt.gzindex=0,Dt.status=At)}else Dt.status=At;if(Dt.status===At)if(Dt.gzhead.comment){Ht=Dt.pending;do{if(Dt.pending===Dt.pending_buf_size&&(Dt.gzhead.hcrc&&Dt.pending>Ht&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),K(ht),Ht=Dt.pending,Dt.pending===Dt.pending_buf_size)){Wt=1;break}Wt=Dt.gzindex<Dt.gzhead.comment.length?255&Dt.gzhead.comment.charCodeAt(Dt.gzindex++):0,bt(Dt,Wt)}while(Wt!==0);Dt.gzhead.hcrc&&Dt.pending>Ht&&(ht.adler=D(ht.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),Wt===0&&(Dt.status=Nt)}else Dt.status=Nt;if(Dt.status===Nt&&(Dt.gzhead.hcrc?(Dt.pending+2>Dt.pending_buf_size&&K(ht),Dt.pending+2<=Dt.pending_buf_size&&(bt(Dt,255&ht.adler),bt(Dt,ht.adler>>8&255),ht.adler=0,Dt.status=Ut)):Dt.status=Ut),Dt.pending!==0){if(K(ht),ht.avail_out===0)return Dt.last_flush=-1,W}else if(ht.avail_in===0&&vt(qt)<=vt(Gt)&&qt!==G)return _t(ht,et);if(Dt.status===jt&&ht.avail_in!==0)return _t(ht,et);if(ht.avail_in!==0||Dt.lookahead!==0||qt!==U&&Dt.status!==jt){var re=Dt.strategy===tt?oe(Dt,qt):Dt.strategy===st?Xt(Dt,qt):w[Dt.level].func(Dt,qt);if(re!==Mt&&re!==mt||(Dt.status=jt),re===Tt||re===Mt)return ht.avail_out===0&&(Dt.last_flush=-1),W;if(re===it&&(qt===j?P._tr_align(Dt):qt!==H&&(P._tr_stored_block(Dt,0,0,!1),qt===Z&&(Bt(Dt.head),Dt.lookahead===0&&(Dt.strstart=0,Dt.block_start=0,Dt.insert=0))),K(ht),ht.avail_out===0))return Dt.last_flush=-1,W}return qt!==G?W:Dt.wrap<=0?Q:(Dt.wrap===2?(bt(Dt,255&ht.adler),bt(Dt,ht.adler>>8&255),bt(Dt,ht.adler>>16&255),bt(Dt,ht.adler>>24&255),bt(Dt,255&ht.total_in),bt(Dt,ht.total_in>>8&255),bt(Dt,ht.total_in>>16&255),bt(Dt,ht.total_in>>24&255)):(yt(Dt,ht.adler>>>16),yt(Dt,65535&ht.adler)),K(ht),Dt.wrap>0&&(Dt.wrap=-Dt.wrap),Dt.pending!==0?W:Q)}function Yt(ht){var qt;return ht&&ht.state?(qt=ht.state.status)!==Ot&&qt!==Rt&&qt!==St&&qt!==At&&qt!==Nt&&qt!==Ut&&qt!==jt?_t(ht,q):(ht.state=null,qt===Ut?_t(ht,rt):W):q}function ue(ht,qt){var Gt,Dt,Ht,Wt,le,re,se,ce,ve=qt.length;if(!ht||!ht.state||(Wt=(Gt=ht.state).wrap)===2||Wt===1&&Gt.status!==Ot||Gt.lookahead)return q;for(Wt===1&&(ht.adler=F(ht.adler,qt,ve,0)),Gt.wrap=0,ve>=Gt.w_size&&(Wt===0&&(Bt(Gt.head),Gt.strstart=0,Gt.block_start=0,Gt.insert=0),ce=new I.Buf8(Gt.w_size),I.arraySet(ce,qt,ve-Gt.w_size,Gt.w_size,0),qt=ce,ve=Gt.w_size),le=ht.avail_in,re=ht.next_in,se=ht.input,ht.avail_in=ve,ht.next_in=0,ht.input=qt,Kt(Gt);Gt.lookahead>=xt;){Dt=Gt.strstart,Ht=Gt.lookahead-(xt-1);do Gt.ins_h=(Gt.ins_h<<Gt.hash_shift^Gt.window[Dt+xt-1])&Gt.hash_mask,Gt.prev[Dt&Gt.w_mask]=Gt.head[Gt.ins_h],Gt.head[Gt.ins_h]=Dt,Dt++;while(--Ht);Gt.strstart=Dt,Gt.lookahead=xt-1,Kt(Gt)}return Gt.strstart+=Gt.lookahead,Gt.block_start=Gt.strstart,Gt.insert=Gt.lookahead,Gt.lookahead=0,Gt.match_length=Gt.prev_length=xt-1,Gt.match_available=0,ht.next_in=re,ht.input=se,ht.avail_in=le,Gt.wrap=Wt,W}w=[new ne(0,0,0,0,te),new ne(4,4,8,4,Vt),new ne(4,5,16,8,Vt),new ne(4,6,32,32,Vt),new ne(4,4,16,16,ee),new ne(8,16,32,32,ee),new ne(8,16,128,128,ee),new ne(8,32,128,256,ee),new ne(32,128,258,1024,ee),new ne(32,258,258,4096,ee)],g.deflateInit=Qt,g.deflateInit2=Lt,g.deflateReset=zt,g.deflateResetKeep=ie,g.deflateSetHeader=Jt,g.deflate=kt,g.deflateEnd=Yt,g.deflateSetDictionary=ue,g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./messages":60,"./trees":61}],57:[function(d,m,g){var w=30,I=12;m.exports=function(P,F){var D,$,U,j,Z,G,H,W,Q,q,rt,et,X,J,tt,st,nt,lt,at,ct,V,ut,wt,dt,ft;D=P.state,$=P.next_in,dt=P.input,U=$+(P.avail_in-5),j=P.next_out,ft=P.output,Z=j-(F-P.avail_out),G=j+(P.avail_out-257),H=D.dmax,W=D.wsize,Q=D.whave,q=D.wnext,rt=D.window,et=D.hold,X=D.bits,J=D.lencode,tt=D.distcode,st=(1<<D.lenbits)-1,nt=(1<<D.distbits)-1;t:do{X<15&&(et+=dt[$++]<<X,X+=8,et+=dt[$++]<<X,X+=8),lt=J[et&st];e:for(;;){if(et>>>=at=lt>>>24,X-=at,(at=lt>>>16&255)==0)ft[j++]=65535&lt;else{if(!(16&at)){if(64&at){if(32&at){D.mode=I;break t}P.msg="invalid literal/length code",D.mode=w;break t}lt=J[(65535&lt)+(et&(1<<at)-1)];continue e}for(ct=65535&lt,(at&=15)&&(X<at&&(et+=dt[$++]<<X,X+=8),ct+=et&(1<<at)-1,et>>>=at,X-=at),X<15&&(et+=dt[$++]<<X,X+=8,et+=dt[$++]<<X,X+=8),lt=tt[et&nt];;){if(et>>>=at=lt>>>24,X-=at,16&(at=lt>>>16&255)){if(V=65535&lt,X<(at&=15)&&(et+=dt[$++]<<X,(X+=8)<at&&(et+=dt[$++]<<X,X+=8)),(V+=et&(1<<at)-1)>H){P.msg="invalid distance too far back",D.mode=w;break t}if(et>>>=at,X-=at,V>(at=j-Z)){if((at=V-at)>Q&&D.sane){P.msg="invalid distance too far back",D.mode=w;break t}if(ut=0,wt=rt,q===0){if(ut+=W-at,at<ct){ct-=at;do ft[j++]=rt[ut++];while(--at);ut=j-V,wt=ft}}else if(q<at){if(ut+=W+q-at,(at-=q)<ct){ct-=at;do ft[j++]=rt[ut++];while(--at);if(ut=0,q<ct){ct-=at=q;do ft[j++]=rt[ut++];while(--at);ut=j-V,wt=ft}}}else if(ut+=q-at,at<ct){ct-=at;do ft[j++]=rt[ut++];while(--at);ut=j-V,wt=ft}for(;ct>2;)ft[j++]=wt[ut++],ft[j++]=wt[ut++],ft[j++]=wt[ut++],ct-=3;ct&&(ft[j++]=wt[ut++],ct>1&&(ft[j++]=wt[ut++]))}else{ut=j-V;do ft[j++]=ft[ut++],ft[j++]=ft[ut++],ft[j++]=ft[ut++],ct-=3;while(ct>2);ct&&(ft[j++]=ft[ut++],ct>1&&(ft[j++]=ft[ut++]))}break}if(64&at){P.msg="invalid distance code",D.mode=w;break t}lt=tt[(65535&lt)+(et&(1<<at)-1)]}}break}}while($<U&&j<G);$-=ct=X>>3,et&=(1<<(X-=ct<<3))-1,P.next_in=$,P.next_out=j,P.avail_in=$<U?U-$+5:5-($-U),P.avail_out=j<G?G-j+257:257-(j-G),D.hold=et,D.bits=X}},{}],58:[function(d,m,g){var w=d("../utils/common"),I=d("./adler32"),P=d("./crc32"),F=d("./inffast"),D=d("./inftrees"),$=0,U=1,j=2,Z=4,G=5,H=6,W=0,Q=1,q=2,rt=-2,et=-3,X=-4,J=-5,tt=8,st=1,nt=2,lt=3,at=4,ct=5,V=6,ut=7,wt=8,dt=9,ft=10,pt=11,Pt=12,It=13,xt=14,Ft=15,Et=16,Ct=17,Ot=18,Rt=19,St=20,At=21,Nt=22,Ut=23,jt=24,Tt=25,it=26,Mt=27,mt=28,gt=29,_t=30,vt=31,Bt=852,K=592,ot=15;function bt(Lt){return(Lt>>>24&255)+(Lt>>>8&65280)+((65280&Lt)<<8)+((255&Lt)<<24)}function yt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new w.Buf16(320),this.work=new w.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function $t(Lt){var Qt;return Lt&&Lt.state?(Qt=Lt.state,Lt.total_in=Lt.total_out=Qt.total=0,Lt.msg="",Qt.wrap&&(Lt.adler=1&Qt.wrap),Qt.mode=st,Qt.last=0,Qt.havedict=0,Qt.dmax=32768,Qt.head=null,Qt.hold=0,Qt.bits=0,Qt.lencode=Qt.lendyn=new w.Buf32(Bt),Qt.distcode=Qt.distdyn=new w.Buf32(K),Qt.sane=1,Qt.back=-1,W):rt}function Zt(Lt){var Qt;return Lt&&Lt.state?((Qt=Lt.state).wsize=0,Qt.whave=0,Qt.wnext=0,$t(Lt)):rt}function Kt(Lt,Qt){var kt,Yt;return Lt&&Lt.state?(Yt=Lt.state,Qt<0?(kt=0,Qt=-Qt):(kt=1+(Qt>>4),Qt<48&&(Qt&=15)),Qt&&(Qt<8||Qt>15)?rt:(Yt.window!==null&&Yt.wbits!==Qt&&(Yt.window=null),Yt.wrap=kt,Yt.wbits=Qt,Zt(Lt))):rt}function te(Lt,Qt){var kt,Yt;return Lt?(Yt=new yt,Lt.state=Yt,Yt.window=null,(kt=Kt(Lt,Qt))!==W&&(Lt.state=null),kt):rt}function Vt(Lt){return te(Lt,ot)}var ee,Xt,oe=!0;function ne(Lt){if(oe){var Qt;for(ee=new w.Buf32(512),Xt=new w.Buf32(32),Qt=0;Qt<144;)Lt.lens[Qt++]=8;for(;Qt<256;)Lt.lens[Qt++]=9;for(;Qt<280;)Lt.lens[Qt++]=7;for(;Qt<288;)Lt.lens[Qt++]=8;for(D(U,Lt.lens,0,288,ee,0,Lt.work,{bits:9}),Qt=0;Qt<32;)Lt.lens[Qt++]=5;D(j,Lt.lens,0,32,Xt,0,Lt.work,{bits:5}),oe=!1}Lt.lencode=ee,Lt.lenbits=9,Lt.distcode=Xt,Lt.distbits=5}function ae(Lt,Qt,kt,Yt){var ue,ht=Lt.state;return ht.window===null&&(ht.wsize=1<<ht.wbits,ht.wnext=0,ht.whave=0,ht.window=new w.Buf8(ht.wsize)),Yt>=ht.wsize?(w.arraySet(ht.window,Qt,kt-ht.wsize,ht.wsize,0),ht.wnext=0,ht.whave=ht.wsize):((ue=ht.wsize-ht.wnext)>Yt&&(ue=Yt),w.arraySet(ht.window,Qt,kt-Yt,ue,ht.wnext),(Yt-=ue)?(w.arraySet(ht.window,Qt,kt-Yt,Yt,0),ht.wnext=Yt,ht.whave=ht.wsize):(ht.wnext+=ue,ht.wnext===ht.wsize&&(ht.wnext=0),ht.whave<ht.wsize&&(ht.whave+=ue))),0}function he(Lt,Qt){var kt,Yt,ue,ht,qt,Gt,Dt,Ht,Wt,le,re,se,ce,ve,fe,de,_e,ge,Ee,ke,pe,ye,xe,we,be=0,me=new w.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Lt||!Lt.state||!Lt.output||!Lt.input&&Lt.avail_in!==0)return rt;(kt=Lt.state).mode===Pt&&(kt.mode=It),qt=Lt.next_out,ue=Lt.output,Dt=Lt.avail_out,ht=Lt.next_in,Yt=Lt.input,Gt=Lt.avail_in,Ht=kt.hold,Wt=kt.bits,le=Gt,re=Dt,ye=W;t:for(;;)switch(kt.mode){case st:if(kt.wrap===0){kt.mode=It;break}for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(2&kt.wrap&&Ht===35615){kt.check=0,me[0]=255&Ht,me[1]=Ht>>>8&255,kt.check=P(kt.check,me,2,0),Ht=0,Wt=0,kt.mode=nt;break}if(kt.flags=0,kt.head&&(kt.head.done=!1),!(1&kt.wrap)||(((255&Ht)<<8)+(Ht>>8))%31){Lt.msg="incorrect header check",kt.mode=_t;break}if((15&Ht)!==tt){Lt.msg="unknown compression method",kt.mode=_t;break}if(Wt-=4,pe=8+(15&(Ht>>>=4)),kt.wbits===0)kt.wbits=pe;else if(pe>kt.wbits){Lt.msg="invalid window size",kt.mode=_t;break}kt.dmax=1<<pe,Lt.adler=kt.check=1,kt.mode=512&Ht?ft:Pt,Ht=0,Wt=0;break;case nt:for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(kt.flags=Ht,(255&kt.flags)!==tt){Lt.msg="unknown compression method",kt.mode=_t;break}if(57344&kt.flags){Lt.msg="unknown header flags set",kt.mode=_t;break}kt.head&&(kt.head.text=Ht>>8&1),512&kt.flags&&(me[0]=255&Ht,me[1]=Ht>>>8&255,kt.check=P(kt.check,me,2,0)),Ht=0,Wt=0,kt.mode=lt;case lt:for(;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}kt.head&&(kt.head.time=Ht),512&kt.flags&&(me[0]=255&Ht,me[1]=Ht>>>8&255,me[2]=Ht>>>16&255,me[3]=Ht>>>24&255,kt.check=P(kt.check,me,4,0)),Ht=0,Wt=0,kt.mode=at;case at:for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}kt.head&&(kt.head.xflags=255&Ht,kt.head.os=Ht>>8),512&kt.flags&&(me[0]=255&Ht,me[1]=Ht>>>8&255,kt.check=P(kt.check,me,2,0)),Ht=0,Wt=0,kt.mode=ct;case ct:if(1024&kt.flags){for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}kt.length=Ht,kt.head&&(kt.head.extra_len=Ht),512&kt.flags&&(me[0]=255&Ht,me[1]=Ht>>>8&255,kt.check=P(kt.check,me,2,0)),Ht=0,Wt=0}else kt.head&&(kt.head.extra=null);kt.mode=V;case V:if(1024&kt.flags&&((se=kt.length)>Gt&&(se=Gt),se&&(kt.head&&(pe=kt.head.extra_len-kt.length,kt.head.extra||(kt.head.extra=new Array(kt.head.extra_len)),w.arraySet(kt.head.extra,Yt,ht,se,pe)),512&kt.flags&&(kt.check=P(kt.check,Yt,se,ht)),Gt-=se,ht+=se,kt.length-=se),kt.length))break t;kt.length=0,kt.mode=ut;case ut:if(2048&kt.flags){if(Gt===0)break t;se=0;do pe=Yt[ht+se++],kt.head&&pe&&kt.length<65536&&(kt.head.name+=String.fromCharCode(pe));while(pe&&se<Gt);if(512&kt.flags&&(kt.check=P(kt.check,Yt,se,ht)),Gt-=se,ht+=se,pe)break t}else kt.head&&(kt.head.name=null);kt.length=0,kt.mode=wt;case wt:if(4096&kt.flags){if(Gt===0)break t;se=0;do pe=Yt[ht+se++],kt.head&&pe&&kt.length<65536&&(kt.head.comment+=String.fromCharCode(pe));while(pe&&se<Gt);if(512&kt.flags&&(kt.check=P(kt.check,Yt,se,ht)),Gt-=se,ht+=se,pe)break t}else kt.head&&(kt.head.comment=null);kt.mode=dt;case dt:if(512&kt.flags){for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(Ht!==(65535&kt.check)){Lt.msg="header crc mismatch",kt.mode=_t;break}Ht=0,Wt=0}kt.head&&(kt.head.hcrc=kt.flags>>9&1,kt.head.done=!0),Lt.adler=kt.check=0,kt.mode=Pt;break;case ft:for(;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}Lt.adler=kt.check=bt(Ht),Ht=0,Wt=0,kt.mode=pt;case pt:if(kt.havedict===0)return Lt.next_out=qt,Lt.avail_out=Dt,Lt.next_in=ht,Lt.avail_in=Gt,kt.hold=Ht,kt.bits=Wt,q;Lt.adler=kt.check=1,kt.mode=Pt;case Pt:if(Qt===G||Qt===H)break t;case It:if(kt.last){Ht>>>=7&Wt,Wt-=7&Wt,kt.mode=Mt;break}for(;Wt<3;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}switch(kt.last=1&Ht,Wt-=1,3&(Ht>>>=1)){case 0:kt.mode=xt;break;case 1:if(ne(kt),kt.mode=St,Qt===H){Ht>>>=2,Wt-=2;break t}break;case 2:kt.mode=Ct;break;case 3:Lt.msg="invalid block type",kt.mode=_t}Ht>>>=2,Wt-=2;break;case xt:for(Ht>>>=7&Wt,Wt-=7&Wt;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if((65535&Ht)!=(Ht>>>16^65535)){Lt.msg="invalid stored block lengths",kt.mode=_t;break}if(kt.length=65535&Ht,Ht=0,Wt=0,kt.mode=Ft,Qt===H)break t;case Ft:kt.mode=Et;case Et:if(se=kt.length){if(se>Gt&&(se=Gt),se>Dt&&(se=Dt),se===0)break t;w.arraySet(ue,Yt,ht,se,qt),Gt-=se,ht+=se,Dt-=se,qt+=se,kt.length-=se;break}kt.mode=Pt;break;case Ct:for(;Wt<14;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(kt.nlen=257+(31&Ht),Ht>>>=5,Wt-=5,kt.ndist=1+(31&Ht),Ht>>>=5,Wt-=5,kt.ncode=4+(15&Ht),Ht>>>=4,Wt-=4,kt.nlen>286||kt.ndist>30){Lt.msg="too many length or distance symbols",kt.mode=_t;break}kt.have=0,kt.mode=Ot;case Ot:for(;kt.have<kt.ncode;){for(;Wt<3;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}kt.lens[Se[kt.have++]]=7&Ht,Ht>>>=3,Wt-=3}for(;kt.have<19;)kt.lens[Se[kt.have++]]=0;if(kt.lencode=kt.lendyn,kt.lenbits=7,xe={bits:kt.lenbits},ye=D($,kt.lens,0,19,kt.lencode,0,kt.work,xe),kt.lenbits=xe.bits,ye){Lt.msg="invalid code lengths set",kt.mode=_t;break}kt.have=0,kt.mode=Rt;case Rt:for(;kt.have<kt.nlen+kt.ndist;){for(;de=(be=kt.lencode[Ht&(1<<kt.lenbits)-1])>>>16&255,_e=65535&be,!((fe=be>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(_e<16)Ht>>>=fe,Wt-=fe,kt.lens[kt.have++]=_e;else{if(_e===16){for(we=fe+2;Wt<we;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(Ht>>>=fe,Wt-=fe,kt.have===0){Lt.msg="invalid bit length repeat",kt.mode=_t;break}pe=kt.lens[kt.have-1],se=3+(3&Ht),Ht>>>=2,Wt-=2}else if(_e===17){for(we=fe+3;Wt<we;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}Wt-=fe,pe=0,se=3+(7&(Ht>>>=fe)),Ht>>>=3,Wt-=3}else{for(we=fe+7;Wt<we;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}Wt-=fe,pe=0,se=11+(127&(Ht>>>=fe)),Ht>>>=7,Wt-=7}if(kt.have+se>kt.nlen+kt.ndist){Lt.msg="invalid bit length repeat",kt.mode=_t;break}for(;se--;)kt.lens[kt.have++]=pe}}if(kt.mode===_t)break;if(kt.lens[256]===0){Lt.msg="invalid code -- missing end-of-block",kt.mode=_t;break}if(kt.lenbits=9,xe={bits:kt.lenbits},ye=D(U,kt.lens,0,kt.nlen,kt.lencode,0,kt.work,xe),kt.lenbits=xe.bits,ye){Lt.msg="invalid literal/lengths set",kt.mode=_t;break}if(kt.distbits=6,kt.distcode=kt.distdyn,xe={bits:kt.distbits},ye=D(j,kt.lens,kt.nlen,kt.ndist,kt.distcode,0,kt.work,xe),kt.distbits=xe.bits,ye){Lt.msg="invalid distances set",kt.mode=_t;break}if(kt.mode=St,Qt===H)break t;case St:kt.mode=At;case At:if(Gt>=6&&Dt>=258){Lt.next_out=qt,Lt.avail_out=Dt,Lt.next_in=ht,Lt.avail_in=Gt,kt.hold=Ht,kt.bits=Wt,F(Lt,re),qt=Lt.next_out,ue=Lt.output,Dt=Lt.avail_out,ht=Lt.next_in,Yt=Lt.input,Gt=Lt.avail_in,Ht=kt.hold,Wt=kt.bits,kt.mode===Pt&&(kt.back=-1);break}for(kt.back=0;de=(be=kt.lencode[Ht&(1<<kt.lenbits)-1])>>>16&255,_e=65535&be,!((fe=be>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(de&&!(240&de)){for(ge=fe,Ee=de,ke=_e;de=(be=kt.lencode[ke+((Ht&(1<<ge+Ee)-1)>>ge)])>>>16&255,_e=65535&be,!(ge+(fe=be>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}Ht>>>=ge,Wt-=ge,kt.back+=ge}if(Ht>>>=fe,Wt-=fe,kt.back+=fe,kt.length=_e,de===0){kt.mode=it;break}if(32&de){kt.back=-1,kt.mode=Pt;break}if(64&de){Lt.msg="invalid literal/length code",kt.mode=_t;break}kt.extra=15&de,kt.mode=Nt;case Nt:if(kt.extra){for(we=kt.extra;Wt<we;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}kt.length+=Ht&(1<<kt.extra)-1,Ht>>>=kt.extra,Wt-=kt.extra,kt.back+=kt.extra}kt.was=kt.length,kt.mode=Ut;case Ut:for(;de=(be=kt.distcode[Ht&(1<<kt.distbits)-1])>>>16&255,_e=65535&be,!((fe=be>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(!(240&de)){for(ge=fe,Ee=de,ke=_e;de=(be=kt.distcode[ke+((Ht&(1<<ge+Ee)-1)>>ge)])>>>16&255,_e=65535&be,!(ge+(fe=be>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}Ht>>>=ge,Wt-=ge,kt.back+=ge}if(Ht>>>=fe,Wt-=fe,kt.back+=fe,64&de){Lt.msg="invalid distance code",kt.mode=_t;break}kt.offset=_e,kt.extra=15&de,kt.mode=jt;case jt:if(kt.extra){for(we=kt.extra;Wt<we;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}kt.offset+=Ht&(1<<kt.extra)-1,Ht>>>=kt.extra,Wt-=kt.extra,kt.back+=kt.extra}if(kt.offset>kt.dmax){Lt.msg="invalid distance too far back",kt.mode=_t;break}kt.mode=Tt;case Tt:if(Dt===0)break t;if(se=re-Dt,kt.offset>se){if((se=kt.offset-se)>kt.whave&&kt.sane){Lt.msg="invalid distance too far back",kt.mode=_t;break}se>kt.wnext?(se-=kt.wnext,ce=kt.wsize-se):ce=kt.wnext-se,se>kt.length&&(se=kt.length),ve=kt.window}else ve=ue,ce=qt-kt.offset,se=kt.length;se>Dt&&(se=Dt),Dt-=se,kt.length-=se;do ue[qt++]=ve[ce++];while(--se);kt.length===0&&(kt.mode=At);break;case it:if(Dt===0)break t;ue[qt++]=kt.length,Dt--,kt.mode=At;break;case Mt:if(kt.wrap){for(;Wt<32;){if(Gt===0)break t;Gt--,Ht|=Yt[ht++]<<Wt,Wt+=8}if(re-=Dt,Lt.total_out+=re,kt.total+=re,re&&(Lt.adler=kt.check=kt.flags?P(kt.check,ue,re,qt-re):I(kt.check,ue,re,qt-re)),re=Dt,(kt.flags?Ht:bt(Ht))!==kt.check){Lt.msg="incorrect data check",kt.mode=_t;break}Ht=0,Wt=0}kt.mode=mt;case mt:if(kt.wrap&&kt.flags){for(;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[ht++]<<Wt,Wt+=8}if(Ht!==(4294967295&kt.total)){Lt.msg="incorrect length check",kt.mode=_t;break}Ht=0,Wt=0}kt.mode=gt;case gt:ye=Q;break t;case _t:ye=et;break t;case vt:return X;default:return rt}return Lt.next_out=qt,Lt.avail_out=Dt,Lt.next_in=ht,Lt.avail_in=Gt,kt.hold=Ht,kt.bits=Wt,(kt.wsize||re!==Lt.avail_out&&kt.mode<_t&&(kt.mode<Mt||Qt!==Z))&&ae(Lt,Lt.output,Lt.next_out,re-Lt.avail_out),le-=Lt.avail_in,re-=Lt.avail_out,Lt.total_in+=le,Lt.total_out+=re,kt.total+=re,kt.wrap&&re&&(Lt.adler=kt.check=kt.flags?P(kt.check,ue,re,Lt.next_out-re):I(kt.check,ue,re,Lt.next_out-re)),Lt.data_type=kt.bits+(kt.last?64:0)+(kt.mode===Pt?128:0)+(kt.mode===St||kt.mode===Ft?256:0),(le===0&&re===0||Qt===Z)&&ye===W&&(ye=J),ye}function ie(Lt){if(!Lt||!Lt.state)return rt;var Qt=Lt.state;return Qt.window&&(Qt.window=null),Lt.state=null,W}function zt(Lt,Qt){var kt;return Lt&&Lt.state&&2&(kt=Lt.state).wrap?(kt.head=Qt,Qt.done=!1,W):rt}function Jt(Lt,Qt){var kt,Yt=Qt.length;return Lt&&Lt.state?(kt=Lt.state).wrap!==0&&kt.mode!==pt?rt:kt.mode===pt&&I(1,Qt,Yt,0)!==kt.check?et:ae(Lt,Qt,Yt,Yt)?(kt.mode=vt,X):(kt.havedict=1,W):rt}g.inflateReset=Zt,g.inflateReset2=Kt,g.inflateResetKeep=$t,g.inflateInit=Vt,g.inflateInit2=te,g.inflate=he,g.inflateEnd=ie,g.inflateGetHeader=zt,g.inflateSetDictionary=Jt,g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./inffast":57,"./inftrees":59}],59:[function(d,m,g){var w=d("../utils/common"),I=15,P=852,F=592,D=0,$=1,U=2,j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Z=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],H=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(W,Q,q,rt,et,X,J,tt){var st,nt,lt,at,ct,V,ut,wt,dt,ft=tt.bits,pt=0,Pt=0,It=0,xt=0,Ft=0,Et=0,Ct=0,Ot=0,Rt=0,St=0,At=null,Nt=0,Ut=new w.Buf16(I+1),jt=new w.Buf16(I+1),Tt=null,it=0;for(pt=0;pt<=I;pt++)Ut[pt]=0;for(Pt=0;Pt<rt;Pt++)Ut[Q[q+Pt]]++;for(Ft=ft,xt=I;xt>=1&&Ut[xt]===0;xt--);if(Ft>xt&&(Ft=xt),xt===0)return et[X++]=20971520,et[X++]=20971520,tt.bits=1,0;for(It=1;It<xt&&Ut[It]===0;It++);for(Ft<It&&(Ft=It),Ot=1,pt=1;pt<=I;pt++)if(Ot<<=1,(Ot-=Ut[pt])<0)return-1;if(Ot>0&&(W===D||xt!==1))return-1;for(jt[1]=0,pt=1;pt<I;pt++)jt[pt+1]=jt[pt]+Ut[pt];for(Pt=0;Pt<rt;Pt++)Q[q+Pt]!==0&&(J[jt[Q[q+Pt]]++]=Pt);if(W===D?(At=Tt=J,V=19):W===$?(At=j,Nt-=257,Tt=Z,it-=257,V=256):(At=G,Tt=H,V=-1),St=0,Pt=0,pt=It,ct=X,Et=Ft,Ct=0,lt=-1,at=(Rt=1<<Ft)-1,W===$&&Rt>P||W===U&&Rt>F)return 1;for(;;){ut=pt-Ct,J[Pt]<V?(wt=0,dt=J[Pt]):J[Pt]>V?(wt=Tt[it+J[Pt]],dt=At[Nt+J[Pt]]):(wt=96,dt=0),st=1<<pt-Ct,It=nt=1<<Et;do et[ct+(St>>Ct)+(nt-=st)]=ut<<24|wt<<16|dt;while(nt!==0);for(st=1<<pt-1;St&st;)st>>=1;if(st!==0?(St&=st-1,St+=st):St=0,Pt++,--Ut[pt]==0){if(pt===xt)break;pt=Q[q+J[Pt]]}if(pt>Ft&&(St&at)!==lt){for(Ct===0&&(Ct=Ft),ct+=It,Ot=1<<(Et=pt-Ct);Et+Ct<xt&&!((Ot-=Ut[Et+Ct])<=0);)Et++,Ot<<=1;if(Rt+=1<<Et,W===$&&Rt>P||W===U&&Rt>F)return 1;et[lt=St&at]=Ft<<24|Et<<16|ct-X}}return St!==0&&(et[ct+St]=pt-Ct<<24|64<<16),tt.bits=Ft,0}},{"../utils/common":52}],60:[function(d,m,g){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(d,m,g){var w=d("../utils/common"),I=4,P=0,F=1,D=2;function $(zt){for(var Jt=zt.length;--Jt>=0;)zt[Jt]=0}var U=0,j=1,Z=2,G=3,H=258,W=29,Q=256,q=Q+1+W,rt=30,et=19,X=2*q+1,J=15,tt=16,st=7,nt=256,lt=16,at=17,ct=18,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ut=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],wt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],dt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ft=512,pt=new Array(2*(q+2));$(pt);var Pt=new Array(2*rt);$(Pt);var It=new Array(ft);$(It);var xt=new Array(H-G+1);$(xt);var Ft=new Array(W);$(Ft);var Et,Ct,Ot,Rt=new Array(rt);function St(zt,Jt,Lt,Qt,kt){this.static_tree=zt,this.extra_bits=Jt,this.extra_base=Lt,this.elems=Qt,this.max_length=kt,this.has_stree=zt&&zt.length}function At(zt,Jt){this.dyn_tree=zt,this.max_code=0,this.stat_desc=Jt}function Nt(zt){return zt<256?It[zt]:It[256+(zt>>>7)]}function Ut(zt,Jt){zt.pending_buf[zt.pending++]=255&Jt,zt.pending_buf[zt.pending++]=Jt>>>8&255}function jt(zt,Jt,Lt){zt.bi_valid>tt-Lt?(zt.bi_buf|=Jt<<zt.bi_valid&65535,Ut(zt,zt.bi_buf),zt.bi_buf=Jt>>tt-zt.bi_valid,zt.bi_valid+=Lt-tt):(zt.bi_buf|=Jt<<zt.bi_valid&65535,zt.bi_valid+=Lt)}function Tt(zt,Jt,Lt){jt(zt,Lt[2*Jt],Lt[2*Jt+1])}function it(zt,Jt){var Lt=0;do Lt|=1&zt,zt>>>=1,Lt<<=1;while(--Jt>0);return Lt>>>1}function Mt(zt){zt.bi_valid===16?(Ut(zt,zt.bi_buf),zt.bi_buf=0,zt.bi_valid=0):zt.bi_valid>=8&&(zt.pending_buf[zt.pending++]=255&zt.bi_buf,zt.bi_buf>>=8,zt.bi_valid-=8)}function mt(zt,Jt){var Lt,Qt,kt,Yt,ue,ht,qt=Jt.dyn_tree,Gt=Jt.max_code,Dt=Jt.stat_desc.static_tree,Ht=Jt.stat_desc.has_stree,Wt=Jt.stat_desc.extra_bits,le=Jt.stat_desc.extra_base,re=Jt.stat_desc.max_length,se=0;for(Yt=0;Yt<=J;Yt++)zt.bl_count[Yt]=0;for(qt[2*zt.heap[zt.heap_max]+1]=0,Lt=zt.heap_max+1;Lt<X;Lt++)(Yt=qt[2*qt[2*(Qt=zt.heap[Lt])+1]+1]+1)>re&&(Yt=re,se++),qt[2*Qt+1]=Yt,Qt>Gt||(zt.bl_count[Yt]++,ue=0,Qt>=le&&(ue=Wt[Qt-le]),ht=qt[2*Qt],zt.opt_len+=ht*(Yt+ue),Ht&&(zt.static_len+=ht*(Dt[2*Qt+1]+ue)));if(se!==0){do{for(Yt=re-1;zt.bl_count[Yt]===0;)Yt--;zt.bl_count[Yt]--,zt.bl_count[Yt+1]+=2,zt.bl_count[re]--,se-=2}while(se>0);for(Yt=re;Yt!==0;Yt--)for(Qt=zt.bl_count[Yt];Qt!==0;)(kt=zt.heap[--Lt])>Gt||(qt[2*kt+1]!==Yt&&(zt.opt_len+=(Yt-qt[2*kt+1])*qt[2*kt],qt[2*kt+1]=Yt),Qt--)}}function gt(zt,Jt,Lt){var Qt,kt,Yt=new Array(J+1),ue=0;for(Qt=1;Qt<=J;Qt++)Yt[Qt]=ue=ue+Lt[Qt-1]<<1;for(kt=0;kt<=Jt;kt++){var ht=zt[2*kt+1];ht!==0&&(zt[2*kt]=it(Yt[ht]++,ht))}}function _t(){var zt,Jt,Lt,Qt,kt,Yt=new Array(J+1);for(Lt=0,Qt=0;Qt<W-1;Qt++)for(Ft[Qt]=Lt,zt=0;zt<1<<V[Qt];zt++)xt[Lt++]=Qt;for(xt[Lt-1]=Qt,kt=0,Qt=0;Qt<16;Qt++)for(Rt[Qt]=kt,zt=0;zt<1<<ut[Qt];zt++)It[kt++]=Qt;for(kt>>=7;Qt<rt;Qt++)for(Rt[Qt]=kt<<7,zt=0;zt<1<<ut[Qt]-7;zt++)It[256+kt++]=Qt;for(Jt=0;Jt<=J;Jt++)Yt[Jt]=0;for(zt=0;zt<=143;)pt[2*zt+1]=8,zt++,Yt[8]++;for(;zt<=255;)pt[2*zt+1]=9,zt++,Yt[9]++;for(;zt<=279;)pt[2*zt+1]=7,zt++,Yt[7]++;for(;zt<=287;)pt[2*zt+1]=8,zt++,Yt[8]++;for(gt(pt,q+1,Yt),zt=0;zt<rt;zt++)Pt[2*zt+1]=5,Pt[2*zt]=it(zt,5);Et=new St(pt,V,Q+1,q,J),Ct=new St(Pt,ut,0,rt,J),Ot=new St(new Array(0),wt,0,et,st)}function vt(zt){var Jt;for(Jt=0;Jt<q;Jt++)zt.dyn_ltree[2*Jt]=0;for(Jt=0;Jt<rt;Jt++)zt.dyn_dtree[2*Jt]=0;for(Jt=0;Jt<et;Jt++)zt.bl_tree[2*Jt]=0;zt.dyn_ltree[2*nt]=1,zt.opt_len=zt.static_len=0,zt.last_lit=zt.matches=0}function Bt(zt){zt.bi_valid>8?Ut(zt,zt.bi_buf):zt.bi_valid>0&&(zt.pending_buf[zt.pending++]=zt.bi_buf),zt.bi_buf=0,zt.bi_valid=0}function K(zt,Jt,Lt,Qt){Bt(zt),Ut(zt,Lt),Ut(zt,~Lt),w.arraySet(zt.pending_buf,zt.window,Jt,Lt,zt.pending),zt.pending+=Lt}function ot(zt,Jt,Lt,Qt){var kt=2*Jt,Yt=2*Lt;return zt[kt]<zt[Yt]||zt[kt]===zt[Yt]&&Qt[Jt]<=Qt[Lt]}function bt(zt,Jt,Lt){for(var Qt=zt.heap[Lt],kt=Lt<<1;kt<=zt.heap_len&&(kt<zt.heap_len&&ot(Jt,zt.heap[kt+1],zt.heap[kt],zt.depth)&&kt++,!ot(Jt,Qt,zt.heap[kt],zt.depth));)zt.heap[Lt]=zt.heap[kt],Lt=kt,kt<<=1;zt.heap[Lt]=Qt}function yt(zt,Jt,Lt){var Qt,kt,Yt,ue,ht=0;if(zt.last_lit!==0)do Qt=zt.pending_buf[zt.d_buf+2*ht]<<8|zt.pending_buf[zt.d_buf+2*ht+1],kt=zt.pending_buf[zt.l_buf+ht],ht++,Qt===0?Tt(zt,kt,Jt):(Tt(zt,(Yt=xt[kt])+Q+1,Jt),(ue=V[Yt])!==0&&jt(zt,kt-=Ft[Yt],ue),Tt(zt,Yt=Nt(--Qt),Lt),(ue=ut[Yt])!==0&&jt(zt,Qt-=Rt[Yt],ue));while(ht<zt.last_lit);Tt(zt,nt,Jt)}function $t(zt,Jt){var Lt,Qt,kt,Yt=Jt.dyn_tree,ue=Jt.stat_desc.static_tree,ht=Jt.stat_desc.has_stree,qt=Jt.stat_desc.elems,Gt=-1;for(zt.heap_len=0,zt.heap_max=X,Lt=0;Lt<qt;Lt++)Yt[2*Lt]!==0?(zt.heap[++zt.heap_len]=Gt=Lt,zt.depth[Lt]=0):Yt[2*Lt+1]=0;for(;zt.heap_len<2;)Yt[2*(kt=zt.heap[++zt.heap_len]=Gt<2?++Gt:0)]=1,zt.depth[kt]=0,zt.opt_len--,ht&&(zt.static_len-=ue[2*kt+1]);for(Jt.max_code=Gt,Lt=zt.heap_len>>1;Lt>=1;Lt--)bt(zt,Yt,Lt);kt=qt;do Lt=zt.heap[1],zt.heap[1]=zt.heap[zt.heap_len--],bt(zt,Yt,1),Qt=zt.heap[1],zt.heap[--zt.heap_max]=Lt,zt.heap[--zt.heap_max]=Qt,Yt[2*kt]=Yt[2*Lt]+Yt[2*Qt],zt.depth[kt]=(zt.depth[Lt]>=zt.depth[Qt]?zt.depth[Lt]:zt.depth[Qt])+1,Yt[2*Lt+1]=Yt[2*Qt+1]=kt,zt.heap[1]=kt++,bt(zt,Yt,1);while(zt.heap_len>=2);zt.heap[--zt.heap_max]=zt.heap[1],mt(zt,Jt),gt(Yt,Gt,zt.bl_count)}function Zt(zt,Jt,Lt){var Qt,kt,Yt=-1,ue=Jt[1],ht=0,qt=7,Gt=4;for(ue===0&&(qt=138,Gt=3),Jt[2*(Lt+1)+1]=65535,Qt=0;Qt<=Lt;Qt++)kt=ue,ue=Jt[2*(Qt+1)+1],++ht<qt&&kt===ue||(ht<Gt?zt.bl_tree[2*kt]+=ht:kt!==0?(kt!==Yt&&zt.bl_tree[2*kt]++,zt.bl_tree[2*lt]++):ht<=10?zt.bl_tree[2*at]++:zt.bl_tree[2*ct]++,ht=0,Yt=kt,ue===0?(qt=138,Gt=3):kt===ue?(qt=6,Gt=3):(qt=7,Gt=4))}function Kt(zt,Jt,Lt){var Qt,kt,Yt=-1,ue=Jt[1],ht=0,qt=7,Gt=4;for(ue===0&&(qt=138,Gt=3),Qt=0;Qt<=Lt;Qt++)if(kt=ue,ue=Jt[2*(Qt+1)+1],!(++ht<qt&&kt===ue)){if(ht<Gt)do Tt(zt,kt,zt.bl_tree);while(--ht!=0);else kt!==0?(kt!==Yt&&(Tt(zt,kt,zt.bl_tree),ht--),Tt(zt,lt,zt.bl_tree),jt(zt,ht-3,2)):ht<=10?(Tt(zt,at,zt.bl_tree),jt(zt,ht-3,3)):(Tt(zt,ct,zt.bl_tree),jt(zt,ht-11,7));ht=0,Yt=kt,ue===0?(qt=138,Gt=3):kt===ue?(qt=6,Gt=3):(qt=7,Gt=4)}}function te(zt){var Jt;for(Zt(zt,zt.dyn_ltree,zt.l_desc.max_code),Zt(zt,zt.dyn_dtree,zt.d_desc.max_code),$t(zt,zt.bl_desc),Jt=et-1;Jt>=3&&zt.bl_tree[2*dt[Jt]+1]===0;Jt--);return zt.opt_len+=3*(Jt+1)+5+5+4,Jt}function Vt(zt,Jt,Lt,Qt){var kt;for(jt(zt,Jt-257,5),jt(zt,Lt-1,5),jt(zt,Qt-4,4),kt=0;kt<Qt;kt++)jt(zt,zt.bl_tree[2*dt[kt]+1],3);Kt(zt,zt.dyn_ltree,Jt-1),Kt(zt,zt.dyn_dtree,Lt-1)}function ee(zt){var Jt,Lt=4093624447;for(Jt=0;Jt<=31;Jt++,Lt>>>=1)if(1&Lt&&zt.dyn_ltree[2*Jt]!==0)return P;if(zt.dyn_ltree[18]!==0||zt.dyn_ltree[20]!==0||zt.dyn_ltree[26]!==0)return F;for(Jt=32;Jt<Q;Jt++)if(zt.dyn_ltree[2*Jt]!==0)return F;return P}$(Rt);var Xt=!1;function oe(zt){Xt||(_t(),Xt=!0),zt.l_desc=new At(zt.dyn_ltree,Et),zt.d_desc=new At(zt.dyn_dtree,Ct),zt.bl_desc=new At(zt.bl_tree,Ot),zt.bi_buf=0,zt.bi_valid=0,vt(zt)}function ne(zt,Jt,Lt,Qt){jt(zt,(U<<1)+(Qt?1:0),3),K(zt,Jt,Lt)}function ae(zt){jt(zt,j<<1,3),Tt(zt,nt,pt),Mt(zt)}function he(zt,Jt,Lt,Qt){var kt,Yt,ue=0;zt.level>0?(zt.strm.data_type===D&&(zt.strm.data_type=ee(zt)),$t(zt,zt.l_desc),$t(zt,zt.d_desc),ue=te(zt),kt=zt.opt_len+3+7>>>3,(Yt=zt.static_len+3+7>>>3)<=kt&&(kt=Yt)):kt=Yt=Lt+5,Lt+4<=kt&&Jt!==-1?ne(zt,Jt,Lt,Qt):zt.strategy===I||Yt===kt?(jt(zt,(j<<1)+(Qt?1:0),3),yt(zt,pt,Pt)):(jt(zt,(Z<<1)+(Qt?1:0),3),Vt(zt,zt.l_desc.max_code+1,zt.d_desc.max_code+1,ue+1),yt(zt,zt.dyn_ltree,zt.dyn_dtree)),vt(zt),Qt&&Bt(zt)}function ie(zt,Jt,Lt){return zt.pending_buf[zt.d_buf+2*zt.last_lit]=Jt>>>8&255,zt.pending_buf[zt.d_buf+2*zt.last_lit+1]=255&Jt,zt.pending_buf[zt.l_buf+zt.last_lit]=255&Lt,zt.last_lit++,Jt===0?zt.dyn_ltree[2*Lt]++:(zt.matches++,Jt--,zt.dyn_ltree[2*(xt[Lt]+Q+1)]++,zt.dyn_dtree[2*Nt(Jt)]++),zt.last_lit===zt.lit_bufsize-1}g._tr_init=oe,g._tr_stored_block=ne,g._tr_flush_block=he,g._tr_tally=ie,g._tr_align=ae},{"../utils/common":52}],62:[function(d,m,g){function w(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}m.exports=w},{}],63:[function(d,m,g){var w,I,P=m.exports={};function F(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function $(et){if(w===setTimeout)return setTimeout(et,0);if((w===F||!w)&&setTimeout)return w=setTimeout,setTimeout(et,0);try{return w(et,0)}catch{try{return w.call(null,et,0)}catch{return w.call(this,et,0)}}}function U(et){if(I===clearTimeout)return clearTimeout(et);if((I===D||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(et);try{return I(et)}catch{try{return I.call(null,et)}catch{return I.call(this,et)}}}(function(){try{w=typeof setTimeout=="function"?setTimeout:F}catch{w=F}try{I=typeof clearTimeout=="function"?clearTimeout:D}catch{I=D}})();var j,Z=[],G=!1,H=-1;function W(){G&&j&&(G=!1,j.length?Z=j.concat(Z):H=-1,Z.length&&Q())}function Q(){if(!G){var et=$(W);G=!0;for(var X=Z.length;X;){for(j=Z,Z=[];++H<X;)j&&j[H].run();H=-1,X=Z.length}j=null,G=!1,U(et)}}function q(et,X){this.fun=et,this.array=X}function rt(){}P.nextTick=function(et){var X=new Array(arguments.length-1);if(arguments.length>1)for(var J=1;J<arguments.length;J++)X[J-1]=arguments[J];Z.push(new q(et,X)),Z.length!==1||G||$(Q)},q.prototype.run=function(){this.fun.apply(null,this.array)},P.title="browser",P.browser=!0,P.env={},P.argv=[],P.version="",P.versions={},P.on=rt,P.addListener=rt,P.once=rt,P.off=rt,P.removeListener=rt,P.removeAllListeners=rt,P.emit=rt,P.prependListener=rt,P.prependOnceListener=rt,P.listeners=function(et){return[]},P.binding=function(et){throw new Error("process.binding is not supported")},P.cwd=function(){return"/"},P.chdir=function(et){throw new Error("process.chdir is not supported")},P.umask=function(){return 0}},{}],64:[function(d,m,g){var w=d("buffer"),I=w.Buffer;function P(D,$){for(var U in D)$[U]=D[U]}function F(D,$,U){return I(D,$,U)}I.from&&I.alloc&&I.allocUnsafe&&I.allocUnsafeSlow?m.exports=w:(P(w,g),g.Buffer=F),F.prototype=Object.create(I.prototype),P(I,F),F.from=function(D,$,U){if(typeof D=="number")throw new TypeError("Argument must not be a number");return I(D,$,U)},F.alloc=function(D,$,U){if(typeof D!="number")throw new TypeError("Argument must be a number");var j=I(D);return $!==void 0?typeof U=="string"?j.fill($,U):j.fill($):j.fill(0),j},F.allocUnsafe=function(D){if(typeof D!="number")throw new TypeError("Argument must be a number");return I(D)},F.allocUnsafeSlow=function(D){if(typeof D!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(D)}},{buffer:32}],65:[function(d,m,g){m.exports=I;var w=d("events").EventEmitter;function I(){w.call(this)}d("inherits")(I,w),I.Readable=d("readable-stream/lib/_stream_readable.js"),I.Writable=d("readable-stream/lib/_stream_writable.js"),I.Duplex=d("readable-stream/lib/_stream_duplex.js"),I.Transform=d("readable-stream/lib/_stream_transform.js"),I.PassThrough=d("readable-stream/lib/_stream_passthrough.js"),I.finished=d("readable-stream/lib/internal/streams/end-of-stream.js"),I.pipeline=d("readable-stream/lib/internal/streams/pipeline.js"),I.Stream=I,I.prototype.pipe=function(P,F){var D=this;function $(Q){P.writable&&P.write(Q)===!1&&D.pause&&D.pause()}function U(){D.readable&&D.resume&&D.resume()}D.on("data",$),P.on("drain",U),P._isStdio||F&&F.end===!1||(D.on("end",Z),D.on("close",G));var j=!1;function Z(){j||(j=!0,P.end())}function G(){j||(j=!0,typeof P.destroy=="function"&&P.destroy())}function H(Q){if(W(),w.listenerCount(this,"error")===0)throw Q}function W(){D.removeListener("data",$),P.removeListener("drain",U),D.removeListener("end",Z),D.removeListener("close",G),D.removeListener("error",H),P.removeListener("error",H),D.removeListener("end",W),D.removeListener("close",W),P.removeListener("close",W)}return D.on("error",H),P.on("error",H),D.on("end",W),D.on("close",W),P.on("close",W),P.emit("pipe",D),P}},{events:35,inherits:46,"readable-stream/lib/_stream_duplex.js":67,"readable-stream/lib/_stream_passthrough.js":68,"readable-stream/lib/_stream_readable.js":69,"readable-stream/lib/_stream_transform.js":70,"readable-stream/lib/_stream_writable.js":71,"readable-stream/lib/internal/streams/end-of-stream.js":75,"readable-stream/lib/internal/streams/pipeline.js":77}],66:[function(d,m,g){function w(j,Z){j.prototype=Object.create(Z.prototype),j.prototype.constructor=j,j.__proto__=Z}var I={};function P(j,Z,G){function H(Q,q,rt){return typeof Z=="string"?Z:Z(Q,q,rt)}G||(G=Error);var W=(function(Q){function q(rt,et,X){return Q.call(this,H(rt,et,X))||this}return w(q,Q),q})(G);W.prototype.name=G.name,W.prototype.code=j,I[j]=W}function F(j,Z){if(Array.isArray(j)){var G=j.length;return j=j.map((function(H){return String(H)})),G>2?"one of ".concat(Z," ").concat(j.slice(0,G-1).join(", "),", or ")+j[G-1]:G===2?"one of ".concat(Z," ").concat(j[0]," or ").concat(j[1]):"of ".concat(Z," ").concat(j[0])}return"of ".concat(Z," ").concat(String(j))}function D(j,Z,G){return j.substr(0,Z.length)===Z}function $(j,Z,G){return(G===void 0||G>j.length)&&(G=j.length),j.substring(G-Z.length,G)===Z}function U(j,Z,G){return typeof G!="number"&&(G=0),!(G+Z.length>j.length)&&j.indexOf(Z,G)!==-1}P("ERR_INVALID_OPT_VALUE",(function(j,Z){return'The value "'+Z+'" is invalid for option "'+j+'"'}),TypeError),P("ERR_INVALID_ARG_TYPE",(function(j,Z,G){var H,W;if(typeof Z=="string"&&D(Z,"not ")?(H="must not be",Z=Z.replace(/^not /,"")):H="must be",$(j," argument"))W="The ".concat(j," ").concat(H," ").concat(F(Z,"type"));else{var Q=U(j,".")?"property":"argument";W='The "'.concat(j,'" ').concat(Q," ").concat(H," ").concat(F(Z,"type"))}return W+=". Received type ".concat(typeof G)}),TypeError),P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),P("ERR_METHOD_NOT_IMPLEMENTED",(function(j){return"The "+j+" method is not implemented"})),P("ERR_STREAM_PREMATURE_CLOSE","Premature close"),P("ERR_STREAM_DESTROYED",(function(j){return"Cannot call "+j+" after a stream was destroyed"})),P("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),P("ERR_STREAM_WRITE_AFTER_END","write after end"),P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),P("ERR_UNKNOWN_ENCODING",(function(j){return"Unknown encoding: "+j}),TypeError),P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),m.exports.codes=I},{}],67:[function(d,m,g){(function(w){(function(){var I=Object.keys||function(H){var W=[];for(var Q in H)W.push(Q);return W};m.exports=j;var P=d("./_stream_readable"),F=d("./_stream_writable");d("inherits")(j,P);for(var D=I(F.prototype),$=0;$<D.length;$++){var U=D[$];j.prototype[U]||(j.prototype[U]=F.prototype[U])}function j(H){if(!(this instanceof j))return new j(H);P.call(this,H),F.call(this,H),this.allowHalfOpen=!0,H&&(H.readable===!1&&(this.readable=!1),H.writable===!1&&(this.writable=!1),H.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Z)))}function Z(){this._writableState.ended||w.nextTick(G,this)}function G(H){H.end()}Object.defineProperty(j.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(j.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(j.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(j.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(H){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=H,this._writableState.destroyed=H)}})}).call(this)}).call(this,d("_process"))},{"./_stream_readable":69,"./_stream_writable":71,_process:63,inherits:46}],68:[function(d,m,g){m.exports=I;var w=d("./_stream_transform");function I(P){if(!(this instanceof I))return new I(P);w.call(this,P)}d("inherits")(I,w),I.prototype._transform=function(P,F,D){D(null,P)}},{"./_stream_transform":70,inherits:46}],69:[function(d,m,g){(function(w,I){(function(){var P;m.exports=wt,wt.ReadableState=ut,d("events").EventEmitter;var F=function(_t,vt){return _t.listeners(vt).length},D=d("./internal/streams/stream"),$=d("buffer").Buffer,U=I.Uint8Array||function(){};function j(_t){return $.from(_t)}function Z(_t){return $.isBuffer(_t)||_t instanceof U}var G,H=d("util");G=H&&H.debuglog?H.debuglog("stream"):function(){};var W,Q,q,rt=d("./internal/streams/buffer_list"),et=d("./internal/streams/destroy"),X=d("./internal/streams/state").getHighWaterMark,J=d("../errors").codes,tt=J.ERR_INVALID_ARG_TYPE,st=J.ERR_STREAM_PUSH_AFTER_EOF,nt=J.ERR_METHOD_NOT_IMPLEMENTED,lt=J.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;d("inherits")(wt,D);var at=et.errorOrDestroy,ct=["error","close","destroy","pause","resume"];function V(_t,vt,Bt){if(typeof _t.prependListener=="function")return _t.prependListener(vt,Bt);_t._events&&_t._events[vt]?Array.isArray(_t._events[vt])?_t._events[vt].unshift(Bt):_t._events[vt]=[Bt,_t._events[vt]]:_t.on(vt,Bt)}function ut(_t,vt,Bt){P=P||d("./_stream_duplex"),_t=_t||{},typeof Bt!="boolean"&&(Bt=vt instanceof P),this.objectMode=!!_t.objectMode,Bt&&(this.objectMode=this.objectMode||!!_t.readableObjectMode),this.highWaterMark=X(this,_t,"readableHighWaterMark",Bt),this.buffer=new rt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=_t.emitClose!==!1,this.autoDestroy=!!_t.autoDestroy,this.destroyed=!1,this.defaultEncoding=_t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,_t.encoding&&(W||(W=d("string_decoder/").StringDecoder),this.decoder=new W(_t.encoding),this.encoding=_t.encoding)}function wt(_t){if(P=P||d("./_stream_duplex"),!(this instanceof wt))return new wt(_t);var vt=this instanceof P;this._readableState=new ut(_t,this,vt),this.readable=!0,_t&&(typeof _t.read=="function"&&(this._read=_t.read),typeof _t.destroy=="function"&&(this._destroy=_t.destroy)),D.call(this)}function dt(_t,vt,Bt,K,ot){G("readableAddChunk",vt);var bt,yt=_t._readableState;if(vt===null)yt.reading=!1,Ft(_t,yt);else if(ot||(bt=pt(yt,vt)),bt)at(_t,bt);else if(yt.objectMode||vt&&vt.length>0)if(typeof vt=="string"||yt.objectMode||Object.getPrototypeOf(vt)===$.prototype||(vt=j(vt)),K)yt.endEmitted?at(_t,new lt):ft(_t,yt,vt,!0);else if(yt.ended)at(_t,new st);else{if(yt.destroyed)return!1;yt.reading=!1,yt.decoder&&!Bt?(vt=yt.decoder.write(vt),yt.objectMode||vt.length!==0?ft(_t,yt,vt,!1):Ot(_t,yt)):ft(_t,yt,vt,!1)}else K||(yt.reading=!1,Ot(_t,yt));return!yt.ended&&(yt.length<yt.highWaterMark||yt.length===0)}function ft(_t,vt,Bt,K){vt.flowing&&vt.length===0&&!vt.sync?(vt.awaitDrain=0,_t.emit("data",Bt)):(vt.length+=vt.objectMode?1:Bt.length,K?vt.buffer.unshift(Bt):vt.buffer.push(Bt),vt.needReadable&&Et(_t)),Ot(_t,vt)}function pt(_t,vt){var Bt;return Z(vt)||typeof vt=="string"||vt===void 0||_t.objectMode||(Bt=new tt("chunk",["string","Buffer","Uint8Array"],vt)),Bt}Object.defineProperty(wt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(_t){this._readableState&&(this._readableState.destroyed=_t)}}),wt.prototype.destroy=et.destroy,wt.prototype._undestroy=et.undestroy,wt.prototype._destroy=function(_t,vt){vt(_t)},wt.prototype.push=function(_t,vt){var Bt,K=this._readableState;return K.objectMode?Bt=!0:typeof _t=="string"&&((vt=vt||K.defaultEncoding)!==K.encoding&&(_t=$.from(_t,vt),vt=""),Bt=!0),dt(this,_t,vt,!1,Bt)},wt.prototype.unshift=function(_t){return dt(this,_t,null,!0,!1)},wt.prototype.isPaused=function(){return this._readableState.flowing===!1},wt.prototype.setEncoding=function(_t){W||(W=d("string_decoder/").StringDecoder);var vt=new W(_t);this._readableState.decoder=vt,this._readableState.encoding=this._readableState.decoder.encoding;for(var Bt=this._readableState.buffer.head,K="";Bt!==null;)K+=vt.write(Bt.data),Bt=Bt.next;return this._readableState.buffer.clear(),K!==""&&this._readableState.buffer.push(K),this._readableState.length=K.length,this};var Pt=1073741824;function It(_t){return _t>=Pt?_t=Pt:(_t--,_t|=_t>>>1,_t|=_t>>>2,_t|=_t>>>4,_t|=_t>>>8,_t|=_t>>>16,_t++),_t}function xt(_t,vt){return _t<=0||vt.length===0&&vt.ended?0:vt.objectMode?1:_t!=_t?vt.flowing&&vt.length?vt.buffer.head.data.length:vt.length:(_t>vt.highWaterMark&&(vt.highWaterMark=It(_t)),_t<=vt.length?_t:vt.ended?vt.length:(vt.needReadable=!0,0))}function Ft(_t,vt){if(G("onEofChunk"),!vt.ended){if(vt.decoder){var Bt=vt.decoder.end();Bt&&Bt.length&&(vt.buffer.push(Bt),vt.length+=vt.objectMode?1:Bt.length)}vt.ended=!0,vt.sync?Et(_t):(vt.needReadable=!1,vt.emittedReadable||(vt.emittedReadable=!0,Ct(_t)))}}function Et(_t){var vt=_t._readableState;G("emitReadable",vt.needReadable,vt.emittedReadable),vt.needReadable=!1,vt.emittedReadable||(G("emitReadable",vt.flowing),vt.emittedReadable=!0,w.nextTick(Ct,_t))}function Ct(_t){var vt=_t._readableState;G("emitReadable_",vt.destroyed,vt.length,vt.ended),vt.destroyed||!vt.length&&!vt.ended||(_t.emit("readable"),vt.emittedReadable=!1),vt.needReadable=!vt.flowing&&!vt.ended&&vt.length<=vt.highWaterMark,Tt(_t)}function Ot(_t,vt){vt.readingMore||(vt.readingMore=!0,w.nextTick(Rt,_t,vt))}function Rt(_t,vt){for(;!vt.reading&&!vt.ended&&(vt.length<vt.highWaterMark||vt.flowing&&vt.length===0);){var Bt=vt.length;if(G("maybeReadMore read 0"),_t.read(0),Bt===vt.length)break}vt.readingMore=!1}function St(_t){return function(){var vt=_t._readableState;G("pipeOnDrain",vt.awaitDrain),vt.awaitDrain&&vt.awaitDrain--,vt.awaitDrain===0&&F(_t,"data")&&(vt.flowing=!0,Tt(_t))}}function At(_t){var vt=_t._readableState;vt.readableListening=_t.listenerCount("readable")>0,vt.resumeScheduled&&!vt.paused?vt.flowing=!0:_t.listenerCount("data")>0&&_t.resume()}function Nt(_t){G("readable nexttick read 0"),_t.read(0)}function Ut(_t,vt){vt.resumeScheduled||(vt.resumeScheduled=!0,w.nextTick(jt,_t,vt))}function jt(_t,vt){G("resume",vt.reading),vt.reading||_t.read(0),vt.resumeScheduled=!1,_t.emit("resume"),Tt(_t),vt.flowing&&!vt.reading&&_t.read(0)}function Tt(_t){var vt=_t._readableState;for(G("flow",vt.flowing);vt.flowing&&_t.read()!==null;);}function it(_t,vt){return vt.length===0?null:(vt.objectMode?Bt=vt.buffer.shift():!_t||_t>=vt.length?(Bt=vt.decoder?vt.buffer.join(""):vt.buffer.length===1?vt.buffer.first():vt.buffer.concat(vt.length),vt.buffer.clear()):Bt=vt.buffer.consume(_t,vt.decoder),Bt);var Bt}function Mt(_t){var vt=_t._readableState;G("endReadable",vt.endEmitted),vt.endEmitted||(vt.ended=!0,w.nextTick(mt,vt,_t))}function mt(_t,vt){if(G("endReadableNT",_t.endEmitted,_t.length),!_t.endEmitted&&_t.length===0&&(_t.endEmitted=!0,vt.readable=!1,vt.emit("end"),_t.autoDestroy)){var Bt=vt._writableState;(!Bt||Bt.autoDestroy&&Bt.finished)&&vt.destroy()}}function gt(_t,vt){for(var Bt=0,K=_t.length;Bt<K;Bt++)if(_t[Bt]===vt)return Bt;return-1}wt.prototype.read=function(_t){G("read",_t),_t=parseInt(_t,10);var vt=this._readableState,Bt=_t;if(_t!==0&&(vt.emittedReadable=!1),_t===0&&vt.needReadable&&((vt.highWaterMark!==0?vt.length>=vt.highWaterMark:vt.length>0)||vt.ended))return G("read: emitReadable",vt.length,vt.ended),vt.length===0&&vt.ended?Mt(this):Et(this),null;if((_t=xt(_t,vt))===0&&vt.ended)return vt.length===0&&Mt(this),null;var K,ot=vt.needReadable;return G("need readable",ot),(vt.length===0||vt.length-_t<vt.highWaterMark)&&G("length less than watermark",ot=!0),vt.ended||vt.reading?G("reading or ended",ot=!1):ot&&(G("do read"),vt.reading=!0,vt.sync=!0,vt.length===0&&(vt.needReadable=!0),this._read(vt.highWaterMark),vt.sync=!1,vt.reading||(_t=xt(Bt,vt))),(K=_t>0?it(_t,vt):null)===null?(vt.needReadable=vt.length<=vt.highWaterMark,_t=0):(vt.length-=_t,vt.awaitDrain=0),vt.length===0&&(vt.ended||(vt.needReadable=!0),Bt!==_t&&vt.ended&&Mt(this)),K!==null&&this.emit("data",K),K},wt.prototype._read=function(_t){at(this,new nt("_read()"))},wt.prototype.pipe=function(_t,vt){var Bt=this,K=this._readableState;switch(K.pipesCount){case 0:K.pipes=_t;break;case 1:K.pipes=[K.pipes,_t];break;default:K.pipes.push(_t)}K.pipesCount+=1,G("pipe count=%d opts=%j",K.pipesCount,vt);var ot=vt&&vt.end===!1||_t===w.stdout||_t===w.stderr?oe:yt;function bt(ne,ae){G("onunpipe"),ne===Bt&&ae&&ae.hasUnpiped===!1&&(ae.hasUnpiped=!0,Kt())}function yt(){G("onend"),_t.end()}K.endEmitted?w.nextTick(ot):Bt.once("end",ot),_t.on("unpipe",bt);var $t=St(Bt);_t.on("drain",$t);var Zt=!1;function Kt(){G("cleanup"),_t.removeListener("close",ee),_t.removeListener("finish",Xt),_t.removeListener("drain",$t),_t.removeListener("error",Vt),_t.removeListener("unpipe",bt),Bt.removeListener("end",yt),Bt.removeListener("end",oe),Bt.removeListener("data",te),Zt=!0,!K.awaitDrain||_t._writableState&&!_t._writableState.needDrain||$t()}function te(ne){G("ondata");var ae=_t.write(ne);G("dest.write",ae),ae===!1&&((K.pipesCount===1&&K.pipes===_t||K.pipesCount>1&&gt(K.pipes,_t)!==-1)&&!Zt&&(G("false write response, pause",K.awaitDrain),K.awaitDrain++),Bt.pause())}function Vt(ne){G("onerror",ne),oe(),_t.removeListener("error",Vt),F(_t,"error")===0&&at(_t,ne)}function ee(){_t.removeListener("finish",Xt),oe()}function Xt(){G("onfinish"),_t.removeListener("close",ee),oe()}function oe(){G("unpipe"),Bt.unpipe(_t)}return Bt.on("data",te),V(_t,"error",Vt),_t.once("close",ee),_t.once("finish",Xt),_t.emit("pipe",Bt),K.flowing||(G("pipe resume"),Bt.resume()),_t},wt.prototype.unpipe=function(_t){var vt=this._readableState,Bt={hasUnpiped:!1};if(vt.pipesCount===0)return this;if(vt.pipesCount===1)return _t&&_t!==vt.pipes||(_t||(_t=vt.pipes),vt.pipes=null,vt.pipesCount=0,vt.flowing=!1,_t&&_t.emit("unpipe",this,Bt)),this;if(!_t){var K=vt.pipes,ot=vt.pipesCount;vt.pipes=null,vt.pipesCount=0,vt.flowing=!1;for(var bt=0;bt<ot;bt++)K[bt].emit("unpipe",this,{hasUnpiped:!1});return this}var yt=gt(vt.pipes,_t);return yt===-1||(vt.pipes.splice(yt,1),vt.pipesCount-=1,vt.pipesCount===1&&(vt.pipes=vt.pipes[0]),_t.emit("unpipe",this,Bt)),this},wt.prototype.on=function(_t,vt){var Bt=D.prototype.on.call(this,_t,vt),K=this._readableState;return _t==="data"?(K.readableListening=this.listenerCount("readable")>0,K.flowing!==!1&&this.resume()):_t==="readable"&&(K.endEmitted||K.readableListening||(K.readableListening=K.needReadable=!0,K.flowing=!1,K.emittedReadable=!1,G("on readable",K.length,K.reading),K.length?Et(this):K.reading||w.nextTick(Nt,this))),Bt},wt.prototype.addListener=wt.prototype.on,wt.prototype.removeListener=function(_t,vt){var Bt=D.prototype.removeListener.call(this,_t,vt);return _t==="readable"&&w.nextTick(At,this),Bt},wt.prototype.removeAllListeners=function(_t){var vt=D.prototype.removeAllListeners.apply(this,arguments);return _t!=="readable"&&_t!==void 0||w.nextTick(At,this),vt},wt.prototype.resume=function(){var _t=this._readableState;return _t.flowing||(G("resume"),_t.flowing=!_t.readableListening,Ut(this,_t)),_t.paused=!1,this},wt.prototype.pause=function(){return G("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(G("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},wt.prototype.wrap=function(_t){var vt=this,Bt=this._readableState,K=!1;for(var ot in _t.on("end",(function(){if(G("wrapped end"),Bt.decoder&&!Bt.ended){var yt=Bt.decoder.end();yt&&yt.length&&vt.push(yt)}vt.push(null)})),_t.on("data",(function(yt){G("wrapped data"),Bt.decoder&&(yt=Bt.decoder.write(yt)),Bt.objectMode&&yt==null||(Bt.objectMode||yt&&yt.length)&&(vt.push(yt)||(K=!0,_t.pause()))})),_t)this[ot]===void 0&&typeof _t[ot]=="function"&&(this[ot]=(function(yt){return function(){return _t[yt].apply(_t,arguments)}})(ot));for(var bt=0;bt<ct.length;bt++)_t.on(ct[bt],this.emit.bind(this,ct[bt]));return this._read=function(yt){G("wrapped _read",yt),K&&(K=!1,_t.resume())},this},typeof Symbol=="function"&&(wt.prototype[Symbol.asyncIterator]=function(){return Q===void 0&&(Q=d("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(wt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(wt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(wt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(_t){this._readableState&&(this._readableState.flowing=_t)}}),wt._fromList=it,Object.defineProperty(wt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(wt.from=function(_t,vt){return q===void 0&&(q=d("./internal/streams/from")),q(wt,_t,vt)})}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/async_iterator":72,"./internal/streams/buffer_list":73,"./internal/streams/destroy":74,"./internal/streams/from":76,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,events:35,inherits:46,"string_decoder/":80,util:29}],70:[function(d,m,g){m.exports=j;var w=d("../errors").codes,I=w.ERR_METHOD_NOT_IMPLEMENTED,P=w.ERR_MULTIPLE_CALLBACK,F=w.ERR_TRANSFORM_ALREADY_TRANSFORMING,D=w.ERR_TRANSFORM_WITH_LENGTH_0,$=d("./_stream_duplex");function U(H,W){var Q=this._transformState;Q.transforming=!1;var q=Q.writecb;if(q===null)return this.emit("error",new P);Q.writechunk=null,Q.writecb=null,W!=null&&this.push(W),q(H);var rt=this._readableState;rt.reading=!1,(rt.needReadable||rt.length<rt.highWaterMark)&&this._read(rt.highWaterMark)}function j(H){if(!(this instanceof j))return new j(H);$.call(this,H),this._transformState={afterTransform:U.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,H&&(typeof H.transform=="function"&&(this._transform=H.transform),typeof H.flush=="function"&&(this._flush=H.flush)),this.on("prefinish",Z)}function Z(){var H=this;typeof this._flush!="function"||this._readableState.destroyed?G(this,null,null):this._flush((function(W,Q){G(H,W,Q)}))}function G(H,W,Q){if(W)return H.emit("error",W);if(Q!=null&&H.push(Q),H._writableState.length)throw new D;if(H._transformState.transforming)throw new F;return H.push(null)}d("inherits")(j,$),j.prototype.push=function(H,W){return this._transformState.needTransform=!1,$.prototype.push.call(this,H,W)},j.prototype._transform=function(H,W,Q){Q(new I("_transform()"))},j.prototype._write=function(H,W,Q){var q=this._transformState;if(q.writecb=Q,q.writechunk=H,q.writeencoding=W,!q.transforming){var rt=this._readableState;(q.needTransform||rt.needReadable||rt.length<rt.highWaterMark)&&this._read(rt.highWaterMark)}},j.prototype._read=function(H){var W=this._transformState;W.writechunk===null||W.transforming?W.needTransform=!0:(W.transforming=!0,this._transform(W.writechunk,W.writeencoding,W.afterTransform))},j.prototype._destroy=function(H,W){$.prototype._destroy.call(this,H,(function(Q){W(Q)}))}},{"../errors":66,"./_stream_duplex":67,inherits:46}],71:[function(d,m,g){(function(w,I){(function(){function P(Tt){var it=this;this.next=null,this.entry=null,this.finish=function(){jt(it,Tt)}}var F;m.exports=ut,ut.WritableState=V;var D={deprecate:d("util-deprecate")},$=d("./internal/streams/stream"),U=d("buffer").Buffer,j=I.Uint8Array||function(){};function Z(Tt){return U.from(Tt)}function G(Tt){return U.isBuffer(Tt)||Tt instanceof j}var H,W=d("./internal/streams/destroy"),Q=d("./internal/streams/state").getHighWaterMark,q=d("../errors").codes,rt=q.ERR_INVALID_ARG_TYPE,et=q.ERR_METHOD_NOT_IMPLEMENTED,X=q.ERR_MULTIPLE_CALLBACK,J=q.ERR_STREAM_CANNOT_PIPE,tt=q.ERR_STREAM_DESTROYED,st=q.ERR_STREAM_NULL_VALUES,nt=q.ERR_STREAM_WRITE_AFTER_END,lt=q.ERR_UNKNOWN_ENCODING,at=W.errorOrDestroy;function ct(){}function V(Tt,it,Mt){F=F||d("./_stream_duplex"),Tt=Tt||{},typeof Mt!="boolean"&&(Mt=it instanceof F),this.objectMode=!!Tt.objectMode,Mt&&(this.objectMode=this.objectMode||!!Tt.writableObjectMode),this.highWaterMark=Q(this,Tt,"writableHighWaterMark",Mt),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var mt=Tt.decodeStrings===!1;this.decodeStrings=!mt,this.defaultEncoding=Tt.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(gt){Ft(it,gt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Tt.emitClose!==!1,this.autoDestroy=!!Tt.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new P(this)}function ut(Tt){var it=this instanceof(F=F||d("./_stream_duplex"));if(!it&&!H.call(ut,this))return new ut(Tt);this._writableState=new V(Tt,this,it),this.writable=!0,Tt&&(typeof Tt.write=="function"&&(this._write=Tt.write),typeof Tt.writev=="function"&&(this._writev=Tt.writev),typeof Tt.destroy=="function"&&(this._destroy=Tt.destroy),typeof Tt.final=="function"&&(this._final=Tt.final)),$.call(this)}function wt(Tt,it){var Mt=new nt;at(Tt,Mt),w.nextTick(it,Mt)}function dt(Tt,it,Mt,mt){var gt;return Mt===null?gt=new st:typeof Mt=="string"||it.objectMode||(gt=new rt("chunk",["string","Buffer"],Mt)),!gt||(at(Tt,gt),w.nextTick(mt,gt),!1)}function ft(Tt,it,Mt){return Tt.objectMode||Tt.decodeStrings===!1||typeof it!="string"||(it=U.from(it,Mt)),it}function pt(Tt,it,Mt,mt,gt,_t){if(!Mt){var vt=ft(it,mt,gt);mt!==vt&&(Mt=!0,gt="buffer",mt=vt)}var Bt=it.objectMode?1:mt.length;it.length+=Bt;var K=it.length<it.highWaterMark;if(K||(it.needDrain=!0),it.writing||it.corked){var ot=it.lastBufferedRequest;it.lastBufferedRequest={chunk:mt,encoding:gt,isBuf:Mt,callback:_t,next:null},ot?ot.next=it.lastBufferedRequest:it.bufferedRequest=it.lastBufferedRequest,it.bufferedRequestCount+=1}else Pt(Tt,it,!1,Bt,mt,gt,_t);return K}function Pt(Tt,it,Mt,mt,gt,_t,vt){it.writelen=mt,it.writecb=vt,it.writing=!0,it.sync=!0,it.destroyed?it.onwrite(new tt("write")):Mt?Tt._writev(gt,it.onwrite):Tt._write(gt,_t,it.onwrite),it.sync=!1}function It(Tt,it,Mt,mt,gt){--it.pendingcb,Mt?(w.nextTick(gt,mt),w.nextTick(Nt,Tt,it),Tt._writableState.errorEmitted=!0,at(Tt,mt)):(gt(mt),Tt._writableState.errorEmitted=!0,at(Tt,mt),Nt(Tt,it))}function xt(Tt){Tt.writing=!1,Tt.writecb=null,Tt.length-=Tt.writelen,Tt.writelen=0}function Ft(Tt,it){var Mt=Tt._writableState,mt=Mt.sync,gt=Mt.writecb;if(typeof gt!="function")throw new X;if(xt(Mt),it)It(Tt,Mt,mt,it,gt);else{var _t=Rt(Mt)||Tt.destroyed;_t||Mt.corked||Mt.bufferProcessing||!Mt.bufferedRequest||Ot(Tt,Mt),mt?w.nextTick(Et,Tt,Mt,_t,gt):Et(Tt,Mt,_t,gt)}}function Et(Tt,it,Mt,mt){Mt||Ct(Tt,it),it.pendingcb--,mt(),Nt(Tt,it)}function Ct(Tt,it){it.length===0&&it.needDrain&&(it.needDrain=!1,Tt.emit("drain"))}function Ot(Tt,it){it.bufferProcessing=!0;var Mt=it.bufferedRequest;if(Tt._writev&&Mt&&Mt.next){var mt=it.bufferedRequestCount,gt=new Array(mt),_t=it.corkedRequestsFree;_t.entry=Mt;for(var vt=0,Bt=!0;Mt;)gt[vt]=Mt,Mt.isBuf||(Bt=!1),Mt=Mt.next,vt+=1;gt.allBuffers=Bt,Pt(Tt,it,!0,it.length,gt,"",_t.finish),it.pendingcb++,it.lastBufferedRequest=null,_t.next?(it.corkedRequestsFree=_t.next,_t.next=null):it.corkedRequestsFree=new P(it),it.bufferedRequestCount=0}else{for(;Mt;){var K=Mt.chunk,ot=Mt.encoding,bt=Mt.callback;if(Pt(Tt,it,!1,it.objectMode?1:K.length,K,ot,bt),Mt=Mt.next,it.bufferedRequestCount--,it.writing)break}Mt===null&&(it.lastBufferedRequest=null)}it.bufferedRequest=Mt,it.bufferProcessing=!1}function Rt(Tt){return Tt.ending&&Tt.length===0&&Tt.bufferedRequest===null&&!Tt.finished&&!Tt.writing}function St(Tt,it){Tt._final((function(Mt){it.pendingcb--,Mt&&at(Tt,Mt),it.prefinished=!0,Tt.emit("prefinish"),Nt(Tt,it)}))}function At(Tt,it){it.prefinished||it.finalCalled||(typeof Tt._final!="function"||it.destroyed?(it.prefinished=!0,Tt.emit("prefinish")):(it.pendingcb++,it.finalCalled=!0,w.nextTick(St,Tt,it)))}function Nt(Tt,it){var Mt=Rt(it);if(Mt&&(At(Tt,it),it.pendingcb===0&&(it.finished=!0,Tt.emit("finish"),it.autoDestroy))){var mt=Tt._readableState;(!mt||mt.autoDestroy&&mt.endEmitted)&&Tt.destroy()}return Mt}function Ut(Tt,it,Mt){it.ending=!0,Nt(Tt,it),Mt&&(it.finished?w.nextTick(Mt):Tt.once("finish",Mt)),it.ended=!0,Tt.writable=!1}function jt(Tt,it,Mt){var mt=Tt.entry;for(Tt.entry=null;mt;){var gt=mt.callback;it.pendingcb--,gt(Mt),mt=mt.next}it.corkedRequestsFree.next=Tt}d("inherits")(ut,$),V.prototype.getBuffer=function(){for(var Tt=this.bufferedRequest,it=[];Tt;)it.push(Tt),Tt=Tt.next;return it},(function(){try{Object.defineProperty(V.prototype,"buffer",{get:D.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(H=Function.prototype[Symbol.hasInstance],Object.defineProperty(ut,Symbol.hasInstance,{value:function(Tt){return!!H.call(this,Tt)||this===ut&&Tt&&Tt._writableState instanceof V}})):H=function(Tt){return Tt instanceof this},ut.prototype.pipe=function(){at(this,new J)},ut.prototype.write=function(Tt,it,Mt){var mt=this._writableState,gt=!1,_t=!mt.objectMode&&G(Tt);return _t&&!U.isBuffer(Tt)&&(Tt=Z(Tt)),typeof it=="function"&&(Mt=it,it=null),_t?it="buffer":it||(it=mt.defaultEncoding),typeof Mt!="function"&&(Mt=ct),mt.ending?wt(this,Mt):(_t||dt(this,mt,Tt,Mt))&&(mt.pendingcb++,gt=pt(this,mt,_t,Tt,it,Mt)),gt},ut.prototype.cork=function(){this._writableState.corked++},ut.prototype.uncork=function(){var Tt=this._writableState;Tt.corked&&(Tt.corked--,Tt.writing||Tt.corked||Tt.bufferProcessing||!Tt.bufferedRequest||Ot(this,Tt))},ut.prototype.setDefaultEncoding=function(Tt){if(typeof Tt=="string"&&(Tt=Tt.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Tt+"").toLowerCase())>-1))throw new lt(Tt);return this._writableState.defaultEncoding=Tt,this},Object.defineProperty(ut.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ut.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),ut.prototype._write=function(Tt,it,Mt){Mt(new et("_write()"))},ut.prototype._writev=null,ut.prototype.end=function(Tt,it,Mt){var mt=this._writableState;return typeof Tt=="function"?(Mt=Tt,Tt=null,it=null):typeof it=="function"&&(Mt=it,it=null),Tt!=null&&this.write(Tt,it),mt.corked&&(mt.corked=1,this.uncork()),mt.ending||Ut(this,mt,Mt),this},Object.defineProperty(ut.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ut.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(Tt){this._writableState&&(this._writableState.destroyed=Tt)}}),ut.prototype.destroy=W.destroy,ut.prototype._undestroy=W.undestroy,ut.prototype._destroy=function(Tt,it){it(Tt)}}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/destroy":74,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,inherits:46,"util-deprecate":81}],72:[function(d,m,g){(function(w){(function(){var I;function P(tt,st,nt){return st in tt?Object.defineProperty(tt,st,{value:nt,enumerable:!0,configurable:!0,writable:!0}):tt[st]=nt,tt}var F=d("./end-of-stream"),D=Symbol("lastResolve"),$=Symbol("lastReject"),U=Symbol("error"),j=Symbol("ended"),Z=Symbol("lastPromise"),G=Symbol("handlePromise"),H=Symbol("stream");function W(tt,st){return{value:tt,done:st}}function Q(tt){var st=tt[D];if(st!==null){var nt=tt[H].read();nt!==null&&(tt[Z]=null,tt[D]=null,tt[$]=null,st(W(nt,!1)))}}function q(tt){w.nextTick(Q,tt)}function rt(tt,st){return function(nt,lt){tt.then((function(){st[j]?nt(W(void 0,!0)):st[G](nt,lt)}),lt)}}var et=Object.getPrototypeOf((function(){})),X=Object.setPrototypeOf((I={get stream(){return this[H]},next:function(){var tt=this,st=this[U];if(st!==null)return Promise.reject(st);if(this[j])return Promise.resolve(W(void 0,!0));if(this[H].destroyed)return new Promise((function(ct,V){w.nextTick((function(){tt[U]?V(tt[U]):ct(W(void 0,!0))}))}));var nt,lt=this[Z];if(lt)nt=new Promise(rt(lt,this));else{var at=this[H].read();if(at!==null)return Promise.resolve(W(at,!1));nt=new Promise(this[G])}return this[Z]=nt,nt}},P(I,Symbol.asyncIterator,(function(){return this})),P(I,"return",(function(){var tt=this;return new Promise((function(st,nt){tt[H].destroy(null,(function(lt){lt?nt(lt):st(W(void 0,!0))}))}))})),I),et),J=function(tt){var st,nt=Object.create(X,(P(st={},H,{value:tt,writable:!0}),P(st,D,{value:null,writable:!0}),P(st,$,{value:null,writable:!0}),P(st,U,{value:null,writable:!0}),P(st,j,{value:tt._readableState.endEmitted,writable:!0}),P(st,G,{value:function(lt,at){var ct=nt[H].read();ct?(nt[Z]=null,nt[D]=null,nt[$]=null,lt(W(ct,!1))):(nt[D]=lt,nt[$]=at)},writable:!0}),st));return nt[Z]=null,F(tt,(function(lt){if(lt&&lt.code!=="ERR_STREAM_PREMATURE_CLOSE"){var at=nt[$];return at!==null&&(nt[Z]=null,nt[D]=null,nt[$]=null,at(lt)),void(nt[U]=lt)}var ct=nt[D];ct!==null&&(nt[Z]=null,nt[D]=null,nt[$]=null,ct(W(void 0,!0))),nt[j]=!0})),tt.on("readable",q.bind(null,nt)),nt};m.exports=J}).call(this)}).call(this,d("_process"))},{"./end-of-stream":75,_process:63}],73:[function(d,m,g){function w(H,W){var Q=Object.keys(H);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(H);W&&(q=q.filter((function(rt){return Object.getOwnPropertyDescriptor(H,rt).enumerable}))),Q.push.apply(Q,q)}return Q}function I(H){for(var W=1;W<arguments.length;W++){var Q=arguments[W]!=null?arguments[W]:{};W%2?w(Object(Q),!0).forEach((function(q){P(H,q,Q[q])})):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(Q)):w(Object(Q)).forEach((function(q){Object.defineProperty(H,q,Object.getOwnPropertyDescriptor(Q,q))}))}return H}function P(H,W,Q){return W in H?Object.defineProperty(H,W,{value:Q,enumerable:!0,configurable:!0,writable:!0}):H[W]=Q,H}function F(H,W){if(!(H instanceof W))throw new TypeError("Cannot call a class as a function")}function D(H,W){for(var Q=0;Q<W.length;Q++){var q=W[Q];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(H,q.key,q)}}function $(H,W,Q){return W&&D(H.prototype,W),H}var U=d("buffer").Buffer,j=d("util").inspect,Z=j&&j.custom||"inspect";function G(H,W,Q){U.prototype.copy.call(H,W,Q)}m.exports=(function(){function H(){F(this,H),this.head=null,this.tail=null,this.length=0}return $(H,[{key:"push",value:function(W){var Q={data:W,next:null};this.length>0?this.tail.next=Q:this.head=Q,this.tail=Q,++this.length}},{key:"unshift",value:function(W){var Q={data:W,next:this.head};this.length===0&&(this.tail=Q),this.head=Q,++this.length}},{key:"shift",value:function(){if(this.length!==0){var W=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,W}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(W){if(this.length===0)return"";for(var Q=this.head,q=""+Q.data;Q=Q.next;)q+=W+Q.data;return q}},{key:"concat",value:function(W){if(this.length===0)return U.alloc(0);for(var Q=U.allocUnsafe(W>>>0),q=this.head,rt=0;q;)G(q.data,Q,rt),rt+=q.data.length,q=q.next;return Q}},{key:"consume",value:function(W,Q){var q;return W<this.head.data.length?(q=this.head.data.slice(0,W),this.head.data=this.head.data.slice(W)):q=W===this.head.data.length?this.shift():Q?this._getString(W):this._getBuffer(W),q}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(W){var Q=this.head,q=1,rt=Q.data;for(W-=rt.length;Q=Q.next;){var et=Q.data,X=W>et.length?et.length:W;if(X===et.length?rt+=et:rt+=et.slice(0,W),(W-=X)==0){X===et.length?(++q,Q.next?this.head=Q.next:this.head=this.tail=null):(this.head=Q,Q.data=et.slice(X));break}++q}return this.length-=q,rt}},{key:"_getBuffer",value:function(W){var Q=U.allocUnsafe(W),q=this.head,rt=1;for(q.data.copy(Q),W-=q.data.length;q=q.next;){var et=q.data,X=W>et.length?et.length:W;if(et.copy(Q,Q.length-W,0,X),(W-=X)==0){X===et.length?(++rt,q.next?this.head=q.next:this.head=this.tail=null):(this.head=q,q.data=et.slice(X));break}++rt}return this.length-=rt,Q}},{key:Z,value:function(W,Q){return j(this,I({},Q,{depth:0,customInspect:!1}))}}]),H})()},{buffer:32,util:29}],74:[function(d,m,g){(function(w){(function(){function I(j,Z){var G=this,H=this._readableState&&this._readableState.destroyed,W=this._writableState&&this._writableState.destroyed;return H||W?(Z?Z(j):j&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,w.nextTick($,this,j)):w.nextTick($,this,j)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(j||null,(function(Q){!Z&&Q?G._writableState?G._writableState.errorEmitted?w.nextTick(F,G):(G._writableState.errorEmitted=!0,w.nextTick(P,G,Q)):w.nextTick(P,G,Q):Z?(w.nextTick(F,G),Z(Q)):w.nextTick(F,G)})),this)}function P(j,Z){$(j,Z),F(j)}function F(j){j._writableState&&!j._writableState.emitClose||j._readableState&&!j._readableState.emitClose||j.emit("close")}function D(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function $(j,Z){j.emit("error",Z)}function U(j,Z){var G=j._readableState,H=j._writableState;G&&G.autoDestroy||H&&H.autoDestroy?j.destroy(Z):j.emit("error",Z)}m.exports={destroy:I,undestroy:D,errorOrDestroy:U}}).call(this)}).call(this,d("_process"))},{_process:63}],75:[function(d,m,g){var w=d("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function I($){var U=!1;return function(){if(!U){U=!0;for(var j=arguments.length,Z=new Array(j),G=0;G<j;G++)Z[G]=arguments[G];$.apply(this,Z)}}}function P(){}function F($){return $.setHeader&&typeof $.abort=="function"}function D($,U,j){if(typeof U=="function")return D($,null,U);U||(U={}),j=I(j||P);var Z=U.readable||U.readable!==!1&&$.readable,G=U.writable||U.writable!==!1&&$.writable,H=function(){$.writable||Q()},W=$._writableState&&$._writableState.finished,Q=function(){G=!1,W=!0,Z||j.call($)},q=$._readableState&&$._readableState.endEmitted,rt=function(){Z=!1,q=!0,G||j.call($)},et=function(tt){j.call($,tt)},X=function(){var tt;return Z&&!q?($._readableState&&$._readableState.ended||(tt=new w),j.call($,tt)):G&&!W?($._writableState&&$._writableState.ended||(tt=new w),j.call($,tt)):void 0},J=function(){$.req.on("finish",Q)};return F($)?($.on("complete",Q),$.on("abort",X),$.req?J():$.on("request",J)):G&&!$._writableState&&($.on("end",H),$.on("close",H)),$.on("end",rt),$.on("finish",Q),U.error!==!1&&$.on("error",et),$.on("close",X),function(){$.removeListener("complete",Q),$.removeListener("abort",X),$.removeListener("request",J),$.req&&$.req.removeListener("finish",Q),$.removeListener("end",H),$.removeListener("close",H),$.removeListener("finish",Q),$.removeListener("end",rt),$.removeListener("error",et),$.removeListener("close",X)}}m.exports=D},{"../../../errors":66}],76:[function(d,m,g){m.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],77:[function(d,m,g){var w;function I(Q){var q=!1;return function(){q||(q=!0,Q.apply(void 0,arguments))}}var P=d("../../../errors").codes,F=P.ERR_MISSING_ARGS,D=P.ERR_STREAM_DESTROYED;function $(Q){if(Q)throw Q}function U(Q){return Q.setHeader&&typeof Q.abort=="function"}function j(Q,q,rt,et){et=I(et);var X=!1;Q.on("close",(function(){X=!0})),w===void 0&&(w=d("./end-of-stream")),w(Q,{readable:q,writable:rt},(function(tt){if(tt)return et(tt);X=!0,et()}));var J=!1;return function(tt){if(!X&&!J)return J=!0,U(Q)?Q.abort():typeof Q.destroy=="function"?Q.destroy():void et(tt||new D("pipe"))}}function Z(Q){Q()}function G(Q,q){return Q.pipe(q)}function H(Q){return Q.length?typeof Q[Q.length-1]!="function"?$:Q.pop():$}function W(){for(var Q=arguments.length,q=new Array(Q),rt=0;rt<Q;rt++)q[rt]=arguments[rt];var et,X=H(q);if(Array.isArray(q[0])&&(q=q[0]),q.length<2)throw new F("streams");var J=q.map((function(tt,st){var nt=st<q.length-1;return j(tt,nt,st>0,(function(lt){et||(et=lt),lt&&J.forEach(Z),nt||(J.forEach(Z),X(et))}))}));return q.reduce(G)}m.exports=W},{"../../../errors":66,"./end-of-stream":75}],78:[function(d,m,g){var w=d("../../../errors").codes.ERR_INVALID_OPT_VALUE;function I(F,D,$){return F.highWaterMark!=null?F.highWaterMark:D?F[$]:null}function P(F,D,$,U){var j=I(D,U,$);if(j!=null){if(!isFinite(j)||Math.floor(j)!==j||j<0)throw new w(U?$:"highWaterMark",j);return Math.floor(j)}return F.objectMode?16:16384}m.exports={getHighWaterMark:P}},{"../../../errors":66}],79:[function(d,m,g){m.exports=d("events").EventEmitter},{events:35}],80:[function(d,m,g){var w=d("safe-buffer").Buffer,I=w.isEncoding||function(J){switch((J=""+J)&&J.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function P(J){if(!J)return"utf8";for(var tt;;)switch(J){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return J;default:if(tt)return;J=(""+J).toLowerCase(),tt=!0}}function F(J){var tt=P(J);if(typeof tt!="string"&&(w.isEncoding===I||!I(J)))throw new Error("Unknown encoding: "+J);return tt||J}function D(J){var tt;switch(this.encoding=F(J),this.encoding){case"utf16le":this.text=W,this.end=Q,tt=4;break;case"utf8":this.fillLast=Z,tt=4;break;case"base64":this.text=q,this.end=rt,tt=3;break;default:return this.write=et,void(this.end=X)}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(tt)}function $(J){return J<=127?0:J>>5==6?2:J>>4==14?3:J>>3==30?4:J>>6==2?-1:-2}function U(J,tt,st){var nt=tt.length-1;if(nt<st)return 0;var lt=$(tt[nt]);return lt>=0?(lt>0&&(J.lastNeed=lt-1),lt):--nt<st||lt===-2?0:(lt=$(tt[nt]))>=0?(lt>0&&(J.lastNeed=lt-2),lt):--nt<st||lt===-2?0:(lt=$(tt[nt]))>=0?(lt>0&&(lt===2?lt=0:J.lastNeed=lt-3),lt):0}function j(J,tt,st){if((192&tt[0])!=128)return J.lastNeed=0,"";if(J.lastNeed>1&&tt.length>1){if((192&tt[1])!=128)return J.lastNeed=1,"";if(J.lastNeed>2&&tt.length>2&&(192&tt[2])!=128)return J.lastNeed=2,""}}function Z(J){var tt=this.lastTotal-this.lastNeed,st=j(this,J);return st!==void 0?st:this.lastNeed<=J.length?(J.copy(this.lastChar,tt,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(J.copy(this.lastChar,tt,0,J.length),void(this.lastNeed-=J.length))}function G(J,tt){var st=U(this,J,tt);if(!this.lastNeed)return J.toString("utf8",tt);this.lastTotal=st;var nt=J.length-(st-this.lastNeed);return J.copy(this.lastChar,0,nt),J.toString("utf8",tt,nt)}function H(J){var tt=J&&J.length?this.write(J):"";return this.lastNeed?tt+"":tt}function W(J,tt){if((J.length-tt)%2==0){var st=J.toString("utf16le",tt);if(st){var nt=st.charCodeAt(st.length-1);if(nt>=55296&&nt<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=J[J.length-2],this.lastChar[1]=J[J.length-1],st.slice(0,-1)}return st}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=J[J.length-1],J.toString("utf16le",tt,J.length-1)}function Q(J){var tt=J&&J.length?this.write(J):"";if(this.lastNeed){var st=this.lastTotal-this.lastNeed;return tt+this.lastChar.toString("utf16le",0,st)}return tt}function q(J,tt){var st=(J.length-tt)%3;return st===0?J.toString("base64",tt):(this.lastNeed=3-st,this.lastTotal=3,st===1?this.lastChar[0]=J[J.length-1]:(this.lastChar[0]=J[J.length-2],this.lastChar[1]=J[J.length-1]),J.toString("base64",tt,J.length-st))}function rt(J){var tt=J&&J.length?this.write(J):"";return this.lastNeed?tt+this.lastChar.toString("base64",0,3-this.lastNeed):tt}function et(J){return J.toString(this.encoding)}function X(J){return J&&J.length?this.write(J):""}g.StringDecoder=D,D.prototype.write=function(J){if(J.length===0)return"";var tt,st;if(this.lastNeed){if((tt=this.fillLast(J))===void 0)return"";st=this.lastNeed,this.lastNeed=0}else st=0;return st<J.length?tt?tt+this.text(J,st):this.text(J,st):tt||""},D.prototype.end=H,D.prototype.text=G,D.prototype.fillLast=function(J){if(this.lastNeed<=J.length)return J.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);J.copy(this.lastChar,this.lastTotal-this.lastNeed,0,J.length),this.lastNeed-=J.length}},{"safe-buffer":64}],81:[function(d,m,g){(function(w){(function(){function I(F,D){if(P("noDeprecation"))return F;var $=!1;function U(){if(!$){if(P("throwDeprecation"))throw new Error(D);P("traceDeprecation")?console.trace(D):console.warn(D),$=!0}return F.apply(this,arguments)}return U}function P(F){try{if(!w.localStorage)return!1}catch{return!1}var D=w.localStorage[F];return D!=null&&String(D).toLowerCase()==="true"}m.exports=I}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],82:[function(d,m,g){arguments[4][25][0].apply(g,arguments)},{dup:25}],83:[function(d,m,g){var w=d("is-arguments"),I=d("is-generator-function"),P=d("which-typed-array"),F=d("is-typed-array");function D(yt){return yt.call.bind(yt)}var $=typeof BigInt<"u",U=typeof Symbol<"u",j=D(Object.prototype.toString),Z=D(Number.prototype.valueOf),G=D(String.prototype.valueOf),H=D(Boolean.prototype.valueOf);if($)var W=D(BigInt.prototype.valueOf);if(U)var Q=D(Symbol.prototype.valueOf);function q(yt,$t){if(typeof yt!="object")return!1;try{return $t(yt),!0}catch{return!1}}function rt(yt){return typeof Promise<"u"&&yt instanceof Promise||yt!==null&&typeof yt=="object"&&typeof yt.then=="function"&&typeof yt.catch=="function"}function et(yt){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(yt):F(yt)||St(yt)}function X(yt){return P(yt)==="Uint8Array"}function J(yt){return P(yt)==="Uint8ClampedArray"}function tt(yt){return P(yt)==="Uint16Array"}function st(yt){return P(yt)==="Uint32Array"}function nt(yt){return P(yt)==="Int8Array"}function lt(yt){return P(yt)==="Int16Array"}function at(yt){return P(yt)==="Int32Array"}function ct(yt){return P(yt)==="Float32Array"}function V(yt){return P(yt)==="Float64Array"}function ut(yt){return P(yt)==="BigInt64Array"}function wt(yt){return P(yt)==="BigUint64Array"}function dt(yt){return j(yt)==="[object Map]"}function ft(yt){return typeof Map<"u"&&(dt.working?dt(yt):yt instanceof Map)}function pt(yt){return j(yt)==="[object Set]"}function Pt(yt){return typeof Set<"u"&&(pt.working?pt(yt):yt instanceof Set)}function It(yt){return j(yt)==="[object WeakMap]"}function xt(yt){return typeof WeakMap<"u"&&(It.working?It(yt):yt instanceof WeakMap)}function Ft(yt){return j(yt)==="[object WeakSet]"}function Et(yt){return Ft(yt)}function Ct(yt){return j(yt)==="[object ArrayBuffer]"}function Ot(yt){return typeof ArrayBuffer<"u"&&(Ct.working?Ct(yt):yt instanceof ArrayBuffer)}function Rt(yt){return j(yt)==="[object DataView]"}function St(yt){return typeof DataView<"u"&&(Rt.working?Rt(yt):yt instanceof DataView)}g.isArgumentsObject=w,g.isGeneratorFunction=I,g.isTypedArray=F,g.isPromise=rt,g.isArrayBufferView=et,g.isUint8Array=X,g.isUint8ClampedArray=J,g.isUint16Array=tt,g.isUint32Array=st,g.isInt8Array=nt,g.isInt16Array=lt,g.isInt32Array=at,g.isFloat32Array=ct,g.isFloat64Array=V,g.isBigInt64Array=ut,g.isBigUint64Array=wt,dt.working=typeof Map<"u"&&dt(new Map),g.isMap=ft,pt.working=typeof Set<"u"&&pt(new Set),g.isSet=Pt,It.working=typeof WeakMap<"u"&&It(new WeakMap),g.isWeakMap=xt,Ft.working=typeof WeakSet<"u"&&Ft(new WeakSet),g.isWeakSet=Et,Ct.working=typeof ArrayBuffer<"u"&&Ct(new ArrayBuffer),g.isArrayBuffer=Ot,Rt.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Rt(new DataView(new ArrayBuffer(1),0,1)),g.isDataView=St;var At=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Nt(yt){return j(yt)==="[object SharedArrayBuffer]"}function Ut(yt){return At!==void 0&&(Nt.working===void 0&&(Nt.working=Nt(new At)),Nt.working?Nt(yt):yt instanceof At)}function jt(yt){return j(yt)==="[object AsyncFunction]"}function Tt(yt){return j(yt)==="[object Map Iterator]"}function it(yt){return j(yt)==="[object Set Iterator]"}function Mt(yt){return j(yt)==="[object Generator]"}function mt(yt){return j(yt)==="[object WebAssembly.Module]"}function gt(yt){return q(yt,Z)}function _t(yt){return q(yt,G)}function vt(yt){return q(yt,H)}function Bt(yt){return $&&q(yt,W)}function K(yt){return U&&q(yt,Q)}function ot(yt){return gt(yt)||_t(yt)||vt(yt)||Bt(yt)||K(yt)}function bt(yt){return typeof Uint8Array<"u"&&(Ot(yt)||Ut(yt))}g.isSharedArrayBuffer=Ut,g.isAsyncFunction=jt,g.isMapIterator=Tt,g.isSetIterator=it,g.isGeneratorObject=Mt,g.isWebAssemblyCompiledModule=mt,g.isNumberObject=gt,g.isStringObject=_t,g.isBooleanObject=vt,g.isBigIntObject=Bt,g.isSymbolObject=K,g.isBoxedPrimitive=ot,g.isAnyArrayBuffer=bt,["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(yt){Object.defineProperty(g,yt,{enumerable:!1,value:function(){throw new Error(yt+" is not supported in userland")}})}))},{"is-arguments":47,"is-generator-function":49,"is-typed-array":50,"which-typed-array":85}],84:[function(d,m,g){(function(w){(function(){var I=Object.getOwnPropertyDescriptors||function(St){for(var At=Object.keys(St),Nt={},Ut=0;Ut<At.length;Ut++)Nt[At[Ut]]=Object.getOwnPropertyDescriptor(St,At[Ut]);return Nt},P=/%[sdj%]/g;g.format=function(St){if(!lt(St)){for(var At=[],Nt=0;Nt<arguments.length;Nt++)At.push(U(arguments[Nt]));return At.join(" ")}Nt=1;for(var Ut=arguments,jt=Ut.length,Tt=String(St).replace(P,(function(Mt){if(Mt==="%%")return"%";if(Nt>=jt)return Mt;switch(Mt){case"%s":return String(Ut[Nt++]);case"%d":return Number(Ut[Nt++]);case"%j":try{return JSON.stringify(Ut[Nt++])}catch{return"[Circular]"}default:return Mt}})),it=Ut[Nt];Nt<jt;it=Ut[++Nt])tt(it)||!ut(it)?Tt+=" "+it:Tt+=" "+U(it);return Tt},g.deprecate=function(St,At){if(w!==void 0&&w.noDeprecation===!0)return St;if(w===void 0)return function(){return g.deprecate(St,At).apply(this,arguments)};var Nt=!1;function Ut(){if(!Nt){if(w.throwDeprecation)throw new Error(At);w.traceDeprecation?console.trace(At):console.error(At),Nt=!0}return St.apply(this,arguments)}return Ut};var F={},D=/^$/;if(w.env.NODE_DEBUG){var $=w.env.NODE_DEBUG;$=$.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),D=new RegExp("^"+$+"$","i")}function U(St,At){var Nt={seen:[],stylize:Z};return arguments.length>=3&&(Nt.depth=arguments[2]),arguments.length>=4&&(Nt.colors=arguments[3]),J(At)?Nt.showHidden=At:At&&g._extend(Nt,At),ct(Nt.showHidden)&&(Nt.showHidden=!1),ct(Nt.depth)&&(Nt.depth=2),ct(Nt.colors)&&(Nt.colors=!1),ct(Nt.customInspect)&&(Nt.customInspect=!0),Nt.colors&&(Nt.stylize=j),H(Nt,St,Nt.depth)}function j(St,At){var Nt=U.styles[At];return Nt?"\x1B["+U.colors[Nt][0]+"m"+St+"\x1B["+U.colors[Nt][1]+"m":St}function Z(St,At){return St}function G(St){var At={};return St.forEach((function(Nt,Ut){At[Nt]=!0})),At}function H(St,At,Nt){if(St.customInspect&&At&&ft(At.inspect)&&At.inspect!==g.inspect&&(!At.constructor||At.constructor.prototype!==At)){var Ut=At.inspect(Nt,St);return lt(Ut)||(Ut=H(St,Ut,Nt)),Ut}var jt=W(St,At);if(jt)return jt;var Tt=Object.keys(At),it=G(Tt);if(St.showHidden&&(Tt=Object.getOwnPropertyNames(At)),dt(At)&&(Tt.indexOf("message")>=0||Tt.indexOf("description")>=0))return Q(At);if(Tt.length===0){if(ft(At)){var Mt=At.name?": "+At.name:"";return St.stylize("[Function"+Mt+"]","special")}if(V(At))return St.stylize(RegExp.prototype.toString.call(At),"regexp");if(wt(At))return St.stylize(Date.prototype.toString.call(At),"date");if(dt(At))return Q(At)}var mt,gt="",_t=!1,vt=["{","}"];return X(At)&&(_t=!0,vt=["[","]"]),ft(At)&&(gt=" [Function"+(At.name?": "+At.name:"")+"]"),V(At)&&(gt=" "+RegExp.prototype.toString.call(At)),wt(At)&&(gt=" "+Date.prototype.toUTCString.call(At)),dt(At)&&(gt=" "+Q(At)),Tt.length!==0||_t&&At.length!=0?Nt<0?V(At)?St.stylize(RegExp.prototype.toString.call(At),"regexp"):St.stylize("[Object]","special"):(St.seen.push(At),mt=_t?q(St,At,Nt,it,Tt):Tt.map((function(Bt){return rt(St,At,Nt,it,Bt,_t)})),St.seen.pop(),et(mt,gt,vt)):vt[0]+gt+vt[1]}function W(St,At){if(ct(At))return St.stylize("undefined","undefined");if(lt(At)){var Nt="'"+JSON.stringify(At).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return St.stylize(Nt,"string")}return nt(At)?St.stylize(""+At,"number"):J(At)?St.stylize(""+At,"boolean"):tt(At)?St.stylize("null","null"):void 0}function Q(St){return"["+Error.prototype.toString.call(St)+"]"}function q(St,At,Nt,Ut,jt){for(var Tt=[],it=0,Mt=At.length;it<Mt;++it)Et(At,String(it))?Tt.push(rt(St,At,Nt,Ut,String(it),!0)):Tt.push("");return jt.forEach((function(mt){mt.match(/^\d+$/)||Tt.push(rt(St,At,Nt,Ut,mt,!0))})),Tt}function rt(St,At,Nt,Ut,jt,Tt){var it,Mt,mt;if((mt=Object.getOwnPropertyDescriptor(At,jt)||{value:At[jt]}).get?Mt=mt.set?St.stylize("[Getter/Setter]","special"):St.stylize("[Getter]","special"):mt.set&&(Mt=St.stylize("[Setter]","special")),Et(Ut,jt)||(it="["+jt+"]"),Mt||(St.seen.indexOf(mt.value)<0?(Mt=tt(Nt)?H(St,mt.value,null):H(St,mt.value,Nt-1)).indexOf(`
`)>-1&&(Mt=Tt?Mt.split(`
`).map((function(gt){return"  "+gt})).join(`
`).slice(2):`
`+Mt.split(`
`).map((function(gt){return"   "+gt})).join(`
`)):Mt=St.stylize("[Circular]","special")),ct(it)){if(Tt&&jt.match(/^\d+$/))return Mt;(it=JSON.stringify(""+jt)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(it=it.slice(1,-1),it=St.stylize(it,"name")):(it=it.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),it=St.stylize(it,"string"))}return it+": "+Mt}function et(St,At,Nt){return St.reduce((function(Ut,jt){return jt.indexOf(`
`),Ut+jt.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?Nt[0]+(At===""?"":At+`
 `)+" "+St.join(`,
  `)+" "+Nt[1]:Nt[0]+At+" "+St.join(", ")+" "+Nt[1]}function X(St){return Array.isArray(St)}function J(St){return typeof St=="boolean"}function tt(St){return St===null}function st(St){return St==null}function nt(St){return typeof St=="number"}function lt(St){return typeof St=="string"}function at(St){return typeof St=="symbol"}function ct(St){return St===void 0}function V(St){return ut(St)&&Pt(St)==="[object RegExp]"}function ut(St){return typeof St=="object"&&St!==null}function wt(St){return ut(St)&&Pt(St)==="[object Date]"}function dt(St){return ut(St)&&(Pt(St)==="[object Error]"||St instanceof Error)}function ft(St){return typeof St=="function"}function pt(St){return St===null||typeof St=="boolean"||typeof St=="number"||typeof St=="string"||typeof St=="symbol"||St===void 0}function Pt(St){return Object.prototype.toString.call(St)}function It(St){return St<10?"0"+St.toString(10):St.toString(10)}g.debuglog=function(St){if(St=St.toUpperCase(),!F[St])if(D.test(St)){var At=w.pid;F[St]=function(){var Nt=g.format.apply(g,arguments);console.error("%s %d: %s",St,At,Nt)}}else F[St]=function(){};return F[St]},g.inspect=U,U.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},U.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},g.types=d("./support/types"),g.isArray=X,g.isBoolean=J,g.isNull=tt,g.isNullOrUndefined=st,g.isNumber=nt,g.isString=lt,g.isSymbol=at,g.isUndefined=ct,g.isRegExp=V,g.types.isRegExp=V,g.isObject=ut,g.isDate=wt,g.types.isDate=wt,g.isError=dt,g.types.isNativeError=dt,g.isFunction=ft,g.isPrimitive=pt,g.isBuffer=d("./support/isBuffer");var xt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ft(){var St=new Date,At=[It(St.getHours()),It(St.getMinutes()),It(St.getSeconds())].join(":");return[St.getDate(),xt[St.getMonth()],At].join(" ")}function Et(St,At){return Object.prototype.hasOwnProperty.call(St,At)}g.log=function(){console.log("%s - %s",Ft(),g.format.apply(g,arguments))},g.inherits=d("inherits"),g._extend=function(St,At){if(!At||!ut(At))return St;for(var Nt=Object.keys(At),Ut=Nt.length;Ut--;)St[Nt[Ut]]=At[Nt[Ut]];return St};var Ct=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function Ot(St,At){if(!St){var Nt=new Error("Promise was rejected with a falsy value");Nt.reason=St,St=Nt}return At(St)}function Rt(St){if(typeof St!="function")throw new TypeError('The "original" argument must be of type Function');function At(){for(var Nt=[],Ut=0;Ut<arguments.length;Ut++)Nt.push(arguments[Ut]);var jt=Nt.pop();if(typeof jt!="function")throw new TypeError("The last argument must be of type Function");var Tt=this,it=function(){return jt.apply(Tt,arguments)};St.apply(this,Nt).then((function(Mt){w.nextTick(it.bind(null,null,Mt))}),(function(Mt){w.nextTick(Ot.bind(null,Mt,it))}))}return Object.setPrototypeOf(At,Object.getPrototypeOf(St)),Object.defineProperties(At,I(St)),At}g.promisify=function(St){if(typeof St!="function")throw new TypeError('The "original" argument must be of type Function');if(Ct&&St[Ct]){var At;if(typeof(At=St[Ct])!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(At,Ct,{value:At,enumerable:!1,writable:!1,configurable:!0}),At}function At(){for(var Nt,Ut,jt=new Promise((function(Mt,mt){Nt=Mt,Ut=mt})),Tt=[],it=0;it<arguments.length;it++)Tt.push(arguments[it]);Tt.push((function(Mt,mt){Mt?Ut(Mt):Nt(mt)}));try{St.apply(this,Tt)}catch(Mt){Ut(Mt)}return jt}return Object.setPrototypeOf(At,Object.getPrototypeOf(St)),Ct&&Object.defineProperty(At,Ct,{value:At,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(At,I(St))},g.promisify.custom=Ct,g.callbackify=Rt}).call(this)}).call(this,d("_process"))},{"./support/isBuffer":82,"./support/types":83,_process:63,inherits:46}],85:[function(d,m,g){(function(w){(function(){var I=d("for-each"),P=d("available-typed-arrays"),F=d("call-bind/callBound"),D=d("gopd"),$=F("Object.prototype.toString"),U=d("has-tostringtag/shams")(),j=typeof globalThis>"u"?w:globalThis,Z=P(),G=F("String.prototype.slice"),H={},W=Object.getPrototypeOf;U&&D&&W&&I(Z,(function(rt){if(typeof j[rt]=="function"){var et=new j[rt];if(Symbol.toStringTag in et){var X=W(et),J=D(X,Symbol.toStringTag);if(!J){var tt=W(X);J=D(tt,Symbol.toStringTag)}H[rt]=J.get}}}));var Q=function(rt){var et=!1;return I(H,(function(X,J){if(!et)try{var tt=X.call(rt);tt===J&&(et=tt)}catch{}})),et},q=d("is-typed-array");m.exports=function(rt){return!!q(rt)&&(U&&Symbol.toStringTag in rt?Q(rt):G($(rt),8,-1))}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43,"is-typed-array":50}]},{},[20])(20);var browserExports=browser$1.exports,PNGFilterType,PNGFilterType2,PNGColorType,PNGColorType2;function png(){return{mime:"image/png",hasAlpha:!0,encode:(d,{deflateLevel:m=9,deflateStrategy:g=3,filterType:w=PNGFilterType.AUTO,colorType:I,inputHasAlpha:P=!0,...F}={})=>{const D=new browserExports.PNG({width:d.width,height:d.height});return D.data=d.data,browserExports.PNG.sync.write(D,{...F,deflateLevel:m,deflateStrategy:g,filterType:w,colorType:I!==void 0?I:P?PNGColorType.COLOR_ALPHA:PNGColorType.COLOR,inputHasAlpha:P})},decode:(d,m)=>{const g=browserExports.PNG.sync.read(d,m);return{data:g.data,width:g.width,height:g.height}}}}PNGFilterType2=PNGFilterType||(PNGFilterType={}),PNGFilterType2[PNGFilterType2.AUTO=-1]="AUTO",PNGFilterType2[PNGFilterType2.NONE=0]="NONE",PNGFilterType2[PNGFilterType2.SUB=1]="SUB",PNGFilterType2[PNGFilterType2.UP=2]="UP",PNGFilterType2[PNGFilterType2.AVERAGE=3]="AVERAGE",PNGFilterType2[PNGFilterType2.PATH=4]="PATH",PNGColorType2=PNGColorType||(PNGColorType={}),PNGColorType2[PNGColorType2.GRAYSCALE=0]="GRAYSCALE",PNGColorType2[PNGColorType2.COLOR=2]="COLOR",PNGColorType2[PNGColorType2.GRAYSCALE_ALPHA=4]="GRAYSCALE_ALPHA",PNGColorType2[PNGColorType2.COLOR_ALPHA=6]="COLOR_ALPHA";var UTIF={exports:{}},common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,(function(d){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function g(P,F){return Object.prototype.hasOwnProperty.call(P,F)}d.assign=function(P){for(var F=Array.prototype.slice.call(arguments,1);F.length;){var D=F.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var $ in D)g(D,$)&&(P[$]=D[$])}}return P},d.shrinkBuf=function(P,F){return P.length===F?P:P.subarray?P.subarray(0,F):(P.length=F,P)};var w={arraySet:function(P,F,D,$,U){if(F.subarray&&P.subarray)P.set(F.subarray(D,D+$),U);else for(var j=0;j<$;j++)P[U+j]=F[D+j]},flattenChunks:function(P){var F,D,$,U,j,Z;for($=0,F=0,D=P.length;F<D;F++)$+=P[F].length;for(Z=new Uint8Array($),U=0,F=0,D=P.length;F<D;F++)j=P[F],Z.set(j,U),U+=j.length;return Z}},I={arraySet:function(P,F,D,$,U){for(var j=0;j<$;j++)P[U+j]=F[D+j]},flattenChunks:function(P){return[].concat.apply([],P)}};d.setTyped=function(P){P?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,w)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,I))},d.setTyped(m)})(common)),common}var deflate$1={},deflate={},trees={},hasRequiredTrees,adler32_1,hasRequiredAdler32,crc32_1,hasRequiredCrc32,messages,hasRequiredMessages,hasRequiredDeflate$1;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var d=requireCommon(),m=0,g=1;function w(mt){for(var gt=mt.length;--gt>=0;)mt[gt]=0}var I=0,P=29,F=256,D=F+1+P,$=30,U=19,j=2*D+1,Z=15,G=16,H=7,W=256,Q=16,q=17,rt=18,et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],st=new Array(2*(D+2));w(st);var nt=new Array(2*$);w(nt);var lt=new Array(512);w(lt);var at=new Array(256);w(at);var ct=new Array(P);w(ct);var V,ut,wt,dt=new Array($);function ft(mt,gt,_t,vt,Bt){this.static_tree=mt,this.extra_bits=gt,this.extra_base=_t,this.elems=vt,this.max_length=Bt,this.has_stree=mt&&mt.length}function pt(mt,gt){this.dyn_tree=mt,this.max_code=0,this.stat_desc=gt}function Pt(mt){return mt<256?lt[mt]:lt[256+(mt>>>7)]}function It(mt,gt){mt.pending_buf[mt.pending++]=255&gt,mt.pending_buf[mt.pending++]=gt>>>8&255}function xt(mt,gt,_t){mt.bi_valid>G-_t?(mt.bi_buf|=gt<<mt.bi_valid&65535,It(mt,mt.bi_buf),mt.bi_buf=gt>>G-mt.bi_valid,mt.bi_valid+=_t-G):(mt.bi_buf|=gt<<mt.bi_valid&65535,mt.bi_valid+=_t)}function Ft(mt,gt,_t){xt(mt,_t[2*gt],_t[2*gt+1])}function Et(mt,gt){var _t=0;do _t|=1&mt,mt>>>=1,_t<<=1;while(--gt>0);return _t>>>1}function Ct(mt,gt,_t){var vt,Bt,K=new Array(Z+1),ot=0;for(vt=1;vt<=Z;vt++)K[vt]=ot=ot+_t[vt-1]<<1;for(Bt=0;Bt<=gt;Bt++){var bt=mt[2*Bt+1];bt!==0&&(mt[2*Bt]=Et(K[bt]++,bt))}}function Ot(mt){var gt;for(gt=0;gt<D;gt++)mt.dyn_ltree[2*gt]=0;for(gt=0;gt<$;gt++)mt.dyn_dtree[2*gt]=0;for(gt=0;gt<U;gt++)mt.bl_tree[2*gt]=0;mt.dyn_ltree[2*W]=1,mt.opt_len=mt.static_len=0,mt.last_lit=mt.matches=0}function Rt(mt){mt.bi_valid>8?It(mt,mt.bi_buf):mt.bi_valid>0&&(mt.pending_buf[mt.pending++]=mt.bi_buf),mt.bi_buf=0,mt.bi_valid=0}function St(mt,gt,_t,vt){var Bt=2*gt,K=2*_t;return mt[Bt]<mt[K]||mt[Bt]===mt[K]&&vt[gt]<=vt[_t]}function At(mt,gt,_t){for(var vt=mt.heap[_t],Bt=_t<<1;Bt<=mt.heap_len&&(Bt<mt.heap_len&&St(gt,mt.heap[Bt+1],mt.heap[Bt],mt.depth)&&Bt++,!St(gt,vt,mt.heap[Bt],mt.depth));)mt.heap[_t]=mt.heap[Bt],_t=Bt,Bt<<=1;mt.heap[_t]=vt}function Nt(mt,gt,_t){var vt,Bt,K,ot,bt=0;if(mt.last_lit!==0)do vt=mt.pending_buf[mt.d_buf+2*bt]<<8|mt.pending_buf[mt.d_buf+2*bt+1],Bt=mt.pending_buf[mt.l_buf+bt],bt++,vt===0?Ft(mt,Bt,gt):(Ft(mt,(K=at[Bt])+F+1,gt),(ot=et[K])!==0&&xt(mt,Bt-=ct[K],ot),Ft(mt,K=Pt(--vt),_t),(ot=X[K])!==0&&xt(mt,vt-=dt[K],ot));while(bt<mt.last_lit);Ft(mt,W,gt)}function Ut(mt,gt){var _t,vt,Bt,K=gt.dyn_tree,ot=gt.stat_desc.static_tree,bt=gt.stat_desc.has_stree,yt=gt.stat_desc.elems,$t=-1;for(mt.heap_len=0,mt.heap_max=j,_t=0;_t<yt;_t++)K[2*_t]!==0?(mt.heap[++mt.heap_len]=$t=_t,mt.depth[_t]=0):K[2*_t+1]=0;for(;mt.heap_len<2;)K[2*(Bt=mt.heap[++mt.heap_len]=$t<2?++$t:0)]=1,mt.depth[Bt]=0,mt.opt_len--,bt&&(mt.static_len-=ot[2*Bt+1]);for(gt.max_code=$t,_t=mt.heap_len>>1;_t>=1;_t--)At(mt,K,_t);Bt=yt;do _t=mt.heap[1],mt.heap[1]=mt.heap[mt.heap_len--],At(mt,K,1),vt=mt.heap[1],mt.heap[--mt.heap_max]=_t,mt.heap[--mt.heap_max]=vt,K[2*Bt]=K[2*_t]+K[2*vt],mt.depth[Bt]=(mt.depth[_t]>=mt.depth[vt]?mt.depth[_t]:mt.depth[vt])+1,K[2*_t+1]=K[2*vt+1]=Bt,mt.heap[1]=Bt++,At(mt,K,1);while(mt.heap_len>=2);mt.heap[--mt.heap_max]=mt.heap[1],(function(Zt,Kt){var te,Vt,ee,Xt,oe,ne,ae=Kt.dyn_tree,he=Kt.max_code,ie=Kt.stat_desc.static_tree,zt=Kt.stat_desc.has_stree,Jt=Kt.stat_desc.extra_bits,Lt=Kt.stat_desc.extra_base,Qt=Kt.stat_desc.max_length,kt=0;for(Xt=0;Xt<=Z;Xt++)Zt.bl_count[Xt]=0;for(ae[2*Zt.heap[Zt.heap_max]+1]=0,te=Zt.heap_max+1;te<j;te++)(Xt=ae[2*ae[2*(Vt=Zt.heap[te])+1]+1]+1)>Qt&&(Xt=Qt,kt++),ae[2*Vt+1]=Xt,Vt>he||(Zt.bl_count[Xt]++,oe=0,Vt>=Lt&&(oe=Jt[Vt-Lt]),ne=ae[2*Vt],Zt.opt_len+=ne*(Xt+oe),zt&&(Zt.static_len+=ne*(ie[2*Vt+1]+oe)));if(kt!==0){do{for(Xt=Qt-1;Zt.bl_count[Xt]===0;)Xt--;Zt.bl_count[Xt]--,Zt.bl_count[Xt+1]+=2,Zt.bl_count[Qt]--,kt-=2}while(kt>0);for(Xt=Qt;Xt!==0;Xt--)for(Vt=Zt.bl_count[Xt];Vt!==0;)(ee=Zt.heap[--te])>he||(ae[2*ee+1]!==Xt&&(Zt.opt_len+=(Xt-ae[2*ee+1])*ae[2*ee],ae[2*ee+1]=Xt),Vt--)}})(mt,gt),Ct(K,$t,mt.bl_count)}function jt(mt,gt,_t){var vt,Bt,K=-1,ot=gt[1],bt=0,yt=7,$t=4;for(ot===0&&(yt=138,$t=3),gt[2*(_t+1)+1]=65535,vt=0;vt<=_t;vt++)Bt=ot,ot=gt[2*(vt+1)+1],++bt<yt&&Bt===ot||(bt<$t?mt.bl_tree[2*Bt]+=bt:Bt!==0?(Bt!==K&&mt.bl_tree[2*Bt]++,mt.bl_tree[2*Q]++):bt<=10?mt.bl_tree[2*q]++:mt.bl_tree[2*rt]++,bt=0,K=Bt,ot===0?(yt=138,$t=3):Bt===ot?(yt=6,$t=3):(yt=7,$t=4))}function Tt(mt,gt,_t){var vt,Bt,K=-1,ot=gt[1],bt=0,yt=7,$t=4;for(ot===0&&(yt=138,$t=3),vt=0;vt<=_t;vt++)if(Bt=ot,ot=gt[2*(vt+1)+1],!(++bt<yt&&Bt===ot)){if(bt<$t)do Ft(mt,Bt,mt.bl_tree);while(--bt!=0);else Bt!==0?(Bt!==K&&(Ft(mt,Bt,mt.bl_tree),bt--),Ft(mt,Q,mt.bl_tree),xt(mt,bt-3,2)):bt<=10?(Ft(mt,q,mt.bl_tree),xt(mt,bt-3,3)):(Ft(mt,rt,mt.bl_tree),xt(mt,bt-11,7));bt=0,K=Bt,ot===0?(yt=138,$t=3):Bt===ot?(yt=6,$t=3):(yt=7,$t=4)}}w(dt);var it=!1;function Mt(mt,gt,_t,vt){xt(mt,(I<<1)+(vt?1:0),3),(function(Bt,K,ot,bt){Rt(Bt),It(Bt,ot),It(Bt,~ot),d.arraySet(Bt.pending_buf,Bt.window,K,ot,Bt.pending),Bt.pending+=ot})(mt,gt,_t)}return trees._tr_init=function(mt){it||((function(){var gt,_t,vt,Bt,K,ot=new Array(Z+1);for(vt=0,Bt=0;Bt<P-1;Bt++)for(ct[Bt]=vt,gt=0;gt<1<<et[Bt];gt++)at[vt++]=Bt;for(at[vt-1]=Bt,K=0,Bt=0;Bt<16;Bt++)for(dt[Bt]=K,gt=0;gt<1<<X[Bt];gt++)lt[K++]=Bt;for(K>>=7;Bt<$;Bt++)for(dt[Bt]=K<<7,gt=0;gt<1<<X[Bt]-7;gt++)lt[256+K++]=Bt;for(_t=0;_t<=Z;_t++)ot[_t]=0;for(gt=0;gt<=143;)st[2*gt+1]=8,gt++,ot[8]++;for(;gt<=255;)st[2*gt+1]=9,gt++,ot[9]++;for(;gt<=279;)st[2*gt+1]=7,gt++,ot[7]++;for(;gt<=287;)st[2*gt+1]=8,gt++,ot[8]++;for(Ct(st,D+1,ot),gt=0;gt<$;gt++)nt[2*gt+1]=5,nt[2*gt]=Et(gt,5);V=new ft(st,et,F+1,D,Z),ut=new ft(nt,X,0,$,Z),wt=new ft(new Array(0),J,0,U,H)})(),it=!0),mt.l_desc=new pt(mt.dyn_ltree,V),mt.d_desc=new pt(mt.dyn_dtree,ut),mt.bl_desc=new pt(mt.bl_tree,wt),mt.bi_buf=0,mt.bi_valid=0,Ot(mt)},trees._tr_stored_block=Mt,trees._tr_flush_block=function(mt,gt,_t,vt){var Bt,K,ot=0;mt.level>0?(mt.strm.data_type===2&&(mt.strm.data_type=(function(bt){var yt,$t=4093624447;for(yt=0;yt<=31;yt++,$t>>>=1)if(1&$t&&bt.dyn_ltree[2*yt]!==0)return m;if(bt.dyn_ltree[18]!==0||bt.dyn_ltree[20]!==0||bt.dyn_ltree[26]!==0)return g;for(yt=32;yt<F;yt++)if(bt.dyn_ltree[2*yt]!==0)return g;return m})(mt)),Ut(mt,mt.l_desc),Ut(mt,mt.d_desc),ot=(function(bt){var yt;for(jt(bt,bt.dyn_ltree,bt.l_desc.max_code),jt(bt,bt.dyn_dtree,bt.d_desc.max_code),Ut(bt,bt.bl_desc),yt=U-1;yt>=3&&bt.bl_tree[2*tt[yt]+1]===0;yt--);return bt.opt_len+=3*(yt+1)+5+5+4,yt})(mt),Bt=mt.opt_len+3+7>>>3,(K=mt.static_len+3+7>>>3)<=Bt&&(Bt=K)):Bt=K=_t+5,_t+4<=Bt&&gt!==-1?Mt(mt,gt,_t,vt):mt.strategy===4||K===Bt?(xt(mt,2+(vt?1:0),3),Nt(mt,st,nt)):(xt(mt,4+(vt?1:0),3),(function(bt,yt,$t,Zt){var Kt;for(xt(bt,yt-257,5),xt(bt,$t-1,5),xt(bt,Zt-4,4),Kt=0;Kt<Zt;Kt++)xt(bt,bt.bl_tree[2*tt[Kt]+1],3);Tt(bt,bt.dyn_ltree,yt-1),Tt(bt,bt.dyn_dtree,$t-1)})(mt,mt.l_desc.max_code+1,mt.d_desc.max_code+1,ot+1),Nt(mt,mt.dyn_ltree,mt.dyn_dtree)),Ot(mt),vt&&Rt(mt)},trees._tr_tally=function(mt,gt,_t){return mt.pending_buf[mt.d_buf+2*mt.last_lit]=gt>>>8&255,mt.pending_buf[mt.d_buf+2*mt.last_lit+1]=255&gt,mt.pending_buf[mt.l_buf+mt.last_lit]=255&_t,mt.last_lit++,gt===0?mt.dyn_ltree[2*_t]++:(mt.matches++,gt--,mt.dyn_ltree[2*(at[_t]+F+1)]++,mt.dyn_dtree[2*Pt(gt)]++),mt.last_lit===mt.lit_bufsize-1},trees._tr_align=function(mt){xt(mt,2,3),Ft(mt,W,st),(function(gt){gt.bi_valid===16?(It(gt,gt.bi_buf),gt.bi_buf=0,gt.bi_valid=0):gt.bi_valid>=8&&(gt.pending_buf[gt.pending++]=255&gt.bi_buf,gt.bi_buf>>=8,gt.bi_valid-=8)})(mt)},trees}function requireAdler32(){return hasRequiredAdler32||(hasRequiredAdler32=1,adler32_1=function(d,m,g,w){for(var I=65535&d,P=d>>>16&65535,F=0;g!==0;){g-=F=g>2e3?2e3:g;do P=P+(I=I+m[w++]|0)|0;while(--F);I%=65521,P%=65521}return I|P<<16}),adler32_1}function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;var d=(function(){for(var m,g=[],w=0;w<256;w++){m=w;for(var I=0;I<8;I++)m=1&m?3988292384^m>>>1:m>>>1;g[w]=m}return g})();return crc32_1=function(m,g,w,I){var P=d,F=I+w;m^=-1;for(var D=I;D<F;D++)m=m>>>8^P[255&(m^g[D])];return~m},crc32_1}function requireMessages(){return hasRequiredMessages?messages:(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;var d,m=requireCommon(),g=requireTrees(),w=requireAdler32(),I=requireCrc32(),P=requireMessages(),F=0,D=4,$=0,U=-2,j=-1,Z=4,G=2,H=8,W=9,Q=286,q=30,rt=19,et=2*Q+1,X=15,J=3,tt=258,st=tt+J+1,nt=42,lt=103,at=113,ct=666,V=1,ut=2,wt=3,dt=4;function ft(it,Mt){return it.msg=P[Mt],Mt}function pt(it){return(it<<1)-(it>4?9:0)}function Pt(it){for(var Mt=it.length;--Mt>=0;)it[Mt]=0}function It(it){var Mt=it.state,mt=Mt.pending;mt>it.avail_out&&(mt=it.avail_out),mt!==0&&(m.arraySet(it.output,Mt.pending_buf,Mt.pending_out,mt,it.next_out),it.next_out+=mt,Mt.pending_out+=mt,it.total_out+=mt,it.avail_out-=mt,Mt.pending-=mt,Mt.pending===0&&(Mt.pending_out=0))}function xt(it,Mt){g._tr_flush_block(it,it.block_start>=0?it.block_start:-1,it.strstart-it.block_start,Mt),it.block_start=it.strstart,It(it.strm)}function Ft(it,Mt){it.pending_buf[it.pending++]=Mt}function Et(it,Mt){it.pending_buf[it.pending++]=Mt>>>8&255,it.pending_buf[it.pending++]=255&Mt}function Ct(it,Mt){var mt,gt,_t=it.max_chain_length,vt=it.strstart,Bt=it.prev_length,K=it.nice_match,ot=it.strstart>it.w_size-st?it.strstart-(it.w_size-st):0,bt=it.window,yt=it.w_mask,$t=it.prev,Zt=it.strstart+tt,Kt=bt[vt+Bt-1],te=bt[vt+Bt];it.prev_length>=it.good_match&&(_t>>=2),K>it.lookahead&&(K=it.lookahead);do if(bt[(mt=Mt)+Bt]===te&&bt[mt+Bt-1]===Kt&&bt[mt]===bt[vt]&&bt[++mt]===bt[vt+1]){vt+=2,mt++;do;while(bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&bt[++vt]===bt[++mt]&&vt<Zt);if(gt=tt-(Zt-vt),vt=Zt-tt,gt>Bt){if(it.match_start=Mt,Bt=gt,gt>=K)break;Kt=bt[vt+Bt-1],te=bt[vt+Bt]}}while((Mt=$t[Mt&yt])>ot&&--_t!=0);return Bt<=it.lookahead?Bt:it.lookahead}function Ot(it){var Mt,mt,gt,_t,vt,Bt,K,ot,bt,yt,$t=it.w_size;do{if(_t=it.window_size-it.lookahead-it.strstart,it.strstart>=$t+($t-st)){m.arraySet(it.window,it.window,$t,$t,0),it.match_start-=$t,it.strstart-=$t,it.block_start-=$t,Mt=mt=it.hash_size;do gt=it.head[--Mt],it.head[Mt]=gt>=$t?gt-$t:0;while(--mt);Mt=mt=$t;do gt=it.prev[--Mt],it.prev[Mt]=gt>=$t?gt-$t:0;while(--mt);_t+=$t}if(it.strm.avail_in===0)break;if(Bt=it.strm,K=it.window,ot=it.strstart+it.lookahead,bt=_t,yt=void 0,(yt=Bt.avail_in)>bt&&(yt=bt),mt=yt===0?0:(Bt.avail_in-=yt,m.arraySet(K,Bt.input,Bt.next_in,yt,ot),Bt.state.wrap===1?Bt.adler=w(Bt.adler,K,yt,ot):Bt.state.wrap===2&&(Bt.adler=I(Bt.adler,K,yt,ot)),Bt.next_in+=yt,Bt.total_in+=yt,yt),it.lookahead+=mt,it.lookahead+it.insert>=J)for(vt=it.strstart-it.insert,it.ins_h=it.window[vt],it.ins_h=(it.ins_h<<it.hash_shift^it.window[vt+1])&it.hash_mask;it.insert&&(it.ins_h=(it.ins_h<<it.hash_shift^it.window[vt+J-1])&it.hash_mask,it.prev[vt&it.w_mask]=it.head[it.ins_h],it.head[it.ins_h]=vt,vt++,it.insert--,!(it.lookahead+it.insert<J)););}while(it.lookahead<st&&it.strm.avail_in!==0)}function Rt(it,Mt){for(var mt,gt;;){if(it.lookahead<st){if(Ot(it),it.lookahead<st&&Mt===F)return V;if(it.lookahead===0)break}if(mt=0,it.lookahead>=J&&(it.ins_h=(it.ins_h<<it.hash_shift^it.window[it.strstart+J-1])&it.hash_mask,mt=it.prev[it.strstart&it.w_mask]=it.head[it.ins_h],it.head[it.ins_h]=it.strstart),mt!==0&&it.strstart-mt<=it.w_size-st&&(it.match_length=Ct(it,mt)),it.match_length>=J)if(gt=g._tr_tally(it,it.strstart-it.match_start,it.match_length-J),it.lookahead-=it.match_length,it.match_length<=it.max_lazy_match&&it.lookahead>=J){it.match_length--;do it.strstart++,it.ins_h=(it.ins_h<<it.hash_shift^it.window[it.strstart+J-1])&it.hash_mask,mt=it.prev[it.strstart&it.w_mask]=it.head[it.ins_h],it.head[it.ins_h]=it.strstart;while(--it.match_length!=0);it.strstart++}else it.strstart+=it.match_length,it.match_length=0,it.ins_h=it.window[it.strstart],it.ins_h=(it.ins_h<<it.hash_shift^it.window[it.strstart+1])&it.hash_mask;else gt=g._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++;if(gt&&(xt(it,!1),it.strm.avail_out===0))return V}return it.insert=it.strstart<J-1?it.strstart:J-1,Mt===D?(xt(it,!0),it.strm.avail_out===0?wt:dt):it.last_lit&&(xt(it,!1),it.strm.avail_out===0)?V:ut}function St(it,Mt){for(var mt,gt,_t;;){if(it.lookahead<st){if(Ot(it),it.lookahead<st&&Mt===F)return V;if(it.lookahead===0)break}if(mt=0,it.lookahead>=J&&(it.ins_h=(it.ins_h<<it.hash_shift^it.window[it.strstart+J-1])&it.hash_mask,mt=it.prev[it.strstart&it.w_mask]=it.head[it.ins_h],it.head[it.ins_h]=it.strstart),it.prev_length=it.match_length,it.prev_match=it.match_start,it.match_length=J-1,mt!==0&&it.prev_length<it.max_lazy_match&&it.strstart-mt<=it.w_size-st&&(it.match_length=Ct(it,mt),it.match_length<=5&&(it.strategy===1||it.match_length===J&&it.strstart-it.match_start>4096)&&(it.match_length=J-1)),it.prev_length>=J&&it.match_length<=it.prev_length){_t=it.strstart+it.lookahead-J,gt=g._tr_tally(it,it.strstart-1-it.prev_match,it.prev_length-J),it.lookahead-=it.prev_length-1,it.prev_length-=2;do++it.strstart<=_t&&(it.ins_h=(it.ins_h<<it.hash_shift^it.window[it.strstart+J-1])&it.hash_mask,mt=it.prev[it.strstart&it.w_mask]=it.head[it.ins_h],it.head[it.ins_h]=it.strstart);while(--it.prev_length!=0);if(it.match_available=0,it.match_length=J-1,it.strstart++,gt&&(xt(it,!1),it.strm.avail_out===0))return V}else if(it.match_available){if((gt=g._tr_tally(it,0,it.window[it.strstart-1]))&&xt(it,!1),it.strstart++,it.lookahead--,it.strm.avail_out===0)return V}else it.match_available=1,it.strstart++,it.lookahead--}return it.match_available&&(gt=g._tr_tally(it,0,it.window[it.strstart-1]),it.match_available=0),it.insert=it.strstart<J-1?it.strstart:J-1,Mt===D?(xt(it,!0),it.strm.avail_out===0?wt:dt):it.last_lit&&(xt(it,!1),it.strm.avail_out===0)?V:ut}function At(it,Mt,mt,gt,_t){this.good_length=it,this.max_lazy=Mt,this.nice_length=mt,this.max_chain=gt,this.func=_t}function Nt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=H,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(2*et),this.dyn_dtree=new m.Buf16(2*(2*q+1)),this.bl_tree=new m.Buf16(2*(2*rt+1)),Pt(this.dyn_ltree),Pt(this.dyn_dtree),Pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(X+1),this.heap=new m.Buf16(2*Q+1),Pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(2*Q+1),Pt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ut(it){var Mt;return it&&it.state?(it.total_in=it.total_out=0,it.data_type=G,(Mt=it.state).pending=0,Mt.pending_out=0,Mt.wrap<0&&(Mt.wrap=-Mt.wrap),Mt.status=Mt.wrap?nt:at,it.adler=Mt.wrap===2?0:1,Mt.last_flush=F,g._tr_init(Mt),$):ft(it,U)}function jt(it){var Mt=Ut(it);return Mt===$&&(function(mt){mt.window_size=2*mt.w_size,Pt(mt.head),mt.max_lazy_match=d[mt.level].max_lazy,mt.good_match=d[mt.level].good_length,mt.nice_match=d[mt.level].nice_length,mt.max_chain_length=d[mt.level].max_chain,mt.strstart=0,mt.block_start=0,mt.lookahead=0,mt.insert=0,mt.match_length=mt.prev_length=J-1,mt.match_available=0,mt.ins_h=0})(it.state),Mt}function Tt(it,Mt,mt,gt,_t,vt){if(!it)return U;var Bt=1;if(Mt===j&&(Mt=6),gt<0?(Bt=0,gt=-gt):gt>15&&(Bt=2,gt-=16),_t<1||_t>W||mt!==H||gt<8||gt>15||Mt<0||Mt>9||vt<0||vt>Z)return ft(it,U);gt===8&&(gt=9);var K=new Nt;return it.state=K,K.strm=it,K.wrap=Bt,K.gzhead=null,K.w_bits=gt,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=_t+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+J-1)/J),K.window=new m.Buf8(2*K.w_size),K.head=new m.Buf16(K.hash_size),K.prev=new m.Buf16(K.w_size),K.lit_bufsize=1<<_t+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new m.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=Mt,K.strategy=vt,K.method=mt,jt(it)}return d=[new At(0,0,0,0,(function(it,Mt){var mt=65535;for(mt>it.pending_buf_size-5&&(mt=it.pending_buf_size-5);;){if(it.lookahead<=1){if(Ot(it),it.lookahead===0&&Mt===F)return V;if(it.lookahead===0)break}it.strstart+=it.lookahead,it.lookahead=0;var gt=it.block_start+mt;if((it.strstart===0||it.strstart>=gt)&&(it.lookahead=it.strstart-gt,it.strstart=gt,xt(it,!1),it.strm.avail_out===0)||it.strstart-it.block_start>=it.w_size-st&&(xt(it,!1),it.strm.avail_out===0))return V}return it.insert=0,Mt===D?(xt(it,!0),it.strm.avail_out===0?wt:dt):(it.strstart>it.block_start&&(xt(it,!1),it.strm.avail_out),V)})),new At(4,4,8,4,Rt),new At(4,5,16,8,Rt),new At(4,6,32,32,Rt),new At(4,4,16,16,St),new At(8,16,32,32,St),new At(8,16,128,128,St),new At(8,32,128,256,St),new At(32,128,258,1024,St),new At(32,258,258,4096,St)],deflate.deflateInit=function(it,Mt){return Tt(it,Mt,H,15,8,0)},deflate.deflateInit2=Tt,deflate.deflateReset=jt,deflate.deflateResetKeep=Ut,deflate.deflateSetHeader=function(it,Mt){return it&&it.state?it.state.wrap!==2?U:(it.state.gzhead=Mt,$):U},deflate.deflate=function(it,Mt){var mt,gt,_t,vt;if(!it||!it.state||Mt>5||Mt<0)return it?ft(it,U):U;if(gt=it.state,!it.output||!it.input&&it.avail_in!==0||gt.status===ct&&Mt!==D)return ft(it,it.avail_out===0?-5:U);if(gt.strm=it,mt=gt.last_flush,gt.last_flush=Mt,gt.status===nt)if(gt.wrap===2)it.adler=0,Ft(gt,31),Ft(gt,139),Ft(gt,8),gt.gzhead?(Ft(gt,(gt.gzhead.text?1:0)+(gt.gzhead.hcrc?2:0)+(gt.gzhead.extra?4:0)+(gt.gzhead.name?8:0)+(gt.gzhead.comment?16:0)),Ft(gt,255&gt.gzhead.time),Ft(gt,gt.gzhead.time>>8&255),Ft(gt,gt.gzhead.time>>16&255),Ft(gt,gt.gzhead.time>>24&255),Ft(gt,gt.level===9?2:gt.strategy>=2||gt.level<2?4:0),Ft(gt,255&gt.gzhead.os),gt.gzhead.extra&&gt.gzhead.extra.length&&(Ft(gt,255&gt.gzhead.extra.length),Ft(gt,gt.gzhead.extra.length>>8&255)),gt.gzhead.hcrc&&(it.adler=I(it.adler,gt.pending_buf,gt.pending,0)),gt.gzindex=0,gt.status=69):(Ft(gt,0),Ft(gt,0),Ft(gt,0),Ft(gt,0),Ft(gt,0),Ft(gt,gt.level===9?2:gt.strategy>=2||gt.level<2?4:0),Ft(gt,3),gt.status=at);else{var Bt=H+(gt.w_bits-8<<4)<<8;Bt|=(gt.strategy>=2||gt.level<2?0:gt.level<6?1:gt.level===6?2:3)<<6,gt.strstart!==0&&(Bt|=32),Bt+=31-Bt%31,gt.status=at,Et(gt,Bt),gt.strstart!==0&&(Et(gt,it.adler>>>16),Et(gt,65535&it.adler)),it.adler=1}if(gt.status===69)if(gt.gzhead.extra){for(_t=gt.pending;gt.gzindex<(65535&gt.gzhead.extra.length)&&(gt.pending!==gt.pending_buf_size||(gt.gzhead.hcrc&&gt.pending>_t&&(it.adler=I(it.adler,gt.pending_buf,gt.pending-_t,_t)),It(it),_t=gt.pending,gt.pending!==gt.pending_buf_size));)Ft(gt,255&gt.gzhead.extra[gt.gzindex]),gt.gzindex++;gt.gzhead.hcrc&&gt.pending>_t&&(it.adler=I(it.adler,gt.pending_buf,gt.pending-_t,_t)),gt.gzindex===gt.gzhead.extra.length&&(gt.gzindex=0,gt.status=73)}else gt.status=73;if(gt.status===73)if(gt.gzhead.name){_t=gt.pending;do{if(gt.pending===gt.pending_buf_size&&(gt.gzhead.hcrc&&gt.pending>_t&&(it.adler=I(it.adler,gt.pending_buf,gt.pending-_t,_t)),It(it),_t=gt.pending,gt.pending===gt.pending_buf_size)){vt=1;break}vt=gt.gzindex<gt.gzhead.name.length?255&gt.gzhead.name.charCodeAt(gt.gzindex++):0,Ft(gt,vt)}while(vt!==0);gt.gzhead.hcrc&&gt.pending>_t&&(it.adler=I(it.adler,gt.pending_buf,gt.pending-_t,_t)),vt===0&&(gt.gzindex=0,gt.status=91)}else gt.status=91;if(gt.status===91)if(gt.gzhead.comment){_t=gt.pending;do{if(gt.pending===gt.pending_buf_size&&(gt.gzhead.hcrc&&gt.pending>_t&&(it.adler=I(it.adler,gt.pending_buf,gt.pending-_t,_t)),It(it),_t=gt.pending,gt.pending===gt.pending_buf_size)){vt=1;break}vt=gt.gzindex<gt.gzhead.comment.length?255&gt.gzhead.comment.charCodeAt(gt.gzindex++):0,Ft(gt,vt)}while(vt!==0);gt.gzhead.hcrc&&gt.pending>_t&&(it.adler=I(it.adler,gt.pending_buf,gt.pending-_t,_t)),vt===0&&(gt.status=lt)}else gt.status=lt;if(gt.status===lt&&(gt.gzhead.hcrc?(gt.pending+2>gt.pending_buf_size&&It(it),gt.pending+2<=gt.pending_buf_size&&(Ft(gt,255&it.adler),Ft(gt,it.adler>>8&255),it.adler=0,gt.status=at)):gt.status=at),gt.pending!==0){if(It(it),it.avail_out===0)return gt.last_flush=-1,$}else if(it.avail_in===0&&pt(Mt)<=pt(mt)&&Mt!==D)return ft(it,-5);if(gt.status===ct&&it.avail_in!==0)return ft(it,-5);if(it.avail_in!==0||gt.lookahead!==0||Mt!==F&&gt.status!==ct){var K=gt.strategy===2?(function(ot,bt){for(var yt;;){if(ot.lookahead===0&&(Ot(ot),ot.lookahead===0)){if(bt===F)return V;break}if(ot.match_length=0,yt=g._tr_tally(ot,0,ot.window[ot.strstart]),ot.lookahead--,ot.strstart++,yt&&(xt(ot,!1),ot.strm.avail_out===0))return V}return ot.insert=0,bt===D?(xt(ot,!0),ot.strm.avail_out===0?wt:dt):ot.last_lit&&(xt(ot,!1),ot.strm.avail_out===0)?V:ut})(gt,Mt):gt.strategy===3?(function(ot,bt){for(var yt,$t,Zt,Kt,te=ot.window;;){if(ot.lookahead<=tt){if(Ot(ot),ot.lookahead<=tt&&bt===F)return V;if(ot.lookahead===0)break}if(ot.match_length=0,ot.lookahead>=J&&ot.strstart>0&&($t=te[Zt=ot.strstart-1])===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]){Kt=ot.strstart+tt;do;while($t===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]&&$t===te[++Zt]&&Zt<Kt);ot.match_length=tt-(Kt-Zt),ot.match_length>ot.lookahead&&(ot.match_length=ot.lookahead)}if(ot.match_length>=J?(yt=g._tr_tally(ot,1,ot.match_length-J),ot.lookahead-=ot.match_length,ot.strstart+=ot.match_length,ot.match_length=0):(yt=g._tr_tally(ot,0,ot.window[ot.strstart]),ot.lookahead--,ot.strstart++),yt&&(xt(ot,!1),ot.strm.avail_out===0))return V}return ot.insert=0,bt===D?(xt(ot,!0),ot.strm.avail_out===0?wt:dt):ot.last_lit&&(xt(ot,!1),ot.strm.avail_out===0)?V:ut})(gt,Mt):d[gt.level].func(gt,Mt);if(K!==wt&&K!==dt||(gt.status=ct),K===V||K===wt)return it.avail_out===0&&(gt.last_flush=-1),$;if(K===ut&&(Mt===1?g._tr_align(gt):Mt!==5&&(g._tr_stored_block(gt,0,0,!1),Mt===3&&(Pt(gt.head),gt.lookahead===0&&(gt.strstart=0,gt.block_start=0,gt.insert=0))),It(it),it.avail_out===0))return gt.last_flush=-1,$}return Mt!==D?$:gt.wrap<=0?1:(gt.wrap===2?(Ft(gt,255&it.adler),Ft(gt,it.adler>>8&255),Ft(gt,it.adler>>16&255),Ft(gt,it.adler>>24&255),Ft(gt,255&it.total_in),Ft(gt,it.total_in>>8&255),Ft(gt,it.total_in>>16&255),Ft(gt,it.total_in>>24&255)):(Et(gt,it.adler>>>16),Et(gt,65535&it.adler)),It(it),gt.wrap>0&&(gt.wrap=-gt.wrap),gt.pending!==0?$:1)},deflate.deflateEnd=function(it){var Mt;return it&&it.state?(Mt=it.state.status)!==nt&&Mt!==69&&Mt!==73&&Mt!==91&&Mt!==lt&&Mt!==at&&Mt!==ct?ft(it,U):(it.state=null,Mt===at?ft(it,-3):$):U},deflate.deflateSetDictionary=function(it,Mt){var mt,gt,_t,vt,Bt,K,ot,bt,yt=Mt.length;if(!it||!it.state||(vt=(mt=it.state).wrap)===2||vt===1&&mt.status!==nt||mt.lookahead)return U;for(vt===1&&(it.adler=w(it.adler,Mt,yt,0)),mt.wrap=0,yt>=mt.w_size&&(vt===0&&(Pt(mt.head),mt.strstart=0,mt.block_start=0,mt.insert=0),bt=new m.Buf8(mt.w_size),m.arraySet(bt,Mt,yt-mt.w_size,mt.w_size,0),Mt=bt,yt=mt.w_size),Bt=it.avail_in,K=it.next_in,ot=it.input,it.avail_in=yt,it.next_in=0,it.input=Mt,Ot(mt);mt.lookahead>=J;){gt=mt.strstart,_t=mt.lookahead-(J-1);do mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[gt+J-1])&mt.hash_mask,mt.prev[gt&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=gt,gt++;while(--_t);mt.strstart=gt,mt.lookahead=J-1,Ot(mt)}return mt.strstart+=mt.lookahead,mt.block_start=mt.strstart,mt.insert=mt.lookahead,mt.lookahead=0,mt.match_length=mt.prev_length=J-1,mt.match_available=0,it.next_in=K,it.input=ot,it.avail_in=Bt,mt.wrap=vt,$},deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var strings={},hasRequiredStrings,zstream,hasRequiredZstream,hasRequiredDeflate;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;var d=requireCommon(),m=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g=!1}for(var w=new d.Buf8(256),I=0;I<256;I++)w[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;function P(F,D){if(D<65534&&(F.subarray&&g||!F.subarray&&m))return String.fromCharCode.apply(null,d.shrinkBuf(F,D));for(var $="",U=0;U<D;U++)$+=String.fromCharCode(F[U]);return $}return w[254]=w[254]=1,strings.string2buf=function(F){var D,$,U,j,Z,G=F.length,H=0;for(j=0;j<G;j++)(64512&($=F.charCodeAt(j)))==55296&&j+1<G&&(64512&(U=F.charCodeAt(j+1)))==56320&&($=65536+($-55296<<10)+(U-56320),j++),H+=$<128?1:$<2048?2:$<65536?3:4;for(D=new d.Buf8(H),Z=0,j=0;Z<H;j++)(64512&($=F.charCodeAt(j)))==55296&&j+1<G&&(64512&(U=F.charCodeAt(j+1)))==56320&&($=65536+($-55296<<10)+(U-56320),j++),$<128?D[Z++]=$:$<2048?(D[Z++]=192|$>>>6,D[Z++]=128|63&$):$<65536?(D[Z++]=224|$>>>12,D[Z++]=128|$>>>6&63,D[Z++]=128|63&$):(D[Z++]=240|$>>>18,D[Z++]=128|$>>>12&63,D[Z++]=128|$>>>6&63,D[Z++]=128|63&$);return D},strings.buf2binstring=function(F){return P(F,F.length)},strings.binstring2buf=function(F){for(var D=new d.Buf8(F.length),$=0,U=D.length;$<U;$++)D[$]=F.charCodeAt($);return D},strings.buf2string=function(F,D){var $,U,j,Z,G=D||F.length,H=new Array(2*G);for(U=0,$=0;$<G;)if((j=F[$++])<128)H[U++]=j;else if((Z=w[j])>4)H[U++]=65533,$+=Z-1;else{for(j&=Z===2?31:Z===3?15:7;Z>1&&$<G;)j=j<<6|63&F[$++],Z--;Z>1?H[U++]=65533:j<65536?H[U++]=j:(j-=65536,H[U++]=55296|j>>10&1023,H[U++]=56320|1023&j)}return P(H,U)},strings.utf8border=function(F,D){var $;for((D=D||F.length)>F.length&&(D=F.length),$=D-1;$>=0&&(192&F[$])==128;)$--;return $<0||$===0?D:$+w[F[$]]>D?$:D},strings}function requireZstream(){return hasRequiredZstream?zstream:(hasRequiredZstream=1,zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0})}function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;var d=requireDeflate$1(),m=requireCommon(),g=requireStrings(),w=requireMessages(),I=requireZstream(),P=Object.prototype.toString,F=0,D=-1,$=0,U=8;function j(G){if(!(this instanceof j))return new j(G);this.options=m.assign({level:D,method:U,chunkSize:16384,windowBits:15,memLevel:8,strategy:$,to:""},G||{});var H=this.options;H.raw&&H.windowBits>0?H.windowBits=-H.windowBits:H.gzip&&H.windowBits>0&&H.windowBits<16&&(H.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var W=d.deflateInit2(this.strm,H.level,H.method,H.windowBits,H.memLevel,H.strategy);if(W!==F)throw new Error(w[W]);if(H.header&&d.deflateSetHeader(this.strm,H.header),H.dictionary){var Q;if(Q=typeof H.dictionary=="string"?g.string2buf(H.dictionary):P.call(H.dictionary)==="[object ArrayBuffer]"?new Uint8Array(H.dictionary):H.dictionary,(W=d.deflateSetDictionary(this.strm,Q))!==F)throw new Error(w[W]);this._dict_set=!0}}function Z(G,H){var W=new j(H);if(W.push(G,!0),W.err)throw W.msg||w[W.err];return W.result}return j.prototype.push=function(G,H){var W,Q,q=this.strm,rt=this.options.chunkSize;if(this.ended)return!1;Q=H===~~H?H:H===!0?4:0,typeof G=="string"?q.input=g.string2buf(G):P.call(G)==="[object ArrayBuffer]"?q.input=new Uint8Array(G):q.input=G,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new m.Buf8(rt),q.next_out=0,q.avail_out=rt),(W=d.deflate(q,Q))!==1&&W!==F)return this.onEnd(W),this.ended=!0,!1;q.avail_out!==0&&(q.avail_in!==0||Q!==4&&Q!==2)||(this.options.to==="string"?this.onData(g.buf2binstring(m.shrinkBuf(q.output,q.next_out))):this.onData(m.shrinkBuf(q.output,q.next_out)))}while((q.avail_in>0||q.avail_out===0)&&W!==1);return Q===4?(W=d.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===F):Q!==2||(this.onEnd(F),q.avail_out=0,!0)},j.prototype.onData=function(G){this.chunks.push(G)},j.prototype.onEnd=function(G){G===F&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=G,this.msg=this.strm.msg},deflate$1.Deflate=j,deflate$1.deflate=Z,deflate$1.deflateRaw=function(G,H){return(H=H||{}).raw=!0,Z(G,H)},deflate$1.gzip=function(G,H){return(H=H||{}).gzip=!0,Z(G,H)},deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast,inftrees,hasRequiredInftrees,hasRequiredInflate$1,constants,hasRequiredConstants,gzheader,hasRequiredGzheader,hasRequiredInflate,pako_1,hasRequiredPako;function requireInffast(){return hasRequiredInffast?inffast:(hasRequiredInffast=1,inffast=function(d,m){var g,w,I,P,F,D,$,U,j,Z,G,H,W,Q,q,rt,et,X,J,tt,st,nt,lt,at,ct;g=d.state,w=d.next_in,at=d.input,I=w+(d.avail_in-5),P=d.next_out,ct=d.output,F=P-(m-d.avail_out),D=P+(d.avail_out-257),$=g.dmax,U=g.wsize,j=g.whave,Z=g.wnext,G=g.window,H=g.hold,W=g.bits,Q=g.lencode,q=g.distcode,rt=(1<<g.lenbits)-1,et=(1<<g.distbits)-1;t:do{W<15&&(H+=at[w++]<<W,W+=8,H+=at[w++]<<W,W+=8),X=Q[H&rt];e:for(;;){if(H>>>=J=X>>>24,W-=J,(J=X>>>16&255)===0)ct[P++]=65535&X;else{if(!(16&J)){if(64&J){if(32&J){g.mode=12;break t}d.msg="invalid literal/length code",g.mode=30;break t}X=Q[(65535&X)+(H&(1<<J)-1)];continue e}for(tt=65535&X,(J&=15)&&(W<J&&(H+=at[w++]<<W,W+=8),tt+=H&(1<<J)-1,H>>>=J,W-=J),W<15&&(H+=at[w++]<<W,W+=8,H+=at[w++]<<W,W+=8),X=q[H&et];;){if(H>>>=J=X>>>24,W-=J,16&(J=X>>>16&255)){if(st=65535&X,W<(J&=15)&&(H+=at[w++]<<W,(W+=8)<J&&(H+=at[w++]<<W,W+=8)),(st+=H&(1<<J)-1)>$){d.msg="invalid distance too far back",g.mode=30;break t}if(H>>>=J,W-=J,st>(J=P-F)){if((J=st-J)>j&&g.sane){d.msg="invalid distance too far back",g.mode=30;break t}if(nt=0,lt=G,Z===0){if(nt+=U-J,J<tt){tt-=J;do ct[P++]=G[nt++];while(--J);nt=P-st,lt=ct}}else if(Z<J){if(nt+=U+Z-J,(J-=Z)<tt){tt-=J;do ct[P++]=G[nt++];while(--J);if(nt=0,Z<tt){tt-=J=Z;do ct[P++]=G[nt++];while(--J);nt=P-st,lt=ct}}}else if(nt+=Z-J,J<tt){tt-=J;do ct[P++]=G[nt++];while(--J);nt=P-st,lt=ct}for(;tt>2;)ct[P++]=lt[nt++],ct[P++]=lt[nt++],ct[P++]=lt[nt++],tt-=3;tt&&(ct[P++]=lt[nt++],tt>1&&(ct[P++]=lt[nt++]))}else{nt=P-st;do ct[P++]=ct[nt++],ct[P++]=ct[nt++],ct[P++]=ct[nt++],tt-=3;while(tt>2);tt&&(ct[P++]=ct[nt++],tt>1&&(ct[P++]=ct[nt++]))}break}if(64&J){d.msg="invalid distance code",g.mode=30;break t}X=q[(65535&X)+(H&(1<<J)-1)]}}break}}while(w<I&&P<D);w-=tt=W>>3,H&=(1<<(W-=tt<<3))-1,d.next_in=w,d.next_out=P,d.avail_in=w<I?I-w+5:5-(w-I),d.avail_out=P<D?D-P+257:257-(P-D),g.hold=H,g.bits=W},inffast)}function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var d=requireCommon(),m=15,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],w=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(F,D,$,U,j,Z,G,H){var W,Q,q,rt,et,X,J,tt,st,nt=H.bits,lt=0,at=0,ct=0,V=0,ut=0,wt=0,dt=0,ft=0,pt=0,Pt=0,It=null,xt=0,Ft=new d.Buf16(16),Et=new d.Buf16(16),Ct=null,Ot=0;for(lt=0;lt<=m;lt++)Ft[lt]=0;for(at=0;at<U;at++)Ft[D[$+at]]++;for(ut=nt,V=m;V>=1&&Ft[V]===0;V--);if(ut>V&&(ut=V),V===0)return j[Z++]=20971520,j[Z++]=20971520,H.bits=1,0;for(ct=1;ct<V&&Ft[ct]===0;ct++);for(ut<ct&&(ut=ct),ft=1,lt=1;lt<=m;lt++)if(ft<<=1,(ft-=Ft[lt])<0)return-1;if(ft>0&&(F===0||V!==1))return-1;for(Et[1]=0,lt=1;lt<m;lt++)Et[lt+1]=Et[lt]+Ft[lt];for(at=0;at<U;at++)D[$+at]!==0&&(G[Et[D[$+at]]++]=at);if(F===0?(It=Ct=G,X=19):F===1?(It=g,xt-=257,Ct=w,Ot-=257,X=256):(It=I,Ct=P,X=-1),Pt=0,at=0,lt=ct,et=Z,wt=ut,dt=0,q=-1,rt=(pt=1<<ut)-1,F===1&&pt>852||F===2&&pt>592)return 1;for(;;){J=lt-dt,G[at]<X?(tt=0,st=G[at]):G[at]>X?(tt=Ct[Ot+G[at]],st=It[xt+G[at]]):(tt=96,st=0),W=1<<lt-dt,ct=Q=1<<wt;do j[et+(Pt>>dt)+(Q-=W)]=J<<24|tt<<16|st;while(Q!==0);for(W=1<<lt-1;Pt&W;)W>>=1;if(W!==0?(Pt&=W-1,Pt+=W):Pt=0,at++,--Ft[lt]==0){if(lt===V)break;lt=D[$+G[at]]}if(lt>ut&&(Pt&rt)!==q){for(dt===0&&(dt=ut),et+=ct,ft=1<<(wt=lt-dt);wt+dt<V&&!((ft-=Ft[wt+dt])<=0);)wt++,ft<<=1;if(pt+=1<<wt,F===1&&pt>852||F===2&&pt>592)return 1;j[q=Pt&rt]=ut<<24|wt<<16|et-Z}}return Pt!==0&&(j[et+Pt]=lt-dt<<24|64<<16),H.bits=ut,0}}function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;var d=requireCommon(),m=requireAdler32(),g=requireCrc32(),w=requireInffast(),I=requireInftrees(),P=1,F=2,D=0,$=-2,U=1,j=12,Z=30,G=852,H=592;function W(at){return(at>>>24&255)+(at>>>8&65280)+((65280&at)<<8)+((255&at)<<24)}function Q(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function q(at){var ct;return at&&at.state?(ct=at.state,at.total_in=at.total_out=ct.total=0,at.msg="",ct.wrap&&(at.adler=1&ct.wrap),ct.mode=U,ct.last=0,ct.havedict=0,ct.dmax=32768,ct.head=null,ct.hold=0,ct.bits=0,ct.lencode=ct.lendyn=new d.Buf32(G),ct.distcode=ct.distdyn=new d.Buf32(H),ct.sane=1,ct.back=-1,D):$}function rt(at){var ct;return at&&at.state?((ct=at.state).wsize=0,ct.whave=0,ct.wnext=0,q(at)):$}function et(at,ct){var V,ut;return at&&at.state?(ut=at.state,ct<0?(V=0,ct=-ct):(V=1+(ct>>4),ct<48&&(ct&=15)),ct&&(ct<8||ct>15)?$:(ut.window!==null&&ut.wbits!==ct&&(ut.window=null),ut.wrap=V,ut.wbits=ct,rt(at))):$}function X(at,ct){var V,ut;return at?(ut=new Q,at.state=ut,ut.window=null,(V=et(at,ct))!==D&&(at.state=null),V):$}var J,tt,st=!0;function nt(at){if(st){var ct;for(J=new d.Buf32(512),tt=new d.Buf32(32),ct=0;ct<144;)at.lens[ct++]=8;for(;ct<256;)at.lens[ct++]=9;for(;ct<280;)at.lens[ct++]=7;for(;ct<288;)at.lens[ct++]=8;for(I(P,at.lens,0,288,J,0,at.work,{bits:9}),ct=0;ct<32;)at.lens[ct++]=5;I(F,at.lens,0,32,tt,0,at.work,{bits:5}),st=!1}at.lencode=J,at.lenbits=9,at.distcode=tt,at.distbits=5}function lt(at,ct,V,ut){var wt,dt=at.state;return dt.window===null&&(dt.wsize=1<<dt.wbits,dt.wnext=0,dt.whave=0,dt.window=new d.Buf8(dt.wsize)),ut>=dt.wsize?(d.arraySet(dt.window,ct,V-dt.wsize,dt.wsize,0),dt.wnext=0,dt.whave=dt.wsize):((wt=dt.wsize-dt.wnext)>ut&&(wt=ut),d.arraySet(dt.window,ct,V-ut,wt,dt.wnext),(ut-=wt)?(d.arraySet(dt.window,ct,V-ut,ut,0),dt.wnext=ut,dt.whave=dt.wsize):(dt.wnext+=wt,dt.wnext===dt.wsize&&(dt.wnext=0),dt.whave<dt.wsize&&(dt.whave+=wt))),0}return inflate.inflateReset=rt,inflate.inflateReset2=et,inflate.inflateResetKeep=q,inflate.inflateInit=function(at){return X(at,15)},inflate.inflateInit2=X,inflate.inflate=function(at,ct){var V,ut,wt,dt,ft,pt,Pt,It,xt,Ft,Et,Ct,Ot,Rt,St,At,Nt,Ut,jt,Tt,it,Mt,mt,gt,_t=0,vt=new d.Buf8(4),Bt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!at||!at.state||!at.output||!at.input&&at.avail_in!==0)return $;(V=at.state).mode===j&&(V.mode=13),ft=at.next_out,wt=at.output,Pt=at.avail_out,dt=at.next_in,ut=at.input,pt=at.avail_in,It=V.hold,xt=V.bits,Ft=pt,Et=Pt,Mt=D;t:for(;;)switch(V.mode){case U:if(V.wrap===0){V.mode=13;break}for(;xt<16;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(2&V.wrap&&It===35615){V.check=0,vt[0]=255&It,vt[1]=It>>>8&255,V.check=g(V.check,vt,2,0),It=0,xt=0,V.mode=2;break}if(V.flags=0,V.head&&(V.head.done=!1),!(1&V.wrap)||(((255&It)<<8)+(It>>8))%31){at.msg="incorrect header check",V.mode=Z;break}if((15&It)!=8){at.msg="unknown compression method",V.mode=Z;break}if(xt-=4,it=8+(15&(It>>>=4)),V.wbits===0)V.wbits=it;else if(it>V.wbits){at.msg="invalid window size",V.mode=Z;break}V.dmax=1<<it,at.adler=V.check=1,V.mode=512&It?10:j,It=0,xt=0;break;case 2:for(;xt<16;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(V.flags=It,(255&V.flags)!=8){at.msg="unknown compression method",V.mode=Z;break}if(57344&V.flags){at.msg="unknown header flags set",V.mode=Z;break}V.head&&(V.head.text=It>>8&1),512&V.flags&&(vt[0]=255&It,vt[1]=It>>>8&255,V.check=g(V.check,vt,2,0)),It=0,xt=0,V.mode=3;case 3:for(;xt<32;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}V.head&&(V.head.time=It),512&V.flags&&(vt[0]=255&It,vt[1]=It>>>8&255,vt[2]=It>>>16&255,vt[3]=It>>>24&255,V.check=g(V.check,vt,4,0)),It=0,xt=0,V.mode=4;case 4:for(;xt<16;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}V.head&&(V.head.xflags=255&It,V.head.os=It>>8),512&V.flags&&(vt[0]=255&It,vt[1]=It>>>8&255,V.check=g(V.check,vt,2,0)),It=0,xt=0,V.mode=5;case 5:if(1024&V.flags){for(;xt<16;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}V.length=It,V.head&&(V.head.extra_len=It),512&V.flags&&(vt[0]=255&It,vt[1]=It>>>8&255,V.check=g(V.check,vt,2,0)),It=0,xt=0}else V.head&&(V.head.extra=null);V.mode=6;case 6:if(1024&V.flags&&((Ct=V.length)>pt&&(Ct=pt),Ct&&(V.head&&(it=V.head.extra_len-V.length,V.head.extra||(V.head.extra=new Array(V.head.extra_len)),d.arraySet(V.head.extra,ut,dt,Ct,it)),512&V.flags&&(V.check=g(V.check,ut,Ct,dt)),pt-=Ct,dt+=Ct,V.length-=Ct),V.length))break t;V.length=0,V.mode=7;case 7:if(2048&V.flags){if(pt===0)break t;Ct=0;do it=ut[dt+Ct++],V.head&&it&&V.length<65536&&(V.head.name+=String.fromCharCode(it));while(it&&Ct<pt);if(512&V.flags&&(V.check=g(V.check,ut,Ct,dt)),pt-=Ct,dt+=Ct,it)break t}else V.head&&(V.head.name=null);V.length=0,V.mode=8;case 8:if(4096&V.flags){if(pt===0)break t;Ct=0;do it=ut[dt+Ct++],V.head&&it&&V.length<65536&&(V.head.comment+=String.fromCharCode(it));while(it&&Ct<pt);if(512&V.flags&&(V.check=g(V.check,ut,Ct,dt)),pt-=Ct,dt+=Ct,it)break t}else V.head&&(V.head.comment=null);V.mode=9;case 9:if(512&V.flags){for(;xt<16;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(It!==(65535&V.check)){at.msg="header crc mismatch",V.mode=Z;break}It=0,xt=0}V.head&&(V.head.hcrc=V.flags>>9&1,V.head.done=!0),at.adler=V.check=0,V.mode=j;break;case 10:for(;xt<32;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}at.adler=V.check=W(It),It=0,xt=0,V.mode=11;case 11:if(V.havedict===0)return at.next_out=ft,at.avail_out=Pt,at.next_in=dt,at.avail_in=pt,V.hold=It,V.bits=xt,2;at.adler=V.check=1,V.mode=j;case j:if(ct===5||ct===6)break t;case 13:if(V.last){It>>>=7&xt,xt-=7&xt,V.mode=27;break}for(;xt<3;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}switch(V.last=1&It,xt-=1,3&(It>>>=1)){case 0:V.mode=14;break;case 1:if(nt(V),V.mode=20,ct===6){It>>>=2,xt-=2;break t}break;case 2:V.mode=17;break;case 3:at.msg="invalid block type",V.mode=Z}It>>>=2,xt-=2;break;case 14:for(It>>>=7&xt,xt-=7&xt;xt<32;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if((65535&It)!=(It>>>16^65535)){at.msg="invalid stored block lengths",V.mode=Z;break}if(V.length=65535&It,It=0,xt=0,V.mode=15,ct===6)break t;case 15:V.mode=16;case 16:if(Ct=V.length){if(Ct>pt&&(Ct=pt),Ct>Pt&&(Ct=Pt),Ct===0)break t;d.arraySet(wt,ut,dt,Ct,ft),pt-=Ct,dt+=Ct,Pt-=Ct,ft+=Ct,V.length-=Ct;break}V.mode=j;break;case 17:for(;xt<14;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(V.nlen=257+(31&It),It>>>=5,xt-=5,V.ndist=1+(31&It),It>>>=5,xt-=5,V.ncode=4+(15&It),It>>>=4,xt-=4,V.nlen>286||V.ndist>30){at.msg="too many length or distance symbols",V.mode=Z;break}V.have=0,V.mode=18;case 18:for(;V.have<V.ncode;){for(;xt<3;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}V.lens[Bt[V.have++]]=7&It,It>>>=3,xt-=3}for(;V.have<19;)V.lens[Bt[V.have++]]=0;if(V.lencode=V.lendyn,V.lenbits=7,mt={bits:V.lenbits},Mt=I(0,V.lens,0,19,V.lencode,0,V.work,mt),V.lenbits=mt.bits,Mt){at.msg="invalid code lengths set",V.mode=Z;break}V.have=0,V.mode=19;case 19:for(;V.have<V.nlen+V.ndist;){for(;At=(_t=V.lencode[It&(1<<V.lenbits)-1])>>>16&255,Nt=65535&_t,!((St=_t>>>24)<=xt);){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(Nt<16)It>>>=St,xt-=St,V.lens[V.have++]=Nt;else{if(Nt===16){for(gt=St+2;xt<gt;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(It>>>=St,xt-=St,V.have===0){at.msg="invalid bit length repeat",V.mode=Z;break}it=V.lens[V.have-1],Ct=3+(3&It),It>>>=2,xt-=2}else if(Nt===17){for(gt=St+3;xt<gt;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}xt-=St,it=0,Ct=3+(7&(It>>>=St)),It>>>=3,xt-=3}else{for(gt=St+7;xt<gt;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}xt-=St,it=0,Ct=11+(127&(It>>>=St)),It>>>=7,xt-=7}if(V.have+Ct>V.nlen+V.ndist){at.msg="invalid bit length repeat",V.mode=Z;break}for(;Ct--;)V.lens[V.have++]=it}}if(V.mode===Z)break;if(V.lens[256]===0){at.msg="invalid code -- missing end-of-block",V.mode=Z;break}if(V.lenbits=9,mt={bits:V.lenbits},Mt=I(P,V.lens,0,V.nlen,V.lencode,0,V.work,mt),V.lenbits=mt.bits,Mt){at.msg="invalid literal/lengths set",V.mode=Z;break}if(V.distbits=6,V.distcode=V.distdyn,mt={bits:V.distbits},Mt=I(F,V.lens,V.nlen,V.ndist,V.distcode,0,V.work,mt),V.distbits=mt.bits,Mt){at.msg="invalid distances set",V.mode=Z;break}if(V.mode=20,ct===6)break t;case 20:V.mode=21;case 21:if(pt>=6&&Pt>=258){at.next_out=ft,at.avail_out=Pt,at.next_in=dt,at.avail_in=pt,V.hold=It,V.bits=xt,w(at,Et),ft=at.next_out,wt=at.output,Pt=at.avail_out,dt=at.next_in,ut=at.input,pt=at.avail_in,It=V.hold,xt=V.bits,V.mode===j&&(V.back=-1);break}for(V.back=0;At=(_t=V.lencode[It&(1<<V.lenbits)-1])>>>16&255,Nt=65535&_t,!((St=_t>>>24)<=xt);){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(At&&!(240&At)){for(Ut=St,jt=At,Tt=Nt;At=(_t=V.lencode[Tt+((It&(1<<Ut+jt)-1)>>Ut)])>>>16&255,Nt=65535&_t,!(Ut+(St=_t>>>24)<=xt);){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}It>>>=Ut,xt-=Ut,V.back+=Ut}if(It>>>=St,xt-=St,V.back+=St,V.length=Nt,At===0){V.mode=26;break}if(32&At){V.back=-1,V.mode=j;break}if(64&At){at.msg="invalid literal/length code",V.mode=Z;break}V.extra=15&At,V.mode=22;case 22:if(V.extra){for(gt=V.extra;xt<gt;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}V.length+=It&(1<<V.extra)-1,It>>>=V.extra,xt-=V.extra,V.back+=V.extra}V.was=V.length,V.mode=23;case 23:for(;At=(_t=V.distcode[It&(1<<V.distbits)-1])>>>16&255,Nt=65535&_t,!((St=_t>>>24)<=xt);){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(!(240&At)){for(Ut=St,jt=At,Tt=Nt;At=(_t=V.distcode[Tt+((It&(1<<Ut+jt)-1)>>Ut)])>>>16&255,Nt=65535&_t,!(Ut+(St=_t>>>24)<=xt);){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}It>>>=Ut,xt-=Ut,V.back+=Ut}if(It>>>=St,xt-=St,V.back+=St,64&At){at.msg="invalid distance code",V.mode=Z;break}V.offset=Nt,V.extra=15&At,V.mode=24;case 24:if(V.extra){for(gt=V.extra;xt<gt;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}V.offset+=It&(1<<V.extra)-1,It>>>=V.extra,xt-=V.extra,V.back+=V.extra}if(V.offset>V.dmax){at.msg="invalid distance too far back",V.mode=Z;break}V.mode=25;case 25:if(Pt===0)break t;if(Ct=Et-Pt,V.offset>Ct){if((Ct=V.offset-Ct)>V.whave&&V.sane){at.msg="invalid distance too far back",V.mode=Z;break}Ct>V.wnext?(Ct-=V.wnext,Ot=V.wsize-Ct):Ot=V.wnext-Ct,Ct>V.length&&(Ct=V.length),Rt=V.window}else Rt=wt,Ot=ft-V.offset,Ct=V.length;Ct>Pt&&(Ct=Pt),Pt-=Ct,V.length-=Ct;do wt[ft++]=Rt[Ot++];while(--Ct);V.length===0&&(V.mode=21);break;case 26:if(Pt===0)break t;wt[ft++]=V.length,Pt--,V.mode=21;break;case 27:if(V.wrap){for(;xt<32;){if(pt===0)break t;pt--,It|=ut[dt++]<<xt,xt+=8}if(Et-=Pt,at.total_out+=Et,V.total+=Et,Et&&(at.adler=V.check=V.flags?g(V.check,wt,Et,ft-Et):m(V.check,wt,Et,ft-Et)),Et=Pt,(V.flags?It:W(It))!==V.check){at.msg="incorrect data check",V.mode=Z;break}It=0,xt=0}V.mode=28;case 28:if(V.wrap&&V.flags){for(;xt<32;){if(pt===0)break t;pt--,It+=ut[dt++]<<xt,xt+=8}if(It!==(4294967295&V.total)){at.msg="incorrect length check",V.mode=Z;break}It=0,xt=0}V.mode=29;case 29:Mt=1;break t;case Z:Mt=-3;break t;case 31:return-4;default:return $}return at.next_out=ft,at.avail_out=Pt,at.next_in=dt,at.avail_in=pt,V.hold=It,V.bits=xt,(V.wsize||Et!==at.avail_out&&V.mode<Z&&(V.mode<27||ct!==4))&&lt(at,at.output,at.next_out,Et-at.avail_out),Ft-=at.avail_in,Et-=at.avail_out,at.total_in+=Ft,at.total_out+=Et,V.total+=Et,V.wrap&&Et&&(at.adler=V.check=V.flags?g(V.check,wt,Et,at.next_out-Et):m(V.check,wt,Et,at.next_out-Et)),at.data_type=V.bits+(V.last?64:0)+(V.mode===j?128:0)+(V.mode===20||V.mode===15?256:0),(Ft===0&&Et===0||ct===4)&&Mt===D&&(Mt=-5),Mt},inflate.inflateEnd=function(at){if(!at||!at.state)return $;var ct=at.state;return ct.window&&(ct.window=null),at.state=null,D},inflate.inflateGetHeader=function(at,ct){var V;return at&&at.state&&2&(V=at.state).wrap?(V.head=ct,ct.done=!1,D):$},inflate.inflateSetDictionary=function(at,ct){var V,ut=ct.length;return at&&at.state?(V=at.state).wrap!==0&&V.mode!==11?$:V.mode===11&&m(1,ct,ut,0)!==V.check?-3:lt(at,ct,ut,ut)?(V.mode=31,-4):(V.havedict=1,D):$},inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}function requireConstants(){return hasRequiredConstants?constants:(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function requireGzheader(){return hasRequiredGzheader?gzheader:(hasRequiredGzheader=1,gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1})}function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;var d=requireInflate$1(),m=requireCommon(),g=requireStrings(),w=requireConstants(),I=requireMessages(),P=requireZstream(),F=requireGzheader(),D=Object.prototype.toString;function $(j){if(!(this instanceof $))return new $(j);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},j||{});var Z=this.options;Z.raw&&Z.windowBits>=0&&Z.windowBits<16&&(Z.windowBits=-Z.windowBits,Z.windowBits===0&&(Z.windowBits=-15)),!(Z.windowBits>=0&&Z.windowBits<16)||j&&j.windowBits||(Z.windowBits+=32),Z.windowBits>15&&Z.windowBits<48&&(15&Z.windowBits||(Z.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var G=d.inflateInit2(this.strm,Z.windowBits);if(G!==w.Z_OK)throw new Error(I[G]);if(this.header=new F,d.inflateGetHeader(this.strm,this.header),Z.dictionary&&(typeof Z.dictionary=="string"?Z.dictionary=g.string2buf(Z.dictionary):D.call(Z.dictionary)==="[object ArrayBuffer]"&&(Z.dictionary=new Uint8Array(Z.dictionary)),Z.raw&&(G=d.inflateSetDictionary(this.strm,Z.dictionary))!==w.Z_OK))throw new Error(I[G])}function U(j,Z){var G=new $(Z);if(G.push(j,!0),G.err)throw G.msg||I[G.err];return G.result}return $.prototype.push=function(j,Z){var G,H,W,Q,q,rt=this.strm,et=this.options.chunkSize,X=this.options.dictionary,J=!1;if(this.ended)return!1;H=Z===~~Z?Z:Z===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof j=="string"?rt.input=g.binstring2buf(j):D.call(j)==="[object ArrayBuffer]"?rt.input=new Uint8Array(j):rt.input=j,rt.next_in=0,rt.avail_in=rt.input.length;do{if(rt.avail_out===0&&(rt.output=new m.Buf8(et),rt.next_out=0,rt.avail_out=et),(G=d.inflate(rt,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&X&&(G=d.inflateSetDictionary(this.strm,X)),G===w.Z_BUF_ERROR&&J===!0&&(G=w.Z_OK,J=!1),G!==w.Z_STREAM_END&&G!==w.Z_OK)return this.onEnd(G),this.ended=!0,!1;rt.next_out&&(rt.avail_out!==0&&G!==w.Z_STREAM_END&&(rt.avail_in!==0||H!==w.Z_FINISH&&H!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(W=g.utf8border(rt.output,rt.next_out),Q=rt.next_out-W,q=g.buf2string(rt.output,W),rt.next_out=Q,rt.avail_out=et-Q,Q&&m.arraySet(rt.output,rt.output,W,Q,0),this.onData(q)):this.onData(m.shrinkBuf(rt.output,rt.next_out)))),rt.avail_in===0&&rt.avail_out===0&&(J=!0)}while((rt.avail_in>0||rt.avail_out===0)&&G!==w.Z_STREAM_END);return G===w.Z_STREAM_END&&(H=w.Z_FINISH),H===w.Z_FINISH?(G=d.inflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===w.Z_OK):H!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),rt.avail_out=0,!0)},$.prototype.onData=function(j){this.chunks.push(j)},$.prototype.onEnd=function(j){j===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=j,this.msg=this.strm.msg},inflate$1.Inflate=$,inflate$1.inflate=U,inflate$1.inflateRaw=function(j,Z){return(Z=Z||{}).raw=!0,U(j,Z)},inflate$1.ungzip=U,inflate$1}function requirePako(){if(hasRequiredPako)return pako_1;hasRequiredPako=1;var d={};return(0,requireCommon().assign)(d,requireDeflate(),requireInflate(),requireConstants()),pako_1=d}(function(d){(function(){var m={};function g(){typeof process<"u"||console.log.apply(console,arguments)}d.exports=m,(function(w,I){(function(){var P=(function(){function $(U){this.message="JPEG error: "+U}return $.prototype=new Error,$.prototype.name="JpegError",$.constructor=$,$})(),F=(function(){var $=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),U=4017,j=799,Z=3406,G=2276,H=1567,W=3784,Q=5793,q=2896;function rt(lt){lt==null&&(lt={}),lt.w==null&&(lt.w=-1),this.V=lt.n,this.N=lt.w}function et(lt,at){for(var ct,V,ut,wt=0,dt=[],ft=16;ft>0&&!lt[ft-1];)ft--;dt.push({children:[],index:0});var pt=dt[0];for(ct=0;ct<ft;ct++){for(V=0;V<lt[ct];V++){for((pt=dt.pop()).children[pt.index]=at[wt];pt.index>0;)pt=dt.pop();for(pt.index++,dt.push(pt);dt.length<=ct;)dt.push(ut={children:[],index:0}),pt.children[pt.index]=ut.children,pt=ut;wt++}ct+1<ft&&(dt.push(ut={children:[],index:0}),pt.children[pt.index]=ut.children,pt=ut)}return dt[0].children}function X(lt,at,ct){return 64*((lt.P+1)*at+ct)}function J(lt,at,ct,V,ut,wt,dt,ft,pt,Pt){Pt==null&&(Pt=!1);var It,xt,Ft,Et,Ct,Ot,Rt,St,At,Nt,Ut,jt=ct.m,Tt=ct.Z,it=at,Mt=0,mt=0,gt=0,_t=0,vt=0,Bt=0;function K(){if(mt>0)return mt--,Mt>>mt&1;if((Mt=lt[at++])===255){var Vt=lt[at++];if(Vt){if(Vt===220&&Pt){var ee=D(lt,at+=2);if(at+=2,ee>0&&ee!==ct.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",ee)}else if(Vt===217){if(Pt){var Xt=8*vt;if(Xt>0&&Xt<ct.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",Xt)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new P("unexpected marker")}}return mt=7,Mt>>>7}function ot(Vt){for(var ee=Vt;;){switch(typeof(ee=ee[K()])){case"number":return ee;case"object":continue}throw new P("invalid huffman sequence")}}function bt(Vt){for(var ee=0;Vt>0;)ee=ee<<1|K(),Vt--;return ee}function yt(Vt){if(Vt===1)return K()===1?1:-1;var ee=bt(Vt);return ee>=1<<Vt-1?ee:ee+(-1<<Vt)+1}function $t(Vt,ee,Xt,oe,ne){var ae=Xt%jt;vt=(Xt/jt|0)*Vt.A+oe;var he=ae*Vt.h+ne;ee(Vt,X(Vt,vt,he))}function Zt(Vt,ee,Xt){vt=Xt/Vt.P|0;var oe=Xt%Vt.P;ee(Vt,X(Vt,vt,oe))}var Kt=V.length;for(Rt=Tt?wt===0?ft===0?function(Vt,ee){var Xt=ot(Vt.J),oe=Xt===0?0:yt(Xt)<<pt;Vt.D[ee]=Vt.Q+=oe}:function(Vt,ee){Vt.D[ee]|=K()<<pt}:ft===0?function(Vt,ee){if(gt>0)gt--;else for(var Xt=wt,oe=dt;Xt<=oe;){var ne=ot(Vt.i),ae=15&ne,he=ne>>4;if(ae!==0){var ie=$[Xt+=he];Vt.D[ee+ie]=yt(ae)*(1<<pt),Xt++}else{if(he<15){gt=bt(he)+(1<<he)-1;break}Xt+=16}}}:function(Vt,ee){for(var Xt,oe,ne=wt,ae=dt,he=0;ne<=ae;){var ie=ee+$[ne],zt=Vt.D[ie]<0?-1:1;switch(_t){case 0:if(he=(oe=ot(Vt.i))>>4,(Xt=15&oe)==0)he<15?(gt=bt(he)+(1<<he),_t=4):(he=16,_t=1);else{if(Xt!==1)throw new P("invalid ACn encoding");It=yt(Xt),_t=he?2:3}continue;case 1:case 2:Vt.D[ie]?Vt.D[ie]+=zt*(K()<<pt):--he==0&&(_t=_t===2?3:0);break;case 3:Vt.D[ie]?Vt.D[ie]+=zt*(K()<<pt):(Vt.D[ie]=It<<pt,_t=0);break;case 4:Vt.D[ie]&&(Vt.D[ie]+=zt*(K()<<pt))}ne++}_t===4&&--gt==0&&(_t=0)}:function(Vt,ee){var Xt=ot(Vt.J),oe=Xt===0?0:yt(Xt),ne=1;for(Vt.D[ee]=Vt.Q+=oe;ne<64;){var ae=ot(Vt.i),he=15&ae,ie=ae>>4;if(he!==0){var zt=$[ne+=ie];Vt.D[ee+zt]=yt(he),ne++}else{if(ie<15)break;ne+=16}}},At=Kt===1?V[0].P*V[0].c:jt*ct.R;Bt<=At;){var te=ut?Math.min(At-Bt,ut):At;if(te>0){for(Ft=0;Ft<Kt;Ft++)V[Ft].Q=0;if(gt=0,Kt===1)for(xt=V[0],Ot=0;Ot<te;Ot++)Zt(xt,Rt,Bt),Bt++;else for(Ot=0;Ot<te;Ot++){for(Ft=0;Ft<Kt;Ft++)for(Nt=(xt=V[Ft]).h,Ut=xt.A,Et=0;Et<Ut;Et++)for(Ct=0;Ct<Nt;Ct++)$t(xt,Rt,Bt,Et,Ct);Bt++}}if(mt=0,!(St=nt(lt,at))||(St.u&&(at=St.offset),!(St.M>=65488&&St.M<=65495)))break;at+=2}return at-it}function tt(lt,at,ct){var V,ut,wt,dt,ft,pt,Pt,It,xt,Ft,Et,Ct,Ot,Rt,St,At,Nt,Ut=lt.$,jt=lt.D;if(!Ut)throw new P("missing required Quantization Table.");for(var Tt=0;Tt<64;Tt+=8)xt=jt[at+Tt],Ft=jt[at+Tt+1],Et=jt[at+Tt+2],Ct=jt[at+Tt+3],Ot=jt[at+Tt+4],Rt=jt[at+Tt+5],St=jt[at+Tt+6],At=jt[at+Tt+7],xt*=Ut[Tt],Ft|Et|Ct|Ot|Rt|St|At?(Ft*=Ut[Tt+1],Et*=Ut[Tt+2],Ct*=Ut[Tt+3],Ot*=Ut[Tt+4],Rt*=Ut[Tt+5],St*=Ut[Tt+6],At*=Ut[Tt+7],ut=(V=(V=Q*xt+128>>8)+(ut=Q*Ot+128>>8)+1>>1)-ut,Nt=(wt=Et)*W+(dt=St)*H+128>>8,wt=wt*H-dt*W+128>>8,Pt=(ft=(ft=q*(Ft-At)+128>>8)+(Pt=Rt<<4)+1>>1)-Pt,pt=(It=(It=q*(Ft+At)+128>>8)+(pt=Ct<<4)+1>>1)-pt,dt=(V=V+(dt=Nt)+1>>1)-dt,wt=(ut=ut+wt+1>>1)-wt,Nt=ft*G+It*Z+2048>>12,ft=ft*Z-It*G+2048>>12,It=Nt,Nt=pt*j+Pt*U+2048>>12,pt=pt*U-Pt*j+2048>>12,Pt=Nt,ct[Tt]=V+It,ct[Tt+7]=V-It,ct[Tt+1]=ut+Pt,ct[Tt+6]=ut-Pt,ct[Tt+2]=wt+pt,ct[Tt+5]=wt-pt,ct[Tt+3]=dt+ft,ct[Tt+4]=dt-ft):(Nt=Q*xt+512>>10,ct[Tt]=Nt,ct[Tt+1]=Nt,ct[Tt+2]=Nt,ct[Tt+3]=Nt,ct[Tt+4]=Nt,ct[Tt+5]=Nt,ct[Tt+6]=Nt,ct[Tt+7]=Nt);for(var it=0;it<8;++it)xt=ct[it],(Ft=ct[it+8])|(Et=ct[it+16])|(Ct=ct[it+24])|(Ot=ct[it+32])|(Rt=ct[it+40])|(St=ct[it+48])|(At=ct[it+56])?(ut=(V=4112+((V=Q*xt+2048>>12)+(ut=Q*Ot+2048>>12)+1>>1))-ut,Nt=(wt=Et)*W+(dt=St)*H+2048>>12,wt=wt*H-dt*W+2048>>12,dt=Nt,Pt=(ft=(ft=q*(Ft-At)+2048>>12)+(Pt=Rt)+1>>1)-Pt,pt=(It=(It=q*(Ft+At)+2048>>12)+(pt=Ct)+1>>1)-pt,Nt=ft*G+It*Z+2048>>12,ft=ft*Z-It*G+2048>>12,It=Nt,Nt=pt*j+Pt*U+2048>>12,pt=pt*U-Pt*j+2048>>12,(xt=(V=V+dt+1>>1)+It)<16?xt=0:xt>=4080?xt=255:xt>>=4,(Ft=(ut=ut+wt+1>>1)+(Pt=Nt))<16?Ft=0:Ft>=4080?Ft=255:Ft>>=4,(Et=(wt=ut-wt)+pt)<16?Et=0:Et>=4080?Et=255:Et>>=4,(Ct=(dt=V-dt)+ft)<16?Ct=0:Ct>=4080?Ct=255:Ct>>=4,(Ot=dt-ft)<16?Ot=0:Ot>=4080?Ot=255:Ot>>=4,(Rt=wt-pt)<16?Rt=0:Rt>=4080?Rt=255:Rt>>=4,(St=ut-Pt)<16?St=0:St>=4080?St=255:St>>=4,(At=V-It)<16?At=0:At>=4080?At=255:At>>=4,jt[at+it]=xt,jt[at+it+8]=Ft,jt[at+it+16]=Et,jt[at+it+24]=Ct,jt[at+it+32]=Ot,jt[at+it+40]=Rt,jt[at+it+48]=St,jt[at+it+56]=At):(Nt=(Nt=Q*xt+8192>>14)<-2040?0:Nt>=2024?255:Nt+2056>>4,jt[at+it]=Nt,jt[at+it+8]=Nt,jt[at+it+16]=Nt,jt[at+it+24]=Nt,jt[at+it+32]=Nt,jt[at+it+40]=Nt,jt[at+it+48]=Nt,jt[at+it+56]=Nt)}function st(lt,at){for(var ct=at.P,V=at.c,ut=new Int16Array(64),wt=0;wt<V;wt++)for(var dt=0;dt<ct;dt++)tt(at,X(at,wt,dt),ut);return at.D}function nt(lt,at,ct){ct==null&&(ct=at);var V=lt.length-1,ut=ct<at?ct:at;if(at>=V)return null;var wt=D(lt,at);if(wt>=65472&&wt<=65534)return{u:null,M:wt,offset:at};for(var dt=D(lt,ut);!(dt>=65472&&dt<=65534);){if(++ut>=V)return null;dt=D(lt,ut)}return{u:wt.toString(16),M:dt,offset:ut}}return rt.prototype={parse(lt,at){at==null&&(at={});var ct,V,ut=at.F,wt=0,dt=null,ft=null,pt=0;function Pt(){var Lt=D(lt,wt),Qt=(wt+=2)+Lt-2,kt=nt(lt,Qt,wt);kt&&kt.u&&(Qt=kt.offset);var Yt=lt.subarray(wt,Qt);return wt+=Yt.length,Yt}function It(Lt){for(var Qt=Math.ceil(Lt.o/8/Lt.X),kt=Math.ceil(Lt.s/8/Lt.B),Yt=0;Yt<Lt.W.length;Yt++){Zt=Lt.W[Yt];var ue=Math.ceil(Math.ceil(Lt.o/8)*Zt.h/Lt.X),ht=Math.ceil(Math.ceil(Lt.s/8)*Zt.A/Lt.B),qt=Qt*Zt.h,Gt=64*(kt*Zt.A)*(qt+1);Zt.D=new Int16Array(Gt),Zt.P=ue,Zt.c=ht}Lt.m=Qt,Lt.R=kt}var xt=[],Ft=[],Et=[],Ct=D(lt,wt);if(wt+=2,Ct!==65496)throw new P("SOI not found");Ct=D(lt,wt),wt+=2;t:for(;Ct!==65497;){var Ot,Rt,St;switch(Ct){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var At=Pt();Ct===65504&&At[0]===74&&At[1]===70&&At[2]===73&&At[3]===70&&At[4]===0&&(dt={version:{d:At[5],T:At[6]},K:At[7],j:At[8]<<8|At[9],H:At[10]<<8|At[11],S:At[12],I:At[13],C:At.subarray(14,14+3*At[12]*At[13])}),Ct===65518&&At[0]===65&&At[1]===100&&At[2]===111&&At[3]===98&&At[4]===101&&(ft={version:At[5]<<8|At[6],k:At[7]<<8|At[8],q:At[9]<<8|At[10],a:At[11]});break;case 65499:for(var Nt=D(lt,wt)+(wt+=2)-2;wt<Nt;){var Ut=lt[wt++],jt=new Uint16Array(64);if(Ut>>4){if(Ut>>4!=1)throw new P("DQT - invalid table spec");for(Rt=0;Rt<64;Rt++)jt[$[Rt]]=D(lt,wt),wt+=2}else for(Rt=0;Rt<64;Rt++)jt[$[Rt]]=lt[wt++];xt[15&Ut]=jt}break;case 65472:case 65473:case 65474:if(ct)throw new P("Only single frame JPEGs supported");wt+=2,(ct={}).G=Ct===65473,ct.Z=Ct===65474,ct.precision=lt[wt++];var Tt,it=D(lt,wt),Mt=0,mt=0;wt+=2,ct.s=ut||it,ct.o=D(lt,wt),wt+=2,ct.W=[],ct._={};var gt=lt[wt++];for(Ot=0;Ot<gt;Ot++){Tt=lt[wt];var _t=lt[wt+1]>>4,vt=15&lt[wt+1];Mt<_t&&(Mt=_t),mt<vt&&(mt=vt);var Bt=lt[wt+2];St=ct.W.push({h:_t,A:vt,L:Bt,$:null}),ct._[Tt]=St-1,wt+=3}ct.X=Mt,ct.B=mt,It(ct);break;case 65476:var K=D(lt,wt);for(wt+=2,Ot=2;Ot<K;){var ot=lt[wt++],bt=new Uint8Array(16),yt=0;for(Rt=0;Rt<16;Rt++,wt++)yt+=bt[Rt]=lt[wt];var $t=new Uint8Array(yt);for(Rt=0;Rt<yt;Rt++,wt++)$t[Rt]=lt[wt];Ot+=17+yt,(ot>>4?Ft:Et)[15&ot]=et(bt,$t)}break;case 65501:V=D(lt,wt+=2),wt+=2;break;case 65498:var Zt,Kt=++pt==1&&!ut;wt+=2;var te=lt[wt++],Vt=[];for(Ot=0;Ot<te;Ot++){var ee=lt[wt++],Xt=ct._[ee];(Zt=ct.W[Xt]).index=ee;var oe=lt[wt++];Zt.J=Et[oe>>4],Zt.i=Ft[15&oe],Vt.push(Zt)}var ne=lt[wt++],ae=lt[wt++],he=lt[wt++];try{var ie=J(lt,wt,ct,Vt,V,ne,ae,he>>4,15&he,Kt);wt+=ie}catch(Lt){if(Lt instanceof DNLMarkerError)return this.parse(lt,{F:Lt.s});if(Lt instanceof EOIMarkerError)break t;throw Lt}break;case 65500:wt+=4;break;case 65535:lt[wt]!==255&&wt--;break;default:var zt=nt(lt,wt-2,wt-3);if(zt&&zt.u){wt=zt.offset;break}if(wt>=lt.length-1)break t;throw new P("JpegImage.parse - unknown marker: "+Ct.toString(16))}Ct=D(lt,wt),wt+=2}for(this.width=ct.o,this.height=ct.s,this.g=dt,this.b=ft,this.W=[],Ot=0;Ot<ct.W.length;Ot++){var Jt=xt[(Zt=ct.W[Ot]).L];Jt&&(Zt.$=Jt),this.W.push({index:Zt.index,e:st(0,Zt),l:Zt.h/ct.X,t:Zt.A/ct.B,P:Zt.P,c:Zt.c})}this.p=this.W.length},Y(lt,at,ct){ct==null&&(ct=!1);var V,ut,wt,dt,ft,pt,Pt,It,xt,Ft,Et,Ct,Ot=this.width/lt,Rt=this.height/at,St=0,At=this.W.length,Nt=lt*at*At,Ut=new Uint8ClampedArray(Nt),jt=new Uint32Array(lt),Tt=4294967288;for(Pt=0;Pt<At;Pt++){if(ut=(V=this.W[Pt]).l*Ot,wt=V.t*Rt,St=Pt,Et=V.e,dt=V.P+1<<3,ut!==Ct){for(ft=0;ft<lt;ft++)It=0|ft*ut,jt[ft]=(It&Tt)<<3|7&It;Ct=ut}for(pt=0;pt<at;pt++)for(Ft=dt*((It=0|pt*wt)&Tt)|(7&It)<<3,ft=0;ft<lt;ft++)Ut[St]=Et[Ft+jt[ft]],St+=At}var it=this.V;if(ct||At!==4||it||(it=new Int32Array([-256,255,-256,255,-256,255,-256,255])),it)for(Pt=0;Pt<Nt;)for(It=0,xt=0;It<At;It++,Pt++,xt+=2)Ut[Pt]=(Ut[Pt]*it[xt]>>8)+it[xt+1];return Ut},get f(){return this.b?!!this.b.a:this.p===3?this.N!==0&&(this.W[0].index!==82||this.W[1].index!==71||this.W[2].index!==66):this.N===1},z:function(lt){for(var at,ct,V,ut=0,wt=lt.length;ut<wt;ut+=3)at=lt[ut],ct=lt[ut+1],V=lt[ut+2],lt[ut]=at-179.456+1.402*V,lt[ut+1]=at+135.459-.344*ct-.714*V,lt[ut+2]=at-226.816+1.772*ct;return lt},O:function(lt){for(var at,ct,V,ut,wt=0,dt=0,ft=lt.length;dt<ft;dt+=4)at=lt[dt],ct=lt[dt+1],V=lt[dt+2],ut=lt[dt+3],lt[wt++]=ct*(-660635669420364e-19*ct+.000437130475926232*V-54080610064599e-18*at+.00048449797120281*ut-.154362151871126)-122.67195406894+V*(-.000957964378445773*V+.000817076911346625*at-.00477271405408747*ut+1.53380253221734)+at*(.000961250184130688*at-.00266257332283933*ut+.48357088451265)+ut*(-.000336197177618394*ut+.484791561490776),lt[wt++]=107.268039397724+ct*(219927104525741e-19*ct-.000640992018297945*V+.000659397001245577*at+.000426105652938837*ut-.176491792462875)+V*(-.000778269941513683*V+.00130872261408275*at+.000770482631801132*ut-.151051492775562)+at*(.00126935368114843*at-.00265090189010898*ut+.25802910206845)+ut*(-.000318913117588328*ut-.213742400323665),lt[wt++]=ct*(-.000570115196973677*ct-263409051004589e-19*V+.0020741088115012*at-.00288260236853442*ut+.814272968359295)-20.810012546947+V*(-153496057440975e-19*V-.000132689043961446*at+.000560833691242812*ut-.195152027534049)+at*(.00174418132927582*at-.00255243321439347*ut+.116935020465145)+ut*(-.000343531996510555*ut+.24165260232407);return lt.subarray(0,wt)},r:function(lt){for(var at,ct,V,ut=0,wt=lt.length;ut<wt;ut+=4)at=lt[ut],ct=lt[ut+1],V=lt[ut+2],lt[ut]=434.456-at-1.402*V,lt[ut+1]=119.541-at+.344*ct+.714*V,lt[ut+2]=481.816-at-1.772*ct;return lt},U:function(lt){for(var at,ct,V,ut,wt=0,dt=0,ft=lt.length;dt<ft;dt+=4)at=lt[dt],ct=lt[dt+1],V=lt[dt+2],ut=lt[dt+3],lt[wt++]=255+at*(-6747147073602441e-20*at+.0008379262121013727*ct+.0002894718188643294*V+.003264231057537806*ut-1.1185611867203937)+ct*(26374107616089405e-21*ct-8626949158638572e-20*V-.0002748769067499491*ut-.02155688794978967)+V*(-3878099212869363e-20*V-.0003267808279485286*ut+.0686742238595345)-ut*(.0003361971776183937*ut+.7430659151342254),lt[wt++]=255+at*(.00013596372813588848*at+.000924537132573585*ct+.00010567359618683593*V+.0004791864687436512*ut-.3109689587515875)+ct*(-.00023545346108370344*ct+.0002702845253534714*V+.0020200308977307156*ut-.7488052167015494)+V*(6834815998235662e-20*V+.00015168452363460973*ut-.09751927774728933)-ut*(.0003189131175883281*ut+.7364883807733168),lt[wt++]=255+at*(13598650411385307e-21*at+.00012423956175490851*ct+.0004751985097583589*V-36729317476630422e-22*ut-.05562186980264034)+ct*(.00016141380598724676*ct+.0009692239130725186*V+.0007782692450036253*ut-.44015232367526463)+V*(5068882914068769e-22*V+.0017778369011375071*ut-.7591454649749609)-ut*(.0003435319965105553*ut+.7063770186160144);return lt.subarray(0,wt)},getData:function(lt){var at=lt.width,ct=lt.height,V=lt.forceRGB,ut=lt.isSourcePDF;if(this.p>4)throw new P("Unsupported color mode");var wt=this.Y(at,ct,ut);if(this.p===1&&V){for(var dt=wt.length,ft=new Uint8ClampedArray(3*dt),pt=0,Pt=0;Pt<dt;Pt++){var It=wt[Pt];ft[pt++]=It,ft[pt++]=It,ft[pt++]=It}return ft}if(this.p===3&&this.f)return this.z(wt);if(this.p===4){if(this.f)return V?this.O(wt):this.r(wt);if(V)return this.U(wt)}return wt}},rt})();function D($,U){return $[U]<<8|$[U+1]}w.JpegDecoder=F})(),w.encodeImage=function(P,F,D,$){var U={t256:[F],t257:[D],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[D],t279:[F*D*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if($)for(var j in $)U[j]=$[j];var Z=new Uint8Array(w.encode([U])),G=new Uint8Array(P),H=new Uint8Array(1e3+F*D*4);for(j=0;j<Z.length;j++)H[j]=Z[j];for(j=0;j<G.length;j++)H[1e3+j]=G[j];return H.buffer},w.encode=function(P){var F=new Uint8Array(2e4),D=4,$=w._binBE;F[0]=F[1]=77,$.writeUshort(F,2,42);var U=8;$.writeUint(F,D,U),D+=4;for(var j=0;j<P.length;j++){var Z=w._writeIFD($,w._types.basic,F,U,P[j]);U=Z[1],j<P.length-1&&(3&U&&(U+=4-(3&U)),$.writeUint(F,Z[0],U))}return F.slice(0,U).buffer},w.decode=function(P,F){F==null&&(F={parseMN:!0,debug:!1});var D=new Uint8Array(P),$=0,U=w._binBE.readASCII(D,$,2);$+=2;var j=U=="II"?w._binLE:w._binBE;j.readUshort(D,$),$+=2;var Z=j.readUint(D,$);$+=4;for(var G=[];;){var H=j.readUshort(D,Z),W=j.readUshort(D,Z+4);if(H!=0&&(W<1||13<W)){g("error in TIFF");break}if(w._readIFD(j,D,Z,G,0,F),(Z=j.readUint(D,Z+2+12*H))==0)break}return G},w.decodeImage=function(P,F,D){if(!F.data){var $=new Uint8Array(P),U=w._binBE.readASCII($,0,2);if(F.t256!=null){F.isLE=U=="II",F.width=F.t256[0],F.height=F.t257[0];var j=F.t259?F.t259[0]:1,Z=F.t266?F.t266[0]:1;F.t284&&F.t284[0]==2&&g("PlanarConfiguration 2 should not be used!"),j==7&&F.t258&&F.t258.length>3&&(F.t258=F.t258.slice(0,3));var G=F.t277?F.t277[0]:1,H=(F.t258?F.t258[0]:1)*G;j==1&&F.t279!=null&&F.t278&&F.t262[0]==32803&&(H=Math.round(8*F.t279[0]/(F.width*F.t278[0]))),F.t50885&&F.t50885[0]==4&&(H=3*F.t258[0]);var W=8*Math.ceil(F.width*H/8),Q=F.t273;(Q==null||F.t322)&&(Q=F.t324);var q=F.t279;j==1&&Q.length==1&&(q=[F.height*(W>>>3)]),(q==null||F.t322)&&(q=F.t325);var rt=new Uint8Array(F.height*(W>>>3)),et=0;if(F.t322!=null){var X=F.t322[0],J=F.t323[0],tt=Math.floor((F.width+X-1)/X),st=Math.floor((F.height+J-1)/J),nt=new Uint8Array(0|Math.ceil(X*J*H/8));console.log("====",tt,st);for(var lt=0;lt<st;lt++)for(var at=0;at<tt;at++){var ct=lt*tt+at;nt.fill(0),w.decode._decompress(F,D,$,Q[ct],q[ct],j,nt,0,Z,X,J),j==6?rt=nt:w._copyTile(nt,0|Math.ceil(X*H/8),J,rt,0|Math.ceil(F.width*H/8),F.height,0|Math.ceil(at*X*H/8),lt*J)}et=8*rt.length}else{if(Q==null)return;var V=F.t278?F.t278[0]:F.height;for(V=Math.min(V,F.height),ct=0;ct<Q.length;ct++)w.decode._decompress(F,D,$,Q[ct],q[ct],j,rt,0|Math.ceil(et/8),Z,F.width,V),et+=W*V;et=Math.min(et,8*rt.length)}F.data=new Uint8Array(rt.buffer,0,0|Math.ceil(et/8))}}},w.decode._decompress=function(P,F,D,$,U,j,Z,G,H,W,Q){if(P.t271&&P.t271[0]=="Panasonic"&&P.t45&&P.t45[0]==6&&(j=34316),j==1)for(var q=0;q<U;q++)Z[G+q]=D[$+q];else if(j==2)w.decode._decodeG2(D,$,U,Z,G,W,H);else if(j==3)w.decode._decodeG3(D,$,U,Z,G,W,H,!!P.t292&&!(1&~P.t292[0]));else if(j==4)w.decode._decodeG4(D,$,U,Z,G,W,H);else if(j==5)w.decode._decodeLZW(D,$,U,Z,G,8);else if(j==6)w.decode._decodeOldJPEG(P,D,$,U,Z,G);else if(j==7||j==34892)w.decode._decodeNewJPEG(P,D,$,U,Z,G);else if(j==8||j==32946){var rt=new Uint8Array(D.buffer,$+2,U-6),et=I.inflateRaw(rt);G+et.length<=Z.length&&Z.set(et,G)}else j==9?w.decode._decodeVC5(D,$,U,Z,G,P.t33422):j==32767?w.decode._decodeARW(P,D,$,U,Z,G):j==32773?w.decode._decodePackBits(D,$,U,Z,G):j==32809?w.decode._decodeThunder(D,$,U,Z,G):j==34316?w.decode._decodePanasonic(P,D,$,U,Z,G):j==34713?w.decode._decodeNikon(P,F,D,$,U,Z,G):j==34676?w.decode._decodeLogLuv32(P,D,$,U,Z,G):g("Unknown compression",j);var X=P.t258?Math.min(32,P.t258[0]):1,J=P.t277?P.t277[0]:1,tt=X*J>>>3,st=Math.ceil(X*J*W/8);if(X==16&&!P.isLE&&P.t33422==null)for(var nt=0;nt<Q;nt++)for(var lt=G+nt*st,at=1;at<st;at+=2){var ct=Z[lt+at];Z[lt+at]=Z[lt+at-1],Z[lt+at-1]=ct}if(P.t317&&P.t317[0]==2)for(nt=0;nt<Q;nt++){var V=G+nt*st;if(X==16)for(q=tt;q<st;q+=2){var ut=(Z[V+q+1]<<8|Z[V+q])+(Z[V+q-tt+1]<<8|Z[V+q-tt]);Z[V+q]=255&ut,Z[V+q+1]=ut>>>8&255}else if(J==3)for(q=3;q<st;q+=3)Z[V+q]=Z[V+q]+Z[V+q-3]&255,Z[V+q+1]=Z[V+q+1]+Z[V+q-2]&255,Z[V+q+2]=Z[V+q+2]+Z[V+q-1]&255;else for(q=tt;q<st;q++)Z[V+q]=Z[V+q]+Z[V+q-tt]&255}},w.decode._decodePanasonic=function(P,F,D,$,U,j){var Z,G,H,W,Q,q,rt,et,X=F.buffer,J=P.t2[0],tt=P.t3[0],st=P.t10[0],nt=P.t45[0],lt=0,at=0,ct=0,V=0,ut=nt==6?new Uint32Array(18):new Uint8Array(16),wt=[0,0],dt=[0,0],ft=0,pt=new Uint8Array(16384),Pt=new Uint16Array(U.buffer);function It(Bt){if(ct==0){var K=new Uint8Array(X,D+at+8184,8200),ot=new Uint8Array(X,D+at,8184);pt.set(K),pt.set(ot,K.length),at+=16384}if(nt!=5)return(pt[V=(ct=ct-Bt&131071)>>3^16368]|pt[V+1]<<8)>>(7&ct)&~(-1<<Bt);for(Z=0;Z<16;Z++)ut[Z]=pt[ct++],ct&=16383}function xt(Bt){return pt[ct+15-Bt]}function Ft(){wt[0]=0,wt[1]=0,dt[0]=0,dt[1]=0}if(nt==7)throw nt;if(nt==6){var Et=st==12,Ct=Et?function(){ut[0]=xt(0)<<4|xt(1)>>4,ut[1]=4095&((15&xt(1))<<8|xt(2)),ut[2]=xt(3)>>6&3,ut[3]=(63&xt(3))<<2|xt(4)>>6,ut[4]=(63&xt(4))<<2|xt(5)>>6,ut[5]=(63&xt(5))<<2|xt(6)>>6,ut[6]=xt(6)>>4&3,ut[7]=(15&xt(6))<<4|xt(7)>>4,ut[8]=(15&xt(7))<<4|xt(8)>>4,ut[9]=(15&xt(8))<<4|xt(9)>>4,ut[10]=xt(9)>>2&3,ut[11]=(3&xt(9))<<6|xt(10)>>2,ut[12]=(3&xt(10))<<6|xt(11)>>2,ut[13]=(3&xt(11))<<6|xt(12)>>2,ut[14]=3&xt(12),ut[15]=xt(13),ut[16]=xt(14),ut[17]=xt(15),ct+=16,V=0}:function(){ut[0]=xt(0)<<6|xt(1)>>2,ut[1]=16383&((3&xt(1))<<12|xt(2)<<4|xt(3)>>4),ut[2]=xt(3)>>2&3,ut[3]=(3&xt(3))<<8|xt(4),ut[4]=xt(5)<<2|xt(6)>>6,ut[5]=(63&xt(6))<<4|xt(7)>>4,ut[6]=xt(7)>>2&3,ut[7]=(3&xt(7))<<8|xt(8),ut[8]=xt(9)<<2&1020|xt(10)>>6,ut[9]=1023&(xt(10)<<4|xt(11)>>4),ut[10]=xt(11)>>2&3,ut[11]=(3&xt(11))<<8|xt(12),ut[12]=1023&(xt(13)<<2&1020|xt(14)>>6),ut[13]=1023&(xt(14)<<4|xt(15)>>4),ct+=16,V=0},Ot=Et?14:11,Rt=Et?128:512,St=Et?2048:8192,At=Et?16383:65535,Nt=Et?4095:16383,Ut=J/Ot,jt=16*Ut,Tt=Et?18:14;for(q=0;q<tt-15;q+=16){var it=Math.min(16,tt-q),Mt=jt*it;for(pt=new Uint8Array(X,D+lt,Mt),ct=0,lt+=Mt,et=0,rt=0;et<it;et++,rt=0){ft=(q+et)*J;for(var mt=0;mt<Ut;mt++)for(Ct(),Ft(),H=0,Q=0,Z=0;Z<Ot;Z++){if(W=1&Z,Z%3==2){var gt=V<Tt?ut[V++]:0;gt==3&&(gt=4),Q=Rt<<gt,H=1<<gt}var _t=V<Tt?ut[V++]:0;wt[W]?(_t*=H,Q<St&&dt[W]>Q&&(_t+=dt[W]-Q),dt[W]=_t):(wt[W]=_t,_t?dt[W]=_t:_t=dt[W]),Pt[ft+rt++]=_t-15<=At?_t-15&At:_t+2147483633>>31&Nt}}}}else if(nt==5){var vt=st==12?10:9;for(q=0;q<tt;q++)for(rt=0;rt<J;rt+=vt)It(0),st==12?(Pt[ft++]=((15&ut[1])<<8)+ut[0],Pt[ft++]=16*ut[2]+(ut[1]>>4),Pt[ft++]=((15&ut[4])<<8)+ut[3],Pt[ft++]=16*ut[5]+(ut[4]>>4),Pt[ft++]=((15&ut[7])<<8)+ut[6],Pt[ft++]=16*ut[8]+(ut[7]>>4),Pt[ft++]=((15&ut[10])<<8)+ut[9],Pt[ft++]=16*ut[11]+(ut[10]>>4),Pt[ft++]=((15&ut[13])<<8)+ut[12],Pt[ft++]=16*ut[14]+(ut[13]>>4)):st==14&&(Pt[ft++]=ut[0]+((63&ut[1])<<8),Pt[ft++]=(ut[1]>>6)+4*ut[2]+((15&ut[3])<<10),Pt[ft++]=(ut[3]>>4)+16*ut[4]+((3&ut[5])<<12),Pt[ft++]=((252&ut[5])>>2)+(ut[6]<<6),Pt[ft++]=ut[7]+((63&ut[8])<<8),Pt[ft++]=(ut[8]>>6)+4*ut[9]+((15&ut[10])<<10),Pt[ft++]=(ut[10]>>4)+16*ut[11]+((3&ut[12])<<12),Pt[ft++]=((252&ut[12])>>2)+(ut[13]<<6),Pt[ft++]=ut[14]+((63&ut[15])<<8))}else{if(nt!=4)throw nt;for(q=0;q<tt;q++)for(rt=0;rt<J;rt++)W=1&(Z=rt%14),Z==0&&Ft(),Z%3==2&&(H=4>>3-It(2)),dt[W]?(G=It(8))!=0&&(wt[W]-=128<<H,(wt[W]<0||H==4)&&(wt[W]&=~(-1<<H)),wt[W]+=G<<H):(dt[W]=It(8),(dt[W]||Z>11)&&(wt[W]=dt[W]<<4|It(4))),Pt[ft++]=wt[1&rt]}},w.decode._decodeVC5=(function(){var P,F,D,$=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],U=[3,3,3,3,2,2,2,1,1,1];function j(et){var X=et[1],J=et[0][X>>>3]>>>7-(7&X)&1;return et[1]++,J}function Z(et,X){if(P==null){P={};for(var J=0;J<$.length;J+=4)P[$[J+1]]=$.slice(J,J+4)}for(var tt=j(et),st=P[tt];st==null;)tt=tt<<1|j(et),st=P[tt];var nt=st[3];nt!=0&&(nt=j(et)==0?nt:-nt),X[0]=st[2],X[1]=nt}function G(et,X){for(var J=0;J<X;J++)1&~et||et++,et>>>=1;return et}function H(et,X){return et>>X}function W(et,X,J,tt,st,nt){X[J]=H(H(11*et[st]-4*et[st+nt]+et[st+nt+nt]+4,3)+et[tt],1),X[J+nt]=H(H(5*et[st]+4*et[st+nt]-et[st+nt+nt]+4,3)-et[tt],1)}function Q(et,X,J,tt,st,nt){var lt=et[st-nt]-et[st+nt],at=et[st],ct=et[tt];X[J]=H(H(lt+4,3)+at+ct,1),X[J+nt]=H(H(4-lt,3)+at-ct,1)}function q(et,X,J,tt,st,nt){X[J]=H(H(5*et[st]+4*et[st-nt]-et[st-nt-nt]+4,3)+et[tt],1),X[J+nt]=H(H(11*et[st]-4*et[st-nt]+et[st-nt-nt]+4,3)-et[tt],1)}function rt(et){return et=D[et=et<0?0:et>4095?4095:et]>>>2}return function(et,X,J,tt,st,nt){tt=new Uint16Array(tt.buffer);var lt,at,ct,V,ut,wt,dt,ft,pt=Date.now(),Pt=w._binBE,It=X+J;X+=4;for(var xt=nt[0]==1;X<It;){var Ft=Pt.readShort(et,X),Et=Pt.readUshort(et,X+2);if(X+=4,Ft==12)Ut=Et;else if(Ft==20)lt=Et;else if(Ft==21)at=Et;else if(Ft==48)ct=Et;else if(Ft==53)V=Et;else if(Ft!=35){if(Ft==62)ut=Et;else if(Ft!=101){if(Ft==109)wt=Et;else if(Ft!=84){if(Ft!=106){if(Ft!=107){if(Ft!=108){if(Ft!=102){if(Ft==104)Xt=Et;else if(Ft!=105){var Ct=Ft<0?-Ft:Ft,Ot=65280&Ct,Rt=0;if(24576&Ct&&(8192&Ct?(Rt=65535&Et,Rt+=(255&Ct)<<16):Rt=65535&Et),24576&~Ct){if(Ct==16388)X+=4*Rt;else if(Ot!=8192&&Ot!=8448&&Ot!=9216)throw Ct.toString(16)}else{if(dt==null){dt=[];for(var St=0;St<4;St++)dt[St]=new Int16Array((lt>>>1)*(at>>>1));for(ft=new Int16Array((lt>>>1)*(at>>>1)),F=new Int16Array(1024),St=0;St<1024;St++){var At=St-512,Nt=Math.abs(At),Ut=Math.floor(768*Nt*Nt*Nt/16581375)+Nt;F[St]=Math.sign(At)*Ut}for(D=new Uint16Array(4096),St=0;St<4096;St++){var jt=St,Tt=65535*(Math.pow(113,jt/4095)-1)/112;D[St]=Math.min(Tt,65535)}}var it=dt[ut],Mt=G(lt,1+U[ct]),mt=G(at,1+U[ct]);if(ct==0)for(var gt=0;gt<mt;gt++)for(var _t=0;_t<Mt;_t++){var vt=X+2*(gt*Mt+_t);it[gt*(lt>>>1)+_t]=et[vt]<<8|et[vt+1]}else{var Bt=[et,8*X],K=[],ot=0,bt=Mt*mt,yt=[0,0],$t=0;for(Et=0;ot<bt;)for(Z(Bt,yt),$t=yt[0],Et=yt[1];$t>0;)K[ot++]=Et,$t--;var Zt=(ct-1)%3,Kt=Zt!=1?Mt:0,te=Zt!=0?mt:0;for(gt=0;gt<mt;gt++){var Vt=(gt+te)*(lt>>>1)+Kt,ee=gt*Mt;for(_t=0;_t<Mt;_t++)it[Vt+_t]=F[K[ee+_t]+512]*V}if(Zt==2){var Xt=lt>>>1,oe=2*Mt,ne=2*mt;for(gt=0;gt<mt;gt++)for(_t=0;_t<oe;_t++){St=2*gt*Xt+_t;var ae=mt*Xt+(ie=gt*Xt+_t);gt==0?W(it,ft,St,ae,ie,Xt):gt==mt-1?q(it,ft,St,ae,ie,Xt):Q(it,ft,St,ae,ie,Xt)}var he=it;for(it=ft,ft=he,gt=0;gt<ne;gt++)for(_t=0;_t<Mt;_t++){var ie;St=gt*Xt+2*_t,ae=Mt+(ie=gt*Xt+_t),_t==0?W(it,ft,St,ae,ie,1):_t==Mt-1?q(it,ft,St,ae,ie,1):Q(it,ft,St,ae,ie,1)}he=it,it=ft,ft=he;for(var zt=[],Jt=2-~~((ct-1)/3),Lt=0;Lt<3;Lt++)zt[Lt]=wt>>14-2*Lt&3;var Qt=zt[Jt];if(Qt!=0)for(gt=0;gt<ne;gt++)for(_t=0;_t<oe;_t++)it[St=gt*Xt+_t]=it[St]<<Qt}}if(ct==9&&ut==3){var kt=dt[0],Yt=dt[1],ue=dt[2],ht=dt[3];for(gt=0;gt<at;gt+=2)for(_t=0;_t<lt;_t+=2){var qt=gt*lt+_t,Gt=kt[vt=(gt>>>1)*(lt>>>1)+(_t>>>1)],Dt=Yt[vt]-2048,Ht=ue[vt]-2048,Wt=ht[vt]-2048,le=(Dt<<1)+Gt,re=(Ht<<1)+Gt,se=Gt+Wt,ce=Gt-Wt;xt?(tt[qt]=rt(se),tt[qt+1]=rt(re),tt[qt+lt]=rt(le),tt[qt+lt+1]=rt(ce)):(tt[qt]=rt(le),tt[qt+1]=rt(se),tt[qt+lt]=rt(ce),tt[qt+lt+1]=rt(re))}}X+=4*Rt}}}}}}}}}}console.log(Date.now()-pt)}})(),w.decode._decodeLogLuv32=function(P,F,D,$,U,j){for(var Z=P.width,G=4*Z,H=0,W=new Uint8Array(G);H<$;){for(var Q=0;Q<G;){var q=F[D+H];if(H++,q<128){for(var rt=0;rt<q;rt++)W[Q+rt]=F[D+H+rt];Q+=q,H+=q}else{for(q-=126,rt=0;rt<q;rt++)W[Q+rt]=F[D+H];Q+=q,H++}}for(var et=0;et<Z;et++)U[j+0]=W[et],U[j+1]=W[et+Z],U[j+2]=W[et+2*Z],U[j+4]=W[et+3*Z],j+=6}},w.decode._ljpeg_diff=function(P,F,D){var $,U,j=w.decode._getbithuff;return $=j(P,F,D[0],D),(U=j(P,F,$,0))&1<<$-1||(U-=(1<<$)-1),U},w.decode._decodeARW=function(P,F,D,$,U,j){var Z=P.t256[0],G=P.t257[0],H=P.t258[0],W=P.isLE?w._binLE:w._binBE;if(Z*G==$||Z*G*1.5==$)if(Z*G*1.5!=$){var Q,q,rt,et,X,J,tt,st,nt=new Uint16Array(16),lt=new Uint8Array(Z+1);for(pt=0;pt<G;pt++){for(var at=0;at<Z;at++)lt[at]=F[D++];for(st=0,ft=0;ft<Z-30;st+=16){for(q=2047&(Q=W.readUint(lt,st)),rt=2047&Q>>>11,et=15&Q>>>22,X=15&Q>>>26,J=0;J<4&&128<<J<=q-rt;J++);for(tt=30,ct=0;ct<16;ct++)ct==et?nt[ct]=q:ct==X?nt[ct]=rt:(nt[ct]=((W.readUshort(lt,st+(tt>>3))>>>(7&tt)&127)<<J)+rt,nt[ct]>2047&&(nt[ct]=2047),tt+=7);for(ct=0;ct<16;ct++,ft+=2)Rt=nt[ct]<<1,w.decode._putsF(U,(pt*Z+ft)*H,Rt<<16-H);ft-=1&ft?1:31}}}else for(var ct=0;ct<$;ct+=3){var V=F[D+ct+0],ut=F[D+ct+1],wt=F[D+ct+2];U[j+ct]=ut<<4|V>>>4,U[j+ct+1]=V<<4|wt>>>4,U[j+ct+2]=wt<<4|ut>>>4}else{G+=8;var dt,ft,pt,Pt=[D,0,0,0],It=new Uint16Array(32770),xt=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],Ft=0,Et=w.decode._ljpeg_diff;for(It[0]=15,dt=ct=0;ct<18;ct++)for(var Ct=32768>>>(xt[ct]>>>8),Ot=0;Ot<Ct;Ot++)It[++dt]=xt[ct];for(ft=Z;ft--;)for(pt=0;pt<G+1;pt+=2)if(pt==G&&(pt=1),Ft+=Et(F,Pt,It),pt<G){var Rt=4095&Ft;w.decode._putsF(U,(pt*Z+ft)*H,Rt<<16-H)}}},w.decode._decodeNikon=function(P,F,D,$,U,j,Z){var G=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],H=P.t256[0],W=P.t257[0],Q=P.t258[0],q=0,rt=0,et=w.decode._make_decoder,X=w.decode._getbithuff,J=F[0].exifIFD.makerNote,tt=J.t150?J.t150:J.t140,st=0,nt=tt[st++],lt=tt[st++];nt!=73&&lt!=88||(st+=2110),nt==70&&(q=2),Q==14&&(q+=3);for(var at=[[0,0],[0,0]],ct=P.isLE?w._binLE:w._binBE,V=0;V<2;V++)for(var ut=0;ut<2;ut++)at[V][ut]=ct.readShort(tt,st),st+=2;var wt,dt,ft,pt,Pt,It=1<<Q&32767,xt=0,Ft=ct.readShort(tt,st);st+=2,Ft>1&&(xt=Math.floor(It/(Ft-1))),nt==68&&lt==32&&xt>0&&(rt=ct.readShort(tt,562));var Et=[0,0],Ct=et(G[q]),Ot=[$,0,0,0];for(wt=0;wt<W;wt++)for(rt&&wt==rt&&(Ct=et(G[q+1])),dt=0;dt<H;dt++){V=X(D,Ot,Ct[0],Ct),(Pt=1+(X(D,Ot,(ft=15&V)-(pt=V>>>4),0)<<1)<<pt>>>1)&1<<ft-1||(Pt-=(1<<ft)-(pt==0?1:0)),dt<2?Et[dt]=at[1&wt][dt]+=Pt:Et[1&dt]+=Pt;var Rt=Math.min(Math.max(Et[1&dt],0),(1<<Q)-1),St=(wt*H+dt)*Q;w.decode._putsF(j,St,Rt<<16-Q)}},w.decode._putsF=function(P,F,D){D<<=8-(7&F);var $=F>>>3;P[$]|=D>>>16,P[$+1]|=D>>>8,P[$+2]|=D},w.decode._getbithuff=function(P,F,D,$){var U;w.decode._get_byte;var j=F[0],Z=F[1],G=F[2],H=F[3];if(D==0||G<0)return 0;for(;!H&&G<D&&(U=P[j++])!=-1&&!(H=0);)Z=(Z<<8)+U,G+=8;if(U=Z<<32-G>>>32-D,$?(G-=$[U+1]>>>8,U=255&$[U+1]):G-=D,G<0)throw"e";return F[0]=j,F[1]=Z,F[2]=G,F[3]=H,U},w.decode._make_decoder=function(P){var F,D,$,U,j,Z=[];for(F=16;F!=0&&!P[F];F--);var G=17;for(Z[0]=F,$=D=1;D<=F;D++)for(U=0;U<P[D];U++,++G)for(j=0;j<1<<F-D;j++)$<=1<<F&&(Z[$++]=D<<8|P[G]);return Z},w.decode._decodeNewJPEG=function(P,F,D,$,U,j){$=Math.min($,F.length-D);var Z=P.t347,G=Z?Z.length:0,H=new Uint8Array(G+$);if(Z){for(var W=0,Q=0;Q<G-1&&(Z[Q]!=255||Z[Q+1]!=217);Q++)H[W++]=Z[Q];var q=F[D],rt=F[D+1];for(q==255&&rt==216||(H[W++]=q,H[W++]=rt),Q=2;Q<$;Q++)H[W++]=F[D+Q]}else for(Q=0;Q<$;Q++)H[Q]=F[D+Q];if(P.t262[0]==32803||P.t259[0]==7&&P.t262[0]==34892){var et=P.t258[0],X=w.LosslessJpegDecode(H),J=X.length;if(et==16)if(P.isLE)for(Q=0;Q<J;Q++)U[j+(Q<<1)]=255&X[Q],U[j+(Q<<1)+1]=X[Q]>>>8;else for(Q=0;Q<J;Q++)U[j+(Q<<1)]=X[Q]>>>8,U[j+(Q<<1)+1]=255&X[Q];else if(et==14||et==12||et==10){var tt=16-et;for(Q=0;Q<J;Q++)w.decode._putsF(U,Q*et,X[Q]<<tt)}else{if(et!=8)throw new Error("unsupported bit depth "+et);for(Q=0;Q<J;Q++)U[j+Q]=X[Q]}}else{var st=new w.JpegDecoder;st.parse(H);var nt=st.getData({width:st.width,height:st.height,forceRGB:!0,isSourcePDF:!1});for(Q=0;Q<nt.length;Q++)U[j+Q]=nt[Q]}P.t262[0]==6&&(P.t262[0]=2)},w.decode._decodeOldJPEGInit=function(P,F,D,$){var U,j,Z,G,H,W=216,Q=0,q=0,rt=!1,et=P.t513,X=et?et[0]:0,J=P.t514,tt=J?J[0]:0,st=P.t324||P.t273||et,nt=P.t530,lt=0,at=0,ct=P.t277?P.t277[0]:1,V=P.t515;if(st&&(q=st[0],rt=st.length>1),!rt){if(F[D]==255&&F[D+1]==W)return{jpegOffset:D};if(et!=null&&(F[D+X]==255&&F[D+X+1]==W?Q=D+X:g("JPEGInterchangeFormat does not point to SOI"),J==null?g("JPEGInterchangeFormatLength field is missing"):(X>=q||X+tt<=q)&&g("JPEGInterchangeFormatLength field value is invalid"),Q!=null))return{jpegOffset:Q}}if(nt!=null&&(lt=nt[0],at=nt[1]),et!=null&&J!=null)if(tt>=2&&X+tt<=q){for(U=F[D+X+tt-2]==255&&F[D+X+tt-1]==W?new Uint8Array(tt-2):new Uint8Array(tt),Z=0;Z<U.length;Z++)U[Z]=F[D+X+Z];g("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else g("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(U==null){var ut=0,wt=[];wt[ut++]=255,wt[ut++]=W;var dt=P.t519;if(dt==null)throw new Error("JPEGQTables tag is missing");for(Z=0;Z<dt.length;Z++)for(wt[ut++]=255,wt[ut++]=219,wt[ut++]=0,wt[ut++]=67,wt[ut++]=Z,G=0;G<64;G++)wt[ut++]=F[D+dt[Z]+G];for(H=0;H<2;H++){var ft=P[H==0?"t520":"t521"];if(ft==null)throw new Error((H==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(Z=0;Z<ft.length;Z++){wt[ut++]=255,wt[ut++]=196;var pt=19;for(G=0;G<16;G++)pt+=F[D+ft[Z]+G];for(wt[ut++]=pt>>>8,wt[ut++]=255&pt,wt[ut++]=Z|H<<4,G=0;G<16;G++)wt[ut++]=F[D+ft[Z]+G];for(G=0;G<pt;G++)wt[ut++]=F[D+ft[Z]+16+G]}}if(wt[ut++]=255,wt[ut++]=192,wt[ut++]=0,wt[ut++]=8+3*ct,wt[ut++]=8,wt[ut++]=P.height>>>8&255,wt[ut++]=255&P.height,wt[ut++]=P.width>>>8&255,wt[ut++]=255&P.width,wt[ut++]=ct,ct==1)wt[ut++]=1,wt[ut++]=17,wt[ut++]=0;else for(Z=0;Z<3;Z++)wt[ut++]=Z+1,wt[ut++]=Z!=0?17:(15&lt)<<4|15&at,wt[ut++]=Z;V!=null&&V[0]!=0&&(wt[ut++]=255,wt[ut++]=221,wt[ut++]=0,wt[ut++]=4,wt[ut++]=V[0]>>>8&255,wt[ut++]=255&V[0]),U=new Uint8Array(wt)}var Pt=-1;for(Z=0;Z<U.length-1;){if(U[Z]==255&&U[Z+1]==192){Pt=Z;break}Z++}if(Pt==-1){var It=new Uint8Array(U.length+10+3*ct);It.set(U);var xt=U.length;if(Pt=U.length,(U=It)[xt++]=255,U[xt++]=192,U[xt++]=0,U[xt++]=8+3*ct,U[xt++]=8,U[xt++]=P.height>>>8&255,U[xt++]=255&P.height,U[xt++]=P.width>>>8&255,U[xt++]=255&P.width,U[xt++]=ct,ct==1)U[xt++]=1,U[xt++]=17,U[xt++]=0;else for(Z=0;Z<3;Z++)U[xt++]=Z+1,U[xt++]=Z!=0?17:(15&lt)<<4|15&at,U[xt++]=Z}if(F[q]==255&&F[q+1]==218){var Ft=F[q+2]<<8|F[q+3];for((j=new Uint8Array(Ft+2))[0]=F[q],j[1]=F[q+1],j[2]=F[q+2],j[3]=F[q+3],Z=0;Z<Ft-2;Z++)j[Z+4]=F[q+Z+4]}else{var Et=0;if((j=new Uint8Array(8+2*ct))[Et++]=255,j[Et++]=218,j[Et++]=0,j[Et++]=6+2*ct,j[Et++]=ct,ct==1)j[Et++]=1,j[Et++]=0;else for(Z=0;Z<3;Z++)j[Et++]=Z+1,j[Et++]=Z<<4|Z;j[Et++]=0,j[Et++]=63,j[Et++]=0}return{jpegOffset:D,tables:U,sosMarker:j,sofPosition:Pt}},w.decode._decodeOldJPEG=function(P,F,D,$,U,j){var Z,G,H,W,Q=w.decode._decodeOldJPEGInit(P,F,D,$);if(Q.jpegOffset!=null)for(Z=D+$-Q.jpegOffset,H=new Uint8Array(Z),et=0;et<Z;et++)H[et]=F[Q.jpegOffset+et];else{for(G=Q.tables.length,(H=new Uint8Array(G+Q.sosMarker.length+$+2)).set(Q.tables),W=G,H[Q.sofPosition+5]=P.height>>>8&255,H[Q.sofPosition+6]=255&P.height,H[Q.sofPosition+7]=P.width>>>8&255,H[Q.sofPosition+8]=255&P.width,F[D]==255&&F[D+1]==SOS||(H.set(Q.sosMarker,W),W+=sosMarker.length),et=0;et<$;et++)H[W++]=F[D+et];H[W++]=255,H[W++]=EOI}var q=new w.JpegDecoder;q.parse(H);for(var rt=q.getData({width:q.width,height:q.height,forceRGB:!0,isSourcePDF:!1}),et=0;et<rt.length;et++)U[j+et]=rt[et];P.t262&&P.t262[0]==6&&(P.t262[0]=2)},w.decode._decodePackBits=function(P,F,D,$,U){for(var j=new Int8Array(P.buffer),Z=new Int8Array($.buffer),G=F+D;F<G;){var H=j[F];if(F++,H>=0&&H<128)for(var W=0;W<H+1;W++)Z[U]=j[F],U++,F++;if(H>=-127&&H<0){for(W=0;W<1-H;W++)Z[U]=j[F],U++;F++}}return U},w.decode._decodeThunder=function(P,F,D,$,U){for(var j=[0,1,0,-1],Z=[0,1,2,3,0,-3,-2,-1],G=F+D,H=2*U,W=0;F<G;){var Q=P[F],q=Q>>>6,rt=63&Q;if(F++,q==3&&(W=15&rt,$[H>>>1]|=W<<4*(1-H&1),H++),q==0)for(var et=0;et<rt;et++)$[H>>>1]|=W<<4*(1-H&1),H++;if(q==2)for(et=0;et<2;et++)(X=rt>>>3*(1-et)&7)!=4&&(W+=Z[X],$[H>>>1]|=W<<4*(1-H&1),H++);if(q==1)for(et=0;et<3;et++){var X;(X=rt>>>2*(2-et)&3)!=2&&(W+=j[X],$[H>>>1]|=W<<4*(1-H&1),H++)}}},w.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},w.decode._lens=(function(){var P=function(H,W,Q,q){for(var rt=0;rt<W.length;rt++)H[W[rt]]=Q+rt*q},F="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",D="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",$="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",U="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",j="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";F=F.split(","),D=D.split(","),$=$.split(","),U=U.split(","),j=j.split(",");var Z={},G={};return P(Z,F,0,1),P(Z,$,64,64),P(Z,j,1792,64),P(G,D,0,1),P(G,U,64,64),P(G,j,1792,64),[Z,G]})(),w.decode._decodeG4=function(P,F,D,$,U,j,Z){for(var G=w.decode,H=F<<3,W=0,Q="",q=[],rt=[],et=0;et<j;et++)rt.push(0);rt=G._makeDiff(rt);for(var X=0,J=0,tt=0,st=0,nt=0,lt=0,at="",ct=0,V=8*Math.ceil(j/8);H>>>3<F+D;){tt=G._findDiff(rt,X+(X==0?0:1),1-nt),st=G._findDiff(rt,tt,nt);var ut=0;if(Z==1&&(ut=P[H>>>3]>>>7-(7&H)&1),Z==2&&(ut=P[H>>>3]>>>(7&H)&1),H++,Q+=ut,at=="H"){if(G._lens[nt][Q]!=null){var wt=G._lens[nt][Q];Q="",W+=wt,wt<64&&(G._addNtimes(q,W,nt),X+=W,nt=1-nt,W=0,--ct==0&&(at=""))}}else Q=="0001"&&(Q="",G._addNtimes(q,st-X,nt),X=st),Q=="001"&&(Q="",at="H",ct=2),G._dmap[Q]!=null&&(J=tt+G._dmap[Q],G._addNtimes(q,J-X,nt),X=J,Q="",nt=1-nt);q.length==j&&at==""&&(G._writeBits(q,$,8*U+lt*V),nt=0,lt++,X=0,rt=G._makeDiff(q),q=[])}},w.decode._findDiff=function(P,F,D){for(var $=0;$<P.length;$+=2)if(P[$]>=F&&P[$+1]==D)return P[$]},w.decode._makeDiff=function(P){var F=[];P[0]==1&&F.push(0,1);for(var D=1;D<P.length;D++)P[D-1]!=P[D]&&F.push(D,P[D]);return F.push(P.length,0,P.length,1),F},w.decode._decodeG2=function(P,F,D,$,U,j,Z){for(var G=w.decode,H=F<<3,W=0,Q="",q=[],rt=0,et=0,X=8*Math.ceil(j/8);H>>>3<F+D;){var J=0;Z==1&&(J=P[H>>>3]>>>7-(7&H)&1),Z==2&&(J=P[H>>>3]>>>(7&H)&1),H++,Q+=J,(W=G._lens[rt][Q])!=null&&(G._addNtimes(q,W,rt),Q="",W<64&&(rt=1-rt),q.length==j&&(G._writeBits(q,$,8*U+et*X),q=[],et++,rt=0,7&H&&(H+=8-(7&H)),W>=64&&(H+=8)))}},w.decode._decodeG3=function(P,F,D,$,U,j,Z,G){for(var H=w.decode,W=F<<3,Q=0,q="",rt=[],et=[],X=0;X<j;X++)rt.push(0);for(var J=0,tt=0,st=0,nt=0,lt=0,at=-1,ct="",V=0,ut=!0,wt=8*Math.ceil(j/8);W>>>3<F+D;){st=H._findDiff(et,J+(J==0?0:1),1-lt),nt=H._findDiff(et,st,lt);var dt=0;if(Z==1&&(dt=P[W>>>3]>>>7-(7&W)&1),Z==2&&(dt=P[W>>>3]>>>(7&W)&1),W++,q+=dt,ut){if(H._lens[lt][q]!=null){var ft=H._lens[lt][q];q="",Q+=ft,ft<64&&(H._addNtimes(rt,Q,lt),lt=1-lt,Q=0)}}else ct=="H"?H._lens[lt][q]!=null&&(ft=H._lens[lt][q],q="",Q+=ft,ft<64&&(H._addNtimes(rt,Q,lt),J+=Q,lt=1-lt,Q=0,--V==0&&(ct=""))):(q=="0001"&&(q="",H._addNtimes(rt,nt-J,lt),J=nt),q=="001"&&(q="",ct="H",V=2),H._dmap[q]!=null&&(tt=st+H._dmap[q],H._addNtimes(rt,tt-J,lt),J=tt,q="",lt=1-lt));q.endsWith("000000000001")&&(at>=0&&H._writeBits(rt,$,8*U+at*wt),G&&(Z==1&&(ut=(P[W>>>3]>>>7-(7&W)&1)==1),Z==2&&(ut=(P[W>>>3]>>>(7&W)&1)==1),W++),q="",lt=0,at++,J=0,et=H._makeDiff(rt),rt=[])}rt.length==j&&H._writeBits(rt,$,8*U+at*wt)},w.decode._addNtimes=function(P,F,D){for(var $=0;$<F;$++)P.push(D)},w.decode._writeBits=function(P,F,D){for(var $=0;$<P.length;$++)F[D+$>>>3]|=P[$]<<7-(D+$&7)},w.decode._decodeLZW=w.decode._decodeLZW=(function(){var P,F,D,$,U=0,j=0,Z=0,G=0,H=function(){var X=P>>>3,J=(F[X]<<16|F[X+1]<<8|F[X+2])>>>24-(7&P)-j&(1<<j)-1;return P+=j,J},W=new Uint32Array(16384),Q=0,q=function(X){j=X+1,U=G+1},rt=function(X){for(var J=X<<2,tt=W[J+2],st=$+tt-1;J!=65535;)D[st--]=W[J],J=W[J+1];$+=tt},et=function(X,J){var tt=U<<2,st=X<<2;W[tt]=W[3+(J<<2)],W[tt+1]=st,W[tt+2]=W[st+2]+1,W[tt+3]=W[st+3],++U+1==1<<j&&j!=12&&j++};return function(X,J,tt,st,nt,lt){P=J<<3,F=X,D=st,$=nt;var at=J+tt<<3,ct=0,V=0;for((function(ut){if(ut!=Q){Q=ut,G=1+(Z=1<<ut);for(var wt=0;wt<G+1;wt++)W[4*wt]=W[4*wt+3]=wt,W[4*wt+1]=65535,W[4*wt+2]=1}})(lt),q(lt);P<at&&(ct=H())!=G;){if(ct==Z){if(q(lt),(ct=H())==G)break;rt(ct)}else ct<U?(rt(ct),et(V,ct)):(et(V,V),rt(U-1));V=ct}return $}})(),w.tags={},w._types=(function(){var P=new Array(250);return P.fill(0),{basic:{main:P=P.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}})(),w._readIFD=function(P,F,D,$,U,j){var Z=P.readUshort(F,D);D+=2;var G={};j.debug&&g("   ".repeat(U),$.length-1,">>>----------------");for(var H=0;H<Z;H++){var W=P.readUshort(F,D);D+=2;var Q=P.readUshort(F,D);D+=2;var q=P.readUint(F,D);D+=4;var rt=P.readUint(F,D);D+=4;var et=[];if(Q==1||Q==7){var X=q<5?D-4:rt;X+q>F.buffer.byteLength&&(q=F.buffer.byteLength-X),et=new Uint8Array(F.buffer,X,q)}if(Q==2){var J=q<5?D-4:rt,tt=F[J],st=Math.max(0,Math.min(q-1,F.length-J));tt<128||st==0?et.push(P.readASCII(F,J,st)):et=new Uint8Array(F.buffer,J,st)}if(Q==3)for(var nt=0;nt<q;nt++)et.push(P.readUshort(F,(q<3?D-4:rt)+2*nt));if(Q==4||Q==13)for(nt=0;nt<q;nt++)et.push(P.readUint(F,(q<2?D-4:rt)+4*nt));if(Q==5||Q==10){var lt=Q==5?P.readUint:P.readInt;for(nt=0;nt<q;nt++)et.push([lt(F,rt+8*nt),lt(F,rt+8*nt+4)])}if(Q==8)for(nt=0;nt<q;nt++)et.push(P.readShort(F,(q<3?D-4:rt)+2*nt));if(Q==9)for(nt=0;nt<q;nt++)et.push(P.readInt(F,(q<2?D-4:rt)+4*nt));if(Q==11)for(nt=0;nt<q;nt++)et.push(P.readFloat(F,rt+4*nt));if(Q==12)for(nt=0;nt<q;nt++)et.push(P.readDouble(F,rt+8*nt));if(q==0||et.length!=0){if(j.debug&&g("   ".repeat(U),W,Q,w.tags[W],et),G["t"+W]=et,!(W==330&&G.t272&&G.t272[0]=="DSLR-A100")){if(W==330||W==34665||W==34853||W==50740&&P.readUshort(F,P.readUint(et,0))<300||W==61440){var at=W==50740?[P.readUint(et,0)]:et,ct=[];for(nt=0;nt<at.length;nt++)w._readIFD(P,F,at[nt],ct,U+1,j);W==330&&(G.subIFD=ct),W==34665&&(G.exifIFD=ct[0]),W==34853&&(G.gpsiIFD=ct[0]),W==50740&&(G.dngPrvt=ct[0]),W==61440&&(G.fujiIFD=ct[0])}}if(W==37500&&j.parseMN){var V=et;if(P.readASCII(V,0,5)=="Nikon")G.makerNote=w.decode(V.slice(10).buffer)[0];else if(P.readASCII(V,0,5)=="OLYMP"||P.readASCII(V,0,9)=="OM SYSTEM"){var ut=[8208,8224,8240,8256,8272],wt=[];w._readIFD(P,V,V[1]==77?16:V[5]==85?12:8,wt,U+1,j);var dt=G.makerNote=wt.pop();for(nt=0;nt<ut.length;nt++){var ft="t"+ut[nt];dt[ft]!=null&&(w._readIFD(P,V,dt[ft][0],wt,U+1,j),dt[ft]=wt.pop())}dt.t12288&&(w._readIFD(P,dt.t12288,0,wt,U+1,j),dt.t12288=wt.pop())}else P.readUshort(F,rt)<300&&P.readUshort(F,rt+4)<=12&&(wt=[],w._readIFD(P,F,rt,wt,U+1,j),G.makerNote=wt[0])}}else if(g(W,"unknown TIFF tag type: ",Q,"num:",q),H==0)return}return $.push(G),j.debug&&g("   ".repeat(U),"<<<---------------"),D},w._writeIFD=function(P,F,D,$,U){var j=Object.keys(U),Z=j.length;U.exifIFD&&Z--,U.gpsiIFD&&Z--,P.writeUshort(D,$,Z);for(var G=($+=2)+12*Z+4,H=0;H<j.length;H++){var W=j[H];if(W!="t34665"&&W!="t34853"){W=="exifIFD"&&(W="t34665"),W=="gpsiIFD"&&(W="t34853");var Q=parseInt(W.slice(1)),q=F.main[Q];if(q==null&&(q=F.rest[Q]),q==null||q==0)throw new Error("unknown type of tag: "+Q);var rt=U[W];Q==34665&&(rt=[G],G=w._writeIFD(P,F,D,G,U.exifIFD)[1]),Q==34853&&(rt=[G],G=w._writeIFD(P,w._types.gps,D,G,U.gpsiIFD)[1]),q==2&&(rt=rt[0]+"\0");var et=rt.length;P.writeUshort(D,$,Q),$+=2,P.writeUshort(D,$,q),$+=2,P.writeUint(D,$,et);var X=[-1,1,1,2,4,8,0,1,0,4,8,0,8][q]*et,J=$+=4;if(X>4&&(P.writeUint(D,$,G),J=G),q==1||q==7)for(var tt=0;tt<et;tt++)D[J+tt]=rt[tt];else if(q==2)P.writeASCII(D,J,rt);else if(q==3)for(tt=0;tt<et;tt++)P.writeUshort(D,J+2*tt,rt[tt]);else if(q==4)for(tt=0;tt<et;tt++)P.writeUint(D,J+4*tt,rt[tt]);else if(q==5||q==10){var st=q==5?P.writeUint:P.writeInt;for(tt=0;tt<et;tt++){var nt=rt[tt],lt=nt[0],at=nt[1];if(lt==null)throw"e";st(D,J+8*tt,lt),st(D,J+8*tt+4,at)}}else if(q==9)for(tt=0;tt<et;tt++)P.writeInt(D,J+4*tt,rt[tt]);else{if(q!=12)throw q;for(tt=0;tt<et;tt++)P.writeDouble(D,J+8*tt,rt[tt])}X>4&&(G+=X+=1&X),$+=4}}return[$,G]},w.toRGBA8=function(P,F){function D(Kt){return Kt<.0031308?12.92*Kt:1.055*Math.pow(Kt,1/2.4)-.055}var $=P.width,U=P.height,j=$*U,Z=P.data,G=new Uint8Array(4*j),H=P.t262?P.t262[0]:2,W=P.t258?Math.min(32,P.t258[0]):1;P.t262==null&&W==1&&(H=0);var Q=P.t277?P.t277[0]:P.t258?P.t258.length:[1,1,3,1,1,4,3][H],q=P.t339?P.t339[0]:null;if(H==1&&W==32&&q!=3)throw"e";var rt=Math.ceil(Q*W*$/8);if(H==0){F=1/256;for(var et=0;et<U;et++){var X=et*rt,J=et*$;if(W==1)for(var tt=0;tt<$;tt++){var st=J+tt<<2,nt=Z[X+(tt>>3)]>>7-(7&tt)&1;G[st]=G[st+1]=G[st+2]=255*(1-nt),G[st+3]=255}if(W==4)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[X+(tt>>1)]>>4-4*(1&tt)&15,G[st]=G[st+1]=G[st+2]=17*(15-nt),G[st+3]=255;if(W==8)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[X+tt],G[st]=G[st+1]=G[st+2]=255-nt,G[st+3]=255;if(W==16)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[(at=X+2*tt)+1]<<8|Z[at],G[st]=G[st+1]=G[st+2]=Math.min(255,255-~~(nt*F)),G[st+3]=255}}else if(H==1){F==null&&(F=1/256);var lt=3&Z.length?null:new Float32Array(Z.buffer);for(et=0;et<U;et++){if(X=et*rt,J=et*$,W==1)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[X+(tt>>3)]>>7-(7&tt)&1,G[st]=G[st+1]=G[st+2]=255*nt,G[st+3]=255;if(W==2)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[X+(tt>>2)]>>6-2*(3&tt)&3,G[st]=G[st+1]=G[st+2]=85*nt,G[st+3]=255;if(W==8)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[X+tt*Q],G[st]=G[st+1]=G[st+2]=nt,G[st+3]=255;if(W==16)for(tt=0;tt<$;tt++)st=J+tt<<2,nt=Z[(at=X+2*tt)+1]<<8|Z[at],G[st]=G[st+1]=G[st+2]=Math.min(255,~~(nt*F)),G[st+3]=255;if(W==32)for(tt=0;tt<$;tt++){var at;st=J+tt<<2,nt=lt[at=(X>>>2)+tt],G[st]=G[st+1]=G[st+2]=~~(.5+255*nt),G[st+3]=255}}}else if(H==2)if(W==8){if(Q==1)for(tt=0;tt<j;tt++)G[4*tt]=G[4*tt+1]=G[4*tt+2]=Z[tt],G[4*tt+3]=255;if(Q==3)for(tt=0;tt<j;tt++){var ct=3*tt;G[st=tt<<2]=Z[ct],G[st+1]=Z[ct+1],G[st+2]=Z[ct+2],G[st+3]=255}if(Q>=4)for(tt=0;tt<j;tt++)ct=tt*Q,G[st=tt<<2]=Z[ct],G[st+1]=Z[ct+1],G[st+2]=Z[ct+2],G[st+3]=Z[ct+3]}else if(W==16){if(Q==4)for(tt=0;tt<j;tt++)ct=8*tt+1,G[st=tt<<2]=Z[ct],G[st+1]=Z[ct+2],G[st+2]=Z[ct+4],G[st+3]=Z[ct+6];if(Q==3)for(tt=0;tt<j;tt++)ct=6*tt+1,G[st=tt<<2]=Z[ct],G[st+1]=Z[ct+2],G[st+2]=Z[ct+4],G[st+3]=255}else{if(W!=32)throw W;var V=new Float32Array(Z.buffer),ut=0;for(tt=0;tt<V.length;tt++)ut=Math.min(ut,V[tt]);if(ut<0)for(tt=0;tt<Z.length;tt+=4){var wt=Z[tt];Z[tt]=Z[tt+3],Z[tt+3]=wt,wt=Z[tt+1],Z[tt+1]=Z[tt+2],Z[tt+2]=wt}var dt=[];for(tt=0;tt<65536;tt++)dt.push(D(tt/65535));for(tt=0;tt<V.length;tt++){var ft=Math.max(0,Math.min(1,V[tt]));V[tt]=dt[~~(.5+65535*ft)]}if(Q==3)for(tt=0;tt<j;tt++)ct=3*tt,G[st=tt<<2]=~~(.5+255*V[ct]),G[st+1]=~~(.5+255*V[ct+1]),G[st+2]=~~(.5+255*V[ct+2]),G[st+3]=255;else{if(Q!=4)throw Q;for(tt=0;tt<j;tt++)ct=4*tt,G[st=tt<<2]=~~(.5+255*V[ct]),G[st+1]=~~(.5+255*V[ct+1]),G[st+2]=~~(.5+255*V[ct+2]),G[st+3]=~~(.5+255*V[ct+3])}}else if(H==3){var pt=P.t320,Pt=1<<W,It=W==8&&Q>1&&P.t338&&P.t338[0]!=0;for(et=0;et<U;et++)for(var xt=0;xt<$;xt++){st=(tt=et*$+xt)<<2;var Ft=0,Et=et*rt;if(W==1)Ft=Z[Et+(xt>>>3)]>>>7-(7&xt)&1;else if(W==2)Ft=Z[Et+(xt>>>2)]>>>6-2*(3&xt)&3;else if(W==4)Ft=Z[Et+(xt>>>1)]>>>4-4*(1&xt)&15;else{if(W!=8)throw W;Ft=Z[Et+xt*Q]}G[st]=pt[Ft]>>8,G[st+1]=pt[Pt+Ft]>>8,G[st+2]=pt[Pt+Pt+Ft]>>8,G[st+3]=It?Z[Et+xt*Q+1]:255}}else if(H==5){var Ct=Q>4?1:0;for(tt=0;tt<j;tt++){st=tt<<2;var Ot=tt*Q;if(window.UDOC){var Rt=Z[Ot],St=Z[Ot+1],At=Z[Ot+2],Nt=Z[Ot+3],Ut=UDOC.C.cmykToRgb([Rt*(1/255),St*(1/255),At*(1/255),Nt*(1/255)]);G[st]=~~(.5+255*Ut[0]),G[st+1]=~~(.5+255*Ut[1]),G[st+2]=~~(.5+255*Ut[2])}else Rt=255-Z[Ot],St=255-Z[Ot+1],At=255-Z[Ot+2],Nt=(255-Z[Ot+3])*(1/255),G[st]=~~(Rt*Nt+.5),G[st+1]=~~(St*Nt+.5),G[st+2]=~~(At*Nt+.5);G[st+3]=255*(1-Ct)+Z[Ot+4]*Ct}}else if(H==6&&P.t278){var jt=P.t278[0];for(et=0;et<U;et+=jt){tt=et*$;for(var Tt=jt*$,it=0;it<Tt;it++){st=4*(tt+it),At=Z[(Ot=3*tt+4*(it>>>1))+(1&it)];var Mt=Z[Ot+2]-128,mt=Z[Ot+3]-128,gt=At+((mt>>2)+(mt>>3)+(mt>>5)),_t=At-((Mt>>2)+(Mt>>4)+(Mt>>5))-((mt>>1)+(mt>>3)+(mt>>4)+(mt>>5)),vt=At+(Mt+(Mt>>1)+(Mt>>2)+(Mt>>6));G[st]=Math.max(0,Math.min(255,gt)),G[st+1]=Math.max(0,Math.min(255,_t)),G[st+2]=Math.max(0,Math.min(255,vt)),G[st+3]=255}}}else if(H==32845)for(et=0;et<U;et++)for(xt=0;xt<$;xt++){st=4*(et*$+xt);var Bt=Z[(Ot=6*(et*$+xt))+1]<<8|Z[Ot],K=(Bt=Math.pow(2,(Bt+.5)/256-64),(Z[Ot+3]+.5)/410),ot=(Z[Ot+5]+.5)/410,bt=9*K/(6*K-16*ot+12),yt=4*ot/(6*K-16*ot+12),$t=bt*Bt/yt,Zt=(1-bt-yt)*Bt/yt;gt=2.69*$t-1.276*(At=Bt)-.414*Zt,_t=-1.022*$t+1.978*At+.044*Zt,vt=.061*$t-.224*At+1.163*Zt,G[st]=255*D(Math.min(gt,1)),G[st+1]=255*D(Math.min(_t,1)),G[st+2]=255*D(Math.min(vt,1)),G[st+3]=255}else g("Unknown Photometric interpretation: "+H);return G},w.replaceIMG=function(P){P==null&&(P=document.getElementsByTagName("img"));for(var F=["tif","tiff","dng","cr2","nef"],D=0;D<P.length;D++){var $=P[D],U=$.getAttribute("src");if(U!=null){var j=U.split(".").pop().toLowerCase();if(F.indexOf(j)!=-1){var Z=new XMLHttpRequest;w._xhrs.push(Z),w._imgs.push($),Z.open("GET",U),Z.responseType="arraybuffer",Z.onload=w._imgLoaded,Z.send()}}}},w._xhrs=[],w._imgs=[],w._imgLoaded=function(P){var F=w._xhrs.indexOf(P.target),D=w._imgs[F];w._xhrs.splice(F,1),w._imgs.splice(F,1),D.setAttribute("src",w.bufferToURI(P.target.response))},w.bufferToURI=function(P){var F=w.decode(P),D=F,$=0,U=D[0];F[0].subIFD&&(D=D.concat(F[0].subIFD));for(var j=0;j<D.length;j++){var Z=D[j];if(!(Z.t258==null||Z.t258.length<3)){var G=Z.t256*Z.t257;G>$&&($=G,U=Z)}}w.decodeImage(P,U,F);var H=w.toRGBA8(U),W=U.width,Q=U.height,q=document.createElement("canvas");q.width=W,q.height=Q;var rt=q.getContext("2d"),et=new ImageData(new Uint8ClampedArray(H.buffer),W,Q);return rt.putImageData(et,0,0),q.toDataURL()},w._binBE={nextZero:function(P,F){for(;P[F]!=0;)F++;return F},readUshort:function(P,F){return P[F]<<8|P[F+1]},readShort:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+1],D[1]=P[F+0],w._binBE.i16[0]},readInt:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+3],D[1]=P[F+2],D[2]=P[F+1],D[3]=P[F+0],w._binBE.i32[0]},readUint:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+3],D[1]=P[F+2],D[2]=P[F+1],D[3]=P[F+0],w._binBE.ui32[0]},readASCII:function(P,F,D){for(var $="",U=0;U<D;U++)$+=String.fromCharCode(P[F+U]);return $},readFloat:function(P,F){for(var D=w._binBE.ui8,$=0;$<4;$++)D[$]=P[F+3-$];return w._binBE.fl32[0]},readDouble:function(P,F){for(var D=w._binBE.ui8,$=0;$<8;$++)D[$]=P[F+7-$];return w._binBE.fl64[0]},writeUshort:function(P,F,D){P[F]=D>>8&255,P[F+1]=255&D},writeInt:function(P,F,D){var $=w._binBE.ui8;w._binBE.i32[0]=D,P[F+3]=$[0],P[F+2]=$[1],P[F+1]=$[2],P[F+0]=$[3]},writeUint:function(P,F,D){P[F]=D>>24&255,P[F+1]=D>>16&255,P[F+2]=D>>8&255,P[F+3]=255&D},writeASCII:function(P,F,D){for(var $=0;$<D.length;$++)P[F+$]=D.charCodeAt($)},writeDouble:function(P,F,D){w._binBE.fl64[0]=D;for(var $=0;$<8;$++)P[F+$]=w._binBE.ui8[7-$]}},w._binBE.ui8=new Uint8Array(8),w._binBE.i16=new Int16Array(w._binBE.ui8.buffer),w._binBE.i32=new Int32Array(w._binBE.ui8.buffer),w._binBE.ui32=new Uint32Array(w._binBE.ui8.buffer),w._binBE.fl32=new Float32Array(w._binBE.ui8.buffer),w._binBE.fl64=new Float64Array(w._binBE.ui8.buffer),w._binLE={nextZero:w._binBE.nextZero,readUshort:function(P,F){return P[F+1]<<8|P[F]},readShort:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+0],D[1]=P[F+1],w._binBE.i16[0]},readInt:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+0],D[1]=P[F+1],D[2]=P[F+2],D[3]=P[F+3],w._binBE.i32[0]},readUint:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+0],D[1]=P[F+1],D[2]=P[F+2],D[3]=P[F+3],w._binBE.ui32[0]},readASCII:w._binBE.readASCII,readFloat:function(P,F){for(var D=w._binBE.ui8,$=0;$<4;$++)D[$]=P[F+$];return w._binBE.fl32[0]},readDouble:function(P,F){for(var D=w._binBE.ui8,$=0;$<8;$++)D[$]=P[F+$];return w._binBE.fl64[0]},writeUshort:function(P,F,D){P[F]=255&D,P[F+1]=D>>8&255},writeInt:function(P,F,D){var $=w._binBE.ui8;w._binBE.i32[0]=D,P[F+0]=$[0],P[F+1]=$[1],P[F+2]=$[2],P[F+3]=$[3]},writeUint:function(P,F,D){P[F]=D>>>0&255,P[F+1]=D>>>8&255,P[F+2]=D>>>16&255,P[F+3]=D>>>24&255},writeASCII:w._binBE.writeASCII},w._copyTile=function(P,F,D,$,U,j,Z,G){for(var H=Math.min(F,U-Z),W=Math.min(D,j-G),Q=0;Q<W;Q++)for(var q=(G+Q)*U+Z,rt=Q*F,et=0;et<H;et++)$[q+et]=P[rt+et]},w.LosslessJpegDecode=(function(){var P,F;function D(){return P[F++]}function $(){return P[F++]<<8|P[F++]}function U(X){for(var J=D(),tt=[0,0,0,255],st=[],nt=0;nt<16;nt++)st[nt]=D();for(nt=0;nt<16;nt++)for(var lt=0;lt<st[nt];lt++)tt[j(tt,0,nt+1,1)+3]=D();var at=new Uint8Array(256);for(X[J]=[new Uint8Array(tt),at],nt=0;nt<256;nt++){for(var ct=8,V=nt,ut=0;tt[ut+3]==255&&ct!=0;)ut=tt[ut+(V>>--ct&1)];at[nt]=ut}}function j(X,J,tt,st){if(X[J+3]!=255)return 0;if(tt==0)return J;for(var nt=0;nt<2;nt++){X[J+nt]==0&&(X[J+nt]=X.length,X.push(0,0,st,255));var lt=j(X,X[J+nt],tt-1,st+1);if(lt!=0)return lt}return 0}function Z(X){for(var J=X.b,tt=X.f;J<25&&X.a<X.d;){var st=X.data[X.a++];st!=255||X.c||X.a++,tt=tt<<8|st,J+=8}if(J<0)throw"e";X.b=J,X.f=tt}function G(X,J){return J.b<X&&Z(J),J.f>>(J.b-=X)&65535>>16-X}function H(X,J){var tt=X[0],st=0,nt=255;J.b<16&&Z(J);var lt=J.f>>J.b-8&255;for(nt=tt[(st=X[1][lt])+3],J.b-=tt[st+2];nt==255;)nt=tt[(st=tt[st+(J.f>>--J.b&1)])+3];return nt}function W(X,J){return X<32768>>16-J&&(X+=1-(1<<J)),X}function Q(X,J){var tt=H(X,J);return tt==0?0:tt==16?-32768:W(G(tt,J),tt)}function q(X,J,tt,st,nt,lt){for(var at=0,ct=0;ct<lt;ct++){for(var V=ct*J,ut=0;ut<J;ut+=nt){at++;for(var wt=0;wt<nt;wt++)X[V+ut+wt]=Q(st[wt],tt)}if(tt.e!=0&&at%tt.e==0&&ct!=0){for(var dt=tt.a,ft=tt.data;ft[dt]!=255||!(208<=ft[dt+1]&&ft[dt+1]<=215);)dt--;tt.a=dt+2,tt.f=0,tt.b=0}}}function rt(X,J){return W(G(X,J),X)}function et(X,J,tt,st,nt,lt,at,ct){for(var V=tt*at,ut=nt;ut<lt;ut++)X[ut]+=1<<ct-1;for(var wt=at;wt<V;wt+=at)for(ut=nt;ut<lt;ut++)X[wt+ut]+=X[wt+ut-at];for(var dt=1;dt<st;dt++){var ft=dt*V;for(ut=nt;ut<lt;ut++)X[ft+ut]+=X[ft+ut-V];for(wt=at;wt<V;wt+=at)for(ut=nt;ut<lt;ut++){var pt=ft+wt+ut,Pt=pt-V,It=X[pt-at],xt=0;if(J==0)xt=0;else if(J==1)xt=It;else if(J==2)xt=X[Pt];else if(J==3)xt=X[Pt-at];else if(J==4)xt=It+(X[Pt]-X[Pt-at]);else if(J==5)xt=It+(X[Pt]-X[Pt-at]>>>1);else if(J==6)xt=X[Pt]+(It-X[Pt-at]>>>1);else{if(J!=7)throw J;xt=It+X[Pt]>>>1}X[pt]+=xt}}}return function(X){if(P=X,F=0,$()!=65496)throw"e";for(var J=[],tt=0,st=0,nt=0,lt=[],at=[],ct=[],V=0,ut=0,wt=0;;){var dt=$();if(dt!=65535){var ft=$();if(dt==65475){st=D(),ut=$(),wt=$(),V=D();for(var pt=0;pt<V;pt++){var Pt=D(),It=D();if(D()!=0)throw"e";J[Pt]=[pt,It>>4,15&It]}}else if(dt==65476)for(var xt=F+ft-2;F<xt;)U(at);else{if(dt==65498){for(F++,pt=0;pt<V;pt++){var Ft=J[D()];ct[Ft[0]]=at[D()>>>4],lt[Ft[0]]=Ft.slice(1)}tt=D(),F+=2;break}dt==65501?nt=$():F+=ft-2}}else F--}var Et=new(st>8?Uint16Array:Uint8Array)(ut*wt*V),Ct={b:0,f:0,c:tt==8,a:F,data:P,d:P.length,e:nt};if(Ct.c)(function($t,Zt,Kt,te,Vt){for(var ee=P.length-F,Xt=0;Xt<ee;Xt+=4){var oe=P[F+Xt];P[F+Xt]=P[F+Xt+3],P[F+Xt+3]=oe,oe=P[F+Xt+1],P[F+Xt+1]=P[F+Xt+2],P[F+Xt+2]=oe}for(var ne=0;ne<Vt;ne++)for(var ae=32768,he=32768,ie=0;ie<Zt;ie+=2){var zt=H(te,Kt),Jt=H(te,Kt);zt!=0&&(ae+=rt(zt,Kt)),Jt!=0&&(he+=rt(Jt,Kt)),$t[ne*Zt+ie]=65535&ae,$t[ne*Zt+ie+1]=65535&he}})(Et,wt*V,Ct,ct[0],ut);else{var Ot=[],Rt=0,St=0;for(pt=0;pt<V;pt++){var At=lt[pt];(vt=At[0])>Rt&&(Rt=vt),(_t=At[1])>St&&(St=_t),Ot.push(vt*_t)}if(Rt!=1||St!=1){if(V!=3||Ot[1]!=1||Ot[2]!=1||Rt!=2||St!=1&&St!=2)throw"e";var Nt=[],Ut=0;for(pt=0;pt<V;pt++){for(var jt=0;jt<Ot[pt];jt++)Nt.push(ct[pt]);Ut+=Ot[pt]}var Tt=wt/Rt,it=ut/St,Mt=Tt*it;q(Et,Tt*Ut,Ct,Nt,Ut,it),et(Et,tt,Tt,it,Ut-2,Ut,Ut,st);var mt=new Uint16Array(Mt*Ot[0]);if(Rt==2&&St==2){for(pt=0;pt<Mt;pt++)mt[4*pt]=Et[6*pt],mt[4*pt+1]=Et[6*pt+1],mt[4*pt+2]=Et[6*pt+2],mt[4*pt+3]=Et[6*pt+3];for(et(mt,tt,4*Tt,it,0,1,1,st),pt=0;pt<Mt;pt++)Et[6*pt]=mt[4*pt],Et[6*pt+1]=mt[4*pt+1],Et[6*pt+2]=mt[4*pt+2],Et[6*pt+3]=mt[4*pt+3]}if(Rt==2&&St==1){for(pt=0;pt<Mt;pt++)mt[2*pt]=Et[4*pt],mt[2*pt+1]=Et[4*pt+1];for(et(mt,tt,2*Tt,it,0,1,1,st),pt=0;pt<Mt;pt++)Et[4*pt]=mt[2*pt],Et[4*pt+1]=mt[2*pt+1]}for(var gt=Et.slice(0),_t=0;_t<ut;_t++)if(St==2)for(var vt=0;vt<wt;vt++){var Bt=((_t>>>1)*Tt+(vt>>>1))*Ut,K=2*(1&_t)+(1&vt);Et[ot=(_t*wt+vt)*V]=gt[Bt+K],Et[ot+1]=gt[Bt+4],Et[ot+2]=gt[Bt+5]}else for(vt=0;vt<wt;vt++){var ot;Bt=(_t*Tt+(vt>>>1))*Ut,K=1&vt,Et[ot=(_t*wt+vt)*V]=gt[Bt+K],Et[ot+1]=gt[Bt+2],Et[ot+2]=gt[Bt+3]}}else if(q(Et,wt*V,Ct,ct,V,ut),nt==0)et(Et,tt,wt,ut,0,V,V,st);else{var bt=Math.floor(nt/wt);for(_t=0;_t<ut;_t+=bt){var yt=Et.slice(_t*wt*V,(_t+bt)*wt*V);et(yt,tt,wt,bt,0,V,V,st),Et.set(yt,_t*wt*V)}}}return Et}})(),(function(){var P=2,F=4,D=5,$=6,U=7,j=12,Z=13,G=14,H=15,W=17;function Q(lt){var at={c:new Int8Array(2<<lt.u)};return(function(ct,V,ut){var wt=[V,3*V+18,5*V+67,7*V+276,ut];ct.o=V,ct.w=(wt[4]+2*V)/(2*V+1)+1|0,ct.v=Math.ceil(Math.log2(ct.w)),ct.t=9,(function(dt,ft){for(var pt=-ft[4],Pt=0;pt<=ft[4];Pt++,pt++)dt[Pt]=pt<=-276?-4:pt<=-67?-3:pt<=-18?-2:pt<-0?-1:pt<=ft[0]?0:pt<ft[1]?1:pt<ft[2]?2:pt<ft[3]?3:4})(ct.c,wt)})(at,0,lt.g),at}function q(lt){for(var at=[[],[],[]],ct=Math.max(2,lt.w+32>>>6),V=0;V<3;V++)for(var ut=0;ut<41;ut++)at[V][ut]=[ct,1];return at}function rt(lt,at){var ct=0,V=8-lt.a;if(lt.j,lt.a,at){if(at>=V)do ct<<=V,at-=V,ct|=lt[lt.j]&(1<<V)-1,lt.j++,V=8;while(at>=8);at&&(ct<<=at,V-=at,ct|=lt[lt.j]>>>V&(1<<at)-1),lt.a=8-V}return ct}function et(lt,at,ct,V,ut,wt,dt,ft){ft==null&&(ft=0);var pt,Pt,It,xt,Ft,Et,Ct=wt+1,Ot=Ct%2,Rt=0,St=V[ut],At=V[ut-1],Nt=V[ut-2][Ct],Ut=At[Ct-1],jt=At[Ct],Tt=At[Ct+1],it=St[Ct-1],Mt=St[Ct+1],mt=Math.abs;if(Ot&&(It=mt(Tt-jt),xt=mt(Nt-jt),Ft=mt(Ut-jt)),Ot){if(Et=(Et=It>Ft&&xt<It?Nt+Ut:It<Ft&&xt<Ft?Nt+Tt:Tt+Ut)+2*jt>>>2,ft)return void(St[Ct]=Et);pt=at.t*at.c[lt.g+jt-Nt]+at.c[lt.g+Ut-jt]}else Et=jt>Ut&&jt>Tt||jt<Ut&&jt<Tt?Mt+it+2*jt>>>2:it+Mt>>>1,pt=at.t*at.c[lt.g+jt-Ut]+at.c[lt.g+Ut-it];Pt=mt(pt);var gt=(function(vt){for(var Bt=-1,K=0;!K;Bt++)K=vt[vt.j]>>>7-vt.a&1,vt.a++,vt.a&=7,vt.a||vt.j++;return Bt})(ct);if(gt<lt.n-at.v-1){var _t=(function(vt,Bt){var K=0;if(Bt<vt)for(;K<=14&&Bt<<++K<vt;);return K})(dt[Pt][0],dt[Pt][1]);Rt=rt(ct,_t)+(gt<<_t)}else Rt=rt(ct,at.v)+1;Rt=1&Rt?-1-(Rt>>>1):Rt>>>1,dt[Pt][0]+=mt(Rt),dt[Pt][1]==lt.f&&(dt[Pt][0]>>>=1,dt[Pt][1]>>>=1),dt[Pt][1]++,Et=pt<0?Et-Rt:Et+Rt,lt.i&&(Et<0?Et+=at.w:Et>lt.g&&(Et-=at.w)),St[Ct]=Et>=0?Math.min(Et,lt.g):0}function X(lt,at,ct){for(var V=lt[0].length,ut=at;ut<=ct;ut++)lt[ut][0]=lt[ut-1][1],lt[ut][V-1]=lt[ut-1][V-2]}function J(lt){X(lt,U,j),X(lt,P,F),X(lt,H,W)}function tt(lt,at,ct,V,ut,wt,dt,ft,pt,Pt,It,xt,Ft){for(var Et=0,Ct=1,Ot=ut<Z&&ut>F;Ct<lt.m;)Et<lt.m&&(et(lt,at,ct,V,ut,Et,dt[pt],lt.h&&(Ot&&Pt||!Ot&&(It||(Et&xt)==Ft))),et(lt,at,ct,V,wt,Et,dt[pt],lt.h&&(!Ot&&Pt||Ot&&(It||(Et&xt)==Ft))),Et+=2),Et>8&&(et(lt,at,ct,V,ut,Ct,ft[pt]),et(lt,at,ct,V,wt,Ct,ft[pt]),Ct+=2);J(V)}function st(lt,at,ct,V,ut,wt){tt(lt,at,ct,V,P,U,ut,wt,0,0,1,0,8),tt(lt,at,ct,V,8,H,ut,wt,1,0,1,0,8),tt(lt,at,ct,V,3,9,ut,wt,2,1,0,3,0),tt(lt,at,ct,V,10,16,ut,wt,0,0,0,3,2),tt(lt,at,ct,V,F,11,ut,wt,1,0,0,3,2),tt(lt,at,ct,V,j,W,ut,wt,2,1,0,3,0)}function nt(lt,at,ct,V,ut,wt){var dt=wt.length,ft=lt.l;ut+1==lt.s&&(ft=lt.e-ut*lt.l);for(var pt=6*lt.e*V+ut*lt.l,Pt=0;Pt<6;Pt++){for(var It=0;It<ft;It++){var xt,Ft=wt[Pt%dt][It%dt];xt=Ft==0?P+(Pt>>>1):Ft==2?H+(Pt>>>1):U+Pt;var Et=lt.h?(2*It/3&2147483646|It%3&1)+(It%3>>>1):It>>>1;at[pt+It]=ct[xt][Et+1]}pt+=lt.e}}w._decompressRAF=function(lt,at){var ct=(function(Ct){var Ot=w._binBE.readUshort,Rt={b:Ot(Ct,0),i:Ct[2],C:Ct[3],u:Ct[4],q:Ot(Ct,5),k:Ot(Ct,7),e:Ot(Ct,9),l:Ot(Ct,11),s:Ct[13],d:Ot(Ct,14)};if(Rt.b!=18771||Rt.i>1||Rt.q<6||Rt.q%6||Rt.e<768||Rt.e%24||Rt.l!=768||Rt.k<Rt.l||Rt.k%Rt.l||Rt.k-Rt.e>=Rt.l||Rt.s>16||Rt.s!=Rt.k/Rt.l||Rt.s!=Math.ceil(Rt.e/Rt.l)||Rt.d!=Rt.q/6||Rt.u!=12&&Rt.u!=14&&Rt.u!=16||Rt.C!=16&&Rt.C!=0)throw"Invalid data";if(Rt.i==0)throw"Not implemented. We need this file!";return Rt.h=Rt.C==16,Rt.m=0|(Rt.h?2*Rt.l/3:Rt.l>>>1),Rt.A=Rt.m+2,Rt.f=64,Rt.g=(1<<Rt.u)-1,Rt.n=4*Rt.u,Rt})(lt),V=(function(Ct,Ot){var Rt=new Array(Ot.s),St=4*Ot.s,At=16+St;12&St&&(At+=16-(12&St));for(var Nt=0,Ut=16;Nt<Ot.s;Ut+=4){var jt=w._binBE.readUint(Ct,Ut);Rt[Nt]=Ct.slice(At,At+jt),Rt[Nt].j=0,Rt[Nt].a=0,At+=jt,Nt++}if(At!=Ct.length)throw"Invalid data";return Rt})(lt,ct),ut=Q(ct),wt=new Int16Array(ct.e*ct.q);at==null&&(at=ct.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var dt=[[0,3],[1,F],[D,11],[$,j],[Z,16],[G,W]],ft=[],pt=0;pt<18;pt++)ft[pt]=new Uint16Array(ct.A);for(var Pt=0;Pt<ct.s;Pt++){var It=q(ut),xt=q(ut);for(pt=0;pt<18;pt++)for(var Ft=0;Ft<ct.A;Ft++)ft[pt][Ft]=0;for(var Et=0;Et<ct.d;Et++){for(st(ct,ut,V[Pt],ft,It,xt),pt=0;pt<6;pt++)for(Ft=0;Ft<ct.A;Ft++)ft[dt[pt][0]][Ft]=ft[dt[pt][1]][Ft];for(nt(ct,wt,ft,Et,Pt,at),pt=P;pt<18;pt++)if([D,$,Z,G].indexOf(pt)==-1)for(Ft=0;Ft<ct.A;Ft++)ft[pt][Ft]=0;J(ft)}}return wt}})()})(m,typeof commonjsRequire=="function"?requirePako():self.pako)})()})(UTIF);var UTIFExports=UTIF.exports,utif=getDefaultExportFromCjs(UTIFExports),util$1,objectUtil;function getDimensionValue(d){return typeof d=="number"?d:d instanceof Uint8Array?d[0]:typeof d[0]=="string"?parseInt(d[0]):d[0]}function tiff(){return{mime:"image/tiff",encode:d=>{const m=utif.encodeImage(d.data,d.width,d.height);return Buffer.from(m)},decode:d=>{const m=utif.decode(d),g=m[0];if(!g)throw new Error("No page found in TIFF");if(!g.t256)throw new Error("No image width found in TIFF");if(!g.t257)throw new Error("No image height found in TIFF");m.forEach((I=>{utif.decodeImage(d,I)}));const w=utif.toRGBA8(g);return{data:Buffer.from(w),width:getDimensionValue(g.t256),height:getDimensionValue(g.t257)}}}}(function(d){d.assertEqual=m=>m,d.assertIs=function(m){},d.assertNever=function(m){throw new Error},d.arrayToEnum=m=>{const g={};for(const w of m)g[w]=w;return g},d.getValidEnumValues=m=>{const g=d.objectKeys(m).filter((I=>typeof m[m[I]]!="number")),w={};for(const I of g)w[I]=m[I];return d.objectValues(w)},d.objectValues=m=>d.objectKeys(m).map((function(g){return m[g]})),d.objectKeys=typeof Object.keys=="function"?m=>Object.keys(m):m=>{const g=[];for(const w in m)Object.prototype.hasOwnProperty.call(m,w)&&g.push(w);return g},d.find=(m,g)=>{for(const w of m)if(g(w))return w},d.isInteger=typeof Number.isInteger=="function"?m=>Number.isInteger(m):m=>typeof m=="number"&&isFinite(m)&&Math.floor(m)===m,d.joinValues=function(m,g=" | "){return m.map((w=>typeof w=="string"?`'${w}'`:w)).join(g)},d.jsonStringifyReplacer=(m,g)=>typeof g=="bigint"?g.toString():g})(util$1||(util$1={})),(function(d){d.mergeShapes=(m,g)=>({...m,...g})})(objectUtil||(objectUtil={}));const ZodParsedType=util$1.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=d=>{switch(typeof d){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(d)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(d)?ZodParsedType.array:d===null?ZodParsedType.null:d.then&&typeof d.then=="function"&&d.catch&&typeof d.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&d instanceof Map?ZodParsedType.map:typeof Set<"u"&&d instanceof Set?ZodParsedType.set:typeof Date<"u"&&d instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util$1.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=d=>JSON.stringify(d,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(m){super(),this.issues=[],this.addIssue=w=>{this.issues=[...this.issues,w]},this.addIssues=(w=[])=>{this.issues=[...this.issues,...w]};const g=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,g):this.__proto__=g,this.name="ZodError",this.issues=m}get errors(){return this.issues}format(m){const g=m||function(P){return P.message},w={_errors:[]},I=P=>{for(const F of P.issues)if(F.code==="invalid_union")F.unionErrors.map(I);else if(F.code==="invalid_return_type")I(F.returnTypeError);else if(F.code==="invalid_arguments")I(F.argumentsError);else if(F.path.length===0)w._errors.push(g(F));else{let D=w,$=0;for(;$<F.path.length;){const U=F.path[$];$===F.path.length-1?(D[U]=D[U]||{_errors:[]},D[U]._errors.push(g(F))):D[U]=D[U]||{_errors:[]},D=D[U],$++}}};return I(this),w}static assert(m){if(!(m instanceof ZodError))throw new Error(`Not a ZodError: ${m}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util$1.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(m=(g=>g.message)){const g={},w=[];for(const I of this.issues)I.path.length>0?(g[I.path[0]]=g[I.path[0]]||[],g[I.path[0]].push(m(I))):w.push(m(I));return{formErrors:w,fieldErrors:g}}get formErrors(){return this.flatten()}}ZodError.create=d=>new ZodError(d);const errorMap=(d,m)=>{let g;switch(d.code){case ZodIssueCode.invalid_type:g=d.received===ZodParsedType.undefined?"Required":`Expected ${d.expected}, received ${d.received}`;break;case ZodIssueCode.invalid_literal:g=`Invalid literal value, expected ${JSON.stringify(d.expected,util$1.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:g=`Unrecognized key(s) in object: ${util$1.joinValues(d.keys,", ")}`;break;case ZodIssueCode.invalid_union:g="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:g=`Invalid discriminator value. Expected ${util$1.joinValues(d.options)}`;break;case ZodIssueCode.invalid_enum_value:g=`Invalid enum value. Expected ${util$1.joinValues(d.options)}, received '${d.received}'`;break;case ZodIssueCode.invalid_arguments:g="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:g="Invalid function return type";break;case ZodIssueCode.invalid_date:g="Invalid date";break;case ZodIssueCode.invalid_string:typeof d.validation=="object"?"includes"in d.validation?(g=`Invalid input: must include "${d.validation.includes}"`,typeof d.validation.position=="number"&&(g=`${g} at one or more positions greater than or equal to ${d.validation.position}`)):"startsWith"in d.validation?g=`Invalid input: must start with "${d.validation.startsWith}"`:"endsWith"in d.validation?g=`Invalid input: must end with "${d.validation.endsWith}"`:util$1.assertNever(d.validation):g=d.validation!=="regex"?`Invalid ${d.validation}`:"Invalid";break;case ZodIssueCode.too_small:g=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at least":"more than"} ${d.minimum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at least":"over"} ${d.minimum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${d.minimum}`:d.type==="date"?`Date must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(d.minimum))}`:"Invalid input";break;case ZodIssueCode.too_big:g=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at most":"less than"} ${d.maximum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at most":"under"} ${d.maximum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="bigint"?`BigInt must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="date"?`Date must be ${d.exact?"exactly":d.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(d.maximum))}`:"Invalid input";break;case ZodIssueCode.custom:g="Invalid input";break;case ZodIssueCode.invalid_intersection_types:g="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:g=`Number must be a multiple of ${d.multipleOf}`;break;case ZodIssueCode.not_finite:g="Number must be finite";break;default:g=m.defaultError,util$1.assertNever(d)}return{message:g}};let overrideErrorMap=errorMap;function setErrorMap(d){overrideErrorMap=d}function getErrorMap(){return overrideErrorMap}const makeIssue=d=>{const{data:m,path:g,errorMaps:w,issueData:I}=d,P=[...g,...I.path||[]],F={...I,path:P};if(I.message!==void 0)return{...I,path:P,message:I.message};let D="";const $=w.filter((U=>!!U)).slice().reverse();for(const U of $)D=U(F,{data:m,defaultError:D}).message;return{...I,path:P,message:D}},EMPTY_PATH=[];function addIssueToContext(d,m){const g=getErrorMap(),w=makeIssue({issueData:m,data:d.data,path:d.path,errorMaps:[d.common.contextualErrorMap,d.schemaErrorMap,g,g===errorMap?void 0:errorMap].filter((I=>!!I))});d.common.issues.push(w)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(m,g){const w=[];for(const I of g){if(I.status==="aborted")return INVALID;I.status==="dirty"&&m.dirty(),w.push(I.value)}return{status:m.value,value:w}}static async mergeObjectAsync(m,g){const w=[];for(const I of g){const P=await I.key,F=await I.value;w.push({key:P,value:F})}return ParseStatus.mergeObjectSync(m,w)}static mergeObjectSync(m,g){const w={};for(const I of g){const{key:P,value:F}=I;if(P.status==="aborted"||F.status==="aborted")return INVALID;P.status==="dirty"&&m.dirty(),F.status==="dirty"&&m.dirty(),P.value==="__proto__"||F.value===void 0&&!I.alwaysSet||(w[P.value]=F.value)}return{status:m.value,value:w}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=d=>({status:"dirty",value:d}),OK=d=>({status:"valid",value:d}),isAborted=d=>d.status==="aborted",isDirty=d=>d.status==="dirty",isValid=d=>d.status==="valid",isAsync=d=>typeof Promise<"u"&&d instanceof Promise;function __classPrivateFieldGet(d,m,g,w){if(typeof m=="function"?d!==m||!0:!m.has(d))throw new TypeError("Cannot read private member from an object whose class did not declare it");return m.get(d)}function __classPrivateFieldSet(d,m,g,w,I){if(typeof m=="function"?d!==m||!0:!m.has(d))throw new TypeError("Cannot write private member to an object whose class did not declare it");return m.set(d,g),g}var errorUtil,_ZodEnum_cache,_ZodNativeEnum_cache;typeof SuppressedError=="function"&&SuppressedError,(function(d){d.errToObj=m=>typeof m=="string"?{message:m}:m||{},d.toString=m=>typeof m=="string"?m:m?.message})(errorUtil||(errorUtil={}));class ParseInputLazyPath{constructor(m,g,w,I){this._cachedPath=[],this.parent=m,this.data=g,this._path=w,this._key=I}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(d,m)=>{if(isValid(m))return{success:!0,data:m.value};if(!d.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const g=new ZodError(d.common.issues);return this._error=g,this._error}}};function processCreateParams(d){if(!d)return{};const{errorMap:m,invalid_type_error:g,required_error:w,description:I}=d;if(m&&(g||w))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return m?{errorMap:m,description:I}:{errorMap:(P,F)=>{var D,$;const{message:U}=d;return P.code==="invalid_enum_value"?{message:U??F.defaultError}:F.data===void 0?{message:(D=U??w)!==null&&D!==void 0?D:F.defaultError}:P.code!=="invalid_type"?{message:F.defaultError}:{message:($=U??g)!==null&&$!==void 0?$:F.defaultError}},description:I}}class ZodType{constructor(m){this.spa=this.safeParseAsync,this._def=m,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(m){return getParsedType(m.data)}_getOrReturnCtx(m,g){return g||{common:m.parent.common,data:m.data,parsedType:getParsedType(m.data),schemaErrorMap:this._def.errorMap,path:m.path,parent:m.parent}}_processInputParams(m){return{status:new ParseStatus,ctx:{common:m.parent.common,data:m.data,parsedType:getParsedType(m.data),schemaErrorMap:this._def.errorMap,path:m.path,parent:m.parent}}}_parseSync(m){const g=this._parse(m);if(isAsync(g))throw new Error("Synchronous parse encountered promise.");return g}_parseAsync(m){const g=this._parse(m);return Promise.resolve(g)}parse(m,g){const w=this.safeParse(m,g);if(w.success)return w.data;throw w.error}safeParse(m,g){var w;const I={common:{issues:[],async:(w=g?.async)!==null&&w!==void 0&&w,contextualErrorMap:g?.errorMap},path:g?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:m,parsedType:getParsedType(m)},P=this._parseSync({data:m,path:I.path,parent:I});return handleResult(I,P)}async parseAsync(m,g){const w=await this.safeParseAsync(m,g);if(w.success)return w.data;throw w.error}async safeParseAsync(m,g){const w={common:{issues:[],contextualErrorMap:g?.errorMap,async:!0},path:g?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:m,parsedType:getParsedType(m)},I=this._parse({data:m,path:w.path,parent:w}),P=await(isAsync(I)?I:Promise.resolve(I));return handleResult(w,P)}refine(m,g){const w=I=>typeof g=="string"||g===void 0?{message:g}:typeof g=="function"?g(I):g;return this._refinement(((I,P)=>{const F=m(I),D=()=>P.addIssue({code:ZodIssueCode.custom,...w(I)});return typeof Promise<"u"&&F instanceof Promise?F.then(($=>!!$||(D(),!1))):!!F||(D(),!1)}))}refinement(m,g){return this._refinement(((w,I)=>!!m(w)||(I.addIssue(typeof g=="function"?g(w,I):g),!1)))}_refinement(m){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:m}})}superRefine(m){return this._refinement(m)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(m){return ZodUnion.create([this,m],this._def)}and(m){return ZodIntersection.create(this,m,this._def)}transform(m){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:m}})}default(m){const g=typeof m=="function"?m:()=>m;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:g,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(m){const g=typeof m=="function"?m:()=>m;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:g,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(m){return new this.constructor({...this._def,description:m})}pipe(m){return ZodPipeline.create(this,m)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6Regex=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(d){let m="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return d.precision?m=`${m}\\.\\d{${d.precision}}`:d.precision==null&&(m=`${m}(\\.\\d+)?`),m}function timeRegex(d){return new RegExp(`^${timeRegexSource(d)}$`)}function datetimeRegex(d){let m=`${dateRegexSource}T${timeRegexSource(d)}`;const g=[];return g.push(d.local?"Z?":"Z"),d.offset&&g.push("([+-]\\d{2}:?\\d{2})"),m=`${m}(${g.join("|")})`,new RegExp(`^${m}$`)}function isValidIP(d,m){return!(m!=="v4"&&m||!ipv4Regex.test(d))||!(m!=="v6"&&m||!ipv6Regex.test(d))}class ZodString extends ZodType{_parse(m){if(this._def.coerce&&(m.data=String(m.data)),this._getType(m)!==ZodParsedType.string){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:I.parsedType}),INVALID}const g=new ParseStatus;let w;for(const I of this._def.checks)if(I.kind==="min")m.data.length<I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.value,type:"string",inclusive:!0,exact:!1,message:I.message}),g.dirty());else if(I.kind==="max")m.data.length>I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.value,type:"string",inclusive:!0,exact:!1,message:I.message}),g.dirty());else if(I.kind==="length"){const P=m.data.length>I.value,F=m.data.length<I.value;(P||F)&&(w=this._getOrReturnCtx(m,w),P?addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.value,type:"string",inclusive:!0,exact:!0,message:I.message}):F&&addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.value,type:"string",inclusive:!0,exact:!0,message:I.message}),g.dirty())}else if(I.kind==="email")emailRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"email",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"emoji",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="uuid")uuidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"uuid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="nanoid")nanoidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="cuid")cuidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"cuid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="cuid2")cuid2Regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="ulid")ulidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"ulid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="url")try{new URL(m.data)}catch{w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"url",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()}else I.kind==="regex"?(I.regex.lastIndex=0,I.regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"regex",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty())):I.kind==="trim"?m.data=m.data.trim():I.kind==="includes"?m.data.includes(I.value,I.position)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{includes:I.value,position:I.position},message:I.message}),g.dirty()):I.kind==="toLowerCase"?m.data=m.data.toLowerCase():I.kind==="toUpperCase"?m.data=m.data.toUpperCase():I.kind==="startsWith"?m.data.startsWith(I.value)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{startsWith:I.value},message:I.message}),g.dirty()):I.kind==="endsWith"?m.data.endsWith(I.value)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{endsWith:I.value},message:I.message}),g.dirty()):I.kind==="datetime"?datetimeRegex(I).test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"datetime",message:I.message}),g.dirty()):I.kind==="date"?dateRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"date",message:I.message}),g.dirty()):I.kind==="time"?timeRegex(I).test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"time",message:I.message}),g.dirty()):I.kind==="duration"?durationRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"duration",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):I.kind==="ip"?isValidIP(m.data,I.version)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"ip",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):I.kind==="base64"?base64Regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"base64",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):util$1.assertNever(I);return{status:g.value,value:m.data}}_regex(m,g,w){return this.refinement((I=>m.test(I)),{validation:g,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(w)})}_addCheck(m){return new ZodString({...this._def,checks:[...this._def.checks,m]})}email(m){return this._addCheck({kind:"email",...errorUtil.errToObj(m)})}url(m){return this._addCheck({kind:"url",...errorUtil.errToObj(m)})}emoji(m){return this._addCheck({kind:"emoji",...errorUtil.errToObj(m)})}uuid(m){return this._addCheck({kind:"uuid",...errorUtil.errToObj(m)})}nanoid(m){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(m)})}cuid(m){return this._addCheck({kind:"cuid",...errorUtil.errToObj(m)})}cuid2(m){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(m)})}ulid(m){return this._addCheck({kind:"ulid",...errorUtil.errToObj(m)})}base64(m){return this._addCheck({kind:"base64",...errorUtil.errToObj(m)})}ip(m){return this._addCheck({kind:"ip",...errorUtil.errToObj(m)})}datetime(m){var g,w;return typeof m=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:m}):this._addCheck({kind:"datetime",precision:m?.precision===void 0?null:m?.precision,offset:(g=m?.offset)!==null&&g!==void 0&&g,local:(w=m?.local)!==null&&w!==void 0&&w,...errorUtil.errToObj(m?.message)})}date(m){return this._addCheck({kind:"date",message:m})}time(m){return typeof m=="string"?this._addCheck({kind:"time",precision:null,message:m}):this._addCheck({kind:"time",precision:m?.precision===void 0?null:m?.precision,...errorUtil.errToObj(m?.message)})}duration(m){return this._addCheck({kind:"duration",...errorUtil.errToObj(m)})}regex(m,g){return this._addCheck({kind:"regex",regex:m,...errorUtil.errToObj(g)})}includes(m,g){return this._addCheck({kind:"includes",value:m,position:g?.position,...errorUtil.errToObj(g?.message)})}startsWith(m,g){return this._addCheck({kind:"startsWith",value:m,...errorUtil.errToObj(g)})}endsWith(m,g){return this._addCheck({kind:"endsWith",value:m,...errorUtil.errToObj(g)})}min(m,g){return this._addCheck({kind:"min",value:m,...errorUtil.errToObj(g)})}max(m,g){return this._addCheck({kind:"max",value:m,...errorUtil.errToObj(g)})}length(m,g){return this._addCheck({kind:"length",value:m,...errorUtil.errToObj(g)})}nonempty(m){return this.min(1,errorUtil.errToObj(m))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((m=>m.kind==="datetime"))}get isDate(){return!!this._def.checks.find((m=>m.kind==="date"))}get isTime(){return!!this._def.checks.find((m=>m.kind==="time"))}get isDuration(){return!!this._def.checks.find((m=>m.kind==="duration"))}get isEmail(){return!!this._def.checks.find((m=>m.kind==="email"))}get isURL(){return!!this._def.checks.find((m=>m.kind==="url"))}get isEmoji(){return!!this._def.checks.find((m=>m.kind==="emoji"))}get isUUID(){return!!this._def.checks.find((m=>m.kind==="uuid"))}get isNANOID(){return!!this._def.checks.find((m=>m.kind==="nanoid"))}get isCUID(){return!!this._def.checks.find((m=>m.kind==="cuid"))}get isCUID2(){return!!this._def.checks.find((m=>m.kind==="cuid2"))}get isULID(){return!!this._def.checks.find((m=>m.kind==="ulid"))}get isIP(){return!!this._def.checks.find((m=>m.kind==="ip"))}get isBase64(){return!!this._def.checks.find((m=>m.kind==="base64"))}get minLength(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxLength(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}}function floatSafeRemainder(d,m){const g=(d.toString().split(".")[1]||"").length,w=(m.toString().split(".")[1]||"").length,I=g>w?g:w;return parseInt(d.toFixed(I).replace(".",""))%parseInt(m.toFixed(I).replace(".",""))/Math.pow(10,I)}ZodString.create=d=>{var m;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(m=d?.coerce)!==null&&m!==void 0&&m,...processCreateParams(d)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(m){if(this._def.coerce&&(m.data=Number(m.data)),this._getType(m)!==ZodParsedType.number){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:I.parsedType}),INVALID}let g;const w=new ParseStatus;for(const I of this._def.checks)I.kind==="int"?util$1.isInteger(m.data)||(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:I.message}),w.dirty()):I.kind==="min"?(I.inclusive?m.data<I.value:m.data<=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_small,minimum:I.value,type:"number",inclusive:I.inclusive,exact:!1,message:I.message}),w.dirty()):I.kind==="max"?(I.inclusive?m.data>I.value:m.data>=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_big,maximum:I.value,type:"number",inclusive:I.inclusive,exact:!1,message:I.message}),w.dirty()):I.kind==="multipleOf"?floatSafeRemainder(m.data,I.value)!==0&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_multiple_of,multipleOf:I.value,message:I.message}),w.dirty()):I.kind==="finite"?Number.isFinite(m.data)||(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_finite,message:I.message}),w.dirty()):util$1.assertNever(I);return{status:w.value,value:m.data}}gte(m,g){return this.setLimit("min",m,!0,errorUtil.toString(g))}gt(m,g){return this.setLimit("min",m,!1,errorUtil.toString(g))}lte(m,g){return this.setLimit("max",m,!0,errorUtil.toString(g))}lt(m,g){return this.setLimit("max",m,!1,errorUtil.toString(g))}setLimit(m,g,w,I){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:m,value:g,inclusive:w,message:errorUtil.toString(I)}]})}_addCheck(m){return new ZodNumber({...this._def,checks:[...this._def.checks,m]})}int(m){return this._addCheck({kind:"int",message:errorUtil.toString(m)})}positive(m){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(m)})}negative(m){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(m)})}nonpositive(m){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(m)})}nonnegative(m){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(m)})}multipleOf(m,g){return this._addCheck({kind:"multipleOf",value:m,message:errorUtil.toString(g)})}finite(m){return this._addCheck({kind:"finite",message:errorUtil.toString(m)})}safe(m){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(m)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(m)})}get minValue(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxValue(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}get isInt(){return!!this._def.checks.find((m=>m.kind==="int"||m.kind==="multipleOf"&&util$1.isInteger(m.value)))}get isFinite(){let m=null,g=null;for(const w of this._def.checks){if(w.kind==="finite"||w.kind==="int"||w.kind==="multipleOf")return!0;w.kind==="min"?(g===null||w.value>g)&&(g=w.value):w.kind==="max"&&(m===null||w.value<m)&&(m=w.value)}return Number.isFinite(g)&&Number.isFinite(m)}}ZodNumber.create=d=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:d?.coerce||!1,...processCreateParams(d)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(m){if(this._def.coerce&&(m.data=BigInt(m.data)),this._getType(m)!==ZodParsedType.bigint){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:I.parsedType}),INVALID}let g;const w=new ParseStatus;for(const I of this._def.checks)I.kind==="min"?(I.inclusive?m.data<I.value:m.data<=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_small,type:"bigint",minimum:I.value,inclusive:I.inclusive,message:I.message}),w.dirty()):I.kind==="max"?(I.inclusive?m.data>I.value:m.data>=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_big,type:"bigint",maximum:I.value,inclusive:I.inclusive,message:I.message}),w.dirty()):I.kind==="multipleOf"?m.data%I.value!==BigInt(0)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_multiple_of,multipleOf:I.value,message:I.message}),w.dirty()):util$1.assertNever(I);return{status:w.value,value:m.data}}gte(m,g){return this.setLimit("min",m,!0,errorUtil.toString(g))}gt(m,g){return this.setLimit("min",m,!1,errorUtil.toString(g))}lte(m,g){return this.setLimit("max",m,!0,errorUtil.toString(g))}lt(m,g){return this.setLimit("max",m,!1,errorUtil.toString(g))}setLimit(m,g,w,I){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:m,value:g,inclusive:w,message:errorUtil.toString(I)}]})}_addCheck(m){return new ZodBigInt({...this._def,checks:[...this._def.checks,m]})}positive(m){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(m)})}negative(m){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(m)})}nonpositive(m){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(m)})}nonnegative(m){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(m)})}multipleOf(m,g){return this._addCheck({kind:"multipleOf",value:m,message:errorUtil.toString(g)})}get minValue(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxValue(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}}ZodBigInt.create=d=>{var m;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(m=d?.coerce)!==null&&m!==void 0&&m,...processCreateParams(d)})};class ZodBoolean extends ZodType{_parse(m){if(this._def.coerce&&(m.data=!!m.data),this._getType(m)!==ZodParsedType.boolean){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:g.parsedType}),INVALID}return OK(m.data)}}ZodBoolean.create=d=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:d?.coerce||!1,...processCreateParams(d)});class ZodDate extends ZodType{_parse(m){if(this._def.coerce&&(m.data=new Date(m.data)),this._getType(m)!==ZodParsedType.date){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:I.parsedType}),INVALID}if(isNaN(m.data.getTime()))return addIssueToContext(this._getOrReturnCtx(m),{code:ZodIssueCode.invalid_date}),INVALID;const g=new ParseStatus;let w;for(const I of this._def.checks)I.kind==="min"?m.data.getTime()<I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_small,message:I.message,inclusive:!0,exact:!1,minimum:I.value,type:"date"}),g.dirty()):I.kind==="max"?m.data.getTime()>I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_big,message:I.message,inclusive:!0,exact:!1,maximum:I.value,type:"date"}),g.dirty()):util$1.assertNever(I);return{status:g.value,value:new Date(m.data.getTime())}}_addCheck(m){return new ZodDate({...this._def,checks:[...this._def.checks,m]})}min(m,g){return this._addCheck({kind:"min",value:m.getTime(),message:errorUtil.toString(g)})}max(m,g){return this._addCheck({kind:"max",value:m.getTime(),message:errorUtil.toString(g)})}get minDate(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m!=null?new Date(m):null}get maxDate(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m!=null?new Date(m):null}}ZodDate.create=d=>new ZodDate({checks:[],coerce:d?.coerce||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(d)});class ZodSymbol extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.symbol){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:g.parsedType}),INVALID}return OK(m.data)}}ZodSymbol.create=d=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(d)});class ZodUndefined extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.undefined){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:g.parsedType}),INVALID}return OK(m.data)}}ZodUndefined.create=d=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(d)});class ZodNull extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.null){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:g.parsedType}),INVALID}return OK(m.data)}}ZodNull.create=d=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(d)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(m){return OK(m.data)}}ZodAny.create=d=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(d)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(m){return OK(m.data)}}ZodUnknown.create=d=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(d)});class ZodNever extends ZodType{_parse(m){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:g.parsedType}),INVALID}}ZodNever.create=d=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(d)});class ZodVoid extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.undefined){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:g.parsedType}),INVALID}return OK(m.data)}}ZodVoid.create=d=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(d)});class ZodArray extends ZodType{_parse(m){const{ctx:g,status:w}=this._processInputParams(m),I=this._def;if(g.parsedType!==ZodParsedType.array)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:g.parsedType}),INVALID;if(I.exactLength!==null){const F=g.data.length>I.exactLength.value,D=g.data.length<I.exactLength.value;(F||D)&&(addIssueToContext(g,{code:F?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:D?I.exactLength.value:void 0,maximum:F?I.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:I.exactLength.message}),w.dirty())}if(I.minLength!==null&&g.data.length<I.minLength.value&&(addIssueToContext(g,{code:ZodIssueCode.too_small,minimum:I.minLength.value,type:"array",inclusive:!0,exact:!1,message:I.minLength.message}),w.dirty()),I.maxLength!==null&&g.data.length>I.maxLength.value&&(addIssueToContext(g,{code:ZodIssueCode.too_big,maximum:I.maxLength.value,type:"array",inclusive:!0,exact:!1,message:I.maxLength.message}),w.dirty()),g.common.async)return Promise.all([...g.data].map(((F,D)=>I.type._parseAsync(new ParseInputLazyPath(g,F,g.path,D))))).then((F=>ParseStatus.mergeArray(w,F)));const P=[...g.data].map(((F,D)=>I.type._parseSync(new ParseInputLazyPath(g,F,g.path,D))));return ParseStatus.mergeArray(w,P)}get element(){return this._def.type}min(m,g){return new ZodArray({...this._def,minLength:{value:m,message:errorUtil.toString(g)}})}max(m,g){return new ZodArray({...this._def,maxLength:{value:m,message:errorUtil.toString(g)}})}length(m,g){return new ZodArray({...this._def,exactLength:{value:m,message:errorUtil.toString(g)}})}nonempty(m){return this.min(1,m)}}function deepPartialify(d){if(d instanceof ZodObject){const m={};for(const g in d.shape){const w=d.shape[g];m[g]=ZodOptional.create(deepPartialify(w))}return new ZodObject({...d._def,shape:()=>m})}return d instanceof ZodArray?new ZodArray({...d._def,type:deepPartialify(d.element)}):d instanceof ZodOptional?ZodOptional.create(deepPartialify(d.unwrap())):d instanceof ZodNullable?ZodNullable.create(deepPartialify(d.unwrap())):d instanceof ZodTuple?ZodTuple.create(d.items.map((m=>deepPartialify(m)))):d}ZodArray.create=(d,m)=>new ZodArray({type:d,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(m)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const m=this._def.shape(),g=util$1.objectKeys(m);return this._cached={shape:m,keys:g}}_parse(m){if(this._getType(m)!==ZodParsedType.object){const $=this._getOrReturnCtx(m);return addIssueToContext($,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:$.parsedType}),INVALID}const{status:g,ctx:w}=this._processInputParams(m),{shape:I,keys:P}=this._getCached(),F=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const $ in w.data)P.includes($)||F.push($);const D=[];for(const $ of P){const U=I[$],j=w.data[$];D.push({key:{status:"valid",value:$},value:U._parse(new ParseInputLazyPath(w,j,w.path,$)),alwaysSet:$ in w.data})}if(this._def.catchall instanceof ZodNever){const $=this._def.unknownKeys;if($==="passthrough")for(const U of F)D.push({key:{status:"valid",value:U},value:{status:"valid",value:w.data[U]}});else if($==="strict")F.length>0&&(addIssueToContext(w,{code:ZodIssueCode.unrecognized_keys,keys:F}),g.dirty());else if($!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const $=this._def.catchall;for(const U of F){const j=w.data[U];D.push({key:{status:"valid",value:U},value:$._parse(new ParseInputLazyPath(w,j,w.path,U)),alwaysSet:U in w.data})}}return w.common.async?Promise.resolve().then((async()=>{const $=[];for(const U of D){const j=await U.key,Z=await U.value;$.push({key:j,value:Z,alwaysSet:U.alwaysSet})}return $})).then(($=>ParseStatus.mergeObjectSync(g,$))):ParseStatus.mergeObjectSync(g,D)}get shape(){return this._def.shape()}strict(m){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...m!==void 0?{errorMap:(g,w)=>{var I,P,F,D;const $=(F=(P=(I=this._def).errorMap)===null||P===void 0?void 0:P.call(I,g,w).message)!==null&&F!==void 0?F:w.defaultError;return g.code==="unrecognized_keys"?{message:(D=errorUtil.errToObj(m).message)!==null&&D!==void 0?D:$}:{message:$}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(m){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...m})})}merge(m){return new ZodObject({unknownKeys:m._def.unknownKeys,catchall:m._def.catchall,shape:()=>({...this._def.shape(),...m._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(m,g){return this.augment({[m]:g})}catchall(m){return new ZodObject({...this._def,catchall:m})}pick(m){const g={};return util$1.objectKeys(m).forEach((w=>{m[w]&&this.shape[w]&&(g[w]=this.shape[w])})),new ZodObject({...this._def,shape:()=>g})}omit(m){const g={};return util$1.objectKeys(this.shape).forEach((w=>{m[w]||(g[w]=this.shape[w])})),new ZodObject({...this._def,shape:()=>g})}deepPartial(){return deepPartialify(this)}partial(m){const g={};return util$1.objectKeys(this.shape).forEach((w=>{const I=this.shape[w];m&&!m[w]?g[w]=I:g[w]=I.optional()})),new ZodObject({...this._def,shape:()=>g})}required(m){const g={};return util$1.objectKeys(this.shape).forEach((w=>{if(m&&!m[w])g[w]=this.shape[w];else{let I=this.shape[w];for(;I instanceof ZodOptional;)I=I._def.innerType;g[w]=I}})),new ZodObject({...this._def,shape:()=>g})}keyof(){return createZodEnum(util$1.objectKeys(this.shape))}}ZodObject.create=(d,m)=>new ZodObject({shape:()=>d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)}),ZodObject.strictCreate=(d,m)=>new ZodObject({shape:()=>d,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)}),ZodObject.lazycreate=(d,m)=>new ZodObject({shape:d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)});class ZodUnion extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w=this._def.options;if(g.common.async)return Promise.all(w.map((async I=>{const P={...g,common:{...g.common,issues:[]},parent:null};return{result:await I._parseAsync({data:g.data,path:g.path,parent:P}),ctx:P}}))).then((function(I){for(const F of I)if(F.result.status==="valid")return F.result;for(const F of I)if(F.result.status==="dirty")return g.common.issues.push(...F.ctx.common.issues),F.result;const P=I.map((F=>new ZodError(F.ctx.common.issues)));return addIssueToContext(g,{code:ZodIssueCode.invalid_union,unionErrors:P}),INVALID}));{let I;const P=[];for(const D of w){const $={...g,common:{...g.common,issues:[]},parent:null},U=D._parseSync({data:g.data,path:g.path,parent:$});if(U.status==="valid")return U;U.status!=="dirty"||I||(I={result:U,ctx:$}),$.common.issues.length&&P.push($.common.issues)}if(I)return g.common.issues.push(...I.ctx.common.issues),I.result;const F=P.map((D=>new ZodError(D)));return addIssueToContext(g,{code:ZodIssueCode.invalid_union,unionErrors:F}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(d,m)=>new ZodUnion({options:d,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(m)});const getDiscriminator=d=>d instanceof ZodLazy?getDiscriminator(d.schema):d instanceof ZodEffects?getDiscriminator(d.innerType()):d instanceof ZodLiteral?[d.value]:d instanceof ZodEnum?d.options:d instanceof ZodNativeEnum?util$1.objectValues(d.enum):d instanceof ZodDefault?getDiscriminator(d._def.innerType):d instanceof ZodUndefined?[void 0]:d instanceof ZodNull?[null]:d instanceof ZodOptional?[void 0,...getDiscriminator(d.unwrap())]:d instanceof ZodNullable?[null,...getDiscriminator(d.unwrap())]:d instanceof ZodBranded||d instanceof ZodReadonly?getDiscriminator(d.unwrap()):d instanceof ZodCatch?getDiscriminator(d._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.object)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:g.parsedType}),INVALID;const w=this.discriminator,I=g.data[w],P=this.optionsMap.get(I);return P?g.common.async?P._parseAsync({data:g.data,path:g.path,parent:g}):P._parseSync({data:g.data,path:g.path,parent:g}):(addIssueToContext(g,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[w]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(m,g,w){const I=new Map;for(const P of g){const F=getDiscriminator(P.shape[m]);if(!F.length)throw new Error(`A discriminator value for key \`${m}\` could not be extracted from all schema options`);for(const D of F){if(I.has(D))throw new Error(`Discriminator property ${String(m)} has duplicate value ${String(D)}`);I.set(D,P)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:m,options:g,optionsMap:I,...processCreateParams(w)})}}function mergeValues(d,m){const g=getParsedType(d),w=getParsedType(m);if(d===m)return{valid:!0,data:d};if(g===ZodParsedType.object&&w===ZodParsedType.object){const I=util$1.objectKeys(m),P=util$1.objectKeys(d).filter((D=>I.indexOf(D)!==-1)),F={...d,...m};for(const D of P){const $=mergeValues(d[D],m[D]);if(!$.valid)return{valid:!1};F[D]=$.data}return{valid:!0,data:F}}if(g===ZodParsedType.array&&w===ZodParsedType.array){if(d.length!==m.length)return{valid:!1};const I=[];for(let P=0;P<d.length;P++){const F=mergeValues(d[P],m[P]);if(!F.valid)return{valid:!1};I.push(F.data)}return{valid:!0,data:I}}return g===ZodParsedType.date&&w===ZodParsedType.date&&+d==+m?{valid:!0,data:d}:{valid:!1}}class ZodIntersection extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m),I=(P,F)=>{if(isAborted(P)||isAborted(F))return INVALID;const D=mergeValues(P.value,F.value);return D.valid?((isDirty(P)||isDirty(F))&&g.dirty(),{status:g.value,value:D.data}):(addIssueToContext(w,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return w.common.async?Promise.all([this._def.left._parseAsync({data:w.data,path:w.path,parent:w}),this._def.right._parseAsync({data:w.data,path:w.path,parent:w})]).then((([P,F])=>I(P,F))):I(this._def.left._parseSync({data:w.data,path:w.path,parent:w}),this._def.right._parseSync({data:w.data,path:w.path,parent:w}))}}ZodIntersection.create=(d,m,g)=>new ZodIntersection({left:d,right:m,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(g)});class ZodTuple extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.array)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:w.parsedType}),INVALID;if(w.data.length<this._def.items.length)return addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&w.data.length>this._def.items.length&&(addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),g.dirty());const I=[...w.data].map(((P,F)=>{const D=this._def.items[F]||this._def.rest;return D?D._parse(new ParseInputLazyPath(w,P,w.path,F)):null})).filter((P=>!!P));return w.common.async?Promise.all(I).then((P=>ParseStatus.mergeArray(g,P))):ParseStatus.mergeArray(g,I)}get items(){return this._def.items}rest(m){return new ZodTuple({...this._def,rest:m})}}ZodTuple.create=(d,m)=>{if(!Array.isArray(d))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:d,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(m)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.object)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:w.parsedType}),INVALID;const I=[],P=this._def.keyType,F=this._def.valueType;for(const D in w.data)I.push({key:P._parse(new ParseInputLazyPath(w,D,w.path,D)),value:F._parse(new ParseInputLazyPath(w,w.data[D],w.path,D)),alwaysSet:D in w.data});return w.common.async?ParseStatus.mergeObjectAsync(g,I):ParseStatus.mergeObjectSync(g,I)}get element(){return this._def.valueType}static create(m,g,w){return new ZodRecord(g instanceof ZodType?{keyType:m,valueType:g,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(w)}:{keyType:ZodString.create(),valueType:m,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(g)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.map)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:w.parsedType}),INVALID;const I=this._def.keyType,P=this._def.valueType,F=[...w.data.entries()].map((([D,$],U)=>({key:I._parse(new ParseInputLazyPath(w,D,w.path,[U,"key"])),value:P._parse(new ParseInputLazyPath(w,$,w.path,[U,"value"]))})));if(w.common.async){const D=new Map;return Promise.resolve().then((async()=>{for(const $ of F){const U=await $.key,j=await $.value;if(U.status==="aborted"||j.status==="aborted")return INVALID;U.status!=="dirty"&&j.status!=="dirty"||g.dirty(),D.set(U.value,j.value)}return{status:g.value,value:D}}))}{const D=new Map;for(const $ of F){const U=$.key,j=$.value;if(U.status==="aborted"||j.status==="aborted")return INVALID;U.status!=="dirty"&&j.status!=="dirty"||g.dirty(),D.set(U.value,j.value)}return{status:g.value,value:D}}}}ZodMap.create=(d,m,g)=>new ZodMap({valueType:m,keyType:d,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(g)});class ZodSet extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.set)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:w.parsedType}),INVALID;const I=this._def;I.minSize!==null&&w.data.size<I.minSize.value&&(addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.minSize.value,type:"set",inclusive:!0,exact:!1,message:I.minSize.message}),g.dirty()),I.maxSize!==null&&w.data.size>I.maxSize.value&&(addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.maxSize.value,type:"set",inclusive:!0,exact:!1,message:I.maxSize.message}),g.dirty());const P=this._def.valueType;function F($){const U=new Set;for(const j of $){if(j.status==="aborted")return INVALID;j.status==="dirty"&&g.dirty(),U.add(j.value)}return{status:g.value,value:U}}const D=[...w.data.values()].map((($,U)=>P._parse(new ParseInputLazyPath(w,$,w.path,U))));return w.common.async?Promise.all(D).then(($=>F($))):F(D)}min(m,g){return new ZodSet({...this._def,minSize:{value:m,message:errorUtil.toString(g)}})}max(m,g){return new ZodSet({...this._def,maxSize:{value:m,message:errorUtil.toString(g)}})}size(m,g){return this.min(m,g).max(m,g)}nonempty(m){return this.min(1,m)}}ZodSet.create=(d,m)=>new ZodSet({valueType:d,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(m)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.function)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:g.parsedType}),INVALID;function w(D,$){return makeIssue({data:D,path:g.path,errorMaps:[g.common.contextualErrorMap,g.schemaErrorMap,getErrorMap(),errorMap].filter((U=>!!U)),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:$}})}function I(D,$){return makeIssue({data:D,path:g.path,errorMaps:[g.common.contextualErrorMap,g.schemaErrorMap,getErrorMap(),errorMap].filter((U=>!!U)),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:$}})}const P={errorMap:g.common.contextualErrorMap},F=g.data;if(this._def.returns instanceof ZodPromise){const D=this;return OK((async function(...$){const U=new ZodError([]),j=await D._def.args.parseAsync($,P).catch((H=>{throw U.addIssue(w($,H)),U})),Z=await Reflect.apply(F,this,j);return await D._def.returns._def.type.parseAsync(Z,P).catch((H=>{throw U.addIssue(I(Z,H)),U}))}))}{const D=this;return OK((function(...$){const U=D._def.args.safeParse($,P);if(!U.success)throw new ZodError([w($,U.error)]);const j=Reflect.apply(F,this,U.data),Z=D._def.returns.safeParse(j,P);if(!Z.success)throw new ZodError([I(j,Z.error)]);return Z.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...m){return new ZodFunction({...this._def,args:ZodTuple.create(m).rest(ZodUnknown.create())})}returns(m){return new ZodFunction({...this._def,returns:m})}implement(m){return this.parse(m)}strictImplement(m){return this.parse(m)}static create(m,g,w){return new ZodFunction({args:m||ZodTuple.create([]).rest(ZodUnknown.create()),returns:g||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(w)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(m){const{ctx:g}=this._processInputParams(m);return this._def.getter()._parse({data:g.data,path:g.path,parent:g})}}ZodLazy.create=(d,m)=>new ZodLazy({getter:d,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(m)});class ZodLiteral extends ZodType{_parse(m){if(m.data!==this._def.value){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{received:g.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:m.data}}get value(){return this._def.value}}function createZodEnum(d,m){return new ZodEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(m)})}ZodLiteral.create=(d,m)=>new ZodLiteral({value:d,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(m)});class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(m){if(typeof m.data!="string"){const g=this._getOrReturnCtx(m),w=this._def.values;return addIssueToContext(g,{expected:util$1.joinValues(w),received:g.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(m.data)){const g=this._getOrReturnCtx(m),w=this._def.values;return addIssueToContext(g,{received:g.data,code:ZodIssueCode.invalid_enum_value,options:w}),INVALID}return OK(m.data)}get options(){return this._def.values}get enum(){const m={};for(const g of this._def.values)m[g]=g;return m}get Values(){const m={};for(const g of this._def.values)m[g]=g;return m}get Enum(){const m={};for(const g of this._def.values)m[g]=g;return m}extract(m,g=this._def){return ZodEnum.create(m,{...this._def,...g})}exclude(m,g=this._def){return ZodEnum.create(this.options.filter((w=>!m.includes(w))),{...this._def,...g})}}_ZodEnum_cache=new WeakMap,ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(m){const g=util$1.getValidEnumValues(this._def.values),w=this._getOrReturnCtx(m);if(w.parsedType!==ZodParsedType.string&&w.parsedType!==ZodParsedType.number){const I=util$1.objectValues(g);return addIssueToContext(w,{expected:util$1.joinValues(I),received:w.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util$1.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(m.data)){const I=util$1.objectValues(g);return addIssueToContext(w,{received:w.data,code:ZodIssueCode.invalid_enum_value,options:I}),INVALID}return OK(m.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap,ZodNativeEnum.create=(d,m)=>new ZodNativeEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(m)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.promise&&g.common.async===!1)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:g.parsedType}),INVALID;const w=g.parsedType===ZodParsedType.promise?g.data:Promise.resolve(g.data);return OK(w.then((I=>this._def.type.parseAsync(I,{path:g.path,errorMap:g.common.contextualErrorMap}))))}}ZodPromise.create=(d,m)=>new ZodPromise({type:d,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(m)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(m){const{status:g,ctx:w}=this._processInputParams(m),I=this._def.effect||null,P={addIssue:F=>{addIssueToContext(w,F),F.fatal?g.abort():g.dirty()},get path(){return w.path}};if(P.addIssue=P.addIssue.bind(P),I.type==="preprocess"){const F=I.transform(w.data,P);if(w.common.async)return Promise.resolve(F).then((async D=>{if(g.value==="aborted")return INVALID;const $=await this._def.schema._parseAsync({data:D,path:w.path,parent:w});return $.status==="aborted"?INVALID:$.status==="dirty"||g.value==="dirty"?DIRTY($.value):$}));{if(g.value==="aborted")return INVALID;const D=this._def.schema._parseSync({data:F,path:w.path,parent:w});return D.status==="aborted"?INVALID:D.status==="dirty"||g.value==="dirty"?DIRTY(D.value):D}}if(I.type==="refinement"){const F=D=>{const $=I.refinement(D,P);if(w.common.async)return Promise.resolve($);if($ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return D};if(w.common.async===!1){const D=this._def.schema._parseSync({data:w.data,path:w.path,parent:w});return D.status==="aborted"?INVALID:(D.status==="dirty"&&g.dirty(),F(D.value),{status:g.value,value:D.value})}return this._def.schema._parseAsync({data:w.data,path:w.path,parent:w}).then((D=>D.status==="aborted"?INVALID:(D.status==="dirty"&&g.dirty(),F(D.value).then((()=>({status:g.value,value:D.value}))))))}if(I.type==="transform"){if(w.common.async===!1){const F=this._def.schema._parseSync({data:w.data,path:w.path,parent:w});if(!isValid(F))return F;const D=I.transform(F.value,P);if(D instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:g.value,value:D}}return this._def.schema._parseAsync({data:w.data,path:w.path,parent:w}).then((F=>isValid(F)?Promise.resolve(I.transform(F.value,P)).then((D=>({status:g.value,value:D}))):F))}util$1.assertNever(I)}}ZodEffects.create=(d,m,g)=>new ZodEffects({schema:d,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:m,...processCreateParams(g)}),ZodEffects.createWithPreprocess=(d,m,g)=>new ZodEffects({schema:m,effect:{type:"preprocess",transform:d},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(g)});class ZodOptional extends ZodType{_parse(m){return this._getType(m)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(m)}unwrap(){return this._def.innerType}}ZodOptional.create=(d,m)=>new ZodOptional({innerType:d,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(m)});class ZodNullable extends ZodType{_parse(m){return this._getType(m)===ZodParsedType.null?OK(null):this._def.innerType._parse(m)}unwrap(){return this._def.innerType}}ZodNullable.create=(d,m)=>new ZodNullable({innerType:d,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(m)});class ZodDefault extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m);let w=g.data;return g.parsedType===ZodParsedType.undefined&&(w=this._def.defaultValue()),this._def.innerType._parse({data:w,path:g.path,parent:g})}removeDefault(){return this._def.innerType}}ZodDefault.create=(d,m)=>new ZodDefault({innerType:d,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof m.default=="function"?m.default:()=>m.default,...processCreateParams(m)});class ZodCatch extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w={...g,common:{...g.common,issues:[]}},I=this._def.innerType._parse({data:w.data,path:w.path,parent:{...w}});return isAsync(I)?I.then((P=>({status:"valid",value:P.status==="valid"?P.value:this._def.catchValue({get error(){return new ZodError(w.common.issues)},input:w.data})}))):{status:"valid",value:I.status==="valid"?I.value:this._def.catchValue({get error(){return new ZodError(w.common.issues)},input:w.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(d,m)=>new ZodCatch({innerType:d,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof m.catch=="function"?m.catch:()=>m.catch,...processCreateParams(m)});class ZodNaN extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.nan){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:g.parsedType}),INVALID}return{status:"valid",value:m.data}}}ZodNaN.create=d=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(d)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w=g.data;return this._def.type._parse({data:w,path:g.path,parent:g})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.common.async)return(async()=>{const I=await this._def.in._parseAsync({data:w.data,path:w.path,parent:w});return I.status==="aborted"?INVALID:I.status==="dirty"?(g.dirty(),DIRTY(I.value)):this._def.out._parseAsync({data:I.value,path:w.path,parent:w})})();{const I=this._def.in._parseSync({data:w.data,path:w.path,parent:w});return I.status==="aborted"?INVALID:I.status==="dirty"?(g.dirty(),{status:"dirty",value:I.value}):this._def.out._parseSync({data:I.value,path:w.path,parent:w})}}static create(m,g){return new ZodPipeline({in:m,out:g,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(m){const g=this._def.innerType._parse(m),w=I=>(isValid(I)&&(I.value=Object.freeze(I.value)),I);return isAsync(g)?g.then((I=>w(I))):w(g)}unwrap(){return this._def.innerType}}function custom(d,m={},g){return d?ZodAny.create().superRefine(((w,I)=>{var P,F;if(!d(w)){const D=typeof m=="function"?m(w):typeof m=="string"?{message:m}:m,$=(F=(P=D.fatal)!==null&&P!==void 0?P:g)===null||F===void 0||F,U=typeof D=="string"?{message:D}:D;I.addIssue({code:"custom",...U,fatal:$})}})):ZodAny.create()}ZodReadonly.create=(d,m)=>new ZodReadonly({innerType:d,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(m)});const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(d){d.ZodString="ZodString",d.ZodNumber="ZodNumber",d.ZodNaN="ZodNaN",d.ZodBigInt="ZodBigInt",d.ZodBoolean="ZodBoolean",d.ZodDate="ZodDate",d.ZodSymbol="ZodSymbol",d.ZodUndefined="ZodUndefined",d.ZodNull="ZodNull",d.ZodAny="ZodAny",d.ZodUnknown="ZodUnknown",d.ZodNever="ZodNever",d.ZodVoid="ZodVoid",d.ZodArray="ZodArray",d.ZodObject="ZodObject",d.ZodUnion="ZodUnion",d.ZodDiscriminatedUnion="ZodDiscriminatedUnion",d.ZodIntersection="ZodIntersection",d.ZodTuple="ZodTuple",d.ZodRecord="ZodRecord",d.ZodMap="ZodMap",d.ZodSet="ZodSet",d.ZodFunction="ZodFunction",d.ZodLazy="ZodLazy",d.ZodLiteral="ZodLiteral",d.ZodEnum="ZodEnum",d.ZodEffects="ZodEffects",d.ZodNativeEnum="ZodNativeEnum",d.ZodOptional="ZodOptional",d.ZodNullable="ZodNullable",d.ZodDefault="ZodDefault",d.ZodCatch="ZodCatch",d.ZodPromise="ZodPromise",d.ZodBranded="ZodBranded",d.ZodPipeline="ZodPipeline",d.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(d,m={message:`Input not instance of ${d.name}`})=>custom((g=>g instanceof d),m),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:d=>ZodString.create({...d,coerce:!0}),number:d=>ZodNumber.create({...d,coerce:!0}),boolean:d=>ZodBoolean.create({...d,coerce:!0}),bigint:d=>ZodBigInt.create({...d,coerce:!0}),date:d=>ZodDate.create({...d,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util$1},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError}),Edge,Edge2;Edge2=Edge||(Edge={}),Edge2[Edge2.EXTEND=1]="EXTEND",Edge2[Edge2.WRAP=2]="WRAP",Edge2[Edge2.CROP=3]="CROP";const JimpClassSchema=z.object({bitmap:z.object({data:z.union([z.instanceof(Buffer),z.instanceof(Uint8Array)]),width:z.number(),height:z.number()})}),BlitOptionsSchemaComplex=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional(),srcX:z.number().optional(),srcY:z.number().optional(),srcW:z.number().optional(),srcH:z.number().optional()}),BlitOptionsSchema=z.union([JimpClassSchema,BlitOptionsSchemaComplex]),methods$h={blit(d,m){const g=BlitOptionsSchema.parse(m);let{src:w,x:I=0,y:P=0,srcX:F=0,srcY:D=0,srcW:$=w.bitmap.width,srcH:U=w.bitmap.height}="bitmap"in g?{src:g}:g;if(!("bitmap"in w))throw new Error("The source must be a Jimp image");if(typeof I!="number"||typeof P!="number")throw new Error("x and y must be numbers");I=Math.round(I),P=Math.round(P),F=Math.round(F),D=Math.round(D),$=Math.round($),U=Math.round(U);const j=d.bitmap.width,Z=d.bitmap.height;return scan(w,F,D,$,U,(function(G,H,W){const Q=I+G-F,q=P+H-D;if(Q>=0&&q>=0&&j-Q>0&&Z-q>0){const rt=d.getPixelIndex(Q,q),et={r:w.bitmap.data[W]||0,g:w.bitmap.data[W+1]||0,b:w.bitmap.data[W+2]||0,a:w.bitmap.data[W+3]||0},X={r:d.bitmap.data[rt]||0,g:d.bitmap.data[rt+1]||0,b:d.bitmap.data[rt+2]||0,a:d.bitmap.data[rt+3]||0};d.bitmap.data[rt]=(et.a*(et.r-X.r)-X.r+255>>8)+X.r,d.bitmap.data[rt+1]=(et.a*(et.g-X.g)-X.g+255>>8)+X.g,d.bitmap.data[rt+2]=(et.a*(et.b-X.b)-X.b+255>>8)+X.b,d.bitmap.data[rt+3]=limit255(X.a+et.a)}})),d}},mulTable=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],shgTable=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18],methods$g={blur(d,m){if(typeof m!="number")throw new Error("r must be a number");if(m<1)throw new Error("r must be greater than 0");let g,w,I,P,F,D,$,U,j,Z,G,H,W;const Q=d.bitmap.width-1,q=d.bitmap.height-1,rt=m+1,et=mulTable[m],X=shgTable[m],J=[],tt=[],st=[],nt=[],lt=[],at=[];let ct=2;for(;ct-- >0;){for(H=0,W=0,D=0;D<d.bitmap.height;D++){for(g=d.bitmap.data[W]*rt,w=d.bitmap.data[W+1]*rt,I=d.bitmap.data[W+2]*rt,P=d.bitmap.data[W+3]*rt,$=1;$<=m;$++)U=W+(($>Q?Q:$)<<2),g+=d.bitmap.data[U++],w+=d.bitmap.data[U++],I+=d.bitmap.data[U++],P+=d.bitmap.data[U];for(F=0;F<d.bitmap.width;F++)J[H]=g,tt[H]=w,st[H]=I,nt[H]=P,D===0&&(lt[F]=((U=F+rt)<Q?U:Q)<<2,at[F]=(U=F-m)>0?U<<2:0),j=W+lt[F],Z=W+at[F],g+=d.bitmap.data[j++]-d.bitmap.data[Z++],w+=d.bitmap.data[j++]-d.bitmap.data[Z++],I+=d.bitmap.data[j++]-d.bitmap.data[Z++],P+=d.bitmap.data[j]-d.bitmap.data[Z++],H++;W+=d.bitmap.width<<2}for(F=0;F<d.bitmap.width;F++){for(G=F,g=J[G]*rt,w=tt[G]*rt,I=st[G]*rt,P=nt[G]*rt,$=1;$<=m;$++)G+=$>q?0:d.bitmap.width,g+=J[G],w+=tt[G],I+=st[G],P+=nt[G];for(H=F<<2,D=0;D<d.bitmap.height;D++)d.bitmap.data[H]=limit255(g*et>>>X),d.bitmap.data[H+1]=limit255(w*et>>>X),d.bitmap.data[H+2]=limit255(I*et>>>X),d.bitmap.data[H+3]=limit255(P*et>>>X),F===0&&(lt[D]=((U=D+rt)<q?U:q)*d.bitmap.width,at[D]=(U=D-m)>0?U*d.bitmap.width:0),j=F+lt[D],Z=F+at[D],g+=J[j]-J[Z],w+=tt[j]-tt[Z],I+=st[j]-st[Z],P+=nt[j]-nt[Z],H+=d.bitmap.width<<2}}return d},gaussian(d,m){if(typeof m!="number")throw new Error("r must be a number");if(m<1)throw new Error("r must be greater than 0");const g=Math.ceil(2.57*m),w=2*g+1,I=m*m*2,P=I*Math.PI,F=[];for(let D=0;D<w;D++){const $=[];for(let U=0;U<w;U++){const j=(U-g)**2+(D-g)**2;$[U]=Math.exp(-j/I)/P}F.push($)}for(let D=0;D<d.bitmap.height;D++)for(let $=0;$<d.bitmap.width;$++){let U=0,j=0,Z=0,G=0,H=0;for(let W=0;W<w;W++){for(let q=0;q<w;q++){const rt=Math.min(d.bitmap.width-1,Math.max(0,q+$-g)),et=Math.min(d.bitmap.height-1,Math.max(0,W+D-g)),X=F[W][q],J=et*d.bitmap.width+rt<<2;U+=d.bitmap.data[J]*X,j+=d.bitmap.data[J+1]*X,Z+=d.bitmap.data[J+2]*X,G+=d.bitmap.data[J+3]*X,H+=X}const Q=D*d.bitmap.width+$<<2;d.bitmap.data[Q]=Math.round(U/H),d.bitmap.data[Q+1]=Math.round(j/H),d.bitmap.data[Q+2]=Math.round(Z/H),d.bitmap.data[Q+3]=Math.round(G/H)}}return d}},CircleOptionsSchema=z.object({x:z.number().optional(),y:z.number().optional(),radius:z.number().min(0).optional()}),methods$f={circle(d,m={}){const g=CircleOptionsSchema.parse(m),w=g.radius||(d.bitmap.width>d.bitmap.height?d.bitmap.height:d.bitmap.width)/2,I=typeof g.x=="number"?g.x:d.bitmap.width/2,P=typeof g.y=="number"?g.y:d.bitmap.height/2;return d.scan(((F,D,$)=>{const U=Math.sqrt(Math.pow(F-I,2)+Math.pow(D-P,2));w-U<=0?d.bitmap.data[$+3]=0:w-U<1&&(d.bitmap.data[$+3]=255*(w-U))})),d}},ConvolutionMatrixSchema=z.array(z.number()).min(1).array(),ConvolutionComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,edgeHandling:z.nativeEnum(Edge).optional()}),ConvolutionOptionsSchema=z.union([ConvolutionMatrixSchema,ConvolutionComplexOptionsSchema]),ConvoluteComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),ConvoluteOptionsSchema=z.union([ConvolutionMatrixSchema,ConvoluteComplexOptionsSchema]),PixelateSize=z.number().min(1).max(1/0),PixelateComplexOptionsSchema=z.object({size:PixelateSize,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),PixelateOptionsSchema=z.union([PixelateSize,PixelateComplexOptionsSchema]);function applyKernel(d,m,g,w){const I=[0,0,0,0],P=(m.length-1)/2;for(let F=0;F<m.length;F+=1)for(let D=0;D<m[F].length;D+=1){const $=d.getPixelIndex(g+F-P,w+D-P);I[0]+=d.bitmap.data[$]*m[F][D],I[1]+=d.bitmap.data[$+1]*m[F][D],I[2]+=d.bitmap.data[$+2]*m[F][D],I[3]+=d.bitmap.data[$+3]*m[F][D]}return I}function mix(d,m,g=50){return{r:(m.r-d.r)*(g/100)+d.r,g:(m.g-d.g)*(g/100)+d.g,b:(m.b-d.b)*(g/100)+d.b}}const HueActionSchema=z.object({apply:z.literal("hue"),params:z.tuple([z.number().min(-360).max(360)])}),SpinActionSchema=z.object({apply:z.literal("spin"),params:z.tuple([z.number().min(-360).max(360)])}),LightenActionSchema=z.object({apply:z.literal("lighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),RGBColorSchema=z.object({r:z.number().min(0).max(255),g:z.number().min(0).max(255),b:z.number().min(0).max(255)}),MixActionSchema=z.object({apply:z.literal("mix"),params:z.union([z.tuple([RGBColorSchema]),z.tuple([RGBColorSchema,z.number().min(0).max(100)])])}),TintActionSchema=z.object({apply:z.literal("tint"),params:z.tuple([z.number().min(0).max(100)]).optional()}),ShadeActionSchema=z.object({apply:z.literal("shade"),params:z.tuple([z.number().min(0).max(100)]).optional()}),XorActionSchema=z.object({apply:z.literal("xor"),params:z.tuple([RGBColorSchema])}),RedActionSchema=z.object({apply:z.literal("red"),params:z.tuple([z.number().min(-255).max(255)])}),GreenActionSchema=z.object({apply:z.literal("green"),params:z.tuple([z.number().min(-255).max(255)])}),BlueActionSchema=z.object({apply:z.literal("blue"),params:z.tuple([z.number().min(-255).max(255)])}),BrightenActionSchema=z.object({apply:z.literal("brighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DarkenActionSchema=z.object({apply:z.literal("darken"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DesaturateActionSchema=z.object({apply:z.literal("desaturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),SaturateActionSchema=z.object({apply:z.literal("saturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),GrayscaleActionSchema=z.object({apply:z.literal("greyscale"),params:z.tuple([]).optional()}),ColorActionNameSchema=z.union([HueActionSchema,SpinActionSchema,LightenActionSchema,MixActionSchema,TintActionSchema,ShadeActionSchema,XorActionSchema,RedActionSchema,GreenActionSchema,BlueActionSchema,BrightenActionSchema,DarkenActionSchema,DesaturateActionSchema,SaturateActionSchema,GrayscaleActionSchema]);function histogram(d){const m={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return d.scan(((g,w,I)=>{m.r[d.bitmap.data[I+0]]++,m.g[d.bitmap.data[I+1]]++,m.b[d.bitmap.data[I+2]]++})),m}const normalizeValue=function(d,m,g){return 255*(d-m)/(g-m)},getBounds=function(d){return[d.findIndex((m=>m>0)),255-d.slice().reverse().findIndex((m=>m>0))]},methods$e={normalize(d){const m=histogram(d),g={r:getBounds(m.r),g:getBounds(m.g),b:getBounds(m.b)};return d.scan(((w,I,P)=>{const F=d.bitmap.data[P+0],D=d.bitmap.data[P+1],$=d.bitmap.data[P+2];d.bitmap.data[P+0]=normalizeValue(F,g.r[0],g.r[1]),d.bitmap.data[P+1]=normalizeValue(D,g.g[0],g.g[1]),d.bitmap.data[P+2]=normalizeValue($,g.b[0],g.b[1])})),d},invert:d=>(d.scan(((m,g,w)=>{d.bitmap.data[w]=255-d.bitmap.data[w],d.bitmap.data[w+1]=255-d.bitmap.data[w+1],d.bitmap.data[w+2]=255-d.bitmap.data[w+2]})),d),brightness(d,m){if(typeof m!="number")throw new Error("val must be numbers");return d.scan(((g,w,I)=>{d.bitmap.data[I]=limit255(d.bitmap.data[I]*m),d.bitmap.data[I+1]=limit255(d.bitmap.data[I+1]*m),d.bitmap.data[I+2]=limit255(d.bitmap.data[I+2]*m)})),d},contrast(d,m){if(typeof m!="number")throw new Error("val must be numbers");if(m<-1||m>1)throw new Error("val must be a number between -1 and +1");const g=(m+1)/(1-m);function w(I){return(I=Math.floor(g*(I-127)+127))<0?0:I>255?255:I}return d.scan(((I,P,F)=>{d.bitmap.data[F]=w(d.bitmap.data[F]),d.bitmap.data[F+1]=w(d.bitmap.data[F+1]),d.bitmap.data[F+2]=w(d.bitmap.data[F+2])})),d},posterize(d,m){if(typeof m!="number")throw new Error("n must be numbers");return m<2&&(m=2),d.scan(((g,w,I)=>{const P=d.bitmap.data[I],F=d.bitmap.data[I+1],D=d.bitmap.data[I+2];d.bitmap.data[I]=Math.floor(P/255*(m-1))/(m-1)*255,d.bitmap.data[I+1]=Math.floor(F/255*(m-1))/(m-1)*255,d.bitmap.data[I+2]=Math.floor(D/255*(m-1))/(m-1)*255})),d},greyscale:d=>(d.scan(((m,g,w)=>{const I=.2126*d.bitmap.data[w]+.7152*d.bitmap.data[w+1]+.0722*d.bitmap.data[w+2];d.bitmap.data[w]=I,d.bitmap.data[w+1]=I,d.bitmap.data[w+2]=I})),d),opacity(d,m){if(typeof m!="number")throw new Error("f must be a number");if(m<0||m>1)throw new Error("f must be a number from 0 to 1");return d.scan(((g,w,I)=>{const P=d.bitmap.data[I+3]*m;d.bitmap.data[I+3]=P})),d},sepia:d=>(d.scan(((m,g,w)=>{let I=d.bitmap.data[w],P=d.bitmap.data[w+1],F=d.bitmap.data[w+2];I=.393*I+.769*P+.189*F,P=.349*I+.686*P+.168*F,F=.272*I+.534*P+.131*F,d.bitmap.data[w]=I<255?I:255,d.bitmap.data[w+1]=P<255?P:255,d.bitmap.data[w+2]=F<255?F:255})),d),fade(d,m){if(typeof m!="number")throw new Error("f must be a number");if(m<0||m>1)throw new Error("f must be a number from 0 to 1");return this.opacity(d,1-m)},convolution(d,m){const g=ConvolutionOptionsSchema.parse(m),{kernel:w,edgeHandling:I=Edge.EXTEND}="kernel"in g?g:{kernel:g,edgeHandling:void 0};if(!w[0])throw new Error("kernel must be a matrix");const P=Buffer.from(d.bitmap.data),F=w.length,D=w[0].length,$=Math.floor(F/2),U=Math.floor(D/2),j=-$,Z=-U;let G,H,W,Q,q,rt,et,X,J,tt;return d.scan(((st,nt,lt)=>{Q=0,W=0,H=0;for(let at=j;at<=$;at++)for(let ct=Z;ct<=U;ct++)X=st+ct,J=nt+at,G=w[at+$][ct+U],tt=d.getPixelIndex(X,J,I),tt===-1?(et=0,rt=0,q=0):(q=d.bitmap.data[tt+0],rt=d.bitmap.data[tt+1],et=d.bitmap.data[tt+2]),H+=G*q,W+=G*rt,Q+=G*et;H<0&&(H=0),W<0&&(W=0),Q<0&&(Q=0),H>255&&(H=255),W>255&&(W=255),Q>255&&(Q=255),P[lt+0]=H,P[lt+1]=W,P[lt+2]=Q})),d.bitmap.data=P,d},opaque:d=>(d.scan(((m,g,w)=>{d.bitmap.data[w+3]=255})),d),pixelate(d,m){const g=PixelateOptionsSchema.parse(m),{size:w,x:I=0,y:P=0,w:F=d.bitmap.width-I,h:D=d.bitmap.height-P}=typeof g=="number"?{size:g}:g,$=[[1/16,2/16,1/16],[2/16,.25,2/16],[1/16,2/16,1/16]],U=clone(d);return scan(U,I,P,F,D,((j,Z,G)=>{j=w*Math.floor(j/w),Z=w*Math.floor(Z/w);const H=applyKernel(U,$,j,Z);d.bitmap.data[G]=H[0],d.bitmap.data[G+1]=H[1],d.bitmap.data[G+2]=H[2],d.bitmap.data[G+3]=H[3]})),d},convolute(d,m){const g=ConvoluteOptionsSchema.parse(m),{kernel:w,x:I=0,y:P=0,w:F=d.bitmap.width-I,h:D=d.bitmap.height-P}="kernel"in g?g:{kernel:g},$=clone(d);return scan($,I,P,F,D,((U,j,Z)=>{const G=applyKernel($,w,U,j);d.bitmap.data[Z]=limit255(G[0]),d.bitmap.data[Z+1]=limit255(G[1]),d.bitmap.data[Z+2]=limit255(G[2]),d.bitmap.data[Z+3]=limit255(G[3])})),d},color(d,m){if(!m||!Array.isArray(m))throw new Error("actions must be an array");return m.forEach((g=>ColorActionNameSchema.parse(g))),m=m.map((g=>(g.apply!=="xor"&&g.apply!=="mix"||(g.params[0]=tinycolor(g.params[0]).toRgb()),g))),d.scan(((g,w,I)=>{let P={r:d.bitmap.data[I],g:d.bitmap.data[I+1],b:d.bitmap.data[I+2]};const F=(D,$)=>limit255(P[D]+$);m.forEach((D=>{if(D.apply==="mix")P=mix(P,D.params[0],D.params[1]);else if(D.apply==="tint")P=mix(P,{r:255,g:255,b:255},D.params?.[0]);else if(D.apply==="shade")P=mix(P,{r:0,g:0,b:0},D.params?.[0]);else if(D.apply==="xor")P={r:P.r^D.params[0].r,g:P.g^D.params[0].g,b:P.b^D.params[0].b};else if(D.apply==="red")P.r=F("r",D.params[0]);else if(D.apply==="green")P.g=F("g",D.params[0]);else if(D.apply==="blue")P.b=F("b",D.params[0]);else{D.apply==="hue"&&(D.apply="spin");const $=tinycolor(P),U=$[D.apply].bind($);if(!U)throw new Error("action "+D.apply+" not supported");P=U(...D.params||[]).toRgb()}})),d.bitmap.data[I]=P.r,d.bitmap.data[I+1]=P.g,d.bitmap.data[I+2]=P.b})),d}};var lib$1={},ieee754={read:function(d,m,g,w,I){var P,F,D=8*I-w-1,$=(1<<D)-1,U=$>>1,j=-7,Z=g?I-1:0,G=g?-1:1,H=d[m+Z];for(Z+=G,P=H&(1<<-j)-1,H>>=-j,j+=D;j>0;P=256*P+d[m+Z],Z+=G,j-=8);for(F=P&(1<<-j)-1,P>>=-j,j+=w;j>0;F=256*F+d[m+Z],Z+=G,j-=8);if(P===0)P=1-U;else{if(P===$)return F?NaN:1/0*(H?-1:1);F+=Math.pow(2,w),P-=U}return(H?-1:1)*F*Math.pow(2,P-w)},write:function(d,m,g,w,I,P){var F,D,$,U=8*P-I-1,j=(1<<U)-1,Z=j>>1,G=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=w?0:P-1,W=w?1:-1,Q=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(D=isNaN(m)?1:0,F=j):(F=Math.floor(Math.log(m)/Math.LN2),m*($=Math.pow(2,-F))<1&&(F--,$*=2),(m+=F+Z>=1?G/$:G*Math.pow(2,1-Z))*$>=2&&(F++,$/=2),F+Z>=j?(D=0,F=j):F+Z>=1?(D=(m*$-1)*Math.pow(2,I),F+=Z):(D=m*Math.pow(2,Z-1)*Math.pow(2,I),F=0));I>=8;d[g+H]=255&D,H+=W,D/=256,I-=8);for(F=F<<I|D,U+=I;U>0;d[g+H]=255&F,H+=W,F/=256,U-=8);d[g+H-W]|=128*Q}};(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.AnsiStringType=d.StringType=d.BufferType=d.Uint8ArrayType=d.IgnoreType=d.Float80_LE=d.Float80_BE=d.Float64_LE=d.Float64_BE=d.Float32_LE=d.Float32_BE=d.Float16_LE=d.Float16_BE=d.INT64_BE=d.UINT64_BE=d.INT64_LE=d.UINT64_LE=d.INT32_LE=d.INT32_BE=d.INT24_BE=d.INT24_LE=d.INT16_LE=d.INT16_BE=d.INT8=d.UINT32_BE=d.UINT32_LE=d.UINT24_BE=d.UINT24_LE=d.UINT16_BE=d.UINT16_LE=d.UINT8=void 0;const m=ieee754;function g(I){return new DataView(I.buffer,I.byteOffset)}d.UINT8={len:1,get:(I,P)=>g(I).getUint8(P),put:(I,P,F)=>(g(I).setUint8(P,F),P+1)},d.UINT16_LE={len:2,get:(I,P)=>g(I).getUint16(P,!0),put:(I,P,F)=>(g(I).setUint16(P,F,!0),P+2)},d.UINT16_BE={len:2,get:(I,P)=>g(I).getUint16(P),put:(I,P,F)=>(g(I).setUint16(P,F),P+2)},d.UINT24_LE={len:3,get(I,P){const F=g(I);return F.getUint8(P)+(F.getUint16(P+1,!0)<<8)},put(I,P,F){const D=g(I);return D.setUint8(P,255&F),D.setUint16(P+1,F>>8,!0),P+3}},d.UINT24_BE={len:3,get(I,P){const F=g(I);return(F.getUint16(P)<<8)+F.getUint8(P+2)},put(I,P,F){const D=g(I);return D.setUint16(P,F>>8),D.setUint8(P+2,255&F),P+3}},d.UINT32_LE={len:4,get:(I,P)=>g(I).getUint32(P,!0),put:(I,P,F)=>(g(I).setUint32(P,F,!0),P+4)},d.UINT32_BE={len:4,get:(I,P)=>g(I).getUint32(P),put:(I,P,F)=>(g(I).setUint32(P,F),P+4)},d.INT8={len:1,get:(I,P)=>g(I).getInt8(P),put:(I,P,F)=>(g(I).setInt8(P,F),P+1)},d.INT16_BE={len:2,get:(I,P)=>g(I).getInt16(P),put:(I,P,F)=>(g(I).setInt16(P,F),P+2)},d.INT16_LE={len:2,get:(I,P)=>g(I).getInt16(P,!0),put:(I,P,F)=>(g(I).setInt16(P,F,!0),P+2)},d.INT24_LE={len:3,get(I,P){const F=d.UINT24_LE.get(I,P);return F>8388607?F-16777216:F},put(I,P,F){const D=g(I);return D.setUint8(P,255&F),D.setUint16(P+1,F>>8,!0),P+3}},d.INT24_BE={len:3,get(I,P){const F=d.UINT24_BE.get(I,P);return F>8388607?F-16777216:F},put(I,P,F){const D=g(I);return D.setUint16(P,F>>8),D.setUint8(P+2,255&F),P+3}},d.INT32_BE={len:4,get:(I,P)=>g(I).getInt32(P),put:(I,P,F)=>(g(I).setInt32(P,F),P+4)},d.INT32_LE={len:4,get:(I,P)=>g(I).getInt32(P,!0),put:(I,P,F)=>(g(I).setInt32(P,F,!0),P+4)},d.UINT64_LE={len:8,get:(I,P)=>g(I).getBigUint64(P,!0),put:(I,P,F)=>(g(I).setBigUint64(P,F,!0),P+8)},d.INT64_LE={len:8,get:(I,P)=>g(I).getBigInt64(P,!0),put:(I,P,F)=>(g(I).setBigInt64(P,F,!0),P+8)},d.UINT64_BE={len:8,get:(I,P)=>g(I).getBigUint64(P),put:(I,P,F)=>(g(I).setBigUint64(P,F),P+8)},d.INT64_BE={len:8,get:(I,P)=>g(I).getBigInt64(P),put:(I,P,F)=>(g(I).setBigInt64(P,F),P+8)},d.Float16_BE={len:2,get(I,P){return m.read(I,P,!1,10,this.len)},put(I,P,F){return m.write(I,F,P,!1,10,this.len),P+this.len}},d.Float16_LE={len:2,get(I,P){return m.read(I,P,!0,10,this.len)},put(I,P,F){return m.write(I,F,P,!0,10,this.len),P+this.len}},d.Float32_BE={len:4,get:(I,P)=>g(I).getFloat32(P),put:(I,P,F)=>(g(I).setFloat32(P,F),P+4)},d.Float32_LE={len:4,get:(I,P)=>g(I).getFloat32(P,!0),put:(I,P,F)=>(g(I).setFloat32(P,F,!0),P+4)},d.Float64_BE={len:8,get:(I,P)=>g(I).getFloat64(P),put:(I,P,F)=>(g(I).setFloat64(P,F),P+8)},d.Float64_LE={len:8,get:(I,P)=>g(I).getFloat64(P,!0),put:(I,P,F)=>(g(I).setFloat64(P,F,!0),P+8)},d.Float80_BE={len:10,get(I,P){return m.read(I,P,!1,63,this.len)},put(I,P,F){return m.write(I,F,P,!1,63,this.len),P+this.len}},d.Float80_LE={len:10,get(I,P){return m.read(I,P,!0,63,this.len)},put(I,P,F){return m.write(I,F,P,!0,63,this.len),P+this.len}},d.IgnoreType=class{constructor(I){this.len=I}get(I,P){}},d.Uint8ArrayType=class{constructor(I){this.len=I}get(I,P){return I.subarray(P,P+this.len)}},d.BufferType=class{constructor(I){this.len=I}get(I,P){return Buffer.from(I.subarray(P,P+this.len))}},d.StringType=class{constructor(I,P){this.len=I,this.encoding=P}get(I,P){return Buffer.from(I).toString(this.encoding,P,P+this.len)}};class w{constructor(P){this.len=P}static decode(P,F,D){let $="";for(let U=F;U<D;++U)$+=w.codePointToString(w.singleByteDecoder(P[U]));return $}static inRange(P,F,D){return F<=P&&P<=D}static codePointToString(P){return P<=65535?String.fromCharCode(P):(P-=65536,String.fromCharCode(55296+(P>>10),56320+(1023&P)))}static singleByteDecoder(P){if(w.inRange(P,0,127))return P;const F=w.windows1252[P-128];if(F===null)throw Error("invaliding encoding");return F}get(P,F=0){return w.decode(P,F,F+this.len)}}d.AnsiStringType=w,w.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]})(lib$1);var core$1={},ReadStreamTokenizer$1={},AbstractTokenizer$1={},lib={},EndOfFileStream={};(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.EndOfStreamError=d.defaultMessages=void 0,d.defaultMessages="End-Of-Stream";class m extends Error{constructor(){super(d.defaultMessages)}}d.EndOfStreamError=m})(EndOfFileStream);var StreamReader={},Deferred$1={};Object.defineProperty(Deferred$1,"__esModule",{value:!0}),Deferred$1.Deferred=void 0;class Deferred{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((m,g)=>{this.reject=g,this.resolve=m}))}}Deferred$1.Deferred=Deferred,(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.StreamReader=d.EndOfStreamError=void 0;const m=EndOfFileStream,g=Deferred$1;var w=EndOfFileStream;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return w.EndOfStreamError}}),d.StreamReader=class{constructor(I){if(this.s=I,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!I.read||!I.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new m.EndOfStreamError))),this.s.once("error",(P=>this.reject(P))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(I,P,F){const D=await this.read(I,P,F);return this.peekQueue.push(I.subarray(P,P+D)),D}async read(I,P,F){if(F===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new m.EndOfStreamError;let D=F,$=0;for(;this.peekQueue.length>0&&D>0;){const U=this.peekQueue.pop();if(!U)throw new Error("peekData should be defined");const j=Math.min(U.length,D);I.set(U.subarray(0,j),P+$),$+=j,D-=j,j<U.length&&this.peekQueue.push(U.subarray(j))}for(;D>0&&!this.endOfStream;){const U=Math.min(D,1048576),j=await this.readFromStream(I,P+$,U);if($+=j,j<U)break;D-=j}return $}async readFromStream(I,P,F){const D=this.s.read(F);if(D)return I.set(D,P),D.length;{const $={buffer:I,offset:P,length:F,deferred:new g.Deferred};return this.deferred=$.deferred,this.s.once("readable",(()=>{this.readDeferred($)})),$.deferred.promise}}readDeferred(I){const P=this.s.read(I.length);P?(I.buffer.set(P,I.offset),I.deferred.resolve(P.length),this.deferred=null):this.s.once("readable",(()=>{this.readDeferred(I)}))}reject(I){this.endOfStream=!0,this.deferred&&(this.deferred.reject(I),this.deferred=null)}}})(StreamReader),(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.StreamReader=d.EndOfStreamError=void 0;var m=EndOfFileStream;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return m.EndOfStreamError}});var g=StreamReader;Object.defineProperty(d,"StreamReader",{enumerable:!0,get:function(){return g.StreamReader}})})(lib),Object.defineProperty(AbstractTokenizer$1,"__esModule",{value:!0}),AbstractTokenizer$1.AbstractTokenizer=void 0;const peek_readable_1$2=lib;class AbstractTokenizer{constructor(m){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=m||{}}async readToken(m,g=this.position){const w=Buffer.alloc(m.len);if(await this.readBuffer(w,{position:g})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(w,0)}async peekToken(m,g=this.position){const w=Buffer.alloc(m.len);if(await this.peekBuffer(w,{position:g})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(w,0)}async readNumber(m){if(await this.readBuffer(this.numBuffer,{length:m.len})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(this.numBuffer,0)}async peekNumber(m){if(await this.peekBuffer(this.numBuffer,{length:m.len})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(this.numBuffer,0)}async ignore(m){if(this.fileInfo.size!==void 0){const g=this.fileInfo.size-this.position;if(m>g)return this.position+=g,g}return this.position+=m,m}async close(){}normalizeOptions(m,g){if(g&&g.position!==void 0&&g.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return g?{mayBeLess:g.mayBeLess===!0,offset:g.offset?g.offset:0,length:g.length?g.length:m.length-(g.offset?g.offset:0),position:g.position?g.position:this.position}:{mayBeLess:!1,offset:0,length:m.length,position:this.position}}}AbstractTokenizer$1.AbstractTokenizer=AbstractTokenizer,Object.defineProperty(ReadStreamTokenizer$1,"__esModule",{value:!0}),ReadStreamTokenizer$1.ReadStreamTokenizer=void 0;const AbstractTokenizer_1$1=AbstractTokenizer$1,peek_readable_1$1=lib,maxBufferSize=256e3;class ReadStreamTokenizer extends AbstractTokenizer_1$1.AbstractTokenizer{constructor(m,g){super(g),this.streamReader=new peek_readable_1$1.StreamReader(m)}async getFileInfo(){return this.fileInfo}async readBuffer(m,g){const w=this.normalizeOptions(m,g),I=w.position-this.position;if(I>0)return await this.ignore(I),this.readBuffer(m,g);if(I<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(w.length===0)return 0;const P=await this.streamReader.read(m,w.offset,w.length);if(this.position+=P,(!g||!g.mayBeLess)&&P<w.length)throw new peek_readable_1$1.EndOfStreamError;return P}async peekBuffer(m,g){const w=this.normalizeOptions(m,g);let I=0;if(w.position){const P=w.position-this.position;if(P>0){const F=new Uint8Array(w.length+P);return I=await this.peekBuffer(F,{mayBeLess:w.mayBeLess}),m.set(F.subarray(P),w.offset),I-P}if(P<0)throw new Error("Cannot peek from a negative offset in a stream")}if(w.length>0){try{I=await this.streamReader.peek(m,w.offset,w.length)}catch(P){if(g&&g.mayBeLess&&P instanceof peek_readable_1$1.EndOfStreamError)return 0;throw P}if(!w.mayBeLess&&I<w.length)throw new peek_readable_1$1.EndOfStreamError}return I}async ignore(m){const g=Math.min(maxBufferSize,m),w=new Uint8Array(g);let I=0;for(;I<m;){const P=m-I,F=await this.readBuffer(w,{length:Math.min(g,P)});if(F<0)return F;I+=F}return I}}ReadStreamTokenizer$1.ReadStreamTokenizer=ReadStreamTokenizer;var BufferTokenizer$1={};Object.defineProperty(BufferTokenizer$1,"__esModule",{value:!0}),BufferTokenizer$1.BufferTokenizer=void 0;const peek_readable_1=lib,AbstractTokenizer_1=AbstractTokenizer$1;class BufferTokenizer extends AbstractTokenizer_1.AbstractTokenizer{constructor(m,g){super(g),this.uint8Array=m,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:m.length}async readBuffer(m,g){if(g&&g.position){if(g.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=g.position}const w=await this.peekBuffer(m,g);return this.position+=w,w}async peekBuffer(m,g){const w=this.normalizeOptions(m,g),I=Math.min(this.uint8Array.length-w.position,w.length);if(!w.mayBeLess&&I<w.length)throw new peek_readable_1.EndOfStreamError;return m.set(this.uint8Array.subarray(w.position,w.position+I),w.offset),I}async close(){}}BufferTokenizer$1.BufferTokenizer=BufferTokenizer,(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.fromBuffer=d.fromStream=d.EndOfStreamError=void 0;const m=ReadStreamTokenizer$1,g=BufferTokenizer$1;var w=lib;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return w.EndOfStreamError}}),d.fromStream=function(I,P){return P=P||{},new m.ReadStreamTokenizer(I,P)},d.fromBuffer=function(I,P){return new g.BufferTokenizer(I,P)}})(core$1);var util={stringToBytes:d=>[...d].map((m=>m.charCodeAt(0))),tarHeaderChecksumMatches:(d,m=0)=>{const g=parseInt(d.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(g))return!1;let w=256;for(let I=m;I<m+148;I++)w+=d[I];for(let I=m+156;I<m+512;I++)w+=d[I];return g===w},uint32SyncSafeToken:{get:(d,m)=>127&d[m+3]|d[m+2]<<7|d[m+1]<<14|d[m]<<21,len:4}},supported$1={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]};const Token=lib$1,strtok3=core$1,{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=util,supported=supported$1,minimumBytes=4100;async function fromStream(d){const m=await strtok3.fromStream(d);try{return await fromTokenizer(m)}finally{await m.close()}}async function fromBuffer(d){if(!(d instanceof Uint8Array||d instanceof ArrayBuffer||Buffer.isBuffer(d)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof d}\``);const m=d instanceof Buffer?d:Buffer.from(d);if(m&&m.length>1)return fromTokenizer(strtok3.fromBuffer(m))}function _check(d,m,g){g={offset:0,...g};for(const[w,I]of m.entries())if(g.mask){if(I!==(g.mask[w]&d[w+g.offset]))return!1}else if(I!==d[w+g.offset])return!1;return!0}async function fromTokenizer(d){try{return _fromTokenizer(d)}catch(m){if(!(m instanceof strtok3.EndOfStreamError))throw m}}async function _fromTokenizer(d){let m=Buffer.alloc(minimumBytes);const g=(I,P)=>_check(m,I,P),w=(I,P)=>g(stringToBytes(I),P);if(d.fileInfo.size||(d.fileInfo.size=Number.MAX_SAFE_INTEGER),await d.peekBuffer(m,{length:12,mayBeLess:!0}),g([66,77]))return{ext:"bmp",mime:"image/bmp"};if(g([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(g([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(g([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(g([37,33]))return await d.peekBuffer(m,{length:24,mayBeLess:!0}),w("PS-Adobe-",{offset:2})&&w(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(g([31,160])||g([31,157]))return{ext:"Z",mime:"application/x-compress"};if(g([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(g([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(g([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(g([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(w("ID3")){await d.ignore(6);const I=await d.readToken(uint32SyncSafeToken);return d.position+I>d.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await d.ignore(I),fromTokenizer(d))}if(w("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((m[0]===67||m[0]===70)&&g([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(g([71,73,70]))return{ext:"gif",mime:"image/gif"};if(w("FLIF"))return{ext:"flif",mime:"image/flif"};if(w("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(w("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(w("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(w("FORM"))return{ext:"aif",mime:"audio/aiff"};if(w("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(g([80,75,3,4])){try{for(;d.position+30<d.fileInfo.size;){await d.readBuffer(m,{length:30});const I={compressedSize:m.readUInt32LE(18),uncompressedSize:m.readUInt32LE(22),filenameLength:m.readUInt16LE(26),extraFieldLength:m.readUInt16LE(28)};if(I.filename=await d.readToken(new Token.StringType(I.filenameLength,"utf-8")),await d.ignore(I.extraFieldLength),I.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(I.filename.endsWith(".rels")||I.filename.endsWith(".xml"))switch(I.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(I.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(I.filename.startsWith("3D/")&&I.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(I.filename==="mimetype"&&I.compressedSize===I.uncompressedSize)switch(await d.readToken(new Token.StringType(I.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(I.compressedSize===0){let P=-1;for(;P<0&&d.position<d.fileInfo.size;)await d.peekBuffer(m,{mayBeLess:!0}),P=m.indexOf("504B0304",0,"hex"),await d.ignore(P>=0?P:m.length)}else await d.ignore(I.compressedSize)}}catch(I){if(!(I instanceof strtok3.EndOfStreamError))throw I}return{ext:"zip",mime:"application/zip"}}if(w("OggS")){await d.ignore(28);const I=Buffer.alloc(8);return await d.readBuffer(I),_check(I,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(I,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(I,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(I,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(I,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(I,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(g([80,75])&&(m[2]===3||m[2]===5||m[2]===7)&&(m[3]===4||m[3]===6||m[3]===8))return{ext:"zip",mime:"application/zip"};if(w("ftyp",{offset:4})&&96&m[8]){const I=m.toString("binary",8,12).replace("\0"," ").trim();switch(I){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return I.startsWith("3g")?I.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(w("MThd"))return{ext:"mid",mime:"audio/midi"};if(w("wOFF")&&(g([0,1,0,0],{offset:4})||w("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(w("wOF2")&&(g([0,1,0,0],{offset:4})||w("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(g([212,195,178,161])||g([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(w("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(w("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(w("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(g([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(w("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(w("%PDF")){await d.ignore(1350);const I=10485760,P=Buffer.alloc(Math.min(I,d.fileInfo.size));return await d.readBuffer(P,{mayBeLess:!0}),P.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(g([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(g([73,73,42,0]))return w("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:g([28,0,254,0],{offset:8})||g([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:g([8,0,0,0],{offset:4})&&(g([45,0,254,0],{offset:8})||g([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(m=Buffer.alloc(24),await d.peekBuffer(m),(g([16,251,134,1],{offset:4})||g([8,0,0,0],{offset:4}))&&g([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(g([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(w("MAC "))return{ext:"ape",mime:"audio/ape"};if(g([26,69,223,163])){async function I(){const $=await d.peekNumber(Token.UINT8);let U=128,j=0;for(;!($&U)&&U!==0;)++j,U>>=1;const Z=Buffer.alloc(j+1);return await d.readBuffer(Z),Z}async function P(){const $=await I(),U=await I();U[0]^=128>>U.length-1;const j=Math.min(6,U.length);return{id:$.readUIntBE(0,$.length),len:U.readUIntBE(U.length-j,j)}}async function F($,U){for(;U>0;){const j=await P();if(j.id===17026)return d.readToken(new Token.StringType(j.len,"utf-8"));await d.ignore(j.len),--U}}const D=await P();switch(await F(0,D.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(g([82,73,70,70])){if(g([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(g([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(g([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(w("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(g([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(w("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(w("MSCF")||w("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(g([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(g([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(g([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(g([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(w("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(w("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(g([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(w("IMPM"))return{ext:"it",mime:"audio/x-it"};if(w("-lh0-",{offset:2})||w("-lh1-",{offset:2})||w("-lh2-",{offset:2})||w("-lh3-",{offset:2})||w("-lh4-",{offset:2})||w("-lh5-",{offset:2})||w("-lh6-",{offset:2})||w("-lh7-",{offset:2})||w("-lzs-",{offset:2})||w("-lz4-",{offset:2})||w("-lz5-",{offset:2})||w("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(g([0,0,1,186])){if(g([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(g([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(w("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(g([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(w("<?xml "))return{ext:"xml",mime:"application/xml"};if(g([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(g([82,97,114,33,26,7])&&(m[6]===0||m[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(w("solid "))return{ext:"stl",mime:"model/stl"};if(w("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(w("!<arch>"))return await d.ignore(8),await d.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(g([137,80,78,71,13,10,26,10])){async function I(){return{length:await d.readToken(Token.INT32_BE),type:await d.readToken(new Token.StringType(4,"binary"))}}await d.ignore(8);do{const P=await I();if(P.length<0)return;switch(P.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await d.ignore(P.length+4)}}while(d.position+8<d.fileInfo.size);return{ext:"png",mime:"image/png"}}if(g([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(g([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(g([102,114,101,101],{offset:4})||g([109,100,97,116],{offset:4})||g([109,111,111,118],{offset:4})||g([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(g([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(w("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(g([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(g([48,38,178,117,142,102,207,17,166,217])){async function I(){const P=Buffer.alloc(16);return await d.readBuffer(P),{id:P,size:Number(await d.readToken(Token.UINT64_LE))}}for(await d.ignore(30);d.position+24<d.fileInfo.size;){const P=await I();let F=P.size-24;if(_check(P.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const D=Buffer.alloc(16);if(F-=await d.readBuffer(D),_check(D,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(D,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await d.ignore(F)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(g([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((g([126,16,4])||g([126,24,4]))&&g([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(g([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(g([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await d.ignore(20),await d.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(g([255,10])||g([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(g([0,0,1,186])||g([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(g([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(g([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(g([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(g([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await d.peekBuffer(m,{length:Math.min(256,d.fileInfo.size),mayBeLess:!0}),w("BEGIN:")){if(w("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(w("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(w("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(w("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(w("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(g([4,0,0,0])&&m.length>=16){const I=m.readUInt32LE(12);if(I>12&&m.length>=I+16)try{const P=m.slice(16,I+16).toString();if(JSON.parse(P).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(g([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(w("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(g([71],{offset:4})&&(g([71],{offset:192})||g([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(g([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(g([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(g([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(g([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(g([76,80],{offset:34})&&(g([0,0,1],{offset:8})||g([1,0,2],{offset:8})||g([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(g([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await d.peekBuffer(m,{length:Math.min(512,d.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(m))return{ext:"tar",mime:"application/x-tar"};if(g([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(w("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(m.length>=2&&g([255,224],{offset:0,mask:[255,224]})){if(g([16],{offset:1,mask:[22]}))return g([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(g([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(g([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(g([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const d=new stream.PassThrough;let m;m=stream.pipeline?stream.pipeline(readableStream,d,(()=>{})):readableStream.pipe(d);const g=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const w=await fromBuffer(g);d.fileType=w}catch(w){reject(w)}resolve(m)}))})),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)});var core=fileType,fileType$1=getDefaultExportFromCjs(core);function to(d,m){return d.then((function(g){return[null,g]})).catch((function(g){return[g,void 0]}))}const writeFile=async()=>{throw new Error("Not supported")};function Mime$1(){this._types=Object.create(null),this._extensions=Object.create(null);for(let d=0;d<arguments.length;d++)this.define(arguments[d]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime$1.prototype.define=function(d,m){for(let g in d){let w=d[g].map((function(I){return I.toLowerCase()}));g=g.toLowerCase();for(let I=0;I<w.length;I++){const P=w[I];if(P[0]!=="*"){if(!m&&P in this._types)throw new Error('Attempt to change mapping for "'+P+'" extension from "'+this._types[P]+'" to "'+g+'". Pass `force=true` to allow this, otherwise remove "'+P+'" from the list of extensions for "'+g+'".');this._types[P]=g}}if(m||!this._extensions[g]){const I=w[0];this._extensions[g]=I[0]!=="*"?I:I.substr(1)}}},Mime$1.prototype.getType=function(d){let m=(d=String(d)).replace(/^.*[/\\]/,"").toLowerCase(),g=m.replace(/^.*\./,"").toLowerCase(),w=m.length<d.length;return(g.length<m.length-1||!w)&&this._types[g]||null},Mime$1.prototype.getExtension=function(d){return(d=/^\s*([^;\s]*)/.test(d)&&RegExp.$1)&&this._extensions[d.toLowerCase()]||null};var Mime_1=Mime$1,standard={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let Mime=Mime_1;var lite=new Mime(standard),mime=getDefaultExportFromCjs(lite),HorizontalAlign,HorizontalAlign2,VerticalAlign,VerticalAlign2,BlendMode,BlendMode2;function srcOver(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a;return{r:(d.r*d.a+m.r*m.a*(1-d.a))/w,g:(d.g*d.a+m.g*m.a*(1-d.a))/w,b:(d.b*d.a+m.b*m.a*(1-d.a))/w,a:w}}function dstOver(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a;return{r:(m.r*m.a+d.r*d.a*(1-m.a))/w,g:(m.g*m.a+d.g*d.a*(1-m.a))/w,b:(m.b*m.a+d.b*d.a*(1-m.a))/w,a:w}}function multiply(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(I*D+I*(1-m.a)+D*(1-d.a))/w,g:(P*$+P*(1-m.a)+$*(1-d.a))/w,b:(F*U+F*(1-m.a)+U*(1-d.a))/w,a:w}}function add(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a;return{r:(I+m.r*m.a)/w,g:(P+m.g*m.a)/w,b:(F+m.b*m.a)/w,a:w}}function screen(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(I*m.a+D*d.a-I*D+I*(1-m.a)+D*(1-d.a))/w,g:(P*m.a+$*d.a-P*$+P*(1-m.a)+$*(1-d.a))/w,b:(F*m.a+U*d.a-F*U+F*(1-m.a)+U*(1-d.a))/w,a:w}}function overlay(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(2*D<=m.a?2*I*D+I*(1-m.a)+D*(1-d.a):I*(1+m.a)+D*(1+d.a)-2*D*I-m.a*d.a)/w,g:(2*$<=m.a?2*P*$+P*(1-m.a)+$*(1-d.a):P*(1+m.a)+$*(1+d.a)-2*$*P-m.a*d.a)/w,b:(2*U<=m.a?2*F*U+F*(1-m.a)+U*(1-d.a):F*(1+m.a)+U*(1+d.a)-2*U*F-m.a*d.a)/w,a:w}}function darken(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(Math.min(I*m.a,D*d.a)+I*(1-m.a)+D*(1-d.a))/w,g:(Math.min(P*m.a,$*d.a)+P*(1-m.a)+$*(1-d.a))/w,b:(Math.min(F*m.a,U*d.a)+F*(1-m.a)+U*(1-d.a))/w,a:w}}function lighten(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(Math.max(I*m.a,D*d.a)+I*(1-m.a)+D*(1-d.a))/w,g:(Math.max(P*m.a,$*d.a)+P*(1-m.a)+$*(1-d.a))/w,b:(Math.max(F*m.a,U*d.a)+F*(1-m.a)+U*(1-d.a))/w,a:w}}function hardLight(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(2*I<=d.a?2*I*D+I*(1-m.a)+D*(1-d.a):I*(1+m.a)+D*(1+d.a)-2*D*I-m.a*d.a)/w,g:(2*P<=d.a?2*P*$+P*(1-m.a)+$*(1-d.a):P*(1+m.a)+$*(1+d.a)-2*$*P-m.a*d.a)/w,b:(2*F<=d.a?2*F*U+F*(1-m.a)+U*(1-d.a):F*(1+m.a)+U*(1+d.a)-2*U*F-m.a*d.a)/w,a:w}}function difference(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(I+D-2*Math.min(I*m.a,D*d.a))/w,g:(P+$-2*Math.min(P*m.a,$*d.a))/w,b:(F+U-2*Math.min(F*m.a,U*d.a))/w,a:w}}function exclusion(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,$=m.g*m.a,U=m.b*m.a;return{r:(I*m.a+D*d.a-2*I*D+I*(1-m.a)+D*(1-d.a))/w,g:(P*m.a+$*d.a-2*P*$+P*(1-m.a)+$*(1-d.a))/w,b:(F*m.a+U*d.a-2*F*U+F*(1-m.a)+U*(1-d.a))/w,a:w}}HorizontalAlign2=HorizontalAlign||(HorizontalAlign={}),HorizontalAlign2[HorizontalAlign2.LEFT=1]="LEFT",HorizontalAlign2[HorizontalAlign2.CENTER=2]="CENTER",HorizontalAlign2[HorizontalAlign2.RIGHT=4]="RIGHT",VerticalAlign2=VerticalAlign||(VerticalAlign={}),VerticalAlign2[VerticalAlign2.TOP=8]="TOP",VerticalAlign2[VerticalAlign2.MIDDLE=16]="MIDDLE",VerticalAlign2[VerticalAlign2.BOTTOM=32]="BOTTOM",BlendMode2=BlendMode||(BlendMode={}),BlendMode2.SRC_OVER="srcOver",BlendMode2.DST_OVER="dstOver",BlendMode2.MULTIPLY="multiply",BlendMode2.ADD="add",BlendMode2.SCREEN="screen",BlendMode2.OVERLAY="overlay",BlendMode2.DARKEN="darken",BlendMode2.LIGHTEN="lighten",BlendMode2.HARD_LIGHT="hardLight",BlendMode2.DIFFERENCE="difference",BlendMode2.EXCLUSION="exclusion";const names=[srcOver,dstOver,multiply,add,screen,overlay,darken,lighten,hardLight,difference,exclusion];var compositeModes=Object.freeze({__proto__:null,add,darken,difference,dstOver,exclusion,hardLight,lighten,multiply,names,overlay,screen,srcOver});function composite(d,m,g=0,w=0,I={}){if(!(m instanceof d.constructor))throw new Error("The source must be a Jimp image");if(typeof g!="number"||typeof w!="number")throw new Error("x and y must be numbers");const{mode:P=BlendMode.SRC_OVER}=I;let{opacitySource:F=1,opacityDest:D=1}=I;(typeof F!="number"||F<0||F>1)&&(F=1),(typeof D!="number"||D<0||D>1)&&(D=1);const $=compositeModes[P];return g=Math.round(g),w=Math.round(w),D!==1&&d.scan(((U,j,Z)=>{const G=d.bitmap.data[Z+3]*D;d.bitmap.data[Z+3]=G})),m.scan(((U,j,Z)=>{const G=d.getPixelIndex(g+U,w+j,Edge.CROP);if(G===-1)return;const H=$({r:m.bitmap.data[Z+0]/255,g:m.bitmap.data[Z+1]/255,b:m.bitmap.data[Z+2]/255,a:m.bitmap.data[Z+3]/255},{r:d.bitmap.data[G+0]/255,g:d.bitmap.data[G+1]/255,b:d.bitmap.data[G+2]/255,a:d.bitmap.data[G+3]/255},F);d.bitmap.data[G+0]=limit255(255*H.r),d.bitmap.data[G+1]=limit255(255*H.g),d.bitmap.data[G+2]=limit255(255*H.b),d.bitmap.data[G+3]=limit255(255*H.a)})),d}var jpeg$1={parseSections:function(d,m){var g,w;for(d.setBigEndian(!0);d.remainingLength()>0&&w!==218;){if(d.nextUInt8()!==255)throw new Error("Invalid JPEG section offset");g=(w=d.nextUInt8())>=208&&w<=217||w===218?0:d.nextUInt16()-2,m(w,d.branch(0,g)),d.skip(g)}},getSizeFromSOFSection:function(d){return d.skip(1),{height:d.nextUInt16(),width:d.nextUInt16()}},getSectionName:function(d){var m,g;switch(d){case 216:m="SOI";break;case 196:m="DHT";break;case 219:m="DQT";break;case 221:m="DRI";break;case 218:m="SOS";break;case 254:m="COM";break;case 217:m="EOI";break;default:d>=224&&d<=239?(m="APP",g=d-224):d>=192&&d<=207&&d!==196&&d!==200&&d!==204?(m="SOF",g=d-192):d>=208&&d<=215&&(m="RST",g=d-208)}var w={name:m};return typeof g=="number"&&(w.index=g),w}};function readExifValue(d,m){switch(d){case 1:return m.nextUInt8();case 3:case 8:return m.nextUInt16();case 4:case 9:return m.nextUInt32();case 5:return[m.nextUInt32(),m.nextUInt32()];case 6:return m.nextInt8();case 10:return[m.nextInt32(),m.nextInt32()];case 11:return m.nextFloat();case 12:return m.nextDouble();default:throw new Error("Invalid format while decoding: "+d)}}function getBytesPerComponent(d){switch(d){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function readExifTag(d,m){var g,w,I=m.nextUInt16(),P=m.nextUInt16(),F=getBytesPerComponent(P),D=m.nextUInt32(),$=F*D;if($>4&&(m=d.openWithOffset(m.nextUInt32())),P===2){var U=(g=m.nextString(D)).indexOf("\0");U!==-1&&(g=g.substr(0,U))}else if(P===7)g=m.nextBuffer(D);else if(P!==0)for(g=[],w=0;w<D;++w)g.push(readExifValue(P,m));return $<4&&m.skip(4-$),[I,g,P]}function readIFDSection(d,m,g){var w,I,P=m.nextUInt16();for(I=0;I<P;++I)g((w=readExifTag(d,m))[0],w[1],w[2])}function readHeader(d){if(d.nextString(6)!=="Exif\0\0")throw new Error("Invalid EXIF header");var m=d.mark(),g=d.nextUInt16();if(g===18761)d.setBigEndian(!1);else{if(g!==19789)throw new Error("Invalid TIFF header");d.setBigEndian(!0)}if(d.nextUInt16()!==42)throw new Error("Invalid TIFF data");return m}var exif$2={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(d,m){var g,w,I,P;try{g=readHeader(d)}catch{return!1}var F=g.openWithOffset(d.nextUInt32()),D=this.IFD0;readIFDSection(g,F,(function(W,Q,q){switch(W){case 34853:I=Q[0];break;case 34665:w=Q[0];break;default:m(D,W,Q,q)}}));var $=F.nextUInt32();if($!==0){var U=g.openWithOffset($);readIFDSection(g,U,m.bind(null,this.IFD1))}if(I){var j=g.openWithOffset(I);readIFDSection(g,j,m.bind(null,this.GPSIFD))}if(w){var Z=g.openWithOffset(w),G=this.InteropIFD;readIFDSection(g,Z,(function(W,Q,q){W===40965?P=Q[0]:m(G,W,Q,q)}))}if(P){var H=g.openWithOffset(P);readIFDSection(g,H,m.bind(null,this.InteropIFD))}return!0}};function parseNumber(d){return parseInt(d,10)}var hours=3600,minutes=60;function parseDateTimeParts(d,m){d=d.map(parseNumber),m=m.map(parseNumber);var g=d[0],w=d[1]-1,I=d[2],P=m[0],F=m[1],D=m[2];return Date.UTC(g,w,I,P,F,D,0)/1e3}function parseDateWithTimezoneFormat(d){var m=d.substr(0,10).split("-"),g=d.substr(11,8).split(":"),w=d.substr(19,6).split(":").map(parseNumber),I=w[0]*hours+w[1]*minutes,P=parseDateTimeParts(m,g);if(typeof(P-=I)=="number"&&!isNaN(P))return P}function parseDateWithSpecFormat(d){var m=d.split(" "),g=parseDateTimeParts(m[0].split(":"),m[1].split(":"));if(typeof g=="number"&&!isNaN(g))return g}function parseExifDate(d){var m=d.length===19&&d.charAt(4)===":";return d.length===25&&d.charAt(10)==="T"?parseDateWithTimezoneFormat(d):m?parseDateWithSpecFormat(d):void 0}var date$1={parseDateWithSpecFormat,parseDateWithTimezoneFormat,parseExifDate},exif$1=exif$2,date=date$1,degreeTags=[{section:exif$1.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:exif$1.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],dateTags=[{section:exif$1.SubIFD,type:306,name:"ModifyDate"},{section:exif$1.SubIFD,type:36867,name:"DateTimeOriginal"},{section:exif$1.SubIFD,type:36868,name:"CreateDate"},{section:exif$1.SubIFD,type:306,name:"ModifyDate"}],simplify$1={castDegreeValues:function(d,m){degreeTags.forEach((function(g){var w=d(g);if(w){var I=d({section:g.section,type:g.refType,name:g.refName})===g.posVal?1:-1,P=(w[0]+w[1]/60+w[2]/3600)*I;m(g,P)}}))},castDateValues:function(d,m){dateTags.forEach((function(g){var w=d(g);if(w){var I=date.parseExifDate(w);I!==void 0&&m(g,I)}}))},simplifyValue:function(d,m){return Array.isArray(d)&&(d=d.map((function(g){return m===10||m===5?g[0]/g[1]:g}))).length===1&&(d=d[0]),d}},exifTags,hasRequiredExifTags;function requireExifTags(){return hasRequiredExifTags?exifTags:(hasRequiredExifTags=1,exifTags={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}})}var jpeg=jpeg$1,exif=exif$2,simplify=simplify$1;function ExifResult(d,m,g,w,I,P,F){this.startMarker=d,this.tags=m,this.imageSize=g,this.thumbnailOffset=w,this.thumbnailLength=I,this.thumbnailType=P,this.app1Offset=F}function Parser$1(d){this.stream=d,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}ExifResult.prototype={hasThumbnail:function(d){return!(!this.thumbnailOffset||!this.thumbnailLength)&&(typeof d!="string"||(d.toLowerCase().trim()==="image/jpeg"?this.thumbnailType===6:d.toLowerCase().trim()==="image/tiff"&&this.thumbnailType===1))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var d,m=this._getThumbnailStream();return jpeg.parseSections(m,(function(g,w){jpeg.getSectionName(g).name==="SOF"&&(d=jpeg.getSizeFromSOFSection(w))})),d}},Parser$1.prototype={enableBinaryFields:function(d){return this.flags.readBinaryTags=!!d,this},enablePointers:function(d){return this.flags.hidePointers=!d,this},enableTagNames:function(d){return this.flags.resolveTagNames=!!d,this},enableImageSize:function(d){return this.flags.imageSize=!!d,this},enableReturnTags:function(d){return this.flags.returnTags=!!d,this},enableSimpleValues:function(d){return this.flags.simplifyValues=!!d,this},parse:function(){var d,m,g,w,I,P,F,D,$,U=this.stream.mark(),j=U.openWithOffset(0),Z=this.flags;return Z.resolveTagNames&&(F=requireExifTags()),Z.resolveTagNames?(d={},D=function(G){return d[G.name]},$=function(G,H){d[G.name]=H}):(d=[],D=function(G){var H;for(H=0;H<d.length;++H)if(d[H].type===G.type&&d[H].section===G.section)return d.value},$=function(G,H){var W;for(W=0;W<d.length;++W)if(d[W].type===G.type&&d[W].section===G.section)return void(d.value=H)}),jpeg.parseSections(j,(function(G,H){var W=H.offsetFrom(U);G===225?exif.parseTags(H,(function(Q,q,rt,et){if(Z.readBinaryTags||et!==7){if(q===513){if(g=rt[0],Z.hidePointers)return}else if(q===514){if(w=rt[0],Z.hidePointers)return}else if(q===259&&(I=rt[0],Z.hidePointers))return;if(Z.returnTags)if(Z.simplifyValues&&(rt=simplify.simplifyValue(rt,et)),Z.resolveTagNames){var X=(Q===exif.GPSIFD?F.gps:F.exif)[q];X||(X=F.exif[q]),d.hasOwnProperty(X)||(d[X]=rt)}else d.push({section:Q,type:q,value:rt})}}))&&(P=W):Z.imageSize&&jpeg.getSectionName(G).name==="SOF"&&(m=jpeg.getSizeFromSOFSection(H))})),Z.simplifyValues&&(simplify.castDegreeValues(D,$),simplify.castDateValues(D,$)),new ExifResult(U,d,m,g,w,I,P)}};var parser=Parser$1,domBufferstream,hasRequiredDomBufferstream,bufferstream,hasRequiredBufferstream;function requireDomBufferstream(){if(hasRequiredDomBufferstream)return domBufferstream;function d(m,g,w,I,P,F){this.global=P,g=g||0,w=w||m.byteLength-g,this.arrayBuffer=m.slice(g,g+w),this.view=new P.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(I),this.offset=0,this.parentOffset=(F||0)+g}return hasRequiredDomBufferstream=1,d.prototype={setBigEndian:function(m){this.littleEndian=!m},nextUInt8:function(){var m=this.view.getUint8(this.offset);return this.offset+=1,m},nextInt8:function(){var m=this.view.getInt8(this.offset);return this.offset+=1,m},nextUInt16:function(){var m=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,m},nextUInt32:function(){var m=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,m},nextInt16:function(){var m=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,m},nextInt32:function(){var m=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,m},nextFloat:function(){var m=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,m},nextDouble:function(){var m=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,m},nextBuffer:function(m){var g=this.arrayBuffer.slice(this.offset,this.offset+m);return this.offset+=m,g},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(m){var g=this.arrayBuffer.slice(this.offset,this.offset+m);return g=String.fromCharCode.apply(null,new this.global.Uint8Array(g)),this.offset+=m,g},mark:function(){var m=this;return{openWithOffset:function(g){return g=(g||0)+this.offset,new d(m.arrayBuffer,g,m.arrayBuffer.byteLength-g,!m.littleEndian,m.global,m.parentOffset)},offset:this.offset,getParentOffset:function(){return m.parentOffset}}},offsetFrom:function(m){return this.parentOffset+this.offset-(m.offset+m.getParentOffset())},skip:function(m){this.offset+=m},branch:function(m,g){return g=typeof g=="number"?g:this.arrayBuffer.byteLength-(this.offset+m),new d(this.arrayBuffer,this.offset+m,g,!this.littleEndian,this.global,this.parentOffset)}},domBufferstream=d}function requireBufferstream(){if(hasRequiredBufferstream)return bufferstream;function d(m,g,w,I){this.buffer=m,this.offset=g||0,w=typeof w=="number"?w:m.length,this.endPosition=this.offset+w,this.setBigEndian(I)}return hasRequiredBufferstream=1,d.prototype={setBigEndian:function(m){this.bigEndian=!!m},nextUInt8:function(){var m=this.buffer.readUInt8(this.offset);return this.offset+=1,m},nextInt8:function(){var m=this.buffer.readInt8(this.offset);return this.offset+=1,m},nextUInt16:function(){var m=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,m},nextUInt32:function(){var m=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,m},nextInt16:function(){var m=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,m},nextInt32:function(){var m=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,m},nextFloat:function(){var m=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,m},nextDouble:function(){var m=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,m},nextBuffer:function(m){var g=this.buffer.slice(this.offset,this.offset+m);return this.offset+=m,g},remainingLength:function(){return this.endPosition-this.offset},nextString:function(m){var g=this.buffer.toString("utf8",this.offset,this.offset+m);return this.offset+=m,g},mark:function(){var m=this;return{openWithOffset:function(g){return g=(g||0)+this.offset,new d(m.buffer,g,m.endPosition-g,m.bigEndian)},offset:this.offset}},offsetFrom:function(m){return this.offset-m.offset},skip:function(m){this.offset+=m},branch:function(m,g){return g=typeof g=="number"?g:this.endPosition-(this.offset+m),new d(this.buffer,this.offset+m,g,this.bigEndian)}},bufferstream=d}var Parser=parser;function getGlobal(){return(0,eval)("this")}var exifParser={create:function(d,m){if(d instanceof(m=m||getGlobal()).ArrayBuffer){var g=requireDomBufferstream();return new Parser(new g(d,0,d.byteLength,!0,m))}var w=requireBufferstream();return new Parser(new w(d,0,d.length,!0))}},EXIFParser=getDefaultExportFromCjs(exifParser);function getExifOrientation(d){const m=d._exif;return m&&m.tags&&m.tags.Orientation||1}function getExifOrientationTransformation(d){const m=d.bitmap.width,g=d.bitmap.height;switch(getExifOrientation(d)){case 1:default:return null;case 2:return function(w,I){return[m-w-1,I]};case 3:return function(w,I){return[m-w-1,g-I-1]};case 4:return function(w,I){return[w,g-I-1]};case 5:return function(w,I){return[I,w]};case 6:return function(w,I){return[I,g-w-1]};case 7:return function(w,I){return[m-I-1,g-w-1]};case 8:return function(w,I){return[m-I-1,w]}}}function transformBitmap(d,m,g,w){const I=d.bitmap.data,P=d.bitmap.width,F=Buffer.alloc(I.length);for(let D=0;D<m;D++)for(let $=0;$<g;$++){const[U,j]=w(D,$),Z=m*$+D<<2,G=P*j+U<<2,H=I.readUInt32BE(G);F.writeUInt32BE(H,Z)}d.bitmap.data=F,d.bitmap.width=m,d.bitmap.height=g,d._exif.tags.Orientation=1}function exifRotate(d){if(getExifOrientation(d)<2)return;const m=getExifOrientationTransformation(d),g=getExifOrientation(d)>4,w=g?d.bitmap.height:d.bitmap.width,I=g?d.bitmap.width:d.bitmap.height;m&&transformBitmap(d,w,I,m)}async function attemptExifRotate(d,m){try{d._exif=EXIFParser.create(m).parse(),exifRotate(d)}catch{}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(d,m,g)=>m in d?__defProp$2(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__publicField$2=(d,m,g)=>__defNormalProp$2(d,typeof m!="symbol"?m+"":m,g);const emptyBitmap={data:Buffer.alloc(0),width:0,height:0};function bufferFromArrayBuffer(d){const m=Buffer.alloc(d.byteLength),g=new Uint8Array(d);for(let w=0;w<m.length;++w)m[w]=g[w];return m}function createJimp({plugins:d,formats:m}={}){const g=d||[],w=(m||[]).map((P=>P())),I=class{constructor(P=emptyBitmap){if(__publicField$2(this,"bitmap",emptyBitmap),__publicField$2(this,"background",0),__publicField$2(this,"formats",[]),__publicField$2(this,"mime"),this.formats=w,"data"in P)this.bitmap=P;else if(this.bitmap={data:Buffer.alloc(P.width*P.height*4),width:P.width,height:P.height},P.color){this.background=typeof P.color=="string"?cssColorToHex(P.color):P.color;for(let F=0;F<this.bitmap.data.length;F+=4)this.bitmap.data.writeUInt32BE(this.background,F)}for(const F of g)for(const D in F)this[D]=(...$)=>{const U=F[D]?.(this,...$);return typeof U=="object"&&"bitmap"in U?(this.bitmap=U.bitmap,this):U}}static async read(P,F){if(Buffer.isBuffer(P)||P instanceof ArrayBuffer)return this.fromBuffer(P);const[D,$]=await to(fetch(P));if(D)throw new Error(`Could not load Buffer from URL: ${P}`);if(!$.ok)throw new Error(`HTTP Status ${$.status} for url ${P}`);const[U,j]=await to($.arrayBuffer());if(U)throw new Error(`Could not load Buffer from ${P}`);const Z=bufferFromArrayBuffer(j);return this.fromBuffer(Z,F)}static fromBitmap(P){let F;if(P.data instanceof Buffer&&(F=Buffer.from(P.data)),(P.data instanceof Uint8Array||P.data instanceof Uint8ClampedArray)&&(F=Buffer.from(P.data.buffer)),Array.isArray(P.data)&&(F=Buffer.concat(P.data.map((D=>Buffer.from(D.toString(16).padStart(8,"0"),"hex"))))),!F)throw new Error("data must be a Buffer");if(typeof P.height!="number"||typeof P.width!="number")throw new Error("bitmap must have width and height");return new I({height:P.height,width:P.width,data:F})}static async fromBuffer(P,F){const D=P instanceof ArrayBuffer?bufferFromArrayBuffer(P):P,$=await fileType$1.fromBuffer(D);if(!$||!$.mime)throw new Error("Could not find MIME for Buffer");const U=w.find((Z=>Z.mime===$.mime));if(!U||!U.decode)throw new Error(`Mime type ${$.mime} does not support decoding`);const j=new I(await U.decode(D,F?.[U.mime]));return j.mime=$.mime,attemptExifRotate(j,D),j}inspect(){return"<Jimp "+(this.bitmap===emptyBitmap?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}toString(){return"[object Jimp]"}get width(){return this.bitmap.width}get height(){return this.bitmap.height}async getBuffer(P,F){const D=this.formats.find((U=>U.mime===P));if(!D||!D.encode)throw new Error(`Unsupported MIME type: ${P}`);let $;return D.hasAlpha?$=this:($=new I({width:this.bitmap.width,height:this.bitmap.height,color:this.background}),composite($,this)),D.encode($.bitmap,F)}async getBase64(P,F){return"data:"+P+";base64,"+(await this.getBuffer(P,F)).toString("base64")}async write(P,F){const D=mime.getType(P);await writeFile(P,await this.getBuffer(D,F))}clone(){return new I({...this.bitmap,data:Buffer.from(this.bitmap.data)})}getPixelIndex(P,F,D){let $,U;if(D||(D=Edge.EXTEND),typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");$=P=Math.round(P),U=F=Math.round(F),D===Edge.EXTEND&&(P<0&&($=0),P>=this.bitmap.width&&($=this.bitmap.width-1),F<0&&(U=0),F>=this.bitmap.height&&(U=this.bitmap.height-1)),D===Edge.WRAP&&(P<0&&($=this.bitmap.width+P),P>=this.bitmap.width&&($=P%this.bitmap.width),F<0&&(U=this.bitmap.height+F),F>=this.bitmap.height&&(U=F%this.bitmap.height));let j=this.bitmap.width*U+$<<2;return($<0||$>=this.bitmap.width)&&(j=-1),(U<0||U>=this.bitmap.height)&&(j=-1),j}getPixelColor(P,F){if(typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");const D=this.getPixelIndex(P,F);return this.bitmap.data.readUInt32BE(D)}setPixelColor(P,F,D){if(typeof P!="number"||typeof F!="number"||typeof D!="number")throw new Error("hex, x and y must be numbers");const $=this.getPixelIndex(F,D);return this.bitmap.data.writeUInt32BE(P,$),this}hasAlpha(){const{width:P,height:F,data:D}=this.bitmap,$=P*F<<2;for(let U=3;U<$;U+=4)if(D[U]!==255)return!0;return!1}composite(P,F=0,D=0,$={}){return composite(this,P,F,D,$)}scan(P,F,D,$,U){return scan(this,P,F,D,$,U)}scanIterator(P=0,F=0,D=this.bitmap.width,$=this.bitmap.height){if(typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");if(typeof D!="number"||typeof $!="number")throw new Error("w and h must be numbers");return scanIterator(this,P,F,D,$)}};return I}var ResizeStrategy,ResizeStrategy2;function Resize(d,m,g,w,I,P,F){this.widthOriginal=Math.abs(Math.floor(d)||0),this.heightOriginal=Math.abs(Math.floor(m)||0),this.targetWidth=Math.abs(Math.floor(g)||0),this.targetHeight=Math.abs(Math.floor(w)||0),this.colorChannels=I?4:3,this.interpolationPass=!!P,this.resizeCallback=typeof F=="function"?F:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}ResizeStrategy2=ResizeStrategy||(ResizeStrategy={}),ResizeStrategy2.NEAREST_NEIGHBOR="nearestNeighbor",ResizeStrategy2.BILINEAR="bilinearInterpolation",ResizeStrategy2.BICUBIC="bicubicInterpolation",ResizeStrategy2.HERMITE="hermiteInterpolation",ResizeStrategy2.BEZIER="bezierInterpolation",Resize.prototype.initialize=function(){if(!(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0))throw console.log(this),new Error("Invalid settings specified for the resizer.");this.configurePasses()},Resize.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB))},Resize.prototype._resizeWidthInterpolatedRGBChannels=function(d,m){const g=m?4:3,w=this.ratioWeightWidthPass,I=this.widthBuffer;let P,F,D=0,$=0,U=0,j=0,Z=0;for(P=0;D<1/3;P+=g,D+=w)for($=P,U=0;$<this.widthPassResultSize;U+=this.originalWidthMultipliedByChannels,$+=this.targetWidthMultipliedByChannels)I[$]=d[U],I[$+1]=d[U+1],I[$+2]=d[U+2],m&&(I[$+3]=d[U+3]);for(D-=1/3,F=this.widthOriginal-1;D<F;P+=g,D+=w)for(Z=D%1,j=1-Z,$=P,U=Math.floor(D)*g;$<this.widthPassResultSize;U+=this.originalWidthMultipliedByChannels,$+=this.targetWidthMultipliedByChannels)I[$+0]=d[U+0]*j+d[U+g+0]*Z,I[$+1]=d[U+1]*j+d[U+g+1]*Z,I[$+2]=d[U+2]*j+d[U+g+2]*Z,m&&(I[$+3]=d[U+3]*j+d[U+g+3]*Z);for(F=this.originalWidthMultipliedByChannels-g;P<this.targetWidthMultipliedByChannels;P+=g)for($=P,U=F;$<this.widthPassResultSize;U+=this.originalWidthMultipliedByChannels,$+=this.targetWidthMultipliedByChannels)I[$]=d[U],I[$+1]=d[U+1],I[$+2]=d[U+2],m&&(I[$+3]=d[U+3]);return I},Resize.prototype._resizeWidthRGBChannels=function(d,m){const g=m?4:3,w=this.ratioWeightWidthPass,I=1/w,P=this.originalWidthMultipliedByChannels-g+1,F=this.targetWidthMultipliedByChannels-g+1,D=this.outputWidthWorkBench,$=this.widthBuffer,U=this.outputWidthWorkBenchOpaquePixelsCount;let j=0,Z=0,G=0,H=0,W=0,Q=0,q=0,rt=1,et=0,X=0,J=0,tt=0;do{for(W=0;W<this.originalHeightMultipliedByChannels;)D[W++]=0,D[W++]=0,D[W++]=0,m&&(D[W++]=0,U[W/g-1]=0);j=w;do{for(Z=1+G-H,rt=Math.min(j,Z),W=0,Q=G;W<this.originalHeightMultipliedByChannels;Q+=P)et=d[Q],X=d[++Q],J=d[++Q],tt=m?d[++Q]:255,D[W++]+=(tt?et:0)*rt,D[W++]+=(tt?X:0)*rt,D[W++]+=(tt?J:0)*rt,m&&(D[W++]+=tt*rt,U[W/g-1]+=tt?rt:0);if(!(j>=Z)){H+=j;break}G+=g,H=G,j-=Z}while(j>0&&G<this.originalWidthMultipliedByChannels);for(W=0,Q=q;W<this.originalHeightMultipliedByChannels;Q+=F)j=m?U[W/g]:1,rt=m?j?1/j:0:I,$[Q]=D[W++]*rt,$[++Q]=D[W++]*rt,$[++Q]=D[W++]*rt,m&&($[++Q]=D[W++]*I);q+=g}while(q<this.targetWidthMultipliedByChannels);return $},Resize.prototype._resizeHeightRGBChannels=function(d,m){const g=this.ratioWeightHeightPass,w=1/g,I=this.outputHeightWorkBench,P=this.heightBuffer,F=this.outputHeightWorkBenchOpaquePixelsCount;let D=0,$=0,U=0,j=0,Z=0,G=0,H=0,W=1,Q=0,q=0,rt=0,et=0;do{for(Z=0;Z<this.targetWidthMultipliedByChannels;)I[Z++]=0,I[Z++]=0,I[Z++]=0,m&&(I[Z++]=0,F[Z/4-1]=0);D=g;do{for($=1+U-j,W=Math.min(D,$),H=U,Z=0;Z<this.targetWidthMultipliedByChannels;)Q=d[H++],q=d[H++],rt=d[H++],et=m?d[H++]:255,I[Z++]+=(et?Q:0)*W,I[Z++]+=(et?q:0)*W,I[Z++]+=(et?rt:0)*W,m&&(I[Z++]+=et*W,F[Z/4-1]+=et?W:0);if(!(D>=$)){j+=D;break}U=H,j=U,D-=$}while(D>0&&U<this.widthPassResultSize);for(Z=0;Z<this.targetWidthMultipliedByChannels;)D=m?F[Z/4]:1,W=m?D?1/D:0:w,P[G++]=Math.round(I[Z++]*W),P[G++]=Math.round(I[Z++]*W),P[G++]=Math.round(I[Z++]*W),m&&(P[G++]=Math.round(I[Z++]*w))}while(G<this.finalResultSize);return P},Resize.prototype.resizeWidthInterpolatedRGB=function(d){return this._resizeWidthInterpolatedRGBChannels(d,!1)},Resize.prototype.resizeWidthInterpolatedRGBA=function(d){return this._resizeWidthInterpolatedRGBChannels(d,!0)},Resize.prototype.resizeWidthRGB=function(d){return this._resizeWidthRGBChannels(d,!1)},Resize.prototype.resizeWidthRGBA=function(d){return this._resizeWidthRGBChannels(d,!0)},Resize.prototype.resizeHeightInterpolated=function(d){const m=this.ratioWeightHeightPass,g=this.heightBuffer;let w,I=0,P=0,F=0,D=0,$=0,U=0,j=0;for(;I<1/3;I+=m)for(F=0;F<this.targetWidthMultipliedByChannels;)g[P++]=Math.round(d[F++]);for(I-=1/3,w=this.heightOriginal-1;I<w;I+=m)for(j=I%1,U=1-j,D=Math.floor(I)*this.targetWidthMultipliedByChannels,$=D+this.targetWidthMultipliedByChannels,F=0;F<this.targetWidthMultipliedByChannels;++F)g[P++]=Math.round(d[D++]*U+d[$++]*j);for(;P<this.finalResultSize;)for(F=0,D=w*this.targetWidthMultipliedByChannels;F<this.targetWidthMultipliedByChannels;++F)g[P++]=Math.round(d[D++]);return g},Resize.prototype.resizeHeightRGB=function(d){return this._resizeHeightRGBChannels(d,!1)},Resize.prototype.resizeHeightRGBA=function(d){return this._resizeHeightRGBChannels(d,!0)},Resize.prototype.resize=function(d){this.resizeCallback(this.resizeHeight(this.resizeWidth(d)))},Resize.prototype.bypassResizer=function(d){return d},Resize.prototype.initializeFirstPassBuffers=function(d){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),d||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},Resize.prototype.initializeSecondPassBuffers=function(d){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),d||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},Resize.prototype.generateFloatBuffer=function(d){try{return new Float32Array(d)}catch(m){return console.error(m),[]}},Resize.prototype.generateFloat64Buffer=function(d){try{return new Float64Array(d)}catch(m){return console.error(m),[]}},Resize.prototype.generateUint8Buffer=function(d){try{return new Uint8Array(d)}catch(m){return console.error(m),[]}};const operations={nearestNeighbor(d,m){const g=d.width,w=d.height,I=m.width,P=m.height,F=d.data,D=m.data;for(let $=0;$<P;$++)for(let U=0;U<I;U++){let j=4*($*I+U),Z=4*(Math.floor($*w/P)*g+Math.floor(U*g/I));D[j++]=F[Z++],D[j++]=F[Z++],D[j++]=F[Z++],D[j++]=F[Z++]}},bilinearInterpolation(d,m){const g=d.width,w=d.height,I=m.width,P=m.height,F=d.data,D=m.data,$=function(j,Z,G,H,W){return Z===H?G:Math.round((j-Z)*W+(H-j)*G)},U=function(j,Z,G,H,W,Q,q,rt){let et=4*(q*g+H)+Z,X=4*(q*g+W)+Z;const J=$(G,H,F[et],W,F[X]);if(rt===q)D[j+Z]=J;else{et=4*(rt*g+H)+Z,X=4*(rt*g+W)+Z;const tt=$(G,H,F[et],W,F[X]);D[j+Z]=$(Q,q,J,rt,tt)}};for(let j=0;j<P;j++)for(let Z=0;Z<I;Z++){const G=4*(j*I+Z),H=Z*g/I,W=Math.floor(H),Q=Math.min(Math.ceil(H),g-1),q=j*w/P,rt=Math.floor(q),et=Math.min(Math.ceil(q),w-1);U(G,0,H,W,Q,q,rt,et),U(G,1,H,W,Q,q,rt,et),U(G,2,H,W,Q,q,rt,et),U(G,3,H,W,Q,q,rt,et)}},_interpolate2D(d,m,g,w){const I=d.data,P=m.data,F=d.width,D=d.height,$=m.width,U=m.height,j=Math.max(1,Math.floor(F/$)),Z=$*j,G=Math.max(1,Math.floor(D/U)),H=U*G,W=Buffer.alloc(Z*D*4);for(let rt=0;rt<D;rt++)for(let et=0;et<Z;et++){const X=et*(F-1)/Z,J=Math.floor(X),tt=X-J,st=4*(rt*F+J),nt=4*(rt*Z+et);for(let lt=0;lt<4;lt++){const at=st+lt,ct=J>0?I[at-4]:2*I[at]-I[at+4],V=I[at],ut=I[at+4],wt=J<F-2?I[at+8]:2*I[at+4]-I[at];W[nt+lt]=w(ct,V,ut,wt,tt)}}const Q=Buffer.alloc(Z*H*4);for(let rt=0;rt<H;rt++)for(let et=0;et<Z;et++){const X=rt*(D-1)/H,J=Math.floor(X),tt=X-J,st=4*(J*Z+et),nt=4*(rt*Z+et);for(let lt=0;lt<4;lt++){const at=st+lt,ct=J>0?W[at-4*Z]:2*W[at]-W[at+4*Z],V=W[at],ut=W[at+4*Z],wt=J<D-2?W[at+8*Z]:2*W[at+4*Z]-W[at];Q[nt+lt]=w(ct,V,ut,wt,tt)}}const q=j*G;if(q>1)for(let rt=0;rt<U;rt++)for(let et=0;et<$;et++){let X=0,J=0,tt=0,st=0,nt=0;for(let at=0;at<G;at++){const ct=rt*G+at;for(let V=0;V<j;V++){const ut=4*(ct*Z+(et*j+V)),wt=Q[ut+3];wt&&(X+=Q[ut],J+=Q[ut+1],tt+=Q[ut+2],nt++),st+=wt}}const lt=4*(rt*$+et);P[lt]=nt?Math.round(X/nt):0,P[lt+1]=nt?Math.round(J/nt):0,P[lt+2]=nt?Math.round(tt/nt):0,P[lt+3]=Math.round(st/q)}else m.data=Q},bicubicInterpolation(d,m,g){return this._interpolate2D(d,m,g,(function(w,I,P,F,D){const $=F-P-w+I,U=w-I-$,j=P-w,Z=I;return Math.max(0,Math.min(255,$*(D*D*D)+U*(D*D)+j*D+Z))}))},hermiteInterpolation(d,m,g){return this._interpolate2D(d,m,g,(function(w,I,P,F,D){const $=I,U=.5*(P-w),j=w-2.5*I+2*P-.5*F,Z=.5*(F-w)+1.5*(I-P);return Math.max(0,Math.min(255,Math.round(((Z*D+j)*D+U)*D+$)))}))},bezierInterpolation(d,m,g){return this._interpolate2D(d,m,g,(function(w,I,P,F,D){const $=1-D,U=I*$*$*$,j=3*(I+(P-w)/4)*$*$*D,Z=3*(P-(F-I)/4)*$*D*D,G=P*D*D*D;return Math.max(0,Math.min(255,Math.round(U+j+Z+G)))}))}},ResizeOptionsSchema=z.union([z.object({w:z.number().min(0),h:z.number().min(0).optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),z.object({w:z.number().min(0).optional(),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()})]),ScaleToFitOptionsSchema=z.object({w:z.number().min(0),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),ScaleComplexOptionsSchema=z.object({f:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$d={resize(d,m){const{mode:g}=ResizeOptionsSchema.parse(m);let w,I;if(typeof m.w=="number")w=m.w,I=m.h??d.bitmap.height*(w/d.bitmap.width);else{if(typeof m.h!="number")throw new Error("w must be a number");I=m.h,w=m.w??d.bitmap.width*(I/d.bitmap.height)}if(w=Math.round(w)||1,I=Math.round(I)||1,g&&typeof operations[g]=="function"){const P={data:Buffer.alloc(w*I*4),width:w,height:I};operations[g](d.bitmap,P),d.bitmap=P}else new Resize(d.bitmap.width,d.bitmap.height,w,I,!0,!0,(P=>{d.bitmap.data=Buffer.from(P),d.bitmap.width=w,d.bitmap.height=I})).resize(d.bitmap.data);return d},scale(d,m){const{f:g,mode:w}=typeof m=="number"?{f:m}:ScaleComplexOptionsSchema.parse(m),I=d.bitmap.width*g,P=d.bitmap.height*g;return this.resize(d,{w:I,h:P,mode:w})},scaleToFit(d,m){const{h:g,w,mode:I}=ScaleToFitOptionsSchema.parse(m),P=w/g>d.bitmap.width/d.bitmap.height?g/d.bitmap.height:w/d.bitmap.width;return this.scale(d,{f:P,mode:I})}},ContainOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$c={contain(d,m){const{w:g,h:w,align:I=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:P}=ContainOptionsSchema.parse(m),F=7&I,D=I>>3;if((F===0||F&F-1)&&(D===0||D&D-1))throw new Error("only use one flag per alignment direction");const $=F>>1,U=D>>1,j=g/w>d.bitmap.width/d.bitmap.height?w/d.bitmap.height:g/d.bitmap.width,Z=methods$d.scale(clone(d),{f:j,mode:P});return(d=methods$d.resize(d,{w:g,h:w,mode:P})).scan(((G,H,W)=>{d.bitmap.data.writeUInt32BE(d.background,W)})),d=methods$h.blit(d,{src:Z,x:(d.bitmap.width-Z.bitmap.width)/2*$,y:(d.bitmap.height-Z.bitmap.height)/2*U})}},CropOptionsSchema=z.object({x:z.number(),y:z.number(),w:z.number(),h:z.number()}),AutocropComplexOptionsSchema=z.object({tolerance:z.number().min(0).max(1).optional(),cropOnlyFrames:z.boolean().optional(),cropSymmetric:z.boolean().optional(),leaveBorder:z.number().optional(),ignoreSides:z.object({north:z.boolean().optional(),south:z.boolean().optional(),east:z.boolean().optional(),west:z.boolean().optional()}).optional()}),methods$b={crop(d,m){let{x:g,y:w,w:I,h:P}=CropOptionsSchema.parse(m);if(g=Math.round(g),w=Math.round(w),I=Math.round(I),P=Math.round(P),g===0&&I===d.bitmap.width){const F=I*w+g<<2,D=F+(P*I<<2);d.bitmap.data=d.bitmap.data.slice(F,D)}else{const F=Buffer.allocUnsafe(I*P*4);let D=0;scan(d,g,w,I,P,(function($,U,j){const Z=d.bitmap.data.readUInt32BE(j);F.writeUInt32BE(Z,D),D+=4})),d.bitmap.data=F}return d.bitmap.width=I,d.bitmap.height=P,d},autocrop(d,m={}){const{tolerance:g=2e-4,cropOnlyFrames:w=!0,cropSymmetric:I=!1,leaveBorder:P=0,ignoreSides:F}=typeof m=="number"?{tolerance:m}:AutocropComplexOptionsSchema.parse(m),D=d.bitmap.width,$=d.bitmap.height,U={north:!1,south:!1,east:!1,west:!1,...F};let j=d.getPixelColor(0,0);const Z=intToRGBA$1(j);let G=0,H=0,W=0,Q=0;if(j=d.getPixelColor(0,0),!U.north)t:for(let X=0;X<$-1;X++){for(let J=0;J<D;J++)if(colorDiff(Z,intToRGBA$1(d.getPixelColor(J,X)))>g)break t;G++}if(j=d.getPixelColor(D,0),!U.west)t:for(let X=0;X<D-1;X++){for(let J=0+G;J<$;J++)if(colorDiff(Z,intToRGBA$1(d.getPixelColor(X,J)))>g)break t;Q++}if(j=d.getPixelColor(0,$),!U.south)t:for(let X=$-1;X>=G+1;X--){for(let J=D-H-1;J>=0;J--)if(colorDiff(Z,intToRGBA$1(d.getPixelColor(J,X)))>g)break t;W++}if(j=d.getPixelColor(D,$),!U.east)t:for(let X=D-1;X>=0+Q+1;X--){for(let J=$-1;J>=0+G;J--)if(colorDiff(Z,intToRGBA$1(d.getPixelColor(X,J)))>g)break t;H++}let q=!1;if(Q-=P,H-=P,G-=P,W-=P,I){const X=Math.min(H,Q),J=Math.min(G,W);Q=X,H=X,G=J,W=J}Q=Q>=0?Q:0,H=H>=0?H:0,G=G>=0?G:0,W=W>=0?W:0;const rt=D-(Q+H),et=$-(W+G);return q=w?H!==0&&G!==0&&Q!==0&&W!==0:H!==0||G!==0||Q!==0||W!==0,q&&this.crop(d,{x:Q,y:G,w:rt,h:et}),d}},CoverOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$a={cover(d,m){const{w:g,h:w,align:I=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:P}=CoverOptionsSchema.parse(m),F=7&I,D=I>>3;if((F===0||F&F-1)&&(D===0||D&D-1))throw new Error("only use one flag per alignment direction");const $=F>>1,U=D>>1,j=g/w>d.bitmap.width/d.bitmap.height?g/d.bitmap.width:w/d.bitmap.height;return d=methods$d.scale(d,{f:j,mode:P}),d=methods$b.crop(d,{x:(d.bitmap.width-g)/2*$,y:(d.bitmap.height-w)/2*U,w:g,h:w})}},DisplaceOptionsSchema=z.object({map:JimpClassSchema,offset:z.number()}),methods$9={displace(d,m){const{map:g,offset:w}=DisplaceOptionsSchema.parse(m),I=clone(d);return d.scan(((P,F,D)=>{let $=g.bitmap.data[D]/256*w;$=Math.round($);const U=d.getPixelIndex(P+$,F);d.bitmap.data[U]=I.bitmap.data[D],d.bitmap.data[U+1]=I.bitmap.data[D+1],d.bitmap.data[U+2]=I.bitmap.data[D+2]})),d}},methods$8={dither(d){const m=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return d.scan(((g,w,I)=>{const P=m[((3&w)<<2)+g%4];d.bitmap.data[I]=Math.min(d.bitmap.data[I]+P,255),d.bitmap.data[I+1]=Math.min(d.bitmap.data[I+1]+P,255),d.bitmap.data[I+2]=Math.min(d.bitmap.data[I+2]+P,255)})),d}},FisheyeOptionsSchema=z.object({radius:z.number().min(0).optional()}),methods$7={fisheye(d,m={}){const{radius:g=2.5}=FisheyeOptionsSchema.parse(m),w=clone(d),{width:I,height:P}=w.bitmap;return w.scan(((F,D)=>{const $=F/I,U=D/P,j=Math.sqrt(Math.pow($-.5,2)+Math.pow(U-.5,2)),Z=2*Math.pow(j,g),G=($-.5)/j,H=(U-.5)/j,W=Math.round((Z*G+.5)*I),Q=Math.round((Z*H+.5)*P),q=w.getPixelColor(W,Q);d.setPixelColor(q,F,D)})),d.setPixelColor(w.getPixelColor(I/2,P/2),I/2,P/2),d}},FlipOptionsSchema=z.object({horizontal:z.boolean().optional(),vertical:z.boolean().optional()}),methods$6={flip(d,m){const{horizontal:g,vertical:w}=FlipOptionsSchema.parse(m),I=Buffer.alloc(d.bitmap.data.length);return d.scan(((P,F,D)=>{const $=g?d.bitmap.width-1-P:P,U=w?d.bitmap.height-1-F:F,j=d.bitmap.width*U+$<<2,Z=d.bitmap.data.readUInt32BE(D);I.writeUInt32BE(Z,j)})),d.bitmap.data=Buffer.from(I),d}};function Converter$1(d,m){if(!(d&&m&&d.length&&m.length))throw new Error("Bad alphabet");this.srcAlphabet=d,this.dstAlphabet=m}Converter$1.prototype.convert=function(d){var m,g,w,I={},P=this.srcAlphabet.length,F=this.dstAlphabet.length,D=d.length,$=typeof d=="string"?"":[];if(!this.isValid(d))throw new Error('Number "'+d+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return d;for(m=0;m<D;m++)I[m]=this.srcAlphabet.indexOf(d[m]);do{for(g=0,w=0,m=0;m<D;m++)(g=g*P+I[m])>=F?(I[w++]=parseInt(g/F,10),g%=F):w>0&&(I[w++]=0);D=w,$=this.dstAlphabet.slice(g,g+1).concat($)}while(w!==0);return $},Converter$1.prototype.isValid=function(d){for(var m=0;m<d.length;++m)if(this.srcAlphabet.indexOf(d[m])===-1)return!1;return!0};var converter=Converter$1,Converter=converter;function anyBase(d,m){var g=new Converter(d,m);return function(w){return g.convert(w)}}anyBase.BIN="01",anyBase.OCT="01234567",anyBase.DEC="0123456789",anyBase.HEX="0123456789abcdef";var anyBase_1=anyBase,anyBase$1=getDefaultExportFromCjs(anyBase_1),__defProp$1=Object.defineProperty,__defNormalProp$1=(d,m,g)=>m in d?__defProp$1(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__publicField$1=(d,m,g)=>__defNormalProp$1(d,typeof m!="symbol"?m+"":m,g);class ImagePHash{constructor(m,g){__publicField$1(this,"size"),__publicField$1(this,"smallerSize"),this.size=m||32,this.smallerSize=g||8,initCoefficients(this.size)}distance(m,g){let w=0;for(let I=0;I<m.length;I++)m[I]!==g[I]&&w++;return w/m.length}getHash(m){m=methods$d.resize(clone(m),{w:this.size,h:this.size}),m=methods$e.greyscale(m);const g=[];for(let D=0;D<m.bitmap.width;D++){const $=[];for(let U=0;U<m.bitmap.height;U++)$[U]=intToRGBA(m.getPixelColor(D,U)).b;g[D]=$}const w=applyDCT(g,this.size);let I=0;for(let D=0;D<this.smallerSize;D++)for(let $=0;$<this.smallerSize;$++)I+=w[D][$];const P=I/(this.smallerSize*this.smallerSize);let F="";for(let D=0;D<this.smallerSize;D++)for(let $=0;$<this.smallerSize;$++)F+=w[D][$]>P?"1":"0";return F}}function intToRGBA(d){const m=255&d,g=255&(d>>>=8),w=255&(d>>>=8);return{r:255&(d>>>=8),g:w,b:g,a:m}}const c$1=[];function initCoefficients(d){for(let m=1;m<d;m++)c$1[m]=1;c$1[0]=1/Math.sqrt(2)}function applyDCT(d,m){const g=m,w=[];for(let I=0;I<g;I++){const P=[];for(let F=0;F<g;F++){let D=0;for(let $=0;$<g;$++)for(let U=0;U<g;U++)D+=Math.cos((2*$+1)/(2*g)*I*Math.PI)*Math.cos((2*U+1)/(2*g)*F*Math.PI)*d[$][U];D*=c$1[I]*c$1[F]/4,P[F]=D,w[I]=P}}return w}const alphabet="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",maxHashLength=[NaN,NaN];for(let d=2;d<65;d++){const m=anyBase$1(anyBase$1.BIN,alphabet.slice(0,d))(new Array(65).join("1"));maxHashLength.push(m.length)}const methods$5={pHash:d=>new ImagePHash().getHash(d),hash(d,m=64){if(m<2||m>64)throw new Error("base must be a number between 2 and 64");const g=alphabet.slice(0,m),w=this.pHash(d),I=maxHashLength[m];return anyBase$1(anyBase$1.BIN,g)(w).padStart(I,"0")},distanceFromHash(d,m){const g=new ImagePHash,w=g.getHash(d);return g.distance(w,m)}},MaskOptionsObjectSchema=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional()}),MaskOptionsSchema=z.union([JimpClassSchema,MaskOptionsObjectSchema]),methods$4={mask(d,m){let g,w,I;MaskOptionsSchema.parse(m),"bitmap"in m?(g=m,w=0,I=0):(g=m.src,w=m.x??0,I=m.y??0),w=Math.round(w),I=Math.round(I);const P=d.bitmap.width,F=d.bitmap.height;return g.scan((function(D,$,U){const j=w+D,Z=I+$;if(j>=0&&Z>=0&&j<P&&Z<F){const G=d.getPixelIndex(j,Z),{data:H}=g.bitmap,W=(H[U+0]+H[U+1]+H[U+2])/3;d.bitmap.data[G+3]*=W/255}})),d}};function measureText(d,m){let g=0;for(let w=0;w<m.length;w++){const I=m[w],P=d.chars[I];if(P){const F=d.kernings[I],D=m[w+1],$=F&&D&&F[D]&&F[D]||0;g+=(P.xadvance||0)+$}}return g}function splitLines(d,m,g){const w=m.replace(/[\r\n]+/g,` 
`).split(" "),I=[];let P=[],F=0;return w.forEach((D=>{if(measureText(d,D+(w.length>1?" ":""))>g){const j=D[Symbol.iterator]();let Z="";for(const G of j){const H=[...P,Z+G].join(" "),W=measureText(d,H);W<g?Z+=G:W>g?(I.push([...P,Z]),P=[],Z=G):(I.push([...P,Z+G]),P=[],Z="")}return}const $=[...P,D].join(" "),U=measureText(d,$);U<=g&&!D.includes(`
`)?(U>F&&(F=U),P.push(D)):(I.push(P),P=[D.replace(`
`,"")])})),I.push(P),{lines:I,longestLine:F}}function measureTextHeight(d,m,g){const{lines:w}=splitLines(d,m,g);return w.length*d.common.lineHeight}const PrintOptionsSchema=z.object({x:z.number(),y:z.number(),text:z.union([z.union([z.string(),z.number()]),z.object({text:z.union([z.string(),z.number()]),alignmentX:z.nativeEnum(HorizontalAlign).optional(),alignmentY:z.nativeEnum(VerticalAlign).optional()})]),maxWidth:z.number().optional(),maxHeight:z.number().optional(),cb:z.function(z.tuple([z.object({x:z.number(),y:z.number()})])).optional()});function xOffsetBasedOnAlignment(d,m,g,w){return w===HorizontalAlign.LEFT?0:w===HorizontalAlign.CENTER?(g-measureText(d,m))/2:g-measureText(d,m)}function drawCharacter(d,m,g,w,I){if(I.width>0&&I.height>0){const P=m.pages[I.page];P&&(d=methods$h.blit(d,{src:P,x:g+I.xoffset,y:w+I.yoffset,srcX:I.x,srcY:I.y,srcW:I.width,srcH:I.height}))}return d}function printText(d,m,g,w,I,P){for(let F=0;F<I.length;F++){const D=I[F];let $;$=m.chars[D]?D:/\s/.test(D)?"":"?";const U=m.chars[$]||{xadvance:void 0},j=m.kernings[$];U&&drawCharacter(d,m,g,w,U);const Z=I[F+1];g+=(j&&Z&&j[Z]&&j[Z]||0)+(U.xadvance||P)}}const methods$3={print(d,{font:m,...g}){let w,I,{x:P,y:F,text:D,maxWidth:$=1/0,maxHeight:U=1/0,cb:j=(()=>{})}=PrintOptionsSchema.parse(g);typeof D=="object"&&D.text!==null&&D.text!==void 0?(w=D.alignmentX||HorizontalAlign.LEFT,I=D.alignmentY||VerticalAlign.TOP,{text:D}=D):(w=HorizontalAlign.LEFT,I=VerticalAlign.TOP,D=D.toString()),typeof D=="number"&&(D=D.toString()),U!==1/0&&I===VerticalAlign.BOTTOM?F+=U-measureTextHeight(m,D,$):U!==1/0&&I===VerticalAlign.MIDDLE&&(F+=U/2-measureTextHeight(m,D,$)/2);const Z=Object.entries(m.chars).find((W=>W[1].xadvance))?.[1].xadvance;if(typeof Z!="number")throw new Error("Could not find default character width");const{lines:G,longestLine:H}=splitLines(m,D,$);return G.forEach((W=>{const Q=W.join(" "),q=xOffsetBasedOnAlignment(m,Q,$,w);printText(d,m,P+q,F,Q,Z),F+=m.common.lineHeight})),j.bind(d)({x:P+H,y:F}),d}},RotateOptionsSchema=z.union([z.number(),z.object({deg:z.number(),mode:z.union([z.boolean(),z.nativeEnum(ResizeStrategy)]).optional()})]);function createIdxTranslationFunction(d){return function(m,g){return g*d+m<<2}}function matrixRotate(d,m){if(Math.abs(m)%90!=0)throw new Error("Unsupported matrix rotation degree");const g=d.bitmap.width,w=d.bitmap.height;let I;switch(m){case 90:case-270:I=90;break;case 180:case-180:I=180;break;case 270:case-90:I=-90;break;default:throw new Error("Unsupported matrix rotation degree")}const P=I===180?g:w,F=I===180?w:g,D=Buffer.alloc(d.bitmap.data.length),$=createIdxTranslationFunction(g),U=createIdxTranslationFunction(P);for(let j=0;j<g;j++)for(let Z=0;Z<w;Z++){const G=$(j,Z),H=d.bitmap.data.readUInt32BE(G);let W;switch(I){case 90:W=U(Z,g-j-1);break;case-90:W=U(w-Z-1,j);break;case 180:W=U(g-j-1,w-Z-1);break;default:throw new Error("Unsupported matrix rotation angle")}D.writeUInt32BE(H,W)}d.bitmap.data=D,d.bitmap.width=P,d.bitmap.height=F}function createTranslationFunction(d,m){return function(g,w){return{x:g+d,y:w+m}}}function advancedRotate(d,m,g){const w=m*Math.PI/180,I=Math.cos(w),P=Math.sin(w);let F=d.bitmap.width,D=d.bitmap.height;if(g===!0||typeof g=="string"){F=Math.ceil(Math.abs(d.bitmap.width*I)+Math.abs(d.bitmap.height*P))+1,D=Math.ceil(Math.abs(d.bitmap.width*P)+Math.abs(d.bitmap.height*I))+1,F%2!=0&&F++,D%2!=0&&D++;const H=clone(d);d.scan(((Q,q,rt)=>{d.bitmap.data.writeUInt32BE(d.background,rt)}));const W=Math.max(F,D,d.bitmap.width,d.bitmap.height);d=composite(d=methods$d.resize(d,{h:W,w:W,mode:g===!0?void 0:g}),H,d.bitmap.width/2-H.bitmap.width/2,d.bitmap.height/2-H.bitmap.height/2)}const $=d.bitmap.width,U=d.bitmap.height,j=Buffer.alloc(d.bitmap.data.length),Z=createTranslationFunction(-$/2,-U/2),G=createTranslationFunction($/2+.5,U/2+.5);for(let H=1;H<=U;H++)for(let W=1;W<=$;W++){const Q=Z(W,H),q=G(I*Q.x-P*Q.y,I*Q.y+P*Q.x),rt=$*(H-1)+W-1<<2;if(q.x>=0&&q.x<$&&q.y>=0&&q.y<U){const et=$*(0|q.y)+q.x<<2,X=d.bitmap.data.readUInt32BE(et);j.writeUInt32BE(X,rt)}else j.writeUInt32BE(d.background,rt)}if(d.bitmap.data=j,g===!0||typeof g=="string"){const H=Math.max($/2-F/2,0),W=Math.max(U/2-D/2,0);d=methods$b.crop(d,{x:H,y:W,w:F,h:D})}}const methods$2={rotate(d,m){const g=RotateOptionsSchema.parse(m),w=typeof g=="number"?{deg:g}:g,{mode:I=!0}=w;let{deg:P}=w;return P%=360,P%360==0||(P%90==0&&(I||d.bitmap.width===d.bitmap.height||P%180==0)?matrixRotate(d,P):advancedRotate(d,P,I)),d}},ThresholdOptionsSchema=z.object({max:z.number().min(0).max(255),replace:z.number().min(0).max(255).optional(),autoGreyscale:z.boolean().optional()}),methods$1={threshold(d,m){let{max:g,replace:w=255,autoGreyscale:I=!0}=ThresholdOptionsSchema.parse(m);return g=limit255(g),w=limit255(w),I&&methods$e.greyscale(d),d.scan(((P,F,D)=>{const $=d.bitmap.data[D]<g?d.bitmap.data[D]:w;d.bitmap.data[D]=$,d.bitmap.data[D+1]=$,d.bitmap.data[D+2]=$})),d}};var __defProp=Object.defineProperty,__defNormalProp=(d,m,g)=>m in d?__defProp(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__export=(d,m)=>{for(var g in m)__defProp(d,g,{get:m[g],enumerable:!0})},__publicField=(d,m,g)=>(__defNormalProp(d,typeof m!="symbol"?m+"":m,g),g),constants_exports={};__export(constants_exports,{bt709:()=>bt709_exports});var bt709_exports={};__export(bt709_exports,{Y:()=>Y,x:()=>x$1,y:()=>y$1});var Y=(d=>(d[d.RED=.2126]="RED",d[d.GREEN=.7152]="GREEN",d[d.BLUE=.0722]="BLUE",d[d.WHITE=1]="WHITE",d))(Y||{}),x$1=(d=>(d[d.RED=.64]="RED",d[d.GREEN=.3]="GREEN",d[d.BLUE=.15]="BLUE",d[d.WHITE=.3127]="WHITE",d))(x$1||{}),y$1=(d=>(d[d.RED=.33]="RED",d[d.GREEN=.6]="GREEN",d[d.BLUE=.06]="BLUE",d[d.WHITE=.329]="WHITE",d))(y$1||{}),conversion_exports={};function correctGamma(d){return d>.04045?((d+.055)/1.055)**2.4:d/12.92}function rgb2xyz(d,m,g){return{x:.4124*(d=correctGamma(d/255))+.3576*(m=correctGamma(m/255))+.1805*(g=correctGamma(g/255)),y:.2126*d+.7152*m+.0722*g,z:.0193*d+.1192*m+.9505*g}}__export(conversion_exports,{lab2rgb:()=>lab2rgb,lab2xyz:()=>lab2xyz,rgb2hsl:()=>rgb2hsl,rgb2lab:()=>rgb2lab,rgb2xyz:()=>rgb2xyz,xyz2lab:()=>xyz2lab,xyz2rgb:()=>xyz2rgb});var arithmetic_exports={};function degrees2radians(d){return d*(Math.PI/180)}function max3(d,m,g){let w=d;return w<m&&(w=m),w<g&&(w=g),w}function min3(d,m,g){let w=d;return w>m&&(w=m),w>g&&(w=g),w}function intInRange(d,m,g){return d>g&&(d=g),d<m&&(d=m),0|d}function inRange0to255Rounded(d){return(d=Math.round(d))>255?d=255:d<0&&(d=0),d}function inRange0to255(d){return d>255?d=255:d<0&&(d=0),d}function stableSort(d,m){const g=typeof d[0];let w;if(g==="number"||g==="string"){const I=Object.create(null);for(let P=0,F=d.length;P<F;P++){const D=d[P];I[D]||I[D]===0||(I[D]=P)}w=d.sort(((P,F)=>m(P,F)||I[P]-I[F]))}else{const I=d.slice(0);w=d.sort(((P,F)=>m(P,F)||I.indexOf(P)-I.indexOf(F)))}return w}function rgb2hsl(d,m,g){const w=min3(d,m,g),I=max3(d,m,g),P=I-w,F=(w+I)/510;let D=0;F>0&&F<1&&(D=P/(F<.5?I+w:510-I-w));let $=0;return P>0&&($=I===d?(m-g)/P:I===m?2+(g-d)/P:4+(d-m)/P,$*=60,$<0&&($+=360)),{h:$,s:D,l:F}}__export(arithmetic_exports,{degrees2radians:()=>degrees2radians,inRange0to255:()=>inRange0to255,inRange0to255Rounded:()=>inRange0to255Rounded,intInRange:()=>intInRange,max3:()=>max3,min3:()=>min3,stableSort:()=>stableSort});var refX=.95047,refY=1,refZ=1.08883;function pivot(d){return d>.008856?d**(1/3):7.787*d+16/116}function xyz2lab(d,m,g){if(d=pivot(d/refX),m=pivot(m/refY),g=pivot(g/refZ),116*m-16<0)throw new Error("xxx");return{L:Math.max(0,116*m-16),a:500*(d-m),b:200*(m-g)}}function rgb2lab(d,m,g){const w=rgb2xyz(d,m,g);return xyz2lab(w.x,w.y,w.z)}var refX2=.95047,refY2=1,refZ2=1.08883;function pivot2(d){return d>.206893034?d**3:(d-16/116)/7.787}function lab2xyz(d,m,g){const w=(d+16)/116,I=w-g/200;return{x:refX2*pivot2(m/500+w),y:refY2*pivot2(w),z:refZ2*pivot2(I)}}function correctGamma2(d){return d>.0031308?1.055*d**(1/2.4)-.055:12.92*d}function xyz2rgb(d,m,g){const w=correctGamma2(3.2406*d+-1.5372*m+-.4986*g),I=correctGamma2(-.9689*d+1.8758*m+.0415*g),P=correctGamma2(.0557*d+-.204*m+1.057*g);return{r:inRange0to255Rounded(255*w),g:inRange0to255Rounded(255*I),b:inRange0to255Rounded(255*P)}}function lab2rgb(d,m,g){const w=lab2xyz(d,m,g);return xyz2rgb(w.x,w.y,w.z)}var distance_exports={};__export(distance_exports,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator,AbstractEuclidean:()=>AbstractEuclidean,AbstractManhattan:()=>AbstractManhattan,CIE94GraphicArts:()=>CIE94GraphicArts,CIE94Textiles:()=>CIE94Textiles,CIEDE2000:()=>CIEDE2000,CMetric:()=>CMetric,Euclidean:()=>Euclidean,EuclideanBT709:()=>EuclideanBT709,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha,Manhattan:()=>Manhattan,ManhattanBT709:()=>ManhattanBT709,ManhattanNommyde:()=>ManhattanNommyde,PNGQuant:()=>PNGQuant});var AbstractDistanceCalculator=class{constructor(){__publicField(this,"_maxDistance"),__publicField(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(d,m,g,w){this._whitePoint={r:d>0?255/d:0,g:m>0?255/m:0,b:g>0?255/g:0,a:w>0?255/w:0},this._maxDistance=this.calculateRaw(d,m,g,w,0,0,0,0)}calculateNormalized(d,m){return this.calculateRaw(d.r,d.g,d.b,d.a,m.r,m.g,m.b,m.a)/this._maxDistance}},AbstractCIE94=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const $=rgb2lab(inRange0to255(d*this._whitePoint.r),inRange0to255(m*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),U=rgb2lab(inRange0to255(I*this._whitePoint.r),inRange0to255(P*this._whitePoint.g),inRange0to255(F*this._whitePoint.b)),j=$.L-U.L,Z=$.a-U.a,G=$.b-U.b,H=Math.sqrt($.a*$.a+$.b*$.b),W=H-Math.sqrt(U.a*U.a+U.b*U.b);let Q=Z*Z+G*G-W*W;Q=Q<0?0:Math.sqrt(Q);const q=(D-w)*this._whitePoint.a*this._kA;return Math.sqrt((j/this._Kl)**2+(W/(1+this._K1*H))**2+(Q/(1+this._K2*H))**2+q**2)}},CIE94Textiles=class extends AbstractCIE94{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts=class extends AbstractCIE94{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000=class extends AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(d,m){const g=Math.atan2(d,m);return g>=0?g:g+_CIEDE2000._deg360InRad}static _calculateRT(d,m){const g=m**7,w=2*Math.sqrt(g/(g+_CIEDE2000._pow25to7)),I=_CIEDE2000._deg30InRad*Math.exp(-(((d-_CIEDE2000._deg275InRad)/_CIEDE2000._deg25InRad)**2));return-Math.sin(2*I)*w}static _calculateT(d){return 1-.17*Math.cos(d-_CIEDE2000._deg30InRad)+.24*Math.cos(2*d)+.32*Math.cos(3*d+_CIEDE2000._deg6InRad)-.2*Math.cos(4*d-_CIEDE2000._deg63InRad)}static _calculate_ahp(d,m,g,w){const I=g+w;return d===0?I:m<=_CIEDE2000._deg180InRad?I/2:I<_CIEDE2000._deg360InRad?(I+_CIEDE2000._deg360InRad)/2:(I-_CIEDE2000._deg360InRad)/2}static _calculate_dHp(d,m,g,w){let I;return I=d===0?0:m<=_CIEDE2000._deg180InRad?g-w:g<=w?g-w+_CIEDE2000._deg360InRad:g-w-_CIEDE2000._deg360InRad,2*Math.sqrt(d)*Math.sin(I/2)}calculateRaw(d,m,g,w,I,P,F,D){const $=rgb2lab(inRange0to255(d*this._whitePoint.r),inRange0to255(m*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),U=rgb2lab(inRange0to255(I*this._whitePoint.r),inRange0to255(P*this._whitePoint.g),inRange0to255(F*this._whitePoint.b)),j=(D-w)*this._whitePoint.a*_CIEDE2000._kA,Z=this.calculateRawInLab($,U);return Math.sqrt(Z+j*j)}calculateRawInLab(d,m){const g=d.L,w=d.a,I=d.b,P=m.L,F=m.a,D=m.b,$=((Math.sqrt(w*w+I*I)+Math.sqrt(F*F+D*D))/2)**7,U=.5*(1-Math.sqrt($/($+_CIEDE2000._pow25to7))),j=(1+U)*w,Z=(1+U)*F,G=Math.sqrt(j*j+I*I),H=Math.sqrt(Z*Z+D*D),W=G*H,Q=_CIEDE2000._calculatehp(I,j),q=_CIEDE2000._calculatehp(D,Z),rt=Math.abs(Q-q),et=P-g,X=H-G,J=_CIEDE2000._calculate_dHp(W,rt,q,Q),tt=_CIEDE2000._calculate_ahp(W,rt,Q,q),st=(G+H)/2,nt=((g+P)/2-50)**2,lt=X/(1+.045*st),at=J/(1+.015*_CIEDE2000._calculateT(tt)*st);return(et/(1+.015*nt/Math.sqrt(20+nt)))**2+lt**2+at**2+_CIEDE2000._calculateRT(tt,st)*lt*at}},CIEDE2000=_CIEDE2000;__publicField(CIEDE2000,"_kA",25/255),__publicField(CIEDE2000,"_pow25to7",25**7),__publicField(CIEDE2000,"_deg360InRad",degrees2radians(360)),__publicField(CIEDE2000,"_deg180InRad",degrees2radians(180)),__publicField(CIEDE2000,"_deg30InRad",degrees2radians(30)),__publicField(CIEDE2000,"_deg6InRad",degrees2radians(6)),__publicField(CIEDE2000,"_deg63InRad",degrees2radians(63)),__publicField(CIEDE2000,"_deg275InRad",degrees2radians(275)),__publicField(CIEDE2000,"_deg25InRad",degrees2radians(25));var CMetric=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const $=(d+I)/2*this._whitePoint.r,U=(d-I)*this._whitePoint.r,j=(m-P)*this._whitePoint.g,Z=(g-F)*this._whitePoint.b,G=((512+$)*U*U>>8)+4*j*j+((767-$)*Z*Z>>8),H=(D-w)*this._whitePoint.a;return Math.sqrt(G+H*H)}_setDefaults(){}},AbstractEuclidean=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const $=I-d,U=P-m,j=F-g,Z=D-w;return Math.sqrt(this._kR*$*$+this._kG*U*U+this._kB*j*j+this._kA*Z*Z)}},Euclidean=class extends AbstractEuclidean{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){let $=I-d,U=P-m,j=F-g,Z=D-w;return $<0&&($=0-$),U<0&&(U=0-U),j<0&&(j=0-j),Z<0&&(Z=0-Z),this._kR*$+this._kG*U+this._kB*j+this._kA*Z}},Manhattan=class extends AbstractManhattan{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde=class extends AbstractManhattan{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709=class extends AbstractManhattan{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const $=(D-w)*this._whitePoint.a;return this._colordifferenceCh(d*this._whitePoint.r,I*this._whitePoint.r,$)+this._colordifferenceCh(m*this._whitePoint.g,P*this._whitePoint.g,$)+this._colordifferenceCh(g*this._whitePoint.b,F*this._whitePoint.b,$)}_colordifferenceCh(d,m,g){const w=d-m,I=w+g;return w*w+I*I}_setDefaults(){}},palette_exports={};__export(palette_exports,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer,ColorHistogram:()=>ColorHistogram,NeuQuant:()=>NeuQuant,NeuQuantFloat:()=>NeuQuantFloat,RGBQuant:()=>RGBQuant,WuColorCube:()=>WuColorCube,WuQuant:()=>WuQuant});var AbstractPaletteQuantizer=class{quantizeSync(){for(const d of this.quantize())if(d.palette)return d.palette;throw new Error("unreachable")}},Point=class{constructor(){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),__publicField(this,"uint32"),__publicField(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(d){const m=new Point;return m.r=0|d[0],m.g=0|d[1],m.b=0|d[2],m.a=0|d[3],m._loadUINT32(),m._loadQuadruplet(),m}static createByRGBA(d,m,g,w){const I=new Point;return I.r=0|d,I.g=0|m,I.b=0|g,I.a=0|w,I._loadUINT32(),I._loadQuadruplet(),I}static createByUint32(d){const m=new Point;return m.uint32=d>>>0,m._loadRGBA(),m._loadQuadruplet(),m}from(d){this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.uint32=d.uint32,this.rgba[0]=d.r,this.rgba[1]=d.g,this.rgba[2]=d.b,this.rgba[3]=d.a}getLuminosity(d){let m=this.r,g=this.g,w=this.b;return d&&(m=Math.min(255,255-this.a+this.a*m/255),g=Math.min(255,255-this.a+this.a*g/255),w=Math.min(255,255-this.a+this.a*w/255)),.2126*m+.7152*g+.0722*w}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer=class{constructor(){__publicField(this,"_pointArray"),__publicField(this,"_width"),__publicField(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(d){this._width=d}setHeight(d){this._height=d}getPointArray(){return this._pointArray}clone(){const d=new PointContainer;d._width=this._width,d._height=this._height;for(let m=0,g=this._pointArray.length;m<g;m++)d._pointArray[m]=Point.createByUint32(0|this._pointArray[m].uint32);return d}toUint32Array(){const d=this._pointArray.length,m=new Uint32Array(d);for(let g=0;g<d;g++)m[g]=this._pointArray[g].uint32;return m}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(d){const m=d.naturalWidth,g=d.naturalHeight,w=document.createElement("canvas");return w.width=m,w.height=g,w.getContext("2d").drawImage(d,0,0,m,g,0,0,m,g),PointContainer.fromHTMLCanvasElement(w)}static fromHTMLCanvasElement(d){const m=d.width,g=d.height,w=d.getContext("2d").getImageData(0,0,m,g);return PointContainer.fromImageData(w)}static fromImageData(d){const m=d.width,g=d.height;return PointContainer.fromUint8Array(d.data,m,g)}static fromUint8Array(d,m,g){switch(Object.prototype.toString.call(d)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:d=new Uint8Array(d)}const w=new Uint32Array(d.buffer);return PointContainer.fromUint32Array(w,m,g)}static fromUint32Array(d,m,g){const w=new PointContainer;w._width=m,w._height=g;for(let I=0,P=d.length;I<P;I++)w._pointArray[I]=Point.createByUint32(0|d[I]);return w}static fromBuffer(d,m,g){const w=new Uint32Array(d.buffer,d.byteOffset,d.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer.fromUint32Array(w,m,g)}},hueGroups=10;function hueGroup(d,m){const g=360/m;for(let w=1,I=g-g/2;w<m;w++,I+=g)if(d>=I&&d<I+g)return w;return 0}var Palette=class{constructor(){__publicField(this,"_pointContainer"),__publicField(this,"_pointArray",[]),__publicField(this,"_i32idx",{}),this._pointContainer=new PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(d){this._pointArray.push(d),this._pointContainer.setWidth(this._pointArray.length)}has(d){for(let m=this._pointArray.length-1;m>=0;m--)if(d.uint32===this._pointArray[m].uint32)return!0;return!1}getNearestColor(d,m){return this._pointArray[0|this._getNearestIndex(d,m)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(d){return typeof this._i32idx[d]=="number"?this._i32idx[d]:-1}_getNearestIndex(d,m){let g=this._nearestPointFromCache(""+m.uint32);if(g>=0)return g;let w=Number.MAX_VALUE;g=0;for(let I=0,P=this._pointArray.length;I<P;I++){const F=this._pointArray[I],D=d.calculateRaw(m.r,m.g,m.b,m.a,F.r,F.g,F.b,F.a);D<w&&(w=D,g=I)}return this._i32idx[m.uint32]=g,g}sort(){this._i32idx={},this._pointArray.sort(((d,m)=>{const g=rgb2hsl(d.r,d.g,d.b),w=rgb2hsl(m.r,m.g,m.b),I=d.r===d.g&&d.g===d.b?0:1+hueGroup(g.h,hueGroups),P=(m.r===m.g&&m.g===m.b?0:1+hueGroup(w.h,hueGroups))-I;if(P)return-P;const F=d.getLuminosity(!0),D=m.getLuminosity(!0);if(D-F!=0)return D-F;const $=(100*w.s|0)-(100*g.s|0);return $?-$:0}))}},utils_exports={};__export(utils_exports,{HueStatistics:()=>HueStatistics,Palette:()=>Palette,Point:()=>Point,PointContainer:()=>PointContainer,ProgressTracker:()=>ProgressTracker,arithmetic:()=>arithmetic_exports});var HueGroup=class{constructor(){__publicField(this,"num",0),__publicField(this,"cols",[])}},HueStatistics=class{constructor(d,m){__publicField(this,"_numGroups"),__publicField(this,"_minCols"),__publicField(this,"_stats"),__publicField(this,"_groupsFull"),this._numGroups=d,this._minCols=m,this._stats=[];for(let g=0;g<=d;g++)this._stats[g]=new HueGroup;this._groupsFull=0}check(d){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const m=255&d,g=d>>>8&255,w=d>>>16&255,I=m===g&&g===w?0:1+hueGroup(rgb2hsl(m,g,w).h,this._numGroups),P=this._stats[I],F=this._minCols;P.num++,P.num>F||(P.num===F&&this._groupsFull++,P.num<=F&&this._stats[I].cols.push(d))}injectIntoDictionary(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach((g=>{d[g]?d[g]++:d[g]=1}))}injectIntoArray(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach((g=>{d.indexOf(g)===-1&&d.push(g)}))}},_ProgressTracker=class{constructor(d,m){__publicField(this,"progress"),__publicField(this,"_step"),__publicField(this,"_range"),__publicField(this,"_last"),__publicField(this,"_progressRange"),this._range=d,this._progressRange=m,this._step=Math.max(1,this._range/(_ProgressTracker.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(d){return d-this._last>=this._step&&(this._last=d,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker=_ProgressTracker;__publicField(ProgressTracker,"steps",100);var networkBiasShift=3,Neuron=class{constructor(d){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift,this.g>>networkBiasShift,this.b>>networkBiasShift,this.a>>networkBiasShift)}subtract(d,m,g,w){this.r-=0|d,this.g-=0|m,this.b-=0|g,this.a-=0|w}},_NeuQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new Neuron((d<<networkBiasShift+8)/this._networkSize|0),this._freq[d]=_NeuQuant._initialBias/this._networkSize|0,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuant._minpicturebytes&&(d=1);const g=30+(d-1)/3|0,w=m/d|0;let I,P=w/_NeuQuant._nCycles|0,F=_NeuQuant._initAlpha,D=(this._networkSize>>3)*_NeuQuant._radiusBias,$=D>>_NeuQuant._radiusBiasShift;$<=1&&($=0);for(let j=0;j<$;j++)this._radPower[j]=F*(($*$-j*j)*_NeuQuant._radBias/($*$))>>>0;I=m<_NeuQuant._minpicturebytes?1:m%_NeuQuant._prime1!=0?_NeuQuant._prime1:m%_NeuQuant._prime2!=0?_NeuQuant._prime2:m%_NeuQuant._prime3!=0?_NeuQuant._prime3:_NeuQuant._prime4;const U=new ProgressTracker(w,99);for(let j=0,Z=0;j<w;){U.shouldNotify(j)&&(yield{progress:U.progress});const G=this._pointArray[Z],H=G.b<<networkBiasShift,W=G.g<<networkBiasShift,Q=G.r<<networkBiasShift,q=G.a<<networkBiasShift,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),$!==0&&this._alterNeighbour($,rt,H,W,Q,q),Z+=I,Z>=m&&(Z-=m),j++,P===0&&(P=1),j%P==0){F-=F/g|0,D-=D/_NeuQuant._radiusDecrease|0,$=D>>_NeuQuant._radiusBiasShift,$<=1&&($=0);for(let et=0;et<$;et++)this._radPower[et]=F*(($*$-et*et)*_NeuQuant._radBias/($*$))>>>0}}}_buildPalette(){const d=new Palette;return this._network.forEach((m=>{d.add(m.toPoint())})),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let $=m+1,U=m-1,j=1;for(;$<D||U>F;){const Z=this._radPower[j++]/_NeuQuant._alphaRadBias;if($<D){const G=this._network[$++];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuant._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift;let P=2147483647,F=P,D=-1,$=D;for(let U=0;U<this._networkSize;U++){const j=this._network[U],Z=this._distance.calculateNormalized(j,{r:g,g:m,b:d,a:w})*I|0;Z<P&&(P=Z,D=U);const G=Z-(this._bias[U]>>_NeuQuant._initialBiasShift-networkBiasShift);G<F&&(F=G,$=U);const H=this._freq[U]>>_NeuQuant._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuant._gammaShift}return this._freq[D]+=_NeuQuant._beta,this._bias[D]-=_NeuQuant._betaGamma,$}},NeuQuant=_NeuQuant;__publicField(NeuQuant,"_prime1",499),__publicField(NeuQuant,"_prime2",491),__publicField(NeuQuant,"_prime3",487),__publicField(NeuQuant,"_prime4",503),__publicField(NeuQuant,"_minpicturebytes",_NeuQuant._prime4),__publicField(NeuQuant,"_nCycles",100),__publicField(NeuQuant,"_initialBiasShift",16),__publicField(NeuQuant,"_initialBias",1<<_NeuQuant._initialBiasShift),__publicField(NeuQuant,"_gammaShift",10),__publicField(NeuQuant,"_betaShift",10),__publicField(NeuQuant,"_beta",_NeuQuant._initialBias>>_NeuQuant._betaShift),__publicField(NeuQuant,"_betaGamma",_NeuQuant._initialBias<<_NeuQuant._gammaShift-_NeuQuant._betaShift),__publicField(NeuQuant,"_radiusBiasShift",6),__publicField(NeuQuant,"_radiusBias",1<<_NeuQuant._radiusBiasShift),__publicField(NeuQuant,"_radiusDecrease",30),__publicField(NeuQuant,"_alphaBiasShift",10),__publicField(NeuQuant,"_initAlpha",1<<_NeuQuant._alphaBiasShift),__publicField(NeuQuant,"_radBiasShift",8),__publicField(NeuQuant,"_radBias",1<<_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBiasShift",_NeuQuant._alphaBiasShift+_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBias",1<<_NeuQuant._alphaRadBiasShift);var networkBiasShift2=3,NeuronFloat=class{constructor(d){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift2,this.g>>networkBiasShift2,this.b>>networkBiasShift2,this.a>>networkBiasShift2)}subtract(d,m,g,w){this.r-=d,this.g-=m,this.b-=g,this.a-=w}},_NeuQuantFloat=class extends AbstractPaletteQuantizer{constructor(d,m=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new NeuronFloat((d<<networkBiasShift2+8)/this._networkSize),this._freq[d]=_NeuQuantFloat._initialBias/this._networkSize,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuantFloat._minpicturebytes&&(d=1);const g=30+(d-1)/3,w=m/d;let I,P=w/_NeuQuantFloat._nCycles|0,F=_NeuQuantFloat._initAlpha,D=(this._networkSize>>3)*_NeuQuantFloat._radiusBias,$=D>>_NeuQuantFloat._radiusBiasShift;$<=1&&($=0);for(let j=0;j<$;j++)this._radPower[j]=F*(($*$-j*j)*_NeuQuantFloat._radBias/($*$));I=m<_NeuQuantFloat._minpicturebytes?1:m%_NeuQuantFloat._prime1!=0?_NeuQuantFloat._prime1:m%_NeuQuantFloat._prime2!=0?_NeuQuantFloat._prime2:m%_NeuQuantFloat._prime3!=0?_NeuQuantFloat._prime3:_NeuQuantFloat._prime4;const U=new ProgressTracker(w,99);for(let j=0,Z=0;j<w;){U.shouldNotify(j)&&(yield{progress:U.progress});const G=this._pointArray[Z],H=G.b<<networkBiasShift2,W=G.g<<networkBiasShift2,Q=G.r<<networkBiasShift2,q=G.a<<networkBiasShift2,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),$!==0&&this._alterNeighbour($,rt,H,W,Q,q),Z+=I,Z>=m&&(Z-=m),j++,P===0&&(P=1),j%P==0){F-=F/g,D-=D/_NeuQuantFloat._radiusDecrease,$=D>>_NeuQuantFloat._radiusBiasShift,$<=1&&($=0);for(let et=0;et<$;et++)this._radPower[et]=F*(($*$-et*et)*_NeuQuantFloat._radBias/($*$))}}}_buildPalette(){const d=new Palette;return this._network.forEach((m=>{d.add(m.toPoint())})),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let $=m+1,U=m-1,j=1;for(;$<D||U>F;){const Z=this._radPower[j++]/_NeuQuantFloat._alphaRadBias;if($<D){const G=this._network[$++];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(Z*(G.r-I),Z*(G.g-w),Z*(G.b-g),Z*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuantFloat._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift2;let P=2147483647,F=P,D=-1,$=D;for(let U=0;U<this._networkSize;U++){const j=this._network[U],Z=this._distance.calculateNormalized(j,{r:g,g:m,b:d,a:w})*I;Z<P&&(P=Z,D=U);const G=Z-(this._bias[U]>>_NeuQuantFloat._initialBiasShift-networkBiasShift2);G<F&&(F=G,$=U);const H=this._freq[U]>>_NeuQuantFloat._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuantFloat._gammaShift}return this._freq[D]+=_NeuQuantFloat._beta,this._bias[D]-=_NeuQuantFloat._betaGamma,$}},NeuQuantFloat=_NeuQuantFloat;__publicField(NeuQuantFloat,"_prime1",499),__publicField(NeuQuantFloat,"_prime2",491),__publicField(NeuQuantFloat,"_prime3",487),__publicField(NeuQuantFloat,"_prime4",503),__publicField(NeuQuantFloat,"_minpicturebytes",_NeuQuantFloat._prime4),__publicField(NeuQuantFloat,"_nCycles",100),__publicField(NeuQuantFloat,"_initialBiasShift",16),__publicField(NeuQuantFloat,"_initialBias",1<<_NeuQuantFloat._initialBiasShift),__publicField(NeuQuantFloat,"_gammaShift",10),__publicField(NeuQuantFloat,"_betaShift",10),__publicField(NeuQuantFloat,"_beta",_NeuQuantFloat._initialBias>>_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_betaGamma",_NeuQuantFloat._initialBias<<_NeuQuantFloat._gammaShift-_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_radiusBiasShift",6),__publicField(NeuQuantFloat,"_radiusBias",1<<_NeuQuantFloat._radiusBiasShift),__publicField(NeuQuantFloat,"_radiusDecrease",30),__publicField(NeuQuantFloat,"_alphaBiasShift",10),__publicField(NeuQuantFloat,"_initAlpha",1<<_NeuQuantFloat._alphaBiasShift),__publicField(NeuQuantFloat,"_radBiasShift",8),__publicField(NeuQuantFloat,"_radBias",1<<_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBiasShift",_NeuQuantFloat._alphaBiasShift+_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBias",1<<_NeuQuantFloat._alphaRadBiasShift);var _ColorHistogram=class{constructor(d,m){__publicField(this,"_method"),__publicField(this,"_hueStats"),__publicField(this,"_histogram"),__publicField(this,"_initColors"),__publicField(this,"_minHueCols"),this._method=d,this._minHueCols=m<<2,this._initColors=m<<2,this._hueStats=new HueStatistics(_ColorHistogram._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(d){switch(this._method){case 1:this._colorStats1D(d);break;case 2:this._colorStats2D(d)}}getImportanceSortedColorsIDXI32(){const d=stableSort(Object.keys(this._histogram),((g,w)=>this._histogram[w]-this._histogram[g]));if(d.length===0)return[];let m;switch(this._method){case 1:const g=Math.min(d.length,this._initColors),w=d[g-1],I=this._histogram[w];m=d.slice(0,g);let P=g;const F=d.length;for(;P<F&&this._histogram[d[P]]===I;)m.push(d[P++]);this._hueStats.injectIntoArray(m);break;case 2:m=d;break;default:throw new Error("Incorrect method")}return m.map((g=>+g))}_colorStats1D(d){const m=this._histogram,g=d.getPointArray(),w=g.length;for(let I=0;I<w;I++){const P=g[I].uint32;this._hueStats.check(P),P in m?m[P]++:m[P]=1}}_colorStats2D(d){const m=d.getWidth(),g=d.getHeight(),w=d.getPointArray(),I=_ColorHistogram._boxSize[0],P=_ColorHistogram._boxSize[1],F=I*P,D=this._makeBoxes(m,g,I,P),$=this._histogram;D.forEach((U=>{let j=Math.round(U.w*U.h/F)*_ColorHistogram._boxPixels;j<2&&(j=2);const Z={};this._iterateBox(U,m,(G=>{const H=w[G].uint32;this._hueStats.check(H),H in $?$[H]++:H in Z?++Z[H]>=j&&($[H]=Z[H]):Z[H]=1}))})),this._hueStats.injectIntoDictionary($)}_iterateBox(d,m,g){const w=d,I=w.y*m+w.x,P=(w.y+w.h-1)*m+(w.x+w.w-1),F=m-w.w+1;let D=0,$=I;do g.call(this,$),$+=++D%w.w==0?F:1;while($<=P)}_makeBoxes(d,m,g,w){const I=d%g,P=m%w,F=d-I,D=m-P,$=[];for(let U=0;U<m;U+=w)for(let j=0;j<d;j+=g)$.push({x:j,y:U,w:j===F?I:g,h:U===D?P:w});return $}},ColorHistogram=_ColorHistogram;__publicField(ColorHistogram,"_boxSize",[64,64]),__publicField(ColorHistogram,"_boxPixels",2),__publicField(ColorHistogram,"_hueGroups",10);var RemovedColor=class{constructor(d,m,g){__publicField(this,"index"),__publicField(this,"color"),__publicField(this,"distance"),this.index=d,this.color=m,this.distance=g}},RGBQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256,g=2){super(),__publicField(this,"_colors"),__publicField(this,"_initialDistance"),__publicField(this,"_distanceIncrement"),__publicField(this,"_histogram"),__publicField(this,"_distance"),this._distance=d,this._colors=m,this._histogram=new ColorHistogram(g,m),this._initialDistance=.01,this._distanceIncrement=.005}sample(d){this._histogram.sample(d)}*quantize(){const d=this._histogram.getImportanceSortedColorsIDXI32();if(d.length===0)throw new Error("No colors in image");yield*this._buildPalette(d)}*_buildPalette(d){const m=new Palette,g=m.getPointContainer().getPointArray(),w=new Array(d.length);for(let j=0;j<d.length;j++)g.push(Point.createByUint32(d[j])),w[j]=1;const I=g.length,P=[];let F=I,D=this._initialDistance;const $=new ProgressTracker(F-this._colors,99);for(;F>this._colors;){P.length=0;for(let j=0;j<I;j++){if($.shouldNotify(I-F)&&(yield{progress:$.progress}),w[j]===0)continue;const Z=g[j];for(let G=j+1;G<I;G++){if(w[G]===0)continue;const H=g[G],W=this._distance.calculateNormalized(Z,H);W<D&&(P.push(new RemovedColor(G,H,W)),w[G]=0,F--)}}D+=F>3*this._colors?this._initialDistance:this._distanceIncrement}if(F<this._colors){stableSort(P,((Z,G)=>G.distance-Z.distance));let j=0;for(;F<this._colors&&j<P.length;)w[P[j].index]=1,F++,j++}let U=g.length;for(let j=U-1;j>=0;j--)w[j]===0&&(j!==U-1&&(g[j]=g[U-1]),--U);g.length=U,m.sort(),yield{palette:m,progress:100}}};function createArray1D(d){const m=[];for(let g=0;g<d;g++)m[g]=0;return m}function createArray4D(d,m,g,w){const I=new Array(d);for(let P=0;P<d;P++){I[P]=new Array(m);for(let F=0;F<m;F++){I[P][F]=new Array(g);for(let D=0;D<g;D++){I[P][F][D]=new Array(w);for(let $=0;$<w;$++)I[P][F][D][$]=0}}}return I}function createArray3D(d,m,g){const w=new Array(d);for(let I=0;I<d;I++){w[I]=new Array(m);for(let P=0;P<m;P++){w[I][P]=new Array(g);for(let F=0;F<g;F++)w[I][P][F]=0}}return w}function fillArray3D(d,m,g,w,I){for(let P=0;P<m;P++){d[P]=[];for(let F=0;F<g;F++){d[P][F]=[];for(let D=0;D<w;D++)d[P][F][D]=I}}}function fillArray1D(d,m,g){for(let w=0;w<m;w++)d[w]=g}var WuColorCube=class{constructor(){__publicField(this,"redMinimum"),__publicField(this,"redMaximum"),__publicField(this,"greenMinimum"),__publicField(this,"greenMaximum"),__publicField(this,"blueMinimum"),__publicField(this,"blueMaximum"),__publicField(this,"volume"),__publicField(this,"alphaMinimum"),__publicField(this,"alphaMaximum")}},_WuQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256,g=5){super(),__publicField(this,"_reds"),__publicField(this,"_greens"),__publicField(this,"_blues"),__publicField(this,"_alphas"),__publicField(this,"_sums"),__publicField(this,"_weights"),__publicField(this,"_momentsRed"),__publicField(this,"_momentsGreen"),__publicField(this,"_momentsBlue"),__publicField(this,"_momentsAlpha"),__publicField(this,"_moments"),__publicField(this,"_table"),__publicField(this,"_pixels"),__publicField(this,"_cubes"),__publicField(this,"_colors"),__publicField(this,"_significantBitsPerChannel"),__publicField(this,"_maxSideIndex"),__publicField(this,"_alphaMaxSideIndex"),__publicField(this,"_sideSize"),__publicField(this,"_alphaSideSize"),__publicField(this,"_distance"),this._distance=d,this._setQuality(g),this._initialize(m)}sample(d){const m=d.getPointArray();for(let g=0,w=m.length;g<w;g++)this._addColor(m[g]);this._pixels=this._pixels.concat(m)}*quantize(){yield*this._preparePalette();const d=new Palette;for(let m=0;m<this._colors;m++)if(this._sums[m]>0){const g=this._sums[m],w=this._reds[m]/g,I=this._greens[m]/g,P=this._blues[m]/g,F=this._alphas[m]/g,D=Point.createByRGBA(0|w,0|I,0|P,0|F);d.add(D)}d.sort(),yield{palette:d,progress:100}}*_preparePalette(){yield*this._calculateMoments();let d=0;const m=createArray1D(this._colors);for(let F=1;F<this._colors;++F){this._cut(this._cubes[d],this._cubes[F])?(m[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0,m[F]=this._cubes[F].volume>1?this._calculateVariance(this._cubes[F]):0):(m[d]=0,F--),d=0;let D=m[0];for(let $=1;$<=F;++$)m[$]>D&&(D=m[$],d=$);if(D<=0){this._colors=F+1;break}}const g=[],w=[],I=[],P=[];for(let F=0;F<this._colors;++F){const D=_WuQuant._volume(this._cubes[F],this._weights);D>0?(g[F]=_WuQuant._volume(this._cubes[F],this._momentsRed)/D|0,w[F]=_WuQuant._volume(this._cubes[F],this._momentsGreen)/D|0,I[F]=_WuQuant._volume(this._cubes[F],this._momentsBlue)/D|0,P[F]=_WuQuant._volume(this._cubes[F],this._momentsAlpha)/D|0):(g[F]=0,w[F]=0,I[F]=0,P[F]=0)}this._reds=createArray1D(this._colors+1),this._greens=createArray1D(this._colors+1),this._blues=createArray1D(this._colors+1),this._alphas=createArray1D(this._colors+1),this._sums=createArray1D(this._colors+1);for(let F=0,D=this._pixels.length;F<D;F++){const $=this._pixels[F];let U=-1,j=Number.MAX_VALUE;for(let Z=0;Z<this._colors;Z++){const G=g[Z],H=w[Z],W=I[Z],Q=P[Z],q=this._distance.calculateRaw(G,H,W,Q,$.r,$.g,$.b,$.a);q<j&&(j=q,U=Z)}this._reds[U]+=$.r,this._greens[U]+=$.g,this._blues[U]+=$.b,this._alphas[U]+=$.a,this._sums[U]++}}_addColor(d){const m=8-this._significantBitsPerChannel,g=1+(d.r>>m),w=1+(d.g>>m),I=1+(d.b>>m),P=1+(d.a>>m);this._weights[P][g][w][I]++,this._momentsRed[P][g][w][I]+=d.r,this._momentsGreen[P][g][w][I]+=d.g,this._momentsBlue[P][g][w][I]+=d.b,this._momentsAlpha[P][g][w][I]+=d.a,this._moments[P][g][w][I]+=this._table[d.r]+this._table[d.g]+this._table[d.b]+this._table[d.a]}*_calculateMoments(){const d=[],m=[],g=[],w=[],I=[],P=[],F=createArray3D(this._sideSize,this._sideSize,this._sideSize),D=createArray3D(this._sideSize,this._sideSize,this._sideSize),$=createArray3D(this._sideSize,this._sideSize,this._sideSize),U=createArray3D(this._sideSize,this._sideSize,this._sideSize),j=createArray3D(this._sideSize,this._sideSize,this._sideSize),Z=createArray3D(this._sideSize,this._sideSize,this._sideSize);let G=0;const H=new ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let W=1;W<=this._alphaMaxSideIndex;++W){fillArray3D(F,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(D,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(U,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(j,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(Z,this._sideSize,this._sideSize,this._sideSize,0);for(let Q=1;Q<=this._maxSideIndex;++Q,++G){H.shouldNotify(G)&&(yield{progress:H.progress}),fillArray1D(d,this._sideSize,0),fillArray1D(m,this._sideSize,0),fillArray1D(g,this._sideSize,0),fillArray1D(w,this._sideSize,0),fillArray1D(I,this._sideSize,0),fillArray1D(P,this._sideSize,0);for(let q=1;q<=this._maxSideIndex;++q){let rt=0,et=0,X=0,J=0,tt=0,st=0;for(let nt=1;nt<=this._maxSideIndex;++nt)rt+=this._weights[W][Q][q][nt],et+=this._momentsRed[W][Q][q][nt],X+=this._momentsGreen[W][Q][q][nt],J+=this._momentsBlue[W][Q][q][nt],tt+=this._momentsAlpha[W][Q][q][nt],st+=this._moments[W][Q][q][nt],d[nt]+=rt,m[nt]+=et,g[nt]+=X,w[nt]+=J,I[nt]+=tt,P[nt]+=st,F[Q][q][nt]=F[Q-1][q][nt]+d[nt],D[Q][q][nt]=D[Q-1][q][nt]+m[nt],$[Q][q][nt]=$[Q-1][q][nt]+g[nt],U[Q][q][nt]=U[Q-1][q][nt]+w[nt],j[Q][q][nt]=j[Q-1][q][nt]+I[nt],Z[Q][q][nt]=Z[Q-1][q][nt]+P[nt],this._weights[W][Q][q][nt]=this._weights[W-1][Q][q][nt]+F[Q][q][nt],this._momentsRed[W][Q][q][nt]=this._momentsRed[W-1][Q][q][nt]+D[Q][q][nt],this._momentsGreen[W][Q][q][nt]=this._momentsGreen[W-1][Q][q][nt]+$[Q][q][nt],this._momentsBlue[W][Q][q][nt]=this._momentsBlue[W-1][Q][q][nt]+U[Q][q][nt],this._momentsAlpha[W][Q][q][nt]=this._momentsAlpha[W-1][Q][q][nt]+j[Q][q][nt],this._moments[W][Q][q][nt]=this._moments[W-1][Q][q][nt]+Z[Q][q][nt]}}}}static _volumeFloat(d,m){return m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMaximum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum])}static _volume(d,m){return 0|_WuQuant._volumeFloat(d,m)}static _top(d,m,g,w){let I;switch(m){case _WuQuant._alpha:I=w[g][d.redMaximum][d.greenMaximum][d.blueMaximum]-w[g][d.redMaximum][d.greenMinimum][d.blueMaximum]-w[g][d.redMinimum][d.greenMaximum][d.blueMaximum]+w[g][d.redMinimum][d.greenMinimum][d.blueMaximum]-(w[g][d.redMaximum][d.greenMaximum][d.blueMinimum]-w[g][d.redMaximum][d.greenMinimum][d.blueMinimum]-w[g][d.redMinimum][d.greenMaximum][d.blueMinimum]+w[g][d.redMinimum][d.greenMinimum][d.blueMinimum]);break;case _WuQuant._red:I=w[d.alphaMaximum][g][d.greenMaximum][d.blueMaximum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMaximum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMaximum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMaximum]-(w[d.alphaMaximum][g][d.greenMaximum][d.blueMinimum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMinimum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMinimum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMinimum]);break;case _WuQuant._green:I=w[d.alphaMaximum][d.redMaximum][g][d.blueMaximum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMaximum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMaximum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMaximum]-(w[d.alphaMaximum][d.redMaximum][g][d.blueMinimum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMinimum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMinimum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMinimum]);break;case _WuQuant._blue:I=w[d.alphaMaximum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMaximum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMaximum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMaximum][d.redMinimum][d.greenMinimum][g]-(w[d.alphaMinimum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMinimum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMinimum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMinimum][d.redMinimum][d.greenMinimum][g]);break;default:throw new Error("impossible")}return 0|I}static _bottom(d,m,g){switch(m){case _WuQuant._alpha:return-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._red:return-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._green:return-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._blue:return-g[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);default:return 0}}_calculateVariance(d){const m=_WuQuant._volume(d,this._momentsRed),g=_WuQuant._volume(d,this._momentsGreen),w=_WuQuant._volume(d,this._momentsBlue),I=_WuQuant._volume(d,this._momentsAlpha);return _WuQuant._volumeFloat(d,this._moments)-(m*m+g*g+w*w+I*I)/_WuQuant._volume(d,this._weights)}_maximize(d,m,g,w,I,P,F,D,$){const U=0|_WuQuant._bottom(d,m,this._momentsRed),j=0|_WuQuant._bottom(d,m,this._momentsGreen),Z=0|_WuQuant._bottom(d,m,this._momentsBlue),G=0|_WuQuant._bottom(d,m,this._momentsAlpha),H=0|_WuQuant._bottom(d,m,this._weights);let W=0,Q=-1;for(let q=g;q<w;++q){let rt=U+_WuQuant._top(d,m,q,this._momentsRed),et=j+_WuQuant._top(d,m,q,this._momentsGreen),X=Z+_WuQuant._top(d,m,q,this._momentsBlue),J=G+_WuQuant._top(d,m,q,this._momentsAlpha),tt=H+_WuQuant._top(d,m,q,this._weights);if(tt!==0){let st=rt*rt+et*et+X*X+J*J,nt=st/tt;rt=I-rt,et=P-et,X=F-X,J=D-J,tt=$-tt,tt!==0&&(st=rt*rt+et*et+X*X+J*J,nt+=st/tt,nt>W&&(W=nt,Q=q))}}return{max:W,position:Q}}_cut(d,m){let g;const w=_WuQuant._volume(d,this._momentsRed),I=_WuQuant._volume(d,this._momentsGreen),P=_WuQuant._volume(d,this._momentsBlue),F=_WuQuant._volume(d,this._momentsAlpha),D=_WuQuant._volume(d,this._weights),$=this._maximize(d,_WuQuant._red,d.redMinimum+1,d.redMaximum,w,I,P,F,D),U=this._maximize(d,_WuQuant._green,d.greenMinimum+1,d.greenMaximum,w,I,P,F,D),j=this._maximize(d,_WuQuant._blue,d.blueMinimum+1,d.blueMaximum,w,I,P,F,D),Z=this._maximize(d,_WuQuant._alpha,d.alphaMinimum+1,d.alphaMaximum,w,I,P,F,D);if(Z.max>=$.max&&Z.max>=U.max&&Z.max>=j.max){if(g=_WuQuant._alpha,Z.position<0)return!1}else g=$.max>=Z.max&&$.max>=U.max&&$.max>=j.max?_WuQuant._red:U.max>=Z.max&&U.max>=$.max&&U.max>=j.max?_WuQuant._green:_WuQuant._blue;switch(m.redMaximum=d.redMaximum,m.greenMaximum=d.greenMaximum,m.blueMaximum=d.blueMaximum,m.alphaMaximum=d.alphaMaximum,g){case _WuQuant._red:m.redMinimum=d.redMaximum=$.position,m.greenMinimum=d.greenMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._green:m.greenMinimum=d.greenMaximum=U.position,m.redMinimum=d.redMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._blue:m.blueMinimum=d.blueMaximum=j.position,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._alpha:m.alphaMinimum=d.alphaMaximum=Z.position,m.blueMinimum=d.blueMinimum,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum}return d.volume=(d.redMaximum-d.redMinimum)*(d.greenMaximum-d.greenMinimum)*(d.blueMaximum-d.blueMinimum)*(d.alphaMaximum-d.alphaMinimum),m.volume=(m.redMaximum-m.redMinimum)*(m.greenMaximum-m.greenMinimum)*(m.blueMaximum-m.blueMinimum)*(m.alphaMaximum-m.alphaMinimum),!0}_initialize(d){this._colors=d,this._cubes=[];for(let m=0;m<d;m++)this._cubes[m]=new WuColorCube;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let m=0;m<256;++m)this._table[m]=m*m;this._pixels=[]}_setQuality(d=5){this._significantBitsPerChannel=d,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant=_WuQuant;__publicField(WuQuant,"_alpha",3),__publicField(WuQuant,"_red",2),__publicField(WuQuant,"_green",1),__publicField(WuQuant,"_blue",0);var image_exports={};__export(image_exports,{AbstractImageQuantizer:()=>AbstractImageQuantizer,ErrorDiffusionArray:()=>ErrorDiffusionArray,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma,NearestColor:()=>NearestColor});var AbstractImageQuantizer=class{quantizeSync(d,m){for(const g of this.quantize(d,m))if(g.pointContainer)return g.pointContainer;throw new Error("unreachable")}},NearestColor=class extends AbstractImageQuantizer{constructor(d){super(),__publicField(this,"_distance"),this._distance=d}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=new ProgressTracker(I,99);for(let F=0;F<I;F++){P.shouldNotify(F)&&(yield{progress:P.progress});for(let D=0,$=F*w;D<w;D++,$++){const U=g[$];U.from(m.getNearestColor(this._distance,U))}}yield{pointContainer:d,progress:100}}},ErrorDiffusionArrayKernel=(d=>(d[d.FloydSteinberg=0]="FloydSteinberg",d[d.FalseFloydSteinberg=1]="FalseFloydSteinberg",d[d.Stucki=2]="Stucki",d[d.Atkinson=3]="Atkinson",d[d.Jarvis=4]="Jarvis",d[d.Burkes=5]="Burkes",d[d.Sierra=6]="Sierra",d[d.TwoSierra=7]="TwoSierra",d[d.SierraLite=8]="SierraLite",d))(ErrorDiffusionArrayKernel||{}),ErrorDiffusionArray=class extends AbstractImageQuantizer{constructor(d,m,g=!0,w=0,I=!1){super(),__publicField(this,"_minColorDistance"),__publicField(this,"_serpentine"),__publicField(this,"_kernel"),__publicField(this,"_calculateErrorLikeGIMP"),__publicField(this,"_distance"),this._setKernel(m),this._distance=d,this._minColorDistance=w,this._serpentine=g,this._calculateErrorLikeGIMP=I}*quantize(d,m){const g=d.getPointArray(),w=new Point,I=d.getWidth(),P=d.getHeight(),F=[];let D=1,$=1;for(const j of this._kernel){const Z=j[2]+1;$<Z&&($=Z)}for(let j=0;j<$;j++)this._fillErrorLine(F[j]=[],I);const U=new ProgressTracker(P,99);for(let j=0;j<P;j++){U.shouldNotify(j)&&(yield{progress:U.progress}),this._serpentine&&(D*=-1);const Z=j*I,G=D===1?0:I-1,H=D===1?I:-1;this._fillErrorLine(F[0],I),F.push(F.shift());const W=F[0];for(let Q=G,q=Z+G;Q!==H;Q+=D,q+=D){const rt=g[q],et=W[Q];w.from(rt);const X=Point.createByRGBA(inRange0to255Rounded(rt.r+et[0]),inRange0to255Rounded(rt.g+et[1]),inRange0to255Rounded(rt.b+et[2]),inRange0to255Rounded(rt.a+et[3])),J=m.getNearestColor(this._distance,X);if(rt.from(J),this._minColorDistance&&this._distance.calculateNormalized(w,J)<this._minColorDistance)continue;let tt,st,nt,lt;this._calculateErrorLikeGIMP?(tt=X.r-J.r,st=X.g-J.g,nt=X.b-J.b,lt=X.a-J.a):(tt=w.r-J.r,st=w.g-J.g,nt=w.b-J.b,lt=w.a-J.a);const at=D===1?0:this._kernel.length-1,ct=D===1?this._kernel.length:-1;for(let V=at;V!==ct;V+=D){const ut=this._kernel[V][1]*D,wt=this._kernel[V][2];if(ut+Q>=0&&ut+Q<I&&wt+j>=0&&wt+j<P){const dt=this._kernel[V][0],ft=F[wt][ut+Q];ft[0]+=tt*dt,ft[1]+=st*dt,ft[2]+=nt*dt,ft[3]+=lt*dt}}}}yield{pointContainer:d,progress:100}}_fillErrorLine(d,m){d.length>m&&(d.length=m);const g=d.length;for(let w=0;w<g;w++){const I=d[w];I[0]=I[1]=I[2]=I[3]=0}for(let w=g;w<m;w++)d[w]=[0,0,0,0]}_setKernel(d){switch(d){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${d}`)}}};function*hilbertCurve(d,m,g){const w=Math.max(d,m),I={width:d,height:m,level:Math.floor(Math.log(w)/Math.log(2)+1),callback:g,tracker:new ProgressTracker(d*m,99),index:0,x:0,y:0};yield*walkHilbert(I,1),visit(I,0)}function*walkHilbert(d,m){if(!(d.level<1)){switch(d.tracker.shouldNotify(d.index)&&(yield{progress:d.tracker.progress}),d.level--,m){case 2:yield*walkHilbert(d,1),visit(d,3),yield*walkHilbert(d,2),visit(d,4),yield*walkHilbert(d,2),visit(d,2),yield*walkHilbert(d,4);break;case 3:yield*walkHilbert(d,4),visit(d,2),yield*walkHilbert(d,3),visit(d,1),yield*walkHilbert(d,3),visit(d,3),yield*walkHilbert(d,1);break;case 1:yield*walkHilbert(d,2),visit(d,4),yield*walkHilbert(d,1),visit(d,3),yield*walkHilbert(d,1),visit(d,1),yield*walkHilbert(d,3);break;case 4:yield*walkHilbert(d,3),visit(d,1),yield*walkHilbert(d,4),visit(d,2),yield*walkHilbert(d,4),visit(d,4),yield*walkHilbert(d,2)}d.level++}}function visit(d,m){switch(d.x>=0&&d.x<d.width&&d.y>=0&&d.y<d.height&&(d.callback(d.x,d.y),d.index++),m){case 2:d.x--;break;case 3:d.x++;break;case 1:d.y--;break;case 4:d.y++}}var ErrorDiffusionRiemersma=class extends AbstractImageQuantizer{constructor(d,m=16,g=1){super(),__publicField(this,"_distance"),__publicField(this,"_weights"),__publicField(this,"_errorQueueSize"),this._distance=d,this._errorQueueSize=m,this._weights=ErrorDiffusionRiemersma._createWeights(g,m)}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=[];let F=0;for(let D=0;D<this._errorQueueSize;D++)P[D]={r:0,g:0,b:0,a:0};yield*hilbertCurve(w,I,((D,$)=>{const U=g[D+$*w];let{r:j,g:Z,b:G,a:H}=U;for(let rt=0;rt<this._errorQueueSize;rt++){const et=this._weights[rt],X=P[(rt+F)%this._errorQueueSize];j+=X.r*et,Z+=X.g*et,G+=X.b*et,H+=X.a*et}const W=Point.createByRGBA(inRange0to255Rounded(j),inRange0to255Rounded(Z),inRange0to255Rounded(G),inRange0to255Rounded(H)),Q=m.getNearestColor(this._distance,W);F=(F+1)%this._errorQueueSize;const q=(F+this._errorQueueSize-1)%this._errorQueueSize;P[q].r=U.r-Q.r,P[q].g=U.g-Q.g,P[q].b=U.b-Q.b,P[q].a=U.a-Q.a,U.from(Q)})),yield{pointContainer:d,progress:100}}static _createWeights(d,m){const g=[],w=Math.exp(Math.log(m)/(m-1));for(let I=0,P=1;I<m;I++)g[I]=(P+.5|0)/m*d,P*=w;return g}},quality_exports={};__export(quality_exports,{ssim:()=>ssim});var K1=.01,K2=.03;function ssim(d,m){if(d.getHeight()!==m.getHeight()||d.getWidth()!==m.getWidth())throw new Error("Images have different sizes!");const g=(255*K1)**2,w=(255*K2)**2;let I=0,P=0;return iterate(d,m,((F,D,$,U)=>{let j=0,Z=0,G=0;for(let W=0;W<F.length;W++)Z+=(F[W]-$)**2,G+=(D[W]-U)**2,j+=(F[W]-$)*(D[W]-U);const H=F.length-1;Z/=H,G/=H,j/=H,P+=(2*$*U+g)*(2*j+w)/(($**2+U**2+g)*(Z+G+w)),I++})),P/I}function iterate(d,m,g){const w=d.getWidth(),I=d.getHeight();for(let P=0;P<I;P+=8)for(let F=0;F<w;F+=8){const D=Math.min(8,w-F),$=Math.min(8,I-P),U=calculateLumaValuesForWindow(d,F,P,D,$),j=calculateLumaValuesForWindow(m,F,P,D,$);g(U,j,calculateAverageLuma(U),calculateAverageLuma(j))}}function calculateLumaValuesForWindow(d,m,g,w,I){const P=d.getPointArray(),F=[];let D=0;for(let $=g;$<g+I;$++){const U=$*d.getWidth();for(let j=m;j<m+w;j++){const Z=P[U+j];F[D]=.2126*Z.r+.7152*Z.g+.0722*Z.b,D++}}return F}function calculateAverageLuma(d){let m=0;for(const g of d)m+=g;return m/d.length}function buildPaletteSync(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w}={}){const I=paletteQuantizationToPaletteQuantizer(colorDistanceFormulaToColorDistance(m),g,w);return d.forEach((P=>I.sample(P))),I.quantizeSync()}function applyPaletteSync(d,m,{colorDistanceFormula:g,imageQuantization:w}={}){return imageQuantizationToImageQuantizer(colorDistanceFormulaToColorDistance(g),w).quantizeSync(d,m)}function colorDistanceFormulaToColorDistance(d="euclidean-bt709"){switch(d){case"cie94-graphic-arts":return new CIE94GraphicArts;case"cie94-textiles":return new CIE94Textiles;case"ciede2000":return new CIEDE2000;case"color-metric":return new CMetric;case"euclidean":return new Euclidean;case"euclidean-bt709":return new EuclideanBT709;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha;case"manhattan":return new Manhattan;case"manhattan-bt709":return new ManhattanBT709;case"manhattan-nommyde":return new ManhattanNommyde;case"pngquant":return new PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${d}`)}}function imageQuantizationToImageQuantizer(d,m="floyd-steinberg"){switch(m){case"nearest":return new NearestColor(d);case"riemersma":return new ErrorDiffusionRiemersma(d);case"floyd-steinberg":return new ErrorDiffusionArray(d,0);case"false-floyd-steinberg":return new ErrorDiffusionArray(d,1);case"stucki":return new ErrorDiffusionArray(d,2);case"atkinson":return new ErrorDiffusionArray(d,3);case"jarvis":return new ErrorDiffusionArray(d,4);case"burkes":return new ErrorDiffusionArray(d,5);case"sierra":return new ErrorDiffusionArray(d,6);case"two-sierra":return new ErrorDiffusionArray(d,7);case"sierra-lite":return new ErrorDiffusionArray(d,8);default:throw new Error(`Unknown imageQuantization ${m}`)}}function paletteQuantizationToPaletteQuantizer(d,m="wuquant",g=256){switch(m){case"neuquant":return new NeuQuant(d,g);case"rgbquant":return new RGBQuant(d,g);case"wuquant":return new WuQuant(d,g);case"neuquant-float":return new NeuQuantFloat(d,g);default:throw new Error(`Unknown paletteQuantization ${m}`)}}typeof setImmediate=="function"?setImmediate:typeof process<"u"&&process?.nextTick;const QuantizeOptionsSchema=z.object({colors:z.number().optional(),colorDistanceFormula:z.union([z.literal("cie94-textiles"),z.literal("cie94-graphic-arts"),z.literal("ciede2000"),z.literal("color-metric"),z.literal("euclidean"),z.literal("euclidean-bt709-noalpha"),z.literal("euclidean-bt709"),z.literal("manhattan"),z.literal("manhattan-bt709"),z.literal("manhattan-nommyde"),z.literal("pngquant")]).optional(),paletteQuantization:z.union([z.literal("neuquant"),z.literal("neuquant-float"),z.literal("rgbquant"),z.literal("wuquant")]).optional(),imageQuantization:z.union([z.literal("nearest"),z.literal("riemersma"),z.literal("floyd-steinberg"),z.literal("false-floyd-steinberg"),z.literal("stucki"),z.literal("atkinson"),z.literal("jarvis"),z.literal("burkes"),z.literal("sierra"),z.literal("two-sierra"),z.literal("sierra-lite")]).optional()}),methods={quantize(d,m){const{colors:g,colorDistanceFormula:w,paletteQuantization:I,imageQuantization:P}=QuantizeOptionsSchema.parse(m),F=utils_exports.PointContainer.fromUint8Array(d.bitmap.data,d.bitmap.width,d.bitmap.height),D=applyPaletteSync(F,buildPaletteSync([F],{colors:g,colorDistanceFormula:w,paletteQuantization:I}),{colorDistanceFormula:w,imageQuantization:P});return d.bitmap.data=Buffer.from(D.toUint8Array()),d}};var parseBmfontAscii=function(d){if(!d)throw new Error("no data provided");var m={pages:[],chars:[],kernings:[]},g=(d=d.toString().trim()).split(/\r\n?|\n/g);if(g.length===0)throw new Error("no data in BMFont file");for(var w=0;w<g.length;w++){var I=splitLine(g[w],w);if(I)if(I.key==="page"){if(typeof I.data.id!="number")throw new Error("malformed file at line "+w+" -- needs page id=N");if(typeof I.data.file!="string")throw new Error("malformed file at line "+w+' -- needs page file="path"');m.pages[I.data.id]=I.data.file}else I.key==="chars"||I.key==="kernings"||(I.key==="char"?m.chars.push(I.data):I.key==="kerning"?m.kernings.push(I.data):m[I.key]=I.data)}return m};function splitLine(d,m){if(!(d=d.replace(/\t+/g," ").trim()))return null;var g=d.indexOf(" ");if(g===-1)throw new Error("no named row at line "+m);var w=d.substring(0,g);d=(d=(d=(d=d.substring(g+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map((function($){return $.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}));for(var I=[],P=0;P<d.length;P++){var F=d[P];P===0?I.push({key:F[0],data:""}):P===d.length-1?I[I.length-1].data=parseData(F[0]):(I[I.length-1].data=parseData(F[0]),I.push({key:F[1],data:""}))}var D={key:w,data:{}};return I.forEach((function($){D.data[$.key]=$.data})),D}function parseData(d){return d&&d.length!==0?d.indexOf('"')===0||d.indexOf("'")===0?d.substring(1,d.length-1):d.indexOf(",")!==-1?parseIntList$1(d):parseInt(d,10):""}function parseIntList$1(d){return d.split(",").map((function(m){return parseInt(m,10)}))}getDefaultExportFromCjs(parseBmfontAscii);var GLYPH_DESIGNER_ERROR="chasrset",parseAttribs=function(d){for(var m in d=Object.assign({},d),GLYPH_DESIGNER_ERROR in d&&(d.charset=d[GLYPH_DESIGNER_ERROR],delete d[GLYPH_DESIGNER_ERROR]),d)m!=="face"&&m!=="charset"&&(d[m]=m==="padding"||m==="spacing"?parseIntList(d[m]):parseInt(d[m],10));return d};function parseIntList(d){return d.split(",").map((function(m){return parseInt(m,10)}))}var xmlParseFromString=self.DOMParser!==void 0?function(d){return new self.DOMParser().parseFromString(d,"application/xml")}:self.ActiveXObject!==void 0&&new self.ActiveXObject("Microsoft.XMLDOM")?function(d){var m=new self.ActiveXObject("Microsoft.XMLDOM");return m.async="false",m.loadXML(d),m}:function(d){var m=document.createElement("div");return m.innerHTML=d,m},parseAttributes=parseAttribs,parseFromString=xmlParseFromString,NAME_MAP={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"},browser=function(d){d=d.toString();var m=parseFromString(d),g={pages:[],chars:[],kernings:[]};["info","common"].forEach((function(U){var j=m.getElementsByTagName(U)[0];j&&(g[U]=parseAttributes(getAttribs(j)))}));var w=m.getElementsByTagName("pages")[0];if(!w)throw new Error("malformed file -- no <pages> element");for(var I=w.getElementsByTagName("page"),P=0;P<I.length;P++){var F=I[P],D=parseInt(F.getAttribute("id"),10),$=F.getAttribute("file");if(isNaN(D))throw new Error('malformed file -- page "id" attribute is NaN');if(!$)throw new Error('malformed file -- needs page "file" attribute');g.pages[parseInt(D,10)]=$}return["chars","kernings"].forEach((function(U){var j=m.getElementsByTagName(U)[0];if(j)for(var Z=U.substring(0,U.length-1),G=j.getElementsByTagName(Z),H=0;H<G.length;H++){var W=G[H];g[U].push(parseAttributes(getAttribs(W)))}})),g};function getAttribs(d){return getAttribList(d).reduce((function(m,g){return m[mapName(g.nodeName)]=g.nodeValue,m}),{})}function getAttribList(d){for(var m=[],g=0;g<d.attributes.length;g++)m.push(d.attributes[g]);return m}function mapName(d){return NAME_MAP[d.toLowerCase()]||d}getDefaultExportFromCjs(browser);var HEADER$1=[66,77,70],parseBmfontBinary=function(d){if(d.length<6)throw new Error("invalid buffer length for BMFont");var m=HEADER$1.every((function(P,F){return d.readUInt8(F)===P}));if(!m)throw new Error("BMFont missing BMF byte header");var g=3;if(d.readUInt8(g++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var w={kernings:[],chars:[]},I=0;I<5;I++)g+=readBlock(w,d,g);return w};function readBlock(d,m,g){if(g>m.length-1)return 0;var w=m.readUInt8(g++),I=m.readInt32LE(g);switch(g+=4,w){case 1:d.info=readInfo(m,g);break;case 2:d.common=readCommon(m,g);break;case 3:d.pages=readPages(m,g,I);break;case 4:d.chars=readChars(m,g,I);break;case 5:d.kernings=readKernings(m,g,I)}return 5+I}function readInfo(d,m){var g={};g.size=d.readInt16LE(m);var w=d.readUInt8(m+2);return g.smooth=w>>7&1,g.unicode=w>>6&1,g.italic=w>>5&1,g.bold=w>>4&1,w>>3&1&&(g.fixedHeight=1),g.charset=d.readUInt8(m+3)||"",g.stretchH=d.readUInt16LE(m+4),g.aa=d.readUInt8(m+6),g.padding=[d.readInt8(m+7),d.readInt8(m+8),d.readInt8(m+9),d.readInt8(m+10)],g.spacing=[d.readInt8(m+11),d.readInt8(m+12)],g.outline=d.readUInt8(m+13),g.face=readStringNT(d,m+14),g}function readCommon(d,m){var g={};return g.lineHeight=d.readUInt16LE(m),g.base=d.readUInt16LE(m+2),g.scaleW=d.readUInt16LE(m+4),g.scaleH=d.readUInt16LE(m+6),g.pages=d.readUInt16LE(m+8),d.readUInt8(m+10),g.packed=0,g.alphaChnl=d.readUInt8(m+11),g.redChnl=d.readUInt8(m+12),g.greenChnl=d.readUInt8(m+13),g.blueChnl=d.readUInt8(m+14),g}function readPages(d,m,g){for(var w=[],I=readNameNT(d,m),P=I.length+1,F=g/P,D=0;D<F;D++)w[D]=d.slice(m,m+I.length).toString("utf8"),m+=P;return w}function readChars(d,m,g){for(var w=[],I=g/20,P=0;P<I;P++){var F={},D=20*P;F.id=d.readUInt32LE(m+0+D),F.x=d.readUInt16LE(m+4+D),F.y=d.readUInt16LE(m+6+D),F.width=d.readUInt16LE(m+8+D),F.height=d.readUInt16LE(m+10+D),F.xoffset=d.readInt16LE(m+12+D),F.yoffset=d.readInt16LE(m+14+D),F.xadvance=d.readInt16LE(m+16+D),F.page=d.readUInt8(m+18+D),F.chnl=d.readUInt8(m+19+D),w[P]=F}return w}function readKernings(d,m,g){for(var w=[],I=g/10,P=0;P<I;P++){var F={},D=10*P;F.first=d.readUInt32LE(m+0+D),F.second=d.readUInt32LE(m+4+D),F.amount=d.readInt16LE(m+8+D),w[P]=F}return w}function readNameNT(d,m){for(var g=m;g<d.length&&d[g]!==0;g++);return d.slice(m,g)}function readStringNT(d,m){return readNameNT(d,m).toString("utf8")}getDefaultExportFromCjs(parseBmfontBinary);function e(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}const t=d=>{if(!d)return null;const m={};switch(d.type){case"ELEMENT":{let g={};const w=E(d.value.attributes),I=t(d.value.children);if(w&&(g=Object.assign(g,w)),I){const P=r(d.value.children);g=Object.assign(g,P)}m[d.value.type]=g;break}case"ATTRIBUTE":{const g=d.value;m[g.name]=g.value;break}case"CONTENT":return{content:d.value}}return m},r=d=>d&&Array.isArray(d)&&d.length!==0?n(d)?{content:d[0].value}:{children:d.map(t)}:null,n=d=>d&&Array.isArray(d)&&d.length===1&&d[0].type==="CONTENT",E=d=>d&&Array.isArray(d)?d.map(t).reduce(((m,g)=>Object.assign(m,g)),{}):null;var s={convert:d=>t(d.value.children[0])},a={Token:(d,m)=>({type:d,value:m}),TOKEN_TYPE:{OPEN_BRACKET:"OPEN_BRACKET",ELEMENT_TYPE:"ELEMENT_TYPE",CLOSE_ELEMENT:"CLOSE_ELEMENT",ATTRIB_NAME:"ATTRIB_NAME",ATTRIB_VALUE:"ATTRIB_VALUE",ASSIGN:"ASSIGN",CLOSE_BRACKET:"CLOSE_BRACKET",CONTENT:"CONTENT",EOF:"EOF"}};const{Token:T,TOKEN_TYPE:u}=a,c=T("EOF"),l=d=>d===" "||d===`
`||d==="\r"||d==="	",o=d=>d.replace(/'/g,'"');var N={createLexer:function(d){let m=null,g=(Z=>{let G=0;for(;G<Z.length&&l(Z[G]);)G++;return((H,W)=>{if(H.startsWith("<?xml",W)){const Q=H.length;for(;W<Q;)if(H[W]!=="?")W++;else{if(H[W+1]===">")return W+2;W++}}return W})(Z,G)})(d),w=[];const I=()=>d[g],P=()=>m!==c&&g<d.length,F=Z=>Z==='"'||Z==="'",D=()=>{for(;P()&&l(d[g]);)g++},$=Z=>{if(P()){if(d[g]==="<"){let G="<";return g++,P()&&d[g]==="/"?(g++,G="</"):P()&&d[g]==="!"&&d[g+1]==="-"&&d[g+2]==="-"&&(g++,g++,g++,G="<!--"),G}if(I()==="/"){let G="/";return g++,P()&&I()===">"&&(g++,G="/>"),G}if(d[g]==="="||d[g]===">"){const G=d[g];return g++,G}}return U(!!Z)},U=Z=>{const G=Z?/[^>=<]/u:/[a-zA-Z0-9_:-]/;let H=g;for(;P()&&d[g].match(G);)g++;return o(d.substring(H,g))},j=()=>{const Z=g;D();const G=g-Z;if(P())if(m&&m.type===u.OPEN_BRACKET){D();const H=$(!1);m=T(u.ELEMENT_TYPE,H),w.push(H)}else if(m&&m.type===u.ASSIGN){P()&&F(I())&&g++;let H=g;for(;P()&&!F(I());)g++;const W=o(d.substring(H,g));g++,m=T(u.ATTRIB_VALUE,W)}else{D();let H=$(!0);switch(H){case"=":m=m.type===u.ATTRIB_NAME?T(u.ASSIGN):T(u.CONTENT,H);break;case"</":{const W=g;for(;d[g]!==">";)g++;m=T(u.CLOSE_ELEMENT,d.substring(W,g)),g++,w.pop();break}case"/>":{const W=w.pop();m=T(u.CLOSE_ELEMENT,W);break}case"<!--":{const W=["!","-","-"];for(;P()&&(W[2]!==">"||W[1]!=="-"||W[0]!=="-");)W.shift(),W.push(d[g]),g++;return j()}case">":m=T(u.CLOSE_BRACKET);break;case"<":m=T(u.OPEN_BRACKET);break;default:if(H&&H.length>0){if(m.type===u.CLOSE_BRACKET){let W="";I()!=="<"&&(W=U(!0)),m=T(u.CONTENT,H+W)}else if(m.type!==u.ATTRIB_NAME&&m.type!==u.CONTENT)m.type===u.CLOSE_ELEMENT?(H=" ".repeat(G)+H,m=T(u.CONTENT,H)):m=T(u.ATTRIB_NAME,H);else{const W=" ".repeat(G)+H;m=T(u.CONTENT,W)}break}{const W='Unknown Syntax : "'+d[g]+'"';throw new Error(W)}}}else m=c;return m};return{peek:I,next:j,hasNext:P}}};const{createLexer:i}=N,{Token:p,TOKEN_TYPE:O}=a,[A,f,C,h]=["ROOT","ELEMENT","ATTRIBUTE","CONTENT"],_=(d,m)=>({type:d,value:m}),L=d=>_(h,d),y=(d,m,g)=>_(f,{type:d,attributes:m,children:g}),v=(d,m)=>_(C,{name:d,value:m}),S=(d,m)=>{const g=[];for(;d.hasNext();){const w=d.next();switch(w.type){case O.OPEN_BRACKET:{const I=d.next(),[P,F]=R(d);let D=[];F.type!==O.CLOSE_ELEMENT&&(D=S(d,I)),D&&D.length>0&&D[0].type===O.CONTENT&&(D=b(D)),g.push(y(I.value,P,D));break}case O.CLOSE_ELEMENT:if(w.value===m.value)return g;break;case O.CONTENT:g.push(L(w.value));break;case O.EOF:return g;default:throw new Error(`Unknown Lexem type: ${w.type} "${w.value}, scoping element: ${m.value}"`)}}return g},R=d=>{const m=[];let g=d.peek();if(!d.hasNext()||g&&g.type===O.CLOSE_BRACKET||g&&g.type===O.CLOSE_ELEMENT)return[m,g];for(g=d.next();d.hasNext()&&g&&g.type!==O.CLOSE_BRACKET&&g.type!==O.CLOSE_ELEMENT;){const w=g;d.next();const I=d.next(),P=v(w.value,I.value);m.push(P),g=d.next()}return[m,g]};function b(d){let m=[],g="";return d.forEach((w=>{w.type===O.CONTENT?g+=w.value:(g.length&&(m.push(L(g)),g=""),m.push(w))})),g.length&&m.push(L(g)),m}var B={transpile:function(d,m){const g=(w=>_(A,{children:S(w,p(A,"ROOT"))}))(i(d));return m?m.convert(g):g}};const M=s,{transpile:x}=B;var k=e({convertXML:function(d,m){return x(d,m||M)},createAST:function(d){return x(d)}}),simpleXmlToJson_min=k,xmlPackage=getDefaultExportFromCjs(simpleXmlToJson_min);const{convertXML}=xmlPackage;createJimp({formats:[png]});Buffer.from([66,77,70,3]);var pixelmatch_1=pixelmatch;const defaultOptions={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function pixelmatch(d,m,g,w,I,P){if(!isPixelData(d)||!isPixelData(m)||g&&!isPixelData(g))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(d.length!==m.length||g&&g.length!==d.length)throw new Error("Image sizes do not match.");if(d.length!==w*I*4)throw new Error("Image data size does not match width/height.");P=Object.assign({},defaultOptions,P);const F=w*I,D=new Uint32Array(d.buffer,d.byteOffset,F),$=new Uint32Array(m.buffer,m.byteOffset,F);let U=!0;for(let G=0;G<F;G++)if(D[G]!==$[G]){U=!1;break}if(U){if(g&&!P.diffMask)for(let G=0;G<F;G++)drawGrayPixel(d,4*G,P.alpha,g);return 0}const j=35215*P.threshold*P.threshold;let Z=0;for(let G=0;G<I;G++)for(let H=0;H<w;H++){const W=4*(G*w+H),Q=colorDelta(d,m,W,W);Math.abs(Q)>j?P.includeAA||!antialiased(d,H,G,w,I,m)&&!antialiased(m,H,G,w,I,d)?(g&&drawPixel(g,W,...Q<0&&P.diffColorAlt||P.diffColor),Z++):g&&!P.diffMask&&drawPixel(g,W,...P.aaColor):g&&(P.diffMask||drawGrayPixel(d,W,P.alpha,g))}return Z}function isPixelData(d){return ArrayBuffer.isView(d)&&d.constructor.BYTES_PER_ELEMENT===1}function antialiased(d,m,g,w,I,P){const F=Math.max(m-1,0),D=Math.max(g-1,0),$=Math.min(m+1,w-1),U=Math.min(g+1,I-1),j=4*(g*w+m);let Z,G,H,W,Q=m===F||m===$||g===D||g===U?1:0,q=0,rt=0;for(let et=F;et<=$;et++)for(let X=D;X<=U;X++){if(et===m&&X===g)continue;const J=colorDelta(d,d,j,4*(X*w+et),!0);if(J===0){if(Q++,Q>2)return!1}else J<q?(q=J,Z=et,G=X):J>rt&&(rt=J,H=et,W=X)}return q!==0&&rt!==0&&(hasManySiblings(d,Z,G,w,I)&&hasManySiblings(P,Z,G,w,I)||hasManySiblings(d,H,W,w,I)&&hasManySiblings(P,H,W,w,I))}function hasManySiblings(d,m,g,w,I){const P=Math.max(m-1,0),F=Math.max(g-1,0),D=Math.min(m+1,w-1),$=Math.min(g+1,I-1),U=4*(g*w+m);let j=m===P||m===D||g===F||g===$?1:0;for(let Z=P;Z<=D;Z++)for(let G=F;G<=$;G++){if(Z===m&&G===g)continue;const H=4*(G*w+Z);if(d[U]===d[H]&&d[U+1]===d[H+1]&&d[U+2]===d[H+2]&&d[U+3]===d[H+3]&&j++,j>2)return!0}return!1}function colorDelta(d,m,g,w,I){let P=d[g+0],F=d[g+1],D=d[g+2],$=d[g+3],U=m[w+0],j=m[w+1],Z=m[w+2],G=m[w+3];if($===G&&P===U&&F===j&&D===Z)return 0;$<255&&($/=255,P=blend(P,$),F=blend(F,$),D=blend(D,$)),G<255&&(G/=255,U=blend(U,G),j=blend(j,G),Z=blend(Z,G));const H=rgb2y(P,F,D),W=rgb2y(U,j,Z),Q=H-W;if(I)return Q;const q=rgb2i(P,F,D)-rgb2i(U,j,Z),rt=rgb2q(P,F,D)-rgb2q(U,j,Z),et=.5053*Q*Q+.299*q*q+.1957*rt*rt;return H>W?-et:et}function rgb2y(d,m,g){return .29889531*d+.58662247*m+.11448223*g}function rgb2i(d,m,g){return .59597799*d-.2741761*m-.32180189*g}function rgb2q(d,m,g){return .21147017*d-.52261711*m+.31114694*g}function blend(d,m){return 255+(d-255)*m}function drawPixel(d,m,g,w,I){d[m+0]=g,d[m+1]=w,d[m+2]=I,d[m+3]=255}function drawGrayPixel(d,m,g,w){const I=blend(rgb2y(d[m+0],d[m+1],d[m+2]),g*d[m+3]/255);drawPixel(w,m,I,I,I)}getDefaultExportFromCjs(pixelmatch_1);const defaultPlugins=[methods$h,methods$g,methods$f,methods$e,methods$c,methods$a,methods$b,methods$9,methods$8,methods$7,methods$6,methods$5,methods$4,methods$3,methods$d,methods$2,methods$1,methods],defaultFormats=[bmp,msBmp,gif,jpeg$2,png,tiff];bmp().mime,gif().mime,jpeg$2().mime,png().mime,tiff().mime;const Jimp=createJimp({formats:defaultFormats,plugins:defaultPlugins});class MapParser{static async parseMap(m,g=1){console.log(`[MapParser] Parsing: ${m}`);try{const w=await Jimp.read(m);if(!w)throw new Error(`Jimp failed to load image: ${m}`);const I=w.bitmap.width,P=w.bitmap.height;console.log(`[MapParser] Image loaded: ${I}x${P}`);const F=[];let D;const $={r:89,g:103,b:161},U={r:74,g:169,b:8},j={r:128,g:0,b:128},Z={r:71,g:13,b:191},G={r:13,g:191,b:184},H={r:28,g:0,b:255},W={r:0,g:0,b:0},Q={r:255,g:0,b:0},q={r:122,g:75,b:13},rt={r:214,g:159,b:96};for(let et=0;et<P;et++)for(let X=0;X<I;X++){const J=(I*et+X)*4,tt=w.bitmap.data[J],st=w.bitmap.data[J+1],nt=w.bitmap.data[J+2];if(w.bitmap.data[J+3]<128)continue;const at=Pt=>Math.abs(tt-Pt.r)<15&&Math.abs(st-Pt.g)<15&&Math.abs(nt-Pt.b)<15;if(at(rt)){D={x:X*g,y:et*g,width:1*g,height:1*g};continue}const ct=at($)||at(U),V=at(j)||at(Z),ut=at(G),wt=at(H),dt=at(W),ft=at(Q),pt=at(q);if(ct||V||ut||wt||dt||ft||pt){const Pt={x:X*g,y:et*g,width:1*g,height:1*g,isFloor:ct,isWall:V,isSpike:ut,isPortal:wt,isVoid:dt,isExit:ft,isFallthrough:pt,assetKey:V?"Platform Length":ft?"Exit Door":"Platform Floor"};F.push(Pt)}}return D||(console.warn("[MapParser] No player start found. Using default."),D={x:5,y:5,width:1,height:1}),{platforms:F,playerStart:D}}catch(w){throw console.error(`[MapParser] Failed to parse map ${m}:`,w),w}}}class MapGenerator{static generateDefaultMap(){return{platforms:[],playerStart:{x:0,y:0,width:1,height:1}}}static generateProcedural(m){return this.generateDefaultMap()}}class Game3Controller extends BaseController{currentLevel=Game3Level.Level1;hasCompleted=!1;constructor(m){super(m,FeatureEnum.GAME_3)}onWorkerEvent(m,g){switch(m){case"LEVEL_COMPLETE":this.hasCompleted||(this.hasCompleted=!0,this.handleLevelComplete());break;case"MAP_DATA_PRODUCED":console.log("[Game3Controller] Worker confirmed map data ingestion.");break}}onKeyDown(m){InputManager.getInstance().isKeyAction(m.key,"PAUSE")&&this.openPauseMenu()}async initialize(m,g=Game3Level.Level1){this.currentLevel=g,this.hasCompleted=!1,InputManager.getInstance().refreshBindings("Game3");try{this.send("INITIALIZE",m);let w;if(m.mapPath)try{w=await MapParser.parseMap(m.mapPath,m.mapScale??1)}catch(I){console.warn("[Game3Controller] Map parse failed, falling back to generator.",I),w=MapGenerator.generateDefaultMap()}else w=MapGenerator.generateDefaultMap();this.send("SET_MAP_DATA",w)}catch(w){console.error("[Game3Controller] Critical initialization failure:",w)}}modifyHP(m){this.send("MOD_HP",{amount:m})}async loadLevel(m){const g=await StateRegistry.create(FeatureEnum.GAME_3,{reset:!1,level:m});await StateManager.getInstance().replace(g)}async resetLevel(){await SaveManager.getInstance().performLoad(this.QUICK_SAVE_KEY);const m=await StateRegistry.create(FeatureEnum.GAME_3,{reset:!1,level:this.currentLevel});await StateManager.getInstance().replace(m)}handleLevelComplete(){CampaignManager.getInstance().completeCurrentStep()}async openPauseMenu(){const m=StateManager.getInstance();if(m.getCurrentStateName()===this.stateName){const g=await StateRegistry.create(FeatureEnum.PAUSE_MENU);await m.push(g)}}}class Game3State extends BaseGameState{name=FeatureEnum.GAME_3;logicSchema=Game3LogicSchema;viewSchema=Game3ViewSchema;viewComponent=Game3View;currentLevel;constructor(m={}){super(m.reset??!1),this.currentLevel=m.level??Game3Level.Level1}getConfig(){return getGame3Config(this.currentLevel)}getSessionOverrides(m){const g=m.get(GLOBAL_SESSION_MAP.hp);return g!==void 0?{initialHP:g}:{}}initMVC(){this.vm=new Game3Presenter,this.controller=new Game3Controller(this.vm)}async init(){InputManager.getInstance().refreshBindings(this.name),await super.init();const m=SharedSession.getInstance(),g=this.getConfig(),w=this.getSessionOverrides(m),I={...g,...w};this.controller&&I.mapPath&&await this.controller.initialize(I,this.currentLevel)}}export{Game3State};
//# sourceMappingURL=Game3State-CRsnG8el.js.map
