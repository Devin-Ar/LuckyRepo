{"version":3,"file":"Game2ViewLogic-CzviCqce.js","sources":["../src/features/Game2/model/Game2ViewSchema.ts","../src/features/Game2/view/Game2ViewLogic.ts"],"sourcesContent":["// src/features/Game2/model/Game2ViewSchema.ts\r\nimport {IBuffer} from \"../../../core/interfaces/IBuffer\";\r\n\r\nexport const Game2ViewSchema: IBuffer = {\r\n    HERO_HP_DISPLAY: 0,\r\n    ENERGY_DISPLAY: 1,\r\n    SCRAP_DISPLAY: 2,\r\n\r\n    UI_BOUNCE: 3,\r\n    GLITCH_INTENSITY: 4,\r\n    VIGNETTE_PULSE: 5,\r\n    BUFFER_SIZE: 1024\r\n};","// src/features/Game2/view/Game2ViewLogic.ts\r\nimport {Game2LogicSchema} from '../model/Game2LogicSchema';\r\nimport {Game2ViewSchema} from '../model/Game2ViewSchema';\r\nimport {BaseViewLogic} from '../../../core/templates/BaseViewLogic';\r\n\r\nexport class Game2ViewLogic extends BaseViewLogic {\r\n    private uiBounce: number = 0;\r\n    private glitchIntensity: number = 0;\r\n    private lastHp: number = -1;\r\n\r\n    public update(dt: number, frameCount: number) {\r\n        if (!this.hasBuffers()) return;\r\n\r\n        const currentHp = this.logicView[Game2LogicSchema.HERO_HP];\r\n        const currentEnergy = this.logicView[Game2LogicSchema.ENERGY];\r\n\r\n        if (this.lastHp !== -1 && currentHp < this.lastHp) {\r\n            this.glitchIntensity = 1.0;\r\n        }\r\n        this.lastHp = currentHp;\r\n\r\n        this.glitchIntensity *= 0.92;\r\n\r\n        this.outputView[Game2ViewSchema.HERO_HP_DISPLAY] = currentHp;\r\n        this.outputView[Game2ViewSchema.ENERGY_DISPLAY] = currentEnergy;\r\n        this.outputView[Game2ViewSchema.SCRAP_DISPLAY] = this.logicView[Game2LogicSchema.SCRAP_COUNT];\r\n\r\n        const timeFactor = dt / 16.67;\r\n        this.uiBounce += 0.05 * timeFactor;\r\n\r\n        const pulseSpeed = currentEnergy < 20 ? 0.15 : 0.05;\r\n        const vignettePulse = 0.5 + Math.sin(frameCount * pulseSpeed) * 0.2;\r\n\r\n        this.outputView[Game2ViewSchema.UI_BOUNCE] = Math.sin(this.uiBounce) * 5;\r\n        this.outputView[Game2ViewSchema.GLITCH_INTENSITY] = this.glitchIntensity;\r\n        this.outputView[Game2ViewSchema.VIGNETTE_PULSE] = vignettePulse;\r\n    }\r\n\r\n    public override getSnapshot() {\r\n        return {\r\n            uiBounce: this.uiBounce,\r\n            glitchIntensity: this.glitchIntensity,\r\n            lastHp: this.lastHp\r\n        };\r\n    }\r\n\r\n    public override loadSnapshot(data: any) {\r\n        if (data) {\r\n            this.uiBounce = data.uiBounce ?? 0;\r\n            this.glitchIntensity = data.glitchIntensity ?? 0;\r\n            this.lastHp = data.lastHp ?? -1;\r\n        }\r\n    }\r\n}"],"names":["Game2ViewSchema","Game2ViewLogic","BaseViewLogic","dt","frameCount","currentHp","Game2LogicSchema","currentEnergy","timeFactor","pulseSpeed","vignettePulse","data"],"mappings":"mGAGO,MAAMA,EAA2B,CACpC,gBAAiB,EACjB,eAAgB,EAChB,cAAe,EAEf,UAAW,EACX,iBAAkB,EAClB,eAAgB,CAEpB,ECPO,MAAMC,UAAuBC,CAAc,CACtC,SAAmB,EACnB,gBAA0B,EAC1B,OAAiB,GAElB,OAAOC,EAAYC,EAAoB,CAC1C,GAAI,CAAC,KAAK,aAAc,OAExB,MAAMC,EAAY,KAAK,UAAUC,EAAiB,OAAO,EACnDC,EAAgB,KAAK,UAAUD,EAAiB,MAAM,EAExD,KAAK,SAAW,IAAMD,EAAY,KAAK,SACvC,KAAK,gBAAkB,GAE3B,KAAK,OAASA,EAEd,KAAK,iBAAmB,IAExB,KAAK,WAAWL,EAAgB,eAAe,EAAIK,EACnD,KAAK,WAAWL,EAAgB,cAAc,EAAIO,EAClD,KAAK,WAAWP,EAAgB,aAAa,EAAI,KAAK,UAAUM,EAAiB,WAAW,EAE5F,MAAME,EAAaL,EAAK,MACxB,KAAK,UAAY,IAAOK,EAExB,MAAMC,EAAaF,EAAgB,GAAK,IAAO,IACzCG,EAAgB,GAAM,KAAK,IAAIN,EAAaK,CAAU,EAAI,GAEhE,KAAK,WAAWT,EAAgB,SAAS,EAAI,KAAK,IAAI,KAAK,QAAQ,EAAI,EACvE,KAAK,WAAWA,EAAgB,gBAAgB,EAAI,KAAK,gBACzD,KAAK,WAAWA,EAAgB,cAAc,EAAIU,CACtD,CAEgB,aAAc,CAC1B,MAAO,CACH,SAAU,KAAK,SACf,gBAAiB,KAAK,gBACtB,OAAQ,KAAK,MAAA,CAErB,CAEgB,aAAaC,EAAW,CAChCA,IACA,KAAK,SAAWA,EAAK,UAAY,EACjC,KAAK,gBAAkBA,EAAK,iBAAmB,EAC/C,KAAK,OAASA,EAAK,QAAU,GAErC,CACJ"}