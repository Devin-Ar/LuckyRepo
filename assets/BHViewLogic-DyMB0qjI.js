import{B as l,a as L,b as C,c as g}from"./BHLogicSchema-BSxOF7JP.js";import{B as D}from"./BaseViewLogic-fTOOk9Vw.js";const m={HERO_X:0,HERO_Y:1,HERO_ROTATION:2,HERO_SCALE:3,HERO_HP_DISPLAY:4,HERO_FRAME:5,HERO_WIDTH:6,HERO_HEIGHT:7,CURRENT_WAVE:10,TOTAL_WAVES:11,WAVE_STATE:12,WAVE_DELAY_TIMER:13,EXIT_DOOR_ACTIVE:14,EXIT_DOOR_X:15,EXIT_DOOR_Y:16,CURRENT_LEVEL:17,BOSS_HP:18,BOSS_VULNERABLE:19,BOSS_X:20,BOSS_Y:21,BOSS_ACTIVE:22,ROCK_COUNT:30,PPROJ_COUNT:31,EPROJ_COUNT:32,MOUSE_RELATIVE:33},U={STRIDE:8},N={STRIDE:5},X={STRIDE:5};class W extends D{heroRotation=0;globalRockRotation=0;heroFrame=0;update(T,u){const t=this.logicViews.get("main"),e=this.logicViews.get("rocks"),S=this.logicViews.get("pProjs"),c=this.logicViews.get("eProjs"),o=this.outputViews.get("main"),i=this.outputViews.get("rocks"),a=this.outputViews.get("pProjs"),n=this.outputViews.get("eProjs");if(!t||!e||!S||!c||!o||!i||!a||!n)return;const R=l,E=m,I=t[R.HERO_X],B=t[R.HERO_Y],r=t[R.HERO_HP];this.heroRotation+=.03*(T/16.67),this.heroFrame+=.15*(T/16.67),o[E.HERO_X]=I,o[E.HERO_Y]=B,o[E.HERO_WIDTH]=t[R.HERO_WIDTH],o[E.HERO_HEIGHT]=t[R.HERO_HEIGHT],o[E.HERO_ROTATION]=this.heroRotation,o[E.HERO_SCALE]=.5+r/100,o[E.MOUSE_RELATIVE]=t[R.MOUSE_RELATIVE],o[E.HERO_HP_DISPLAY]=r,o[E.HERO_FRAME]=this.heroFrame;const H=t[R.ROCK_COUNT];o[E.ROCK_COUNT]=H,this.globalRockRotation+=.02*(T/16.67);for(let O=0;O<H;O++){const s=O*L.STRIDE,_=O*U.STRIDE;i[_]=e[s],i[_+1]=e[s+1];const A=e[s+2],P=(Math.floor(A)%5+1)*.5;i[_+2]=this.globalRockRotation*P+A,i[_+3]=e[s+3],i[_+4]=e[s+4],i[_+5]=e[s+5],i[_+6]=e[s+6],i[_+7]=e[s+7]}const h=t[R.PPROJ_COUNT];o[E.PPROJ_COUNT]=h;for(let O=0;O<h;O++){const s=O*C.STRIDE,_=O*N.STRIDE;a[_]=S[s],a[_+1]=S[s+1],a[_+2]=S[s+2],a[_+3]=S[s+3],a[_+4]=S[s+4]}const V=t[R.EPROJ_COUNT];o[E.EPROJ_COUNT]=V;for(let O=0;O<V;O++){const s=O*g.STRIDE,_=O*X.STRIDE;n[_]=c[s],n[_+1]=c[s+1],n[_+2]=c[s+2],n[_+3]=c[s+3],n[_+4]=c[s+4]}o[E.CURRENT_WAVE]=t[R.CURRENT_WAVE],o[E.TOTAL_WAVES]=t[R.TOTAL_WAVES],o[E.WAVE_STATE]=t[R.WAVE_STATE],o[E.WAVE_DELAY_TIMER]=t[R.WAVE_DELAY_TIMER],o[E.EXIT_DOOR_ACTIVE]=t[R.EXIT_DOOR_ACTIVE],o[E.EXIT_DOOR_X]=t[R.EXIT_DOOR_X],o[E.EXIT_DOOR_Y]=t[R.EXIT_DOOR_Y],o[E.CURRENT_LEVEL]=t[R.CURRENT_LEVEL],o[E.BOSS_HP]=t[R.BOSS_HP],o[E.BOSS_VULNERABLE]=t[R.BOSS_VULNERABLE],o[E.BOSS_X]=t[R.BOSS_X],o[E.BOSS_Y]=t[R.BOSS_Y],o[E.BOSS_ACTIVE]=t[R.BOSS_ACTIVE]}getSnapshot(){return{heroRotation:this.heroRotation,globalRockRotation:this.globalRockRotation,heroFrame:this.heroFrame}}loadSnapshot(T){T&&(this.heroRotation=T.heroRotation??0,this.globalRockRotation=T.globalRockRotation??0,this.heroFrame=T.heroFrame??0)}}export{W as BHViewLogic};
//# sourceMappingURL=BHViewLogic-DyMB0qjI.js.map
