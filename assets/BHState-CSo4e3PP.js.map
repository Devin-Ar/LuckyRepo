{"version":3,"file":"BHState-CSo4e3PP.js","sources":["../../src/features/BulletTest/view/BHController.ts","../../src/features/BulletTest/model/BHViewSchema.ts","../../src/features/BulletTest/view/BHPresenter.ts","../../src/features/BulletTest/view/ui-components/BHSimulation.tsx","../../src/features/BulletTest/view/ui-components/BH_HUD.tsx","../../src/features/BulletTest/view/BHView.tsx","../../src/features/BulletTest/model/BHLogicSchema.ts","../../src/features/BulletTest/model/BHState.ts"],"sourcesContent":["// src/features/BulletTest/view/BHController.ts\r\nimport {BaseController} from \"../../../core/templates/BaseController\";\r\nimport {BHPresenter} from \"./BHPresenter\";\r\nimport {StateManager} from \"../../../core/managers/StateManager\";\r\nimport {AudioManager} from \"../../../core/managers/AudioManager\";\r\nimport {CampaignManager} from \"../../../core/managers/CampaignManager\";\r\nimport {BHLevel} from \"../model/BHConfig\";\r\nimport {SaveManager} from \"../../../core/managers/SaveManager\";\r\nimport {InputManager} from \"../../../core/managers/InputManager\";\r\nimport {StateRegistry} from \"../../../core/registry/StateRegistry\";\r\nimport {FeatureEnum} from \"../../FeatureEnum\";\r\n\r\nexport class BHController extends BaseController<BHPresenter> {\r\n    private isDead: boolean = false;\r\n    private hasExited: boolean = false;\r\n\r\n    constructor(vm: BHPresenter) {\r\n        super(vm, FeatureEnum.BH_GAME);\r\n    }\r\n\r\n    public takeDamage() {\r\n        this.send('TAKE_DAMAGE', {amount: 15});\r\n    }\r\n\r\n    public async jumpToGame2() {\r\n        const target = await StateRegistry.create(FeatureEnum.GAME_2, { reset: false });\r\n        await StateManager.getInstance().replace(target);\r\n    }\r\n\r\n    public async loadLevel(level: BHLevel) {\r\n        const target = await StateRegistry.create(FeatureEnum.BH_GAME, { reset: false, level });\r\n        await StateManager.getInstance().replace(target);\r\n    }\r\n\r\n    public async resetLevel() {\r\n        await SaveManager.getInstance().performLoad(this.QUICK_SAVE_KEY);\r\n        const currentLevel = (this.vm as any).currentLevel || BHLevel.Level1;\r\n        const target = await StateRegistry.create(FeatureEnum.BH_GAME, { reset: false, level: currentLevel });\r\n        await StateManager.getInstance().replace(target);\r\n    }\r\n\r\n    protected onKeyDown(e: KeyboardEvent): void {\r\n        const input = InputManager.getInstance();\r\n        if (input.isKeyAction(e.key, 'PAUSE')) {\r\n            this.openPauseMenu();\r\n        }\r\n    }\r\n\r\n    protected onWorkerEvent(name: string): void {\r\n        if (name === 'EXPLOSION_REQ') {\r\n            AudioManager.getInstance().play('sfx_explosion');\r\n        }\r\n        if (name === 'PLAYER_DEAD' && !this.isDead) {\r\n            this.isDead = true;\r\n            this.handlePlayerDeath();\r\n        }\r\n        if (name === 'EXIT_DOOR_ENTERED' && !this.hasExited) {\r\n            this.hasExited = true;\r\n            this.handleExitDoor();\r\n        }\r\n    }\r\n\r\n    private handlePlayerDeath(): void {\r\n        CampaignManager.getInstance().failCurrentStep();\r\n    }\r\n\r\n    private handleExitDoor(): void {\r\n        CampaignManager.getInstance().completeCurrentStep();\r\n    }\r\n\r\n    private async openPauseMenu() {\r\n        const manager = StateManager.getInstance();\r\n        if (manager.getCurrentStateName() === this.stateName) {\r\n            const target = await StateRegistry.create(FeatureEnum.PAUSE_MENU);\r\n            await manager.push(target);\r\n        }\r\n    }\r\n}","// src/features/BulletTest/model/BHViewSchema.ts\r\nimport { IBuffer } from \"../../../core/interfaces/IBuffer\";\r\n\r\nexport const BHViewSchema: IBuffer = {\r\n    HERO_X: 0,\r\n    HERO_Y: 1,\r\n    HERO_ROTATION: 2,\r\n    HERO_SCALE: 3,\r\n    HERO_HP_DISPLAY: 4,\r\n    HERO_FRAME: 5,\r\n\r\n    ACTIVE_ROCK_COUNT: 8,\r\n\r\n    // Wave display\r\n    CURRENT_WAVE: 9,\r\n    TOTAL_WAVES: 12,\r\n    WAVE_STATE: 13,\r\n    WAVE_DELAY_TIMER: 14,\r\n\r\n    // Exit door\r\n    EXIT_DOOR_ACTIVE: 15,\r\n    EXIT_DOOR_X: 16,\r\n    EXIT_DOOR_Y: 17,\r\n    CURRENT_LEVEL: 18,\r\n    BOSS_HP: 19,\r\n    BOSS_VULNERABLE: 20,\r\n\r\n    ROCKS_START_INDEX: 21,\r\n    BOSS_X: 21,\r\n    BOSS_Y: 22,\r\n    BOSS_ACTIVE: 23,\r\n\r\n    ROCKS_START_INDEX_ACTUAL: 24,\r\n    ROCK_STRIDE: 6,\r\n    PPROJ_START_INDEX: 200,\r\n    PPROJ_STRIDE: 2,\r\n    EPROJ_START_INDEX: 300,\r\n    EPROJ_STRIDE: 2,\r\n\r\n    BUFFER_SIZE: 4096\r\n};","// src/features/BulletTest/view/BHPresenter.ts\r\nimport { BasePresenter } from \"../../../core/templates/BasePresenter\";\r\nimport { BHViewSchema } from \"../model/BHViewSchema\";\r\n\r\nconst WAVE_STATE_LABELS = ['IDLE', 'DELAY', 'ACTIVE', 'CLEARED', 'ALL_CLEARED'] as const;\r\n\r\nexport class BHPresenter extends BasePresenter {\r\n\r\n    public get pos() {\r\n        return {\r\n            x: this.sharedView[BHViewSchema.HERO_X] || 0,\r\n            y: this.sharedView[BHViewSchema.HERO_Y] || 0\r\n        };\r\n    }\r\n\r\n    public get hp(): number {\r\n        return this.sharedView[BHViewSchema.HERO_HP_DISPLAY] || 0;\r\n    }\r\n\r\n    public get entityCount(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.ACTIVE_ROCK_COUNT] || 0);\r\n    }\r\n\r\n    public get projCount(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.PPROJ_START_INDEX - 1] || 0);\r\n    }\r\n\r\n    public get projEnemyCount(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.EPROJ_START_INDEX - 1] || 0);\r\n    }\r\n\r\n    // Wave state\r\n\r\n    public get currentWave(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.CURRENT_WAVE] || 0);\r\n    }\r\n\r\n    public get totalWaves(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.TOTAL_WAVES] || 0);\r\n    }\r\n\r\n    public get waveState(): string {\r\n        const idx = Math.floor(this.sharedView[BHViewSchema.WAVE_STATE] || 0);\r\n        return WAVE_STATE_LABELS[idx] || 'IDLE';\r\n    }\r\n\r\n    public get waveDelayTimer(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.WAVE_DELAY_TIMER] || 0);\r\n    }\r\n\r\n    public get isRoomCleared(): boolean {\r\n        return this.waveState === 'ALL_CLEARED' && this.entityCount === 0;\r\n    }\r\n\r\n    // Exit Door\r\n\r\n    public get exitDoorActive(): boolean {\r\n        return (this.sharedView[BHViewSchema.EXIT_DOOR_ACTIVE] || 0) === 1;\r\n    }\r\n\r\n    public get exitDoorX(): number {\r\n        return this.sharedView[BHViewSchema.EXIT_DOOR_X] || 0;\r\n    }\r\n\r\n    public get exitDoorY(): number {\r\n        return this.sharedView[BHViewSchema.EXIT_DOOR_Y] || 0;\r\n    }\r\n\r\n    public get currentLevelIndex(): number {\r\n        return Math.floor(this.sharedView[BHViewSchema.CURRENT_LEVEL] || 0);\r\n    }\r\n\r\n    public get bossHp(): number {\r\n        return this.sharedView[BHViewSchema.BOSS_HP] || 0;\r\n    }\r\n\r\n    public get bossVulnerable(): boolean {\r\n        return (this.sharedView[BHViewSchema.BOSS_VULNERABLE] || 0) === 1;\r\n    }\r\n\r\n    public get bossPos() {\r\n        return {\r\n            x: this.sharedView[BHViewSchema.BOSS_X] || 0,\r\n            y: this.sharedView[BHViewSchema.BOSS_Y] || 0\r\n        };\r\n    }\r\n\r\n    public get bossActive(): boolean {\r\n        return (this.sharedView[BHViewSchema.BOSS_ACTIVE] || 0) === 1;\r\n    }\r\n\r\n    // Visuals\r\n\r\n    public get heroVisuals() {\r\n        return {\r\n            x: this.sharedView[BHViewSchema.HERO_X] || 0,\r\n            y: this.sharedView[BHViewSchema.HERO_Y] || 0,\r\n            rotation: this.sharedView[BHViewSchema.HERO_ROTATION] || 0,\r\n            scale: this.sharedView[BHViewSchema.HERO_SCALE] || 1,\r\n            currentFrame: this.sharedView[BHViewSchema.HERO_FRAME] || 0\r\n        };\r\n    }\r\n\r\n    public getRockViewData(index: number) {\r\n        const offset = BHViewSchema.ROCKS_START_INDEX_ACTUAL + (index * BHViewSchema.ROCK_STRIDE);\r\n        return {\r\n            x: this.sharedView[offset] || 0,\r\n            y: this.sharedView[offset + 1] || 0,\r\n            rotation: this.sharedView[offset + 2] || 0\r\n        };\r\n    }\r\n\r\n    public getRockAttackData(index: number) {\r\n        const offset = BHViewSchema.ROCKS_START_INDEX_ACTUAL + (index * BHViewSchema.ROCK_STRIDE);\r\n        return {\r\n            primedMode: this.sharedView[offset + 3] || 0,\r\n            endX: this.sharedView[offset + 4] || 0,\r\n            endY: this.sharedView[offset + 5] || 0\r\n        };\r\n    }\r\n\r\n    public getPlayerProjData(index: number) {\r\n        const offset = BHViewSchema.PPROJ_START_INDEX + (index * BHViewSchema.PPROJ_STRIDE);\r\n        return {\r\n            x: this.sharedView[offset] || 0,\r\n            y: this.sharedView[offset + 1] || 0,\r\n        };\r\n    }\r\n\r\n    public getEnemyProjData(index: number) {\r\n        const offset = BHViewSchema.EPROJ_START_INDEX + (index * BHViewSchema.EPROJ_STRIDE);\r\n        return {\r\n            x: this.sharedView[offset] || 0,\r\n            y: this.sharedView[offset + 1] || 0,\r\n        };\r\n    }\r\n}","// src/features/Game1/view/ui-components/Game1Simulation.tsx\r\nimport React, {useEffect, useRef, useState} from 'react';\r\nimport * as PIXI from 'pixi.js';\r\nimport {Container, Graphics, useApp, useTick} from '@pixi/react';\r\nimport {BHPresenter} from '../BHPresenter';\r\nimport {GameSprite} from '../../../../components/GameSprite';\r\nimport {SpriteManager} from \"../../../../core/managers/SpriteManager\";\r\n\r\nconst PixiForceResizer: React.FC<{ w: number, h: number }> = ({w, h}) => {\r\n    const app = useApp();\r\n    useEffect(() => {\r\n        if (app?.renderer) {\r\n            app.renderer.resize(w, h);\r\n            if (app.view instanceof HTMLCanvasElement) {\r\n                app.view.width = w;\r\n                app.view.height = h;\r\n            }\r\n        }\r\n    }, [app, w, h]);\r\n    return null;\r\n};\r\n\r\nconst OscillatingBackground: React.FC<{ paused: boolean, w: number, h: number }> = ({paused, w, h}) => {\r\n    const graphicsRef = useRef<PIXI.Graphics>(null);\r\n    const time = useRef(0);\r\n\r\n    useEffect(() => {\r\n        graphicsRef.current?.clear().beginFill(0xffffff).drawRect(0, 0, w, h).endFill();\r\n    }, [w, h]);\r\n\r\n    useTick((delta) => {\r\n        if (!graphicsRef.current || paused) return;\r\n        time.current += (Math.PI / 60) * delta;\r\n        const factor = (Math.sin(time.current) + 1) / 2;\r\n        const r = Math.round(26 + factor * (30 - 26));\r\n        const g = Math.round(26 + factor * (80 - 26));\r\n        const b = Math.round(46 + factor * (150 - 46));\r\n        graphicsRef.current.tint = (r << 16) + (g << 8) + b;\r\n    });\r\n\r\n    return <Graphics ref={graphicsRef}/>;\r\n};\r\n\r\nconst RockPool: React.FC<{ vm: BHPresenter, paused: boolean }> = ({vm, paused}) => {\r\n    const containerRef = useRef<PIXI.Container>(null);\r\n    const spritePool = useRef<PIXI.Sprite[]>([]);\r\n    const manager = SpriteManager.getInstance();\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            spritePool.current.forEach(s => {\r\n                if (s && !s.destroyed) {\r\n                    s.destroy();\r\n                }\r\n            });\r\n            spritePool.current = [];\r\n        };\r\n    }, []);\r\n\r\n    useTick(() => {\r\n        if (!containerRef.current) return;\r\n\r\n        const currentCount = vm.entityCount;\r\n        const pool = spritePool.current;\r\n\r\n        if (currentCount > pool.length) {\r\n            for (let i = pool.length; i < currentCount; i++) {\r\n                const texture = manager.getTexture('static_rock');\r\n\r\n                if (texture) {\r\n                    const sprite = new PIXI.Sprite(texture);\r\n                    sprite.anchor.set(0.5);\r\n                    sprite.scale.set(0.8);\r\n                    containerRef.current.addChild(sprite);\r\n                    pool.push(sprite);\r\n                }\r\n            }\r\n        } else if (currentCount < pool.length) {\r\n            for (let i = pool.length - 1; i >= currentCount; i--) {\r\n                const sprite = pool.pop();\r\n                if (sprite) {\r\n                    containerRef.current.removeChild(sprite);\r\n                    sprite.destroy();\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < currentCount; i++) {\r\n            const sprite = pool[i];\r\n            const data = vm.getRockViewData(i);\r\n\r\n            if (!data || paused) {\r\n                if (sprite) sprite.visible = false;\r\n                continue;\r\n            }\r\n\r\n            sprite.visible = true;\r\n            sprite.x = data.x;\r\n            sprite.y = data.y;\r\n            sprite.rotation = data.rotation;\r\n        }\r\n    });\r\n\r\n    return <Container ref={containerRef}/>;\r\n};\r\n\r\nconst RockAttackPool: React.FC<{ vm: BHPresenter, paused: boolean }> = ({vm, paused}) => {\r\n    const containerRef = useRef<PIXI.Container>(null);\r\n    const graphicsPool = useRef<PIXI.Graphics[]>([]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            graphicsPool.current.forEach(s => {\r\n                if (s && !s.destroyed) {\r\n                    s.destroy();\r\n                }\r\n            });\r\n            graphicsPool.current = [];\r\n        };\r\n    }, []);\r\n\r\n    useTick(() => {\r\n        if (!containerRef.current) return;\r\n\r\n        const currentCount = vm.entityCount;\r\n        const pool = graphicsPool.current;\r\n\r\n        if (currentCount > pool.length) {\r\n            for (let i = pool.length; i < currentCount; i++) {\r\n                const newGraphic = new PIXI.Graphics();\r\n                newGraphic.visible = false;\r\n                containerRef.current.addChild(newGraphic);\r\n                pool.push(newGraphic);\r\n            }\r\n        } else if (currentCount < pool.length) {\r\n            for (let i = pool.length - 1; i >= currentCount; i--) {\r\n                const oldGraphic = pool.pop();\r\n                if (oldGraphic) {\r\n                    containerRef.current.removeChild(oldGraphic);\r\n                    oldGraphic.destroy();\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < currentCount; i++) {\r\n            const graphic = pool[i];\r\n            const data = vm.getRockAttackData(i);\r\n            const data2 = vm.getRockViewData(i);\r\n\r\n            if (!data || paused) {\r\n                if (graphic) graphic.visible = false;\r\n                continue;\r\n            }\r\n\r\n            if (data.primedMode === 1) {\r\n                graphic.visible = true;\r\n                graphic.clear();\r\n                graphic.lineStyle(30, 0xff0000);\r\n                graphic.moveTo(data2.x, data2.y);\r\n                graphic.lineTo(data.endX, data.endY);\r\n            } else {\r\n                graphic.visible = false;\r\n            }\r\n        }\r\n    });\r\n\r\n    return <Container ref={containerRef}/>;\r\n};\r\n\r\nconst PlayerProjPool: React.FC<{ vm: BHPresenter, paused: boolean }> = ({vm, paused}) => {\r\n    const containerRef = useRef<PIXI.Container>(null);\r\n    const graphicsPool = useRef<PIXI.Graphics[]>([]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            graphicsPool.current.forEach(s => {\r\n                if (s && !s.destroyed) {\r\n                    s.destroy();\r\n                }\r\n            });\r\n            graphicsPool.current = [];\r\n        };\r\n    }, []);\r\n\r\n    useTick(() => {\r\n        if (!containerRef.current) return;\r\n        const currentCount = vm.projCount;\r\n\r\n        const pool = graphicsPool.current;\r\n\r\n        if (currentCount > pool.length) {\r\n            for (let i = pool.length; i < currentCount; i++) {\r\n                const newGraphic = new PIXI.Graphics();\r\n                newGraphic.visible = false;\r\n                containerRef.current.addChild(newGraphic);\r\n                pool.push(newGraphic);\r\n            }\r\n        } else if (currentCount < pool.length) {\r\n            for (let i = pool.length - 1; i >= currentCount; i--) {\r\n                const oldGraphic = pool.pop();\r\n                if (oldGraphic) {\r\n                    containerRef.current.removeChild(oldGraphic);\r\n                    oldGraphic.destroy();\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < currentCount; i++) {\r\n            const graphic = pool[i];\r\n            const data = vm.getPlayerProjData(i);\r\n            if (!data || paused) {\r\n                if (graphic) graphic.visible = false;\r\n                continue;\r\n            }\r\n\r\n            graphic.visible = true;\r\n            graphic.clear();\r\n            graphic.lineStyle(10, 0x00ff00);\r\n            graphic.drawRect(data.x, data.y, 20, 20);\r\n        }\r\n    });\r\n\r\n    return <Container ref={containerRef}/>;\r\n};\r\n\r\nconst EnemyProjPool: React.FC<{ vm: BHPresenter, paused: boolean }> = ({vm, paused}) => {\r\n    const containerRef = useRef<PIXI.Container>(null);\r\n    const graphicsPool = useRef<PIXI.Graphics[]>([]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            graphicsPool.current.forEach(s => {\r\n                if (s && !s.destroyed) {\r\n                    s.destroy();\r\n                }\r\n            });\r\n            graphicsPool.current = [];\r\n        };\r\n    }, []);\r\n\r\n    useTick(() => {\r\n        if (!containerRef.current) return;\r\n        const currentCount = vm.projEnemyCount;\r\n\r\n        const pool = graphicsPool.current;\r\n\r\n        if (currentCount > pool.length) {\r\n            for (let i = pool.length; i < currentCount; i++) {\r\n                const newGraphic = new PIXI.Graphics();\r\n                newGraphic.visible = false;\r\n                containerRef.current.addChild(newGraphic);\r\n                pool.push(newGraphic);\r\n            }\r\n        } else if (currentCount < pool.length) {\r\n            for (let i = pool.length - 1; i >= currentCount; i--) {\r\n                const oldGraphic = pool.pop();\r\n                if (oldGraphic) {\r\n                    containerRef.current.removeChild(oldGraphic);\r\n                    oldGraphic.destroy();\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < currentCount; i++) {\r\n            const graphic = pool[i];\r\n            const data = vm.getEnemyProjData(i);\r\n            if (!data || paused) {\r\n                if (graphic) graphic.visible = false;\r\n                continue;\r\n            }\r\n            graphic.visible = true;\r\n            graphic.clear();\r\n            graphic.lineStyle(10, 0xff0000);\r\n            graphic.drawRect(data.x, data.y, 20, 20);\r\n        }\r\n    });\r\n\r\n    return <Container ref={containerRef}/>;\r\n};\r\n\r\nconst BossRenderer: React.FC<{ vm: BHPresenter, paused: boolean }> = ({vm, paused}) => {\r\n    const graphicsRef = useRef<PIXI.Graphics>(null);\r\n\r\n    useTick(() => {\r\n        if (!graphicsRef.current) return;\r\n        \r\n        if (!vm.bossActive || paused) {\r\n            graphicsRef.current.visible = false;\r\n            return;\r\n        }\r\n\r\n        const pos = vm.bossPos;\r\n        const vulnerable = vm.bossVulnerable;\r\n        \r\n        graphicsRef.current.visible = true;\r\n        graphicsRef.current.clear();\r\n        \r\n        // Draw boss body\r\n        graphicsRef.current.beginFill(vulnerable ? 0xe74c3c : 0x444444);\r\n        graphicsRef.current.lineStyle(4, 0xffffff);\r\n        graphicsRef.current.drawRect(pos.x, pos.y, 200, 200);\r\n        graphicsRef.current.endFill();\r\n    });\r\n\r\n    return <Graphics ref={graphicsRef} />;\r\n};\r\n\r\nexport const BHSimulation: React.FC<{\r\n    vm: BHPresenter,\r\n    paused: boolean,\r\n    width: number,\r\n    height: number,\r\n    scale: number,\r\n    heroPos: React.MutableRefObject<{ x: number, y: number }>,\r\n    hp: number\r\n}> = ({vm, paused, width, height, scale, heroPos, hp}) => {\r\n    const heroRef = useRef<PIXI.Container>(null);\r\n    const [heroVisuals, setHeroVisuals] = useState(vm.heroVisuals);\r\n\r\n    useTick(() => {\r\n        const visuals = vm.heroVisuals;\r\n        if (!heroRef.current) return;\r\n\r\n        heroRef.current.x = visuals.x;\r\n        heroRef.current.y = visuals.y;\r\n        heroRef.current.rotation = visuals.rotation;\r\n        heroRef.current.scale.set(visuals.scale);\r\n\r\n        heroPos.current.x = visuals.x;\r\n        heroPos.current.y = visuals.y;\r\n\r\n        // Sync local state for frame rendering\r\n        setHeroVisuals(visuals);\r\n    });\r\n\r\n    return (\r\n        <>\r\n            <PixiForceResizer w={width} h={height}/>\r\n            <OscillatingBackground paused={paused} w={width} h={height}/>\r\n            <Container scale={scale}>\r\n                <PlayerProjPool vm={vm} paused={paused}/>\r\n                <EnemyProjPool vm={vm} paused={paused}/>\r\n                <RockAttackPool vm={vm} paused={paused}/>\r\n                <RockPool vm={vm} paused={paused}/>\r\n                <BossRenderer vm={vm} paused={paused}/>\r\n                <Container ref={heroRef}>\r\n                    <GameSprite\r\n                        sheetName=\"hero_sheet\"\r\n                        animationName=\"idle\"\r\n                        x={0} y={0}\r\n                        scale={1}\r\n                        anchor={0.5}\r\n                        currentFrame={heroVisuals.currentFrame}\r\n                    />\r\n                </Container>\r\n            </Container>\r\n        </>\r\n    );\r\n};","// src/features/BulletTest/view/ui-components/BH_HUD.tsx\r\nimport React from 'react';\r\n\r\ninterface HUDProps {\r\n    hp: number;\r\n    rockCount: number;\r\n    currentWave: number;\r\n    totalWaves: number;\r\n    waveState: string;\r\n    waveDelayTimer: number;\r\n    isRoomCleared: boolean;\r\n    exitDoorActive: boolean;\r\n    exitDoorX: number;\r\n    exitDoorY: number;\r\n    bossHp: number;\r\n    bossVulnerable: boolean;\r\n    gameWidth: number;\r\n    gameHeight: number;\r\n    shieldBarRef: React.RefObject<HTMLDivElement>;\r\n    shieldTextRef: React.RefObject<HTMLSpanElement>;\r\n    damageBtnRef: React.RefObject<HTMLButtonElement>;\r\n    onDamage: () => void;\r\n    onJumpToG2: () => void;\r\n    onLevel1: () => void;\r\n    onLevel2: () => void;\r\n    onLevel3: () => void;\r\n    onLevel4: () => void;\r\n    onResetG1: () => void;\r\n}\r\n\r\nexport const BH_HUD: React.FC<HUDProps> = ({\r\n                                               hp, rockCount, currentWave, totalWaves, waveState, waveDelayTimer, isRoomCleared,\r\n                                               exitDoorActive, exitDoorX, exitDoorY, bossHp, bossVulnerable, gameWidth, gameHeight,\r\n                                               shieldBarRef, shieldTextRef, damageBtnRef,\r\n                                               onDamage, onJumpToG2, onLevel1, onLevel2, onLevel3, onLevel4, onResetG1\r\n                                           }) => {\r\n    const btnStyle: React.CSSProperties = {\r\n        padding: '0.6cqw 1cqw',\r\n        cursor: 'pointer',\r\n        color: '#fff',\r\n        border: 'none',\r\n        borderRadius: '0.4cqw',\r\n        fontWeight: 'bold',\r\n        fontFamily: 'monospace',\r\n        fontSize: '0.8cqw',\r\n        pointerEvents: 'auto',\r\n        textAlign: 'center'\r\n    };\r\n\r\n    const getWaveStatusText = (): string => {\r\n        if (isRoomCleared) return 'ROOM CLEARED!';\r\n        if (waveState === 'DELAY') return `NEXT WAVE IN ${Math.ceil(waveDelayTimer / 60)}s`;\r\n        if (waveState === 'ACTIVE') return `ENEMIES: ${rockCount}`;\r\n        if (waveState === 'CLEARED') return 'WAVE CLEARED!';\r\n        return 'STANDBY';\r\n    };\r\n\r\n    const getWaveStatusColor = (): string => {\r\n        if (isRoomCleared) return '#f1c40f';\r\n        if (waveState === 'DELAY') return '#e67e22';\r\n        if (waveState === 'ACTIVE') return '#e74c3c';\r\n        if (waveState === 'CLEARED') return '#2ecc71';\r\n        return '#888';\r\n    };\r\n\r\n    return (\r\n        <div style={{ position: 'absolute', inset: 0, pointerEvents: 'none', containerType: 'size' }}>\r\n\r\n            {/* Shield Bar - Top Center */}\r\n            <div style={{\r\n                position: 'absolute', top: '5cqh', left: '50%',\r\n                transform: 'translateX(-50%)', width: '35cqw'\r\n            }}>\r\n                <div style={{\r\n                    display: 'flex', justifyContent: 'space-between',\r\n                    color: '#fff', marginBottom: '0.5cqh',\r\n                    fontWeight: 'bold', fontFamily: 'monospace', fontSize: '1.2cqw'\r\n                }}>\r\n                    <span>SHIELD ENERGY</span>\r\n                    <span ref={shieldTextRef}>{Math.round(hp)}%</span>\r\n                </div>\r\n                <div style={{\r\n                    width: '100%', height: '2cqh', backgroundColor: '#222',\r\n                    borderRadius: '1cqw', border: '0.2cqw solid #fff', overflow: 'hidden'\r\n                }}>\r\n                    <div ref={shieldBarRef} style={{\r\n                        width: `${Math.max(0, hp)}%`, height: '100%',\r\n                        backgroundColor: hp < 30 ? '#c0392b' : '#27ae60'\r\n                    }} />\r\n                </div>\r\n            </div>\r\n\r\n            {/* Boss Health Bar - Top Center (below Shield Bar) */}\r\n            {bossHp > 0 && (\r\n                <div style={{\r\n                    position: 'absolute', top: '15cqh', left: '50%',\r\n                    transform: 'translateX(-50%)', width: '50cqw'\r\n                }}>\r\n                    <div style={{\r\n                        display: 'flex', justifyContent: 'space-between',\r\n                        color: bossVulnerable ? '#e74c3c' : '#888', marginBottom: '0.5cqh',\r\n                        fontWeight: 'bold', fontFamily: 'monospace', fontSize: '1cqw'\r\n                    }}>\r\n                        <span>THE CORE {bossVulnerable ? '(VULNERABLE)' : '(PROTECTED)'}</span>\r\n                        <span>{Math.max(0, bossHp)} / 300</span>\r\n                    </div>\r\n                    <div style={{\r\n                        width: '100%', height: '1.5cqh', backgroundColor: '#111',\r\n                        borderRadius: '0.75cqw', border: `0.2cqw solid ${bossVulnerable ? '#e74c3c' : '#444'}`,\r\n                        overflow: 'hidden', boxShadow: bossVulnerable ? '0 0 10px rgba(231, 76, 60, 0.4)' : 'none'\r\n                    }}>\r\n                        <div style={{\r\n                            width: `${(Math.max(0, bossHp) / 300) * 100}%`, height: '100%',\r\n                            backgroundColor: bossVulnerable ? '#e74c3c' : '#444',\r\n                            transition: 'width 0.3s ease-out, background-color 0.3s ease'\r\n                        }} />\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Wave Info - Top Right */}\r\n            <div style={{\r\n                position: 'absolute', top: '3cqh', right: '3cqw',\r\n                color: '#fff', fontFamily: 'monospace', textAlign: 'right', fontSize: '1.2cqw'\r\n            }}>\r\n                <div style={{\r\n                    color: getWaveStatusColor(),\r\n                    fontSize: '1.4cqw', fontWeight: 'bold', marginBottom: '0.5cqh'\r\n                }}>\r\n                    WAVE {currentWave + 1} / {totalWaves}\r\n                </div>\r\n                <div style={{ color: getWaveStatusColor(), fontSize: '1cqw' }}>\r\n                    {getWaveStatusText()}\r\n                </div>\r\n                <div style={{ color: '#888', fontSize: '0.8cqw', marginTop: '0.3cqh' }}>\r\n                    ENEMIES_ACTIVE: {rockCount}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Room Cleared Banner - Center */}\r\n            {isRoomCleared && (\r\n                <div style={{\r\n                    position: 'absolute', top: '40%', left: '50%',\r\n                    transform: 'translate(-50%, -50%)',\r\n                    color: '#f1c40f', fontFamily: 'monospace',\r\n                    fontSize: '3cqw', fontWeight: 'bold',\r\n                    textShadow: '0 0 20px rgba(241, 196, 60, 0.6)',\r\n                    textAlign: 'center', letterSpacing: '0.3cqw'\r\n                }}>\r\n                    ALL WAVES CLEARED\r\n                    <div style={{ fontSize: '1.2cqw', color: '#fff', marginTop: '1cqh' }}>\r\n                        PROCEED TO EXIT\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Exit Door - rendered as a square in game space */}\r\n            {exitDoorActive && gameWidth > 0 && gameHeight > 0 && (\r\n                <div style={{\r\n                    position: 'absolute',\r\n                    left: `${(exitDoorX / gameWidth) * 100}%`,\r\n                    top: `${(exitDoorY / gameHeight) * 100}%`,\r\n                    transform: 'translate(-50%, -50%)',\r\n                    width: '6.25%',   /* ~60px at 960 width */\r\n                    height: '11.1%',  /* ~60px at 540 height */\r\n                    border: '3px solid #f1c40f',\r\n                    backgroundColor: 'rgba(241, 196, 60, 0.25)',\r\n                    boxShadow: '0 0 20px rgba(241, 196, 60, 0.5), inset 0 0 15px rgba(241, 196, 60, 0.3)',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    animation: 'exitDoorPulse 1.5s ease-in-out infinite'\r\n                }}>\r\n                    <span style={{\r\n                        color: '#f1c40f',\r\n                        fontFamily: 'monospace',\r\n                        fontWeight: 'bold',\r\n                        fontSize: '0.9cqw',\r\n                        textShadow: '0 0 8px rgba(241, 196, 60, 0.8)'\r\n                    }}>\r\n                        EXIT\r\n                    </span>\r\n                </div>\r\n            )}\r\n\r\n            {/* Exit door pulse animation */}\r\n            {exitDoorActive && (\r\n                <style>{`\r\n                    @keyframes exitDoorPulse {\r\n                        0%, 100% { box-shadow: 0 0 20px rgba(241, 196, 60, 0.5), inset 0 0 15px rgba(241, 196, 60, 0.3); }\r\n                        50% { box-shadow: 0 0 35px rgba(241, 196, 60, 0.8), inset 0 0 25px rgba(241, 196, 60, 0.5); }\r\n                    }\r\n                `}</style>\r\n            )}\r\n\r\n            {/* Delay Countdown Overlay - Center (during delay phase) */}\r\n            {waveState === 'DELAY' && waveDelayTimer > 0 && (\r\n                <div style={{\r\n                    position: 'absolute', top: '35%', left: '50%',\r\n                    transform: 'translate(-50%, -50%)',\r\n                    color: '#e67e22', fontFamily: 'monospace',\r\n                    fontSize: '2cqw', fontWeight: 'bold',\r\n                    textShadow: '0 0 15px rgba(230, 126, 34, 0.5)',\r\n                    textAlign: 'center', opacity: 0.9\r\n                }}>\r\n                    WAVE {currentWave + 1} INCOMING\r\n                    <div style={{ fontSize: '4cqw', color: '#fff', marginTop: '0.5cqh' }}>\r\n                        {Math.ceil(waveDelayTimer / 60)}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Dev Controls - Bottom Left */}\r\n            <div style={{\r\n                position: 'absolute', top: '3cqh', left: '3cqw',\r\n                display: 'flex', flexDirection: 'column', gap: '1cqh'\r\n            }}>\r\n                <button ref={damageBtnRef} onClick={onDamage}\r\n                        style={{ ...btnStyle, background: '#333', border: '0.1cqw solid #fff' }}>\r\n                    TAKE DAMAGE (-15)\r\n                </button>\r\n\r\n                <div style={{ display: 'flex', gap: '0.5cqw' }}>\r\n                    <button onClick={onLevel1} style={{ ...btnStyle, background: '#408240', flex: 1 }}>LVL 1</button>\r\n                    <button onClick={onLevel2} style={{ ...btnStyle, background: '#C29F19', flex: 1 }}>LVL 2</button>\r\n                    <button onClick={onLevel3} style={{ ...btnStyle, background: '#C21919', flex: 1 }}>LVL 3</button>\r\n                    <button onClick={onLevel4} style={{ ...btnStyle, background: '#8E44AD', flex: 1 }}>LVL 4</button>\r\n                </div>\r\n\r\n                <button onClick={onJumpToG2} style={{ ...btnStyle, background: '#2980b9' }}>\r\n                    Go to Game 2\r\n                </button>\r\n\r\n                <div style={{ display: 'flex', gap: '0.5cqw' }}>\r\n                    <button onClick={onResetG1} style={{ ...btnStyle, background: '#c0392b', flex: 1 }}>\r\n                        Quick Load\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};","// src/features/BulletTest/view/BHView.tsx\r\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Stage } from '@pixi/react';\r\nimport { BHPresenter } from './BHPresenter';\r\nimport { BHController } from './BHController';\r\nimport { StateManager } from '../../../core/managers/StateManager';\r\nimport { IGameViewProps } from '../../../core/interfaces/IViewProps';\r\nimport { BHLevel } from \"../model/BHConfig\";\r\n\r\nimport { BHSimulation } from './ui-components/BHSimulation';\r\nimport { BH_HUD } from './ui-components/BH_HUD';\r\n\r\nexport const BHView: React.FC<IGameViewProps<BHPresenter, BHController>> = ({\r\n                                                                                vm, controller, width = 960, height = 540\r\n                                                                            }) => {\r\n    const [hpState, setHpState] = useState(vm.hp);\r\n    const [rockCount, setRockCount] = useState(vm.entityCount);\r\n    const [isPaused, setIsPaused] = useState(false);\r\n\r\n    // Wave state\r\n    const [currentWave, setCurrentWave] = useState(vm.currentWave);\r\n    const [totalWaves, setTotalWaves] = useState(vm.totalWaves);\r\n    const [waveState, setWaveState] = useState(vm.waveState);\r\n    const [waveDelayTimer, setWaveDelayTimer] = useState(vm.waveDelayTimer);\r\n    const [isRoomCleared, setIsRoomCleared] = useState(vm.isRoomCleared);\r\n\r\n    // Exit door\r\n    const [exitDoorActive, setExitDoorActive] = useState(vm.exitDoorActive);\r\n    const [exitDoorX, setExitDoorX] = useState(vm.exitDoorX);\r\n    const [exitDoorY, setExitDoorY] = useState(vm.exitDoorY);\r\n\r\n    // Boss state\r\n    const [bossHp, setBossHp] = useState(vm.bossHp);\r\n    const [bossVulnerable, setBossVulnerable] = useState(vm.bossVulnerable);\r\n\r\n    const shieldBarRef = useRef<HTMLDivElement>(null);\r\n    const shieldTextRef = useRef<HTMLSpanElement>(null);\r\n    const damageBtnRef = useRef<HTMLButtonElement>(null);\r\n    const heroPosRef = useRef({ x: vm.pos.x, y: vm.pos.y });\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = vm.subscribe(() => {\r\n            const stateManager = StateManager.getInstance();\r\n            const activeState = stateManager.getActiveState();\r\n            const pausedStatus = activeState?.name !== \"BHGame\";\r\n            if (isPaused !== pausedStatus) setIsPaused(pausedStatus);\r\n\r\n            const currentHp = vm.hp;\r\n            heroPosRef.current.x = vm.pos.x;\r\n            heroPosRef.current.y = vm.pos.y;\r\n\r\n            if (shieldBarRef.current) shieldBarRef.current.style.width = `${Math.max(0, currentHp)}%`;\r\n            if (shieldTextRef.current) shieldTextRef.current.innerText = `${Math.round(currentHp)}%`;\r\n\r\n            if (Math.abs(hpState - currentHp) > 1) setHpState(currentHp);\r\n            if (rockCount !== vm.entityCount) setRockCount(vm.entityCount);\r\n\r\n            // Update wave state\r\n            setCurrentWave(vm.currentWave);\r\n            setTotalWaves(vm.totalWaves);\r\n            setWaveState(vm.waveState);\r\n            setWaveDelayTimer(vm.waveDelayTimer);\r\n            setIsRoomCleared(vm.isRoomCleared);\r\n\r\n            // Exit door\r\n            setExitDoorActive(vm.exitDoorActive);\r\n            setExitDoorX(vm.exitDoorX);\r\n            setExitDoorY(vm.exitDoorY);\r\n\r\n            // Boss state\r\n            setBossHp(vm.bossHp);\r\n            setBossVulnerable(vm.bossVulnerable);\r\n        });\r\n        return () => unsubscribe();\r\n    }, [vm, hpState, rockCount, isPaused]);\r\n\r\n    const scaleFactor = useMemo(() => width / 960, [width]);\r\n\r\n    return (\r\n        <div style={{\r\n            position: 'absolute', inset: 0, background: '#000',\r\n            overflow: 'hidden', display: 'flex',\r\n            alignItems: 'center', justifyContent: 'center'\r\n        }}>\r\n            <div style={{\r\n                position: 'relative', width: '100%', height: '100%',\r\n                display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n            }}>\r\n                <Stage\r\n                    key={`stage-${width}-${height}`}\r\n                    width={width} height={height}\r\n                    options={{ backgroundColor: 0x000, antialias: true, resolution: 1, autoDensity: false }}\r\n                    style={{\r\n                        display: 'block', width: '100%', height: '100%',\r\n                        objectFit: 'contain', imageRendering: 'pixelated'\r\n                    }}\r\n                >\r\n                    <BHSimulation\r\n                        vm={vm} paused={isPaused}\r\n                        width={width} height={height}\r\n                        scale={scaleFactor} heroPos={heroPosRef} hp={hpState}\r\n                    />\r\n                </Stage>\r\n            </div>\r\n\r\n            <BH_HUD\r\n                hp={hpState}\r\n                rockCount={rockCount}\r\n                currentWave={currentWave}\r\n                totalWaves={totalWaves}\r\n                waveState={waveState}\r\n                waveDelayTimer={waveDelayTimer}\r\n                isRoomCleared={isRoomCleared}\r\n                exitDoorActive={exitDoorActive}\r\n                exitDoorX={exitDoorX}\r\n                exitDoorY={exitDoorY}\r\n                bossHp={bossHp}\r\n                bossVulnerable={bossVulnerable}\r\n                gameWidth={width}\r\n                gameHeight={height}\r\n                shieldBarRef={shieldBarRef}\r\n                shieldTextRef={shieldTextRef}\r\n                damageBtnRef={damageBtnRef}\r\n                onDamage={() => controller.takeDamage()}\r\n                onJumpToG2={() => controller.jumpToGame2()}\r\n                onLevel1={() => controller.loadLevel(BHLevel.Level1)}\r\n                onLevel2={() => controller.loadLevel(BHLevel.Level2)}\r\n                onLevel3={() => controller.loadLevel(BHLevel.Level3)}\r\n                onLevel4={() => controller.loadLevel(BHLevel.Level4)}\r\n                onResetG1={() => controller.resetLevel()}\r\n            />\r\n        </div>\r\n    );\r\n};","// src/features/BulletTest/model/BHLogicSchema.ts\r\nimport { IBuffer } from \"../../../core/interfaces/IBuffer\";\r\n\r\nexport const BHLogicSchema: IBuffer = {\r\n    HERO_HP: 0,\r\n    HERO_X: 1,\r\n    HERO_Y: 2,\r\n\r\n    TICK_COUNT: 3,\r\n    FRAME_COUNT: 4,\r\n    FPS: 5,\r\n    REVISION: 6,\r\n    LAST_HIT_FRAME: 7,\r\n    ENTITY_COUNT: 8,\r\n\r\n    // Wave state (new)\r\n    CURRENT_WAVE: 9,\r\n    TOTAL_WAVES: 12,\r\n    WAVE_STATE: 13,        // 0=IDLE, 1=DELAY, 2=ACTIVE, 3=CLEARED, 4=ALL_CLEARED\r\n    WAVE_DELAY_TIMER: 14,\r\n\r\n    // Exit door\r\n    EXIT_DOOR_ACTIVE: 15,  // 1 = visible, 0 = hidden\r\n    EXIT_DOOR_X: 16,\r\n    EXIT_DOOR_Y: 17,\r\n    CURRENT_LEVEL: 18,     // 0=Level1, 1=Level2, 2=Level3, 3=Level4\r\n    BOSS_HP: 19,\r\n    BOSS_VULNERABLE: 20,\r\n\r\n    ROCKS_START_INDEX: 21,\r\n    BOSS_X: 21,\r\n    BOSS_Y: 22,\r\n    BOSS_ACTIVE: 23,\r\n\r\n    ROCKS_START_INDEX_ACTUAL: 24,\r\n    PPROJ_START_INDEX: 200,\r\n    PPROJ_STRIDE: 2,\r\n    EPROJ_START_INDEX: 300,\r\n    EPROJ_STRIDE: 2,\r\n    ROCK_STRIDE: 6,\r\n    MAX_ROCKS: 1000,\r\n\r\n    BUFFER_SIZE: 4096\r\n};","// src/features/Game1/model/Game1State.ts\r\nimport {BaseGameState} from '../../../core/templates/BaseGameState';\r\nimport {BHController} from '../view/BHController';\r\nimport {BHPresenter} from '../view/BHPresenter';\r\nimport {BHView} from '../view/BHView';\r\nimport {BHLogicSchema} from './BHLogicSchema';\r\nimport {BHViewSchema} from \"./BHViewSchema\";\r\nimport {BHConfig, BHLevel, getBHConfig} from './BHConfig';\r\nimport {SharedSession} from '../../../core/session/SharedSession';\r\nimport {GLOBAL_SESSION_MAP} from '../../../core/session/GlobalSessionMap';\r\nimport {InputManager} from \"../../../core/managers/InputManager\";\r\nimport {FeatureEnum} from \"../../FeatureEnum\";\r\n\r\nexport interface BHParams {\r\n    reset?: boolean;\r\n    level?: BHLevel;\r\n}\r\n\r\nexport class BHState extends BaseGameState<BHPresenter, BHController, BHConfig> {\r\n    public name = FeatureEnum.BH_GAME;\r\n\r\n    protected logicSchema = BHLogicSchema;\r\n    protected viewSchema = BHViewSchema;\r\n    protected viewComponent = BHView;\r\n\r\n    private currentLevel: BHLevel;\r\n\r\n    constructor(params: BHParams = {}) {\r\n        super(params.reset ?? false);\r\n        this.currentLevel = params.level ?? BHLevel.Level1;\r\n    }\r\n\r\n    protected getConfig(): BHConfig {\r\n        return getBHConfig(this.currentLevel);\r\n    }\r\n\r\n    protected getSessionOverrides(session: SharedSession): Partial<BHConfig> {\r\n        const hp = session.get<number>(GLOBAL_SESSION_MAP.hp);\r\n        return hp !== undefined ? {initialHP: hp} : {};\r\n    }\r\n\r\n    protected initMVC(): void {\r\n        this.vm = new BHPresenter();\r\n        this.controller = new BHController(this.vm);\r\n    }\r\n\r\n    public async init(): Promise<void> {\r\n        InputManager.getInstance().refreshBindings(this.name);\r\n\r\n        await super.init();\r\n    }\r\n}"],"names":["BHController","BaseController","vm","FeatureEnum","target","StateRegistry","StateManager","level","SaveManager","currentLevel","BHLevel","e","InputManager","name","AudioManager","CampaignManager","manager","BHViewSchema","WAVE_STATE_LABELS","BHPresenter","BasePresenter","idx","index","offset","PixiForceResizer","w","h","app","useApp","useEffect","OscillatingBackground","paused","graphicsRef","useRef","time","useTick","delta","factor","r","g","b","jsx","Graphics","RockPool","containerRef","spritePool","SpriteManager","s","currentCount","pool","i","texture","sprite","PIXI.Sprite","data","Container","RockAttackPool","graphicsPool","newGraphic","PIXI.Graphics","oldGraphic","graphic","data2","PlayerProjPool","EnemyProjPool","BossRenderer","pos","vulnerable","BHSimulation","width","height","scale","heroPos","hp","heroRef","heroVisuals","setHeroVisuals","useState","visuals","jsxs","Fragment","GameSprite","BH_HUD","rockCount","currentWave","totalWaves","waveState","waveDelayTimer","isRoomCleared","exitDoorActive","exitDoorX","exitDoorY","bossHp","bossVulnerable","gameWidth","gameHeight","shieldBarRef","shieldTextRef","damageBtnRef","onDamage","onJumpToG2","onLevel1","onLevel2","onLevel3","onLevel4","onResetG1","btnStyle","getWaveStatusText","getWaveStatusColor","BHView","controller","hpState","setHpState","setRockCount","isPaused","setIsPaused","setCurrentWave","setTotalWaves","setWaveState","setWaveDelayTimer","setIsRoomCleared","setExitDoorActive","setExitDoorX","setExitDoorY","setBossHp","setBossVulnerable","heroPosRef","unsubscribe","pausedStatus","currentHp","scaleFactor","useMemo","Stage","BHLogicSchema","BHState","BaseGameState","params","getBHConfig","session","GLOBAL_SESSION_MAP"],"mappings":"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"}