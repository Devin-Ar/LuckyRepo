import{X as o,f as s,a as c,S as p,F as d}from"./index-Cx4hW8x4.js";class i{static instance;constructor(){}static getInstance(){return i.instance||(i.instance=new i),i.instance}startCampaign(e){const a=o.get(e);if(!a){console.error(`[CampaignManager] Could not find campaign: ${e}`);return}console.log(`[CampaignManager] Starting Campaign: ${e}`);const t=s.getInstance();t.clearSavableKeys(),t.set("campaign_id",e),t.set("campaign_step_index",0),this.loadCurrentStep(a,0)}completeCurrentStep(){const e=s.getInstance(),a=e.get("campaign_id");let t=e.get("campaign_step_index");if(!a||t===void 0){this.quitCampaign();return}const n=o.get(a);n&&(t++,e.set("campaign_step_index",t),t>=n.steps.length?this.quitCampaign():this.loadCurrentStep(n,t))}retryCurrentStep(){const e=s.getInstance(),a=e.get("campaign_id"),t=e.get("campaign_step_index");if(!a||t===void 0)return;const n=o.get(a);n&&(console.log(`[CampaignManager] Retrying step ${t}`),e.clearSavableKeys(),e.set("campaign_id",a),e.set("campaign_step_index",t),this.loadCurrentStep(n,t))}failCurrentStep(e){const a=s.getInstance(),t=a.get("campaign_id"),n=a.get("campaign_step_index");if(!t){console.error("No active campaign to fail."),this.quitCampaign();return}const r=o.get(t),g=r?.steps[n??-1]?.failFactory||r?.failFactory;if(g){console.log("[CampaignManager] Campaign Failed. Loading Fail State.");const l=g(e);c.getInstance().replace(l)}else console.warn("No failFactory defined for this campaign. Quitting."),this.quitCampaign()}quitCampaign(){const e=s.getInstance();e.clearSavableKeys(),e.set("campaign_id",null),e.set("campaign_step_index",0),console.log("[CampaignManager] Quitting to Menu."),c.getInstance().replace(p.create(d.DEV_MENU))}loadCurrentStep(e,a){const t=e.steps[a];console.log(`[CampaignManager] Loading Step ${a}: ${t.name}`);const n=p.createFromPreset(t.stateId,t.presetLabel);c.getInstance().replace(n,t.loadingConfig)}}export{i as C};
//# sourceMappingURL=CampaignManager-BzEj4yem.js.map
