import{B as l,a as L,b as C,c as D}from"./BHLogicSchema-CYtmDdMY.js";import{B as g}from"./BaseViewLogic-fTOOk9Vw.js";const m={HERO_X:0,HERO_Y:1,HERO_ROTATION:2,HERO_SCALE:3,HERO_HP_DISPLAY:4,HERO_FRAME:5,HERO_WIDTH:6,HERO_HEIGHT:7,CURRENT_WAVE:10,TOTAL_WAVES:11,WAVE_STATE:12,WAVE_DELAY_TIMER:13,EXIT_DOOR_ACTIVE:14,EXIT_DOOR_X:15,EXIT_DOOR_Y:16,CURRENT_LEVEL:17,BOSS_HP:18,BOSS_VULNERABLE:19,BOSS_X:20,BOSS_Y:21,BOSS_ACTIVE:22,ROCK_COUNT:30,PPROJ_COUNT:31,EPROJ_COUNT:32,MOUSE_RELATIVE:33,MAP_WIDTH:34,MAP_HEIGHT:35},M={STRIDE:8},U={STRIDE:5},N={STRIDE:5};class k extends g{heroRotation=0;globalRockRotation=0;heroFrame=0;update(T,W){const t=this.logicViews.get("main"),e=this.logicViews.get("rocks"),S=this.logicViews.get("pProjs"),c=this.logicViews.get("eProjs"),o=this.outputViews.get("main"),i=this.outputViews.get("rocks"),a=this.outputViews.get("pProjs"),n=this.outputViews.get("eProjs");if(!t||!e||!S||!c||!o||!i||!a||!n)return;const R=l,E=m,P=t[R.HERO_X],V=t[R.HERO_Y],r=t[R.HERO_HP];this.heroRotation+=.03*(T/16.67),this.heroFrame+=.15*(T/16.67),o[E.HERO_X]=P,o[E.HERO_Y]=V,o[E.HERO_WIDTH]=t[R.HERO_WIDTH],o[E.HERO_HEIGHT]=t[R.HERO_HEIGHT],o[E.HERO_ROTATION]=this.heroRotation,o[E.HERO_SCALE]=.5+r/100,o[E.MOUSE_RELATIVE]=t[R.MOUSE_RELATIVE],o[E.MAP_WIDTH]=t[R.MAP_WIDTH],o[E.MAP_HEIGHT]=t[R.MAP_HEIGHT],o[E.HERO_HP_DISPLAY]=r,o[E.HERO_FRAME]=this.heroFrame;const H=t[R.ROCK_COUNT];o[E.ROCK_COUNT]=H,this.globalRockRotation+=.02*(T/16.67);for(let O=0;O<H;O++){const _=O*L.STRIDE,s=O*M.STRIDE;i[s]=e[_],i[s+1]=e[_+1];const h=e[_+2],B=(Math.floor(h)%5+1)*.5;i[s+2]=this.globalRockRotation*B+h,i[s+3]=e[_+3],i[s+4]=e[_+4],i[s+5]=e[_+5],i[s+6]=e[_+6],i[s+7]=e[_+7]}const A=t[R.PPROJ_COUNT];o[E.PPROJ_COUNT]=A;for(let O=0;O<A;O++){const _=O*C.STRIDE,s=O*U.STRIDE;a[s]=S[_],a[s+1]=S[_+1],a[s+2]=S[_+2],a[s+3]=S[_+3],a[s+4]=S[_+4]}const I=t[R.EPROJ_COUNT];o[E.EPROJ_COUNT]=I;for(let O=0;O<I;O++){const _=O*D.STRIDE,s=O*N.STRIDE;n[s]=c[_],n[s+1]=c[_+1],n[s+2]=c[_+2],n[s+3]=c[_+3],n[s+4]=c[_+4]}o[E.CURRENT_WAVE]=t[R.CURRENT_WAVE],o[E.TOTAL_WAVES]=t[R.TOTAL_WAVES],o[E.WAVE_STATE]=t[R.WAVE_STATE],o[E.WAVE_DELAY_TIMER]=t[R.WAVE_DELAY_TIMER],o[E.EXIT_DOOR_ACTIVE]=t[R.EXIT_DOOR_ACTIVE],o[E.EXIT_DOOR_X]=t[R.EXIT_DOOR_X],o[E.EXIT_DOOR_Y]=t[R.EXIT_DOOR_Y],o[E.CURRENT_LEVEL]=t[R.CURRENT_LEVEL],o[E.BOSS_HP]=t[R.BOSS_HP],o[E.BOSS_VULNERABLE]=t[R.BOSS_VULNERABLE],o[E.BOSS_X]=t[R.BOSS_X],o[E.BOSS_Y]=t[R.BOSS_Y],o[E.BOSS_ACTIVE]=t[R.BOSS_ACTIVE]}getSnapshot(){return{heroRotation:this.heroRotation,globalRockRotation:this.globalRockRotation,heroFrame:this.heroFrame}}loadSnapshot(T){T&&(this.heroRotation=T.heroRotation??0,this.globalRockRotation=T.globalRockRotation??0,this.heroFrame=T.heroFrame??0)}}export{k as BHViewLogic};
//# sourceMappingURL=BHViewLogic-C9L5ABqO.js.map
