{"version":3,"file":"Game2Logic-B1dLFliD.js","sources":["../src/features/Game2/logic/Game2Commands.ts","../src/features/Game2/logic/Game2Logic.ts"],"sourcesContent":["// src/features/Game2/logic/Game2Commands.ts\r\nimport {ICommand} from '../../../core/interfaces/ICommand';\r\nimport {Game2Config} from '../model/Game2Config';\r\n\r\nexport const Game2Commands: Record<string, ICommand> = {\r\n    INITIALIZE: {\r\n        execute(logic, payload: Game2Config) {\r\n            logic.applyConfig(payload);\r\n            logic.setInitialized(true);\r\n        }\r\n    },\r\n    MOD_HP: {\r\n        execute(logic, payload) {\r\n            logic.modifyHp(payload.amount);\r\n        }\r\n    },\r\n    MOD_ENERGY: {\r\n        execute(logic, payload) {\r\n            logic.modifyEnergy(payload.amount);\r\n        }\r\n    },\r\n    ADD_SCRAP: {\r\n        execute(logic) {\r\n            logic.addScrap(1);\r\n        }\r\n    }\r\n};","// src/features/Game2/logic/Game2Logic.ts\r\nimport {Game2LogicSchema} from '../model/Game2LogicSchema';\r\nimport {BaseLogic} from '../../../core/templates/BaseLogic';\r\nimport {BaseDispatcher} from '../../../core/templates/BaseDispatcher';\r\nimport {Game2Commands} from './Game2Commands';\r\nimport {Game2Config} from '../model/Game2Config';\r\n\r\nexport class Game2Logic extends BaseLogic<Game2Config> {\r\n    protected dispatcher: BaseDispatcher<Game2Logic>;\r\n    private hp = 100;\r\n    private energy = 50;\r\n    private scrap = 0;\r\n    private currentFrame = 0;\r\n\r\n    constructor() {\r\n        super(Game2LogicSchema.REVISION);\r\n        this.dispatcher = new BaseDispatcher(this, Game2Commands, \"Game2\");\r\n    }\r\n\r\n    public applyConfig(config: Game2Config): void {\r\n        this.config = config;\r\n        this.hp = config.initialHP;\r\n        this.energy = config.initialEnergy;\r\n        this.scrap = config.initialScrap;\r\n    }\r\n\r\n    public modifyHp(amount: number) {\r\n        this.hp = Math.max(0, this.hp + amount);\r\n    }\r\n\r\n    public modifyEnergy(amount: number) {\r\n        if (!this.config) return;\r\n        this.energy = Math.max(0, this.energy + amount);\r\n    }\r\n\r\n    public addScrap(amount: number = 1) {\r\n        this.scrap += amount;\r\n    }\r\n\r\n    public override destroy(): void {\r\n        super.destroy();\r\n        this.hp = 100;\r\n        this.energy = 50;\r\n        this.scrap = 0;\r\n    }\r\n\r\n    public override getSnapshot(): any {\r\n        return {\r\n            hp: this.hp, energy: this.energy, scrap: this.scrap,\r\n            currentFrame: this.currentFrame, config: this.config\r\n        };\r\n    }\r\n\r\n    public override loadSnapshot(data: any): void {\r\n        if (!data) return;\r\n        this.config = data.config;\r\n        this.hp = data.hp ?? 100;\r\n        this.energy = data.energy ?? 50;\r\n        this.scrap = data.scrap ?? 0;\r\n        this.isInitialized = true;\r\n    }\r\n\r\n    protected onUpdate(sharedView: Float32Array, intView: Int32Array, frameCount: number, fps: number): void {\r\n        if (!this.config) return;\r\n        this.currentFrame = frameCount;\r\n\r\n        if (frameCount % this.config.regenRate === 0 && this.energy < this.config.maxEnergy) {\r\n            this.modifyEnergy(1);\r\n        }\r\n\r\n        sharedView[Game2LogicSchema.HERO_HP] = this.hp;\r\n        sharedView[Game2LogicSchema.ENERGY] = this.energy;\r\n        sharedView[Game2LogicSchema.SCRAP_COUNT] = this.scrap;\r\n        sharedView[Game2LogicSchema.TICK_COUNT] = frameCount;\r\n    }\r\n}"],"names":["Game2Commands","logic","payload","Game2Logic","BaseLogic","Game2LogicSchema","BaseDispatcher","config","amount","data","sharedView","intView","frameCount","fps"],"mappings":"2GAIO,MAAMA,EAA0C,CACnD,WAAY,CACR,QAAQC,EAAOC,EAAsB,CACjCD,EAAM,YAAYC,CAAO,EACzBD,EAAM,eAAe,EAAI,CAC7B,CAAA,EAEJ,OAAQ,CACJ,QAAQA,EAAOC,EAAS,CACpBD,EAAM,SAASC,EAAQ,MAAM,CACjC,CAAA,EAEJ,WAAY,CACR,QAAQD,EAAOC,EAAS,CACpBD,EAAM,aAAaC,EAAQ,MAAM,CACrC,CAAA,EAEJ,UAAW,CACP,QAAQD,EAAO,CACXA,EAAM,SAAS,CAAC,CACpB,CAAA,CAER,ECnBO,MAAME,UAAmBC,CAAuB,CACzC,WACF,GAAK,IACL,OAAS,GACT,MAAQ,EACR,aAAe,EAEvB,aAAc,CACV,MAAMC,EAAiB,QAAQ,EAC/B,KAAK,WAAa,IAAIC,EAAe,KAAMN,EAAe,OAAO,CACrE,CAEO,YAAYO,EAA2B,CAC1C,KAAK,OAASA,EACd,KAAK,GAAKA,EAAO,UACjB,KAAK,OAASA,EAAO,cACrB,KAAK,MAAQA,EAAO,YACxB,CAEO,SAASC,EAAgB,CAC5B,KAAK,GAAK,KAAK,IAAI,EAAG,KAAK,GAAKA,CAAM,CAC1C,CAEO,aAAaA,EAAgB,CAC3B,KAAK,SACV,KAAK,OAAS,KAAK,IAAI,EAAG,KAAK,OAASA,CAAM,EAClD,CAEO,SAASA,EAAiB,EAAG,CAChC,KAAK,OAASA,CAClB,CAEgB,SAAgB,CAC5B,MAAM,QAAA,EACN,KAAK,GAAK,IACV,KAAK,OAAS,GACd,KAAK,MAAQ,CACjB,CAEgB,aAAmB,CAC/B,MAAO,CACH,GAAI,KAAK,GAAI,OAAQ,KAAK,OAAQ,MAAO,KAAK,MAC9C,aAAc,KAAK,aAAc,OAAQ,KAAK,MAAA,CAEtD,CAEgB,aAAaC,EAAiB,CACrCA,IACL,KAAK,OAASA,EAAK,OACnB,KAAK,GAAKA,EAAK,IAAM,IACrB,KAAK,OAASA,EAAK,QAAU,GAC7B,KAAK,MAAQA,EAAK,OAAS,EAC3B,KAAK,cAAgB,GACzB,CAEU,SAASC,EAA0BC,EAAqBC,EAAoBC,EAAmB,CAChG,KAAK,SACV,KAAK,aAAeD,EAEhBA,EAAa,KAAK,OAAO,YAAc,GAAK,KAAK,OAAS,KAAK,OAAO,WACtE,KAAK,aAAa,CAAC,EAGvBF,EAAWL,EAAiB,OAAO,EAAI,KAAK,GAC5CK,EAAWL,EAAiB,MAAM,EAAI,KAAK,OAC3CK,EAAWL,EAAiB,WAAW,EAAI,KAAK,MAChDK,EAAWL,EAAiB,UAAU,EAAIO,EAC9C,CACJ"}