(function(){const et=document.createElement("link").relList;if(et&&et.supports&&et.supports("modulepreload"))return;for(const it of document.querySelectorAll('link[rel="modulepreload"]'))nt(it);new MutationObserver(it=>{for(const at of it)if(at.type==="childList")for(const st of at.addedNodes)st.tagName==="LINK"&&st.rel==="modulepreload"&&nt(st)}).observe(document,{childList:!0,subtree:!0});function rt(it){const at={};return it.integrity&&(at.integrity=it.integrity),it.referrerPolicy&&(at.referrerPolicy=it.referrerPolicy),it.crossOrigin==="use-credentials"?at.credentials="include":it.crossOrigin==="anonymous"?at.credentials="omit":at.credentials="same-origin",at}function nt(it){if(it.ep)return;it.ep=!0;const at=rt(it);fetch(it.href,at)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}function getAugmentedNamespace$1(tt){if(Object.prototype.hasOwnProperty.call(tt,"__esModule"))return tt;var et=tt.default;if(typeof et=="function"){var rt=function nt(){var it=!1;try{it=this instanceof nt}catch{}return it?Reflect.construct(et,arguments,this.constructor):et.apply(this,arguments)};rt.prototype=et.prototype}else rt={};return Object.defineProperty(rt,"__esModule",{value:!0}),Object.keys(tt).forEach(function(nt){var it=Object.getOwnPropertyDescriptor(tt,nt);Object.defineProperty(rt,nt,it.get?it:{enumerable:!0,get:function(){return tt[nt]}})}),rt}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var tt=Symbol.for("react.element"),et=Symbol.for("react.portal"),rt=Symbol.for("react.fragment"),nt=Symbol.for("react.strict_mode"),it=Symbol.for("react.profiler"),at=Symbol.for("react.provider"),st=Symbol.for("react.context"),ot=Symbol.for("react.forward_ref"),lt=Symbol.for("react.suspense"),ht=Symbol.for("react.memo"),dt=Symbol.for("react.lazy"),ut=Symbol.iterator;function ft(zt){return zt===null||typeof zt!="object"?null:(zt=ut&&zt[ut]||zt["@@iterator"],typeof zt=="function"?zt:null)}var mt={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gt=Object.assign,vt={};function xt(zt,er,dr){this.props=zt,this.context=er,this.refs=vt,this.updater=dr||mt}xt.prototype.isReactComponent={},xt.prototype.setState=function(zt,er){if(typeof zt!="object"&&typeof zt!="function"&&zt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,zt,er,"setState")},xt.prototype.forceUpdate=function(zt){this.updater.enqueueForceUpdate(this,zt,"forceUpdate")};function wt(){}wt.prototype=xt.prototype;function At(zt,er,dr){this.props=zt,this.context=er,this.refs=vt,this.updater=dr||mt}var Tt=At.prototype=new wt;Tt.constructor=At,gt(Tt,xt.prototype),Tt.isPureReactComponent=!0;var Pt=Array.isArray,Rt=Object.prototype.hasOwnProperty,Ot={current:null},Et={key:!0,ref:!0,__self:!0,__source:!0};function Lt(zt,er,dr){var fr,lr={},mr=null,br=null;if(er!=null)for(fr in er.ref!==void 0&&(br=er.ref),er.key!==void 0&&(mr=""+er.key),er)Rt.call(er,fr)&&!Et.hasOwnProperty(fr)&&(lr[fr]=er[fr]);var Sr=arguments.length-2;if(Sr===1)lr.children=dr;else if(1<Sr){for(var Ir=Array(Sr),cr=0;cr<Sr;cr++)Ir[cr]=arguments[cr+2];lr.children=Ir}if(zt&&zt.defaultProps)for(fr in Sr=zt.defaultProps,Sr)lr[fr]===void 0&&(lr[fr]=Sr[fr]);return{$$typeof:tt,type:zt,key:mr,ref:br,props:lr,_owner:Ot.current}}function kt(zt,er){return{$$typeof:tt,type:zt.type,key:er,ref:zt.ref,props:zt.props,_owner:zt._owner}}function jt(zt){return typeof zt=="object"&&zt!==null&&zt.$$typeof===tt}function Mt(zt){var er={"=":"=0",":":"=2"};return"$"+zt.replace(/[=:]/g,function(dr){return er[dr]})}var $t=/\/+/g;function Qt(zt,er){return typeof zt=="object"&&zt!==null&&zt.key!=null?Mt(""+zt.key):er.toString(36)}function Ht(zt,er,dr,fr,lr){var mr=typeof zt;(mr==="undefined"||mr==="boolean")&&(zt=null);var br=!1;if(zt===null)br=!0;else switch(mr){case"string":case"number":br=!0;break;case"object":switch(zt.$$typeof){case tt:case et:br=!0}}if(br)return br=zt,lr=lr(br),zt=fr===""?"."+Qt(br,0):fr,Pt(lr)?(dr="",zt!=null&&(dr=zt.replace($t,"$&/")+"/"),Ht(lr,er,dr,"",function(cr){return cr})):lr!=null&&(jt(lr)&&(lr=kt(lr,dr+(!lr.key||br&&br.key===lr.key?"":(""+lr.key).replace($t,"$&/")+"/")+zt)),er.push(lr)),1;if(br=0,fr=fr===""?".":fr+":",Pt(zt))for(var Sr=0;Sr<zt.length;Sr++){mr=zt[Sr];var Ir=fr+Qt(mr,Sr);br+=Ht(mr,er,dr,Ir,lr)}else if(Ir=ft(zt),typeof Ir=="function")for(zt=Ir.call(zt),Sr=0;!(mr=zt.next()).done;)mr=mr.value,Ir=fr+Qt(mr,Sr++),br+=Ht(mr,er,dr,Ir,lr);else if(mr==="object")throw er=String(zt),Error("Objects are not valid as a React child (found: "+(er==="[object Object]"?"object with keys {"+Object.keys(zt).join(", ")+"}":er)+"). If you meant to render a collection of children, use an array instead.");return br}function qt(zt,er,dr){if(zt==null)return zt;var fr=[],lr=0;return Ht(zt,fr,"","",function(mr){return er.call(dr,mr,lr++)}),fr}function Bt(zt){if(zt._status===-1){var er=zt._result;er=er(),er.then(function(dr){(zt._status===0||zt._status===-1)&&(zt._status=1,zt._result=dr)},function(dr){(zt._status===0||zt._status===-1)&&(zt._status=2,zt._result=dr)}),zt._status===-1&&(zt._status=0,zt._result=er)}if(zt._status===1)return zt._result.default;throw zt._result}var Xt={current:null},Ft={transition:null},Wt={ReactCurrentDispatcher:Xt,ReactCurrentBatchConfig:Ft,ReactCurrentOwner:Ot};function Yt(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:qt,forEach:function(zt,er,dr){qt(zt,function(){er.apply(this,arguments)},dr)},count:function(zt){var er=0;return qt(zt,function(){er++}),er},toArray:function(zt){return qt(zt,function(er){return er})||[]},only:function(zt){if(!jt(zt))throw Error("React.Children.only expected to receive a single React element child.");return zt}},react_production_min.Component=xt,react_production_min.Fragment=rt,react_production_min.Profiler=it,react_production_min.PureComponent=At,react_production_min.StrictMode=nt,react_production_min.Suspense=lt,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wt,react_production_min.act=Yt,react_production_min.cloneElement=function(zt,er,dr){if(zt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+zt+".");var fr=gt({},zt.props),lr=zt.key,mr=zt.ref,br=zt._owner;if(er!=null){if(er.ref!==void 0&&(mr=er.ref,br=Ot.current),er.key!==void 0&&(lr=""+er.key),zt.type&&zt.type.defaultProps)var Sr=zt.type.defaultProps;for(Ir in er)Rt.call(er,Ir)&&!Et.hasOwnProperty(Ir)&&(fr[Ir]=er[Ir]===void 0&&Sr!==void 0?Sr[Ir]:er[Ir])}var Ir=arguments.length-2;if(Ir===1)fr.children=dr;else if(1<Ir){Sr=Array(Ir);for(var cr=0;cr<Ir;cr++)Sr[cr]=arguments[cr+2];fr.children=Sr}return{$$typeof:tt,type:zt.type,key:lr,ref:mr,props:fr,_owner:br}},react_production_min.createContext=function(zt){return zt={$$typeof:st,_currentValue:zt,_currentValue2:zt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},zt.Provider={$$typeof:at,_context:zt},zt.Consumer=zt},react_production_min.createElement=Lt,react_production_min.createFactory=function(zt){var er=Lt.bind(null,zt);return er.type=zt,er},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(zt){return{$$typeof:ot,render:zt}},react_production_min.isValidElement=jt,react_production_min.lazy=function(zt){return{$$typeof:dt,_payload:{_status:-1,_result:zt},_init:Bt}},react_production_min.memo=function(zt,er){return{$$typeof:ht,type:zt,compare:er===void 0?null:er}},react_production_min.startTransition=function(zt){var er=Ft.transition;Ft.transition={};try{zt()}finally{Ft.transition=er}},react_production_min.unstable_act=Yt,react_production_min.useCallback=function(zt,er){return Xt.current.useCallback(zt,er)},react_production_min.useContext=function(zt){return Xt.current.useContext(zt)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(zt){return Xt.current.useDeferredValue(zt)},react_production_min.useEffect=function(zt,er){return Xt.current.useEffect(zt,er)},react_production_min.useId=function(){return Xt.current.useId()},react_production_min.useImperativeHandle=function(zt,er,dr){return Xt.current.useImperativeHandle(zt,er,dr)},react_production_min.useInsertionEffect=function(zt,er){return Xt.current.useInsertionEffect(zt,er)},react_production_min.useLayoutEffect=function(zt,er){return Xt.current.useLayoutEffect(zt,er)},react_production_min.useMemo=function(zt,er){return Xt.current.useMemo(zt,er)},react_production_min.useReducer=function(zt,er,dr){return Xt.current.useReducer(zt,er,dr)},react_production_min.useRef=function(zt){return Xt.current.useRef(zt)},react_production_min.useState=function(zt){return Xt.current.useState(zt)},react_production_min.useSyncExternalStore=function(zt,er,dr){return Xt.current.useSyncExternalStore(zt,er,dr)},react_production_min.useTransition=function(){return Xt.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var tt=requireReact(),et=Symbol.for("react.element"),rt=Symbol.for("react.fragment"),nt=Object.prototype.hasOwnProperty,it=tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,at={key:!0,ref:!0,__self:!0,__source:!0};function st(ot,lt,ht){var dt,ut={},ft=null,mt=null;ht!==void 0&&(ft=""+ht),lt.key!==void 0&&(ft=""+lt.key),lt.ref!==void 0&&(mt=lt.ref);for(dt in lt)nt.call(lt,dt)&&!at.hasOwnProperty(dt)&&(ut[dt]=lt[dt]);if(ot&&ot.defaultProps)for(dt in lt=ot.defaultProps,lt)ut[dt]===void 0&&(ut[dt]=lt[dt]);return{$$typeof:et,type:ot,key:ft,ref:mt,props:ut,_owner:it.current}}return reactJsxRuntime_production_min.Fragment=rt,reactJsxRuntime_production_min.jsx=st,reactJsxRuntime_production_min.jsxs=st,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs$1(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(tt){function et(Ft,Wt){var Yt=Ft.length;Ft.push(Wt);e:for(;0<Yt;){var zt=Yt-1>>>1,er=Ft[zt];if(0<it(er,Wt))Ft[zt]=Wt,Ft[Yt]=er,Yt=zt;else break e}}function rt(Ft){return Ft.length===0?null:Ft[0]}function nt(Ft){if(Ft.length===0)return null;var Wt=Ft[0],Yt=Ft.pop();if(Yt!==Wt){Ft[0]=Yt;e:for(var zt=0,er=Ft.length,dr=er>>>1;zt<dr;){var fr=2*(zt+1)-1,lr=Ft[fr],mr=fr+1,br=Ft[mr];if(0>it(lr,Yt))mr<er&&0>it(br,lr)?(Ft[zt]=br,Ft[mr]=Yt,zt=mr):(Ft[zt]=lr,Ft[fr]=Yt,zt=fr);else if(mr<er&&0>it(br,Yt))Ft[zt]=br,Ft[mr]=Yt,zt=mr;else break e}}return Wt}function it(Ft,Wt){var Yt=Ft.sortIndex-Wt.sortIndex;return Yt!==0?Yt:Ft.id-Wt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var at=performance;tt.unstable_now=function(){return at.now()}}else{var st=Date,ot=st.now();tt.unstable_now=function(){return st.now()-ot}}var lt=[],ht=[],dt=1,ut=null,ft=3,mt=!1,gt=!1,vt=!1,xt=typeof setTimeout=="function"?setTimeout:null,wt=typeof clearTimeout=="function"?clearTimeout:null,At=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Tt(Ft){for(var Wt=rt(ht);Wt!==null;){if(Wt.callback===null)nt(ht);else if(Wt.startTime<=Ft)nt(ht),Wt.sortIndex=Wt.expirationTime,et(lt,Wt);else break;Wt=rt(ht)}}function Pt(Ft){if(vt=!1,Tt(Ft),!gt)if(rt(lt)!==null)gt=!0,Bt(Rt);else{var Wt=rt(ht);Wt!==null&&Xt(Pt,Wt.startTime-Ft)}}function Rt(Ft,Wt){gt=!1,vt&&(vt=!1,wt(Lt),Lt=-1),mt=!0;var Yt=ft;try{for(Tt(Wt),ut=rt(lt);ut!==null&&(!(ut.expirationTime>Wt)||Ft&&!Mt());){var zt=ut.callback;if(typeof zt=="function"){ut.callback=null,ft=ut.priorityLevel;var er=zt(ut.expirationTime<=Wt);Wt=tt.unstable_now(),typeof er=="function"?ut.callback=er:ut===rt(lt)&&nt(lt),Tt(Wt)}else nt(lt);ut=rt(lt)}if(ut!==null)var dr=!0;else{var fr=rt(ht);fr!==null&&Xt(Pt,fr.startTime-Wt),dr=!1}return dr}finally{ut=null,ft=Yt,mt=!1}}var Ot=!1,Et=null,Lt=-1,kt=5,jt=-1;function Mt(){return!(tt.unstable_now()-jt<kt)}function $t(){if(Et!==null){var Ft=tt.unstable_now();jt=Ft;var Wt=!0;try{Wt=Et(!0,Ft)}finally{Wt?Qt():(Ot=!1,Et=null)}}else Ot=!1}var Qt;if(typeof At=="function")Qt=function(){At($t)};else if(typeof MessageChannel<"u"){var Ht=new MessageChannel,qt=Ht.port2;Ht.port1.onmessage=$t,Qt=function(){qt.postMessage(null)}}else Qt=function(){xt($t,0)};function Bt(Ft){Et=Ft,Ot||(Ot=!0,Qt())}function Xt(Ft,Wt){Lt=xt(function(){Ft(tt.unstable_now())},Wt)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Ft){Ft.callback=null},tt.unstable_continueExecution=function(){gt||mt||(gt=!0,Bt(Rt))},tt.unstable_forceFrameRate=function(Ft){0>Ft||125<Ft?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<Ft?Math.floor(1e3/Ft):5},tt.unstable_getCurrentPriorityLevel=function(){return ft},tt.unstable_getFirstCallbackNode=function(){return rt(lt)},tt.unstable_next=function(Ft){switch(ft){case 1:case 2:case 3:var Wt=3;break;default:Wt=ft}var Yt=ft;ft=Wt;try{return Ft()}finally{ft=Yt}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Ft,Wt){switch(Ft){case 1:case 2:case 3:case 4:case 5:break;default:Ft=3}var Yt=ft;ft=Ft;try{return Wt()}finally{ft=Yt}},tt.unstable_scheduleCallback=function(Ft,Wt,Yt){var zt=tt.unstable_now();switch(typeof Yt=="object"&&Yt!==null?(Yt=Yt.delay,Yt=typeof Yt=="number"&&0<Yt?zt+Yt:zt):Yt=zt,Ft){case 1:var er=-1;break;case 2:er=250;break;case 5:er=1073741823;break;case 4:er=1e4;break;default:er=5e3}return er=Yt+er,Ft={id:dt++,callback:Wt,priorityLevel:Ft,startTime:Yt,expirationTime:er,sortIndex:-1},Yt>zt?(Ft.sortIndex=Yt,et(ht,Ft),rt(lt)===null&&Ft===rt(ht)&&(vt?(wt(Lt),Lt=-1):vt=!0,Xt(Pt,Yt-zt))):(Ft.sortIndex=er,et(lt,Ft),gt||mt||(gt=!0,Bt(Rt))),Ft},tt.unstable_shouldYield=Mt,tt.unstable_wrapCallback=function(Ft){var Wt=ft;return function(){var Yt=ft;ft=Wt;try{return Ft.apply(this,arguments)}finally{ft=Yt}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var tt=requireReact(),et=requireScheduler();function rt(ct){for(var pt="https://reactjs.org/docs/error-decoder.html?invariant="+ct,bt=1;bt<arguments.length;bt++)pt+="&args[]="+encodeURIComponent(arguments[bt]);return"Minified React error #"+ct+"; visit "+pt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nt=new Set,it={};function at(ct,pt){st(ct,pt),st(ct+"Capture",pt)}function st(ct,pt){for(it[ct]=pt,ct=0;ct<pt.length;ct++)nt.add(pt[ct])}var ot=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lt=Object.prototype.hasOwnProperty,ht=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dt={},ut={};function ft(ct){return lt.call(ut,ct)?!0:lt.call(dt,ct)?!1:ht.test(ct)?ut[ct]=!0:(dt[ct]=!0,!1)}function mt(ct,pt,bt,It){if(bt!==null&&bt.type===0)return!1;switch(typeof pt){case"function":case"symbol":return!0;case"boolean":return It?!1:bt!==null?!bt.acceptsBooleans:(ct=ct.toLowerCase().slice(0,5),ct!=="data-"&&ct!=="aria-");default:return!1}}function gt(ct,pt,bt,It){if(pt===null||typeof pt>"u"||mt(ct,pt,bt,It))return!0;if(It)return!1;if(bt!==null)switch(bt.type){case 3:return!pt;case 4:return pt===!1;case 5:return isNaN(pt);case 6:return isNaN(pt)||1>pt}return!1}function vt(ct,pt,bt,It,Gt,ir,wr){this.acceptsBooleans=pt===2||pt===3||pt===4,this.attributeName=It,this.attributeNamespace=Gt,this.mustUseProperty=bt,this.propertyName=ct,this.type=pt,this.sanitizeURL=ir,this.removeEmptyString=wr}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(ct){xt[ct]=new vt(ct,0,!1,ct,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(ct){var pt=ct[0];xt[pt]=new vt(pt,1,!1,ct[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(ct){xt[ct]=new vt(ct,2,!1,ct.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(ct){xt[ct]=new vt(ct,2,!1,ct,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(ct){xt[ct]=new vt(ct,3,!1,ct.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(ct){xt[ct]=new vt(ct,3,!0,ct,null,!1,!1)}),["capture","download"].forEach(function(ct){xt[ct]=new vt(ct,4,!1,ct,null,!1,!1)}),["cols","rows","size","span"].forEach(function(ct){xt[ct]=new vt(ct,6,!1,ct,null,!1,!1)}),["rowSpan","start"].forEach(function(ct){xt[ct]=new vt(ct,5,!1,ct.toLowerCase(),null,!1,!1)});var wt=/[\-:]([a-z])/g;function At(ct){return ct[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(ct){var pt=ct.replace(wt,At);xt[pt]=new vt(pt,1,!1,ct,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(ct){var pt=ct.replace(wt,At);xt[pt]=new vt(pt,1,!1,ct,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(ct){var pt=ct.replace(wt,At);xt[pt]=new vt(pt,1,!1,ct,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(ct){xt[ct]=new vt(ct,1,!1,ct.toLowerCase(),null,!1,!1)}),xt.xlinkHref=new vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(ct){xt[ct]=new vt(ct,1,!1,ct.toLowerCase(),null,!0,!0)});function Tt(ct,pt,bt,It){var Gt=xt.hasOwnProperty(pt)?xt[pt]:null;(Gt!==null?Gt.type!==0:It||!(2<pt.length)||pt[0]!=="o"&&pt[0]!=="O"||pt[1]!=="n"&&pt[1]!=="N")&&(gt(pt,bt,Gt,It)&&(bt=null),It||Gt===null?ft(pt)&&(bt===null?ct.removeAttribute(pt):ct.setAttribute(pt,""+bt)):Gt.mustUseProperty?ct[Gt.propertyName]=bt===null?Gt.type===3?!1:"":bt:(pt=Gt.attributeName,It=Gt.attributeNamespace,bt===null?ct.removeAttribute(pt):(Gt=Gt.type,bt=Gt===3||Gt===4&&bt===!0?"":""+bt,It?ct.setAttributeNS(It,pt,bt):ct.setAttribute(pt,bt))))}var Pt=tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rt=Symbol.for("react.element"),Ot=Symbol.for("react.portal"),Et=Symbol.for("react.fragment"),Lt=Symbol.for("react.strict_mode"),kt=Symbol.for("react.profiler"),jt=Symbol.for("react.provider"),Mt=Symbol.for("react.context"),$t=Symbol.for("react.forward_ref"),Qt=Symbol.for("react.suspense"),Ht=Symbol.for("react.suspense_list"),qt=Symbol.for("react.memo"),Bt=Symbol.for("react.lazy"),Xt=Symbol.for("react.offscreen"),Ft=Symbol.iterator;function Wt(ct){return ct===null||typeof ct!="object"?null:(ct=Ft&&ct[Ft]||ct["@@iterator"],typeof ct=="function"?ct:null)}var Yt=Object.assign,zt;function er(ct){if(zt===void 0)try{throw Error()}catch(bt){var pt=bt.stack.trim().match(/\n( *(at )?)/);zt=pt&&pt[1]||""}return`
`+zt+ct}var dr=!1;function fr(ct,pt){if(!ct||dr)return"";dr=!0;var bt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(pt)if(pt=function(){throw Error()},Object.defineProperty(pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pt,[])}catch(Hn){var It=Hn}Reflect.construct(ct,[],pt)}else{try{pt.call()}catch(Hn){It=Hn}ct.call(pt.prototype)}else{try{throw Error()}catch(Hn){It=Hn}ct()}}catch(Hn){if(Hn&&It&&typeof Hn.stack=="string"){for(var Gt=Hn.stack.split(`
`),ir=It.stack.split(`
`),wr=Gt.length-1,Or=ir.length-1;1<=wr&&0<=Or&&Gt[wr]!==ir[Or];)Or--;for(;1<=wr&&0<=Or;wr--,Or--)if(Gt[wr]!==ir[Or]){if(wr!==1||Or!==1)do if(wr--,Or--,0>Or||Gt[wr]!==ir[Or]){var zr=`
`+Gt[wr].replace(" at new "," at ");return ct.displayName&&zr.includes("<anonymous>")&&(zr=zr.replace("<anonymous>",ct.displayName)),zr}while(1<=wr&&0<=Or);break}}}finally{dr=!1,Error.prepareStackTrace=bt}return(ct=ct?ct.displayName||ct.name:"")?er(ct):""}function lr(ct){switch(ct.tag){case 5:return er(ct.type);case 16:return er("Lazy");case 13:return er("Suspense");case 19:return er("SuspenseList");case 0:case 2:case 15:return ct=fr(ct.type,!1),ct;case 11:return ct=fr(ct.type.render,!1),ct;case 1:return ct=fr(ct.type,!0),ct;default:return""}}function mr(ct){if(ct==null)return null;if(typeof ct=="function")return ct.displayName||ct.name||null;if(typeof ct=="string")return ct;switch(ct){case Et:return"Fragment";case Ot:return"Portal";case kt:return"Profiler";case Lt:return"StrictMode";case Qt:return"Suspense";case Ht:return"SuspenseList"}if(typeof ct=="object")switch(ct.$$typeof){case Mt:return(ct.displayName||"Context")+".Consumer";case jt:return(ct._context.displayName||"Context")+".Provider";case $t:var pt=ct.render;return ct=ct.displayName,ct||(ct=pt.displayName||pt.name||"",ct=ct!==""?"ForwardRef("+ct+")":"ForwardRef"),ct;case qt:return pt=ct.displayName||null,pt!==null?pt:mr(ct.type)||"Memo";case Bt:pt=ct._payload,ct=ct._init;try{return mr(ct(pt))}catch{}}return null}function br(ct){var pt=ct.type;switch(ct.tag){case 24:return"Cache";case 9:return(pt.displayName||"Context")+".Consumer";case 10:return(pt._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return ct=pt.render,ct=ct.displayName||ct.name||"",pt.displayName||(ct!==""?"ForwardRef("+ct+")":"ForwardRef");case 7:return"Fragment";case 5:return pt;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mr(pt);case 8:return pt===Lt?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof pt=="function")return pt.displayName||pt.name||null;if(typeof pt=="string")return pt}return null}function Sr(ct){switch(typeof ct){case"boolean":case"number":case"string":case"undefined":return ct;case"object":return ct;default:return""}}function Ir(ct){var pt=ct.type;return(ct=ct.nodeName)&&ct.toLowerCase()==="input"&&(pt==="checkbox"||pt==="radio")}function cr(ct){var pt=Ir(ct)?"checked":"value",bt=Object.getOwnPropertyDescriptor(ct.constructor.prototype,pt),It=""+ct[pt];if(!ct.hasOwnProperty(pt)&&typeof bt<"u"&&typeof bt.get=="function"&&typeof bt.set=="function"){var Gt=bt.get,ir=bt.set;return Object.defineProperty(ct,pt,{configurable:!0,get:function(){return Gt.call(this)},set:function(wr){It=""+wr,ir.call(this,wr)}}),Object.defineProperty(ct,pt,{enumerable:bt.enumerable}),{getValue:function(){return It},setValue:function(wr){It=""+wr},stopTracking:function(){ct._valueTracker=null,delete ct[pt]}}}}function Nt(ct){ct._valueTracker||(ct._valueTracker=cr(ct))}function pr(ct){if(!ct)return!1;var pt=ct._valueTracker;if(!pt)return!0;var bt=pt.getValue(),It="";return ct&&(It=Ir(ct)?ct.checked?"true":"false":ct.value),ct=It,ct!==bt?(pt.setValue(ct),!0):!1}function rr(ct){if(ct=ct||(typeof document<"u"?document:void 0),typeof ct>"u")return null;try{return ct.activeElement||ct.body}catch{return ct.body}}function ar(ct,pt){var bt=pt.checked;return Yt({},pt,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:bt??ct._wrapperState.initialChecked})}function nr(ct,pt){var bt=pt.defaultValue==null?"":pt.defaultValue,It=pt.checked!=null?pt.checked:pt.defaultChecked;bt=Sr(pt.value!=null?pt.value:bt),ct._wrapperState={initialChecked:It,initialValue:bt,controlled:pt.type==="checkbox"||pt.type==="radio"?pt.checked!=null:pt.value!=null}}function ur(ct,pt){pt=pt.checked,pt!=null&&Tt(ct,"checked",pt,!1)}function Er(ct,pt){ur(ct,pt);var bt=Sr(pt.value),It=pt.type;if(bt!=null)It==="number"?(bt===0&&ct.value===""||ct.value!=bt)&&(ct.value=""+bt):ct.value!==""+bt&&(ct.value=""+bt);else if(It==="submit"||It==="reset"){ct.removeAttribute("value");return}pt.hasOwnProperty("value")?Kt(ct,pt.type,bt):pt.hasOwnProperty("defaultValue")&&Kt(ct,pt.type,Sr(pt.defaultValue)),pt.checked==null&&pt.defaultChecked!=null&&(ct.defaultChecked=!!pt.defaultChecked)}function Ut(ct,pt,bt){if(pt.hasOwnProperty("value")||pt.hasOwnProperty("defaultValue")){var It=pt.type;if(!(It!=="submit"&&It!=="reset"||pt.value!==void 0&&pt.value!==null))return;pt=""+ct._wrapperState.initialValue,bt||pt===ct.value||(ct.value=pt),ct.defaultValue=pt}bt=ct.name,bt!==""&&(ct.name=""),ct.defaultChecked=!!ct._wrapperState.initialChecked,bt!==""&&(ct.name=bt)}function Kt(ct,pt,bt){(pt!=="number"||rr(ct.ownerDocument)!==ct)&&(bt==null?ct.defaultValue=""+ct._wrapperState.initialValue:ct.defaultValue!==""+bt&&(ct.defaultValue=""+bt))}var or=Array.isArray;function hr(ct,pt,bt,It){if(ct=ct.options,pt){pt={};for(var Gt=0;Gt<bt.length;Gt++)pt["$"+bt[Gt]]=!0;for(bt=0;bt<ct.length;bt++)Gt=pt.hasOwnProperty("$"+ct[bt].value),ct[bt].selected!==Gt&&(ct[bt].selected=Gt),Gt&&It&&(ct[bt].defaultSelected=!0)}else{for(bt=""+Sr(bt),pt=null,Gt=0;Gt<ct.length;Gt++){if(ct[Gt].value===bt){ct[Gt].selected=!0,It&&(ct[Gt].defaultSelected=!0);return}pt!==null||ct[Gt].disabled||(pt=ct[Gt])}pt!==null&&(pt.selected=!0)}}function kr(ct,pt){if(pt.dangerouslySetInnerHTML!=null)throw Error(rt(91));return Yt({},pt,{value:void 0,defaultValue:void 0,children:""+ct._wrapperState.initialValue})}function Br(ct,pt){var bt=pt.value;if(bt==null){if(bt=pt.children,pt=pt.defaultValue,bt!=null){if(pt!=null)throw Error(rt(92));if(or(bt)){if(1<bt.length)throw Error(rt(93));bt=bt[0]}pt=bt}pt==null&&(pt=""),bt=pt}ct._wrapperState={initialValue:Sr(bt)}}function Gn(ct,pt){var bt=Sr(pt.value),It=Sr(pt.defaultValue);bt!=null&&(bt=""+bt,bt!==ct.value&&(ct.value=bt),pt.defaultValue==null&&ct.defaultValue!==bt&&(ct.defaultValue=bt)),It!=null&&(ct.defaultValue=""+It)}function Xn(ct){var pt=ct.textContent;pt===ct._wrapperState.initialValue&&pt!==""&&pt!==null&&(ct.value=pt)}function Mn(ct){switch(ct){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kn(ct,pt){return ct==null||ct==="http://www.w3.org/1999/xhtml"?Mn(pt):ct==="http://www.w3.org/2000/svg"&&pt==="foreignObject"?"http://www.w3.org/1999/xhtml":ct}var Vn,vi=(function(ct){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(pt,bt,It,Gt){MSApp.execUnsafeLocalFunction(function(){return ct(pt,bt,It,Gt)})}:ct})(function(ct,pt){if(ct.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in ct)ct.innerHTML=pt;else{for(Vn=Vn||document.createElement("div"),Vn.innerHTML="<svg>"+pt.valueOf().toString()+"</svg>",pt=Vn.firstChild;ct.firstChild;)ct.removeChild(ct.firstChild);for(;pt.firstChild;)ct.appendChild(pt.firstChild)}});function mi(ct,pt){if(pt){var bt=ct.firstChild;if(bt&&bt===ct.lastChild&&bt.nodeType===3){bt.nodeValue=pt;return}}ct.textContent=pt}var _i={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ri=["Webkit","ms","Moz","O"];Object.keys(_i).forEach(function(ct){Ri.forEach(function(pt){pt=pt+ct.charAt(0).toUpperCase()+ct.substring(1),_i[pt]=_i[ct]})});function pi(ct,pt,bt){return pt==null||typeof pt=="boolean"||pt===""?"":bt||typeof pt!="number"||pt===0||_i.hasOwnProperty(ct)&&_i[ct]?(""+pt).trim():pt+"px"}function Tr(ct,pt){ct=ct.style;for(var bt in pt)if(pt.hasOwnProperty(bt)){var It=bt.indexOf("--")===0,Gt=pi(bt,pt[bt],It);bt==="float"&&(bt="cssFloat"),It?ct.setProperty(bt,Gt):ct[bt]=Gt}}var qn=Yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _r(ct,pt){if(pt){if(qn[ct]&&(pt.children!=null||pt.dangerouslySetInnerHTML!=null))throw Error(rt(137,ct));if(pt.dangerouslySetInnerHTML!=null){if(pt.children!=null)throw Error(rt(60));if(typeof pt.dangerouslySetInnerHTML!="object"||!("__html"in pt.dangerouslySetInnerHTML))throw Error(rt(61))}if(pt.style!=null&&typeof pt.style!="object")throw Error(rt(62))}}function Rr(ct,pt){if(ct.indexOf("-")===-1)return typeof pt.is=="string";switch(ct){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yr=null;function Kr(ct){return ct=ct.target||ct.srcElement||window,ct.correspondingUseElement&&(ct=ct.correspondingUseElement),ct.nodeType===3?ct.parentNode:ct}var Jr=null,Zt=null,Qr=null;function Dr(ct){if(ct=ju(ct)){if(typeof Jr!="function")throw Error(rt(280));var pt=ct.stateNode;pt&&(pt=Gu(pt),Jr(ct.stateNode,ct.type,pt))}}function Pr(ct){Zt?Qr?Qr.push(ct):Qr=[ct]:Zt=ct}function Hr(){if(Zt){var ct=Zt,pt=Qr;if(Qr=Zt=null,Dr(ct),pt)for(ct=0;ct<pt.length;ct++)Dr(pt[ct])}}function qr(ct,pt){return ct(pt)}function bi(){}var ri=!1;function yi(ct,pt,bt){if(ri)return ct(pt,bt);ri=!0;try{return qr(ct,pt,bt)}finally{ri=!1,(Zt!==null||Qr!==null)&&(bi(),Hr())}}function Li(ct,pt){var bt=ct.stateNode;if(bt===null)return null;var It=Gu(bt);if(It===null)return null;bt=It[pt];e:switch(pt){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(It=!It.disabled)||(ct=ct.type,It=!(ct==="button"||ct==="input"||ct==="select"||ct==="textarea")),ct=!It;break e;default:ct=!1}if(ct)return null;if(bt&&typeof bt!="function")throw Error(rt(231,pt,typeof bt));return bt}var xa=!1;if(ot)try{var Ti={};Object.defineProperty(Ti,"passive",{get:function(){xa=!0}}),window.addEventListener("test",Ti,Ti),window.removeEventListener("test",Ti,Ti)}catch{xa=!1}function $i(ct,pt,bt,It,Gt,ir,wr,Or,zr){var Hn=Array.prototype.slice.call(arguments,3);try{pt.apply(bt,Hn)}catch(ai){this.onError(ai)}}var Ji=!1,ea=null,Na=!1,Oa=null,la={onError:function(ct){Ji=!0,ea=ct}};function ua(ct,pt,bt,It,Gt,ir,wr,Or,zr){Ji=!1,ea=null,$i.apply(la,arguments)}function ka(ct,pt,bt,It,Gt,ir,wr,Or,zr){if(ua.apply(this,arguments),Ji){if(Ji){var Hn=ea;Ji=!1,ea=null}else throw Error(rt(198));Na||(Na=!0,Oa=Hn)}}function Xi(ct){var pt=ct,bt=ct;if(ct.alternate)for(;pt.return;)pt=pt.return;else{ct=pt;do pt=ct,(pt.flags&4098)!==0&&(bt=pt.return),ct=pt.return;while(ct)}return pt.tag===3?bt:null}function ca(ct){if(ct.tag===13){var pt=ct.memoizedState;if(pt===null&&(ct=ct.alternate,ct!==null&&(pt=ct.memoizedState)),pt!==null)return pt.dehydrated}return null}function _a(ct){if(Xi(ct)!==ct)throw Error(rt(188))}function Ua(ct){var pt=ct.alternate;if(!pt){if(pt=Xi(ct),pt===null)throw Error(rt(188));return pt!==ct?null:ct}for(var bt=ct,It=pt;;){var Gt=bt.return;if(Gt===null)break;var ir=Gt.alternate;if(ir===null){if(It=Gt.return,It!==null){bt=It;continue}break}if(Gt.child===ir.child){for(ir=Gt.child;ir;){if(ir===bt)return _a(Gt),ct;if(ir===It)return _a(Gt),pt;ir=ir.sibling}throw Error(rt(188))}if(bt.return!==It.return)bt=Gt,It=ir;else{for(var wr=!1,Or=Gt.child;Or;){if(Or===bt){wr=!0,bt=Gt,It=ir;break}if(Or===It){wr=!0,It=Gt,bt=ir;break}Or=Or.sibling}if(!wr){for(Or=ir.child;Or;){if(Or===bt){wr=!0,bt=ir,It=Gt;break}if(Or===It){wr=!0,It=ir,bt=Gt;break}Or=Or.sibling}if(!wr)throw Error(rt(189))}}if(bt.alternate!==It)throw Error(rt(190))}if(bt.tag!==3)throw Error(rt(188));return bt.stateNode.current===bt?ct:pt}function Es(ct){return ct=Ua(ct),ct!==null?is(ct):null}function is(ct){if(ct.tag===5||ct.tag===6)return ct;for(ct=ct.child;ct!==null;){var pt=is(ct);if(pt!==null)return pt;ct=ct.sibling}return null}var zo=et.unstable_scheduleCallback,Xs=et.unstable_cancelCallback,wa=et.unstable_shouldYield,Qs=et.unstable_requestPaint,ta=et.unstable_now,Il=et.unstable_getCurrentPriorityLevel,Ks=et.unstable_ImmediatePriority,ol=et.unstable_UserBlockingPriority,Pl=et.unstable_NormalPriority,au=et.unstable_LowPriority,Ss=et.unstable_IdlePriority,Ps=null,qi=null;function pa(ct){if(qi&&typeof qi.onCommitFiberRoot=="function")try{qi.onCommitFiberRoot(Ps,ct,void 0,(ct.current.flags&128)===128)}catch{}}var Fi=Math.clz32?Math.clz32:Js,Za=Math.log,ls=Math.LN2;function Js(ct){return ct>>>=0,ct===0?32:31-(Za(ct)/ls|0)|0}var Ts=64,Ya=4194304;function jo(ct){switch(ct&-ct){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return ct&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return ct&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return ct}}function Cl(ct,pt){var bt=ct.pendingLanes;if(bt===0)return 0;var It=0,Gt=ct.suspendedLanes,ir=ct.pingedLanes,wr=bt&268435455;if(wr!==0){var Or=wr&~Gt;Or!==0?It=jo(Or):(ir&=wr,ir!==0&&(It=jo(ir)))}else wr=bt&~Gt,wr!==0?It=jo(wr):ir!==0&&(It=jo(ir));if(It===0)return 0;if(pt!==0&&pt!==It&&(pt&Gt)===0&&(Gt=It&-It,ir=pt&-pt,Gt>=ir||Gt===16&&(ir&4194240)!==0))return pt;if((It&4)!==0&&(It|=bt&16),pt=ct.entangledLanes,pt!==0)for(ct=ct.entanglements,pt&=It;0<pt;)bt=31-Fi(pt),Gt=1<<bt,It|=ct[bt],pt&=~Gt;return It}function ma(ct,pt){switch(ct){case 1:case 2:case 4:return pt+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return pt+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Go(ct,pt){for(var bt=ct.suspendedLanes,It=ct.pingedLanes,Gt=ct.expirationTimes,ir=ct.pendingLanes;0<ir;){var wr=31-Fi(ir),Or=1<<wr,zr=Gt[wr];zr===-1?((Or&bt)===0||(Or&It)!==0)&&(Gt[wr]=ma(Or,pt)):zr<=pt&&(ct.expiredLanes|=Or),ir&=~Or}}function Ho(ct){return ct=ct.pendingLanes&-1073741825,ct!==0?ct:ct&1073741824?1073741824:0}function Xa(){var ct=Ts;return Ts<<=1,(Ts&4194240)===0&&(Ts=64),ct}function su(ct){for(var pt=[],bt=0;31>bt;bt++)pt.push(ct);return pt}function ll(ct,pt,bt){ct.pendingLanes|=pt,pt!==536870912&&(ct.suspendedLanes=0,ct.pingedLanes=0),ct=ct.eventTimes,pt=31-Fi(pt),ct[pt]=bt}function Ml(ct,pt){var bt=ct.pendingLanes&~pt;ct.pendingLanes=pt,ct.suspendedLanes=0,ct.pingedLanes=0,ct.expiredLanes&=pt,ct.mutableReadLanes&=pt,ct.entangledLanes&=pt,pt=ct.entanglements;var It=ct.eventTimes;for(ct=ct.expirationTimes;0<bt;){var Gt=31-Fi(bt),ir=1<<Gt;pt[Gt]=0,It[Gt]=-1,ct[Gt]=-1,bt&=~ir}}function kl(ct,pt){var bt=ct.entangledLanes|=pt;for(ct=ct.entanglements;bt;){var It=31-Fi(bt),Gt=1<<It;Gt&pt|ct[It]&pt&&(ct[It]|=pt),bt&=~Gt}}var Zi=0;function Ol(ct){return ct&=-ct,1<ct?4<ct?(ct&268435455)!==0?16:536870912:4:1}var Fc,Yi,Pu,Cu,Bl,Qa=!1,Gi=[],Cs=null,Ka=null,eo=null,Dl=new Map,Pa=new Map,Qi=[],ul="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ll(ct,pt){switch(ct){case"focusin":case"focusout":Cs=null;break;case"dragenter":case"dragleave":Ka=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":Dl.delete(pt.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pa.delete(pt.pointerId)}}function Vo(ct,pt,bt,It,Gt,ir){return ct===null||ct.nativeEvent!==ir?(ct={blockedOn:pt,domEventName:bt,eventSystemFlags:It,nativeEvent:ir,targetContainers:[Gt]},pt!==null&&(pt=ju(pt),pt!==null&&Yi(pt)),ct):(ct.eventSystemFlags|=It,pt=ct.targetContainers,Gt!==null&&pt.indexOf(Gt)===-1&&pt.push(Gt),ct)}function Wo(ct,pt,bt,It,Gt){switch(pt){case"focusin":return Cs=Vo(Cs,ct,pt,bt,It,Gt),!0;case"dragenter":return Ka=Vo(Ka,ct,pt,bt,It,Gt),!0;case"mouseover":return eo=Vo(eo,ct,pt,bt,It,Gt),!0;case"pointerover":var ir=Gt.pointerId;return Dl.set(ir,Vo(Dl.get(ir)||null,ct,pt,bt,It,Gt)),!0;case"gotpointercapture":return ir=Gt.pointerId,Pa.set(ir,Vo(Pa.get(ir)||null,ct,pt,bt,It,Gt)),!0}return!1}function ou(ct){var pt=Yl(ct.target);if(pt!==null){var bt=Xi(pt);if(bt!==null){if(pt=bt.tag,pt===13){if(pt=ca(bt),pt!==null){ct.blockedOn=pt,Bl(ct.priority,function(){Pu(bt)});return}}else if(pt===3&&bt.stateNode.current.memoizedState.isDehydrated){ct.blockedOn=bt.tag===3?bt.stateNode.containerInfo:null;return}}}ct.blockedOn=null}function Ca(ct){if(ct.blockedOn!==null)return!1;for(var pt=ct.targetContainers;0<pt.length;){var bt=Ja(ct.domEventName,ct.eventSystemFlags,pt[0],ct.nativeEvent);if(bt===null){bt=ct.nativeEvent;var It=new bt.constructor(bt.type,bt);yr=It,bt.target.dispatchEvent(It),yr=null}else return pt=ju(bt),pt!==null&&Yi(pt),ct.blockedOn=bt,!1;pt.shift()}return!0}function ps(ct,pt,bt){Ca(ct)&&bt.delete(pt)}function ro(){Qa=!1,Cs!==null&&Ca(Cs)&&(Cs=null),Ka!==null&&Ca(Ka)&&(Ka=null),eo!==null&&Ca(eo)&&(eo=null),Dl.forEach(ps),Pa.forEach(ps)}function no(ct,pt){ct.blockedOn===pt&&(ct.blockedOn=null,Qa||(Qa=!0,et.unstable_scheduleCallback(et.unstable_NormalPriority,ro)))}function zs(ct){function pt(Gt){return no(Gt,ct)}if(0<Gi.length){no(Gi[0],ct);for(var bt=1;bt<Gi.length;bt++){var It=Gi[bt];It.blockedOn===ct&&(It.blockedOn=null)}}for(Cs!==null&&no(Cs,ct),Ka!==null&&no(Ka,ct),eo!==null&&no(eo,ct),Dl.forEach(pt),Pa.forEach(pt),bt=0;bt<Qi.length;bt++)It=Qi[bt],It.blockedOn===ct&&(It.blockedOn=null);for(;0<Qi.length&&(bt=Qi[0],bt.blockedOn===null);)ou(bt),bt.blockedOn===null&&Qi.shift()}var Po=Pt.ReactCurrentBatchConfig,ms=!0;function Fl(ct,pt,bt,It){var Gt=Zi,ir=Po.transition;Po.transition=null;try{Zi=1,Nl(ct,pt,bt,It)}finally{Zi=Gt,Po.transition=ir}}function io(ct,pt,bt,It){var Gt=Zi,ir=Po.transition;Po.transition=null;try{Zi=4,Nl(ct,pt,bt,It)}finally{Zi=Gt,Po.transition=ir}}function Nl(ct,pt,bt,It){if(ms){var Gt=Ja(ct,pt,bt,It);if(Gt===null)Gc(ct,pt,It,cl,bt),Ll(ct,It);else if(Wo(Gt,ct,pt,bt,It))It.stopPropagation();else if(Ll(ct,It),pt&4&&-1<ul.indexOf(ct)){for(;Gt!==null;){var ir=ju(Gt);if(ir!==null&&Fc(ir),ir=Ja(ct,pt,bt,It),ir===null&&Gc(ct,pt,It,cl,bt),ir===Gt)break;Gt=ir}Gt!==null&&It.stopPropagation()}else Gc(ct,pt,It,null,bt)}}var cl=null;function Ja(ct,pt,bt,It){if(cl=null,ct=Kr(It),ct=Yl(ct),ct!==null)if(pt=Xi(ct),pt===null)ct=null;else if(bt=pt.tag,bt===13){if(ct=ca(pt),ct!==null)return ct;ct=null}else if(bt===3){if(pt.stateNode.current.memoizedState.isDehydrated)return pt.tag===3?pt.stateNode.containerInfo:null;ct=null}else pt!==ct&&(ct=null);return cl=ct,null}function as(ct){switch(ct){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Il()){case Ks:return 1;case ol:return 4;case Pl:case au:return 16;case Ss:return 536870912;default:return 16}default:return 16}}var ss=null,Ms=null,ks=null;function qo(){if(ks)return ks;var ct,pt=Ms,bt=pt.length,It,Gt="value"in ss?ss.value:ss.textContent,ir=Gt.length;for(ct=0;ct<bt&&pt[ct]===Gt[ct];ct++);var wr=bt-ct;for(It=1;It<=wr&&pt[bt-It]===Gt[ir-It];It++);return ks=Gt.slice(ct,1<It?1-It:void 0)}function hl(ct){var pt=ct.keyCode;return"charCode"in ct?(ct=ct.charCode,ct===0&&pt===13&&(ct=13)):ct=pt,ct===10&&(ct=13),32<=ct||ct===13?ct:0}function Zo(){return!0}function lu(){return!1}function ha(ct){function pt(bt,It,Gt,ir,wr){this._reactName=bt,this._targetInst=Gt,this.type=It,this.nativeEvent=ir,this.target=wr,this.currentTarget=null;for(var Or in ct)ct.hasOwnProperty(Or)&&(bt=ct[Or],this[Or]=bt?bt(ir):ir[Or]);return this.isDefaultPrevented=(ir.defaultPrevented!=null?ir.defaultPrevented:ir.returnValue===!1)?Zo:lu,this.isPropagationStopped=lu,this}return Yt(pt.prototype,{preventDefault:function(){this.defaultPrevented=!0;var bt=this.nativeEvent;bt&&(bt.preventDefault?bt.preventDefault():typeof bt.returnValue!="unknown"&&(bt.returnValue=!1),this.isDefaultPrevented=Zo)},stopPropagation:function(){var bt=this.nativeEvent;bt&&(bt.stopPropagation?bt.stopPropagation():typeof bt.cancelBubble!="unknown"&&(bt.cancelBubble=!0),this.isPropagationStopped=Zo)},persist:function(){},isPersistent:Zo}),pt}var Ba={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(ct){return ct.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ia=ha(Ba),ao=Yt({},Ba,{view:0,detail:0}),js=ha(ao),Co,Ul,Mo,Yo=Yt({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hl,button:0,buttons:0,relatedTarget:function(ct){return ct.relatedTarget===void 0?ct.fromElement===ct.srcElement?ct.toElement:ct.fromElement:ct.relatedTarget},movementX:function(ct){return"movementX"in ct?ct.movementX:(ct!==Mo&&(Mo&&ct.type==="mousemove"?(Co=ct.screenX-Mo.screenX,Ul=ct.screenY-Mo.screenY):Ul=Co=0,Mo=ct),Co)},movementY:function(ct){return"movementY"in ct?ct.movementY:Ul}}),uu=ha(Yo),$a=Yt({},Yo,{dataTransfer:0}),$l=ha($a),so=Yt({},ao,{relatedTarget:0}),zl=ha(so),Mu=Yt({},Ba,{animationName:0,elapsedTime:0,pseudoElement:0}),cu=ha(Mu),Nc=Yt({},Ba,{clipboardData:function(ct){return"clipboardData"in ct?ct.clipboardData:window.clipboardData}}),gs=ha(Nc),jl=Yt({},Ba,{data:0}),Gs=ha(jl),Xo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ku(ct){var pt=this.nativeEvent;return pt.getModifierState?pt.getModifierState(ct):(ct=Gl[ct])?!!pt[ct]:!1}function Hl(){return ku}var oc=Yt({},ao,{key:function(ct){if(ct.key){var pt=Xo[ct.key]||ct.key;if(pt!=="Unidentified")return pt}return ct.type==="keypress"?(ct=hl(ct),ct===13?"Enter":String.fromCharCode(ct)):ct.type==="keydown"||ct.type==="keyup"?hu[ct.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hl,charCode:function(ct){return ct.type==="keypress"?hl(ct):0},keyCode:function(ct){return ct.type==="keydown"||ct.type==="keyup"?ct.keyCode:0},which:function(ct){return ct.type==="keypress"?hl(ct):ct.type==="keydown"||ct.type==="keyup"?ct.keyCode:0}}),Qo=ha(oc),us=Yt({},Yo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ko=ha(us),du=Yt({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hl}),Ou=ha(du),oo=Yt({},Ba,{propertyName:0,elapsedTime:0,pseudoElement:0}),ko=ha(oo),lc=Yt({},Yo,{deltaX:function(ct){return"deltaX"in ct?ct.deltaX:"wheelDeltaX"in ct?-ct.wheelDeltaX:0},deltaY:function(ct){return"deltaY"in ct?ct.deltaY:"wheelDeltaY"in ct?-ct.wheelDeltaY:"wheelDelta"in ct?-ct.wheelDelta:0},deltaZ:0,deltaMode:0}),uc=ha(lc),lo=[9,13,27,32],uo=ot&&"CompositionEvent"in window,Oo=null;ot&&"documentMode"in document&&(Oo=document.documentMode);var Bu=ot&&"TextEvent"in window&&!Oo,Vl=ot&&(!uo||Oo&&8<Oo&&11>=Oo),Du=" ",cc=!1;function Lu(ct,pt){switch(ct){case"keyup":return lo.indexOf(pt.keyCode)!==-1;case"keydown":return pt.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fu(ct){return ct=ct.detail,typeof ct=="object"&&"data"in ct?ct.data:null}var co=!1;function ho(ct,pt){switch(ct){case"compositionend":return fu(pt);case"keypress":return pt.which!==32?null:(cc=!0,Du);case"textInput":return ct=pt.data,ct===Du&&cc?null:ct;default:return null}}function Ma(ct,pt){if(co)return ct==="compositionend"||!uo&&Lu(ct,pt)?(ct=qo(),ks=Ms=ss=null,co=!1,ct):null;switch(ct){case"paste":return null;case"keypress":if(!(pt.ctrlKey||pt.altKey||pt.metaKey)||pt.ctrlKey&&pt.altKey){if(pt.char&&1<pt.char.length)return pt.char;if(pt.which)return String.fromCharCode(pt.which)}return null;case"compositionend":return Vl&&pt.locale!=="ko"?null:pt.data;default:return null}}var Wl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hs(ct){var pt=ct&&ct.nodeName&&ct.nodeName.toLowerCase();return pt==="input"?!!Wl[ct.type]:pt==="textarea"}function pu(ct,pt,bt,It){Pr(It),pt=fc(pt,"onChange"),0<pt.length&&(bt=new ia("onChange","change",null,bt,It),ct.push({event:bt,listeners:pt}))}var Jo=null,dl=null;function Os(ct){$c(ct,0)}function fl(ct){var pt=gu(ct);if(pr(pt))return ct}function fo(ct,pt){if(ct==="change")return pt}var Da=!1;if(ot){var el;if(ot){var St="oninput"in document;if(!St){var Dt=document.createElement("div");Dt.setAttribute("oninput","return;"),St=typeof Dt.oninput=="function"}el=St}else el=!1;Da=el&&(!document.documentMode||9<document.documentMode)}function Jt(){Jo&&(Jo.detachEvent("onpropertychange",sr),dl=Jo=null)}function sr(ct){if(ct.propertyName==="value"&&fl(dl)){var pt=[];pu(pt,dl,ct,Kr(ct)),yi(Os,pt)}}function gr(ct,pt,bt){ct==="focusin"?(Jt(),Jo=pt,dl=bt,Jo.attachEvent("onpropertychange",sr)):ct==="focusout"&&Jt()}function xr(ct){if(ct==="selectionchange"||ct==="keyup"||ct==="keydown")return fl(dl)}function Ar(ct,pt){if(ct==="click")return fl(pt)}function Mr(ct,pt){if(ct==="input"||ct==="change")return fl(pt)}function jr(ct,pt){return ct===pt&&(ct!==0||1/ct===1/pt)||ct!==ct&&pt!==pt}var Zr=typeof Object.is=="function"?Object.is:jr;function $r(ct,pt){if(Zr(ct,pt))return!0;if(typeof ct!="object"||ct===null||typeof pt!="object"||pt===null)return!1;var bt=Object.keys(ct),It=Object.keys(pt);if(bt.length!==It.length)return!1;for(It=0;It<bt.length;It++){var Gt=bt[It];if(!lt.call(pt,Gt)||!Zr(ct[Gt],pt[Gt]))return!1}return!0}function Ur(ct){for(;ct&&ct.firstChild;)ct=ct.firstChild;return ct}function Gr(ct,pt){var bt=Ur(ct);ct=0;for(var It;bt;){if(bt.nodeType===3){if(It=ct+bt.textContent.length,ct<=pt&&It>=pt)return{node:bt,offset:pt-ct};ct=It}e:{for(;bt;){if(bt.nextSibling){bt=bt.nextSibling;break e}bt=bt.parentNode}bt=void 0}bt=Ur(bt)}}function Nr(ct,pt){return ct&&pt?ct===pt?!0:ct&&ct.nodeType===3?!1:pt&&pt.nodeType===3?Nr(ct,pt.parentNode):"contains"in ct?ct.contains(pt):ct.compareDocumentPosition?!!(ct.compareDocumentPosition(pt)&16):!1:!1}function Fr(){for(var ct=window,pt=rr();pt instanceof ct.HTMLIFrameElement;){try{var bt=typeof pt.contentWindow.location.href=="string"}catch{bt=!1}if(bt)ct=pt.contentWindow;else break;pt=rr(ct.document)}return pt}function Lr(ct){var pt=ct&&ct.nodeName&&ct.nodeName.toLowerCase();return pt&&(pt==="input"&&(ct.type==="text"||ct.type==="search"||ct.type==="tel"||ct.type==="url"||ct.type==="password")||pt==="textarea"||ct.contentEditable==="true")}function An(ct){var pt=Fr(),bt=ct.focusedElem,It=ct.selectionRange;if(pt!==bt&&bt&&bt.ownerDocument&&Nr(bt.ownerDocument.documentElement,bt)){if(It!==null&&Lr(bt)){if(pt=It.start,ct=It.end,ct===void 0&&(ct=pt),"selectionStart"in bt)bt.selectionStart=pt,bt.selectionEnd=Math.min(ct,bt.value.length);else if(ct=(pt=bt.ownerDocument||document)&&pt.defaultView||window,ct.getSelection){ct=ct.getSelection();var Gt=bt.textContent.length,ir=Math.min(It.start,Gt);It=It.end===void 0?ir:Math.min(It.end,Gt),!ct.extend&&ir>It&&(Gt=It,It=ir,ir=Gt),Gt=Gr(bt,ir);var wr=Gr(bt,It);Gt&&wr&&(ct.rangeCount!==1||ct.anchorNode!==Gt.node||ct.anchorOffset!==Gt.offset||ct.focusNode!==wr.node||ct.focusOffset!==wr.offset)&&(pt=pt.createRange(),pt.setStart(Gt.node,Gt.offset),ct.removeAllRanges(),ir>It?(ct.addRange(pt),ct.extend(wr.node,wr.offset)):(pt.setEnd(wr.node,wr.offset),ct.addRange(pt)))}}for(pt=[],ct=bt;ct=ct.parentNode;)ct.nodeType===1&&pt.push({element:ct,left:ct.scrollLeft,top:ct.scrollTop});for(typeof bt.focus=="function"&&bt.focus(),bt=0;bt<pt.length;bt++)ct=pt[bt],ct.element.scrollLeft=ct.left,ct.element.scrollTop=ct.top}}var Fn=ot&&"documentMode"in document&&11>=document.documentMode,Yr=null,Zn=null,Qn=null,ci=!1;function di(ct,pt,bt){var It=bt.window===bt?bt.document:bt.nodeType===9?bt:bt.ownerDocument;ci||Yr==null||Yr!==rr(It)||(It=Yr,"selectionStart"in It&&Lr(It)?It={start:It.selectionStart,end:It.selectionEnd}:(It=(It.ownerDocument&&It.ownerDocument.defaultView||window).getSelection(),It={anchorNode:It.anchorNode,anchorOffset:It.anchorOffset,focusNode:It.focusNode,focusOffset:It.focusOffset}),Qn&&$r(Qn,It)||(Qn=It,It=fc(Zn,"onSelect"),0<It.length&&(pt=new ia("onSelect","select",null,pt,bt),ct.push({event:pt,listeners:It}),pt.target=Yr)))}function ni(ct,pt){var bt={};return bt[ct.toLowerCase()]=pt.toLowerCase(),bt["Webkit"+ct]="webkit"+pt,bt["Moz"+ct]="moz"+pt,bt}var gi={animationend:ni("Animation","AnimationEnd"),animationiteration:ni("Animation","AnimationIteration"),animationstart:ni("Animation","AnimationStart"),transitionend:ni("Transition","TransitionEnd")},hi={},oi={};ot&&(oi=document.createElement("div").style,"AnimationEvent"in window||(delete gi.animationend.animation,delete gi.animationiteration.animation,delete gi.animationstart.animation),"TransitionEvent"in window||delete gi.transitionend.transition);function wi(ct){if(hi[ct])return hi[ct];if(!gi[ct])return ct;var pt=gi[ct],bt;for(bt in pt)if(pt.hasOwnProperty(bt)&&bt in oi)return hi[ct]=pt[bt];return ct}var Wi=wi("animationend"),Ki=wi("animationiteration"),Bi=wi("animationstart"),ji=wi("transitionend"),ya=new Map,_s="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function na(ct,pt){ya.set(ct,pt),at(pt,[ct])}for(var po=0;po<_s.length;po++){var ql=_s[po],hc=ql.toLowerCase(),Zh=ql[0].toUpperCase()+ql.slice(1);na(hc,"on"+Zh)}na(Wi,"onAnimationEnd"),na(Ki,"onAnimationIteration"),na(Bi,"onAnimationStart"),na("dblclick","onDoubleClick"),na("focusin","onFocus"),na("focusout","onBlur"),na(ji,"onTransitionEnd"),st("onMouseEnter",["mouseout","mouseover"]),st("onMouseLeave",["mouseout","mouseover"]),st("onPointerEnter",["pointerout","pointerover"]),st("onPointerLeave",["pointerout","pointerover"]),at("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),at("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),at("onBeforeInput",["compositionend","keypress","textInput","paste"]),at("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),at("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zl));function dh(ct,pt,bt){var It=ct.type||"unknown-event";ct.currentTarget=bt,ka(It,pt,void 0,ct),ct.currentTarget=null}function $c(ct,pt){pt=(pt&4)!==0;for(var bt=0;bt<ct.length;bt++){var It=ct[bt],Gt=It.event;It=It.listeners;e:{var ir=void 0;if(pt)for(var wr=It.length-1;0<=wr;wr--){var Or=It[wr],zr=Or.instance,Hn=Or.currentTarget;if(Or=Or.listener,zr!==ir&&Gt.isPropagationStopped())break e;dh(Gt,Or,Hn),ir=zr}else for(wr=0;wr<It.length;wr++){if(Or=It[wr],zr=Or.instance,Hn=Or.currentTarget,Or=Or.listener,zr!==ir&&Gt.isPropagationStopped())break e;dh(Gt,Or,Hn),ir=zr}}}if(Na)throw ct=Oa,Na=!1,Oa=null,ct}function Ea(ct,pt){var bt=pt[ys];bt===void 0&&(bt=pt[ys]=new Set);var It=ct+"__bubble";bt.has(It)||(jc(pt,ct,2,!1),bt.add(It))}function zc(ct,pt,bt){var It=0;pt&&(It|=4),jc(bt,ct,It,pt)}var dc="_reactListening"+Math.random().toString(36).slice(2);function Fu(ct){if(!ct[dc]){ct[dc]=!0,nt.forEach(function(bt){bt!=="selectionchange"&&(Uc.has(bt)||zc(bt,!1,ct),zc(bt,!0,ct))});var pt=ct.nodeType===9?ct:ct.ownerDocument;pt===null||pt[dc]||(pt[dc]=!0,zc("selectionchange",!1,pt))}}function jc(ct,pt,bt,It){switch(as(pt)){case 1:var Gt=Fl;break;case 4:Gt=io;break;default:Gt=Nl}bt=Gt.bind(null,pt,bt,ct),Gt=void 0,!xa||pt!=="touchstart"&&pt!=="touchmove"&&pt!=="wheel"||(Gt=!0),It?Gt!==void 0?ct.addEventListener(pt,bt,{capture:!0,passive:Gt}):ct.addEventListener(pt,bt,!0):Gt!==void 0?ct.addEventListener(pt,bt,{passive:Gt}):ct.addEventListener(pt,bt,!1)}function Gc(ct,pt,bt,It,Gt){var ir=It;if((pt&1)===0&&(pt&2)===0&&It!==null)e:for(;;){if(It===null)return;var wr=It.tag;if(wr===3||wr===4){var Or=It.stateNode.containerInfo;if(Or===Gt||Or.nodeType===8&&Or.parentNode===Gt)break;if(wr===4)for(wr=It.return;wr!==null;){var zr=wr.tag;if((zr===3||zr===4)&&(zr=wr.stateNode.containerInfo,zr===Gt||zr.nodeType===8&&zr.parentNode===Gt))return;wr=wr.return}for(;Or!==null;){if(wr=Yl(Or),wr===null)return;if(zr=wr.tag,zr===5||zr===6){It=ir=wr;continue e}Or=Or.parentNode}}It=It.return}yi(function(){var Hn=ir,ai=Kr(bt),li=[];e:{var ii=ya.get(ct);if(ii!==void 0){var Si=ia,Pi=ct;switch(ct){case"keypress":if(hl(bt)===0)break e;case"keydown":case"keyup":Si=Qo;break;case"focusin":Pi="focus",Si=zl;break;case"focusout":Pi="blur",Si=zl;break;case"beforeblur":case"afterblur":Si=zl;break;case"click":if(bt.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Si=uu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Si=$l;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Si=Ou;break;case Wi:case Ki:case Bi:Si=cu;break;case ji:Si=ko;break;case"scroll":Si=js;break;case"wheel":Si=uc;break;case"copy":case"cut":case"paste":Si=gs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Si=Ko}var Mi=(pt&4)!==0,ns=!Mi&&ct==="scroll",Bn=Mi?ii!==null?ii+"Capture":null:ii;Mi=[];for(var Wr=Hn,$n;Wr!==null;){$n=Wr;var fi=$n.stateNode;if($n.tag===5&&fi!==null&&($n=fi,Bn!==null&&(fi=Li(Wr,Bn),fi!=null&&Mi.push(Nu(Wr,fi,$n)))),ns)break;Wr=Wr.return}0<Mi.length&&(ii=new Si(ii,Pi,null,bt,ai),li.push({event:ii,listeners:Mi}))}}if((pt&7)===0){e:{if(ii=ct==="mouseover"||ct==="pointerover",Si=ct==="mouseout"||ct==="pointerout",ii&&bt!==yr&&(Pi=bt.relatedTarget||bt.fromElement)&&(Yl(Pi)||Pi[La]))break e;if((Si||ii)&&(ii=ai.window===ai?ai:(ii=ai.ownerDocument)?ii.defaultView||ii.parentWindow:window,Si?(Pi=bt.relatedTarget||bt.toElement,Si=Hn,Pi=Pi?Yl(Pi):null,Pi!==null&&(ns=Xi(Pi),Pi!==ns||Pi.tag!==5&&Pi.tag!==6)&&(Pi=null)):(Si=null,Pi=Hn),Si!==Pi)){if(Mi=uu,fi="onMouseLeave",Bn="onMouseEnter",Wr="mouse",(ct==="pointerout"||ct==="pointerover")&&(Mi=Ko,fi="onPointerLeave",Bn="onPointerEnter",Wr="pointer"),ns=Si==null?ii:gu(Si),$n=Pi==null?ii:gu(Pi),ii=new Mi(fi,Wr+"leave",Si,bt,ai),ii.target=ns,ii.relatedTarget=$n,fi=null,Yl(ai)===Hn&&(Mi=new Mi(Bn,Wr+"enter",Pi,bt,ai),Mi.target=$n,Mi.relatedTarget=ns,fi=Mi),ns=fi,Si&&Pi)t:{for(Mi=Si,Bn=Pi,Wr=0,$n=Mi;$n;$n=Uu($n))Wr++;for($n=0,fi=Bn;fi;fi=Uu(fi))$n++;for(;0<Wr-$n;)Mi=Uu(Mi),Wr--;for(;0<$n-Wr;)Bn=Uu(Bn),$n--;for(;Wr--;){if(Mi===Bn||Bn!==null&&Mi===Bn.alternate)break t;Mi=Uu(Mi),Bn=Uu(Bn)}Mi=null}else Mi=null;Si!==null&&fh(li,ii,Si,Mi,!1),Pi!==null&&ns!==null&&fh(li,ns,Pi,Mi,!0)}}e:{if(ii=Hn?gu(Hn):window,Si=ii.nodeName&&ii.nodeName.toLowerCase(),Si==="select"||Si==="input"&&ii.type==="file")var ki=fo;else if(Hs(ii))if(Da)ki=Mr;else{ki=xr;var Ni=gr}else(Si=ii.nodeName)&&Si.toLowerCase()==="input"&&(ii.type==="checkbox"||ii.type==="radio")&&(ki=Ar);if(ki&&(ki=ki(ct,Hn))){pu(li,ki,bt,ai);break e}Ni&&Ni(ct,ii,Hn),ct==="focusout"&&(Ni=ii._wrapperState)&&Ni.controlled&&ii.type==="number"&&Kt(ii,"number",ii.value)}switch(Ni=Hn?gu(Hn):window,ct){case"focusin":(Hs(Ni)||Ni.contentEditable==="true")&&(Yr=Ni,Zn=Hn,Qn=null);break;case"focusout":Qn=Zn=Yr=null;break;case"mousedown":ci=!0;break;case"contextmenu":case"mouseup":case"dragend":ci=!1,di(li,bt,ai);break;case"selectionchange":if(Fn)break;case"keydown":case"keyup":di(li,bt,ai)}var Ui;if(uo)e:{switch(ct){case"compositionstart":var zi="onCompositionStart";break e;case"compositionend":zi="onCompositionEnd";break e;case"compositionupdate":zi="onCompositionUpdate";break e}zi=void 0}else co?Lu(ct,bt)&&(zi="onCompositionEnd"):ct==="keydown"&&bt.keyCode===229&&(zi="onCompositionStart");zi&&(Vl&&bt.locale!=="ko"&&(co||zi!=="onCompositionStart"?zi==="onCompositionEnd"&&co&&(Ui=qo()):(ss=ai,Ms="value"in ss?ss.value:ss.textContent,co=!0)),Ni=fc(Hn,zi),0<Ni.length&&(zi=new Gs(zi,ct,null,bt,ai),li.push({event:zi,listeners:Ni}),Ui?zi.data=Ui:(Ui=fu(bt),Ui!==null&&(zi.data=Ui)))),(Ui=Bu?ho(ct,bt):Ma(ct,bt))&&(Hn=fc(Hn,"onBeforeInput"),0<Hn.length&&(ai=new Gs("onBeforeInput","beforeinput",null,bt,ai),li.push({event:ai,listeners:Hn}),ai.data=Ui))}$c(li,pt)})}function Nu(ct,pt,bt){return{instance:ct,listener:pt,currentTarget:bt}}function fc(ct,pt){for(var bt=pt+"Capture",It=[];ct!==null;){var Gt=ct,ir=Gt.stateNode;Gt.tag===5&&ir!==null&&(Gt=ir,ir=Li(ct,bt),ir!=null&&It.unshift(Nu(ct,ir,Gt)),ir=Li(ct,pt),ir!=null&&It.push(Nu(ct,ir,Gt))),ct=ct.return}return It}function Uu(ct){if(ct===null)return null;do ct=ct.return;while(ct&&ct.tag!==5);return ct||null}function fh(ct,pt,bt,It,Gt){for(var ir=pt._reactName,wr=[];bt!==null&&bt!==It;){var Or=bt,zr=Or.alternate,Hn=Or.stateNode;if(zr!==null&&zr===It)break;Or.tag===5&&Hn!==null&&(Or=Hn,Gt?(zr=Li(bt,ir),zr!=null&&wr.unshift(Nu(bt,zr,Or))):Gt||(zr=Li(bt,ir),zr!=null&&wr.push(Nu(bt,zr,Or)))),bt=bt.return}wr.length!==0&&ct.push({event:pt,listeners:wr})}var Pd=/\r\n?/g,Cd=/\u0000|\uFFFD/g;function ph(ct){return(typeof ct=="string"?ct:""+ct).replace(Pd,`
`).replace(Cd,"")}function pc(ct,pt,bt){if(pt=ph(pt),ph(ct)!==pt&&bt)throw Error(rt(425))}function mc(){}var $u=null,mh=null;function gh(ct,pt){return ct==="textarea"||ct==="noscript"||typeof pt.children=="string"||typeof pt.children=="number"||typeof pt.dangerouslySetInnerHTML=="object"&&pt.dangerouslySetInnerHTML!==null&&pt.dangerouslySetInnerHTML.__html!=null}var _h=typeof setTimeout=="function"?setTimeout:void 0,zu=typeof clearTimeout=="function"?clearTimeout:void 0,Hc=typeof Promise=="function"?Promise:void 0,yh=typeof queueMicrotask=="function"?queueMicrotask:typeof Hc<"u"?function(ct){return Hc.resolve(null).then(ct).catch(Md)}:_h;function Md(ct){setTimeout(function(){throw ct})}function Vc(ct,pt){var bt=pt,It=0;do{var Gt=bt.nextSibling;if(ct.removeChild(bt),Gt&&Gt.nodeType===8)if(bt=Gt.data,bt==="/$"){if(It===0){ct.removeChild(Gt),zs(pt);return}It--}else bt!=="$"&&bt!=="$?"&&bt!=="$!"||It++;bt=Gt}while(bt);zs(pt)}function pl(ct){for(;ct!=null;ct=ct.nextSibling){var pt=ct.nodeType;if(pt===1||pt===3)break;if(pt===8){if(pt=ct.data,pt==="$"||pt==="$!"||pt==="$?")break;if(pt==="/$")return null}}return ct}function vh(ct){ct=ct.previousSibling;for(var pt=0;ct;){if(ct.nodeType===8){var bt=ct.data;if(bt==="$"||bt==="$!"||bt==="$?"){if(pt===0)return ct;pt--}else bt==="/$"&&pt++}ct=ct.previousSibling}return null}var mu=Math.random().toString(36).slice(2),Bo="__reactFiber$"+mu,gc="__reactProps$"+mu,La="__reactContainer$"+mu,ys="__reactEvents$"+mu,Yh="__reactListeners$"+mu,Xh="__reactHandles$"+mu;function Yl(ct){var pt=ct[Bo];if(pt)return pt;for(var bt=ct.parentNode;bt;){if(pt=bt[La]||bt[Bo]){if(bt=pt.alternate,pt.child!==null||bt!==null&&bt.child!==null)for(ct=vh(ct);ct!==null;){if(bt=ct[Bo])return bt;ct=vh(ct)}return pt}ct=bt,bt=ct.parentNode}return null}function ju(ct){return ct=ct[Bo]||ct[La],!ct||ct.tag!==5&&ct.tag!==6&&ct.tag!==13&&ct.tag!==3?null:ct}function gu(ct){if(ct.tag===5||ct.tag===6)return ct.stateNode;throw Error(rt(33))}function Gu(ct){return ct[gc]||null}var Wc=[],Xl=-1;function ml(ct){return{current:ct}}function Sa(ct){0>Xl||(ct.current=Wc[Xl],Wc[Xl]=null,Xl--)}function da(ct,pt){Xl++,Wc[Xl]=ct.current,ct.current=pt}var mo={},es=ml(mo),cs=ml(!1),gl=mo;function Ql(ct,pt){var bt=ct.type.contextTypes;if(!bt)return mo;var It=ct.stateNode;if(It&&It.__reactInternalMemoizedUnmaskedChildContext===pt)return It.__reactInternalMemoizedMaskedChildContext;var Gt={},ir;for(ir in bt)Gt[ir]=pt[ir];return It&&(ct=ct.stateNode,ct.__reactInternalMemoizedUnmaskedChildContext=pt,ct.__reactInternalMemoizedMaskedChildContext=Gt),Gt}function As(ct){return ct=ct.childContextTypes,ct!=null}function Hu(){Sa(cs),Sa(es)}function _c(ct,pt,bt){if(es.current!==mo)throw Error(rt(168));da(es,pt),da(cs,bt)}function bh(ct,pt,bt){var It=ct.stateNode;if(pt=pt.childContextTypes,typeof It.getChildContext!="function")return bt;It=It.getChildContext();for(var Gt in It)if(!(Gt in pt))throw Error(rt(108,br(ct)||"Unknown",Gt));return Yt({},bt,It)}function Vu(ct){return ct=(ct=ct.stateNode)&&ct.__reactInternalMemoizedMergedChildContext||mo,gl=es.current,da(es,ct),da(cs,cs.current),!0}function xh(ct,pt,bt){var It=ct.stateNode;if(!It)throw Error(rt(169));bt?(ct=bh(ct,pt,gl),It.__reactInternalMemoizedMergedChildContext=ct,Sa(cs),Sa(es),da(es,ct)):Sa(cs),da(cs,bt)}var go=null,_o=!1,yo=!1;function wh(ct){go===null?go=[ct]:go.push(ct)}function Qh(ct){_o=!0,wh(ct)}function vo(){if(!yo&&go!==null){yo=!0;var ct=0,pt=Zi;try{var bt=go;for(Zi=1;ct<bt.length;ct++){var It=bt[ct];do It=It(!0);while(It!==null)}go=null,_o=!1}catch(Gt){throw go!==null&&(go=go.slice(ct+1)),zo(Ks,vo),Gt}finally{Zi=pt,yo=!1}}return null}var Ga=[],Wu=0,qc=null,_u=0,va=[],bo=0,Ei=null,Bs=1,tl="";function Kl(ct,pt){Ga[Wu++]=_u,Ga[Wu++]=qc,qc=ct,_u=pt}function qu(ct,pt,bt){va[bo++]=Bs,va[bo++]=tl,va[bo++]=Ei,Ei=ct;var It=Bs;ct=tl;var Gt=32-Fi(It)-1;It&=~(1<<Gt),bt+=1;var ir=32-Fi(pt)+Gt;if(30<ir){var wr=Gt-Gt%5;ir=(It&(1<<wr)-1).toString(32),It>>=wr,Gt-=wr,Bs=1<<32-Fi(pt)+Gt|bt<<Gt|It,tl=ir+ct}else Bs=1<<ir|bt<<Gt|It,tl=ct}function Zu(ct){ct.return!==null&&(Kl(ct,1),qu(ct,1,0))}function yc(ct){for(;ct===qc;)qc=Ga[--Wu],Ga[Wu]=null,_u=Ga[--Wu],Ga[Wu]=null;for(;ct===Ei;)Ei=va[--bo],va[bo]=null,tl=va[--bo],va[bo]=null,Bs=va[--bo],va[bo]=null}var Ds=null,Ls=null,Aa=!1,Vs=null;function Zc(ct,pt){var bt=sl(5,null,null,0);bt.elementType="DELETED",bt.stateNode=pt,bt.return=ct,pt=ct.deletions,pt===null?(ct.deletions=[bt],ct.flags|=16):pt.push(bt)}function vs(ct,pt){switch(ct.tag){case 5:var bt=ct.type;return pt=pt.nodeType!==1||bt.toLowerCase()!==pt.nodeName.toLowerCase()?null:pt,pt!==null?(ct.stateNode=pt,Ds=ct,Ls=pl(pt.firstChild),!0):!1;case 6:return pt=ct.pendingProps===""||pt.nodeType!==3?null:pt,pt!==null?(ct.stateNode=pt,Ds=ct,Ls=null,!0):!1;case 13:return pt=pt.nodeType!==8?null:pt,pt!==null?(bt=Ei!==null?{id:Bs,overflow:tl}:null,ct.memoizedState={dehydrated:pt,treeContext:bt,retryLane:1073741824},bt=sl(18,null,null,0),bt.stateNode=pt,bt.return=ct,ct.child=bt,Ds=ct,Ls=null,!0):!1;default:return!1}}function xo(ct){return(ct.mode&1)!==0&&(ct.flags&128)===0}function wo(ct){if(Aa){var pt=Ls;if(pt){var bt=pt;if(!vs(ct,pt)){if(xo(ct))throw Error(rt(418));pt=pl(bt.nextSibling);var It=Ds;pt&&vs(ct,pt)?Zc(It,bt):(ct.flags=ct.flags&-4097|2,Aa=!1,Ds=ct)}}else{if(xo(ct))throw Error(rt(418));ct.flags=ct.flags&-4097|2,Aa=!1,Ds=ct}}}function Yc(ct){for(ct=ct.return;ct!==null&&ct.tag!==5&&ct.tag!==3&&ct.tag!==13;)ct=ct.return;Ds=ct}function vc(ct){if(ct!==Ds)return!1;if(!Aa)return Yc(ct),Aa=!0,!1;var pt;if((pt=ct.tag!==3)&&!(pt=ct.tag!==5)&&(pt=ct.type,pt=pt!=="head"&&pt!=="body"&&!gh(ct.type,ct.memoizedProps)),pt&&(pt=Ls)){if(xo(ct))throw Eo(),Error(rt(418));for(;pt;)Zc(ct,pt),pt=pl(pt.nextSibling)}if(Yc(ct),ct.tag===13){if(ct=ct.memoizedState,ct=ct!==null?ct.dehydrated:null,!ct)throw Error(rt(317));e:{for(ct=ct.nextSibling,pt=0;ct;){if(ct.nodeType===8){var bt=ct.data;if(bt==="/$"){if(pt===0){Ls=pl(ct.nextSibling);break e}pt--}else bt!=="$"&&bt!=="$!"&&bt!=="$?"||pt++}ct=ct.nextSibling}Ls=null}}else Ls=Ds?pl(ct.stateNode.nextSibling):null;return!0}function Eo(){for(var ct=Ls;ct;)ct=pl(ct.nextSibling)}function yu(){Ls=Ds=null,Aa=!1}function So(ct){Vs===null?Vs=[ct]:Vs.push(ct)}var kd=Pt.ReactCurrentBatchConfig;function Yu(ct,pt,bt){if(ct=bt.ref,ct!==null&&typeof ct!="function"&&typeof ct!="object"){if(bt._owner){if(bt=bt._owner,bt){if(bt.tag!==1)throw Error(rt(309));var It=bt.stateNode}if(!It)throw Error(rt(147,ct));var Gt=It,ir=""+ct;return pt!==null&&pt.ref!==null&&typeof pt.ref=="function"&&pt.ref._stringRef===ir?pt.ref:(pt=function(wr){var Or=Gt.refs;wr===null?delete Or[ir]:Or[ir]=wr},pt._stringRef=ir,pt)}if(typeof ct!="string")throw Error(rt(284));if(!bt._owner)throw Error(rt(290,ct))}return ct}function bc(ct,pt){throw ct=Object.prototype.toString.call(pt),Error(rt(31,ct==="[object Object]"?"object with keys {"+Object.keys(pt).join(", ")+"}":ct))}function Eh(ct){var pt=ct._init;return pt(ct._payload)}function Sh(ct){function pt(Bn,Wr){if(ct){var $n=Bn.deletions;$n===null?(Bn.deletions=[Wr],Bn.flags|=16):$n.push(Wr)}}function bt(Bn,Wr){if(!ct)return null;for(;Wr!==null;)pt(Bn,Wr),Wr=Wr.sibling;return null}function It(Bn,Wr){for(Bn=new Map;Wr!==null;)Wr.key!==null?Bn.set(Wr.key,Wr):Bn.set(Wr.index,Wr),Wr=Wr.sibling;return Bn}function Gt(Bn,Wr){return Bn=ac(Bn,Wr),Bn.index=0,Bn.sibling=null,Bn}function ir(Bn,Wr,$n){return Bn.index=$n,ct?($n=Bn.alternate,$n!==null?($n=$n.index,$n<Wr?(Bn.flags|=2,Wr):$n):(Bn.flags|=2,Wr)):(Bn.flags|=1048576,Wr)}function wr(Bn){return ct&&Bn.alternate===null&&(Bn.flags|=2),Bn}function Or(Bn,Wr,$n,fi){return Wr===null||Wr.tag!==6?(Wr=rf($n,Bn.mode,fi),Wr.return=Bn,Wr):(Wr=Gt(Wr,$n),Wr.return=Bn,Wr)}function zr(Bn,Wr,$n,fi){var ki=$n.type;return ki===Et?ai(Bn,Wr,$n.props.children,fi,$n.key):Wr!==null&&(Wr.elementType===ki||typeof ki=="object"&&ki!==null&&ki.$$typeof===Bt&&Eh(ki)===Wr.type)?(fi=Gt(Wr,$n.props),fi.ref=Yu(Bn,Wr,$n),fi.return=Bn,fi):(fi=md($n.type,$n.key,$n.props,null,Bn.mode,fi),fi.ref=Yu(Bn,Wr,$n),fi.return=Bn,fi)}function Hn(Bn,Wr,$n,fi){return Wr===null||Wr.tag!==4||Wr.stateNode.containerInfo!==$n.containerInfo||Wr.stateNode.implementation!==$n.implementation?(Wr=nf($n,Bn.mode,fi),Wr.return=Bn,Wr):(Wr=Gt(Wr,$n.children||[]),Wr.return=Bn,Wr)}function ai(Bn,Wr,$n,fi,ki){return Wr===null||Wr.tag!==7?(Wr=Lc($n,Bn.mode,fi,ki),Wr.return=Bn,Wr):(Wr=Gt(Wr,$n),Wr.return=Bn,Wr)}function li(Bn,Wr,$n){if(typeof Wr=="string"&&Wr!==""||typeof Wr=="number")return Wr=rf(""+Wr,Bn.mode,$n),Wr.return=Bn,Wr;if(typeof Wr=="object"&&Wr!==null){switch(Wr.$$typeof){case Rt:return $n=md(Wr.type,Wr.key,Wr.props,null,Bn.mode,$n),$n.ref=Yu(Bn,null,Wr),$n.return=Bn,$n;case Ot:return Wr=nf(Wr,Bn.mode,$n),Wr.return=Bn,Wr;case Bt:var fi=Wr._init;return li(Bn,fi(Wr._payload),$n)}if(or(Wr)||Wt(Wr))return Wr=Lc(Wr,Bn.mode,$n,null),Wr.return=Bn,Wr;bc(Bn,Wr)}return null}function ii(Bn,Wr,$n,fi){var ki=Wr!==null?Wr.key:null;if(typeof $n=="string"&&$n!==""||typeof $n=="number")return ki!==null?null:Or(Bn,Wr,""+$n,fi);if(typeof $n=="object"&&$n!==null){switch($n.$$typeof){case Rt:return $n.key===ki?zr(Bn,Wr,$n,fi):null;case Ot:return $n.key===ki?Hn(Bn,Wr,$n,fi):null;case Bt:return ki=$n._init,ii(Bn,Wr,ki($n._payload),fi)}if(or($n)||Wt($n))return ki!==null?null:ai(Bn,Wr,$n,fi,null);bc(Bn,$n)}return null}function Si(Bn,Wr,$n,fi,ki){if(typeof fi=="string"&&fi!==""||typeof fi=="number")return Bn=Bn.get($n)||null,Or(Wr,Bn,""+fi,ki);if(typeof fi=="object"&&fi!==null){switch(fi.$$typeof){case Rt:return Bn=Bn.get(fi.key===null?$n:fi.key)||null,zr(Wr,Bn,fi,ki);case Ot:return Bn=Bn.get(fi.key===null?$n:fi.key)||null,Hn(Wr,Bn,fi,ki);case Bt:var Ni=fi._init;return Si(Bn,Wr,$n,Ni(fi._payload),ki)}if(or(fi)||Wt(fi))return Bn=Bn.get($n)||null,ai(Wr,Bn,fi,ki,null);bc(Wr,fi)}return null}function Pi(Bn,Wr,$n,fi){for(var ki=null,Ni=null,Ui=Wr,zi=Wr=0,ws=null;Ui!==null&&zi<$n.length;zi++){Ui.index>zi?(ws=Ui,Ui=null):ws=Ui.sibling;var fa=ii(Bn,Ui,$n[zi],fi);if(fa===null){Ui===null&&(Ui=ws);break}ct&&Ui&&fa.alternate===null&&pt(Bn,Ui),Wr=ir(fa,Wr,zi),Ni===null?ki=fa:Ni.sibling=fa,Ni=fa,Ui=ws}if(zi===$n.length)return bt(Bn,Ui),Aa&&Kl(Bn,zi),ki;if(Ui===null){for(;zi<$n.length;zi++)Ui=li(Bn,$n[zi],fi),Ui!==null&&(Wr=ir(Ui,Wr,zi),Ni===null?ki=Ui:Ni.sibling=Ui,Ni=Ui);return Aa&&Kl(Bn,zi),ki}for(Ui=It(Bn,Ui);zi<$n.length;zi++)ws=Si(Ui,Bn,zi,$n[zi],fi),ws!==null&&(ct&&ws.alternate!==null&&Ui.delete(ws.key===null?zi:ws.key),Wr=ir(ws,Wr,zi),Ni===null?ki=ws:Ni.sibling=ws,Ni=ws);return ct&&Ui.forEach(function(sc){return pt(Bn,sc)}),Aa&&Kl(Bn,zi),ki}function Mi(Bn,Wr,$n,fi){var ki=Wt($n);if(typeof ki!="function")throw Error(rt(150));if($n=ki.call($n),$n==null)throw Error(rt(151));for(var Ni=ki=null,Ui=Wr,zi=Wr=0,ws=null,fa=$n.next();Ui!==null&&!fa.done;zi++,fa=$n.next()){Ui.index>zi?(ws=Ui,Ui=null):ws=Ui.sibling;var sc=ii(Bn,Ui,fa.value,fi);if(sc===null){Ui===null&&(Ui=ws);break}ct&&Ui&&sc.alternate===null&&pt(Bn,Ui),Wr=ir(sc,Wr,zi),Ni===null?ki=sc:Ni.sibling=sc,Ni=sc,Ui=ws}if(fa.done)return bt(Bn,Ui),Aa&&Kl(Bn,zi),ki;if(Ui===null){for(;!fa.done;zi++,fa=$n.next())fa=li(Bn,fa.value,fi),fa!==null&&(Wr=ir(fa,Wr,zi),Ni===null?ki=fa:Ni.sibling=fa,Ni=fa);return Aa&&Kl(Bn,zi),ki}for(Ui=It(Bn,Ui);!fa.done;zi++,fa=$n.next())fa=Si(Ui,Bn,zi,fa.value,fi),fa!==null&&(ct&&fa.alternate!==null&&Ui.delete(fa.key===null?zi:fa.key),Wr=ir(fa,Wr,zi),Ni===null?ki=fa:Ni.sibling=fa,Ni=fa);return ct&&Ui.forEach(function(Tp){return pt(Bn,Tp)}),Aa&&Kl(Bn,zi),ki}function ns(Bn,Wr,$n,fi){if(typeof $n=="object"&&$n!==null&&$n.type===Et&&$n.key===null&&($n=$n.props.children),typeof $n=="object"&&$n!==null){switch($n.$$typeof){case Rt:e:{for(var ki=$n.key,Ni=Wr;Ni!==null;){if(Ni.key===ki){if(ki=$n.type,ki===Et){if(Ni.tag===7){bt(Bn,Ni.sibling),Wr=Gt(Ni,$n.props.children),Wr.return=Bn,Bn=Wr;break e}}else if(Ni.elementType===ki||typeof ki=="object"&&ki!==null&&ki.$$typeof===Bt&&Eh(ki)===Ni.type){bt(Bn,Ni.sibling),Wr=Gt(Ni,$n.props),Wr.ref=Yu(Bn,Ni,$n),Wr.return=Bn,Bn=Wr;break e}bt(Bn,Ni);break}else pt(Bn,Ni);Ni=Ni.sibling}$n.type===Et?(Wr=Lc($n.props.children,Bn.mode,fi,$n.key),Wr.return=Bn,Bn=Wr):(fi=md($n.type,$n.key,$n.props,null,Bn.mode,fi),fi.ref=Yu(Bn,Wr,$n),fi.return=Bn,Bn=fi)}return wr(Bn);case Ot:e:{for(Ni=$n.key;Wr!==null;){if(Wr.key===Ni)if(Wr.tag===4&&Wr.stateNode.containerInfo===$n.containerInfo&&Wr.stateNode.implementation===$n.implementation){bt(Bn,Wr.sibling),Wr=Gt(Wr,$n.children||[]),Wr.return=Bn,Bn=Wr;break e}else{bt(Bn,Wr);break}else pt(Bn,Wr);Wr=Wr.sibling}Wr=nf($n,Bn.mode,fi),Wr.return=Bn,Bn=Wr}return wr(Bn);case Bt:return Ni=$n._init,ns(Bn,Wr,Ni($n._payload),fi)}if(or($n))return Pi(Bn,Wr,$n,fi);if(Wt($n))return Mi(Bn,Wr,$n,fi);bc(Bn,$n)}return typeof $n=="string"&&$n!==""||typeof $n=="number"?($n=""+$n,Wr!==null&&Wr.tag===6?(bt(Bn,Wr.sibling),Wr=Gt(Wr,$n),Wr.return=Bn,Bn=Wr):(bt(Bn,Wr),Wr=rf($n,Bn.mode,fi),Wr.return=Bn,Bn=Wr),wr(Bn)):bt(Bn,Wr)}return ns}var _l=Sh(!0),xc=Sh(!1),vu=ml(null),bu=null,yl=null,xu=null;function wc(){xu=yl=bu=null}function Ec(ct){var pt=vu.current;Sa(vu),ct._currentValue=pt}function Sc(ct,pt,bt){for(;ct!==null;){var It=ct.alternate;if((ct.childLanes&pt)!==pt?(ct.childLanes|=pt,It!==null&&(It.childLanes|=pt)):It!==null&&(It.childLanes&pt)!==pt&&(It.childLanes|=pt),ct===bt)break;ct=ct.return}}function wu(ct,pt){bu=ct,xu=yl=null,ct=ct.dependencies,ct!==null&&ct.firstContext!==null&&((ct.lanes&pt)!==0&&(Xr=!0),ct.firstContext=null)}function Fs(ct){var pt=ct._currentValue;if(xu!==ct)if(ct={context:ct,memoizedValue:pt,next:null},yl===null){if(bu===null)throw Error(rt(308));yl=ct,bu.dependencies={lanes:0,firstContext:ct}}else yl=yl.next=ct;return pt}var Eu=null;function Xu(ct){Eu===null?Eu=[ct]:Eu.push(ct)}function Xc(ct,pt,bt,It){var Gt=pt.interleaved;return Gt===null?(bt.next=bt,Xu(pt)):(bt.next=Gt.next,Gt.next=bt),pt.interleaved=bt,ga(ct,It)}function ga(ct,pt){ct.lanes|=pt;var bt=ct.alternate;for(bt!==null&&(bt.lanes|=pt),bt=ct,ct=ct.return;ct!==null;)ct.childLanes|=pt,bt=ct.alternate,bt!==null&&(bt.childLanes|=pt),bt=ct,ct=ct.return;return bt.tag===3?bt.stateNode:null}var Hi=!1;function Ha(ct){ct.updateQueue={baseState:ct.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function za(ct,pt){ct=ct.updateQueue,pt.updateQueue===ct&&(pt.updateQueue={baseState:ct.baseState,firstBaseUpdate:ct.firstBaseUpdate,lastBaseUpdate:ct.lastBaseUpdate,shared:ct.shared,effects:ct.effects})}function Ra(ct,pt){return{eventTime:ct,lane:pt,tag:0,payload:null,callback:null,next:null}}function Va(ct,pt,bt){var It=ct.updateQueue;if(It===null)return null;if(It=It.shared,(oa&2)!==0){var Gt=It.pending;return Gt===null?pt.next=pt:(pt.next=Gt.next,Gt.next=pt),It.pending=pt,ga(ct,bt)}return Gt=It.interleaved,Gt===null?(pt.next=pt,Xu(It)):(pt.next=Gt.next,Gt.next=pt),It.interleaved=pt,ga(ct,bt)}function vl(ct,pt,bt){if(pt=pt.updateQueue,pt!==null&&(pt=pt.shared,(bt&4194240)!==0)){var It=pt.lanes;It&=ct.pendingLanes,bt|=It,pt.lanes=bt,kl(ct,bt)}}function Wa(ct,pt){var bt=ct.updateQueue,It=ct.alternate;if(It!==null&&(It=It.updateQueue,bt===It)){var Gt=null,ir=null;if(bt=bt.firstBaseUpdate,bt!==null){do{var wr={eventTime:bt.eventTime,lane:bt.lane,tag:bt.tag,payload:bt.payload,callback:bt.callback,next:null};ir===null?Gt=ir=wr:ir=ir.next=wr,bt=bt.next}while(bt!==null);ir===null?Gt=ir=pt:ir=ir.next=pt}else Gt=ir=pt;bt={baseState:It.baseState,firstBaseUpdate:Gt,lastBaseUpdate:ir,shared:It.shared,effects:It.effects},ct.updateQueue=bt;return}ct=bt.lastBaseUpdate,ct===null?bt.firstBaseUpdate=pt:ct.next=pt,bt.lastBaseUpdate=pt}function Jl(ct,pt,bt,It){var Gt=ct.updateQueue;Hi=!1;var ir=Gt.firstBaseUpdate,wr=Gt.lastBaseUpdate,Or=Gt.shared.pending;if(Or!==null){Gt.shared.pending=null;var zr=Or,Hn=zr.next;zr.next=null,wr===null?ir=Hn:wr.next=Hn,wr=zr;var ai=ct.alternate;ai!==null&&(ai=ai.updateQueue,Or=ai.lastBaseUpdate,Or!==wr&&(Or===null?ai.firstBaseUpdate=Hn:Or.next=Hn,ai.lastBaseUpdate=zr))}if(ir!==null){var li=Gt.baseState;wr=0,ai=Hn=zr=null,Or=ir;do{var ii=Or.lane,Si=Or.eventTime;if((It&ii)===ii){ai!==null&&(ai=ai.next={eventTime:Si,lane:0,tag:Or.tag,payload:Or.payload,callback:Or.callback,next:null});e:{var Pi=ct,Mi=Or;switch(ii=pt,Si=bt,Mi.tag){case 1:if(Pi=Mi.payload,typeof Pi=="function"){li=Pi.call(Si,li,ii);break e}li=Pi;break e;case 3:Pi.flags=Pi.flags&-65537|128;case 0:if(Pi=Mi.payload,ii=typeof Pi=="function"?Pi.call(Si,li,ii):Pi,ii==null)break e;li=Yt({},li,ii);break e;case 2:Hi=!0}}Or.callback!==null&&Or.lane!==0&&(ct.flags|=64,ii=Gt.effects,ii===null?Gt.effects=[Or]:ii.push(Or))}else Si={eventTime:Si,lane:ii,tag:Or.tag,payload:Or.payload,callback:Or.callback,next:null},ai===null?(Hn=ai=Si,zr=li):ai=ai.next=Si,wr|=ii;if(Or=Or.next,Or===null){if(Or=Gt.shared.pending,Or===null)break;ii=Or,Or=ii.next,ii.next=null,Gt.lastBaseUpdate=ii,Gt.shared.pending=null}}while(!0);if(ai===null&&(zr=li),Gt.baseState=zr,Gt.firstBaseUpdate=Hn,Gt.lastBaseUpdate=ai,pt=Gt.shared.interleaved,pt!==null){Gt=pt;do wr|=Gt.lane,Gt=Gt.next;while(Gt!==pt)}else ir===null&&(Gt.shared.lanes=0);kc|=wr,ct.lanes=wr,ct.memoizedState=li}}function eu(ct,pt,bt){if(ct=pt.effects,pt.effects=null,ct!==null)for(pt=0;pt<ct.length;pt++){var It=ct[pt],Gt=It.callback;if(Gt!==null){if(It.callback=null,It=bt,typeof Gt!="function")throw Error(rt(191,Gt));Gt.call(It)}}}var tu={},To=ml(tu),bl=ml(tu),hs=ml(tu);function xl(ct){if(ct===tu)throw Error(rt(174));return ct}function Tc(ct,pt){switch(da(hs,pt),da(bl,ct),da(To,tu),ct=pt.nodeType,ct){case 9:case 11:pt=(pt=pt.documentElement)?pt.namespaceURI:Kn(null,"");break;default:ct=ct===8?pt.parentNode:pt,pt=ct.namespaceURI||null,ct=ct.tagName,pt=Kn(pt,ct)}Sa(To),da(To,pt)}function Ws(){Sa(To),Sa(bl),Sa(hs)}function Su(ct){xl(hs.current);var pt=xl(To.current),bt=Kn(pt,ct.type);pt!==bt&&(da(bl,ct),da(To,bt))}function Qc(ct){bl.current===ct&&(Sa(To),Sa(bl))}var Ta=ml(0);function Qu(ct){for(var pt=ct;pt!==null;){if(pt.tag===13){var bt=pt.memoizedState;if(bt!==null&&(bt=bt.dehydrated,bt===null||bt.data==="$?"||bt.data==="$!"))return pt}else if(pt.tag===19&&pt.memoizedProps.revealOrder!==void 0){if((pt.flags&128)!==0)return pt}else if(pt.child!==null){pt.child.return=pt,pt=pt.child;continue}if(pt===ct)break;for(;pt.sibling===null;){if(pt.return===null||pt.return===ct)return null;pt=pt.return}pt.sibling.return=pt.return,pt=pt.sibling}return null}var rl=[];function Ku(){for(var ct=0;ct<rl.length;ct++)rl[ct]._workInProgressVersionPrimary=null;rl.length=0}var Do=Pt.ReactCurrentDispatcher,Ju=Pt.ReactCurrentBatchConfig,Lo=0,Ia=null,Fa=null,ja=null,ts=!1,Ao=!1,bs=0,Ns=0;function ds(){throw Error(rt(321))}function Ac(ct,pt){if(pt===null)return!1;for(var bt=0;bt<pt.length&&bt<ct.length;bt++)if(!Zr(ct[bt],pt[bt]))return!1;return!0}function Rc(ct,pt,bt,It,Gt,ir){if(Lo=ir,Ia=pt,pt.memoizedState=null,pt.updateQueue=null,pt.lanes=0,Do.current=ct===null||ct.memoizedState===null?nh:Bd,ct=bt(It,Gt),Ao){ir=0;do{if(Ao=!1,bs=0,25<=ir)throw Error(rt(301));ir+=1,ja=Fa=null,pt.updateQueue=null,Do.current=Dd,ct=bt(It,Gt)}while(Ao)}if(Do.current=Mc,pt=Fa!==null&&Fa.next!==null,Lo=0,ja=Fa=Ia=null,ts=!1,pt)throw Error(rt(300));return ct}function nl(){var ct=bs!==0;return bs=0,ct}function Fo(){var ct={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ja===null?Ia.memoizedState=ja=ct:ja=ja.next=ct,ja}function qs(){if(Fa===null){var ct=Ia.alternate;ct=ct!==null?ct.memoizedState:null}else ct=Fa.next;var pt=ja===null?Ia.memoizedState:ja.next;if(pt!==null)ja=pt,Fa=ct;else{if(ct===null)throw Error(rt(310));Fa=ct,ct={memoizedState:Fa.memoizedState,baseState:Fa.baseState,baseQueue:Fa.baseQueue,queue:Fa.queue,next:null},ja===null?Ia.memoizedState=ja=ct:ja=ja.next=ct}return ja}function Tu(ct,pt){return typeof pt=="function"?pt(ct):pt}function wl(ct){var pt=qs(),bt=pt.queue;if(bt===null)throw Error(rt(311));bt.lastRenderedReducer=ct;var It=Fa,Gt=It.baseQueue,ir=bt.pending;if(ir!==null){if(Gt!==null){var wr=Gt.next;Gt.next=ir.next,ir.next=wr}It.baseQueue=Gt=ir,bt.pending=null}if(Gt!==null){ir=Gt.next,It=It.baseState;var Or=wr=null,zr=null,Hn=ir;do{var ai=Hn.lane;if((Lo&ai)===ai)zr!==null&&(zr=zr.next={lane:0,action:Hn.action,hasEagerState:Hn.hasEagerState,eagerState:Hn.eagerState,next:null}),It=Hn.hasEagerState?Hn.eagerState:ct(It,Hn.action);else{var li={lane:ai,action:Hn.action,hasEagerState:Hn.hasEagerState,eagerState:Hn.eagerState,next:null};zr===null?(Or=zr=li,wr=It):zr=zr.next=li,Ia.lanes|=ai,kc|=ai}Hn=Hn.next}while(Hn!==null&&Hn!==ir);zr===null?wr=It:zr.next=Or,Zr(It,pt.memoizedState)||(Xr=!0),pt.memoizedState=It,pt.baseState=wr,pt.baseQueue=zr,bt.lastRenderedState=It}if(ct=bt.interleaved,ct!==null){Gt=ct;do ir=Gt.lane,Ia.lanes|=ir,kc|=ir,Gt=Gt.next;while(Gt!==ct)}else Gt===null&&(bt.lanes=0);return[pt.memoizedState,bt.dispatch]}function Kc(ct){var pt=qs(),bt=pt.queue;if(bt===null)throw Error(rt(311));bt.lastRenderedReducer=ct;var It=bt.dispatch,Gt=bt.pending,ir=pt.memoizedState;if(Gt!==null){bt.pending=null;var wr=Gt=Gt.next;do ir=ct(ir,wr.action),wr=wr.next;while(wr!==Gt);Zr(ir,pt.memoizedState)||(Xr=!0),pt.memoizedState=ir,pt.baseQueue===null&&(pt.baseState=ir),bt.lastRenderedState=ir}return[ir,It]}function Th(){}function Jc(ct,pt){var bt=Ia,It=qs(),Gt=pt(),ir=!Zr(It.memoizedState,Gt);if(ir&&(It.memoizedState=Gt,Xr=!0),It=It.queue,Ch(Jh.bind(null,bt,It,ct),[ct]),It.getSnapshot!==pt||ir||ja!==null&&ja.memoizedState.tag&1){if(bt.flags|=2048,No(9,Kh.bind(null,bt,It,Gt,pt),void 0,null),xs===null)throw Error(rt(349));(Lo&30)!==0||Ic(bt,pt,Gt)}return Gt}function Ic(ct,pt,bt){ct.flags|=16384,ct={getSnapshot:pt,value:bt},pt=Ia.updateQueue,pt===null?(pt={lastEffect:null,stores:null},Ia.updateQueue=pt,pt.stores=[ct]):(bt=pt.stores,bt===null?pt.stores=[ct]:bt.push(ct))}function Kh(ct,pt,bt,It){pt.value=bt,pt.getSnapshot=It,Ah(pt)&&Rh(ct)}function Jh(ct,pt,bt){return bt(function(){Ah(pt)&&Rh(ct)})}function Ah(ct){var pt=ct.getSnapshot;ct=ct.value;try{var bt=pt();return!Zr(ct,bt)}catch{return!0}}function Rh(ct){var pt=ga(ct,1);pt!==null&&Al(pt,ct,1,-1)}function Au(ct){var pt=Fo();return typeof ct=="function"&&(ct=ct()),pt.memoizedState=pt.baseState=ct,ct={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tu,lastRenderedState:ct},pt.queue=ct,ct=ct.dispatch=Od.bind(null,Ia,ct),[pt.memoizedState,ct]}function No(ct,pt,bt,It){return ct={tag:ct,create:pt,destroy:bt,deps:It,next:null},pt=Ia.updateQueue,pt===null?(pt={lastEffect:null,stores:null},Ia.updateQueue=pt,pt.lastEffect=ct.next=ct):(bt=pt.lastEffect,bt===null?pt.lastEffect=ct.next=ct:(It=bt.next,bt.next=ct,ct.next=It,pt.lastEffect=ct)),ct}function Ih(){return qs().memoizedState}function ba(ct,pt,bt,It){var Gt=Fo();Ia.flags|=ct,Gt.memoizedState=No(1|pt,bt,void 0,It===void 0?null:It)}function eh(ct,pt,bt,It){var Gt=qs();It=It===void 0?null:It;var ir=void 0;if(Fa!==null){var wr=Fa.memoizedState;if(ir=wr.destroy,It!==null&&Ac(It,wr.deps)){Gt.memoizedState=No(pt,bt,ir,It);return}}Ia.flags|=ct,Gt.memoizedState=No(1|pt,bt,ir,It)}function Ph(ct,pt){return ba(8390656,8,ct,pt)}function Ch(ct,pt){return eh(2048,8,ct,pt)}function ed(ct,pt){return eh(4,2,ct,pt)}function Mh(ct,pt){return eh(4,4,ct,pt)}function td(ct,pt){if(typeof pt=="function")return ct=ct(),pt(ct),function(){pt(null)};if(pt!=null)return ct=ct(),pt.current=ct,function(){pt.current=null}}function Zs(ct,pt,bt){return bt=bt!=null?bt.concat([ct]):null,eh(4,4,td.bind(null,pt,ct),bt)}function Pc(){}function El(ct,pt){var bt=qs();pt=pt===void 0?null:pt;var It=bt.memoizedState;return It!==null&&pt!==null&&Ac(pt,It[1])?It[0]:(bt.memoizedState=[ct,pt],ct)}function Cc(ct,pt){var bt=qs();pt=pt===void 0?null:pt;var It=bt.memoizedState;return It!==null&&pt!==null&&Ac(pt,It[1])?It[0]:(ct=ct(),bt.memoizedState=[ct,pt],ct)}function ru(ct,pt,bt){return(Lo&21)===0?(ct.baseState&&(ct.baseState=!1,Xr=!0),ct.memoizedState=bt):(Zr(bt,pt)||(bt=Xa(),Ia.lanes|=bt,kc|=bt,ct.baseState=!0),pt)}function th(ct,pt){var bt=Zi;Zi=bt!==0&&4>bt?bt:4,ct(!0);var It=Ju.transition;Ju.transition={};try{ct(!1),pt()}finally{Zi=bt,Ju.transition=It}}function rh(){return qs().memoizedState}function kh(ct,pt,bt){var It=nc(ct);if(bt={lane:It,action:bt,hasEagerState:!1,eagerState:null,next:null},Oh(ct))Bh(pt,bt);else if(bt=Xc(ct,pt,bt,It),bt!==null){var Gt=Ys();Al(bt,ct,It,Gt),Dh(bt,pt,It)}}function Od(ct,pt,bt){var It=nc(ct),Gt={lane:It,action:bt,hasEagerState:!1,eagerState:null,next:null};if(Oh(ct))Bh(pt,Gt);else{var ir=ct.alternate;if(ct.lanes===0&&(ir===null||ir.lanes===0)&&(ir=pt.lastRenderedReducer,ir!==null))try{var wr=pt.lastRenderedState,Or=ir(wr,bt);if(Gt.hasEagerState=!0,Gt.eagerState=Or,Zr(Or,wr)){var zr=pt.interleaved;zr===null?(Gt.next=Gt,Xu(pt)):(Gt.next=zr.next,zr.next=Gt),pt.interleaved=Gt;return}}catch{}bt=Xc(ct,pt,Gt,It),bt!==null&&(Gt=Ys(),Al(bt,ct,It,Gt),Dh(bt,pt,It))}}function Oh(ct){var pt=ct.alternate;return ct===Ia||pt!==null&&pt===Ia}function Bh(ct,pt){Ao=ts=!0;var bt=ct.pending;bt===null?pt.next=pt:(pt.next=bt.next,bt.next=pt),ct.pending=pt}function Dh(ct,pt,bt){if((bt&4194240)!==0){var It=pt.lanes;It&=ct.pendingLanes,bt|=It,pt.lanes=bt,kl(ct,bt)}}var Mc={readContext:Fs,useCallback:ds,useContext:ds,useEffect:ds,useImperativeHandle:ds,useInsertionEffect:ds,useLayoutEffect:ds,useMemo:ds,useReducer:ds,useRef:ds,useState:ds,useDebugValue:ds,useDeferredValue:ds,useTransition:ds,useMutableSource:ds,useSyncExternalStore:ds,useId:ds,unstable_isNewReconciler:!1},nh={readContext:Fs,useCallback:function(ct,pt){return Fo().memoizedState=[ct,pt===void 0?null:pt],ct},useContext:Fs,useEffect:Ph,useImperativeHandle:function(ct,pt,bt){return bt=bt!=null?bt.concat([ct]):null,ba(4194308,4,td.bind(null,pt,ct),bt)},useLayoutEffect:function(ct,pt){return ba(4194308,4,ct,pt)},useInsertionEffect:function(ct,pt){return ba(4,2,ct,pt)},useMemo:function(ct,pt){var bt=Fo();return pt=pt===void 0?null:pt,ct=ct(),bt.memoizedState=[ct,pt],ct},useReducer:function(ct,pt,bt){var It=Fo();return pt=bt!==void 0?bt(pt):pt,It.memoizedState=It.baseState=pt,ct={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ct,lastRenderedState:pt},It.queue=ct,ct=ct.dispatch=kh.bind(null,Ia,ct),[It.memoizedState,ct]},useRef:function(ct){var pt=Fo();return ct={current:ct},pt.memoizedState=ct},useState:Au,useDebugValue:Pc,useDeferredValue:function(ct){return Fo().memoizedState=ct},useTransition:function(){var ct=Au(!1),pt=ct[0];return ct=th.bind(null,ct[1]),Fo().memoizedState=ct,[pt,ct]},useMutableSource:function(){},useSyncExternalStore:function(ct,pt,bt){var It=Ia,Gt=Fo();if(Aa){if(bt===void 0)throw Error(rt(407));bt=bt()}else{if(bt=pt(),xs===null)throw Error(rt(349));(Lo&30)!==0||Ic(It,pt,bt)}Gt.memoizedState=bt;var ir={value:bt,getSnapshot:pt};return Gt.queue=ir,Ph(Jh.bind(null,It,ir,ct),[ct]),It.flags|=2048,No(9,Kh.bind(null,It,ir,bt,pt),void 0,null),bt},useId:function(){var ct=Fo(),pt=xs.identifierPrefix;if(Aa){var bt=tl,It=Bs;bt=(It&~(1<<32-Fi(It)-1)).toString(32)+bt,pt=":"+pt+"R"+bt,bt=bs++,0<bt&&(pt+="H"+bt.toString(32)),pt+=":"}else bt=Ns++,pt=":"+pt+"r"+bt.toString(32)+":";return ct.memoizedState=pt},unstable_isNewReconciler:!1},Bd={readContext:Fs,useCallback:El,useContext:Fs,useEffect:Ch,useImperativeHandle:Zs,useInsertionEffect:ed,useLayoutEffect:Mh,useMemo:Cc,useReducer:wl,useRef:Ih,useState:function(){return wl(Tu)},useDebugValue:Pc,useDeferredValue:function(ct){var pt=qs();return ru(pt,Fa.memoizedState,ct)},useTransition:function(){var ct=wl(Tu)[0],pt=qs().memoizedState;return[ct,pt]},useMutableSource:Th,useSyncExternalStore:Jc,useId:rh,unstable_isNewReconciler:!1},Dd={readContext:Fs,useCallback:El,useContext:Fs,useEffect:Ch,useImperativeHandle:Zs,useInsertionEffect:ed,useLayoutEffect:Mh,useMemo:Cc,useReducer:Kc,useRef:Ih,useState:function(){return Kc(Tu)},useDebugValue:Pc,useDeferredValue:function(ct){var pt=qs();return Fa===null?pt.memoizedState=ct:ru(pt,Fa.memoizedState,ct)},useTransition:function(){var ct=Kc(Tu)[0],pt=qs().memoizedState;return[ct,pt]},useMutableSource:Th,useSyncExternalStore:Jc,useId:rh,unstable_isNewReconciler:!1};function _t(ct,pt){if(ct&&ct.defaultProps){pt=Yt({},pt),ct=ct.defaultProps;for(var bt in ct)pt[bt]===void 0&&(pt[bt]=ct[bt]);return pt}return pt}function yt(ct,pt,bt,It){pt=ct.memoizedState,bt=bt(It,pt),bt=bt==null?pt:Yt({},pt,bt),ct.memoizedState=bt,ct.lanes===0&&(ct.updateQueue.baseState=bt)}var Ct={isMounted:function(ct){return(ct=ct._reactInternals)?Xi(ct)===ct:!1},enqueueSetState:function(ct,pt,bt){ct=ct._reactInternals;var It=Ys(),Gt=nc(ct),ir=Ra(It,Gt);ir.payload=pt,bt!=null&&(ir.callback=bt),pt=Va(ct,ir,Gt),pt!==null&&(Al(pt,ct,Gt,It),vl(pt,ct,Gt))},enqueueReplaceState:function(ct,pt,bt){ct=ct._reactInternals;var It=Ys(),Gt=nc(ct),ir=Ra(It,Gt);ir.tag=1,ir.payload=pt,bt!=null&&(ir.callback=bt),pt=Va(ct,ir,Gt),pt!==null&&(Al(pt,ct,Gt,It),vl(pt,ct,Gt))},enqueueForceUpdate:function(ct,pt){ct=ct._reactInternals;var bt=Ys(),It=nc(ct),Gt=Ra(bt,It);Gt.tag=2,pt!=null&&(Gt.callback=pt),pt=Va(ct,Gt,It),pt!==null&&(Al(pt,ct,It,bt),vl(pt,ct,It))}};function Vt(ct,pt,bt,It,Gt,ir,wr){return ct=ct.stateNode,typeof ct.shouldComponentUpdate=="function"?ct.shouldComponentUpdate(It,ir,wr):pt.prototype&&pt.prototype.isPureReactComponent?!$r(bt,It)||!$r(Gt,ir):!0}function tr(ct,pt,bt){var It=!1,Gt=mo,ir=pt.contextType;return typeof ir=="object"&&ir!==null?ir=Fs(ir):(Gt=As(pt)?gl:es.current,It=pt.contextTypes,ir=(It=It!=null)?Ql(ct,Gt):mo),pt=new pt(bt,ir),ct.memoizedState=pt.state!==null&&pt.state!==void 0?pt.state:null,pt.updater=Ct,ct.stateNode=pt,pt._reactInternals=ct,It&&(ct=ct.stateNode,ct.__reactInternalMemoizedUnmaskedChildContext=Gt,ct.__reactInternalMemoizedMaskedChildContext=ir),pt}function vr(ct,pt,bt,It){ct=pt.state,typeof pt.componentWillReceiveProps=="function"&&pt.componentWillReceiveProps(bt,It),typeof pt.UNSAFE_componentWillReceiveProps=="function"&&pt.UNSAFE_componentWillReceiveProps(bt,It),pt.state!==ct&&Ct.enqueueReplaceState(pt,pt.state,null)}function Cr(ct,pt,bt,It){var Gt=ct.stateNode;Gt.props=bt,Gt.state=ct.memoizedState,Gt.refs={},Ha(ct);var ir=pt.contextType;typeof ir=="object"&&ir!==null?Gt.context=Fs(ir):(ir=As(pt)?gl:es.current,Gt.context=Ql(ct,ir)),Gt.state=ct.memoizedState,ir=pt.getDerivedStateFromProps,typeof ir=="function"&&(yt(ct,pt,ir,bt),Gt.state=ct.memoizedState),typeof pt.getDerivedStateFromProps=="function"||typeof Gt.getSnapshotBeforeUpdate=="function"||typeof Gt.UNSAFE_componentWillMount!="function"&&typeof Gt.componentWillMount!="function"||(pt=Gt.state,typeof Gt.componentWillMount=="function"&&Gt.componentWillMount(),typeof Gt.UNSAFE_componentWillMount=="function"&&Gt.UNSAFE_componentWillMount(),pt!==Gt.state&&Ct.enqueueReplaceState(Gt,Gt.state,null),Jl(ct,bt,Gt,It),Gt.state=ct.memoizedState),typeof Gt.componentDidMount=="function"&&(ct.flags|=4194308)}function Vr(ct,pt){try{var bt="",It=pt;do bt+=lr(It),It=It.return;while(It);var Gt=bt}catch(ir){Gt=`
Error generating stack: `+ir.message+`
`+ir.stack}return{value:ct,source:pt,stack:Gt,digest:null}}function Un(ct,pt,bt){return{value:ct,source:null,stack:bt??null,digest:pt??null}}function Yn(ct,pt){try{console.error(pt.value)}catch(bt){setTimeout(function(){throw bt})}}var ei=typeof WeakMap=="function"?WeakMap:Map;function xi(ct,pt,bt){bt=Ra(-1,bt),bt.tag=3,bt.payload={element:null};var It=pt.value;return bt.callback=function(){ud||(ud=!0,Zd=It),Yn(ct,pt)},bt}function Jn(ct,pt,bt){bt=Ra(-1,bt),bt.tag=3;var It=ct.type.getDerivedStateFromError;if(typeof It=="function"){var Gt=pt.value;bt.payload=function(){return It(Gt)},bt.callback=function(){Yn(ct,pt)}}var ir=ct.stateNode;return ir!==null&&typeof ir.componentDidCatch=="function"&&(bt.callback=function(){Yn(ct,pt),typeof It!="function"&&(tc===null?tc=new Set([this]):tc.add(this));var wr=pt.stack;this.componentDidCatch(pt.value,{componentStack:wr!==null?wr:""})}),bt}function ui(ct,pt,bt){var It=ct.pingCache;if(It===null){It=ct.pingCache=new ei;var Gt=new Set;It.set(pt,Gt)}else Gt=It.get(pt),Gt===void 0&&(Gt=new Set,It.set(pt,Gt));Gt.has(bt)||(Gt.add(bt),ct=pp.bind(null,ct,pt,bt),pt.then(ct,ct))}function Ii(ct){do{var pt;if((pt=ct.tag===13)&&(pt=ct.memoizedState,pt=pt!==null?pt.dehydrated!==null:!0),pt)return ct;ct=ct.return}while(ct!==null);return null}function Vi(ct,pt,bt,It,Gt){return(ct.mode&1)===0?(ct===pt?ct.flags|=65536:(ct.flags|=128,bt.flags|=131072,bt.flags&=-52805,bt.tag===1&&(bt.alternate===null?bt.tag=17:(pt=Ra(-1,1),pt.tag=2,Va(bt,pt,1))),bt.lanes|=1),ct):(ct.flags|=65536,ct.lanes=Gt,ct)}var ti=Pt.ReactCurrentOwner,Xr=!1;function Wn(ct,pt,bt,It){pt.child=ct===null?xc(pt,null,bt,It):_l(pt,ct.child,bt,It)}function si(ct,pt,bt,It,Gt){bt=bt.render;var ir=pt.ref;return wu(pt,Gt),It=Rc(ct,pt,bt,It,ir,Gt),bt=nl(),ct!==null&&!Xr?(pt.updateQueue=ct.updateQueue,pt.flags&=-2053,ct.lanes&=~Gt,Ru(ct,pt,Gt)):(Aa&&bt&&Zu(pt),pt.flags|=1,Wn(ct,pt,It,Gt),pt.child)}function Di(ct,pt,bt,It,Gt){if(ct===null){var ir=bt.type;return typeof ir=="function"&&!tf(ir)&&ir.defaultProps===void 0&&bt.compare===null&&bt.defaultProps===void 0?(pt.tag=15,pt.type=ir,aa(ct,pt,ir,It,Gt)):(ct=md(bt.type,null,It,pt,pt.mode,Gt),ct.ref=pt.ref,ct.return=pt,pt.child=ct)}if(ir=ct.child,(ct.lanes&Gt)===0){var wr=ir.memoizedProps;if(bt=bt.compare,bt=bt!==null?bt:$r,bt(wr,It)&&ct.ref===pt.ref)return Ru(ct,pt,Gt)}return pt.flags|=1,ct=ac(ir,It),ct.ref=pt.ref,ct.return=pt,pt.child=ct}function aa(ct,pt,bt,It,Gt){if(ct!==null){var ir=ct.memoizedProps;if($r(ir,It)&&ct.ref===pt.ref)if(Xr=!1,pt.pendingProps=It=ir,(ct.lanes&Gt)!==0)(ct.flags&131072)!==0&&(Xr=!0);else return pt.lanes=ct.lanes,Ru(ct,pt,Gt)}return rs(ct,pt,bt,It,Gt)}function Ci(ct,pt,bt){var It=pt.pendingProps,Gt=It.children,ir=ct!==null?ct.memoizedState:null;if(It.mode==="hidden")if((pt.mode&1)===0)pt.memoizedState={baseLanes:0,cachePool:null,transitions:null},da(ah,Uo),Uo|=bt;else{if((bt&1073741824)===0)return ct=ir!==null?ir.baseLanes|bt:bt,pt.lanes=pt.childLanes=1073741824,pt.memoizedState={baseLanes:ct,cachePool:null,transitions:null},pt.updateQueue=null,da(ah,Uo),Uo|=ct,null;pt.memoizedState={baseLanes:0,cachePool:null,transitions:null},It=ir!==null?ir.baseLanes:bt,da(ah,Uo),Uo|=It}else ir!==null?(It=ir.baseLanes|bt,pt.memoizedState=null):It=bt,da(ah,Uo),Uo|=It;return Wn(ct,pt,Gt,bt),pt.child}function ra(ct,pt){var bt=pt.ref;(ct===null&&bt!==null||ct!==null&&ct.ref!==bt)&&(pt.flags|=512,pt.flags|=2097152)}function rs(ct,pt,bt,It,Gt){var ir=As(bt)?gl:es.current;return ir=Ql(pt,ir),wu(pt,Gt),bt=Rc(ct,pt,bt,It,ir,Gt),It=nl(),ct!==null&&!Xr?(pt.updateQueue=ct.updateQueue,pt.flags&=-2053,ct.lanes&=~Gt,Ru(ct,pt,Gt)):(Aa&&It&&Zu(pt),pt.flags|=1,Wn(ct,pt,bt,Gt),pt.child)}function sa(ct,pt,bt,It,Gt){if(As(bt)){var ir=!0;Vu(pt)}else ir=!1;if(wu(pt,Gt),pt.stateNode===null)id(ct,pt),tr(pt,bt,It),Cr(pt,bt,It,Gt),It=!0;else if(ct===null){var wr=pt.stateNode,Or=pt.memoizedProps;wr.props=Or;var zr=wr.context,Hn=bt.contextType;typeof Hn=="object"&&Hn!==null?Hn=Fs(Hn):(Hn=As(bt)?gl:es.current,Hn=Ql(pt,Hn));var ai=bt.getDerivedStateFromProps,li=typeof ai=="function"||typeof wr.getSnapshotBeforeUpdate=="function";li||typeof wr.UNSAFE_componentWillReceiveProps!="function"&&typeof wr.componentWillReceiveProps!="function"||(Or!==It||zr!==Hn)&&vr(pt,wr,It,Hn),Hi=!1;var ii=pt.memoizedState;wr.state=ii,Jl(pt,It,wr,Gt),zr=pt.memoizedState,Or!==It||ii!==zr||cs.current||Hi?(typeof ai=="function"&&(yt(pt,bt,ai,It),zr=pt.memoizedState),(Or=Hi||Vt(pt,bt,Or,It,ii,zr,Hn))?(li||typeof wr.UNSAFE_componentWillMount!="function"&&typeof wr.componentWillMount!="function"||(typeof wr.componentWillMount=="function"&&wr.componentWillMount(),typeof wr.UNSAFE_componentWillMount=="function"&&wr.UNSAFE_componentWillMount()),typeof wr.componentDidMount=="function"&&(pt.flags|=4194308)):(typeof wr.componentDidMount=="function"&&(pt.flags|=4194308),pt.memoizedProps=It,pt.memoizedState=zr),wr.props=It,wr.state=zr,wr.context=Hn,It=Or):(typeof wr.componentDidMount=="function"&&(pt.flags|=4194308),It=!1)}else{wr=pt.stateNode,za(ct,pt),Or=pt.memoizedProps,Hn=pt.type===pt.elementType?Or:_t(pt.type,Or),wr.props=Hn,li=pt.pendingProps,ii=wr.context,zr=bt.contextType,typeof zr=="object"&&zr!==null?zr=Fs(zr):(zr=As(bt)?gl:es.current,zr=Ql(pt,zr));var Si=bt.getDerivedStateFromProps;(ai=typeof Si=="function"||typeof wr.getSnapshotBeforeUpdate=="function")||typeof wr.UNSAFE_componentWillReceiveProps!="function"&&typeof wr.componentWillReceiveProps!="function"||(Or!==li||ii!==zr)&&vr(pt,wr,It,zr),Hi=!1,ii=pt.memoizedState,wr.state=ii,Jl(pt,It,wr,Gt);var Pi=pt.memoizedState;Or!==li||ii!==Pi||cs.current||Hi?(typeof Si=="function"&&(yt(pt,bt,Si,It),Pi=pt.memoizedState),(Hn=Hi||Vt(pt,bt,Hn,It,ii,Pi,zr)||!1)?(ai||typeof wr.UNSAFE_componentWillUpdate!="function"&&typeof wr.componentWillUpdate!="function"||(typeof wr.componentWillUpdate=="function"&&wr.componentWillUpdate(It,Pi,zr),typeof wr.UNSAFE_componentWillUpdate=="function"&&wr.UNSAFE_componentWillUpdate(It,Pi,zr)),typeof wr.componentDidUpdate=="function"&&(pt.flags|=4),typeof wr.getSnapshotBeforeUpdate=="function"&&(pt.flags|=1024)):(typeof wr.componentDidUpdate!="function"||Or===ct.memoizedProps&&ii===ct.memoizedState||(pt.flags|=4),typeof wr.getSnapshotBeforeUpdate!="function"||Or===ct.memoizedProps&&ii===ct.memoizedState||(pt.flags|=1024),pt.memoizedProps=It,pt.memoizedState=Pi),wr.props=It,wr.state=Pi,wr.context=zr,It=Hn):(typeof wr.componentDidUpdate!="function"||Or===ct.memoizedProps&&ii===ct.memoizedState||(pt.flags|=4),typeof wr.getSnapshotBeforeUpdate!="function"||Or===ct.memoizedProps&&ii===ct.memoizedState||(pt.flags|=1024),It=!1)}return il(ct,pt,bt,It,ir,Gt)}function il(ct,pt,bt,It,Gt,ir){ra(ct,pt);var wr=(pt.flags&128)!==0;if(!It&&!wr)return Gt&&xh(pt,bt,!1),Ru(ct,pt,ir);It=pt.stateNode,ti.current=pt;var Or=wr&&typeof bt.getDerivedStateFromError!="function"?null:It.render();return pt.flags|=1,ct!==null&&wr?(pt.child=_l(pt,ct.child,null,ir),pt.child=_l(pt,null,Or,ir)):Wn(ct,pt,Or,ir),pt.memoizedState=It.state,Gt&&xh(pt,bt,!0),pt.child}function rd(ct){var pt=ct.stateNode;pt.pendingContext?_c(ct,pt.pendingContext,pt.pendingContext!==pt.context):pt.context&&_c(ct,pt.context,!1),Tc(ct,pt.containerInfo)}function _f(ct,pt,bt,It,Gt){return yu(),So(Gt),pt.flags|=256,Wn(ct,pt,bt,It),pt.child}var Ld={dehydrated:null,treeContext:null,retryLane:0};function Fd(ct){return{baseLanes:ct,cachePool:null,transitions:null}}function yf(ct,pt,bt){var It=pt.pendingProps,Gt=Ta.current,ir=!1,wr=(pt.flags&128)!==0,Or;if((Or=wr)||(Or=ct!==null&&ct.memoizedState===null?!1:(Gt&2)!==0),Or?(ir=!0,pt.flags&=-129):(ct===null||ct.memoizedState!==null)&&(Gt|=1),da(Ta,Gt&1),ct===null)return wo(pt),ct=pt.memoizedState,ct!==null&&(ct=ct.dehydrated,ct!==null)?((pt.mode&1)===0?pt.lanes=1:ct.data==="$!"?pt.lanes=8:pt.lanes=1073741824,null):(wr=It.children,ct=It.fallback,ir?(It=pt.mode,ir=pt.child,wr={mode:"hidden",children:wr},(It&1)===0&&ir!==null?(ir.childLanes=0,ir.pendingProps=wr):ir=gd(wr,It,0,null),ct=Lc(ct,It,bt,null),ir.return=pt,ct.return=pt,ir.sibling=ct,pt.child=ir,pt.child.memoizedState=Fd(bt),pt.memoizedState=Ld,ct):Nd(pt,wr));if(Gt=ct.memoizedState,Gt!==null&&(Or=Gt.dehydrated,Or!==null))return rp(ct,pt,wr,It,Or,Gt,bt);if(ir){ir=It.fallback,wr=pt.mode,Gt=ct.child,Or=Gt.sibling;var zr={mode:"hidden",children:It.children};return(wr&1)===0&&pt.child!==Gt?(It=pt.child,It.childLanes=0,It.pendingProps=zr,pt.deletions=null):(It=ac(Gt,zr),It.subtreeFlags=Gt.subtreeFlags&14680064),Or!==null?ir=ac(Or,ir):(ir=Lc(ir,wr,bt,null),ir.flags|=2),ir.return=pt,It.return=pt,It.sibling=ir,pt.child=It,It=ir,ir=pt.child,wr=ct.child.memoizedState,wr=wr===null?Fd(bt):{baseLanes:wr.baseLanes|bt,cachePool:null,transitions:wr.transitions},ir.memoizedState=wr,ir.childLanes=ct.childLanes&~bt,pt.memoizedState=Ld,It}return ir=ct.child,ct=ir.sibling,It=ac(ir,{mode:"visible",children:It.children}),(pt.mode&1)===0&&(It.lanes=bt),It.return=pt,It.sibling=null,ct!==null&&(bt=pt.deletions,bt===null?(pt.deletions=[ct],pt.flags|=16):bt.push(ct)),pt.child=It,pt.memoizedState=null,It}function Nd(ct,pt){return pt=gd({mode:"visible",children:pt},ct.mode,0,null),pt.return=ct,ct.child=pt}function nd(ct,pt,bt,It){return It!==null&&So(It),_l(pt,ct.child,null,bt),ct=Nd(pt,pt.pendingProps.children),ct.flags|=2,pt.memoizedState=null,ct}function rp(ct,pt,bt,It,Gt,ir,wr){if(bt)return pt.flags&256?(pt.flags&=-257,It=Un(Error(rt(422))),nd(ct,pt,wr,It)):pt.memoizedState!==null?(pt.child=ct.child,pt.flags|=128,null):(ir=It.fallback,Gt=pt.mode,It=gd({mode:"visible",children:It.children},Gt,0,null),ir=Lc(ir,Gt,wr,null),ir.flags|=2,It.return=pt,ir.return=pt,It.sibling=ir,pt.child=It,(pt.mode&1)!==0&&_l(pt,ct.child,null,wr),pt.child.memoizedState=Fd(wr),pt.memoizedState=Ld,ir);if((pt.mode&1)===0)return nd(ct,pt,wr,null);if(Gt.data==="$!"){if(It=Gt.nextSibling&&Gt.nextSibling.dataset,It)var Or=It.dgst;return It=Or,ir=Error(rt(419)),It=Un(ir,It,void 0),nd(ct,pt,wr,It)}if(Or=(wr&ct.childLanes)!==0,Xr||Or){if(It=xs,It!==null){switch(wr&-wr){case 4:Gt=2;break;case 16:Gt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Gt=32;break;case 536870912:Gt=268435456;break;default:Gt=0}Gt=(Gt&(It.suspendedLanes|wr))!==0?0:Gt,Gt!==0&&Gt!==ir.retryLane&&(ir.retryLane=Gt,ga(ct,Gt),Al(It,ct,Gt,-1))}return ef(),It=Un(Error(rt(421))),nd(ct,pt,wr,It)}return Gt.data==="$?"?(pt.flags|=128,pt.child=ct.child,pt=mp.bind(null,ct),Gt._reactRetry=pt,null):(ct=ir.treeContext,Ls=pl(Gt.nextSibling),Ds=pt,Aa=!0,Vs=null,ct!==null&&(va[bo++]=Bs,va[bo++]=tl,va[bo++]=Ei,Bs=ct.id,tl=ct.overflow,Ei=pt),pt=Nd(pt,It.children),pt.flags|=4096,pt)}function vf(ct,pt,bt){ct.lanes|=pt;var It=ct.alternate;It!==null&&(It.lanes|=pt),Sc(ct.return,pt,bt)}function Ud(ct,pt,bt,It,Gt){var ir=ct.memoizedState;ir===null?ct.memoizedState={isBackwards:pt,rendering:null,renderingStartTime:0,last:It,tail:bt,tailMode:Gt}:(ir.isBackwards=pt,ir.rendering=null,ir.renderingStartTime=0,ir.last=It,ir.tail=bt,ir.tailMode=Gt)}function bf(ct,pt,bt){var It=pt.pendingProps,Gt=It.revealOrder,ir=It.tail;if(Wn(ct,pt,It.children,bt),It=Ta.current,(It&2)!==0)It=It&1|2,pt.flags|=128;else{if(ct!==null&&(ct.flags&128)!==0)e:for(ct=pt.child;ct!==null;){if(ct.tag===13)ct.memoizedState!==null&&vf(ct,bt,pt);else if(ct.tag===19)vf(ct,bt,pt);else if(ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===pt)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===pt)break e;ct=ct.return}ct.sibling.return=ct.return,ct=ct.sibling}It&=1}if(da(Ta,It),(pt.mode&1)===0)pt.memoizedState=null;else switch(Gt){case"forwards":for(bt=pt.child,Gt=null;bt!==null;)ct=bt.alternate,ct!==null&&Qu(ct)===null&&(Gt=bt),bt=bt.sibling;bt=Gt,bt===null?(Gt=pt.child,pt.child=null):(Gt=bt.sibling,bt.sibling=null),Ud(pt,!1,Gt,bt,ir);break;case"backwards":for(bt=null,Gt=pt.child,pt.child=null;Gt!==null;){if(ct=Gt.alternate,ct!==null&&Qu(ct)===null){pt.child=Gt;break}ct=Gt.sibling,Gt.sibling=bt,bt=Gt,Gt=ct}Ud(pt,!0,bt,null,ir);break;case"together":Ud(pt,!1,null,null,void 0);break;default:pt.memoizedState=null}return pt.child}function id(ct,pt){(pt.mode&1)===0&&ct!==null&&(ct.alternate=null,pt.alternate=null,pt.flags|=2)}function Ru(ct,pt,bt){if(ct!==null&&(pt.dependencies=ct.dependencies),kc|=pt.lanes,(bt&pt.childLanes)===0)return null;if(ct!==null&&pt.child!==ct.child)throw Error(rt(153));if(pt.child!==null){for(ct=pt.child,bt=ac(ct,ct.pendingProps),pt.child=bt,bt.return=pt;ct.sibling!==null;)ct=ct.sibling,bt=bt.sibling=ac(ct,ct.pendingProps),bt.return=pt;bt.sibling=null}return pt.child}function np(ct,pt,bt){switch(pt.tag){case 3:rd(pt),yu();break;case 5:Su(pt);break;case 1:As(pt.type)&&Vu(pt);break;case 4:Tc(pt,pt.stateNode.containerInfo);break;case 10:var It=pt.type._context,Gt=pt.memoizedProps.value;da(vu,It._currentValue),It._currentValue=Gt;break;case 13:if(It=pt.memoizedState,It!==null)return It.dehydrated!==null?(da(Ta,Ta.current&1),pt.flags|=128,null):(bt&pt.child.childLanes)!==0?yf(ct,pt,bt):(da(Ta,Ta.current&1),ct=Ru(ct,pt,bt),ct!==null?ct.sibling:null);da(Ta,Ta.current&1);break;case 19:if(It=(bt&pt.childLanes)!==0,(ct.flags&128)!==0){if(It)return bf(ct,pt,bt);pt.flags|=128}if(Gt=pt.memoizedState,Gt!==null&&(Gt.rendering=null,Gt.tail=null,Gt.lastEffect=null),da(Ta,Ta.current),It)break;return null;case 22:case 23:return pt.lanes=0,Ci(ct,pt,bt)}return Ru(ct,pt,bt)}var xf,$d,wf,Ef;xf=function(ct,pt){for(var bt=pt.child;bt!==null;){if(bt.tag===5||bt.tag===6)ct.appendChild(bt.stateNode);else if(bt.tag!==4&&bt.child!==null){bt.child.return=bt,bt=bt.child;continue}if(bt===pt)break;for(;bt.sibling===null;){if(bt.return===null||bt.return===pt)return;bt=bt.return}bt.sibling.return=bt.return,bt=bt.sibling}},$d=function(){},wf=function(ct,pt,bt,It){var Gt=ct.memoizedProps;if(Gt!==It){ct=pt.stateNode,xl(To.current);var ir=null;switch(bt){case"input":Gt=ar(ct,Gt),It=ar(ct,It),ir=[];break;case"select":Gt=Yt({},Gt,{value:void 0}),It=Yt({},It,{value:void 0}),ir=[];break;case"textarea":Gt=kr(ct,Gt),It=kr(ct,It),ir=[];break;default:typeof Gt.onClick!="function"&&typeof It.onClick=="function"&&(ct.onclick=mc)}_r(bt,It);var wr;bt=null;for(Hn in Gt)if(!It.hasOwnProperty(Hn)&&Gt.hasOwnProperty(Hn)&&Gt[Hn]!=null)if(Hn==="style"){var Or=Gt[Hn];for(wr in Or)Or.hasOwnProperty(wr)&&(bt||(bt={}),bt[wr]="")}else Hn!=="dangerouslySetInnerHTML"&&Hn!=="children"&&Hn!=="suppressContentEditableWarning"&&Hn!=="suppressHydrationWarning"&&Hn!=="autoFocus"&&(it.hasOwnProperty(Hn)?ir||(ir=[]):(ir=ir||[]).push(Hn,null));for(Hn in It){var zr=It[Hn];if(Or=Gt?.[Hn],It.hasOwnProperty(Hn)&&zr!==Or&&(zr!=null||Or!=null))if(Hn==="style")if(Or){for(wr in Or)!Or.hasOwnProperty(wr)||zr&&zr.hasOwnProperty(wr)||(bt||(bt={}),bt[wr]="");for(wr in zr)zr.hasOwnProperty(wr)&&Or[wr]!==zr[wr]&&(bt||(bt={}),bt[wr]=zr[wr])}else bt||(ir||(ir=[]),ir.push(Hn,bt)),bt=zr;else Hn==="dangerouslySetInnerHTML"?(zr=zr?zr.__html:void 0,Or=Or?Or.__html:void 0,zr!=null&&Or!==zr&&(ir=ir||[]).push(Hn,zr)):Hn==="children"?typeof zr!="string"&&typeof zr!="number"||(ir=ir||[]).push(Hn,""+zr):Hn!=="suppressContentEditableWarning"&&Hn!=="suppressHydrationWarning"&&(it.hasOwnProperty(Hn)?(zr!=null&&Hn==="onScroll"&&Ea("scroll",ct),ir||Or===zr||(ir=[])):(ir=ir||[]).push(Hn,zr))}bt&&(ir=ir||[]).push("style",bt);var Hn=ir;(pt.updateQueue=Hn)&&(pt.flags|=4)}},Ef=function(ct,pt,bt,It){bt!==It&&(pt.flags|=4)};function Lh(ct,pt){if(!Aa)switch(ct.tailMode){case"hidden":pt=ct.tail;for(var bt=null;pt!==null;)pt.alternate!==null&&(bt=pt),pt=pt.sibling;bt===null?ct.tail=null:bt.sibling=null;break;case"collapsed":bt=ct.tail;for(var It=null;bt!==null;)bt.alternate!==null&&(It=bt),bt=bt.sibling;It===null?pt||ct.tail===null?ct.tail=null:ct.tail.sibling=null:It.sibling=null}}function Us(ct){var pt=ct.alternate!==null&&ct.alternate.child===ct.child,bt=0,It=0;if(pt)for(var Gt=ct.child;Gt!==null;)bt|=Gt.lanes|Gt.childLanes,It|=Gt.subtreeFlags&14680064,It|=Gt.flags&14680064,Gt.return=ct,Gt=Gt.sibling;else for(Gt=ct.child;Gt!==null;)bt|=Gt.lanes|Gt.childLanes,It|=Gt.subtreeFlags,It|=Gt.flags,Gt.return=ct,Gt=Gt.sibling;return ct.subtreeFlags|=It,ct.childLanes=bt,pt}function ip(ct,pt,bt){var It=pt.pendingProps;switch(yc(pt),pt.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Us(pt),null;case 1:return As(pt.type)&&Hu(),Us(pt),null;case 3:return It=pt.stateNode,Ws(),Sa(cs),Sa(es),Ku(),It.pendingContext&&(It.context=It.pendingContext,It.pendingContext=null),(ct===null||ct.child===null)&&(vc(pt)?pt.flags|=4:ct===null||ct.memoizedState.isDehydrated&&(pt.flags&256)===0||(pt.flags|=1024,Vs!==null&&(Qd(Vs),Vs=null))),$d(ct,pt),Us(pt),null;case 5:Qc(pt);var Gt=xl(hs.current);if(bt=pt.type,ct!==null&&pt.stateNode!=null)wf(ct,pt,bt,It,Gt),ct.ref!==pt.ref&&(pt.flags|=512,pt.flags|=2097152);else{if(!It){if(pt.stateNode===null)throw Error(rt(166));return Us(pt),null}if(ct=xl(To.current),vc(pt)){It=pt.stateNode,bt=pt.type;var ir=pt.memoizedProps;switch(It[Bo]=pt,It[gc]=ir,ct=(pt.mode&1)!==0,bt){case"dialog":Ea("cancel",It),Ea("close",It);break;case"iframe":case"object":case"embed":Ea("load",It);break;case"video":case"audio":for(Gt=0;Gt<Zl.length;Gt++)Ea(Zl[Gt],It);break;case"source":Ea("error",It);break;case"img":case"image":case"link":Ea("error",It),Ea("load",It);break;case"details":Ea("toggle",It);break;case"input":nr(It,ir),Ea("invalid",It);break;case"select":It._wrapperState={wasMultiple:!!ir.multiple},Ea("invalid",It);break;case"textarea":Br(It,ir),Ea("invalid",It)}_r(bt,ir),Gt=null;for(var wr in ir)if(ir.hasOwnProperty(wr)){var Or=ir[wr];wr==="children"?typeof Or=="string"?It.textContent!==Or&&(ir.suppressHydrationWarning!==!0&&pc(It.textContent,Or,ct),Gt=["children",Or]):typeof Or=="number"&&It.textContent!==""+Or&&(ir.suppressHydrationWarning!==!0&&pc(It.textContent,Or,ct),Gt=["children",""+Or]):it.hasOwnProperty(wr)&&Or!=null&&wr==="onScroll"&&Ea("scroll",It)}switch(bt){case"input":Nt(It),Ut(It,ir,!0);break;case"textarea":Nt(It),Xn(It);break;case"select":case"option":break;default:typeof ir.onClick=="function"&&(It.onclick=mc)}It=Gt,pt.updateQueue=It,It!==null&&(pt.flags|=4)}else{wr=Gt.nodeType===9?Gt:Gt.ownerDocument,ct==="http://www.w3.org/1999/xhtml"&&(ct=Mn(bt)),ct==="http://www.w3.org/1999/xhtml"?bt==="script"?(ct=wr.createElement("div"),ct.innerHTML="<script><\/script>",ct=ct.removeChild(ct.firstChild)):typeof It.is=="string"?ct=wr.createElement(bt,{is:It.is}):(ct=wr.createElement(bt),bt==="select"&&(wr=ct,It.multiple?wr.multiple=!0:It.size&&(wr.size=It.size))):ct=wr.createElementNS(ct,bt),ct[Bo]=pt,ct[gc]=It,xf(ct,pt,!1,!1),pt.stateNode=ct;e:{switch(wr=Rr(bt,It),bt){case"dialog":Ea("cancel",ct),Ea("close",ct),Gt=It;break;case"iframe":case"object":case"embed":Ea("load",ct),Gt=It;break;case"video":case"audio":for(Gt=0;Gt<Zl.length;Gt++)Ea(Zl[Gt],ct);Gt=It;break;case"source":Ea("error",ct),Gt=It;break;case"img":case"image":case"link":Ea("error",ct),Ea("load",ct),Gt=It;break;case"details":Ea("toggle",ct),Gt=It;break;case"input":nr(ct,It),Gt=ar(ct,It),Ea("invalid",ct);break;case"option":Gt=It;break;case"select":ct._wrapperState={wasMultiple:!!It.multiple},Gt=Yt({},It,{value:void 0}),Ea("invalid",ct);break;case"textarea":Br(ct,It),Gt=kr(ct,It),Ea("invalid",ct);break;default:Gt=It}_r(bt,Gt),Or=Gt;for(ir in Or)if(Or.hasOwnProperty(ir)){var zr=Or[ir];ir==="style"?Tr(ct,zr):ir==="dangerouslySetInnerHTML"?(zr=zr?zr.__html:void 0,zr!=null&&vi(ct,zr)):ir==="children"?typeof zr=="string"?(bt!=="textarea"||zr!=="")&&mi(ct,zr):typeof zr=="number"&&mi(ct,""+zr):ir!=="suppressContentEditableWarning"&&ir!=="suppressHydrationWarning"&&ir!=="autoFocus"&&(it.hasOwnProperty(ir)?zr!=null&&ir==="onScroll"&&Ea("scroll",ct):zr!=null&&Tt(ct,ir,zr,wr))}switch(bt){case"input":Nt(ct),Ut(ct,It,!1);break;case"textarea":Nt(ct),Xn(ct);break;case"option":It.value!=null&&ct.setAttribute("value",""+Sr(It.value));break;case"select":ct.multiple=!!It.multiple,ir=It.value,ir!=null?hr(ct,!!It.multiple,ir,!1):It.defaultValue!=null&&hr(ct,!!It.multiple,It.defaultValue,!0);break;default:typeof Gt.onClick=="function"&&(ct.onclick=mc)}switch(bt){case"button":case"input":case"select":case"textarea":It=!!It.autoFocus;break e;case"img":It=!0;break e;default:It=!1}}It&&(pt.flags|=4)}pt.ref!==null&&(pt.flags|=512,pt.flags|=2097152)}return Us(pt),null;case 6:if(ct&&pt.stateNode!=null)Ef(ct,pt,ct.memoizedProps,It);else{if(typeof It!="string"&&pt.stateNode===null)throw Error(rt(166));if(bt=xl(hs.current),xl(To.current),vc(pt)){if(It=pt.stateNode,bt=pt.memoizedProps,It[Bo]=pt,(ir=It.nodeValue!==bt)&&(ct=Ds,ct!==null))switch(ct.tag){case 3:pc(It.nodeValue,bt,(ct.mode&1)!==0);break;case 5:ct.memoizedProps.suppressHydrationWarning!==!0&&pc(It.nodeValue,bt,(ct.mode&1)!==0)}ir&&(pt.flags|=4)}else It=(bt.nodeType===9?bt:bt.ownerDocument).createTextNode(It),It[Bo]=pt,pt.stateNode=It}return Us(pt),null;case 13:if(Sa(Ta),It=pt.memoizedState,ct===null||ct.memoizedState!==null&&ct.memoizedState.dehydrated!==null){if(Aa&&Ls!==null&&(pt.mode&1)!==0&&(pt.flags&128)===0)Eo(),yu(),pt.flags|=98560,ir=!1;else if(ir=vc(pt),It!==null&&It.dehydrated!==null){if(ct===null){if(!ir)throw Error(rt(318));if(ir=pt.memoizedState,ir=ir!==null?ir.dehydrated:null,!ir)throw Error(rt(317));ir[Bo]=pt}else yu(),(pt.flags&128)===0&&(pt.memoizedState=null),pt.flags|=4;Us(pt),ir=!1}else Vs!==null&&(Qd(Vs),Vs=null),ir=!0;if(!ir)return pt.flags&65536?pt:null}return(pt.flags&128)!==0?(pt.lanes=bt,pt):(It=It!==null,It!==(ct!==null&&ct.memoizedState!==null)&&It&&(pt.child.flags|=8192,(pt.mode&1)!==0&&(ct===null||(Ta.current&1)!==0?fs===0&&(fs=3):ef())),pt.updateQueue!==null&&(pt.flags|=4),Us(pt),null);case 4:return Ws(),$d(ct,pt),ct===null&&Fu(pt.stateNode.containerInfo),Us(pt),null;case 10:return Ec(pt.type._context),Us(pt),null;case 17:return As(pt.type)&&Hu(),Us(pt),null;case 19:if(Sa(Ta),ir=pt.memoizedState,ir===null)return Us(pt),null;if(It=(pt.flags&128)!==0,wr=ir.rendering,wr===null)if(It)Lh(ir,!1);else{if(fs!==0||ct!==null&&(ct.flags&128)!==0)for(ct=pt.child;ct!==null;){if(wr=Qu(ct),wr!==null){for(pt.flags|=128,Lh(ir,!1),It=wr.updateQueue,It!==null&&(pt.updateQueue=It,pt.flags|=4),pt.subtreeFlags=0,It=bt,bt=pt.child;bt!==null;)ir=bt,ct=It,ir.flags&=14680066,wr=ir.alternate,wr===null?(ir.childLanes=0,ir.lanes=ct,ir.child=null,ir.subtreeFlags=0,ir.memoizedProps=null,ir.memoizedState=null,ir.updateQueue=null,ir.dependencies=null,ir.stateNode=null):(ir.childLanes=wr.childLanes,ir.lanes=wr.lanes,ir.child=wr.child,ir.subtreeFlags=0,ir.deletions=null,ir.memoizedProps=wr.memoizedProps,ir.memoizedState=wr.memoizedState,ir.updateQueue=wr.updateQueue,ir.type=wr.type,ct=wr.dependencies,ir.dependencies=ct===null?null:{lanes:ct.lanes,firstContext:ct.firstContext}),bt=bt.sibling;return da(Ta,Ta.current&1|2),pt.child}ct=ct.sibling}ir.tail!==null&&ta()>sh&&(pt.flags|=128,It=!0,Lh(ir,!1),pt.lanes=4194304)}else{if(!It)if(ct=Qu(wr),ct!==null){if(pt.flags|=128,It=!0,bt=ct.updateQueue,bt!==null&&(pt.updateQueue=bt,pt.flags|=4),Lh(ir,!0),ir.tail===null&&ir.tailMode==="hidden"&&!wr.alternate&&!Aa)return Us(pt),null}else 2*ta()-ir.renderingStartTime>sh&&bt!==1073741824&&(pt.flags|=128,It=!0,Lh(ir,!1),pt.lanes=4194304);ir.isBackwards?(wr.sibling=pt.child,pt.child=wr):(bt=ir.last,bt!==null?bt.sibling=wr:pt.child=wr,ir.last=wr)}return ir.tail!==null?(pt=ir.tail,ir.rendering=pt,ir.tail=pt.sibling,ir.renderingStartTime=ta(),pt.sibling=null,bt=Ta.current,da(Ta,It?bt&1|2:bt&1),pt):(Us(pt),null);case 22:case 23:return Jd(),It=pt.memoizedState!==null,ct!==null&&ct.memoizedState!==null!==It&&(pt.flags|=8192),It&&(pt.mode&1)!==0?(Uo&1073741824)!==0&&(Us(pt),pt.subtreeFlags&6&&(pt.flags|=8192)):Us(pt),null;case 24:return null;case 25:return null}throw Error(rt(156,pt.tag))}function ap(ct,pt){switch(yc(pt),pt.tag){case 1:return As(pt.type)&&Hu(),ct=pt.flags,ct&65536?(pt.flags=ct&-65537|128,pt):null;case 3:return Ws(),Sa(cs),Sa(es),Ku(),ct=pt.flags,(ct&65536)!==0&&(ct&128)===0?(pt.flags=ct&-65537|128,pt):null;case 5:return Qc(pt),null;case 13:if(Sa(Ta),ct=pt.memoizedState,ct!==null&&ct.dehydrated!==null){if(pt.alternate===null)throw Error(rt(340));yu()}return ct=pt.flags,ct&65536?(pt.flags=ct&-65537|128,pt):null;case 19:return Sa(Ta),null;case 4:return Ws(),null;case 10:return Ec(pt.type._context),null;case 22:case 23:return Jd(),null;case 24:return null;default:return null}}var ad=!1,$s=!1,sp=typeof WeakSet=="function"?WeakSet:Set,Ai=null;function ih(ct,pt){var bt=ct.ref;if(bt!==null)if(typeof bt=="function")try{bt(null)}catch(It){qa(ct,pt,It)}else bt.current=null}function zd(ct,pt,bt){try{bt()}catch(It){qa(ct,pt,It)}}var Sf=!1;function op(ct,pt){if($u=ms,ct=Fr(),Lr(ct)){if("selectionStart"in ct)var bt={start:ct.selectionStart,end:ct.selectionEnd};else e:{bt=(bt=ct.ownerDocument)&&bt.defaultView||window;var It=bt.getSelection&&bt.getSelection();if(It&&It.rangeCount!==0){bt=It.anchorNode;var Gt=It.anchorOffset,ir=It.focusNode;It=It.focusOffset;try{bt.nodeType,ir.nodeType}catch{bt=null;break e}var wr=0,Or=-1,zr=-1,Hn=0,ai=0,li=ct,ii=null;t:for(;;){for(var Si;li!==bt||Gt!==0&&li.nodeType!==3||(Or=wr+Gt),li!==ir||It!==0&&li.nodeType!==3||(zr=wr+It),li.nodeType===3&&(wr+=li.nodeValue.length),(Si=li.firstChild)!==null;)ii=li,li=Si;for(;;){if(li===ct)break t;if(ii===bt&&++Hn===Gt&&(Or=wr),ii===ir&&++ai===It&&(zr=wr),(Si=li.nextSibling)!==null)break;li=ii,ii=li.parentNode}li=Si}bt=Or===-1||zr===-1?null:{start:Or,end:zr}}else bt=null}bt=bt||{start:0,end:0}}else bt=null;for(mh={focusedElem:ct,selectionRange:bt},ms=!1,Ai=pt;Ai!==null;)if(pt=Ai,ct=pt.child,(pt.subtreeFlags&1028)!==0&&ct!==null)ct.return=pt,Ai=ct;else for(;Ai!==null;){pt=Ai;try{var Pi=pt.alternate;if((pt.flags&1024)!==0)switch(pt.tag){case 0:case 11:case 15:break;case 1:if(Pi!==null){var Mi=Pi.memoizedProps,ns=Pi.memoizedState,Bn=pt.stateNode,Wr=Bn.getSnapshotBeforeUpdate(pt.elementType===pt.type?Mi:_t(pt.type,Mi),ns);Bn.__reactInternalSnapshotBeforeUpdate=Wr}break;case 3:var $n=pt.stateNode.containerInfo;$n.nodeType===1?$n.textContent="":$n.nodeType===9&&$n.documentElement&&$n.removeChild($n.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(rt(163))}}catch(fi){qa(pt,pt.return,fi)}if(ct=pt.sibling,ct!==null){ct.return=pt.return,Ai=ct;break}Ai=pt.return}return Pi=Sf,Sf=!1,Pi}function Fh(ct,pt,bt){var It=pt.updateQueue;if(It=It!==null?It.lastEffect:null,It!==null){var Gt=It=It.next;do{if((Gt.tag&ct)===ct){var ir=Gt.destroy;Gt.destroy=void 0,ir!==void 0&&zd(pt,bt,ir)}Gt=Gt.next}while(Gt!==It)}}function sd(ct,pt){if(pt=pt.updateQueue,pt=pt!==null?pt.lastEffect:null,pt!==null){var bt=pt=pt.next;do{if((bt.tag&ct)===ct){var It=bt.create;bt.destroy=It()}bt=bt.next}while(bt!==pt)}}function jd(ct){var pt=ct.ref;if(pt!==null){var bt=ct.stateNode;ct.tag,ct=bt,typeof pt=="function"?pt(ct):pt.current=ct}}function Tf(ct){var pt=ct.alternate;pt!==null&&(ct.alternate=null,Tf(pt)),ct.child=null,ct.deletions=null,ct.sibling=null,ct.tag===5&&(pt=ct.stateNode,pt!==null&&(delete pt[Bo],delete pt[gc],delete pt[ys],delete pt[Yh],delete pt[Xh])),ct.stateNode=null,ct.return=null,ct.dependencies=null,ct.memoizedProps=null,ct.memoizedState=null,ct.pendingProps=null,ct.stateNode=null,ct.updateQueue=null}function Af(ct){return ct.tag===5||ct.tag===3||ct.tag===4}function Rf(ct){e:for(;;){for(;ct.sibling===null;){if(ct.return===null||Af(ct.return))return null;ct=ct.return}for(ct.sibling.return=ct.return,ct=ct.sibling;ct.tag!==5&&ct.tag!==6&&ct.tag!==18;){if(ct.flags&2||ct.child===null||ct.tag===4)continue e;ct.child.return=ct,ct=ct.child}if(!(ct.flags&2))return ct.stateNode}}function Gd(ct,pt,bt){var It=ct.tag;if(It===5||It===6)ct=ct.stateNode,pt?bt.nodeType===8?bt.parentNode.insertBefore(ct,pt):bt.insertBefore(ct,pt):(bt.nodeType===8?(pt=bt.parentNode,pt.insertBefore(ct,bt)):(pt=bt,pt.appendChild(ct)),bt=bt._reactRootContainer,bt!=null||pt.onclick!==null||(pt.onclick=mc));else if(It!==4&&(ct=ct.child,ct!==null))for(Gd(ct,pt,bt),ct=ct.sibling;ct!==null;)Gd(ct,pt,bt),ct=ct.sibling}function Hd(ct,pt,bt){var It=ct.tag;if(It===5||It===6)ct=ct.stateNode,pt?bt.insertBefore(ct,pt):bt.appendChild(ct);else if(It!==4&&(ct=ct.child,ct!==null))for(Hd(ct,pt,bt),ct=ct.sibling;ct!==null;)Hd(ct,pt,bt),ct=ct.sibling}var Rs=null,Sl=!1;function ec(ct,pt,bt){for(bt=bt.child;bt!==null;)If(ct,pt,bt),bt=bt.sibling}function If(ct,pt,bt){if(qi&&typeof qi.onCommitFiberUnmount=="function")try{qi.onCommitFiberUnmount(Ps,bt)}catch{}switch(bt.tag){case 5:$s||ih(bt,pt);case 6:var It=Rs,Gt=Sl;Rs=null,ec(ct,pt,bt),Rs=It,Sl=Gt,Rs!==null&&(Sl?(ct=Rs,bt=bt.stateNode,ct.nodeType===8?ct.parentNode.removeChild(bt):ct.removeChild(bt)):Rs.removeChild(bt.stateNode));break;case 18:Rs!==null&&(Sl?(ct=Rs,bt=bt.stateNode,ct.nodeType===8?Vc(ct.parentNode,bt):ct.nodeType===1&&Vc(ct,bt),zs(ct)):Vc(Rs,bt.stateNode));break;case 4:It=Rs,Gt=Sl,Rs=bt.stateNode.containerInfo,Sl=!0,ec(ct,pt,bt),Rs=It,Sl=Gt;break;case 0:case 11:case 14:case 15:if(!$s&&(It=bt.updateQueue,It!==null&&(It=It.lastEffect,It!==null))){Gt=It=It.next;do{var ir=Gt,wr=ir.destroy;ir=ir.tag,wr!==void 0&&((ir&2)!==0||(ir&4)!==0)&&zd(bt,pt,wr),Gt=Gt.next}while(Gt!==It)}ec(ct,pt,bt);break;case 1:if(!$s&&(ih(bt,pt),It=bt.stateNode,typeof It.componentWillUnmount=="function"))try{It.props=bt.memoizedProps,It.state=bt.memoizedState,It.componentWillUnmount()}catch(Or){qa(bt,pt,Or)}ec(ct,pt,bt);break;case 21:ec(ct,pt,bt);break;case 22:bt.mode&1?($s=(It=$s)||bt.memoizedState!==null,ec(ct,pt,bt),$s=It):ec(ct,pt,bt);break;default:ec(ct,pt,bt)}}function Pf(ct){var pt=ct.updateQueue;if(pt!==null){ct.updateQueue=null;var bt=ct.stateNode;bt===null&&(bt=ct.stateNode=new sp),pt.forEach(function(It){var Gt=gp.bind(null,ct,It);bt.has(It)||(bt.add(It),It.then(Gt,Gt))})}}function Tl(ct,pt){var bt=pt.deletions;if(bt!==null)for(var It=0;It<bt.length;It++){var Gt=bt[It];try{var ir=ct,wr=pt,Or=wr;e:for(;Or!==null;){switch(Or.tag){case 5:Rs=Or.stateNode,Sl=!1;break e;case 3:Rs=Or.stateNode.containerInfo,Sl=!0;break e;case 4:Rs=Or.stateNode.containerInfo,Sl=!0;break e}Or=Or.return}if(Rs===null)throw Error(rt(160));If(ir,wr,Gt),Rs=null,Sl=!1;var zr=Gt.alternate;zr!==null&&(zr.return=null),Gt.return=null}catch(Hn){qa(Gt,pt,Hn)}}if(pt.subtreeFlags&12854)for(pt=pt.child;pt!==null;)Cf(pt,ct),pt=pt.sibling}function Cf(ct,pt){var bt=ct.alternate,It=ct.flags;switch(ct.tag){case 0:case 11:case 14:case 15:if(Tl(pt,ct),nu(ct),It&4){try{Fh(3,ct,ct.return),sd(3,ct)}catch(Mi){qa(ct,ct.return,Mi)}try{Fh(5,ct,ct.return)}catch(Mi){qa(ct,ct.return,Mi)}}break;case 1:Tl(pt,ct),nu(ct),It&512&&bt!==null&&ih(bt,bt.return);break;case 5:if(Tl(pt,ct),nu(ct),It&512&&bt!==null&&ih(bt,bt.return),ct.flags&32){var Gt=ct.stateNode;try{mi(Gt,"")}catch(Mi){qa(ct,ct.return,Mi)}}if(It&4&&(Gt=ct.stateNode,Gt!=null)){var ir=ct.memoizedProps,wr=bt!==null?bt.memoizedProps:ir,Or=ct.type,zr=ct.updateQueue;if(ct.updateQueue=null,zr!==null)try{Or==="input"&&ir.type==="radio"&&ir.name!=null&&ur(Gt,ir),Rr(Or,wr);var Hn=Rr(Or,ir);for(wr=0;wr<zr.length;wr+=2){var ai=zr[wr],li=zr[wr+1];ai==="style"?Tr(Gt,li):ai==="dangerouslySetInnerHTML"?vi(Gt,li):ai==="children"?mi(Gt,li):Tt(Gt,ai,li,Hn)}switch(Or){case"input":Er(Gt,ir);break;case"textarea":Gn(Gt,ir);break;case"select":var ii=Gt._wrapperState.wasMultiple;Gt._wrapperState.wasMultiple=!!ir.multiple;var Si=ir.value;Si!=null?hr(Gt,!!ir.multiple,Si,!1):ii!==!!ir.multiple&&(ir.defaultValue!=null?hr(Gt,!!ir.multiple,ir.defaultValue,!0):hr(Gt,!!ir.multiple,ir.multiple?[]:"",!1))}Gt[gc]=ir}catch(Mi){qa(ct,ct.return,Mi)}}break;case 6:if(Tl(pt,ct),nu(ct),It&4){if(ct.stateNode===null)throw Error(rt(162));Gt=ct.stateNode,ir=ct.memoizedProps;try{Gt.nodeValue=ir}catch(Mi){qa(ct,ct.return,Mi)}}break;case 3:if(Tl(pt,ct),nu(ct),It&4&&bt!==null&&bt.memoizedState.isDehydrated)try{zs(pt.containerInfo)}catch(Mi){qa(ct,ct.return,Mi)}break;case 4:Tl(pt,ct),nu(ct);break;case 13:Tl(pt,ct),nu(ct),Gt=ct.child,Gt.flags&8192&&(ir=Gt.memoizedState!==null,Gt.stateNode.isHidden=ir,!ir||Gt.alternate!==null&&Gt.alternate.memoizedState!==null||(qd=ta())),It&4&&Pf(ct);break;case 22:if(ai=bt!==null&&bt.memoizedState!==null,ct.mode&1?($s=(Hn=$s)||ai,Tl(pt,ct),$s=Hn):Tl(pt,ct),nu(ct),It&8192){if(Hn=ct.memoizedState!==null,(ct.stateNode.isHidden=Hn)&&!ai&&(ct.mode&1)!==0)for(Ai=ct,ai=ct.child;ai!==null;){for(li=Ai=ai;Ai!==null;){switch(ii=Ai,Si=ii.child,ii.tag){case 0:case 11:case 14:case 15:Fh(4,ii,ii.return);break;case 1:ih(ii,ii.return);var Pi=ii.stateNode;if(typeof Pi.componentWillUnmount=="function"){It=ii,bt=ii.return;try{pt=It,Pi.props=pt.memoizedProps,Pi.state=pt.memoizedState,Pi.componentWillUnmount()}catch(Mi){qa(It,bt,Mi)}}break;case 5:ih(ii,ii.return);break;case 22:if(ii.memoizedState!==null){Of(li);continue}}Si!==null?(Si.return=ii,Ai=Si):Of(li)}ai=ai.sibling}e:for(ai=null,li=ct;;){if(li.tag===5){if(ai===null){ai=li;try{Gt=li.stateNode,Hn?(ir=Gt.style,typeof ir.setProperty=="function"?ir.setProperty("display","none","important"):ir.display="none"):(Or=li.stateNode,zr=li.memoizedProps.style,wr=zr!=null&&zr.hasOwnProperty("display")?zr.display:null,Or.style.display=pi("display",wr))}catch(Mi){qa(ct,ct.return,Mi)}}}else if(li.tag===6){if(ai===null)try{li.stateNode.nodeValue=Hn?"":li.memoizedProps}catch(Mi){qa(ct,ct.return,Mi)}}else if((li.tag!==22&&li.tag!==23||li.memoizedState===null||li===ct)&&li.child!==null){li.child.return=li,li=li.child;continue}if(li===ct)break e;for(;li.sibling===null;){if(li.return===null||li.return===ct)break e;ai===li&&(ai=null),li=li.return}ai===li&&(ai=null),li.sibling.return=li.return,li=li.sibling}}break;case 19:Tl(pt,ct),nu(ct),It&4&&Pf(ct);break;case 21:break;default:Tl(pt,ct),nu(ct)}}function nu(ct){var pt=ct.flags;if(pt&2){try{e:{for(var bt=ct.return;bt!==null;){if(Af(bt)){var It=bt;break e}bt=bt.return}throw Error(rt(160))}switch(It.tag){case 5:var Gt=It.stateNode;It.flags&32&&(mi(Gt,""),It.flags&=-33);var ir=Rf(ct);Hd(ct,ir,Gt);break;case 3:case 4:var wr=It.stateNode.containerInfo,Or=Rf(ct);Gd(ct,Or,wr);break;default:throw Error(rt(161))}}catch(zr){qa(ct,ct.return,zr)}ct.flags&=-3}pt&4096&&(ct.flags&=-4097)}function lp(ct,pt,bt){Ai=ct,Mf(ct)}function Mf(ct,pt,bt){for(var It=(ct.mode&1)!==0;Ai!==null;){var Gt=Ai,ir=Gt.child;if(Gt.tag===22&&It){var wr=Gt.memoizedState!==null||ad;if(!wr){var Or=Gt.alternate,zr=Or!==null&&Or.memoizedState!==null||$s;Or=ad;var Hn=$s;if(ad=wr,($s=zr)&&!Hn)for(Ai=Gt;Ai!==null;)wr=Ai,zr=wr.child,wr.tag===22&&wr.memoizedState!==null?Bf(Gt):zr!==null?(zr.return=wr,Ai=zr):Bf(Gt);for(;ir!==null;)Ai=ir,Mf(ir),ir=ir.sibling;Ai=Gt,ad=Or,$s=Hn}kf(ct)}else(Gt.subtreeFlags&8772)!==0&&ir!==null?(ir.return=Gt,Ai=ir):kf(ct)}}function kf(ct){for(;Ai!==null;){var pt=Ai;if((pt.flags&8772)!==0){var bt=pt.alternate;try{if((pt.flags&8772)!==0)switch(pt.tag){case 0:case 11:case 15:$s||sd(5,pt);break;case 1:var It=pt.stateNode;if(pt.flags&4&&!$s)if(bt===null)It.componentDidMount();else{var Gt=pt.elementType===pt.type?bt.memoizedProps:_t(pt.type,bt.memoizedProps);It.componentDidUpdate(Gt,bt.memoizedState,It.__reactInternalSnapshotBeforeUpdate)}var ir=pt.updateQueue;ir!==null&&eu(pt,ir,It);break;case 3:var wr=pt.updateQueue;if(wr!==null){if(bt=null,pt.child!==null)switch(pt.child.tag){case 5:bt=pt.child.stateNode;break;case 1:bt=pt.child.stateNode}eu(pt,wr,bt)}break;case 5:var Or=pt.stateNode;if(bt===null&&pt.flags&4){bt=Or;var zr=pt.memoizedProps;switch(pt.type){case"button":case"input":case"select":case"textarea":zr.autoFocus&&bt.focus();break;case"img":zr.src&&(bt.src=zr.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(pt.memoizedState===null){var Hn=pt.alternate;if(Hn!==null){var ai=Hn.memoizedState;if(ai!==null){var li=ai.dehydrated;li!==null&&zs(li)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(rt(163))}$s||pt.flags&512&&jd(pt)}catch(ii){qa(pt,pt.return,ii)}}if(pt===ct){Ai=null;break}if(bt=pt.sibling,bt!==null){bt.return=pt.return,Ai=bt;break}Ai=pt.return}}function Of(ct){for(;Ai!==null;){var pt=Ai;if(pt===ct){Ai=null;break}var bt=pt.sibling;if(bt!==null){bt.return=pt.return,Ai=bt;break}Ai=pt.return}}function Bf(ct){for(;Ai!==null;){var pt=Ai;try{switch(pt.tag){case 0:case 11:case 15:var bt=pt.return;try{sd(4,pt)}catch(zr){qa(pt,bt,zr)}break;case 1:var It=pt.stateNode;if(typeof It.componentDidMount=="function"){var Gt=pt.return;try{It.componentDidMount()}catch(zr){qa(pt,Gt,zr)}}var ir=pt.return;try{jd(pt)}catch(zr){qa(pt,ir,zr)}break;case 5:var wr=pt.return;try{jd(pt)}catch(zr){qa(pt,wr,zr)}}}catch(zr){qa(pt,pt.return,zr)}if(pt===ct){Ai=null;break}var Or=pt.sibling;if(Or!==null){Or.return=pt.return,Ai=Or;break}Ai=pt.return}}var up=Math.ceil,od=Pt.ReactCurrentDispatcher,Vd=Pt.ReactCurrentOwner,al=Pt.ReactCurrentBatchConfig,oa=0,xs=null,os=null,Is=0,Uo=0,ah=ml(0),fs=0,Nh=null,kc=0,ld=0,Wd=0,Uh=null,Ro=null,qd=0,sh=1/0,Iu=null,ud=!1,Zd=null,tc=null,cd=!1,rc=null,hd=0,$h=0,Yd=null,dd=-1,fd=0;function Ys(){return(oa&6)!==0?ta():dd!==-1?dd:dd=ta()}function nc(ct){return(ct.mode&1)===0?1:(oa&2)!==0&&Is!==0?Is&-Is:kd.transition!==null?(fd===0&&(fd=Xa()),fd):(ct=Zi,ct!==0||(ct=window.event,ct=ct===void 0?16:as(ct.type)),ct)}function Al(ct,pt,bt,It){if(50<$h)throw $h=0,Yd=null,Error(rt(185));ll(ct,bt,It),((oa&2)===0||ct!==xs)&&(ct===xs&&((oa&2)===0&&(ld|=bt),fs===4&&ic(ct,Is)),Io(ct,It),bt===1&&oa===0&&(pt.mode&1)===0&&(sh=ta()+500,_o&&vo()))}function Io(ct,pt){var bt=ct.callbackNode;Go(ct,pt);var It=Cl(ct,ct===xs?Is:0);if(It===0)bt!==null&&Xs(bt),ct.callbackNode=null,ct.callbackPriority=0;else if(pt=It&-It,ct.callbackPriority!==pt){if(bt!=null&&Xs(bt),pt===1)ct.tag===0?Qh(Lf.bind(null,ct)):wh(Lf.bind(null,ct)),yh(function(){(oa&6)===0&&vo()}),bt=null;else{switch(Ol(It)){case 1:bt=Ks;break;case 4:bt=ol;break;case 16:bt=Pl;break;case 536870912:bt=Ss;break;default:bt=Pl}bt=Hf(bt,Df.bind(null,ct))}ct.callbackPriority=pt,ct.callbackNode=bt}}function Df(ct,pt){if(dd=-1,fd=0,(oa&6)!==0)throw Error(rt(327));var bt=ct.callbackNode;if(oh()&&ct.callbackNode!==bt)return null;var It=Cl(ct,ct===xs?Is:0);if(It===0)return null;if((It&30)!==0||(It&ct.expiredLanes)!==0||pt)pt=pd(ct,It);else{pt=It;var Gt=oa;oa|=2;var ir=Nf();(xs!==ct||Is!==pt)&&(Iu=null,sh=ta()+500,Bc(ct,pt));do try{dp();break}catch(Or){Ff(ct,Or)}while(!0);wc(),od.current=ir,oa=Gt,os!==null?pt=0:(xs=null,Is=0,pt=fs)}if(pt!==0){if(pt===2&&(Gt=Ho(ct),Gt!==0&&(It=Gt,pt=Xd(ct,Gt))),pt===1)throw bt=Nh,Bc(ct,0),ic(ct,It),Io(ct,ta()),bt;if(pt===6)ic(ct,It);else{if(Gt=ct.current.alternate,(It&30)===0&&!cp(Gt)&&(pt=pd(ct,It),pt===2&&(ir=Ho(ct),ir!==0&&(It=ir,pt=Xd(ct,ir))),pt===1))throw bt=Nh,Bc(ct,0),ic(ct,It),Io(ct,ta()),bt;switch(ct.finishedWork=Gt,ct.finishedLanes=It,pt){case 0:case 1:throw Error(rt(345));case 2:Dc(ct,Ro,Iu);break;case 3:if(ic(ct,It),(It&130023424)===It&&(pt=qd+500-ta(),10<pt)){if(Cl(ct,0)!==0)break;if(Gt=ct.suspendedLanes,(Gt&It)!==It){Ys(),ct.pingedLanes|=ct.suspendedLanes&Gt;break}ct.timeoutHandle=_h(Dc.bind(null,ct,Ro,Iu),pt);break}Dc(ct,Ro,Iu);break;case 4:if(ic(ct,It),(It&4194240)===It)break;for(pt=ct.eventTimes,Gt=-1;0<It;){var wr=31-Fi(It);ir=1<<wr,wr=pt[wr],wr>Gt&&(Gt=wr),It&=~ir}if(It=Gt,It=ta()-It,It=(120>It?120:480>It?480:1080>It?1080:1920>It?1920:3e3>It?3e3:4320>It?4320:1960*up(It/1960))-It,10<It){ct.timeoutHandle=_h(Dc.bind(null,ct,Ro,Iu),It);break}Dc(ct,Ro,Iu);break;case 5:Dc(ct,Ro,Iu);break;default:throw Error(rt(329))}}}return Io(ct,ta()),ct.callbackNode===bt?Df.bind(null,ct):null}function Xd(ct,pt){var bt=Uh;return ct.current.memoizedState.isDehydrated&&(Bc(ct,pt).flags|=256),ct=pd(ct,pt),ct!==2&&(pt=Ro,Ro=bt,pt!==null&&Qd(pt)),ct}function Qd(ct){Ro===null?Ro=ct:Ro.push.apply(Ro,ct)}function cp(ct){for(var pt=ct;;){if(pt.flags&16384){var bt=pt.updateQueue;if(bt!==null&&(bt=bt.stores,bt!==null))for(var It=0;It<bt.length;It++){var Gt=bt[It],ir=Gt.getSnapshot;Gt=Gt.value;try{if(!Zr(ir(),Gt))return!1}catch{return!1}}}if(bt=pt.child,pt.subtreeFlags&16384&&bt!==null)bt.return=pt,pt=bt;else{if(pt===ct)break;for(;pt.sibling===null;){if(pt.return===null||pt.return===ct)return!0;pt=pt.return}pt.sibling.return=pt.return,pt=pt.sibling}}return!0}function ic(ct,pt){for(pt&=~Wd,pt&=~ld,ct.suspendedLanes|=pt,ct.pingedLanes&=~pt,ct=ct.expirationTimes;0<pt;){var bt=31-Fi(pt),It=1<<bt;ct[bt]=-1,pt&=~It}}function Lf(ct){if((oa&6)!==0)throw Error(rt(327));oh();var pt=Cl(ct,0);if((pt&1)===0)return Io(ct,ta()),null;var bt=pd(ct,pt);if(ct.tag!==0&&bt===2){var It=Ho(ct);It!==0&&(pt=It,bt=Xd(ct,It))}if(bt===1)throw bt=Nh,Bc(ct,0),ic(ct,pt),Io(ct,ta()),bt;if(bt===6)throw Error(rt(345));return ct.finishedWork=ct.current.alternate,ct.finishedLanes=pt,Dc(ct,Ro,Iu),Io(ct,ta()),null}function Kd(ct,pt){var bt=oa;oa|=1;try{return ct(pt)}finally{oa=bt,oa===0&&(sh=ta()+500,_o&&vo())}}function Oc(ct){rc!==null&&rc.tag===0&&(oa&6)===0&&oh();var pt=oa;oa|=1;var bt=al.transition,It=Zi;try{if(al.transition=null,Zi=1,ct)return ct()}finally{Zi=It,al.transition=bt,oa=pt,(oa&6)===0&&vo()}}function Jd(){Uo=ah.current,Sa(ah)}function Bc(ct,pt){ct.finishedWork=null,ct.finishedLanes=0;var bt=ct.timeoutHandle;if(bt!==-1&&(ct.timeoutHandle=-1,zu(bt)),os!==null)for(bt=os.return;bt!==null;){var It=bt;switch(yc(It),It.tag){case 1:It=It.type.childContextTypes,It!=null&&Hu();break;case 3:Ws(),Sa(cs),Sa(es),Ku();break;case 5:Qc(It);break;case 4:Ws();break;case 13:Sa(Ta);break;case 19:Sa(Ta);break;case 10:Ec(It.type._context);break;case 22:case 23:Jd()}bt=bt.return}if(xs=ct,os=ct=ac(ct.current,null),Is=Uo=pt,fs=0,Nh=null,Wd=ld=kc=0,Ro=Uh=null,Eu!==null){for(pt=0;pt<Eu.length;pt++)if(bt=Eu[pt],It=bt.interleaved,It!==null){bt.interleaved=null;var Gt=It.next,ir=bt.pending;if(ir!==null){var wr=ir.next;ir.next=Gt,It.next=wr}bt.pending=It}Eu=null}return ct}function Ff(ct,pt){do{var bt=os;try{if(wc(),Do.current=Mc,ts){for(var It=Ia.memoizedState;It!==null;){var Gt=It.queue;Gt!==null&&(Gt.pending=null),It=It.next}ts=!1}if(Lo=0,ja=Fa=Ia=null,Ao=!1,bs=0,Vd.current=null,bt===null||bt.return===null){fs=1,Nh=pt,os=null;break}e:{var ir=ct,wr=bt.return,Or=bt,zr=pt;if(pt=Is,Or.flags|=32768,zr!==null&&typeof zr=="object"&&typeof zr.then=="function"){var Hn=zr,ai=Or,li=ai.tag;if((ai.mode&1)===0&&(li===0||li===11||li===15)){var ii=ai.alternate;ii?(ai.updateQueue=ii.updateQueue,ai.memoizedState=ii.memoizedState,ai.lanes=ii.lanes):(ai.updateQueue=null,ai.memoizedState=null)}var Si=Ii(wr);if(Si!==null){Si.flags&=-257,Vi(Si,wr,Or,ir,pt),Si.mode&1&&ui(ir,Hn,pt),pt=Si,zr=Hn;var Pi=pt.updateQueue;if(Pi===null){var Mi=new Set;Mi.add(zr),pt.updateQueue=Mi}else Pi.add(zr);break e}else{if((pt&1)===0){ui(ir,Hn,pt),ef();break e}zr=Error(rt(426))}}else if(Aa&&Or.mode&1){var ns=Ii(wr);if(ns!==null){(ns.flags&65536)===0&&(ns.flags|=256),Vi(ns,wr,Or,ir,pt),So(Vr(zr,Or));break e}}ir=zr=Vr(zr,Or),fs!==4&&(fs=2),Uh===null?Uh=[ir]:Uh.push(ir),ir=wr;do{switch(ir.tag){case 3:ir.flags|=65536,pt&=-pt,ir.lanes|=pt;var Bn=xi(ir,zr,pt);Wa(ir,Bn);break e;case 1:Or=zr;var Wr=ir.type,$n=ir.stateNode;if((ir.flags&128)===0&&(typeof Wr.getDerivedStateFromError=="function"||$n!==null&&typeof $n.componentDidCatch=="function"&&(tc===null||!tc.has($n)))){ir.flags|=65536,pt&=-pt,ir.lanes|=pt;var fi=Jn(ir,Or,pt);Wa(ir,fi);break e}}ir=ir.return}while(ir!==null)}$f(bt)}catch(ki){pt=ki,os===bt&&bt!==null&&(os=bt=bt.return);continue}break}while(!0)}function Nf(){var ct=od.current;return od.current=Mc,ct===null?Mc:ct}function ef(){(fs===0||fs===3||fs===2)&&(fs=4),xs===null||(kc&268435455)===0&&(ld&268435455)===0||ic(xs,Is)}function pd(ct,pt){var bt=oa;oa|=2;var It=Nf();(xs!==ct||Is!==pt)&&(Iu=null,Bc(ct,pt));do try{hp();break}catch(Gt){Ff(ct,Gt)}while(!0);if(wc(),oa=bt,od.current=It,os!==null)throw Error(rt(261));return xs=null,Is=0,fs}function hp(){for(;os!==null;)Uf(os)}function dp(){for(;os!==null&&!wa();)Uf(os)}function Uf(ct){var pt=Gf(ct.alternate,ct,Uo);ct.memoizedProps=ct.pendingProps,pt===null?$f(ct):os=pt,Vd.current=null}function $f(ct){var pt=ct;do{var bt=pt.alternate;if(ct=pt.return,(pt.flags&32768)===0){if(bt=ip(bt,pt,Uo),bt!==null){os=bt;return}}else{if(bt=ap(bt,pt),bt!==null){bt.flags&=32767,os=bt;return}if(ct!==null)ct.flags|=32768,ct.subtreeFlags=0,ct.deletions=null;else{fs=6,os=null;return}}if(pt=pt.sibling,pt!==null){os=pt;return}os=pt=ct}while(pt!==null);fs===0&&(fs=5)}function Dc(ct,pt,bt){var It=Zi,Gt=al.transition;try{al.transition=null,Zi=1,fp(ct,pt,bt,It)}finally{al.transition=Gt,Zi=It}return null}function fp(ct,pt,bt,It){do oh();while(rc!==null);if((oa&6)!==0)throw Error(rt(327));bt=ct.finishedWork;var Gt=ct.finishedLanes;if(bt===null)return null;if(ct.finishedWork=null,ct.finishedLanes=0,bt===ct.current)throw Error(rt(177));ct.callbackNode=null,ct.callbackPriority=0;var ir=bt.lanes|bt.childLanes;if(Ml(ct,ir),ct===xs&&(os=xs=null,Is=0),(bt.subtreeFlags&2064)===0&&(bt.flags&2064)===0||cd||(cd=!0,Hf(Pl,function(){return oh(),null})),ir=(bt.flags&15990)!==0,(bt.subtreeFlags&15990)!==0||ir){ir=al.transition,al.transition=null;var wr=Zi;Zi=1;var Or=oa;oa|=4,Vd.current=null,op(ct,bt),Cf(bt,ct),An(mh),ms=!!$u,mh=$u=null,ct.current=bt,lp(bt),Qs(),oa=Or,Zi=wr,al.transition=ir}else ct.current=bt;if(cd&&(cd=!1,rc=ct,hd=Gt),ir=ct.pendingLanes,ir===0&&(tc=null),pa(bt.stateNode),Io(ct,ta()),pt!==null)for(It=ct.onRecoverableError,bt=0;bt<pt.length;bt++)Gt=pt[bt],It(Gt.value,{componentStack:Gt.stack,digest:Gt.digest});if(ud)throw ud=!1,ct=Zd,Zd=null,ct;return(hd&1)!==0&&ct.tag!==0&&oh(),ir=ct.pendingLanes,(ir&1)!==0?ct===Yd?$h++:($h=0,Yd=ct):$h=0,vo(),null}function oh(){if(rc!==null){var ct=Ol(hd),pt=al.transition,bt=Zi;try{if(al.transition=null,Zi=16>ct?16:ct,rc===null)var It=!1;else{if(ct=rc,rc=null,hd=0,(oa&6)!==0)throw Error(rt(331));var Gt=oa;for(oa|=4,Ai=ct.current;Ai!==null;){var ir=Ai,wr=ir.child;if((Ai.flags&16)!==0){var Or=ir.deletions;if(Or!==null){for(var zr=0;zr<Or.length;zr++){var Hn=Or[zr];for(Ai=Hn;Ai!==null;){var ai=Ai;switch(ai.tag){case 0:case 11:case 15:Fh(8,ai,ir)}var li=ai.child;if(li!==null)li.return=ai,Ai=li;else for(;Ai!==null;){ai=Ai;var ii=ai.sibling,Si=ai.return;if(Tf(ai),ai===Hn){Ai=null;break}if(ii!==null){ii.return=Si,Ai=ii;break}Ai=Si}}}var Pi=ir.alternate;if(Pi!==null){var Mi=Pi.child;if(Mi!==null){Pi.child=null;do{var ns=Mi.sibling;Mi.sibling=null,Mi=ns}while(Mi!==null)}}Ai=ir}}if((ir.subtreeFlags&2064)!==0&&wr!==null)wr.return=ir,Ai=wr;else e:for(;Ai!==null;){if(ir=Ai,(ir.flags&2048)!==0)switch(ir.tag){case 0:case 11:case 15:Fh(9,ir,ir.return)}var Bn=ir.sibling;if(Bn!==null){Bn.return=ir.return,Ai=Bn;break e}Ai=ir.return}}var Wr=ct.current;for(Ai=Wr;Ai!==null;){wr=Ai;var $n=wr.child;if((wr.subtreeFlags&2064)!==0&&$n!==null)$n.return=wr,Ai=$n;else e:for(wr=Wr;Ai!==null;){if(Or=Ai,(Or.flags&2048)!==0)try{switch(Or.tag){case 0:case 11:case 15:sd(9,Or)}}catch(ki){qa(Or,Or.return,ki)}if(Or===wr){Ai=null;break e}var fi=Or.sibling;if(fi!==null){fi.return=Or.return,Ai=fi;break e}Ai=Or.return}}if(oa=Gt,vo(),qi&&typeof qi.onPostCommitFiberRoot=="function")try{qi.onPostCommitFiberRoot(Ps,ct)}catch{}It=!0}return It}finally{Zi=bt,al.transition=pt}}return!1}function zf(ct,pt,bt){pt=Vr(bt,pt),pt=xi(ct,pt,1),ct=Va(ct,pt,1),pt=Ys(),ct!==null&&(ll(ct,1,pt),Io(ct,pt))}function qa(ct,pt,bt){if(ct.tag===3)zf(ct,ct,bt);else for(;pt!==null;){if(pt.tag===3){zf(pt,ct,bt);break}else if(pt.tag===1){var It=pt.stateNode;if(typeof pt.type.getDerivedStateFromError=="function"||typeof It.componentDidCatch=="function"&&(tc===null||!tc.has(It))){ct=Vr(bt,ct),ct=Jn(pt,ct,1),pt=Va(pt,ct,1),ct=Ys(),pt!==null&&(ll(pt,1,ct),Io(pt,ct));break}}pt=pt.return}}function pp(ct,pt,bt){var It=ct.pingCache;It!==null&&It.delete(pt),pt=Ys(),ct.pingedLanes|=ct.suspendedLanes&bt,xs===ct&&(Is&bt)===bt&&(fs===4||fs===3&&(Is&130023424)===Is&&500>ta()-qd?Bc(ct,0):Wd|=bt),Io(ct,pt)}function jf(ct,pt){pt===0&&((ct.mode&1)===0?pt=1:(pt=Ya,Ya<<=1,(Ya&130023424)===0&&(Ya=4194304)));var bt=Ys();ct=ga(ct,pt),ct!==null&&(ll(ct,pt,bt),Io(ct,bt))}function mp(ct){var pt=ct.memoizedState,bt=0;pt!==null&&(bt=pt.retryLane),jf(ct,bt)}function gp(ct,pt){var bt=0;switch(ct.tag){case 13:var It=ct.stateNode,Gt=ct.memoizedState;Gt!==null&&(bt=Gt.retryLane);break;case 19:It=ct.stateNode;break;default:throw Error(rt(314))}It!==null&&It.delete(pt),jf(ct,bt)}var Gf;Gf=function(ct,pt,bt){if(ct!==null)if(ct.memoizedProps!==pt.pendingProps||cs.current)Xr=!0;else{if((ct.lanes&bt)===0&&(pt.flags&128)===0)return Xr=!1,np(ct,pt,bt);Xr=(ct.flags&131072)!==0}else Xr=!1,Aa&&(pt.flags&1048576)!==0&&qu(pt,_u,pt.index);switch(pt.lanes=0,pt.tag){case 2:var It=pt.type;id(ct,pt),ct=pt.pendingProps;var Gt=Ql(pt,es.current);wu(pt,bt),Gt=Rc(null,pt,It,ct,Gt,bt);var ir=nl();return pt.flags|=1,typeof Gt=="object"&&Gt!==null&&typeof Gt.render=="function"&&Gt.$$typeof===void 0?(pt.tag=1,pt.memoizedState=null,pt.updateQueue=null,As(It)?(ir=!0,Vu(pt)):ir=!1,pt.memoizedState=Gt.state!==null&&Gt.state!==void 0?Gt.state:null,Ha(pt),Gt.updater=Ct,pt.stateNode=Gt,Gt._reactInternals=pt,Cr(pt,It,ct,bt),pt=il(null,pt,It,!0,ir,bt)):(pt.tag=0,Aa&&ir&&Zu(pt),Wn(null,pt,Gt,bt),pt=pt.child),pt;case 16:It=pt.elementType;e:{switch(id(ct,pt),ct=pt.pendingProps,Gt=It._init,It=Gt(It._payload),pt.type=It,Gt=pt.tag=yp(It),ct=_t(It,ct),Gt){case 0:pt=rs(null,pt,It,ct,bt);break e;case 1:pt=sa(null,pt,It,ct,bt);break e;case 11:pt=si(null,pt,It,ct,bt);break e;case 14:pt=Di(null,pt,It,_t(It.type,ct),bt);break e}throw Error(rt(306,It,""))}return pt;case 0:return It=pt.type,Gt=pt.pendingProps,Gt=pt.elementType===It?Gt:_t(It,Gt),rs(ct,pt,It,Gt,bt);case 1:return It=pt.type,Gt=pt.pendingProps,Gt=pt.elementType===It?Gt:_t(It,Gt),sa(ct,pt,It,Gt,bt);case 3:e:{if(rd(pt),ct===null)throw Error(rt(387));It=pt.pendingProps,ir=pt.memoizedState,Gt=ir.element,za(ct,pt),Jl(pt,It,null,bt);var wr=pt.memoizedState;if(It=wr.element,ir.isDehydrated)if(ir={element:It,isDehydrated:!1,cache:wr.cache,pendingSuspenseBoundaries:wr.pendingSuspenseBoundaries,transitions:wr.transitions},pt.updateQueue.baseState=ir,pt.memoizedState=ir,pt.flags&256){Gt=Vr(Error(rt(423)),pt),pt=_f(ct,pt,It,bt,Gt);break e}else if(It!==Gt){Gt=Vr(Error(rt(424)),pt),pt=_f(ct,pt,It,bt,Gt);break e}else for(Ls=pl(pt.stateNode.containerInfo.firstChild),Ds=pt,Aa=!0,Vs=null,bt=xc(pt,null,It,bt),pt.child=bt;bt;)bt.flags=bt.flags&-3|4096,bt=bt.sibling;else{if(yu(),It===Gt){pt=Ru(ct,pt,bt);break e}Wn(ct,pt,It,bt)}pt=pt.child}return pt;case 5:return Su(pt),ct===null&&wo(pt),It=pt.type,Gt=pt.pendingProps,ir=ct!==null?ct.memoizedProps:null,wr=Gt.children,gh(It,Gt)?wr=null:ir!==null&&gh(It,ir)&&(pt.flags|=32),ra(ct,pt),Wn(ct,pt,wr,bt),pt.child;case 6:return ct===null&&wo(pt),null;case 13:return yf(ct,pt,bt);case 4:return Tc(pt,pt.stateNode.containerInfo),It=pt.pendingProps,ct===null?pt.child=_l(pt,null,It,bt):Wn(ct,pt,It,bt),pt.child;case 11:return It=pt.type,Gt=pt.pendingProps,Gt=pt.elementType===It?Gt:_t(It,Gt),si(ct,pt,It,Gt,bt);case 7:return Wn(ct,pt,pt.pendingProps,bt),pt.child;case 8:return Wn(ct,pt,pt.pendingProps.children,bt),pt.child;case 12:return Wn(ct,pt,pt.pendingProps.children,bt),pt.child;case 10:e:{if(It=pt.type._context,Gt=pt.pendingProps,ir=pt.memoizedProps,wr=Gt.value,da(vu,It._currentValue),It._currentValue=wr,ir!==null)if(Zr(ir.value,wr)){if(ir.children===Gt.children&&!cs.current){pt=Ru(ct,pt,bt);break e}}else for(ir=pt.child,ir!==null&&(ir.return=pt);ir!==null;){var Or=ir.dependencies;if(Or!==null){wr=ir.child;for(var zr=Or.firstContext;zr!==null;){if(zr.context===It){if(ir.tag===1){zr=Ra(-1,bt&-bt),zr.tag=2;var Hn=ir.updateQueue;if(Hn!==null){Hn=Hn.shared;var ai=Hn.pending;ai===null?zr.next=zr:(zr.next=ai.next,ai.next=zr),Hn.pending=zr}}ir.lanes|=bt,zr=ir.alternate,zr!==null&&(zr.lanes|=bt),Sc(ir.return,bt,pt),Or.lanes|=bt;break}zr=zr.next}}else if(ir.tag===10)wr=ir.type===pt.type?null:ir.child;else if(ir.tag===18){if(wr=ir.return,wr===null)throw Error(rt(341));wr.lanes|=bt,Or=wr.alternate,Or!==null&&(Or.lanes|=bt),Sc(wr,bt,pt),wr=ir.sibling}else wr=ir.child;if(wr!==null)wr.return=ir;else for(wr=ir;wr!==null;){if(wr===pt){wr=null;break}if(ir=wr.sibling,ir!==null){ir.return=wr.return,wr=ir;break}wr=wr.return}ir=wr}Wn(ct,pt,Gt.children,bt),pt=pt.child}return pt;case 9:return Gt=pt.type,It=pt.pendingProps.children,wu(pt,bt),Gt=Fs(Gt),It=It(Gt),pt.flags|=1,Wn(ct,pt,It,bt),pt.child;case 14:return It=pt.type,Gt=_t(It,pt.pendingProps),Gt=_t(It.type,Gt),Di(ct,pt,It,Gt,bt);case 15:return aa(ct,pt,pt.type,pt.pendingProps,bt);case 17:return It=pt.type,Gt=pt.pendingProps,Gt=pt.elementType===It?Gt:_t(It,Gt),id(ct,pt),pt.tag=1,As(It)?(ct=!0,Vu(pt)):ct=!1,wu(pt,bt),tr(pt,It,Gt),Cr(pt,It,Gt,bt),il(null,pt,It,!0,ct,bt);case 19:return bf(ct,pt,bt);case 22:return Ci(ct,pt,bt)}throw Error(rt(156,pt.tag))};function Hf(ct,pt){return zo(ct,pt)}function _p(ct,pt,bt,It){this.tag=ct,this.key=bt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=pt,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=It,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sl(ct,pt,bt,It){return new _p(ct,pt,bt,It)}function tf(ct){return ct=ct.prototype,!(!ct||!ct.isReactComponent)}function yp(ct){if(typeof ct=="function")return tf(ct)?1:0;if(ct!=null){if(ct=ct.$$typeof,ct===$t)return 11;if(ct===qt)return 14}return 2}function ac(ct,pt){var bt=ct.alternate;return bt===null?(bt=sl(ct.tag,pt,ct.key,ct.mode),bt.elementType=ct.elementType,bt.type=ct.type,bt.stateNode=ct.stateNode,bt.alternate=ct,ct.alternate=bt):(bt.pendingProps=pt,bt.type=ct.type,bt.flags=0,bt.subtreeFlags=0,bt.deletions=null),bt.flags=ct.flags&14680064,bt.childLanes=ct.childLanes,bt.lanes=ct.lanes,bt.child=ct.child,bt.memoizedProps=ct.memoizedProps,bt.memoizedState=ct.memoizedState,bt.updateQueue=ct.updateQueue,pt=ct.dependencies,bt.dependencies=pt===null?null:{lanes:pt.lanes,firstContext:pt.firstContext},bt.sibling=ct.sibling,bt.index=ct.index,bt.ref=ct.ref,bt}function md(ct,pt,bt,It,Gt,ir){var wr=2;if(It=ct,typeof ct=="function")tf(ct)&&(wr=1);else if(typeof ct=="string")wr=5;else e:switch(ct){case Et:return Lc(bt.children,Gt,ir,pt);case Lt:wr=8,Gt|=8;break;case kt:return ct=sl(12,bt,pt,Gt|2),ct.elementType=kt,ct.lanes=ir,ct;case Qt:return ct=sl(13,bt,pt,Gt),ct.elementType=Qt,ct.lanes=ir,ct;case Ht:return ct=sl(19,bt,pt,Gt),ct.elementType=Ht,ct.lanes=ir,ct;case Xt:return gd(bt,Gt,ir,pt);default:if(typeof ct=="object"&&ct!==null)switch(ct.$$typeof){case jt:wr=10;break e;case Mt:wr=9;break e;case $t:wr=11;break e;case qt:wr=14;break e;case Bt:wr=16,It=null;break e}throw Error(rt(130,ct==null?ct:typeof ct,""))}return pt=sl(wr,bt,pt,Gt),pt.elementType=ct,pt.type=It,pt.lanes=ir,pt}function Lc(ct,pt,bt,It){return ct=sl(7,ct,It,pt),ct.lanes=bt,ct}function gd(ct,pt,bt,It){return ct=sl(22,ct,It,pt),ct.elementType=Xt,ct.lanes=bt,ct.stateNode={isHidden:!1},ct}function rf(ct,pt,bt){return ct=sl(6,ct,null,pt),ct.lanes=bt,ct}function nf(ct,pt,bt){return pt=sl(4,ct.children!==null?ct.children:[],ct.key,pt),pt.lanes=bt,pt.stateNode={containerInfo:ct.containerInfo,pendingChildren:null,implementation:ct.implementation},pt}function vp(ct,pt,bt,It,Gt){this.tag=pt,this.containerInfo=ct,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=su(0),this.expirationTimes=su(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=su(0),this.identifierPrefix=It,this.onRecoverableError=Gt,this.mutableSourceEagerHydrationData=null}function af(ct,pt,bt,It,Gt,ir,wr,Or,zr){return ct=new vp(ct,pt,bt,Or,zr),pt===1?(pt=1,ir===!0&&(pt|=8)):pt=0,ir=sl(3,null,null,pt),ct.current=ir,ir.stateNode=ct,ir.memoizedState={element:It,isDehydrated:bt,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ha(ir),ct}function bp(ct,pt,bt){var It=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ot,key:It==null?null:""+It,children:ct,containerInfo:pt,implementation:bt}}function Vf(ct){if(!ct)return mo;ct=ct._reactInternals;e:{if(Xi(ct)!==ct||ct.tag!==1)throw Error(rt(170));var pt=ct;do{switch(pt.tag){case 3:pt=pt.stateNode.context;break e;case 1:if(As(pt.type)){pt=pt.stateNode.__reactInternalMemoizedMergedChildContext;break e}}pt=pt.return}while(pt!==null);throw Error(rt(171))}if(ct.tag===1){var bt=ct.type;if(As(bt))return bh(ct,bt,pt)}return pt}function Wf(ct,pt,bt,It,Gt,ir,wr,Or,zr){return ct=af(bt,It,!0,ct,Gt,ir,wr,Or,zr),ct.context=Vf(null),bt=ct.current,It=Ys(),Gt=nc(bt),ir=Ra(It,Gt),ir.callback=pt??null,Va(bt,ir,Gt),ct.current.lanes=Gt,ll(ct,Gt,It),Io(ct,It),ct}function _d(ct,pt,bt,It){var Gt=pt.current,ir=Ys(),wr=nc(Gt);return bt=Vf(bt),pt.context===null?pt.context=bt:pt.pendingContext=bt,pt=Ra(ir,wr),pt.payload={element:ct},It=It===void 0?null:It,It!==null&&(pt.callback=It),ct=Va(Gt,pt,wr),ct!==null&&(Al(ct,Gt,wr,ir),vl(ct,Gt,wr)),wr}function yd(ct){return ct=ct.current,ct.child?(ct.child.tag===5,ct.child.stateNode):null}function qf(ct,pt){if(ct=ct.memoizedState,ct!==null&&ct.dehydrated!==null){var bt=ct.retryLane;ct.retryLane=bt!==0&&bt<pt?bt:pt}}function sf(ct,pt){qf(ct,pt),(ct=ct.alternate)&&qf(ct,pt)}function xp(){return null}var Zf=typeof reportError=="function"?reportError:function(ct){console.error(ct)};function of(ct){this._internalRoot=ct}vd.prototype.render=of.prototype.render=function(ct){var pt=this._internalRoot;if(pt===null)throw Error(rt(409));_d(ct,pt,null,null)},vd.prototype.unmount=of.prototype.unmount=function(){var ct=this._internalRoot;if(ct!==null){this._internalRoot=null;var pt=ct.containerInfo;Oc(function(){_d(null,ct,null,null)}),pt[La]=null}};function vd(ct){this._internalRoot=ct}vd.prototype.unstable_scheduleHydration=function(ct){if(ct){var pt=Cu();ct={blockedOn:null,target:ct,priority:pt};for(var bt=0;bt<Qi.length&&pt!==0&&pt<Qi[bt].priority;bt++);Qi.splice(bt,0,ct),bt===0&&ou(ct)}};function lf(ct){return!(!ct||ct.nodeType!==1&&ct.nodeType!==9&&ct.nodeType!==11)}function bd(ct){return!(!ct||ct.nodeType!==1&&ct.nodeType!==9&&ct.nodeType!==11&&(ct.nodeType!==8||ct.nodeValue!==" react-mount-point-unstable "))}function Yf(){}function wp(ct,pt,bt,It,Gt){if(Gt){if(typeof It=="function"){var ir=It;It=function(){var Hn=yd(wr);ir.call(Hn)}}var wr=Wf(pt,It,ct,0,null,!1,!1,"",Yf);return ct._reactRootContainer=wr,ct[La]=wr.current,Fu(ct.nodeType===8?ct.parentNode:ct),Oc(),wr}for(;Gt=ct.lastChild;)ct.removeChild(Gt);if(typeof It=="function"){var Or=It;It=function(){var Hn=yd(zr);Or.call(Hn)}}var zr=af(ct,0,!1,null,null,!1,!1,"",Yf);return ct._reactRootContainer=zr,ct[La]=zr.current,Fu(ct.nodeType===8?ct.parentNode:ct),Oc(function(){_d(pt,zr,bt,It)}),zr}function xd(ct,pt,bt,It,Gt){var ir=bt._reactRootContainer;if(ir){var wr=ir;if(typeof Gt=="function"){var Or=Gt;Gt=function(){var zr=yd(wr);Or.call(zr)}}_d(pt,wr,ct,Gt)}else wr=wp(bt,pt,ct,Gt,It);return yd(wr)}Fc=function(ct){switch(ct.tag){case 3:var pt=ct.stateNode;if(pt.current.memoizedState.isDehydrated){var bt=jo(pt.pendingLanes);bt!==0&&(kl(pt,bt|1),Io(pt,ta()),(oa&6)===0&&(sh=ta()+500,vo()))}break;case 13:Oc(function(){var It=ga(ct,1);if(It!==null){var Gt=Ys();Al(It,ct,1,Gt)}}),sf(ct,1)}},Yi=function(ct){if(ct.tag===13){var pt=ga(ct,134217728);if(pt!==null){var bt=Ys();Al(pt,ct,134217728,bt)}sf(ct,134217728)}},Pu=function(ct){if(ct.tag===13){var pt=nc(ct),bt=ga(ct,pt);if(bt!==null){var It=Ys();Al(bt,ct,pt,It)}sf(ct,pt)}},Cu=function(){return Zi},Bl=function(ct,pt){var bt=Zi;try{return Zi=ct,pt()}finally{Zi=bt}},Jr=function(ct,pt,bt){switch(pt){case"input":if(Er(ct,bt),pt=bt.name,bt.type==="radio"&&pt!=null){for(bt=ct;bt.parentNode;)bt=bt.parentNode;for(bt=bt.querySelectorAll("input[name="+JSON.stringify(""+pt)+'][type="radio"]'),pt=0;pt<bt.length;pt++){var It=bt[pt];if(It!==ct&&It.form===ct.form){var Gt=Gu(It);if(!Gt)throw Error(rt(90));pr(It),Er(It,Gt)}}}break;case"textarea":Gn(ct,bt);break;case"select":pt=bt.value,pt!=null&&hr(ct,!!bt.multiple,pt,!1)}},qr=Kd,bi=Oc;var Ep={usingClientEntryPoint:!1,Events:[ju,gu,Gu,Pr,Hr,Kd]},zh={findFiberByHostInstance:Yl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sp={bundleType:zh.bundleType,version:zh.version,rendererPackageName:zh.rendererPackageName,rendererConfig:zh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pt.ReactCurrentDispatcher,findHostInstanceByFiber:function(ct){return ct=Es(ct),ct===null?null:ct.stateNode},findFiberByHostInstance:zh.findFiberByHostInstance||xp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wd.isDisabled&&wd.supportsFiber)try{Ps=wd.inject(Sp),qi=wd}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ep,reactDom_production_min.createPortal=function(ct,pt){var bt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lf(pt))throw Error(rt(200));return bp(ct,pt,null,bt)},reactDom_production_min.createRoot=function(ct,pt){if(!lf(ct))throw Error(rt(299));var bt=!1,It="",Gt=Zf;return pt!=null&&(pt.unstable_strictMode===!0&&(bt=!0),pt.identifierPrefix!==void 0&&(It=pt.identifierPrefix),pt.onRecoverableError!==void 0&&(Gt=pt.onRecoverableError)),pt=af(ct,1,!1,null,null,bt,!1,It,Gt),ct[La]=pt.current,Fu(ct.nodeType===8?ct.parentNode:ct),new of(pt)},reactDom_production_min.findDOMNode=function(ct){if(ct==null)return null;if(ct.nodeType===1)return ct;var pt=ct._reactInternals;if(pt===void 0)throw typeof ct.render=="function"?Error(rt(188)):(ct=Object.keys(ct).join(","),Error(rt(268,ct)));return ct=Es(pt),ct=ct===null?null:ct.stateNode,ct},reactDom_production_min.flushSync=function(ct){return Oc(ct)},reactDom_production_min.hydrate=function(ct,pt,bt){if(!bd(pt))throw Error(rt(200));return xd(null,ct,pt,!0,bt)},reactDom_production_min.hydrateRoot=function(ct,pt,bt){if(!lf(ct))throw Error(rt(405));var It=bt!=null&&bt.hydratedSources||null,Gt=!1,ir="",wr=Zf;if(bt!=null&&(bt.unstable_strictMode===!0&&(Gt=!0),bt.identifierPrefix!==void 0&&(ir=bt.identifierPrefix),bt.onRecoverableError!==void 0&&(wr=bt.onRecoverableError)),pt=Wf(pt,null,ct,1,bt??null,Gt,!1,ir,wr),ct[La]=pt.current,Fu(ct),It)for(ct=0;ct<It.length;ct++)bt=It[ct],Gt=bt._getVersion,Gt=Gt(bt._source),pt.mutableSourceEagerHydrationData==null?pt.mutableSourceEagerHydrationData=[bt,Gt]:pt.mutableSourceEagerHydrationData.push(bt,Gt);return new vd(pt)},reactDom_production_min.render=function(ct,pt,bt){if(!bd(pt))throw Error(rt(200));return xd(null,ct,pt,!1,bt)},reactDom_production_min.unmountComponentAtNode=function(ct){if(!bd(ct))throw Error(rt(40));return ct._reactRootContainer?(Oc(function(){xd(null,null,ct,!1,function(){ct._reactRootContainer=null,ct[La]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Kd,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(ct,pt,bt,It){if(!bd(bt))throw Error(rt(200));if(ct==null||ct._reactInternals===void 0)throw Error(rt(38));return xd(ct,pt,bt,!1,It)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function tt(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tt)}catch(et){console.error(et)}}return tt(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var tt=requireReactDom();return client.createRoot=tt.createRoot,client.hydrateRoot=tt.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs$1(clientExports);function WorkerWrapper$1(tt){return new Worker("/LuckyRepo/assets/logic.worker-TvHVpNsO.js",{name:tt?.name})}function WorkerWrapper(tt){return new Worker("/LuckyRepo/assets/view.worker-JgGQVcTy.js",{name:tt?.name})}class ViewWorkerManager{static instance;worker;sharedBuffers=new Map;sharedViews=new Map;isInitialized=!1;activeStateName=null;activeInstanceId=null;constructor(){this.worker=new WorkerWrapper,this.worker.onerror=et=>console.error("View Worker Error:",et),this.worker.onmessage=et=>{et.data.type==="REQUEST_RESIZE_OUTPUT"&&this.resizeOutputBuffer(et.data.payload.bufferName,et.data.payload.newSize)}}static getInstance(){return ViewWorkerManager.instance||(ViewWorkerManager.instance=new ViewWorkerManager),ViewWorkerManager.instance}updateInputBuffer(et,rt){this.worker.postMessage({type:"UPDATE_BUFFER",payload:{name:et,buffer:rt,isInput:!0}})}resizeOutputBuffer(et,rt){const nt=this.sharedViews.get(et),it=rt*4,at=new SharedArrayBuffer(it),st=new Float32Array(at);nt&&st.set(nt),this.sharedBuffers.set(et,at),this.sharedViews.set(et,st),this.worker.postMessage({type:"UPDATE_BUFFER",payload:{name:et,buffer:at,isInput:!1}})}setupBuffers(et,rt){this.isInitialized=!1,this.sharedBuffers.clear(),this.sharedViews.clear();const nt="BUFFER_SIZE"in rt?{main:rt}:rt,it={};Object.entries(nt).forEach(([at,st])=>{const ot=st.BUFFER_SIZE*4,lt=new SharedArrayBuffer(ot);this.sharedBuffers.set(at,lt),this.sharedViews.set(at,new Float32Array(lt)),it[at]=lt}),this.worker.postMessage({type:"INIT_SABS",payload:{inputBuffers:et,outputBuffers:it}}),this.isInitialized=!0}prepareForState(et){const rt=crypto.randomUUID();return this.activeStateName!==et&&(this.isInitialized=!1),this.activeInstanceId=rt,this.activeStateName=et,rt}createState(et){this.worker.postMessage({type:"CREATE_STATE",stateName:et})}terminateState(et,rt){rt&&rt!==this.activeInstanceId||(this.activeStateName===et&&(this.activeStateName=null,this.activeInstanceId=null,this.isInitialized=!1),this.worker.postMessage({type:"TERMINATE_STATE",stateName:et}))}tick(et,rt,nt){!this.isInitialized||this.sharedViews.size===0||et!==this.activeStateName||this.worker.postMessage({type:"TICK",stateName:et,dt:rt,frameCount:nt})}forceClearWorker(){this.isInitialized=!1,this.activeStateName=null,this.activeInstanceId=null,this.worker.postMessage({type:"TERMINATE_ALL"})}sendInput(et,rt,nt={}){this.worker.postMessage({type:"INPUT",stateName:et,payload:{action:rt,...nt}})}loadSnapshot(et,rt){this.worker.postMessage({type:"INPUT",stateName:et,payload:{action:"LOAD_SNAPSHOT",data:rt}})}}let WorkerManager$1=class jh{static instance;logic;buffers=new Map;views=new Map;isInitialized=!1;activeStateName=null;activeInstanceId=null;constructor(){if(this.logic=new WorkerWrapper$1,typeof SharedArrayBuffer>"u")throw new Error("COOP/COEP headers missing for SharedArrayBuffer.");this.logic.onerror=et=>console.error("Logic Worker Error:",et),this.logic.onmessage=et=>{et.data.type==="REQUEST_RESIZE"&&this.resizeBuffer(et.data.payload.bufferName,et.data.payload.newSize)}}static getInstance(){return jh.instance||(jh.instance=new jh),jh.instance}setupBuffers(et,rt=!1){this.isInitialized=!1,this.buffers.clear(),this.views.clear();const nt="BUFFER_SIZE"in et?{main:et}:et,it={};Object.entries(nt).forEach(([at,st])=>{const ot=st.BUFFER_SIZE*4,lt=new SharedArrayBuffer(ot);rt&&new Float32Array(lt).fill(0),this.buffers.set(at,lt),this.views.set(at,new Float32Array(lt)),it[at]=lt}),this.logic.postMessage({type:"INIT_SABS",payload:{buffers:it}}),this.isInitialized=!0}resizeBuffer(et,rt){const nt=this.views.get(et),it=rt*4,at=new SharedArrayBuffer(it),st=new Float32Array(at);nt&&st.set(nt),this.buffers.set(et,at),this.views.set(et,st),this.logic.postMessage({type:"UPDATE_BUFFER",payload:{name:et,buffer:at}}),ViewWorkerManager.getInstance().updateInputBuffer(et,at)}getBuffers(){const et={};return this.buffers.forEach((rt,nt)=>et[nt]=rt),et}prepareForState(et){const rt=crypto.randomUUID();return this.activeStateName!==et&&(this.isInitialized=!1),this.activeInstanceId=rt,this.activeStateName=et,rt}createState(et,rt=!1){this.logic.postMessage({type:"CREATE_STATE",stateName:et,payload:{force:rt}})}terminateState(et,rt){rt&&rt!==this.activeInstanceId||(this.activeStateName===et&&(this.activeStateName=null,this.activeInstanceId=null,this.isInitialized=!1),this.logic.postMessage({type:"TERMINATE_STATE",stateName:et}))}sendInput(et,rt,nt={}){this.logic.postMessage({type:"INPUT",stateName:et,payload:{action:rt,...nt}})}tick(et,rt,nt){!this.isInitialized||this.views.size===0||et!==this.activeStateName||this.logic.postMessage({type:"TICK",stateName:et,frameCount:rt,fps:nt})}forceClearWorker(){this.isInitialized=!1,this.activeStateName=null,this.activeInstanceId=null,this.logic.postMessage({type:"TERMINATE_ALL"})}};class SharedSession{static instance;data=new Map;isWriteLocked=!1;STORAGE_KEY="engine_settings_global";PERSISTENT_KEYS=["resolution","master_volume","ost_volume","sfx_volume"];SAVABLE_KEYS=["global_hp","global_energy","campaign_id","campaign_step_index"];constructor(){this.data.set("master_volume",.5),this.data.set("ost_volume",.5),this.data.set("sfx_volume",.5),this.data.set("resolution","1080p"),this.loadFromLocalStorage()}static getInstance(){return SharedSession.instance||(SharedSession.instance=new SharedSession),SharedSession.instance}exportSaveData(){const et={};return this.SAVABLE_KEYS.forEach(rt=>{this.data.has(rt)&&(et[rt]=this.data.get(rt))}),et}importSaveData(et){this.SAVABLE_KEYS.forEach(rt=>{et[rt]!==void 0&&this.forceSet(rt,et[rt])})}set(et,rt){if(this.isWriteLocked&&this.SAVABLE_KEYS.includes(et)){console.warn(`[SharedSession] Blocked stale write to ${et} during lock.`);return}this.data.set(et,rt),(this.PERSISTENT_KEYS.includes(et)||et.startsWith("bind_"))&&this.saveToLocalStorage()}get(et,rt){return this.data.has(et)?this.data.get(et):rt}clearSavableKeys(){this.SAVABLE_KEYS.forEach(et=>{this.data.delete(et)})}forceSet(et,rt){this.data.set(et,rt)}lockForLoad(){this.isWriteLocked=!0}unlock(){this.isWriteLocked=!1}loadFromLocalStorage(){try{const et=localStorage.getItem(this.STORAGE_KEY);if(et){const rt=JSON.parse(et);Object.entries(rt).forEach(([nt,it])=>{(this.PERSISTENT_KEYS.includes(nt)||nt.startsWith("bind_"))&&this.data.set(nt,it)})}}catch(et){console.warn("[SharedSession] Persistence load failed",et)}}saveToLocalStorage(){const et={};this.data.forEach((rt,nt)=>{(this.PERSISTENT_KEYS.includes(nt)||nt.startsWith("bind_"))&&(et[nt]=rt)}),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(et))}}const INPUT_REGISTRY={Shared:{UI_BACK:["ESCAPE","BACKSPACE"],PAUSE:["ESCAPE","P"]},Game1:{MOVE_UP:["W","ARROWUP"],MOVE_DOWN:["S","ARROWDOWN"],MOVE_LEFT:["A","ARROWLEFT"],MOVE_RIGHT:["D","ARROWRIGHT"]},Game2:{MOVE_UP:["G","H"]},BHGame:{MOVE_UP:["W","ARROWUP"],MOVE_DOWN:["S","ARROWDOWN"],MOVE_LEFT:["A","ARROWLEFT"],MOVE_RIGHT:["D","ARROWRIGHT"]},Game3:{MOVE_LEFT:["A","ARROWLEFT"],MOVE_RIGHT:["D","ARROWRIGHT"],MOVE_DOWN:["S","ARROWDOWN"],JUMP:["W","ARROWUP"," "]}};class InputManager{static instance;mouseX=0;mouseY=0;isHoveringButton=!1;isMouseDown=!1;activeKeys=new Set;currentBindings=new Map;currentGame="Shared";constructor(){this.setupGlobalListeners(),this.refreshBindings("Shared")}static getInstance(){return InputManager.instance||(InputManager.instance=new InputManager),InputManager.instance}getSnapshot(){const et=[];return this.currentBindings.forEach((rt,nt)=>{rt.some(it=>this.activeKeys.has(it))&&et.push(nt)}),{isHoveringButton:this.isHoveringButton,isMouseDown:this.isMouseDown,mouseX:this.mouseX,mouseY:this.mouseY,actions:et}}reset(){this.activeKeys.clear(),this.isMouseDown=!1,this.isHoveringButton=!1}refreshBindings(et){this.currentGame=et;const rt=SharedSession.getInstance(),nt={...INPUT_REGISTRY.Shared,...INPUT_REGISTRY[et]||{}},it=rt.get("bind_Shared");if(it&&Object.assign(nt,it),et!=="Shared"){const at=rt.get(`bind_${et}`);at&&Object.assign(nt,at)}this.currentBindings=new Map(Object.entries(nt))}isKeyAction(et,rt){const nt=this.currentBindings.get(rt);return nt?nt.includes(et.toUpperCase()):!1}setBinding(et,rt,nt=this.currentGame,it=0){const at=SharedSession.getInstance(),st=`bind_${nt}`,ot=at.get(st)||{};if(!ot[et]){const lt=this.currentBindings.get(et)||[];ot[et]=[...lt]}ot[et][it]=rt.toUpperCase(),at.set(st,ot),this.refreshBindings(this.currentGame)}resetBindings(et=this.currentGame){const rt=SharedSession.getInstance(),nt=`bind_${et}`;rt.set(nt,void 0),this.refreshBindings(this.currentGame)}setupGlobalListeners(){window.addEventListener("keydown",et=>this.activeKeys.add(et.key.toUpperCase())),window.addEventListener("keyup",et=>this.activeKeys.delete(et.key.toUpperCase())),window.addEventListener("mousemove",et=>{const rt=window.innerWidth,nt=window.innerHeight,it=16/9,at=rt/nt;let st,ot,lt=0,ht=0;at>it?(ot=nt,st=nt*it,lt=(rt-st)/2):(st=rt,ot=rt/it,ht=(nt-ot)/2);const dt=(et.clientX-lt)/st,ut=(et.clientY-ht)/ot;this.mouseX=Math.max(0,Math.min(1,dt)),this.mouseY=Math.max(0,Math.min(1,ut))}),window.addEventListener("mousedown",()=>this.isMouseDown=!0),window.addEventListener("mouseup",()=>this.isMouseDown=!1),window.addEventListener("mouseover",et=>{const rt=et.target;this.isHoveringButton=!!rt.closest("button, .interactable")}),window.addEventListener("blur",()=>this.reset())}}class Engine{static instance;TARGET_FPS=60;MS_PER_FRAME=1e3/this.TARGET_FPS;lastFrameTime=0;isRunning=!1;requestRef=0;frameCount=0;fps=0;lastFpsUpdate=0;framesSinceLastUpdate=0;constructor(){}static getInstance(){return Engine.instance||(Engine.instance=new Engine),Engine.instance}start(){this.isRunning||(this.isRunning=!0,this.lastFrameTime=performance.now(),this.lastFpsUpdate=performance.now(),InputManager.getInstance(),this.requestRef=requestAnimationFrame(this.loop),console.log("[Engine] Core Loop Started"))}stop(){this.isRunning=!1,cancelAnimationFrame(this.requestRef),console.log("[Engine] Core Loop Stopped")}loop=et=>{if(!this.isRunning)return;const rt=et-this.lastFrameTime;if(rt<this.MS_PER_FRAME){this.requestRef=requestAnimationFrame(this.loop);return}this.lastFrameTime=et-rt%this.MS_PER_FRAME;const nt=StateManager.getInstance();if(nt.stack.length===0){this.requestRef=requestAnimationFrame(this.loop);return}this.framesSinceLastUpdate++,et>this.lastFpsUpdate+1e3&&(this.fps=Math.round(this.framesSinceLastUpdate*1e3/(et-this.lastFpsUpdate)),this.lastFpsUpdate=et,this.framesSinceLastUpdate=0),this.dispatchLogicTick(nt),this.dispatchViewTick(nt,this.MS_PER_FRAME),nt.updateAll(this.MS_PER_FRAME,this.frameCount),this.frameCount++,this.requestRef=requestAnimationFrame(this.loop)};dispatchLogicTick(et){const rt=WorkerManager$1.getInstance(),nt=rt.activeStateName;if(!nt)return;const at=et.stack.find(lt=>lt.name===nt);if(!at||!at.isUpdating)return;const ot=InputManager.getInstance().getSnapshot();rt.sendInput(nt,"SYNC_INPUT",{actions:ot.actions,mouseX:ot.mouseX,mouseY:ot.mouseY,isMouseDown:ot.isMouseDown,isHovering:ot.isHoveringButton}),rt.tick(nt,this.frameCount,this.fps||60)}dispatchViewTick(et,rt){const nt=ViewWorkerManager.getInstance(),it=nt.activeStateName;if(!it)return;const st=et.stack.find(lt=>lt.name===it);if(!st||!st.isRendering)return;const ot=st.isUpdating?rt:0;nt.tick(it,ot,this.frameCount)}}let State$1=class{isUpdating=!1;isRendering=!1;priority=0;isInitialized=!1;update(et,rt){}};const DefaultLoadingView=({isFinished:tt,onTransitionComplete:et})=>(reactExports.useEffect(()=>{tt&&et()},[tt,et]),jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",backgroundColor:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsx("div",{style:{color:"#000",fontFamily:"monospace",fontWeight:"bold"},children:"LOADING..."})})}));var ENV=(tt=>(tt[tt.WEBGL_LEGACY=0]="WEBGL_LEGACY",tt[tt.WEBGL=1]="WEBGL",tt[tt.WEBGL2=2]="WEBGL2",tt))(ENV||{}),RENDERER_TYPE=(tt=>(tt[tt.UNKNOWN=0]="UNKNOWN",tt[tt.WEBGL=1]="WEBGL",tt[tt.CANVAS=2]="CANVAS",tt))(RENDERER_TYPE||{}),BUFFER_BITS=(tt=>(tt[tt.COLOR=16384]="COLOR",tt[tt.DEPTH=256]="DEPTH",tt[tt.STENCIL=1024]="STENCIL",tt))(BUFFER_BITS||{}),BLEND_MODES=(tt=>(tt[tt.NORMAL=0]="NORMAL",tt[tt.ADD=1]="ADD",tt[tt.MULTIPLY=2]="MULTIPLY",tt[tt.SCREEN=3]="SCREEN",tt[tt.OVERLAY=4]="OVERLAY",tt[tt.DARKEN=5]="DARKEN",tt[tt.LIGHTEN=6]="LIGHTEN",tt[tt.COLOR_DODGE=7]="COLOR_DODGE",tt[tt.COLOR_BURN=8]="COLOR_BURN",tt[tt.HARD_LIGHT=9]="HARD_LIGHT",tt[tt.SOFT_LIGHT=10]="SOFT_LIGHT",tt[tt.DIFFERENCE=11]="DIFFERENCE",tt[tt.EXCLUSION=12]="EXCLUSION",tt[tt.HUE=13]="HUE",tt[tt.SATURATION=14]="SATURATION",tt[tt.COLOR=15]="COLOR",tt[tt.LUMINOSITY=16]="LUMINOSITY",tt[tt.NORMAL_NPM=17]="NORMAL_NPM",tt[tt.ADD_NPM=18]="ADD_NPM",tt[tt.SCREEN_NPM=19]="SCREEN_NPM",tt[tt.NONE=20]="NONE",tt[tt.SRC_OVER=0]="SRC_OVER",tt[tt.SRC_IN=21]="SRC_IN",tt[tt.SRC_OUT=22]="SRC_OUT",tt[tt.SRC_ATOP=23]="SRC_ATOP",tt[tt.DST_OVER=24]="DST_OVER",tt[tt.DST_IN=25]="DST_IN",tt[tt.DST_OUT=26]="DST_OUT",tt[tt.DST_ATOP=27]="DST_ATOP",tt[tt.ERASE=26]="ERASE",tt[tt.SUBTRACT=28]="SUBTRACT",tt[tt.XOR=29]="XOR",tt))(BLEND_MODES||{}),DRAW_MODES=(tt=>(tt[tt.POINTS=0]="POINTS",tt[tt.LINES=1]="LINES",tt[tt.LINE_LOOP=2]="LINE_LOOP",tt[tt.LINE_STRIP=3]="LINE_STRIP",tt[tt.TRIANGLES=4]="TRIANGLES",tt[tt.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",tt[tt.TRIANGLE_FAN=6]="TRIANGLE_FAN",tt))(DRAW_MODES||{}),FORMATS=(tt=>(tt[tt.RGBA=6408]="RGBA",tt[tt.RGB=6407]="RGB",tt[tt.RG=33319]="RG",tt[tt.RED=6403]="RED",tt[tt.RGBA_INTEGER=36249]="RGBA_INTEGER",tt[tt.RGB_INTEGER=36248]="RGB_INTEGER",tt[tt.RG_INTEGER=33320]="RG_INTEGER",tt[tt.RED_INTEGER=36244]="RED_INTEGER",tt[tt.ALPHA=6406]="ALPHA",tt[tt.LUMINANCE=6409]="LUMINANCE",tt[tt.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",tt[tt.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",tt[tt.DEPTH_STENCIL=34041]="DEPTH_STENCIL",tt))(FORMATS||{}),TARGETS=(tt=>(tt[tt.TEXTURE_2D=3553]="TEXTURE_2D",tt[tt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",tt[tt.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",tt[tt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",tt[tt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",tt[tt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",tt[tt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",tt[tt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",tt[tt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",tt))(TARGETS||{}),TYPES=(tt=>(tt[tt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",tt[tt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",tt[tt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",tt[tt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",tt[tt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",tt[tt.UNSIGNED_INT=5125]="UNSIGNED_INT",tt[tt.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",tt[tt.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",tt[tt.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",tt[tt.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",tt[tt.BYTE=5120]="BYTE",tt[tt.SHORT=5122]="SHORT",tt[tt.INT=5124]="INT",tt[tt.FLOAT=5126]="FLOAT",tt[tt.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",tt[tt.HALF_FLOAT=36193]="HALF_FLOAT",tt))(TYPES||{}),SAMPLER_TYPES=(tt=>(tt[tt.FLOAT=0]="FLOAT",tt[tt.INT=1]="INT",tt[tt.UINT=2]="UINT",tt))(SAMPLER_TYPES||{}),SCALE_MODES=(tt=>(tt[tt.NEAREST=0]="NEAREST",tt[tt.LINEAR=1]="LINEAR",tt))(SCALE_MODES||{}),WRAP_MODES=(tt=>(tt[tt.CLAMP=33071]="CLAMP",tt[tt.REPEAT=10497]="REPEAT",tt[tt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",tt))(WRAP_MODES||{}),MIPMAP_MODES=(tt=>(tt[tt.OFF=0]="OFF",tt[tt.POW2=1]="POW2",tt[tt.ON=2]="ON",tt[tt.ON_MANUAL=3]="ON_MANUAL",tt))(MIPMAP_MODES||{}),ALPHA_MODES=(tt=>(tt[tt.NPM=0]="NPM",tt[tt.UNPACK=1]="UNPACK",tt[tt.PMA=2]="PMA",tt[tt.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",tt[tt.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",tt[tt.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",tt))(ALPHA_MODES||{}),CLEAR_MODES=(tt=>(tt[tt.NO=0]="NO",tt[tt.YES=1]="YES",tt[tt.AUTO=2]="AUTO",tt[tt.BLEND=0]="BLEND",tt[tt.CLEAR=1]="CLEAR",tt[tt.BLIT=2]="BLIT",tt))(CLEAR_MODES||{}),GC_MODES=(tt=>(tt[tt.AUTO=0]="AUTO",tt[tt.MANUAL=1]="MANUAL",tt))(GC_MODES||{}),PRECISION=(tt=>(tt.LOW="lowp",tt.MEDIUM="mediump",tt.HIGH="highp",tt))(PRECISION||{}),MASK_TYPES=(tt=>(tt[tt.NONE=0]="NONE",tt[tt.SCISSOR=1]="SCISSOR",tt[tt.STENCIL=2]="STENCIL",tt[tt.SPRITE=3]="SPRITE",tt[tt.COLOR=4]="COLOR",tt))(MASK_TYPES||{}),MSAA_QUALITY=(tt=>(tt[tt.NONE=0]="NONE",tt[tt.LOW=2]="LOW",tt[tt.MEDIUM=4]="MEDIUM",tt[tt.HIGH=8]="HIGH",tt))(MSAA_QUALITY||{}),BUFFER_TYPE=(tt=>(tt[tt.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",tt[tt.ARRAY_BUFFER=34962]="ARRAY_BUFFER",tt[tt.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",tt))(BUFFER_TYPE||{});const BrowserAdapter={createCanvas:(tt,et)=>{const rt=document.createElement("canvas");return rt.width=tt,rt.height=et,rt},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(tt,et)=>fetch(tt,et),parseXML:tt=>new DOMParser().parseFromString(tt,"text/xml")},settings={ADAPTER:BrowserAdapter,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(tt){return typeof tt<"u"&&tt.platform==="MacIntel"&&typeof tt.maxTouchPoints=="number"&&tt.maxTouchPoints>1&&typeof MSStream>"u"};function createMatch(tt){return function(et){return et.test(tt)}}function isMobile$1(tt){var et={userAgent:"",platform:"",maxTouchPoints:0};!tt&&typeof navigator<"u"?et={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof tt=="string"?et.userAgent=tt:tt&&tt.userAgent&&(et={userAgent:tt.userAgent,platform:tt.platform,maxTouchPoints:tt.maxTouchPoints||0});var rt=et.userAgent,nt=rt.split("[FBAN");typeof nt[1]<"u"&&(rt=nt[0]),nt=rt.split("Twitter"),typeof nt[1]<"u"&&(rt=nt[0]);var it=createMatch(rt),at={apple:{phone:it(appleIphone)&&!it(windowsPhone),ipod:it(appleIpod),tablet:!it(appleIphone)&&(it(appleTablet)||isAppleTabletOnIos13(et))&&!it(windowsPhone),universal:it(appleUniversal),device:(it(appleIphone)||it(appleIpod)||it(appleTablet)||it(appleUniversal)||isAppleTabletOnIos13(et))&&!it(windowsPhone)},amazon:{phone:it(amazonPhone),tablet:!it(amazonPhone)&&it(amazonTablet),device:it(amazonPhone)||it(amazonTablet)},android:{phone:!it(windowsPhone)&&it(amazonPhone)||!it(windowsPhone)&&it(androidPhone),tablet:!it(windowsPhone)&&!it(amazonPhone)&&!it(androidPhone)&&(it(amazonTablet)||it(androidTablet)),device:!it(windowsPhone)&&(it(amazonPhone)||it(amazonTablet)||it(androidPhone)||it(androidTablet))||it(/\bokhttp\b/i)},windows:{phone:it(windowsPhone),tablet:it(windowsTablet),device:it(windowsPhone)||it(windowsTablet)},other:{blackberry:it(otherBlackBerry),blackberry10:it(otherBlackBerry10),opera:it(otherOpera),firefox:it(otherFirefox),chrome:it(otherChrome),device:it(otherBlackBerry)||it(otherBlackBerry10)||it(otherOpera)||it(otherFirefox)||it(otherChrome)},any:!1,phone:!1,tablet:!1};return at.any=at.apple.device||at.android.device||at.windows.device||at.other.device,at.phone=at.apple.phone||at.android.phone||at.windows.phone,at.tablet=at.apple.tablet||at.android.tablet||at.windows.tablet,at}const isMobileCall=isMobile$1.default??isMobile$1,isMobile=isMobileCall(globalThis.navigator);settings.RETINA_PREFIX=/@([0-9\.]+)x/;settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,(function(tt){var et=Object.prototype.hasOwnProperty,rt="~";function nt(){}Object.create&&(nt.prototype=Object.create(null),new nt().__proto__||(rt=!1));function it(lt,ht,dt){this.fn=lt,this.context=ht,this.once=dt||!1}function at(lt,ht,dt,ut,ft){if(typeof dt!="function")throw new TypeError("The listener must be a function");var mt=new it(dt,ut||lt,ft),gt=rt?rt+ht:ht;return lt._events[gt]?lt._events[gt].fn?lt._events[gt]=[lt._events[gt],mt]:lt._events[gt].push(mt):(lt._events[gt]=mt,lt._eventsCount++),lt}function st(lt,ht){--lt._eventsCount===0?lt._events=new nt:delete lt._events[ht]}function ot(){this._events=new nt,this._eventsCount=0}ot.prototype.eventNames=function(){var ht=[],dt,ut;if(this._eventsCount===0)return ht;for(ut in dt=this._events)et.call(dt,ut)&&ht.push(rt?ut.slice(1):ut);return Object.getOwnPropertySymbols?ht.concat(Object.getOwnPropertySymbols(dt)):ht},ot.prototype.listeners=function(ht){var dt=rt?rt+ht:ht,ut=this._events[dt];if(!ut)return[];if(ut.fn)return[ut.fn];for(var ft=0,mt=ut.length,gt=new Array(mt);ft<mt;ft++)gt[ft]=ut[ft].fn;return gt},ot.prototype.listenerCount=function(ht){var dt=rt?rt+ht:ht,ut=this._events[dt];return ut?ut.fn?1:ut.length:0},ot.prototype.emit=function(ht,dt,ut,ft,mt,gt){var vt=rt?rt+ht:ht;if(!this._events[vt])return!1;var xt=this._events[vt],wt=arguments.length,At,Tt;if(xt.fn){switch(xt.once&&this.removeListener(ht,xt.fn,void 0,!0),wt){case 1:return xt.fn.call(xt.context),!0;case 2:return xt.fn.call(xt.context,dt),!0;case 3:return xt.fn.call(xt.context,dt,ut),!0;case 4:return xt.fn.call(xt.context,dt,ut,ft),!0;case 5:return xt.fn.call(xt.context,dt,ut,ft,mt),!0;case 6:return xt.fn.call(xt.context,dt,ut,ft,mt,gt),!0}for(Tt=1,At=new Array(wt-1);Tt<wt;Tt++)At[Tt-1]=arguments[Tt];xt.fn.apply(xt.context,At)}else{var Pt=xt.length,Rt;for(Tt=0;Tt<Pt;Tt++)switch(xt[Tt].once&&this.removeListener(ht,xt[Tt].fn,void 0,!0),wt){case 1:xt[Tt].fn.call(xt[Tt].context);break;case 2:xt[Tt].fn.call(xt[Tt].context,dt);break;case 3:xt[Tt].fn.call(xt[Tt].context,dt,ut);break;case 4:xt[Tt].fn.call(xt[Tt].context,dt,ut,ft);break;default:if(!At)for(Rt=1,At=new Array(wt-1);Rt<wt;Rt++)At[Rt-1]=arguments[Rt];xt[Tt].fn.apply(xt[Tt].context,At)}}return!0},ot.prototype.on=function(ht,dt,ut){return at(this,ht,dt,ut,!1)},ot.prototype.once=function(ht,dt,ut){return at(this,ht,dt,ut,!0)},ot.prototype.removeListener=function(ht,dt,ut,ft){var mt=rt?rt+ht:ht;if(!this._events[mt])return this;if(!dt)return st(this,mt),this;var gt=this._events[mt];if(gt.fn)gt.fn===dt&&(!ft||gt.once)&&(!ut||gt.context===ut)&&st(this,mt);else{for(var vt=0,xt=[],wt=gt.length;vt<wt;vt++)(gt[vt].fn!==dt||ft&&!gt[vt].once||ut&&gt[vt].context!==ut)&&xt.push(gt[vt]);xt.length?this._events[mt]=xt.length===1?xt[0]:xt:st(this,mt)}return this},ot.prototype.removeAllListeners=function(ht){var dt;return ht?(dt=rt?rt+ht:ht,this._events[dt]&&st(this,dt)):(this._events=new nt,this._eventsCount=0),this},ot.prototype.off=ot.prototype.removeListener,ot.prototype.addListener=ot.prototype.on,ot.prefixed=rt,ot.EventEmitter=ot,tt.exports=ot})(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3();const EventEmitter=getDefaultExportFromCjs$1(eventemitter3Exports);var earcut$1={exports:{}},hasRequiredEarcut;function requireEarcut(){if(hasRequiredEarcut)return earcut$1.exports;hasRequiredEarcut=1,earcut$1.exports=tt,earcut$1.exports.default=tt;function tt(Bt,Xt,Ft){Ft=Ft||2;var Wt=Xt&&Xt.length,Yt=Wt?Xt[0]*Ft:Bt.length,zt=et(Bt,0,Yt,Ft,!0),er=[];if(!zt||zt.next===zt.prev)return er;var dr,fr,lr,mr,br,Sr,Ir;if(Wt&&(zt=lt(Bt,Xt,zt,Ft)),Bt.length>80*Ft){dr=lr=Bt[0],fr=mr=Bt[1];for(var cr=Ft;cr<Yt;cr+=Ft)br=Bt[cr],Sr=Bt[cr+1],br<dr&&(dr=br),Sr<fr&&(fr=Sr),br>lr&&(lr=br),Sr>mr&&(mr=Sr);Ir=Math.max(lr-dr,mr-fr),Ir=Ir!==0?32767/Ir:0}return nt(zt,er,Ft,dr,fr,Ir,0),er}function et(Bt,Xt,Ft,Wt,Yt){var zt,er;if(Yt===qt(Bt,Xt,Ft,Wt)>0)for(zt=Xt;zt<Ft;zt+=Wt)er=$t(zt,Bt[zt],Bt[zt+1],er);else for(zt=Ft-Wt;zt>=Xt;zt-=Wt)er=$t(zt,Bt[zt],Bt[zt+1],er);return er&&Pt(er,er.next)&&(Qt(er),er=er.next),er}function rt(Bt,Xt){if(!Bt)return Bt;Xt||(Xt=Bt);var Ft=Bt,Wt;do if(Wt=!1,!Ft.steiner&&(Pt(Ft,Ft.next)||Tt(Ft.prev,Ft,Ft.next)===0)){if(Qt(Ft),Ft=Xt=Ft.prev,Ft===Ft.next)break;Wt=!0}else Ft=Ft.next;while(Wt||Ft!==Xt);return Xt}function nt(Bt,Xt,Ft,Wt,Yt,zt,er){if(Bt){!er&&zt&&mt(Bt,Wt,Yt,zt);for(var dr=Bt,fr,lr;Bt.prev!==Bt.next;){if(fr=Bt.prev,lr=Bt.next,zt?at(Bt,Wt,Yt,zt):it(Bt)){Xt.push(fr.i/Ft|0),Xt.push(Bt.i/Ft|0),Xt.push(lr.i/Ft|0),Qt(Bt),Bt=lr.next,dr=lr.next;continue}if(Bt=lr,Bt===dr){er?er===1?(Bt=st(rt(Bt),Xt,Ft),nt(Bt,Xt,Ft,Wt,Yt,zt,2)):er===2&&ot(Bt,Xt,Ft,Wt,Yt,zt):nt(rt(Bt),Xt,Ft,Wt,Yt,zt,1);break}}}}function it(Bt){var Xt=Bt.prev,Ft=Bt,Wt=Bt.next;if(Tt(Xt,Ft,Wt)>=0)return!1;for(var Yt=Xt.x,zt=Ft.x,er=Wt.x,dr=Xt.y,fr=Ft.y,lr=Wt.y,mr=Yt<zt?Yt<er?Yt:er:zt<er?zt:er,br=dr<fr?dr<lr?dr:lr:fr<lr?fr:lr,Sr=Yt>zt?Yt>er?Yt:er:zt>er?zt:er,Ir=dr>fr?dr>lr?dr:lr:fr>lr?fr:lr,cr=Wt.next;cr!==Xt;){if(cr.x>=mr&&cr.x<=Sr&&cr.y>=br&&cr.y<=Ir&&wt(Yt,dr,zt,fr,er,lr,cr.x,cr.y)&&Tt(cr.prev,cr,cr.next)>=0)return!1;cr=cr.next}return!0}function at(Bt,Xt,Ft,Wt){var Yt=Bt.prev,zt=Bt,er=Bt.next;if(Tt(Yt,zt,er)>=0)return!1;for(var dr=Yt.x,fr=zt.x,lr=er.x,mr=Yt.y,br=zt.y,Sr=er.y,Ir=dr<fr?dr<lr?dr:lr:fr<lr?fr:lr,cr=mr<br?mr<Sr?mr:Sr:br<Sr?br:Sr,Nt=dr>fr?dr>lr?dr:lr:fr>lr?fr:lr,pr=mr>br?mr>Sr?mr:Sr:br>Sr?br:Sr,rr=vt(Ir,cr,Xt,Ft,Wt),ar=vt(Nt,pr,Xt,Ft,Wt),nr=Bt.prevZ,ur=Bt.nextZ;nr&&nr.z>=rr&&ur&&ur.z<=ar;){if(nr.x>=Ir&&nr.x<=Nt&&nr.y>=cr&&nr.y<=pr&&nr!==Yt&&nr!==er&&wt(dr,mr,fr,br,lr,Sr,nr.x,nr.y)&&Tt(nr.prev,nr,nr.next)>=0||(nr=nr.prevZ,ur.x>=Ir&&ur.x<=Nt&&ur.y>=cr&&ur.y<=pr&&ur!==Yt&&ur!==er&&wt(dr,mr,fr,br,lr,Sr,ur.x,ur.y)&&Tt(ur.prev,ur,ur.next)>=0))return!1;ur=ur.nextZ}for(;nr&&nr.z>=rr;){if(nr.x>=Ir&&nr.x<=Nt&&nr.y>=cr&&nr.y<=pr&&nr!==Yt&&nr!==er&&wt(dr,mr,fr,br,lr,Sr,nr.x,nr.y)&&Tt(nr.prev,nr,nr.next)>=0)return!1;nr=nr.prevZ}for(;ur&&ur.z<=ar;){if(ur.x>=Ir&&ur.x<=Nt&&ur.y>=cr&&ur.y<=pr&&ur!==Yt&&ur!==er&&wt(dr,mr,fr,br,lr,Sr,ur.x,ur.y)&&Tt(ur.prev,ur,ur.next)>=0)return!1;ur=ur.nextZ}return!0}function st(Bt,Xt,Ft){var Wt=Bt;do{var Yt=Wt.prev,zt=Wt.next.next;!Pt(Yt,zt)&&Rt(Yt,Wt,Wt.next,zt)&&kt(Yt,zt)&&kt(zt,Yt)&&(Xt.push(Yt.i/Ft|0),Xt.push(Wt.i/Ft|0),Xt.push(zt.i/Ft|0),Qt(Wt),Qt(Wt.next),Wt=Bt=zt),Wt=Wt.next}while(Wt!==Bt);return rt(Wt)}function ot(Bt,Xt,Ft,Wt,Yt,zt){var er=Bt;do{for(var dr=er.next.next;dr!==er.prev;){if(er.i!==dr.i&&At(er,dr)){var fr=Mt(er,dr);er=rt(er,er.next),fr=rt(fr,fr.next),nt(er,Xt,Ft,Wt,Yt,zt,0),nt(fr,Xt,Ft,Wt,Yt,zt,0);return}dr=dr.next}er=er.next}while(er!==Bt)}function lt(Bt,Xt,Ft,Wt){var Yt=[],zt,er,dr,fr,lr;for(zt=0,er=Xt.length;zt<er;zt++)dr=Xt[zt]*Wt,fr=zt<er-1?Xt[zt+1]*Wt:Bt.length,lr=et(Bt,dr,fr,Wt,!1),lr===lr.next&&(lr.steiner=!0),Yt.push(xt(lr));for(Yt.sort(ht),zt=0;zt<Yt.length;zt++)Ft=dt(Yt[zt],Ft);return Ft}function ht(Bt,Xt){return Bt.x-Xt.x}function dt(Bt,Xt){var Ft=ut(Bt,Xt);if(!Ft)return Xt;var Wt=Mt(Ft,Bt);return rt(Wt,Wt.next),rt(Ft,Ft.next)}function ut(Bt,Xt){var Ft=Xt,Wt=Bt.x,Yt=Bt.y,zt=-1/0,er;do{if(Yt<=Ft.y&&Yt>=Ft.next.y&&Ft.next.y!==Ft.y){var dr=Ft.x+(Yt-Ft.y)*(Ft.next.x-Ft.x)/(Ft.next.y-Ft.y);if(dr<=Wt&&dr>zt&&(zt=dr,er=Ft.x<Ft.next.x?Ft:Ft.next,dr===Wt))return er}Ft=Ft.next}while(Ft!==Xt);if(!er)return null;var fr=er,lr=er.x,mr=er.y,br=1/0,Sr;Ft=er;do Wt>=Ft.x&&Ft.x>=lr&&Wt!==Ft.x&&wt(Yt<mr?Wt:zt,Yt,lr,mr,Yt<mr?zt:Wt,Yt,Ft.x,Ft.y)&&(Sr=Math.abs(Yt-Ft.y)/(Wt-Ft.x),kt(Ft,Bt)&&(Sr<br||Sr===br&&(Ft.x>er.x||Ft.x===er.x&&ft(er,Ft)))&&(er=Ft,br=Sr)),Ft=Ft.next;while(Ft!==fr);return er}function ft(Bt,Xt){return Tt(Bt.prev,Bt,Xt.prev)<0&&Tt(Xt.next,Bt,Bt.next)<0}function mt(Bt,Xt,Ft,Wt){var Yt=Bt;do Yt.z===0&&(Yt.z=vt(Yt.x,Yt.y,Xt,Ft,Wt)),Yt.prevZ=Yt.prev,Yt.nextZ=Yt.next,Yt=Yt.next;while(Yt!==Bt);Yt.prevZ.nextZ=null,Yt.prevZ=null,gt(Yt)}function gt(Bt){var Xt,Ft,Wt,Yt,zt,er,dr,fr,lr=1;do{for(Ft=Bt,Bt=null,zt=null,er=0;Ft;){for(er++,Wt=Ft,dr=0,Xt=0;Xt<lr&&(dr++,Wt=Wt.nextZ,!!Wt);Xt++);for(fr=lr;dr>0||fr>0&&Wt;)dr!==0&&(fr===0||!Wt||Ft.z<=Wt.z)?(Yt=Ft,Ft=Ft.nextZ,dr--):(Yt=Wt,Wt=Wt.nextZ,fr--),zt?zt.nextZ=Yt:Bt=Yt,Yt.prevZ=zt,zt=Yt;Ft=Wt}zt.nextZ=null,lr*=2}while(er>1);return Bt}function vt(Bt,Xt,Ft,Wt,Yt){return Bt=(Bt-Ft)*Yt|0,Xt=(Xt-Wt)*Yt|0,Bt=(Bt|Bt<<8)&16711935,Bt=(Bt|Bt<<4)&252645135,Bt=(Bt|Bt<<2)&858993459,Bt=(Bt|Bt<<1)&1431655765,Xt=(Xt|Xt<<8)&16711935,Xt=(Xt|Xt<<4)&252645135,Xt=(Xt|Xt<<2)&858993459,Xt=(Xt|Xt<<1)&1431655765,Bt|Xt<<1}function xt(Bt){var Xt=Bt,Ft=Bt;do(Xt.x<Ft.x||Xt.x===Ft.x&&Xt.y<Ft.y)&&(Ft=Xt),Xt=Xt.next;while(Xt!==Bt);return Ft}function wt(Bt,Xt,Ft,Wt,Yt,zt,er,dr){return(Yt-er)*(Xt-dr)>=(Bt-er)*(zt-dr)&&(Bt-er)*(Wt-dr)>=(Ft-er)*(Xt-dr)&&(Ft-er)*(zt-dr)>=(Yt-er)*(Wt-dr)}function At(Bt,Xt){return Bt.next.i!==Xt.i&&Bt.prev.i!==Xt.i&&!Lt(Bt,Xt)&&(kt(Bt,Xt)&&kt(Xt,Bt)&&jt(Bt,Xt)&&(Tt(Bt.prev,Bt,Xt.prev)||Tt(Bt,Xt.prev,Xt))||Pt(Bt,Xt)&&Tt(Bt.prev,Bt,Bt.next)>0&&Tt(Xt.prev,Xt,Xt.next)>0)}function Tt(Bt,Xt,Ft){return(Xt.y-Bt.y)*(Ft.x-Xt.x)-(Xt.x-Bt.x)*(Ft.y-Xt.y)}function Pt(Bt,Xt){return Bt.x===Xt.x&&Bt.y===Xt.y}function Rt(Bt,Xt,Ft,Wt){var Yt=Et(Tt(Bt,Xt,Ft)),zt=Et(Tt(Bt,Xt,Wt)),er=Et(Tt(Ft,Wt,Bt)),dr=Et(Tt(Ft,Wt,Xt));return!!(Yt!==zt&&er!==dr||Yt===0&&Ot(Bt,Ft,Xt)||zt===0&&Ot(Bt,Wt,Xt)||er===0&&Ot(Ft,Bt,Wt)||dr===0&&Ot(Ft,Xt,Wt))}function Ot(Bt,Xt,Ft){return Xt.x<=Math.max(Bt.x,Ft.x)&&Xt.x>=Math.min(Bt.x,Ft.x)&&Xt.y<=Math.max(Bt.y,Ft.y)&&Xt.y>=Math.min(Bt.y,Ft.y)}function Et(Bt){return Bt>0?1:Bt<0?-1:0}function Lt(Bt,Xt){var Ft=Bt;do{if(Ft.i!==Bt.i&&Ft.next.i!==Bt.i&&Ft.i!==Xt.i&&Ft.next.i!==Xt.i&&Rt(Ft,Ft.next,Bt,Xt))return!0;Ft=Ft.next}while(Ft!==Bt);return!1}function kt(Bt,Xt){return Tt(Bt.prev,Bt,Bt.next)<0?Tt(Bt,Xt,Bt.next)>=0&&Tt(Bt,Bt.prev,Xt)>=0:Tt(Bt,Xt,Bt.prev)<0||Tt(Bt,Bt.next,Xt)<0}function jt(Bt,Xt){var Ft=Bt,Wt=!1,Yt=(Bt.x+Xt.x)/2,zt=(Bt.y+Xt.y)/2;do Ft.y>zt!=Ft.next.y>zt&&Ft.next.y!==Ft.y&&Yt<(Ft.next.x-Ft.x)*(zt-Ft.y)/(Ft.next.y-Ft.y)+Ft.x&&(Wt=!Wt),Ft=Ft.next;while(Ft!==Bt);return Wt}function Mt(Bt,Xt){var Ft=new Ht(Bt.i,Bt.x,Bt.y),Wt=new Ht(Xt.i,Xt.x,Xt.y),Yt=Bt.next,zt=Xt.prev;return Bt.next=Xt,Xt.prev=Bt,Ft.next=Yt,Yt.prev=Ft,Wt.next=Ft,Ft.prev=Wt,zt.next=Wt,Wt.prev=zt,Wt}function $t(Bt,Xt,Ft,Wt){var Yt=new Ht(Bt,Xt,Ft);return Wt?(Yt.next=Wt.next,Yt.prev=Wt,Wt.next.prev=Yt,Wt.next=Yt):(Yt.prev=Yt,Yt.next=Yt),Yt}function Qt(Bt){Bt.next.prev=Bt.prev,Bt.prev.next=Bt.next,Bt.prevZ&&(Bt.prevZ.nextZ=Bt.nextZ),Bt.nextZ&&(Bt.nextZ.prevZ=Bt.prevZ)}function Ht(Bt,Xt,Ft){this.i=Bt,this.x=Xt,this.y=Ft,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}tt.deviation=function(Bt,Xt,Ft,Wt){var Yt=Xt&&Xt.length,zt=Yt?Xt[0]*Ft:Bt.length,er=Math.abs(qt(Bt,0,zt,Ft));if(Yt)for(var dr=0,fr=Xt.length;dr<fr;dr++){var lr=Xt[dr]*Ft,mr=dr<fr-1?Xt[dr+1]*Ft:Bt.length;er-=Math.abs(qt(Bt,lr,mr,Ft))}var br=0;for(dr=0;dr<Wt.length;dr+=3){var Sr=Wt[dr]*Ft,Ir=Wt[dr+1]*Ft,cr=Wt[dr+2]*Ft;br+=Math.abs((Bt[Sr]-Bt[cr])*(Bt[Ir+1]-Bt[Sr+1])-(Bt[Sr]-Bt[Ir])*(Bt[cr+1]-Bt[Sr+1]))}return er===0&&br===0?0:Math.abs((br-er)/er)};function qt(Bt,Xt,Ft,Wt){for(var Yt=0,zt=Xt,er=Ft-Wt;zt<Ft;zt+=Wt)Yt+=(Bt[er]-Bt[zt])*(Bt[zt+1]+Bt[er+1]),er=zt;return Yt}return tt.flatten=function(Bt){for(var Xt=Bt[0][0].length,Ft={vertices:[],holes:[],dimensions:Xt},Wt=0,Yt=0;Yt<Bt.length;Yt++){for(var zt=0;zt<Bt[Yt].length;zt++)for(var er=0;er<Xt;er++)Ft.vertices.push(Bt[Yt][zt][er]);Yt>0&&(Wt+=Bt[Yt-1].length,Ft.holes.push(Wt))}return Ft},earcut$1.exports}var earcutExports=requireEarcut();const earcut=getDefaultExportFromCjs$1(earcutExports);var url={},punycode$1={exports:{}};var punycode=punycode$1.exports,hasRequiredPunycode;function requirePunycode(){return hasRequiredPunycode||(hasRequiredPunycode=1,(function(tt,et){(function(rt){var nt=et&&!et.nodeType&&et,it=tt&&!tt.nodeType&&tt,at=typeof commonjsGlobal$1=="object"&&commonjsGlobal$1;(at.global===at||at.window===at||at.self===at)&&(rt=at);var st,ot=2147483647,lt=36,ht=1,dt=26,ut=38,ft=700,mt=72,gt=128,vt="-",xt=/^xn--/,wt=/[^\x20-\x7E]/,At=/[\x2E\u3002\uFF0E\uFF61]/g,Tt={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Pt=lt-ht,Rt=Math.floor,Ot=String.fromCharCode,Et;function Lt(Yt){throw new RangeError(Tt[Yt])}function kt(Yt,zt){for(var er=Yt.length,dr=[];er--;)dr[er]=zt(Yt[er]);return dr}function jt(Yt,zt){var er=Yt.split("@"),dr="";er.length>1&&(dr=er[0]+"@",Yt=er[1]),Yt=Yt.replace(At,".");var fr=Yt.split("."),lr=kt(fr,zt).join(".");return dr+lr}function Mt(Yt){for(var zt=[],er=0,dr=Yt.length,fr,lr;er<dr;)fr=Yt.charCodeAt(er++),fr>=55296&&fr<=56319&&er<dr?(lr=Yt.charCodeAt(er++),(lr&64512)==56320?zt.push(((fr&1023)<<10)+(lr&1023)+65536):(zt.push(fr),er--)):zt.push(fr);return zt}function $t(Yt){return kt(Yt,function(zt){var er="";return zt>65535&&(zt-=65536,er+=Ot(zt>>>10&1023|55296),zt=56320|zt&1023),er+=Ot(zt),er}).join("")}function Qt(Yt){return Yt-48<10?Yt-22:Yt-65<26?Yt-65:Yt-97<26?Yt-97:lt}function Ht(Yt,zt){return Yt+22+75*(Yt<26)-((zt!=0)<<5)}function qt(Yt,zt,er){var dr=0;for(Yt=er?Rt(Yt/ft):Yt>>1,Yt+=Rt(Yt/zt);Yt>Pt*dt>>1;dr+=lt)Yt=Rt(Yt/Pt);return Rt(dr+(Pt+1)*Yt/(Yt+ut))}function Bt(Yt){var zt=[],er=Yt.length,dr,fr=0,lr=gt,mr=mt,br,Sr,Ir,cr,Nt,pr,rr,ar,nr;for(br=Yt.lastIndexOf(vt),br<0&&(br=0),Sr=0;Sr<br;++Sr)Yt.charCodeAt(Sr)>=128&&Lt("not-basic"),zt.push(Yt.charCodeAt(Sr));for(Ir=br>0?br+1:0;Ir<er;){for(cr=fr,Nt=1,pr=lt;Ir>=er&&Lt("invalid-input"),rr=Qt(Yt.charCodeAt(Ir++)),(rr>=lt||rr>Rt((ot-fr)/Nt))&&Lt("overflow"),fr+=rr*Nt,ar=pr<=mr?ht:pr>=mr+dt?dt:pr-mr,!(rr<ar);pr+=lt)nr=lt-ar,Nt>Rt(ot/nr)&&Lt("overflow"),Nt*=nr;dr=zt.length+1,mr=qt(fr-cr,dr,cr==0),Rt(fr/dr)>ot-lr&&Lt("overflow"),lr+=Rt(fr/dr),fr%=dr,zt.splice(fr++,0,lr)}return $t(zt)}function Xt(Yt){var zt,er,dr,fr,lr,mr,br,Sr,Ir,cr,Nt,pr=[],rr,ar,nr,ur;for(Yt=Mt(Yt),rr=Yt.length,zt=gt,er=0,lr=mt,mr=0;mr<rr;++mr)Nt=Yt[mr],Nt<128&&pr.push(Ot(Nt));for(dr=fr=pr.length,fr&&pr.push(vt);dr<rr;){for(br=ot,mr=0;mr<rr;++mr)Nt=Yt[mr],Nt>=zt&&Nt<br&&(br=Nt);for(ar=dr+1,br-zt>Rt((ot-er)/ar)&&Lt("overflow"),er+=(br-zt)*ar,zt=br,mr=0;mr<rr;++mr)if(Nt=Yt[mr],Nt<zt&&++er>ot&&Lt("overflow"),Nt==zt){for(Sr=er,Ir=lt;cr=Ir<=lr?ht:Ir>=lr+dt?dt:Ir-lr,!(Sr<cr);Ir+=lt)ur=Sr-cr,nr=lt-cr,pr.push(Ot(Ht(cr+ur%nr,0))),Sr=Rt(ur/nr);pr.push(Ot(Ht(Sr,0))),lr=qt(er,ar,dr==fr),er=0,++dr}++er,++zt}return pr.join("")}function Ft(Yt){return jt(Yt,function(zt){return xt.test(zt)?Bt(zt.slice(4).toLowerCase()):zt})}function Wt(Yt){return jt(Yt,function(zt){return wt.test(zt)?"xn--"+Xt(zt):zt})}if(st={version:"1.4.1",ucs2:{decode:Mt,encode:$t},decode:Bt,encode:Xt,toASCII:Wt,toUnicode:Ft},nt&&it)if(tt.exports==nt)it.exports=st;else for(Et in st)st.hasOwnProperty(Et)&&(nt[Et]=st[Et]);else rt.punycode=st})(punycode)})(punycode$1,punycode$1.exports)),punycode$1.exports}var type,hasRequiredType;function requireType(){return hasRequiredType||(hasRequiredType=1,type=TypeError),type}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0$2=getAugmentedNamespace$1(__viteBrowserExternal$1);var objectInspect,hasRequiredObjectInspect;function requireObjectInspect(){if(hasRequiredObjectInspect)return objectInspect;hasRequiredObjectInspect=1;var tt=typeof Map=="function"&&Map.prototype,et=Object.getOwnPropertyDescriptor&&tt?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,rt=tt&&et&&typeof et.get=="function"?et.get:null,nt=tt&&Map.prototype.forEach,it=typeof Set=="function"&&Set.prototype,at=Object.getOwnPropertyDescriptor&&it?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,st=it&&at&&typeof at.get=="function"?at.get:null,ot=it&&Set.prototype.forEach,lt=typeof WeakMap=="function"&&WeakMap.prototype,ht=lt?WeakMap.prototype.has:null,dt=typeof WeakSet=="function"&&WeakSet.prototype,ut=dt?WeakSet.prototype.has:null,ft=typeof WeakRef=="function"&&WeakRef.prototype,mt=ft?WeakRef.prototype.deref:null,gt=Boolean.prototype.valueOf,vt=Object.prototype.toString,xt=Function.prototype.toString,wt=String.prototype.match,At=String.prototype.slice,Tt=String.prototype.replace,Pt=String.prototype.toUpperCase,Rt=String.prototype.toLowerCase,Ot=RegExp.prototype.test,Et=Array.prototype.concat,Lt=Array.prototype.join,kt=Array.prototype.slice,jt=Math.floor,Mt=typeof BigInt=="function"?BigInt.prototype.valueOf:null,$t=Object.getOwnPropertySymbols,Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ht=typeof Symbol=="function"&&typeof Symbol.iterator=="object",qt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ht||!0)?Symbol.toStringTag:null,Bt=Object.prototype.propertyIsEnumerable,Xt=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(_r){return _r.__proto__}:null);function Ft(_r,Rr){if(_r===1/0||_r===-1/0||_r!==_r||_r&&_r>-1e3&&_r<1e3||Ot.call(/e/,Rr))return Rr;var yr=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof _r=="number"){var Kr=_r<0?-jt(-_r):jt(_r);if(Kr!==_r){var Jr=String(Kr),Zt=At.call(Rr,Jr.length+1);return Tt.call(Jr,yr,"$&_")+"."+Tt.call(Tt.call(Zt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Tt.call(Rr,yr,"$&_")}var Wt=require$$0$2,Yt=Wt.custom,zt=ar(Yt)?Yt:null,er={__proto__:null,double:'"',single:"'"},dr={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};objectInspect=function _r(Rr,yr,Kr,Jr){var Zt=yr||{};if(Er(Zt,"quoteStyle")&&!Er(er,Zt.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Er(Zt,"maxStringLength")&&(typeof Zt.maxStringLength=="number"?Zt.maxStringLength<0&&Zt.maxStringLength!==1/0:Zt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Qr=Er(Zt,"customInspect")?Zt.customInspect:!0;if(typeof Qr!="boolean"&&Qr!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Er(Zt,"indent")&&Zt.indent!==null&&Zt.indent!=="	"&&!(parseInt(Zt.indent,10)===Zt.indent&&Zt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Er(Zt,"numericSeparator")&&typeof Zt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Dr=Zt.numericSeparator;if(typeof Rr>"u")return"undefined";if(Rr===null)return"null";if(typeof Rr=="boolean")return Rr?"true":"false";if(typeof Rr=="string")return Kn(Rr,Zt);if(typeof Rr=="number"){if(Rr===0)return 1/0/Rr>0?"0":"-0";var Pr=String(Rr);return Dr?Ft(Rr,Pr):Pr}if(typeof Rr=="bigint"){var Hr=String(Rr)+"n";return Dr?Ft(Rr,Hr):Hr}var qr=typeof Zt.depth>"u"?5:Zt.depth;if(typeof Kr>"u"&&(Kr=0),Kr>=qr&&qr>0&&typeof Rr=="object")return br(Rr)?"[Array]":"[Object]";var bi=pi(Zt,Kr);if(typeof Jr>"u")Jr=[];else if(or(Jr,Rr)>=0)return"[Circular]";function ri(Es,is,zo){if(is&&(Jr=kt.call(Jr),Jr.push(is)),zo){var Xs={depth:Zt.depth};return Er(Zt,"quoteStyle")&&(Xs.quoteStyle=Zt.quoteStyle),_r(Es,Xs,Kr+1,Jr)}return _r(Es,Zt,Kr+1,Jr)}if(typeof Rr=="function"&&!Ir(Rr)){var yi=Kt(Rr),Li=qn(Rr,ri);return"[Function"+(yi?": "+yi:" (anonymous)")+"]"+(Li.length>0?" { "+Lt.call(Li,", ")+" }":"")}if(ar(Rr)){var xa=Ht?Tt.call(String(Rr),/^(Symbol\(.*\))_[^)]*$/,"$1"):Qt.call(Rr);return typeof Rr=="object"&&!Ht?vi(xa):xa}if(Mn(Rr)){for(var Ti="<"+Rt.call(String(Rr.nodeName)),$i=Rr.attributes||[],Ji=0;Ji<$i.length;Ji++)Ti+=" "+$i[Ji].name+"="+fr(lr($i[Ji].value),"double",Zt);return Ti+=">",Rr.childNodes&&Rr.childNodes.length&&(Ti+="..."),Ti+="</"+Rt.call(String(Rr.nodeName))+">",Ti}if(br(Rr)){if(Rr.length===0)return"[]";var ea=qn(Rr,ri);return bi&&!Ri(ea)?"["+Tr(ea,bi)+"]":"[ "+Lt.call(ea,", ")+" ]"}if(cr(Rr)){var Na=qn(Rr,ri);return!("cause"in Error.prototype)&&"cause"in Rr&&!Bt.call(Rr,"cause")?"{ ["+String(Rr)+"] "+Lt.call(Et.call("[cause]: "+ri(Rr.cause),Na),", ")+" }":Na.length===0?"["+String(Rr)+"]":"{ ["+String(Rr)+"] "+Lt.call(Na,", ")+" }"}if(typeof Rr=="object"&&Qr){if(zt&&typeof Rr[zt]=="function"&&Wt)return Wt(Rr,{depth:qr-Kr});if(Qr!=="symbol"&&typeof Rr.inspect=="function")return Rr.inspect()}if(hr(Rr)){var Oa=[];return nt&&nt.call(Rr,function(Es,is){Oa.push(ri(is,Rr,!0)+" => "+ri(Es,Rr))}),_i("Map",rt.call(Rr),Oa,bi)}if(Gn(Rr)){var la=[];return ot&&ot.call(Rr,function(Es){la.push(ri(Es,Rr))}),_i("Set",st.call(Rr),la,bi)}if(kr(Rr))return mi("WeakMap");if(Xn(Rr))return mi("WeakSet");if(Br(Rr))return mi("WeakRef");if(pr(Rr))return vi(ri(Number(Rr)));if(nr(Rr))return vi(ri(Mt.call(Rr)));if(rr(Rr))return vi(gt.call(Rr));if(Nt(Rr))return vi(ri(String(Rr)));if(typeof window<"u"&&Rr===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Rr===globalThis||typeof commonjsGlobal$1<"u"&&Rr===commonjsGlobal$1)return"{ [object globalThis] }";if(!Sr(Rr)&&!Ir(Rr)){var ua=qn(Rr,ri),ka=Xt?Xt(Rr)===Object.prototype:Rr instanceof Object||Rr.constructor===Object,Xi=Rr instanceof Object?"":"null prototype",ca=!ka&&qt&&Object(Rr)===Rr&&qt in Rr?At.call(Ut(Rr),8,-1):Xi?"Object":"",_a=ka||typeof Rr.constructor!="function"?"":Rr.constructor.name?Rr.constructor.name+" ":"",Ua=_a+(ca||Xi?"["+Lt.call(Et.call([],ca||[],Xi||[]),": ")+"] ":"");return ua.length===0?Ua+"{}":bi?Ua+"{"+Tr(ua,bi)+"}":Ua+"{ "+Lt.call(ua,", ")+" }"}return String(Rr)};function fr(_r,Rr,yr){var Kr=yr.quoteStyle||Rr,Jr=er[Kr];return Jr+_r+Jr}function lr(_r){return Tt.call(String(_r),/"/g,"&quot;")}function mr(_r){return!qt||!(typeof _r=="object"&&(qt in _r||typeof _r[qt]<"u"))}function br(_r){return Ut(_r)==="[object Array]"&&mr(_r)}function Sr(_r){return Ut(_r)==="[object Date]"&&mr(_r)}function Ir(_r){return Ut(_r)==="[object RegExp]"&&mr(_r)}function cr(_r){return Ut(_r)==="[object Error]"&&mr(_r)}function Nt(_r){return Ut(_r)==="[object String]"&&mr(_r)}function pr(_r){return Ut(_r)==="[object Number]"&&mr(_r)}function rr(_r){return Ut(_r)==="[object Boolean]"&&mr(_r)}function ar(_r){if(Ht)return _r&&typeof _r=="object"&&_r instanceof Symbol;if(typeof _r=="symbol")return!0;if(!_r||typeof _r!="object"||!Qt)return!1;try{return Qt.call(_r),!0}catch{}return!1}function nr(_r){if(!_r||typeof _r!="object"||!Mt)return!1;try{return Mt.call(_r),!0}catch{}return!1}var ur=Object.prototype.hasOwnProperty||function(_r){return _r in this};function Er(_r,Rr){return ur.call(_r,Rr)}function Ut(_r){return vt.call(_r)}function Kt(_r){if(_r.name)return _r.name;var Rr=wt.call(xt.call(_r),/^function\s*([\w$]+)/);return Rr?Rr[1]:null}function or(_r,Rr){if(_r.indexOf)return _r.indexOf(Rr);for(var yr=0,Kr=_r.length;yr<Kr;yr++)if(_r[yr]===Rr)return yr;return-1}function hr(_r){if(!rt||!_r||typeof _r!="object")return!1;try{rt.call(_r);try{st.call(_r)}catch{return!0}return _r instanceof Map}catch{}return!1}function kr(_r){if(!ht||!_r||typeof _r!="object")return!1;try{ht.call(_r,ht);try{ut.call(_r,ut)}catch{return!0}return _r instanceof WeakMap}catch{}return!1}function Br(_r){if(!mt||!_r||typeof _r!="object")return!1;try{return mt.call(_r),!0}catch{}return!1}function Gn(_r){if(!st||!_r||typeof _r!="object")return!1;try{st.call(_r);try{rt.call(_r)}catch{return!0}return _r instanceof Set}catch{}return!1}function Xn(_r){if(!ut||!_r||typeof _r!="object")return!1;try{ut.call(_r,ut);try{ht.call(_r,ht)}catch{return!0}return _r instanceof WeakSet}catch{}return!1}function Mn(_r){return!_r||typeof _r!="object"?!1:typeof HTMLElement<"u"&&_r instanceof HTMLElement?!0:typeof _r.nodeName=="string"&&typeof _r.getAttribute=="function"}function Kn(_r,Rr){if(_r.length>Rr.maxStringLength){var yr=_r.length-Rr.maxStringLength,Kr="... "+yr+" more character"+(yr>1?"s":"");return Kn(At.call(_r,0,Rr.maxStringLength),Rr)+Kr}var Jr=dr[Rr.quoteStyle||"single"];Jr.lastIndex=0;var Zt=Tt.call(Tt.call(_r,Jr,"\\$1"),/[\x00-\x1f]/g,Vn);return fr(Zt,"single",Rr)}function Vn(_r){var Rr=_r.charCodeAt(0),yr={8:"b",9:"t",10:"n",12:"f",13:"r"}[Rr];return yr?"\\"+yr:"\\x"+(Rr<16?"0":"")+Pt.call(Rr.toString(16))}function vi(_r){return"Object("+_r+")"}function mi(_r){return _r+" { ? }"}function _i(_r,Rr,yr,Kr){var Jr=Kr?Tr(yr,Kr):Lt.call(yr,", ");return _r+" ("+Rr+") {"+Jr+"}"}function Ri(_r){for(var Rr=0;Rr<_r.length;Rr++)if(or(_r[Rr],`
`)>=0)return!1;return!0}function pi(_r,Rr){var yr;if(_r.indent==="	")yr="	";else if(typeof _r.indent=="number"&&_r.indent>0)yr=Lt.call(Array(_r.indent+1)," ");else return null;return{base:yr,prev:Lt.call(Array(Rr+1),yr)}}function Tr(_r,Rr){if(_r.length===0)return"";var yr=`
`+Rr.prev+Rr.base;return yr+Lt.call(_r,","+yr)+`
`+Rr.prev}function qn(_r,Rr){var yr=br(_r),Kr=[];if(yr){Kr.length=_r.length;for(var Jr=0;Jr<_r.length;Jr++)Kr[Jr]=Er(_r,Jr)?Rr(_r[Jr],_r):""}var Zt=typeof $t=="function"?$t(_r):[],Qr;if(Ht){Qr={};for(var Dr=0;Dr<Zt.length;Dr++)Qr["$"+Zt[Dr]]=Zt[Dr]}for(var Pr in _r)Er(_r,Pr)&&(yr&&String(Number(Pr))===Pr&&Pr<_r.length||Ht&&Qr["$"+Pr]instanceof Symbol||(Ot.call(/[^\w$]/,Pr)?Kr.push(Rr(Pr,_r)+": "+Rr(_r[Pr],_r)):Kr.push(Pr+": "+Rr(_r[Pr],_r))));if(typeof $t=="function")for(var Hr=0;Hr<Zt.length;Hr++)Bt.call(_r,Zt[Hr])&&Kr.push("["+Rr(Zt[Hr])+"]: "+Rr(_r[Zt[Hr]],_r));return Kr}return objectInspect}var sideChannelList,hasRequiredSideChannelList;function requireSideChannelList(){if(hasRequiredSideChannelList)return sideChannelList;hasRequiredSideChannelList=1;var tt=requireObjectInspect(),et=requireType(),rt=function(ot,lt,ht){for(var dt=ot,ut;(ut=dt.next)!=null;dt=ut)if(ut.key===lt)return dt.next=ut.next,ht||(ut.next=ot.next,ot.next=ut),ut},nt=function(ot,lt){if(ot){var ht=rt(ot,lt);return ht&&ht.value}},it=function(ot,lt,ht){var dt=rt(ot,lt);dt?dt.value=ht:ot.next={key:lt,next:ot.next,value:ht}},at=function(ot,lt){return ot?!!rt(ot,lt):!1},st=function(ot,lt){if(ot)return rt(ot,lt,!0)};return sideChannelList=function(){var lt,ht={assert:function(dt){if(!ht.has(dt))throw new et("Side channel does not contain "+tt(dt))},delete:function(dt){var ut=lt&&lt.next,ft=st(lt,dt);return ft&&ut&&ut===ft&&(lt=void 0),!!ft},get:function(dt){return nt(lt,dt)},has:function(dt){return at(lt,dt)},set:function(dt,ut){lt||(lt={next:void 0}),it(lt,dt,ut)}};return ht},sideChannelList}var esObjectAtoms,hasRequiredEsObjectAtoms;function requireEsObjectAtoms(){return hasRequiredEsObjectAtoms||(hasRequiredEsObjectAtoms=1,esObjectAtoms=Object),esObjectAtoms}var esErrors,hasRequiredEsErrors;function requireEsErrors(){return hasRequiredEsErrors||(hasRequiredEsErrors=1,esErrors=Error),esErrors}var _eval,hasRequired_eval;function require_eval(){return hasRequired_eval||(hasRequired_eval=1,_eval=EvalError),_eval}var range,hasRequiredRange;function requireRange(){return hasRequiredRange||(hasRequiredRange=1,range=RangeError),range}var ref,hasRequiredRef;function requireRef(){return hasRequiredRef||(hasRequiredRef=1,ref=ReferenceError),ref}var syntax,hasRequiredSyntax;function requireSyntax(){return hasRequiredSyntax||(hasRequiredSyntax=1,syntax=SyntaxError),syntax}var uri,hasRequiredUri;function requireUri(){return hasRequiredUri||(hasRequiredUri=1,uri=URIError),uri}var abs,hasRequiredAbs;function requireAbs(){return hasRequiredAbs||(hasRequiredAbs=1,abs=Math.abs),abs}var floor,hasRequiredFloor;function requireFloor(){return hasRequiredFloor||(hasRequiredFloor=1,floor=Math.floor),floor}var max,hasRequiredMax;function requireMax(){return hasRequiredMax||(hasRequiredMax=1,max=Math.max),max}var min,hasRequiredMin;function requireMin(){return hasRequiredMin||(hasRequiredMin=1,min=Math.min),min}var pow,hasRequiredPow;function requirePow(){return hasRequiredPow||(hasRequiredPow=1,pow=Math.pow),pow}var round$1,hasRequiredRound;function requireRound(){return hasRequiredRound||(hasRequiredRound=1,round$1=Math.round),round$1}var _isNaN,hasRequired_isNaN;function require_isNaN(){return hasRequired_isNaN||(hasRequired_isNaN=1,_isNaN=Number.isNaN||function(et){return et!==et}),_isNaN}var sign$1,hasRequiredSign;function requireSign(){if(hasRequiredSign)return sign$1;hasRequiredSign=1;var tt=require_isNaN();return sign$1=function(rt){return tt(rt)||rt===0?rt:rt<0?-1:1},sign$1}var gOPD,hasRequiredGOPD;function requireGOPD(){return hasRequiredGOPD||(hasRequiredGOPD=1,gOPD=Object.getOwnPropertyDescriptor),gOPD}var gopd,hasRequiredGopd;function requireGopd(){if(hasRequiredGopd)return gopd;hasRequiredGopd=1;var tt=requireGOPD();if(tt)try{tt([],"length")}catch{tt=null}return gopd=tt,gopd}var esDefineProperty,hasRequiredEsDefineProperty;function requireEsDefineProperty(){if(hasRequiredEsDefineProperty)return esDefineProperty;hasRequiredEsDefineProperty=1;var tt=Object.defineProperty||!1;if(tt)try{tt({},"a",{value:1})}catch{tt=!1}return esDefineProperty=tt,esDefineProperty}var shams,hasRequiredShams;function requireShams(){return hasRequiredShams||(hasRequiredShams=1,shams=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var et={},rt=Symbol("test"),nt=Object(rt);if(typeof rt=="string"||Object.prototype.toString.call(rt)!=="[object Symbol]"||Object.prototype.toString.call(nt)!=="[object Symbol]")return!1;var it=42;et[rt]=it;for(var at in et)return!1;if(typeof Object.keys=="function"&&Object.keys(et).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(et).length!==0)return!1;var st=Object.getOwnPropertySymbols(et);if(st.length!==1||st[0]!==rt||!Object.prototype.propertyIsEnumerable.call(et,rt))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var ot=Object.getOwnPropertyDescriptor(et,rt);if(ot.value!==it||ot.enumerable!==!0)return!1}return!0}),shams}var hasSymbols,hasRequiredHasSymbols;function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols;hasRequiredHasSymbols=1;var tt=typeof Symbol<"u"&&Symbol,et=requireShams();return hasSymbols=function(){return typeof tt!="function"||typeof Symbol!="function"||typeof tt("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:et()},hasSymbols}var Reflect_getPrototypeOf,hasRequiredReflect_getPrototypeOf;function requireReflect_getPrototypeOf(){return hasRequiredReflect_getPrototypeOf||(hasRequiredReflect_getPrototypeOf=1,Reflect_getPrototypeOf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Reflect_getPrototypeOf}var Object_getPrototypeOf,hasRequiredObject_getPrototypeOf;function requireObject_getPrototypeOf(){if(hasRequiredObject_getPrototypeOf)return Object_getPrototypeOf;hasRequiredObject_getPrototypeOf=1;var tt=requireEsObjectAtoms();return Object_getPrototypeOf=tt.getPrototypeOf||null,Object_getPrototypeOf}var implementation,hasRequiredImplementation;function requireImplementation(){if(hasRequiredImplementation)return implementation;hasRequiredImplementation=1;var tt="Function.prototype.bind called on incompatible ",et=Object.prototype.toString,rt=Math.max,nt="[object Function]",it=function(lt,ht){for(var dt=[],ut=0;ut<lt.length;ut+=1)dt[ut]=lt[ut];for(var ft=0;ft<ht.length;ft+=1)dt[ft+lt.length]=ht[ft];return dt},at=function(lt,ht){for(var dt=[],ut=ht,ft=0;ut<lt.length;ut+=1,ft+=1)dt[ft]=lt[ut];return dt},st=function(ot,lt){for(var ht="",dt=0;dt<ot.length;dt+=1)ht+=ot[dt],dt+1<ot.length&&(ht+=lt);return ht};return implementation=function(lt){var ht=this;if(typeof ht!="function"||et.apply(ht)!==nt)throw new TypeError(tt+ht);for(var dt=at(arguments,1),ut,ft=function(){if(this instanceof ut){var wt=ht.apply(this,it(dt,arguments));return Object(wt)===wt?wt:this}return ht.apply(lt,it(dt,arguments))},mt=rt(0,ht.length-dt.length),gt=[],vt=0;vt<mt;vt++)gt[vt]="$"+vt;if(ut=Function("binder","return function ("+st(gt,",")+"){ return binder.apply(this,arguments); }")(ft),ht.prototype){var xt=function(){};xt.prototype=ht.prototype,ut.prototype=new xt,xt.prototype=null}return ut},implementation}var functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var tt=requireImplementation();return functionBind=Function.prototype.bind||tt,functionBind}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){return hasRequiredFunctionCall||(hasRequiredFunctionCall=1,functionCall=Function.prototype.call),functionCall}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){return hasRequiredFunctionApply||(hasRequiredFunctionApply=1,functionApply=Function.prototype.apply),functionApply}var reflectApply,hasRequiredReflectApply;function requireReflectApply(){return hasRequiredReflectApply||(hasRequiredReflectApply=1,reflectApply=typeof Reflect<"u"&&Reflect&&Reflect.apply),reflectApply}var actualApply,hasRequiredActualApply;function requireActualApply(){if(hasRequiredActualApply)return actualApply;hasRequiredActualApply=1;var tt=requireFunctionBind(),et=requireFunctionApply(),rt=requireFunctionCall(),nt=requireReflectApply();return actualApply=nt||tt.call(rt,et),actualApply}var callBindApplyHelpers,hasRequiredCallBindApplyHelpers;function requireCallBindApplyHelpers(){if(hasRequiredCallBindApplyHelpers)return callBindApplyHelpers;hasRequiredCallBindApplyHelpers=1;var tt=requireFunctionBind(),et=requireType(),rt=requireFunctionCall(),nt=requireActualApply();return callBindApplyHelpers=function(at){if(at.length<1||typeof at[0]!="function")throw new et("a function is required");return nt(tt,rt,at)},callBindApplyHelpers}var get,hasRequiredGet;function requireGet(){if(hasRequiredGet)return get;hasRequiredGet=1;var tt=requireCallBindApplyHelpers(),et=requireGopd(),rt;try{rt=[].__proto__===Array.prototype}catch(st){if(!st||typeof st!="object"||!("code"in st)||st.code!=="ERR_PROTO_ACCESS")throw st}var nt=!!rt&&et&&et(Object.prototype,"__proto__"),it=Object,at=it.getPrototypeOf;return get=nt&&typeof nt.get=="function"?tt([nt.get]):typeof at=="function"?function(ot){return at(ot==null?ot:it(ot))}:!1,get}var getProto,hasRequiredGetProto;function requireGetProto(){if(hasRequiredGetProto)return getProto;hasRequiredGetProto=1;var tt=requireReflect_getPrototypeOf(),et=requireObject_getPrototypeOf(),rt=requireGet();return getProto=tt?function(it){return tt(it)}:et?function(it){if(!it||typeof it!="object"&&typeof it!="function")throw new TypeError("getProto: not an object");return et(it)}:rt?function(it){return rt(it)}:null,getProto}var hasown,hasRequiredHasown;function requireHasown(){if(hasRequiredHasown)return hasown;hasRequiredHasown=1;var tt=Function.prototype.call,et=Object.prototype.hasOwnProperty,rt=requireFunctionBind();return hasown=rt.call(tt,et),hasown}var getIntrinsic,hasRequiredGetIntrinsic;function requireGetIntrinsic(){if(hasRequiredGetIntrinsic)return getIntrinsic;hasRequiredGetIntrinsic=1;var tt,et=requireEsObjectAtoms(),rt=requireEsErrors(),nt=require_eval(),it=requireRange(),at=requireRef(),st=requireSyntax(),ot=requireType(),lt=requireUri(),ht=requireAbs(),dt=requireFloor(),ut=requireMax(),ft=requireMin(),mt=requirePow(),gt=requireRound(),vt=requireSign(),xt=Function,wt=function(Ir){try{return xt('"use strict"; return ('+Ir+").constructor;")()}catch{}},At=requireGopd(),Tt=requireEsDefineProperty(),Pt=function(){throw new ot},Rt=At?(function(){try{return arguments.callee,Pt}catch{try{return At(arguments,"callee").get}catch{return Pt}}})():Pt,Ot=requireHasSymbols()(),Et=requireGetProto(),Lt=requireObject_getPrototypeOf(),kt=requireReflect_getPrototypeOf(),jt=requireFunctionApply(),Mt=requireFunctionCall(),$t={},Qt=typeof Uint8Array>"u"||!Et?tt:Et(Uint8Array),Ht={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?tt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?tt:ArrayBuffer,"%ArrayIteratorPrototype%":Ot&&Et?Et([][Symbol.iterator]()):tt,"%AsyncFromSyncIteratorPrototype%":tt,"%AsyncFunction%":$t,"%AsyncGenerator%":$t,"%AsyncGeneratorFunction%":$t,"%AsyncIteratorPrototype%":$t,"%Atomics%":typeof Atomics>"u"?tt:Atomics,"%BigInt%":typeof BigInt>"u"?tt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?tt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?tt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?tt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":rt,"%eval%":eval,"%EvalError%":nt,"%Float16Array%":typeof Float16Array>"u"?tt:Float16Array,"%Float32Array%":typeof Float32Array>"u"?tt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?tt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?tt:FinalizationRegistry,"%Function%":xt,"%GeneratorFunction%":$t,"%Int8Array%":typeof Int8Array>"u"?tt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?tt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?tt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ot&&Et?Et(Et([][Symbol.iterator]())):tt,"%JSON%":typeof JSON=="object"?JSON:tt,"%Map%":typeof Map>"u"?tt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ot||!Et?tt:Et(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":et,"%Object.getOwnPropertyDescriptor%":At,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?tt:Promise,"%Proxy%":typeof Proxy>"u"?tt:Proxy,"%RangeError%":it,"%ReferenceError%":at,"%Reflect%":typeof Reflect>"u"?tt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?tt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ot||!Et?tt:Et(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?tt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ot&&Et?Et(""[Symbol.iterator]()):tt,"%Symbol%":Ot?Symbol:tt,"%SyntaxError%":st,"%ThrowTypeError%":Rt,"%TypedArray%":Qt,"%TypeError%":ot,"%Uint8Array%":typeof Uint8Array>"u"?tt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?tt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?tt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?tt:Uint32Array,"%URIError%":lt,"%WeakMap%":typeof WeakMap>"u"?tt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?tt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?tt:WeakSet,"%Function.prototype.call%":Mt,"%Function.prototype.apply%":jt,"%Object.defineProperty%":Tt,"%Object.getPrototypeOf%":Lt,"%Math.abs%":ht,"%Math.floor%":dt,"%Math.max%":ut,"%Math.min%":ft,"%Math.pow%":mt,"%Math.round%":gt,"%Math.sign%":vt,"%Reflect.getPrototypeOf%":kt};if(Et)try{null.error}catch(Ir){var qt=Et(Et(Ir));Ht["%Error.prototype%"]=qt}var Bt=function Ir(cr){var Nt;if(cr==="%AsyncFunction%")Nt=wt("async function () {}");else if(cr==="%GeneratorFunction%")Nt=wt("function* () {}");else if(cr==="%AsyncGeneratorFunction%")Nt=wt("async function* () {}");else if(cr==="%AsyncGenerator%"){var pr=Ir("%AsyncGeneratorFunction%");pr&&(Nt=pr.prototype)}else if(cr==="%AsyncIteratorPrototype%"){var rr=Ir("%AsyncGenerator%");rr&&Et&&(Nt=Et(rr.prototype))}return Ht[cr]=Nt,Nt},Xt={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ft=requireFunctionBind(),Wt=requireHasown(),Yt=Ft.call(Mt,Array.prototype.concat),zt=Ft.call(jt,Array.prototype.splice),er=Ft.call(Mt,String.prototype.replace),dr=Ft.call(Mt,String.prototype.slice),fr=Ft.call(Mt,RegExp.prototype.exec),lr=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,mr=/\\(\\)?/g,br=function(cr){var Nt=dr(cr,0,1),pr=dr(cr,-1);if(Nt==="%"&&pr!=="%")throw new st("invalid intrinsic syntax, expected closing `%`");if(pr==="%"&&Nt!=="%")throw new st("invalid intrinsic syntax, expected opening `%`");var rr=[];return er(cr,lr,function(ar,nr,ur,Er){rr[rr.length]=ur?er(Er,mr,"$1"):nr||ar}),rr},Sr=function(cr,Nt){var pr=cr,rr;if(Wt(Xt,pr)&&(rr=Xt[pr],pr="%"+rr[0]+"%"),Wt(Ht,pr)){var ar=Ht[pr];if(ar===$t&&(ar=Bt(pr)),typeof ar>"u"&&!Nt)throw new ot("intrinsic "+cr+" exists, but is not available. Please file an issue!");return{alias:rr,name:pr,value:ar}}throw new st("intrinsic "+cr+" does not exist!")};return getIntrinsic=function(cr,Nt){if(typeof cr!="string"||cr.length===0)throw new ot("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Nt!="boolean")throw new ot('"allowMissing" argument must be a boolean');if(fr(/^%?[^%]*%?$/,cr)===null)throw new st("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var pr=br(cr),rr=pr.length>0?pr[0]:"",ar=Sr("%"+rr+"%",Nt),nr=ar.name,ur=ar.value,Er=!1,Ut=ar.alias;Ut&&(rr=Ut[0],zt(pr,Yt([0,1],Ut)));for(var Kt=1,or=!0;Kt<pr.length;Kt+=1){var hr=pr[Kt],kr=dr(hr,0,1),Br=dr(hr,-1);if((kr==='"'||kr==="'"||kr==="`"||Br==='"'||Br==="'"||Br==="`")&&kr!==Br)throw new st("property names with quotes must have matching quotes");if((hr==="constructor"||!or)&&(Er=!0),rr+="."+hr,nr="%"+rr+"%",Wt(Ht,nr))ur=Ht[nr];else if(ur!=null){if(!(hr in ur)){if(!Nt)throw new ot("base intrinsic for "+cr+" exists, but the property is not available.");return}if(At&&Kt+1>=pr.length){var Gn=At(ur,hr);or=!!Gn,or&&"get"in Gn&&!("originalValue"in Gn.get)?ur=Gn.get:ur=ur[hr]}else or=Wt(ur,hr),ur=ur[hr];or&&!Er&&(Ht[nr]=ur)}}return ur},getIntrinsic}var callBound,hasRequiredCallBound;function requireCallBound(){if(hasRequiredCallBound)return callBound;hasRequiredCallBound=1;var tt=requireGetIntrinsic(),et=requireCallBindApplyHelpers(),rt=et([tt("%String.prototype.indexOf%")]);return callBound=function(it,at){var st=tt(it,!!at);return typeof st=="function"&&rt(it,".prototype.")>-1?et([st]):st},callBound}var sideChannelMap,hasRequiredSideChannelMap;function requireSideChannelMap(){if(hasRequiredSideChannelMap)return sideChannelMap;hasRequiredSideChannelMap=1;var tt=requireGetIntrinsic(),et=requireCallBound(),rt=requireObjectInspect(),nt=requireType(),it=tt("%Map%",!0),at=et("Map.prototype.get",!0),st=et("Map.prototype.set",!0),ot=et("Map.prototype.has",!0),lt=et("Map.prototype.delete",!0),ht=et("Map.prototype.size",!0);return sideChannelMap=!!it&&function(){var ut,ft={assert:function(mt){if(!ft.has(mt))throw new nt("Side channel does not contain "+rt(mt))},delete:function(mt){if(ut){var gt=lt(ut,mt);return ht(ut)===0&&(ut=void 0),gt}return!1},get:function(mt){if(ut)return at(ut,mt)},has:function(mt){return ut?ot(ut,mt):!1},set:function(mt,gt){ut||(ut=new it),st(ut,mt,gt)}};return ft},sideChannelMap}var sideChannelWeakmap,hasRequiredSideChannelWeakmap;function requireSideChannelWeakmap(){if(hasRequiredSideChannelWeakmap)return sideChannelWeakmap;hasRequiredSideChannelWeakmap=1;var tt=requireGetIntrinsic(),et=requireCallBound(),rt=requireObjectInspect(),nt=requireSideChannelMap(),it=requireType(),at=tt("%WeakMap%",!0),st=et("WeakMap.prototype.get",!0),ot=et("WeakMap.prototype.set",!0),lt=et("WeakMap.prototype.has",!0),ht=et("WeakMap.prototype.delete",!0);return sideChannelWeakmap=at?function(){var ut,ft,mt={assert:function(gt){if(!mt.has(gt))throw new it("Side channel does not contain "+rt(gt))},delete:function(gt){if(at&&gt&&(typeof gt=="object"||typeof gt=="function")){if(ut)return ht(ut,gt)}else if(nt&&ft)return ft.delete(gt);return!1},get:function(gt){return at&&gt&&(typeof gt=="object"||typeof gt=="function")&&ut?st(ut,gt):ft&&ft.get(gt)},has:function(gt){return at&&gt&&(typeof gt=="object"||typeof gt=="function")&&ut?lt(ut,gt):!!ft&&ft.has(gt)},set:function(gt,vt){at&&gt&&(typeof gt=="object"||typeof gt=="function")?(ut||(ut=new at),ot(ut,gt,vt)):nt&&(ft||(ft=nt()),ft.set(gt,vt))}};return mt}:nt,sideChannelWeakmap}var sideChannel,hasRequiredSideChannel;function requireSideChannel(){if(hasRequiredSideChannel)return sideChannel;hasRequiredSideChannel=1;var tt=requireType(),et=requireObjectInspect(),rt=requireSideChannelList(),nt=requireSideChannelMap(),it=requireSideChannelWeakmap(),at=it||nt||rt;return sideChannel=function(){var ot,lt={assert:function(ht){if(!lt.has(ht))throw new tt("Side channel does not contain "+et(ht))},delete:function(ht){return!!ot&&ot.delete(ht)},get:function(ht){return ot&&ot.get(ht)},has:function(ht){return!!ot&&ot.has(ht)},set:function(ht,dt){ot||(ot=at()),ot.set(ht,dt)}};return lt},sideChannel}var formats$1,hasRequiredFormats;function requireFormats(){if(hasRequiredFormats)return formats$1;hasRequiredFormats=1;var tt=String.prototype.replace,et=/%20/g,rt={RFC1738:"RFC1738",RFC3986:"RFC3986"};return formats$1={default:rt.RFC3986,formatters:{RFC1738:function(nt){return tt.call(nt,et,"+")},RFC3986:function(nt){return String(nt)}},RFC1738:rt.RFC1738,RFC3986:rt.RFC3986},formats$1}var utils,hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;var tt=requireFormats(),et=requireSideChannel(),rt=Object.prototype.hasOwnProperty,nt=Array.isArray,it=et(),at=function(Et,Lt){return it.set(Et,Lt),Et},st=function(Et){return it.has(Et)},ot=function(Et){return it.get(Et)},lt=function(Et,Lt){it.set(Et,Lt)},ht=(function(){for(var Ot=[],Et=0;Et<256;++Et)Ot.push("%"+((Et<16?"0":"")+Et.toString(16)).toUpperCase());return Ot})(),dt=function(Et){for(;Et.length>1;){var Lt=Et.pop(),kt=Lt.obj[Lt.prop];if(nt(kt)){for(var jt=[],Mt=0;Mt<kt.length;++Mt)typeof kt[Mt]<"u"&&jt.push(kt[Mt]);Lt.obj[Lt.prop]=jt}}},ut=function(Et,Lt){for(var kt=Lt&&Lt.plainObjects?{__proto__:null}:{},jt=0;jt<Et.length;++jt)typeof Et[jt]<"u"&&(kt[jt]=Et[jt]);return kt},ft=function Ot(Et,Lt,kt){if(!Lt)return Et;if(typeof Lt!="object"&&typeof Lt!="function"){if(nt(Et))Et.push(Lt);else if(Et&&typeof Et=="object")if(st(Et)){var jt=ot(Et)+1;Et[jt]=Lt,lt(Et,jt)}else(kt&&(kt.plainObjects||kt.allowPrototypes)||!rt.call(Object.prototype,Lt))&&(Et[Lt]=!0);else return[Et,Lt];return Et}if(!Et||typeof Et!="object"){if(st(Lt)){for(var Mt=Object.keys(Lt),$t=kt&&kt.plainObjects?{__proto__:null,0:Et}:{0:Et},Qt=0;Qt<Mt.length;Qt++){var Ht=parseInt(Mt[Qt],10);$t[Ht+1]=Lt[Mt[Qt]]}return at($t,ot(Lt)+1)}return[Et].concat(Lt)}var qt=Et;return nt(Et)&&!nt(Lt)&&(qt=ut(Et,kt)),nt(Et)&&nt(Lt)?(Lt.forEach(function(Bt,Xt){if(rt.call(Et,Xt)){var Ft=Et[Xt];Ft&&typeof Ft=="object"&&Bt&&typeof Bt=="object"?Et[Xt]=Ot(Ft,Bt,kt):Et.push(Bt)}else Et[Xt]=Bt}),Et):Object.keys(Lt).reduce(function(Bt,Xt){var Ft=Lt[Xt];return rt.call(Bt,Xt)?Bt[Xt]=Ot(Bt[Xt],Ft,kt):Bt[Xt]=Ft,Bt},qt)},mt=function(Et,Lt){return Object.keys(Lt).reduce(function(kt,jt){return kt[jt]=Lt[jt],kt},Et)},gt=function(Ot,Et,Lt){var kt=Ot.replace(/\+/g," ");if(Lt==="iso-8859-1")return kt.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(kt)}catch{return kt}},vt=1024,xt=function(Et,Lt,kt,jt,Mt){if(Et.length===0)return Et;var $t=Et;if(typeof Et=="symbol"?$t=Symbol.prototype.toString.call(Et):typeof Et!="string"&&($t=String(Et)),kt==="iso-8859-1")return escape($t).replace(/%u[0-9a-f]{4}/gi,function(Wt){return"%26%23"+parseInt(Wt.slice(2),16)+"%3B"});for(var Qt="",Ht=0;Ht<$t.length;Ht+=vt){for(var qt=$t.length>=vt?$t.slice(Ht,Ht+vt):$t,Bt=[],Xt=0;Xt<qt.length;++Xt){var Ft=qt.charCodeAt(Xt);if(Ft===45||Ft===46||Ft===95||Ft===126||Ft>=48&&Ft<=57||Ft>=65&&Ft<=90||Ft>=97&&Ft<=122||Mt===tt.RFC1738&&(Ft===40||Ft===41)){Bt[Bt.length]=qt.charAt(Xt);continue}if(Ft<128){Bt[Bt.length]=ht[Ft];continue}if(Ft<2048){Bt[Bt.length]=ht[192|Ft>>6]+ht[128|Ft&63];continue}if(Ft<55296||Ft>=57344){Bt[Bt.length]=ht[224|Ft>>12]+ht[128|Ft>>6&63]+ht[128|Ft&63];continue}Xt+=1,Ft=65536+((Ft&1023)<<10|qt.charCodeAt(Xt)&1023),Bt[Bt.length]=ht[240|Ft>>18]+ht[128|Ft>>12&63]+ht[128|Ft>>6&63]+ht[128|Ft&63]}Qt+=Bt.join("")}return Qt},wt=function(Et){for(var Lt=[{obj:{o:Et},prop:"o"}],kt=[],jt=0;jt<Lt.length;++jt)for(var Mt=Lt[jt],$t=Mt.obj[Mt.prop],Qt=Object.keys($t),Ht=0;Ht<Qt.length;++Ht){var qt=Qt[Ht],Bt=$t[qt];typeof Bt=="object"&&Bt!==null&&kt.indexOf(Bt)===-1&&(Lt.push({obj:$t,prop:qt}),kt.push(Bt))}return dt(Lt),Et},At=function(Et){return Object.prototype.toString.call(Et)==="[object RegExp]"},Tt=function(Et){return!Et||typeof Et!="object"?!1:!!(Et.constructor&&Et.constructor.isBuffer&&Et.constructor.isBuffer(Et))},Pt=function(Et,Lt,kt,jt){if(st(Et)){var Mt=ot(Et)+1;return Et[Mt]=Lt,lt(Et,Mt),Et}var $t=[].concat(Et,Lt);return $t.length>kt?at(ut($t,{plainObjects:jt}),$t.length-1):$t},Rt=function(Et,Lt){if(nt(Et)){for(var kt=[],jt=0;jt<Et.length;jt+=1)kt.push(Lt(Et[jt]));return kt}return Lt(Et)};return utils={arrayToObject:ut,assign:mt,combine:Pt,compact:wt,decode:gt,encode:xt,isBuffer:Tt,isOverflow:st,isRegExp:At,maybeMap:Rt,merge:ft},utils}var stringify_1,hasRequiredStringify;function requireStringify(){if(hasRequiredStringify)return stringify_1;hasRequiredStringify=1;var tt=requireSideChannel(),et=requireUtils(),rt=requireFormats(),nt=Object.prototype.hasOwnProperty,it={brackets:function(xt){return xt+"[]"},comma:"comma",indices:function(xt,wt){return xt+"["+wt+"]"},repeat:function(xt){return xt}},at=Array.isArray,st=Array.prototype.push,ot=function(vt,xt){st.apply(vt,at(xt)?xt:[xt])},lt=Date.prototype.toISOString,ht=rt.default,dt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:et.encode,encodeValuesOnly:!1,filter:void 0,format:ht,formatter:rt.formatters[ht],indices:!1,serializeDate:function(xt){return lt.call(xt)},skipNulls:!1,strictNullHandling:!1},ut=function(xt){return typeof xt=="string"||typeof xt=="number"||typeof xt=="boolean"||typeof xt=="symbol"||typeof xt=="bigint"},ft={},mt=function vt(xt,wt,At,Tt,Pt,Rt,Ot,Et,Lt,kt,jt,Mt,$t,Qt,Ht,qt,Bt,Xt){for(var Ft=xt,Wt=Xt,Yt=0,zt=!1;(Wt=Wt.get(ft))!==void 0&&!zt;){var er=Wt.get(xt);if(Yt+=1,typeof er<"u"){if(er===Yt)throw new RangeError("Cyclic object value");zt=!0}typeof Wt.get(ft)>"u"&&(Yt=0)}if(typeof kt=="function"?Ft=kt(wt,Ft):Ft instanceof Date?Ft=$t(Ft):At==="comma"&&at(Ft)&&(Ft=et.maybeMap(Ft,function(nr){return nr instanceof Date?$t(nr):nr})),Ft===null){if(Rt)return Lt&&!qt?Lt(wt,dt.encoder,Bt,"key",Qt):wt;Ft=""}if(ut(Ft)||et.isBuffer(Ft)){if(Lt){var dr=qt?wt:Lt(wt,dt.encoder,Bt,"key",Qt);return[Ht(dr)+"="+Ht(Lt(Ft,dt.encoder,Bt,"value",Qt))]}return[Ht(wt)+"="+Ht(String(Ft))]}var fr=[];if(typeof Ft>"u")return fr;var lr;if(At==="comma"&&at(Ft))qt&&Lt&&(Ft=et.maybeMap(Ft,Lt)),lr=[{value:Ft.length>0?Ft.join(",")||null:void 0}];else if(at(kt))lr=kt;else{var mr=Object.keys(Ft);lr=jt?mr.sort(jt):mr}var br=Et?String(wt).replace(/\./g,"%2E"):String(wt),Sr=Tt&&at(Ft)&&Ft.length===1?br+"[]":br;if(Pt&&at(Ft)&&Ft.length===0)return Sr+"[]";for(var Ir=0;Ir<lr.length;++Ir){var cr=lr[Ir],Nt=typeof cr=="object"&&cr&&typeof cr.value<"u"?cr.value:Ft[cr];if(!(Ot&&Nt===null)){var pr=Mt&&Et?String(cr).replace(/\./g,"%2E"):String(cr),rr=at(Ft)?typeof At=="function"?At(Sr,pr):Sr:Sr+(Mt?"."+pr:"["+pr+"]");Xt.set(xt,Yt);var ar=tt();ar.set(ft,Xt),ot(fr,vt(Nt,rr,At,Tt,Pt,Rt,Ot,Et,At==="comma"&&qt&&at(Ft)?null:Lt,kt,jt,Mt,$t,Qt,Ht,qt,Bt,ar))}}return fr},gt=function(xt){if(!xt)return dt;if(typeof xt.allowEmptyArrays<"u"&&typeof xt.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof xt.encodeDotInKeys<"u"&&typeof xt.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(xt.encoder!==null&&typeof xt.encoder<"u"&&typeof xt.encoder!="function")throw new TypeError("Encoder has to be a function.");var wt=xt.charset||dt.charset;if(typeof xt.charset<"u"&&xt.charset!=="utf-8"&&xt.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var At=rt.default;if(typeof xt.format<"u"){if(!nt.call(rt.formatters,xt.format))throw new TypeError("Unknown format option provided.");At=xt.format}var Tt=rt.formatters[At],Pt=dt.filter;(typeof xt.filter=="function"||at(xt.filter))&&(Pt=xt.filter);var Rt;if(xt.arrayFormat in it?Rt=xt.arrayFormat:"indices"in xt?Rt=xt.indices?"indices":"repeat":Rt=dt.arrayFormat,"commaRoundTrip"in xt&&typeof xt.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var Ot=typeof xt.allowDots>"u"?xt.encodeDotInKeys===!0?!0:dt.allowDots:!!xt.allowDots;return{addQueryPrefix:typeof xt.addQueryPrefix=="boolean"?xt.addQueryPrefix:dt.addQueryPrefix,allowDots:Ot,allowEmptyArrays:typeof xt.allowEmptyArrays=="boolean"?!!xt.allowEmptyArrays:dt.allowEmptyArrays,arrayFormat:Rt,charset:wt,charsetSentinel:typeof xt.charsetSentinel=="boolean"?xt.charsetSentinel:dt.charsetSentinel,commaRoundTrip:!!xt.commaRoundTrip,delimiter:typeof xt.delimiter>"u"?dt.delimiter:xt.delimiter,encode:typeof xt.encode=="boolean"?xt.encode:dt.encode,encodeDotInKeys:typeof xt.encodeDotInKeys=="boolean"?xt.encodeDotInKeys:dt.encodeDotInKeys,encoder:typeof xt.encoder=="function"?xt.encoder:dt.encoder,encodeValuesOnly:typeof xt.encodeValuesOnly=="boolean"?xt.encodeValuesOnly:dt.encodeValuesOnly,filter:Pt,format:At,formatter:Tt,serializeDate:typeof xt.serializeDate=="function"?xt.serializeDate:dt.serializeDate,skipNulls:typeof xt.skipNulls=="boolean"?xt.skipNulls:dt.skipNulls,sort:typeof xt.sort=="function"?xt.sort:null,strictNullHandling:typeof xt.strictNullHandling=="boolean"?xt.strictNullHandling:dt.strictNullHandling}};return stringify_1=function(vt,xt){var wt=vt,At=gt(xt),Tt,Pt;typeof At.filter=="function"?(Pt=At.filter,wt=Pt("",wt)):at(At.filter)&&(Pt=At.filter,Tt=Pt);var Rt=[];if(typeof wt!="object"||wt===null)return"";var Ot=it[At.arrayFormat],Et=Ot==="comma"&&At.commaRoundTrip;Tt||(Tt=Object.keys(wt)),At.sort&&Tt.sort(At.sort);for(var Lt=tt(),kt=0;kt<Tt.length;++kt){var jt=Tt[kt],Mt=wt[jt];At.skipNulls&&Mt===null||ot(Rt,mt(Mt,jt,Ot,Et,At.allowEmptyArrays,At.strictNullHandling,At.skipNulls,At.encodeDotInKeys,At.encode?At.encoder:null,At.filter,At.sort,At.allowDots,At.serializeDate,At.format,At.formatter,At.encodeValuesOnly,At.charset,Lt))}var $t=Rt.join(At.delimiter),Qt=At.addQueryPrefix===!0?"?":"";return At.charsetSentinel&&(At.charset==="iso-8859-1"?Qt+="utf8=%26%2310003%3B&":Qt+="utf8=%E2%9C%93&"),$t.length>0?Qt+$t:""},stringify_1}var parse,hasRequiredParse;function requireParse(){if(hasRequiredParse)return parse;hasRequiredParse=1;var tt=requireUtils(),et=Object.prototype.hasOwnProperty,rt=Array.isArray,nt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:tt.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},it=function(mt){return mt.replace(/&#(\d+);/g,function(gt,vt){return String.fromCharCode(parseInt(vt,10))})},at=function(mt,gt,vt){if(mt&&typeof mt=="string"&&gt.comma&&mt.indexOf(",")>-1)return mt.split(",");if(gt.throwOnLimitExceeded&&vt>=gt.arrayLimit)throw new RangeError("Array limit exceeded. Only "+gt.arrayLimit+" element"+(gt.arrayLimit===1?"":"s")+" allowed in an array.");return mt},st="utf8=%26%2310003%3B",ot="utf8=%E2%9C%93",lt=function(gt,vt){var xt={__proto__:null},wt=vt.ignoreQueryPrefix?gt.replace(/^\?/,""):gt;wt=wt.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var At=vt.parameterLimit===1/0?void 0:vt.parameterLimit,Tt=wt.split(vt.delimiter,vt.throwOnLimitExceeded?At+1:At);if(vt.throwOnLimitExceeded&&Tt.length>At)throw new RangeError("Parameter limit exceeded. Only "+At+" parameter"+(At===1?"":"s")+" allowed.");var Pt=-1,Rt,Ot=vt.charset;if(vt.charsetSentinel)for(Rt=0;Rt<Tt.length;++Rt)Tt[Rt].indexOf("utf8=")===0&&(Tt[Rt]===ot?Ot="utf-8":Tt[Rt]===st&&(Ot="iso-8859-1"),Pt=Rt,Rt=Tt.length);for(Rt=0;Rt<Tt.length;++Rt)if(Rt!==Pt){var Et=Tt[Rt],Lt=Et.indexOf("]="),kt=Lt===-1?Et.indexOf("="):Lt+1,jt,Mt;if(kt===-1?(jt=vt.decoder(Et,nt.decoder,Ot,"key"),Mt=vt.strictNullHandling?null:""):(jt=vt.decoder(Et.slice(0,kt),nt.decoder,Ot,"key"),jt!==null&&(Mt=tt.maybeMap(at(Et.slice(kt+1),vt,rt(xt[jt])?xt[jt].length:0),function(Qt){return vt.decoder(Qt,nt.decoder,Ot,"value")}))),Mt&&vt.interpretNumericEntities&&Ot==="iso-8859-1"&&(Mt=it(String(Mt))),Et.indexOf("[]=")>-1&&(Mt=rt(Mt)?[Mt]:Mt),jt!==null){var $t=et.call(xt,jt);$t&&vt.duplicates==="combine"?xt[jt]=tt.combine(xt[jt],Mt,vt.arrayLimit,vt.plainObjects):(!$t||vt.duplicates==="last")&&(xt[jt]=Mt)}}return xt},ht=function(mt,gt,vt,xt){var wt=0;if(mt.length>0&&mt[mt.length-1]==="[]"){var At=mt.slice(0,-1).join("");wt=Array.isArray(gt)&&gt[At]?gt[At].length:0}for(var Tt=xt?gt:at(gt,vt,wt),Pt=mt.length-1;Pt>=0;--Pt){var Rt,Ot=mt[Pt];if(Ot==="[]"&&vt.parseArrays)tt.isOverflow(Tt)?Rt=Tt:Rt=vt.allowEmptyArrays&&(Tt===""||vt.strictNullHandling&&Tt===null)?[]:tt.combine([],Tt,vt.arrayLimit,vt.plainObjects);else{Rt=vt.plainObjects?{__proto__:null}:{};var Et=Ot.charAt(0)==="["&&Ot.charAt(Ot.length-1)==="]"?Ot.slice(1,-1):Ot,Lt=vt.decodeDotInKeys?Et.replace(/%2E/g,"."):Et,kt=parseInt(Lt,10);!vt.parseArrays&&Lt===""?Rt={0:Tt}:!isNaN(kt)&&Ot!==Lt&&String(kt)===Lt&&kt>=0&&vt.parseArrays&&kt<=vt.arrayLimit?(Rt=[],Rt[kt]=Tt):Lt!=="__proto__"&&(Rt[Lt]=Tt)}Tt=Rt}return Tt},dt=function(gt,vt){var xt=vt.allowDots?gt.replace(/\.([^.[]+)/g,"[$1]"):gt;if(vt.depth<=0)return!vt.plainObjects&&et.call(Object.prototype,xt)&&!vt.allowPrototypes?void 0:[xt];var wt=/(\[[^[\]]*])/,At=/(\[[^[\]]*])/g,Tt=wt.exec(xt),Pt=Tt?xt.slice(0,Tt.index):xt,Rt=[];if(Pt){if(!vt.plainObjects&&et.call(Object.prototype,Pt)&&!vt.allowPrototypes)return;Rt.push(Pt)}for(var Ot=0;(Tt=At.exec(xt))!==null&&Ot<vt.depth;){Ot+=1;var Et=Tt[1].slice(1,-1);if(!vt.plainObjects&&et.call(Object.prototype,Et)&&!vt.allowPrototypes)return;Rt.push(Tt[1])}if(Tt){if(vt.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+vt.depth+" and strictDepth is true");Rt.push("["+xt.slice(Tt.index)+"]")}return Rt},ut=function(gt,vt,xt,wt){if(gt){var At=dt(gt,xt);if(At)return ht(At,vt,xt,wt)}},ft=function(gt){if(!gt)return nt;if(typeof gt.allowEmptyArrays<"u"&&typeof gt.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof gt.decodeDotInKeys<"u"&&typeof gt.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(gt.decoder!==null&&typeof gt.decoder<"u"&&typeof gt.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof gt.charset<"u"&&gt.charset!=="utf-8"&&gt.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof gt.throwOnLimitExceeded<"u"&&typeof gt.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var vt=typeof gt.charset>"u"?nt.charset:gt.charset,xt=typeof gt.duplicates>"u"?nt.duplicates:gt.duplicates;if(xt!=="combine"&&xt!=="first"&&xt!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var wt=typeof gt.allowDots>"u"?gt.decodeDotInKeys===!0?!0:nt.allowDots:!!gt.allowDots;return{allowDots:wt,allowEmptyArrays:typeof gt.allowEmptyArrays=="boolean"?!!gt.allowEmptyArrays:nt.allowEmptyArrays,allowPrototypes:typeof gt.allowPrototypes=="boolean"?gt.allowPrototypes:nt.allowPrototypes,allowSparse:typeof gt.allowSparse=="boolean"?gt.allowSparse:nt.allowSparse,arrayLimit:typeof gt.arrayLimit=="number"?gt.arrayLimit:nt.arrayLimit,charset:vt,charsetSentinel:typeof gt.charsetSentinel=="boolean"?gt.charsetSentinel:nt.charsetSentinel,comma:typeof gt.comma=="boolean"?gt.comma:nt.comma,decodeDotInKeys:typeof gt.decodeDotInKeys=="boolean"?gt.decodeDotInKeys:nt.decodeDotInKeys,decoder:typeof gt.decoder=="function"?gt.decoder:nt.decoder,delimiter:typeof gt.delimiter=="string"||tt.isRegExp(gt.delimiter)?gt.delimiter:nt.delimiter,depth:typeof gt.depth=="number"||gt.depth===!1?+gt.depth:nt.depth,duplicates:xt,ignoreQueryPrefix:gt.ignoreQueryPrefix===!0,interpretNumericEntities:typeof gt.interpretNumericEntities=="boolean"?gt.interpretNumericEntities:nt.interpretNumericEntities,parameterLimit:typeof gt.parameterLimit=="number"?gt.parameterLimit:nt.parameterLimit,parseArrays:gt.parseArrays!==!1,plainObjects:typeof gt.plainObjects=="boolean"?gt.plainObjects:nt.plainObjects,strictDepth:typeof gt.strictDepth=="boolean"?!!gt.strictDepth:nt.strictDepth,strictNullHandling:typeof gt.strictNullHandling=="boolean"?gt.strictNullHandling:nt.strictNullHandling,throwOnLimitExceeded:typeof gt.throwOnLimitExceeded=="boolean"?gt.throwOnLimitExceeded:!1}};return parse=function(mt,gt){var vt=ft(gt);if(mt===""||mt===null||typeof mt>"u")return vt.plainObjects?{__proto__:null}:{};for(var xt=typeof mt=="string"?lt(mt,vt):mt,wt=vt.plainObjects?{__proto__:null}:{},At=Object.keys(xt),Tt=0;Tt<At.length;++Tt){var Pt=At[Tt],Rt=ut(Pt,xt[Pt],vt,typeof mt=="string");wt=tt.merge(wt,Rt,vt)}return vt.allowSparse===!0?wt:tt.compact(wt)},parse}var lib$2,hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib$2;hasRequiredLib=1;var tt=requireStringify(),et=requireParse(),rt=requireFormats();return lib$2={formats:rt,parse:et,stringify:tt},lib$2}var hasRequiredUrl;function requireUrl(){if(hasRequiredUrl)return url;hasRequiredUrl=1;var tt=requirePunycode();function et(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var rt=/^([a-z0-9.+-]+:)/i,nt=/:[0-9]*$/,it=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,at=["<",">",'"',"`"," ","\r",`
`,"	"],st=["{","}","|","\\","^","`"].concat(at),ot=["'"].concat(st),lt=["%","/","?",";","#"].concat(ot),ht=["/","?","#"],dt=255,ut=/^[+a-z0-9A-Z_-]{0,63}$/,ft=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,mt={javascript:!0,"javascript:":!0},gt={javascript:!0,"javascript:":!0},vt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},xt=requireLib();function wt(Rt,Ot,Et){if(Rt&&typeof Rt=="object"&&Rt instanceof et)return Rt;var Lt=new et;return Lt.parse(Rt,Ot,Et),Lt}et.prototype.parse=function(Rt,Ot,Et){if(typeof Rt!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof Rt);var Lt=Rt.indexOf("?"),kt=Lt!==-1&&Lt<Rt.indexOf("#")?"?":"#",jt=Rt.split(kt),Mt=/\\/g;jt[0]=jt[0].replace(Mt,"/"),Rt=jt.join(kt);var $t=Rt;if($t=$t.trim(),!Et&&Rt.split("#").length===1){var Qt=it.exec($t);if(Qt)return this.path=$t,this.href=$t,this.pathname=Qt[1],Qt[2]?(this.search=Qt[2],Ot?this.query=xt.parse(this.search.substr(1)):this.query=this.search.substr(1)):Ot&&(this.search="",this.query={}),this}var Ht=rt.exec($t);if(Ht){Ht=Ht[0];var qt=Ht.toLowerCase();this.protocol=qt,$t=$t.substr(Ht.length)}if(Et||Ht||$t.match(/^\/\/[^@/]+@[^@/]+/)){var Bt=$t.substr(0,2)==="//";Bt&&!(Ht&&gt[Ht])&&($t=$t.substr(2),this.slashes=!0)}if(!gt[Ht]&&(Bt||Ht&&!vt[Ht])){for(var Xt=-1,Ft=0;Ft<ht.length;Ft++){var Wt=$t.indexOf(ht[Ft]);Wt!==-1&&(Xt===-1||Wt<Xt)&&(Xt=Wt)}var Yt,zt;Xt===-1?zt=$t.lastIndexOf("@"):zt=$t.lastIndexOf("@",Xt),zt!==-1&&(Yt=$t.slice(0,zt),$t=$t.slice(zt+1),this.auth=decodeURIComponent(Yt)),Xt=-1;for(var Ft=0;Ft<lt.length;Ft++){var Wt=$t.indexOf(lt[Ft]);Wt!==-1&&(Xt===-1||Wt<Xt)&&(Xt=Wt)}Xt===-1&&(Xt=$t.length),this.host=$t.slice(0,Xt),$t=$t.slice(Xt),this.parseHost(),this.hostname=this.hostname||"";var er=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!er)for(var dr=this.hostname.split(/\./),Ft=0,fr=dr.length;Ft<fr;Ft++){var lr=dr[Ft];if(lr&&!lr.match(ut)){for(var mr="",br=0,Sr=lr.length;br<Sr;br++)lr.charCodeAt(br)>127?mr+="x":mr+=lr[br];if(!mr.match(ut)){var Ir=dr.slice(0,Ft),cr=dr.slice(Ft+1),Nt=lr.match(ft);Nt&&(Ir.push(Nt[1]),cr.unshift(Nt[2])),cr.length&&($t="/"+cr.join(".")+$t),this.hostname=Ir.join(".");break}}}this.hostname.length>dt?this.hostname="":this.hostname=this.hostname.toLowerCase(),er||(this.hostname=tt.toASCII(this.hostname));var pr=this.port?":"+this.port:"",rr=this.hostname||"";this.host=rr+pr,this.href+=this.host,er&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),$t[0]!=="/"&&($t="/"+$t))}if(!mt[qt])for(var Ft=0,fr=ot.length;Ft<fr;Ft++){var ar=ot[Ft];if($t.indexOf(ar)!==-1){var nr=encodeURIComponent(ar);nr===ar&&(nr=escape(ar)),$t=$t.split(ar).join(nr)}}var ur=$t.indexOf("#");ur!==-1&&(this.hash=$t.substr(ur),$t=$t.slice(0,ur));var Er=$t.indexOf("?");if(Er!==-1?(this.search=$t.substr(Er),this.query=$t.substr(Er+1),Ot&&(this.query=xt.parse(this.query)),$t=$t.slice(0,Er)):Ot&&(this.search="",this.query={}),$t&&(this.pathname=$t),vt[qt]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var pr=this.pathname||"",Ut=this.search||"";this.path=pr+Ut}return this.href=this.format(),this};function At(Rt){return typeof Rt=="string"&&(Rt=wt(Rt)),Rt instanceof et?Rt.format():et.prototype.format.call(Rt)}et.prototype.format=function(){var Rt=this.auth||"";Rt&&(Rt=encodeURIComponent(Rt),Rt=Rt.replace(/%3A/i,":"),Rt+="@");var Ot=this.protocol||"",Et=this.pathname||"",Lt=this.hash||"",kt=!1,jt="";this.host?kt=Rt+this.host:this.hostname&&(kt=Rt+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(kt+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(jt=xt.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var Mt=this.search||jt&&"?"+jt||"";return Ot&&Ot.substr(-1)!==":"&&(Ot+=":"),this.slashes||(!Ot||vt[Ot])&&kt!==!1?(kt="//"+(kt||""),Et&&Et.charAt(0)!=="/"&&(Et="/"+Et)):kt||(kt=""),Lt&&Lt.charAt(0)!=="#"&&(Lt="#"+Lt),Mt&&Mt.charAt(0)!=="?"&&(Mt="?"+Mt),Et=Et.replace(/[?#]/g,function($t){return encodeURIComponent($t)}),Mt=Mt.replace("#","%23"),Ot+kt+Et+Mt+Lt};function Tt(Rt,Ot){return wt(Rt,!1,!0).resolve(Ot)}et.prototype.resolve=function(Rt){return this.resolveObject(wt(Rt,!1,!0)).format()};function Pt(Rt,Ot){return Rt?wt(Rt,!1,!0).resolveObject(Ot):Ot}return et.prototype.resolveObject=function(Rt){if(typeof Rt=="string"){var Ot=new et;Ot.parse(Rt,!1,!0),Rt=Ot}for(var Et=new et,Lt=Object.keys(this),kt=0;kt<Lt.length;kt++){var jt=Lt[kt];Et[jt]=this[jt]}if(Et.hash=Rt.hash,Rt.href==="")return Et.href=Et.format(),Et;if(Rt.slashes&&!Rt.protocol){for(var Mt=Object.keys(Rt),$t=0;$t<Mt.length;$t++){var Qt=Mt[$t];Qt!=="protocol"&&(Et[Qt]=Rt[Qt])}return vt[Et.protocol]&&Et.hostname&&!Et.pathname&&(Et.pathname="/",Et.path=Et.pathname),Et.href=Et.format(),Et}if(Rt.protocol&&Rt.protocol!==Et.protocol){if(!vt[Rt.protocol]){for(var Ht=Object.keys(Rt),qt=0;qt<Ht.length;qt++){var Bt=Ht[qt];Et[Bt]=Rt[Bt]}return Et.href=Et.format(),Et}if(Et.protocol=Rt.protocol,!Rt.host&&!gt[Rt.protocol]){for(var fr=(Rt.pathname||"").split("/");fr.length&&!(Rt.host=fr.shift()););Rt.host||(Rt.host=""),Rt.hostname||(Rt.hostname=""),fr[0]!==""&&fr.unshift(""),fr.length<2&&fr.unshift(""),Et.pathname=fr.join("/")}else Et.pathname=Rt.pathname;if(Et.search=Rt.search,Et.query=Rt.query,Et.host=Rt.host||"",Et.auth=Rt.auth,Et.hostname=Rt.hostname||Rt.host,Et.port=Rt.port,Et.pathname||Et.search){var Xt=Et.pathname||"",Ft=Et.search||"";Et.path=Xt+Ft}return Et.slashes=Et.slashes||Rt.slashes,Et.href=Et.format(),Et}var Wt=Et.pathname&&Et.pathname.charAt(0)==="/",Yt=Rt.host||Rt.pathname&&Rt.pathname.charAt(0)==="/",zt=Yt||Wt||Et.host&&Rt.pathname,er=zt,dr=Et.pathname&&Et.pathname.split("/")||[],fr=Rt.pathname&&Rt.pathname.split("/")||[],lr=Et.protocol&&!vt[Et.protocol];if(lr&&(Et.hostname="",Et.port=null,Et.host&&(dr[0]===""?dr[0]=Et.host:dr.unshift(Et.host)),Et.host="",Rt.protocol&&(Rt.hostname=null,Rt.port=null,Rt.host&&(fr[0]===""?fr[0]=Rt.host:fr.unshift(Rt.host)),Rt.host=null),zt=zt&&(fr[0]===""||dr[0]==="")),Yt)Et.host=Rt.host||Rt.host===""?Rt.host:Et.host,Et.hostname=Rt.hostname||Rt.hostname===""?Rt.hostname:Et.hostname,Et.search=Rt.search,Et.query=Rt.query,dr=fr;else if(fr.length)dr||(dr=[]),dr.pop(),dr=dr.concat(fr),Et.search=Rt.search,Et.query=Rt.query;else if(Rt.search!=null){if(lr){Et.host=dr.shift(),Et.hostname=Et.host;var mr=Et.host&&Et.host.indexOf("@")>0?Et.host.split("@"):!1;mr&&(Et.auth=mr.shift(),Et.hostname=mr.shift(),Et.host=Et.hostname)}return Et.search=Rt.search,Et.query=Rt.query,(Et.pathname!==null||Et.search!==null)&&(Et.path=(Et.pathname?Et.pathname:"")+(Et.search?Et.search:"")),Et.href=Et.format(),Et}if(!dr.length)return Et.pathname=null,Et.search?Et.path="/"+Et.search:Et.path=null,Et.href=Et.format(),Et;for(var br=dr.slice(-1)[0],Sr=(Et.host||Rt.host||dr.length>1)&&(br==="."||br==="..")||br==="",Ir=0,cr=dr.length;cr>=0;cr--)br=dr[cr],br==="."?dr.splice(cr,1):br===".."?(dr.splice(cr,1),Ir++):Ir&&(dr.splice(cr,1),Ir--);if(!zt&&!er)for(;Ir--;Ir)dr.unshift("..");zt&&dr[0]!==""&&(!dr[0]||dr[0].charAt(0)!=="/")&&dr.unshift(""),Sr&&dr.join("/").substr(-1)!=="/"&&dr.push("");var Nt=dr[0]===""||dr[0]&&dr[0].charAt(0)==="/";if(lr){Et.hostname=Nt?"":dr.length?dr.shift():"",Et.host=Et.hostname;var mr=Et.host&&Et.host.indexOf("@")>0?Et.host.split("@"):!1;mr&&(Et.auth=mr.shift(),Et.hostname=mr.shift(),Et.host=Et.hostname)}return zt=zt||Et.host&&dr.length,zt&&!Nt&&dr.unshift(""),dr.length>0?Et.pathname=dr.join("/"):(Et.pathname=null,Et.path=null),(Et.pathname!==null||Et.search!==null)&&(Et.path=(Et.pathname?Et.pathname:"")+(Et.search?Et.search:"")),Et.auth=Rt.auth||Et.auth,Et.slashes=Et.slashes||Rt.slashes,Et.href=Et.format(),Et},et.prototype.parseHost=function(){var Rt=this.host,Ot=nt.exec(Rt);Ot&&(Ot=Ot[0],Ot!==":"&&(this.port=Ot.substr(1)),Rt=Rt.substr(0,Rt.length-Ot.length)),Rt&&(this.hostname=Rt)},url.parse=wt,url.resolve=Tt,url.resolveObject=Pt,url.format=At,url.Url=et,url}requireUrl();const warnings={};function deprecation(tt,et,rt=3){if(warnings[et])return;let nt=new Error().stack;typeof nt>"u"?console.warn("PixiJS Deprecation Warning: ",`${et}
Deprecated since v${tt}`):(nt=nt.split(`
`).splice(rt).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${et}
Deprecated since v${tt}`),console.warn(nt),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${et}
Deprecated since v${tt}`),console.warn(nt))),warnings[et]=!0}function assertPath(tt){if(typeof tt!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(tt)}`)}function removeUrlParams(tt){return tt.split("?")[0].split("#")[0]}function escapeRegExp(tt){return tt.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(tt,et,rt){return tt.replace(new RegExp(escapeRegExp(et),"g"),rt)}function normalizeStringPosix(tt,et){let rt="",nt=0,it=-1,at=0,st=-1;for(let ot=0;ot<=tt.length;++ot){if(ot<tt.length)st=tt.charCodeAt(ot);else{if(st===47)break;st=47}if(st===47){if(!(it===ot-1||at===1))if(it!==ot-1&&at===2){if(rt.length<2||nt!==2||rt.charCodeAt(rt.length-1)!==46||rt.charCodeAt(rt.length-2)!==46){if(rt.length>2){const lt=rt.lastIndexOf("/");if(lt!==rt.length-1){lt===-1?(rt="",nt=0):(rt=rt.slice(0,lt),nt=rt.length-1-rt.lastIndexOf("/")),it=ot,at=0;continue}}else if(rt.length===2||rt.length===1){rt="",nt=0,it=ot,at=0;continue}}}else rt.length>0?rt+=`/${tt.slice(it+1,ot)}`:rt=tt.slice(it+1,ot),nt=ot-it-1;it=ot,at=0}else st===46&&at!==-1?++at:at=-1}return rt}const path={toPosix(tt){return replaceAll(tt,"\\","/")},isUrl(tt){return/^https?:/.test(this.toPosix(tt))},isDataUrl(tt){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(tt)},isBlobUrl(tt){return tt.startsWith("blob:")},hasProtocol(tt){return/^[^/:]+:/.test(this.toPosix(tt))},getProtocol(tt){assertPath(tt),tt=this.toPosix(tt);const et=/^file:\/\/\//.exec(tt);if(et)return et[0];const rt=/^[^/:]+:\/{0,2}/.exec(tt);return rt?rt[0]:""},toAbsolute(tt,et,rt){if(assertPath(tt),this.isDataUrl(tt)||this.isBlobUrl(tt))return tt;const nt=removeUrlParams(this.toPosix(et??settings.ADAPTER.getBaseUrl())),it=removeUrlParams(this.toPosix(rt??this.rootname(nt)));return tt=this.toPosix(tt),tt.startsWith("/")?path.join(it,tt.slice(1)):this.isAbsolute(tt)?tt:this.join(nt,tt)},normalize(tt){if(assertPath(tt),tt.length===0)return".";if(this.isDataUrl(tt)||this.isBlobUrl(tt))return tt;tt=this.toPosix(tt);let et="";const rt=tt.startsWith("/");this.hasProtocol(tt)&&(et=this.rootname(tt),tt=tt.slice(et.length));const nt=tt.endsWith("/");return tt=normalizeStringPosix(tt),tt.length>0&&nt&&(tt+="/"),rt?`/${tt}`:et+tt},isAbsolute(tt){return assertPath(tt),tt=this.toPosix(tt),this.hasProtocol(tt)?!0:tt.startsWith("/")},join(...tt){if(tt.length===0)return".";let et;for(let rt=0;rt<tt.length;++rt){const nt=tt[rt];if(assertPath(nt),nt.length>0)if(et===void 0)et=nt;else{const it=tt[rt-1]??"";this.joinExtensions.includes(this.extname(it).toLowerCase())?et+=`/../${nt}`:et+=`/${nt}`}}return et===void 0?".":this.normalize(et)},dirname(tt){if(assertPath(tt),tt.length===0)return".";tt=this.toPosix(tt);let et=tt.charCodeAt(0);const rt=et===47;let nt=-1,it=!0;const at=this.getProtocol(tt),st=tt;tt=tt.slice(at.length);for(let ot=tt.length-1;ot>=1;--ot)if(et=tt.charCodeAt(ot),et===47){if(!it){nt=ot;break}}else it=!1;return nt===-1?rt?"/":this.isUrl(st)?at+tt:at:rt&&nt===1?"//":at+tt.slice(0,nt)},rootname(tt){assertPath(tt),tt=this.toPosix(tt);let et="";if(tt.startsWith("/")?et="/":et=this.getProtocol(tt),this.isUrl(tt)){const rt=tt.indexOf("/",et.length);rt!==-1?et=tt.slice(0,rt):et=tt,et.endsWith("/")||(et+="/")}return et},basename(tt,et){assertPath(tt),et&&assertPath(et),tt=removeUrlParams(this.toPosix(tt));let rt=0,nt=-1,it=!0,at;if(et!==void 0&&et.length>0&&et.length<=tt.length){if(et.length===tt.length&&et===tt)return"";let st=et.length-1,ot=-1;for(at=tt.length-1;at>=0;--at){const lt=tt.charCodeAt(at);if(lt===47){if(!it){rt=at+1;break}}else ot===-1&&(it=!1,ot=at+1),st>=0&&(lt===et.charCodeAt(st)?--st===-1&&(nt=at):(st=-1,nt=ot))}return rt===nt?nt=ot:nt===-1&&(nt=tt.length),tt.slice(rt,nt)}for(at=tt.length-1;at>=0;--at)if(tt.charCodeAt(at)===47){if(!it){rt=at+1;break}}else nt===-1&&(it=!1,nt=at+1);return nt===-1?"":tt.slice(rt,nt)},extname(tt){assertPath(tt),tt=removeUrlParams(this.toPosix(tt));let et=-1,rt=0,nt=-1,it=!0,at=0;for(let st=tt.length-1;st>=0;--st){const ot=tt.charCodeAt(st);if(ot===47){if(!it){rt=st+1;break}continue}nt===-1&&(it=!1,nt=st+1),ot===46?et===-1?et=st:at!==1&&(at=1):et!==-1&&(at=-1)}return et===-1||nt===-1||at===0||at===1&&et===nt-1&&et===rt+1?"":tt.slice(et,nt)},parse(tt){assertPath(tt);const et={root:"",dir:"",base:"",ext:"",name:""};if(tt.length===0)return et;tt=removeUrlParams(this.toPosix(tt));let rt=tt.charCodeAt(0);const nt=this.isAbsolute(tt);let it;et.root=this.rootname(tt),nt||this.hasProtocol(tt)?it=1:it=0;let at=-1,st=0,ot=-1,lt=!0,ht=tt.length-1,dt=0;for(;ht>=it;--ht){if(rt=tt.charCodeAt(ht),rt===47){if(!lt){st=ht+1;break}continue}ot===-1&&(lt=!1,ot=ht+1),rt===46?at===-1?at=ht:dt!==1&&(dt=1):at!==-1&&(dt=-1)}return at===-1||ot===-1||dt===0||dt===1&&at===ot-1&&at===st+1?ot!==-1&&(st===0&&nt?et.base=et.name=tt.slice(1,ot):et.base=et.name=tt.slice(st,ot)):(st===0&&nt?(et.name=tt.slice(1,at),et.base=tt.slice(1,ot)):(et.name=tt.slice(st,at),et.base=tt.slice(st,ot)),et.ext=tt.slice(at,ot)),et.dir=this.dirname(tt),et},sep:"/",delimiter:":",joinExtensions:[".html"]};let promise;async function detectVideoAlphaMode(){return promise??(promise=(async()=>{const tt=document.createElement("canvas").getContext("webgl");if(!tt)return ALPHA_MODES.UNPACK;const et=await new Promise(at=>{const st=document.createElement("video");st.onloadeddata=()=>at(st),st.onerror=()=>at(null),st.autoplay=!1,st.crossOrigin="anonymous",st.preload="auto",st.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",st.load()});if(!et)return ALPHA_MODES.UNPACK;const rt=tt.createTexture();tt.bindTexture(tt.TEXTURE_2D,rt);const nt=tt.createFramebuffer();tt.bindFramebuffer(tt.FRAMEBUFFER,nt),tt.framebufferTexture2D(tt.FRAMEBUFFER,tt.COLOR_ATTACHMENT0,tt.TEXTURE_2D,rt,0),tt.pixelStorei(tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),tt.pixelStorei(tt.UNPACK_COLORSPACE_CONVERSION_WEBGL,tt.NONE),tt.texImage2D(tt.TEXTURE_2D,0,tt.RGBA,tt.RGBA,tt.UNSIGNED_BYTE,et);const it=new Uint8Array(4);return tt.readPixels(0,0,1,1,tt.RGBA,tt.UNSIGNED_BYTE,it),tt.deleteFramebuffer(nt),tt.deleteTexture(rt),tt.getExtension("WEBGL_lose_context")?.loseContext(),it[0]<=it[3]?ALPHA_MODES.PMA:ALPHA_MODES.UNPACK})()),promise}let supported$2;function isWebGLSupported(){return typeof supported$2>"u"&&(supported$2=(function(){const tt={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!settings.ADAPTER.getWebGLRenderingContext())return!1;const et=settings.ADAPTER.createCanvas();let rt=et.getContext("webgl",tt)||et.getContext("experimental-webgl",tt);const nt=!!rt?.getContextAttributes()?.stencil;if(rt){const it=rt.getExtension("WEBGL_lose_context");it&&it.loseContext()}return rt=null,nt}catch{return!1}})()),supported$2}var r$1={grad:.9,turn:360,rad:360/(2*Math.PI)},t$1=function(tt){return typeof tt=="string"?tt.length>0:typeof tt=="number"},n$1=function(tt,et,rt){return et===void 0&&(et=0),rt===void 0&&(rt=Math.pow(10,et)),Math.round(rt*tt)/rt+0},e$1=function(tt,et,rt){return et===void 0&&(et=0),rt===void 0&&(rt=1),tt>rt?rt:tt>et?tt:et},u$1=function(tt){return(tt=isFinite(tt)?tt%360:0)>0?tt:tt+360},a$1=function(tt){return{r:e$1(tt.r,0,255),g:e$1(tt.g,0,255),b:e$1(tt.b,0,255),a:e$1(tt.a)}},o$1=function(tt){return{r:n$1(tt.r),g:n$1(tt.g),b:n$1(tt.b),a:n$1(tt.a,3)}},i$1=/^#([0-9a-f]{3,8})$/i,s$1=function(tt){var et=tt.toString(16);return et.length<2?"0"+et:et},h$1=function(tt){var et=tt.r,rt=tt.g,nt=tt.b,it=tt.a,at=Math.max(et,rt,nt),st=at-Math.min(et,rt,nt),ot=st?at===et?(rt-nt)/st:at===rt?2+(nt-et)/st:4+(et-rt)/st:0;return{h:60*(ot<0?ot+6:ot),s:at?st/at*100:0,v:at/255*100,a:it}},b$1=function(tt){var et=tt.h,rt=tt.s,nt=tt.v,it=tt.a;et=et/360*6,rt/=100,nt/=100;var at=Math.floor(et),st=nt*(1-rt),ot=nt*(1-(et-at)*rt),lt=nt*(1-(1-et+at)*rt),ht=at%6;return{r:255*[nt,ot,st,st,lt,nt][ht],g:255*[lt,nt,nt,ot,st,st][ht],b:255*[st,st,lt,nt,nt,ot][ht],a:it}},g=function(tt){return{h:u$1(tt.h),s:e$1(tt.s,0,100),l:e$1(tt.l,0,100),a:e$1(tt.a)}},d=function(tt){return{h:n$1(tt.h),s:n$1(tt.s),l:n$1(tt.l),a:n$1(tt.a,3)}},f$1=function(tt){return b$1((rt=(et=tt).s,{h:et.h,s:(rt*=((nt=et.l)<50?nt:100-nt)/100)>0?2*rt/(nt+rt)*100:0,v:nt+rt,a:et.a}));var et,rt,nt},c$2=function(tt){return{h:(et=h$1(tt)).h,s:(it=(200-(rt=et.s))*(nt=et.v)/100)>0&&it<200?rt*nt/100/(it<=100?it:200-it)*100:0,l:it/2,a:et.a};var et,rt,nt,it},l$1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$3={string:[[function(tt){var et=i$1.exec(tt);return et?(tt=et[1]).length<=4?{r:parseInt(tt[0]+tt[0],16),g:parseInt(tt[1]+tt[1],16),b:parseInt(tt[2]+tt[2],16),a:tt.length===4?n$1(parseInt(tt[3]+tt[3],16)/255,2):1}:tt.length===6||tt.length===8?{r:parseInt(tt.substr(0,2),16),g:parseInt(tt.substr(2,2),16),b:parseInt(tt.substr(4,2),16),a:tt.length===8?n$1(parseInt(tt.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(tt){var et=v$1.exec(tt)||m.exec(tt);return et?et[2]!==et[4]||et[4]!==et[6]?null:a$1({r:Number(et[1])/(et[2]?100/255:1),g:Number(et[3])/(et[4]?100/255:1),b:Number(et[5])/(et[6]?100/255:1),a:et[7]===void 0?1:Number(et[7])/(et[8]?100:1)}):null},"rgb"],[function(tt){var et=l$1.exec(tt)||p$1.exec(tt);if(!et)return null;var rt,nt,it=g({h:(rt=et[1],nt=et[2],nt===void 0&&(nt="deg"),Number(rt)*(r$1[nt]||1)),s:Number(et[3]),l:Number(et[4]),a:et[5]===void 0?1:Number(et[5])/(et[6]?100:1)});return f$1(it)},"hsl"]],object:[[function(tt){var et=tt.r,rt=tt.g,nt=tt.b,it=tt.a,at=it===void 0?1:it;return t$1(et)&&t$1(rt)&&t$1(nt)?a$1({r:Number(et),g:Number(rt),b:Number(nt),a:Number(at)}):null},"rgb"],[function(tt){var et=tt.h,rt=tt.s,nt=tt.l,it=tt.a,at=it===void 0?1:it;if(!t$1(et)||!t$1(rt)||!t$1(nt))return null;var st=g({h:Number(et),s:Number(rt),l:Number(nt),a:Number(at)});return f$1(st)},"hsl"],[function(tt){var et=tt.h,rt=tt.s,nt=tt.v,it=tt.a,at=it===void 0?1:it;if(!t$1(et)||!t$1(rt)||!t$1(nt))return null;var st=(function(ot){return{h:u$1(ot.h),s:e$1(ot.s,0,100),v:e$1(ot.v,0,100),a:e$1(ot.a)}})({h:Number(et),s:Number(rt),v:Number(nt),a:Number(at)});return b$1(st)},"hsv"]]},N$2=function(tt,et){for(var rt=0;rt<et.length;rt++){var nt=et[rt][0](tt);if(nt)return[nt,et[rt][1]]}return[null,void 0]},x$3=function(tt){return typeof tt=="string"?N$2(tt.trim(),y$3.string):typeof tt=="object"&&tt!==null?N$2(tt,y$3.object):[null,void 0]},M$2=function(tt,et){var rt=c$2(tt);return{h:rt.h,s:e$1(rt.s+100*et,0,100),l:rt.l,a:rt.a}},H$1=function(tt){return(299*tt.r+587*tt.g+114*tt.b)/1e3/255},$$1=function(tt,et){var rt=c$2(tt);return{h:rt.h,s:rt.s,l:e$1(rt.l+100*et,0,100),a:rt.a}},j$1=(function(){function tt(et){this.parsed=x$3(et)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return tt.prototype.isValid=function(){return this.parsed!==null},tt.prototype.brightness=function(){return n$1(H$1(this.rgba),2)},tt.prototype.isDark=function(){return H$1(this.rgba)<.5},tt.prototype.isLight=function(){return H$1(this.rgba)>=.5},tt.prototype.toHex=function(){return et=o$1(this.rgba),rt=et.r,nt=et.g,it=et.b,st=(at=et.a)<1?s$1(n$1(255*at)):"","#"+s$1(rt)+s$1(nt)+s$1(it)+st;var et,rt,nt,it,at,st},tt.prototype.toRgb=function(){return o$1(this.rgba)},tt.prototype.toRgbString=function(){return et=o$1(this.rgba),rt=et.r,nt=et.g,it=et.b,(at=et.a)<1?"rgba("+rt+", "+nt+", "+it+", "+at+")":"rgb("+rt+", "+nt+", "+it+")";var et,rt,nt,it,at},tt.prototype.toHsl=function(){return d(c$2(this.rgba))},tt.prototype.toHslString=function(){return et=d(c$2(this.rgba)),rt=et.h,nt=et.s,it=et.l,(at=et.a)<1?"hsla("+rt+", "+nt+"%, "+it+"%, "+at+")":"hsl("+rt+", "+nt+"%, "+it+"%)";var et,rt,nt,it,at},tt.prototype.toHsv=function(){return et=h$1(this.rgba),{h:n$1(et.h),s:n$1(et.s),v:n$1(et.v),a:n$1(et.a,3)};var et},tt.prototype.invert=function(){return w({r:255-(et=this.rgba).r,g:255-et.g,b:255-et.b,a:et.a});var et},tt.prototype.saturate=function(et){return et===void 0&&(et=.1),w(M$2(this.rgba,et))},tt.prototype.desaturate=function(et){return et===void 0&&(et=.1),w(M$2(this.rgba,-et))},tt.prototype.grayscale=function(){return w(M$2(this.rgba,-1))},tt.prototype.lighten=function(et){return et===void 0&&(et=.1),w($$1(this.rgba,et))},tt.prototype.darken=function(et){return et===void 0&&(et=.1),w($$1(this.rgba,-et))},tt.prototype.rotate=function(et){return et===void 0&&(et=15),this.hue(this.hue()+et)},tt.prototype.alpha=function(et){return typeof et=="number"?w({r:(rt=this.rgba).r,g:rt.g,b:rt.b,a:et}):n$1(this.rgba.a,3);var rt},tt.prototype.hue=function(et){var rt=c$2(this.rgba);return typeof et=="number"?w({h:et,s:rt.s,l:rt.l,a:rt.a}):n$1(rt.h)},tt.prototype.isEqual=function(et){return this.toHex()===w(et).toHex()},tt})(),w=function(tt){return tt instanceof j$1?tt:new j$1(tt)},S$1=[],k$2=function(tt){tt.forEach(function(et){S$1.indexOf(et)<0&&(et(j$1,y$3),S$1.push(et))})};function namesPlugin(tt,et){var rt={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},nt={};for(var it in rt)nt[rt[it]]=it;var at={};tt.prototype.toName=function(st){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var ot,lt,ht=nt[this.toHex()];if(ht)return ht;if(st?.closest){var dt=this.toRgb(),ut=1/0,ft="black";if(!at.length)for(var mt in rt)at[mt]=new tt(rt[mt]).toRgb();for(var gt in rt){var vt=(ot=dt,lt=at[gt],Math.pow(ot.r-lt.r,2)+Math.pow(ot.g-lt.g,2)+Math.pow(ot.b-lt.b,2));vt<ut&&(ut=vt,ft=gt)}return ft}},et.string.push([function(st){var ot=st.toLowerCase(),lt=ot==="transparent"?"#0000":rt[ot];return lt?new tt(lt).toRgb():null},"name"])}k$2([namesPlugin]);const _Color=class Ed{constructor(et=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=et}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(et){return this.value=et,this}set value(et){if(et instanceof Ed)this._value=this.cloneSource(et._value),this._int=et._int,this._components.set(et._components);else{if(et===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,et))&&(this.normalize(et),this._value=this.cloneSource(et))}}get value(){return this._value}cloneSource(et){return typeof et=="string"||typeof et=="number"||et instanceof Number||et===null?et:Array.isArray(et)||ArrayBuffer.isView(et)?et.slice(0):typeof et=="object"&&et!==null?{...et}:et}isSourceEqual(et,rt){const nt=typeof et;if(nt!==typeof rt)return!1;if(nt==="number"||nt==="string"||et instanceof Number)return et===rt;if(Array.isArray(et)&&Array.isArray(rt)||ArrayBuffer.isView(et)&&ArrayBuffer.isView(rt))return et.length!==rt.length?!1:et.every((it,at)=>it===rt[at]);if(et!==null&&rt!==null){const it=Object.keys(et),at=Object.keys(rt);return it.length!==at.length?!1:it.every(st=>et[st]===rt[st])}return et===rt}toRgba(){const[et,rt,nt,it]=this._components;return{r:et,g:rt,b:nt,a:it}}toRgb(){const[et,rt,nt]=this._components;return{r:et,g:rt,b:nt}}toRgbaString(){const[et,rt,nt]=this.toUint8RgbArray();return`rgba(${et},${rt},${nt},${this.alpha})`}toUint8RgbArray(et){const[rt,nt,it]=this._components;return et=et??[],et[0]=Math.round(rt*255),et[1]=Math.round(nt*255),et[2]=Math.round(it*255),et}toRgbArray(et){et=et??[];const[rt,nt,it]=this._components;return et[0]=rt,et[1]=nt,et[2]=it,et}toNumber(){return this._int}toLittleEndianNumber(){const et=this._int;return(et>>16)+(et&65280)+((et&255)<<16)}multiply(et){const[rt,nt,it,at]=Ed.temp.setValue(et)._components;return this._components[0]*=rt,this._components[1]*=nt,this._components[2]*=it,this._components[3]*=at,this.refreshInt(),this._value=null,this}premultiply(et,rt=!0){return rt&&(this._components[0]*=et,this._components[1]*=et,this._components[2]*=et),this._components[3]=et,this.refreshInt(),this._value=null,this}toPremultiplied(et,rt=!0){if(et===1)return(255<<24)+this._int;if(et===0)return rt?0:this._int;let nt=this._int>>16&255,it=this._int>>8&255,at=this._int&255;return rt&&(nt=nt*et+.5|0,it=it*et+.5|0,at=at*et+.5|0),(et*255<<24)+(nt<<16)+(it<<8)+at}toHex(){const et=this._int.toString(16);return`#${"000000".substring(0,6-et.length)+et}`}toHexa(){const et=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-et.length)+et}setAlpha(et){return this._components[3]=this._clamp(et),this}round(et){const[rt,nt,it]=this._components;return this._components[0]=Math.round(rt*et)/et,this._components[1]=Math.round(nt*et)/et,this._components[2]=Math.round(it*et)/et,this.refreshInt(),this._value=null,this}toArray(et){et=et??[];const[rt,nt,it,at]=this._components;return et[0]=rt,et[1]=nt,et[2]=it,et[3]=at,et}normalize(et){let rt,nt,it,at;if((typeof et=="number"||et instanceof Number)&&et>=0&&et<=16777215){const st=et;rt=(st>>16&255)/255,nt=(st>>8&255)/255,it=(st&255)/255,at=1}else if((Array.isArray(et)||et instanceof Float32Array)&&et.length>=3&&et.length<=4)et=this._clamp(et),[rt,nt,it,at=1]=et;else if((et instanceof Uint8Array||et instanceof Uint8ClampedArray)&&et.length>=3&&et.length<=4)et=this._clamp(et,0,255),[rt,nt,it,at=255]=et,rt/=255,nt/=255,it/=255,at/=255;else if(typeof et=="string"||typeof et=="object"){if(typeof et=="string"){const ot=Ed.HEX_PATTERN.exec(et);ot&&(et=`#${ot[2]}`)}const st=w(et);st.isValid()&&({r:rt,g:nt,b:it,a:at}=st.rgba,rt/=255,nt/=255,it/=255)}if(rt!==void 0)this._components[0]=rt,this._components[1]=nt,this._components[2]=it,this._components[3]=at,this.refreshInt();else throw new Error(`Unable to convert color ${et}`)}refreshInt(){this._clamp(this._components);const[et,rt,nt]=this._components;this._int=(et*255<<16)+(rt*255<<8)+(nt*255|0)}_clamp(et,rt=0,nt=1){return typeof et=="number"?Math.min(Math.max(et,rt),nt):(et.forEach((it,at)=>{et[at]=Math.min(Math.max(it,rt),nt)}),et)}};_Color.shared=new _Color,_Color.temp=new _Color,_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Color=_Color;function hex2string(tt){return deprecation("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Color.shared.setValue(tt).toHex()}function rgb2hex(tt){return deprecation("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Color.shared.setValue(tt).toNumber()}function mapPremultipliedBlendModes(){const tt=[],et=[];for(let nt=0;nt<32;nt++)tt[nt]=nt,et[nt]=nt;tt[BLEND_MODES.NORMAL_NPM]=BLEND_MODES.NORMAL,tt[BLEND_MODES.ADD_NPM]=BLEND_MODES.ADD,tt[BLEND_MODES.SCREEN_NPM]=BLEND_MODES.SCREEN,et[BLEND_MODES.NORMAL]=BLEND_MODES.NORMAL_NPM,et[BLEND_MODES.ADD]=BLEND_MODES.ADD_NPM,et[BLEND_MODES.SCREEN]=BLEND_MODES.SCREEN_NPM;const rt=[];return rt.push(et),rt.push(tt),rt}const premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(tt,et){return premultiplyBlendMode[et?1:0][tt]}function createIndicesForQuads(tt,et=null){const rt=tt*6;if(et=et||new Uint16Array(rt),et.length!==rt)throw new Error(`Out buffer length is incorrect, got ${et.length} and expected ${rt}`);for(let nt=0,it=0;nt<rt;nt+=6,it+=4)et[nt+0]=it+0,et[nt+1]=it+1,et[nt+2]=it+2,et[nt+3]=it+0,et[nt+4]=it+2,et[nt+5]=it+3;return et}function getBufferType(tt){if(tt.BYTES_PER_ELEMENT===4)return tt instanceof Float32Array?"Float32Array":tt instanceof Uint32Array?"Uint32Array":"Int32Array";if(tt.BYTES_PER_ELEMENT===2){if(tt instanceof Uint16Array)return"Uint16Array"}else if(tt.BYTES_PER_ELEMENT===1&&tt instanceof Uint8Array)return"Uint8Array";return null}function nextPow2(tt){return tt+=tt===0?1:0,--tt,tt|=tt>>>1,tt|=tt>>>2,tt|=tt>>>4,tt|=tt>>>8,tt|=tt>>>16,tt+1}function isPow2(tt){return!(tt&tt-1)&&!!tt}function log2(tt){let et=(tt>65535?1:0)<<4;tt>>>=et;let rt=(tt>255?1:0)<<3;return tt>>>=rt,et|=rt,rt=(tt>15?1:0)<<2,tt>>>=rt,et|=rt,rt=(tt>3?1:0)<<1,tt>>>=rt,et|=rt,et|tt>>1}function removeItems(tt,et,rt){const nt=tt.length;let it;if(et>=nt||rt===0)return;rt=et+rt>nt?nt-et:rt;const at=nt-rt;for(it=et;it<at;++it)tt[it]=tt[it+rt];tt.length=at}function sign(tt){return tt===0?0:tt<0?-1:1}let nextUid=0;function uid(){return++nextUid}const _BoundingBox=class{constructor(tt,et,rt,nt){this.left=tt,this.top=et,this.right=rt,this.bottom=nt}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};_BoundingBox.EMPTY=new _BoundingBox(0,0,0,0);let BoundingBox=_BoundingBox;const ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null);class CanvasRenderTarget{constructor(et,rt,nt){this._canvas=settings.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=nt||settings.RESOLUTION,this.resize(et,rt)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(et,rt){this._checkDestroyed(),this._canvas.width=Math.round(et*this.resolution),this._canvas.height=Math.round(rt*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(et){this._checkDestroyed(),this._canvas.width=Math.round(et)}get height(){return this._checkDestroyed(),this._canvas.height}set height(et){this._checkDestroyed(),this._canvas.height=Math.round(et)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function checkRow(tt,et,rt){for(let nt=0,it=4*rt*et;nt<et;++nt,it+=4)if(tt[it+3]!==0)return!1;return!0}function checkColumn(tt,et,rt,nt,it){const at=4*et;for(let st=nt,ot=nt*at+4*rt;st<=it;++st,ot+=at)if(tt[ot+3]!==0)return!1;return!0}function getCanvasBoundingBox(tt){const{width:et,height:rt}=tt,nt=tt.getContext("2d",{willReadFrequently:!0});if(nt===null)throw new TypeError("Failed to get canvas 2D context");const it=nt.getImageData(0,0,et,rt).data;let at=0,st=0,ot=et-1,lt=rt-1;for(;st<rt&&checkRow(it,et,st);)++st;if(st===rt)return BoundingBox.EMPTY;for(;checkRow(it,et,lt);)--lt;for(;checkColumn(it,et,at,st,lt);)++at;for(;checkColumn(it,et,ot,st,lt);)--ot;return++ot,++lt,new BoundingBox(at,st,ot,lt)}function trimCanvas(tt){const et=getCanvasBoundingBox(tt),{width:rt,height:nt}=et;let it=null;if(!et.isEmpty()){const at=tt.getContext("2d");if(at===null)throw new TypeError("Failed to get canvas 2D context");it=at.getImageData(et.left,et.top,rt,nt)}return{width:rt,height:nt,data:it}}function determineCrossOrigin(tt,et=globalThis.location){if(tt.startsWith("data:"))return"";et=et||globalThis.location;const rt=new URL(tt,document.baseURI);return rt.hostname!==et.hostname||rt.port!==et.port||rt.protocol!==et.protocol?"anonymous":""}function getResolutionOfUrl(tt,et=1){const rt=settings.RETINA_PREFIX?.exec(tt);return rt?parseFloat(rt[1]):et}var ExtensionType=(tt=>(tt.Renderer="renderer",tt.Application="application",tt.RendererSystem="renderer-webgl-system",tt.RendererPlugin="renderer-webgl-plugin",tt.CanvasRendererSystem="renderer-canvas-system",tt.CanvasRendererPlugin="renderer-canvas-plugin",tt.Asset="asset",tt.LoadParser="load-parser",tt.ResolveParser="resolve-parser",tt.CacheParser="cache-parser",tt.DetectionParser="detection-parser",tt))(ExtensionType||{});const normalizeExtension=tt=>{if(typeof tt=="function"||typeof tt=="object"&&tt.extension){if(!tt.extension)throw new Error("Extension class must have an extension object");tt={...typeof tt.extension!="object"?{type:tt.extension}:tt.extension,ref:tt}}if(typeof tt=="object")tt={...tt};else throw new Error("Invalid extension type");return typeof tt.type=="string"&&(tt.type=[tt.type]),tt},normalizePriority=(tt,et)=>normalizeExtension(tt).priority??et,extensions$1={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...tt){return tt.map(normalizeExtension).forEach(et=>{et.type.forEach(rt=>this._removeHandlers[rt]?.(et))}),this},add(...tt){return tt.map(normalizeExtension).forEach(et=>{et.type.forEach(rt=>{const nt=this._addHandlers,it=this._queue;nt[rt]?nt[rt]?.(et):(it[rt]=it[rt]||[],it[rt]?.push(et))})}),this},handle(tt,et,rt){const nt=this._addHandlers,it=this._removeHandlers;if(nt[tt]||it[tt])throw new Error(`Extension type ${tt} already has a handler`);nt[tt]=et,it[tt]=rt;const at=this._queue;return at[tt]&&(at[tt]?.forEach(st=>et(st)),delete at[tt]),this},handleByMap(tt,et){return this.handle(tt,rt=>{rt.name&&(et[rt.name]=rt.ref)},rt=>{rt.name&&delete et[rt.name]})},handleByList(tt,et,rt=-1){return this.handle(tt,nt=>{et.includes(nt.ref)||(et.push(nt.ref),et.sort((it,at)=>normalizePriority(at,rt)-normalizePriority(it,rt)))},nt=>{const it=et.indexOf(nt.ref);it!==-1&&et.splice(it,1)})}};class ViewableBuffer{constructor(et){typeof et=="number"?this.rawBinaryData=new ArrayBuffer(et):et instanceof Uint8Array?this.rawBinaryData=et.buffer:this.rawBinaryData=et,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(et){return this[`${et}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(et){switch(et){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${et} isn't a valid view type`)}}}const fragTemplate$1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(tt){let et="";for(let rt=0;rt<tt;++rt)rt>0&&(et+=`
else `),rt<tt-1&&(et+=`if(test == ${rt}.0){}`);return et}function checkMaxIfStatementsInShader(tt,et){if(tt===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const rt=et.createShader(et.FRAGMENT_SHADER);for(;;){const nt=fragTemplate$1.replace(/%forloop%/gi,generateIfTestSrc(tt));if(et.shaderSource(rt,nt),et.compileShader(rt),!et.getShaderParameter(rt,et.COMPILE_STATUS))tt=tt/2|0;else break}return tt}const BLEND$1=0,OFFSET$1=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5;class State{constructor(){this.data=0,this.blendMode=BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<BLEND$1)}set blend(et){!!(this.data&1<<BLEND$1)!==et&&(this.data^=1<<BLEND$1)}get offsets(){return!!(this.data&1<<OFFSET$1)}set offsets(et){!!(this.data&1<<OFFSET$1)!==et&&(this.data^=1<<OFFSET$1)}get culling(){return!!(this.data&1<<CULLING$1)}set culling(et){!!(this.data&1<<CULLING$1)!==et&&(this.data^=1<<CULLING$1)}get depthTest(){return!!(this.data&1<<DEPTH_TEST$1)}set depthTest(et){!!(this.data&1<<DEPTH_TEST$1)!==et&&(this.data^=1<<DEPTH_TEST$1)}get depthMask(){return!!(this.data&1<<DEPTH_MASK$1)}set depthMask(et){!!(this.data&1<<DEPTH_MASK$1)!==et&&(this.data^=1<<DEPTH_MASK$1)}get clockwiseFrontFace(){return!!(this.data&1<<WINDING$1)}set clockwiseFrontFace(et){!!(this.data&1<<WINDING$1)!==et&&(this.data^=1<<WINDING$1)}get blendMode(){return this._blendMode}set blendMode(et){this.blend=et!==BLEND_MODES.NONE,this._blendMode=et}get polygonOffset(){return this._polygonOffset}set polygonOffset(et){this.offsets=!!et,this._polygonOffset=et}static for2d(){const et=new State;return et.depthTest=!1,et.blend=!0,et}}State.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const INSTALLED=[];function autoDetectResource(tt,et){if(!tt)return null;let rt="";if(typeof tt=="string"){const nt=/\.(\w{3,4})(?:$|\?|#)/i.exec(tt);nt&&(rt=nt[1].toLowerCase())}for(let nt=INSTALLED.length-1;nt>=0;--nt){const it=INSTALLED[nt];if(it.test&&it.test(tt,rt))return new it(tt,et)}throw new Error("Unrecognized source type to auto-detect Resource")}class Runner{constructor(et){this.items=[],this._name=et,this._aliasCount=0}emit(et,rt,nt,it,at,st,ot,lt){if(arguments.length>8)throw new Error("max arguments reached");const{name:ht,items:dt}=this;this._aliasCount++;for(let ut=0,ft=dt.length;ut<ft;ut++)dt[ut][ht](et,rt,nt,it,at,st,ot,lt);return dt===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(et){return et[this._name]&&(this.ensureNonAliasedItems(),this.remove(et),this.items.push(et)),this}remove(et){const rt=this.items.indexOf(et);return rt!==-1&&(this.ensureNonAliasedItems(),this.items.splice(rt,1)),this}contains(et){return this.items.includes(et)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}});class Resource{constructor(et=0,rt=0){this._width=et,this._height=rt,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}bind(et){this.onResize.add(et),this.onUpdate.add(et),this.onError.add(et),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(et){this.onResize.remove(et),this.onUpdate.remove(et),this.onError.remove(et)}resize(et,rt){(et!==this._width||rt!==this._height)&&(this._width=et,this._height=rt,this.onResize.emit(et,rt))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(et,rt,nt){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(et,rt){return!1}}class BufferResource extends Resource{constructor(et,rt){const{width:nt,height:it}=rt||{};if(!nt||!it)throw new Error("BufferResource width or height invalid");super(nt,it),this.data=et,this.unpackAlignment=rt.unpackAlignment??4}upload(et,rt,nt){const it=et.gl;it.pixelStorei(it.UNPACK_ALIGNMENT,this.unpackAlignment),it.pixelStorei(it.UNPACK_PREMULTIPLY_ALPHA_WEBGL,rt.alphaMode===ALPHA_MODES.UNPACK);const at=rt.realWidth,st=rt.realHeight;return nt.width===at&&nt.height===st?it.texSubImage2D(rt.target,0,0,0,at,st,rt.format,nt.type,this.data):(nt.width=at,nt.height=st,it.texImage2D(rt.target,0,nt.internalFormat,at,st,0,rt.format,nt.type,this.data)),!0}dispose(){this.data=null}static test(et){return et===null||et instanceof Int8Array||et instanceof Uint8Array||et instanceof Uint8ClampedArray||et instanceof Int16Array||et instanceof Uint16Array||et instanceof Int32Array||et instanceof Uint32Array||et instanceof Float32Array}}const defaultBufferOptions={scaleMode:SCALE_MODES.NEAREST,alphaMode:ALPHA_MODES.NPM},_BaseTexture=class lh extends EventEmitter{constructor(et=null,rt=null){super(),rt=Object.assign({},lh.defaultOptions,rt);const{alphaMode:nt,mipmap:it,anisotropicLevel:at,scaleMode:st,width:ot,height:lt,wrapMode:ht,format:dt,type:ut,target:ft,resolution:mt,resourceOptions:gt}=rt;et&&!(et instanceof Resource)&&(et=autoDetectResource(et,gt),et.internal=!0),this.resolution=mt||settings.RESOLUTION,this.width=Math.round((ot||0)*this.resolution)/this.resolution,this.height=Math.round((lt||0)*this.resolution)/this.resolution,this._mipmap=it,this.anisotropicLevel=at,this._wrapMode=ht,this._scaleMode=st,this.format=dt,this.type=ut,this.target=ft,this.alphaMode=nt,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=ot>0&&lt>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(et)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(et){this._mipmap!==et&&(this._mipmap=et,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(et){this._scaleMode!==et&&(this._scaleMode=et,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(et){this._wrapMode!==et&&(this._wrapMode=et,this.dirtyStyleId++)}setStyle(et,rt){let nt;return et!==void 0&&et!==this.scaleMode&&(this.scaleMode=et,nt=!0),rt!==void 0&&rt!==this.mipmap&&(this.mipmap=rt,nt=!0),nt&&this.dirtyStyleId++,this}setSize(et,rt,nt){return nt=nt||this.resolution,this.setRealSize(et*nt,rt*nt,nt)}setRealSize(et,rt,nt){return this.resolution=nt||this.resolution,this.width=Math.round(et)/this.resolution,this.height=Math.round(rt)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)}setResolution(et){const rt=this.resolution;return rt===et?this:(this.resolution=et,this.valid&&(this.width=Math.round(this.width*rt)/et,this.height=Math.round(this.height*rt)/et,this.emit("update",this)),this._refreshPOT(),this)}setResource(et){if(this.resource===et)return this;if(this.resource)throw new Error("Resource can be set only once");return et.bind(this),this.resource=et,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(et){this.emit("error",this,et)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),lh.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(et,rt,nt=settings.STRICT_TEXTURE_CACHE){const it=typeof et=="string";let at=null;if(it)at=et;else{if(!et._pixiId){const ot=rt?.pixiIdPrefix||"pixiid";et._pixiId=`${ot}_${uid()}`}at=et._pixiId}let st=BaseTextureCache[at];if(it&&nt&&!st)throw new Error(`The cacheId "${at}" does not exist in BaseTextureCache.`);return st||(st=new lh(et,rt),st.cacheId=at,lh.addToCache(st,at)),st}static fromBuffer(et,rt,nt,it){et=et||new Float32Array(rt*nt*4);const at=new BufferResource(et,{width:rt,height:nt,...it?.resourceOptions});let st,ot;return et instanceof Float32Array?(st=FORMATS.RGBA,ot=TYPES.FLOAT):et instanceof Int32Array?(st=FORMATS.RGBA_INTEGER,ot=TYPES.INT):et instanceof Uint32Array?(st=FORMATS.RGBA_INTEGER,ot=TYPES.UNSIGNED_INT):et instanceof Int16Array?(st=FORMATS.RGBA_INTEGER,ot=TYPES.SHORT):et instanceof Uint16Array?(st=FORMATS.RGBA_INTEGER,ot=TYPES.UNSIGNED_SHORT):et instanceof Int8Array?(st=FORMATS.RGBA,ot=TYPES.BYTE):(st=FORMATS.RGBA,ot=TYPES.UNSIGNED_BYTE),at.internal=!0,new lh(at,Object.assign({},defaultBufferOptions,{type:ot,format:st},it))}static addToCache(et,rt){rt&&(et.textureCacheIds.includes(rt)||et.textureCacheIds.push(rt),BaseTextureCache[rt]&&BaseTextureCache[rt]!==et&&console.warn(`BaseTexture added to the cache with an id [${rt}] that already had an entry`),BaseTextureCache[rt]=et)}static removeFromCache(et){if(typeof et=="string"){const rt=BaseTextureCache[et];if(rt){const nt=rt.textureCacheIds.indexOf(et);return nt>-1&&rt.textureCacheIds.splice(nt,1),delete BaseTextureCache[et],rt}}else if(et?.textureCacheIds){for(let rt=0;rt<et.textureCacheIds.length;++rt)delete BaseTextureCache[et.textureCacheIds[rt]];return et.textureCacheIds.length=0,et}return null}};_BaseTexture.defaultOptions={mipmap:MIPMAP_MODES.POW2,anisotropicLevel:0,scaleMode:SCALE_MODES.LINEAR,wrapMode:WRAP_MODES.CLAMP,alphaMode:ALPHA_MODES.UNPACK,target:TARGETS.TEXTURE_2D,format:FORMATS.RGBA,type:TYPES.UNSIGNED_BYTE},_BaseTexture._globalBatch=0;let BaseTexture=_BaseTexture;class BatchDrawCall{constructor(){this.texArray=null,this.blend=0,this.type=DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}let UID$4=0,Buffer$2=class Xf{constructor(et,rt=!0,nt=!1){this.data=et||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=nt,this.static=rt,this.id=UID$4++,this.disposeRunner=new Runner("disposeBuffer")}update(et){et instanceof Array&&(et=new Float32Array(et)),this.data=et||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(et){this.type=et?BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:BUFFER_TYPE.ARRAY_BUFFER}get index(){return this.type===BUFFER_TYPE.ELEMENT_ARRAY_BUFFER}static from(et){return et instanceof Array&&(et=new Float32Array(et)),new Xf(et)}};class Attribute{constructor(et,rt=0,nt=!1,it=TYPES.FLOAT,at,st,ot,lt=1){this.buffer=et,this.size=rt,this.normalized=nt,this.type=it,this.stride=at,this.start=st,this.instance=ot,this.divisor=lt}destroy(){this.buffer=null}static from(et,rt,nt,it,at){return new Attribute(et,rt,nt,it,at)}}const map$1={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays(tt,et){let rt=0,nt=0;const it={};for(let lt=0;lt<tt.length;lt++)nt+=et[lt],rt+=tt[lt].length;const at=new ArrayBuffer(rt*4);let st=null,ot=0;for(let lt=0;lt<tt.length;lt++){const ht=et[lt],dt=tt[lt],ut=getBufferType(dt);it[ut]||(it[ut]=new map$1[ut](at)),st=it[ut];for(let ft=0;ft<dt.length;ft++){const mt=(ft/ht|0)*nt+ot,gt=ft%ht;st[mt+gt]=dt[ft]}ot+=ht}return new Float32Array(at)}const byteSizeMap$1={5126:4,5123:2,5121:1};let UID$3=0;const map={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Geometry{constructor(et=[],rt={}){this.buffers=et,this.indexBuffer=null,this.attributes=rt,this.glVertexArrayObjects={},this.id=UID$3++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}addAttribute(et,rt,nt=0,it=!1,at,st,ot,lt=!1){if(!rt)throw new Error("You must pass a buffer when creating an attribute");rt instanceof Buffer$2||(rt instanceof Array&&(rt=new Float32Array(rt)),rt=new Buffer$2(rt));const ht=et.split("|");if(ht.length>1){for(let ut=0;ut<ht.length;ut++)this.addAttribute(ht[ut],rt,nt,it,at);return this}let dt=this.buffers.indexOf(rt);return dt===-1&&(this.buffers.push(rt),dt=this.buffers.length-1),this.attributes[et]=new Attribute(dt,nt,it,at,st,ot,lt),this.instanced=this.instanced||lt,this}getAttribute(et){return this.attributes[et]}getBuffer(et){return this.buffers[this.getAttribute(et).buffer]}addIndex(et){return et instanceof Buffer$2||(et instanceof Array&&(et=new Uint16Array(et)),et=new Buffer$2(et)),et.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=et,this.buffers.includes(et)||this.buffers.push(et),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const et=[],rt=[],nt=new Buffer$2;let it;for(it in this.attributes){const at=this.attributes[it],st=this.buffers[at.buffer];et.push(st.data),rt.push(at.size*byteSizeMap$1[at.type]/4),at.buffer=0}for(nt.data=interleaveTypedArrays(et,rt),it=0;it<this.buffers.length;it++)this.buffers[it]!==this.indexBuffer&&this.buffers[it].destroy();return this.buffers=[nt],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const et in this.attributes){const rt=this.attributes[et];return this.buffers[rt.buffer].data.length/(rt.stride/4||rt.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const et=new Geometry;for(let rt=0;rt<this.buffers.length;rt++)et.buffers[rt]=new Buffer$2(this.buffers[rt].data.slice(0));for(const rt in this.attributes){const nt=this.attributes[rt];et.attributes[rt]=new Attribute(nt.buffer,nt.size,nt.normalized,nt.type,nt.stride,nt.start,nt.instance)}return this.indexBuffer&&(et.indexBuffer=et.buffers[this.buffers.indexOf(this.indexBuffer)],et.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),et}static merge(et){const rt=new Geometry,nt=[],it=[],at=[];let st;for(let ot=0;ot<et.length;ot++){st=et[ot];for(let lt=0;lt<st.buffers.length;lt++)it[lt]=it[lt]||0,it[lt]+=st.buffers[lt].data.length,at[lt]=0}for(let ot=0;ot<st.buffers.length;ot++)nt[ot]=new map[getBufferType(st.buffers[ot].data)](it[ot]),rt.buffers[ot]=new Buffer$2(nt[ot]);for(let ot=0;ot<et.length;ot++){st=et[ot];for(let lt=0;lt<st.buffers.length;lt++)nt[lt].set(st.buffers[lt].data,at[lt]),at[lt]+=st.buffers[lt].data.length}if(rt.attributes=st.attributes,st.indexBuffer){rt.indexBuffer=rt.buffers[st.buffers.indexOf(st.indexBuffer)],rt.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;let ot=0,lt=0,ht=0,dt=0;for(let ut=0;ut<st.buffers.length;ut++)if(st.buffers[ut]!==st.indexBuffer){dt=ut;break}for(const ut in st.attributes){const ft=st.attributes[ut];(ft.buffer|0)===dt&&(lt+=ft.size*byteSizeMap$1[ft.type]/4)}for(let ut=0;ut<et.length;ut++){const ft=et[ut].indexBuffer.data;for(let mt=0;mt<ft.length;mt++)rt.indexBuffer.data[mt+ht]+=ot;ot+=et[ut].buffers[dt].data.length/lt,ht+=ft.length}}return rt}}class BatchGeometry extends Geometry{constructor(et=!1){super(),this._buffer=new Buffer$2(null,et,!1),this._indexBuffer=new Buffer$2(null,et,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,TYPES.FLOAT).addIndex(this._indexBuffer)}}const PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;var SHAPES=(tt=>(tt[tt.POLY=0]="POLY",tt[tt.RECT=1]="RECT",tt[tt.CIRC=2]="CIRC",tt[tt.ELIP=3]="ELIP",tt[tt.RREC=4]="RREC",tt))(SHAPES||{});let Point$2=class Qf{constructor(et=0,rt=0){this.x=0,this.y=0,this.x=et,this.y=rt}clone(){return new Qf(this.x,this.y)}copyFrom(et){return this.set(et.x,et.y),this}copyTo(et){return et.set(this.x,this.y),et}equals(et){return et.x===this.x&&et.y===this.y}set(et=0,rt=et){return this.x=et,this.y=rt,this}};Point$2.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const tempPoints$1=[new Point$2,new Point$2,new Point$2,new Point$2];class Rectangle{constructor(et=0,rt=0,nt=0,it=0){this.x=Number(et),this.y=Number(rt),this.width=Number(nt),this.height=Number(it),this.type=SHAPES.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFrom(et){return this.x=et.x,this.y=et.y,this.width=et.width,this.height=et.height,this}copyTo(et){return et.x=this.x,et.y=this.y,et.width=this.width,et.height=this.height,et}contains(et,rt){return this.width<=0||this.height<=0?!1:et>=this.x&&et<this.x+this.width&&rt>=this.y&&rt<this.y+this.height}intersects(et,rt){if(!rt){const Lt=this.x<et.x?et.x:this.x;if((this.right>et.right?et.right:this.right)<=Lt)return!1;const kt=this.y<et.y?et.y:this.y;return(this.bottom>et.bottom?et.bottom:this.bottom)>kt}const nt=this.left,it=this.right,at=this.top,st=this.bottom;if(it<=nt||st<=at)return!1;const ot=tempPoints$1[0].set(et.left,et.top),lt=tempPoints$1[1].set(et.left,et.bottom),ht=tempPoints$1[2].set(et.right,et.top),dt=tempPoints$1[3].set(et.right,et.bottom);if(ht.x<=ot.x||lt.y<=ot.y)return!1;const ut=Math.sign(rt.a*rt.d-rt.b*rt.c);if(ut===0||(rt.apply(ot,ot),rt.apply(lt,lt),rt.apply(ht,ht),rt.apply(dt,dt),Math.max(ot.x,lt.x,ht.x,dt.x)<=nt||Math.min(ot.x,lt.x,ht.x,dt.x)>=it||Math.max(ot.y,lt.y,ht.y,dt.y)<=at||Math.min(ot.y,lt.y,ht.y,dt.y)>=st))return!1;const ft=ut*(lt.y-ot.y),mt=ut*(ot.x-lt.x),gt=ft*nt+mt*at,vt=ft*it+mt*at,xt=ft*nt+mt*st,wt=ft*it+mt*st;if(Math.max(gt,vt,xt,wt)<=ft*ot.x+mt*ot.y||Math.min(gt,vt,xt,wt)>=ft*dt.x+mt*dt.y)return!1;const At=ut*(ot.y-ht.y),Tt=ut*(ht.x-ot.x),Pt=At*nt+Tt*at,Rt=At*it+Tt*at,Ot=At*nt+Tt*st,Et=At*it+Tt*st;return!(Math.max(Pt,Rt,Ot,Et)<=At*ot.x+Tt*ot.y||Math.min(Pt,Rt,Ot,Et)>=At*dt.x+Tt*dt.y)}pad(et=0,rt=et){return this.x-=et,this.y-=rt,this.width+=et*2,this.height+=rt*2,this}fit(et){const rt=Math.max(this.x,et.x),nt=Math.min(this.x+this.width,et.x+et.width),it=Math.max(this.y,et.y),at=Math.min(this.y+this.height,et.y+et.height);return this.x=rt,this.width=Math.max(nt-rt,0),this.y=it,this.height=Math.max(at-it,0),this}ceil(et=1,rt=.001){const nt=Math.ceil((this.x+this.width-rt)*et)/et,it=Math.ceil((this.y+this.height-rt)*et)/et;return this.x=Math.floor((this.x+rt)*et)/et,this.y=Math.floor((this.y+rt)*et)/et,this.width=nt-this.x,this.height=it-this.y,this}enlarge(et){const rt=Math.min(this.x,et.x),nt=Math.max(this.x+this.width,et.x+et.width),it=Math.min(this.y,et.y),at=Math.max(this.y+this.height,et.y+et.height);return this.x=rt,this.width=nt-rt,this.y=it,this.height=at-it,this}}Rectangle.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Circle{constructor(et=0,rt=0,nt=0){this.x=et,this.y=rt,this.radius=nt,this.type=SHAPES.CIRC}clone(){return new Circle(this.x,this.y,this.radius)}contains(et,rt){if(this.radius<=0)return!1;const nt=this.radius*this.radius;let it=this.x-et,at=this.y-rt;return it*=it,at*=at,it+at<=nt}getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Circle.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Ellipse{constructor(et=0,rt=0,nt=0,it=0){this.x=et,this.y=rt,this.width=nt,this.height=it,this.type=SHAPES.ELIP}clone(){return new Ellipse(this.x,this.y,this.width,this.height)}contains(et,rt){if(this.width<=0||this.height<=0)return!1;let nt=(et-this.x)/this.width,it=(rt-this.y)/this.height;return nt*=nt,it*=it,nt+it<=1}getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}}Ellipse.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Polygon{constructor(...et){let rt=Array.isArray(et[0])?et[0]:et;if(typeof rt[0]!="number"){const nt=[];for(let it=0,at=rt.length;it<at;it++)nt.push(rt[it].x,rt[it].y);rt=nt}this.points=rt,this.type=SHAPES.POLY,this.closeStroke=!0}clone(){const et=this.points.slice(),rt=new Polygon(et);return rt.closeStroke=this.closeStroke,rt}contains(et,rt){let nt=!1;const it=this.points.length/2;for(let at=0,st=it-1;at<it;st=at++){const ot=this.points[at*2],lt=this.points[at*2+1],ht=this.points[st*2],dt=this.points[st*2+1];lt>rt!=dt>rt&&et<(ht-ot)*((rt-lt)/(dt-lt))+ot&&(nt=!nt)}return nt}}Polygon.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((tt,et)=>`${tt}, ${et}`,"")}]`};class RoundedRectangle{constructor(et=0,rt=0,nt=0,it=0,at=20){this.x=et,this.y=rt,this.width=nt,this.height=it,this.radius=at,this.type=SHAPES.RREC}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}contains(et,rt){if(this.width<=0||this.height<=0)return!1;if(et>=this.x&&et<=this.x+this.width&&rt>=this.y&&rt<=this.y+this.height){const nt=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(rt>=this.y+nt&&rt<=this.y+this.height-nt||et>=this.x+nt&&et<=this.x+this.width-nt)return!0;let it=et-(this.x+nt),at=rt-(this.y+nt);const st=nt*nt;if(it*it+at*at<=st||(it=et-(this.x+this.width-nt),it*it+at*at<=st)||(at=rt-(this.y+this.height-nt),it*it+at*at<=st)||(it=et-(this.x+nt),it*it+at*at<=st))return!0}return!1}}RoundedRectangle.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Matrix{constructor(et=1,rt=0,nt=0,it=1,at=0,st=0){this.array=null,this.a=et,this.b=rt,this.c=nt,this.d=it,this.tx=at,this.ty=st}fromArray(et){this.a=et[0],this.b=et[1],this.c=et[3],this.d=et[4],this.tx=et[2],this.ty=et[5]}set(et,rt,nt,it,at,st){return this.a=et,this.b=rt,this.c=nt,this.d=it,this.tx=at,this.ty=st,this}toArray(et,rt){this.array||(this.array=new Float32Array(9));const nt=rt||this.array;return et?(nt[0]=this.a,nt[1]=this.b,nt[2]=0,nt[3]=this.c,nt[4]=this.d,nt[5]=0,nt[6]=this.tx,nt[7]=this.ty,nt[8]=1):(nt[0]=this.a,nt[1]=this.c,nt[2]=this.tx,nt[3]=this.b,nt[4]=this.d,nt[5]=this.ty,nt[6]=0,nt[7]=0,nt[8]=1),nt}apply(et,rt){rt=rt||new Point$2;const nt=et.x,it=et.y;return rt.x=this.a*nt+this.c*it+this.tx,rt.y=this.b*nt+this.d*it+this.ty,rt}applyInverse(et,rt){rt=rt||new Point$2;const nt=1/(this.a*this.d+this.c*-this.b),it=et.x,at=et.y;return rt.x=this.d*nt*it+-this.c*nt*at+(this.ty*this.c-this.tx*this.d)*nt,rt.y=this.a*nt*at+-this.b*nt*it+(-this.ty*this.a+this.tx*this.b)*nt,rt}translate(et,rt){return this.tx+=et,this.ty+=rt,this}scale(et,rt){return this.a*=et,this.d*=rt,this.c*=et,this.b*=rt,this.tx*=et,this.ty*=rt,this}rotate(et){const rt=Math.cos(et),nt=Math.sin(et),it=this.a,at=this.c,st=this.tx;return this.a=it*rt-this.b*nt,this.b=it*nt+this.b*rt,this.c=at*rt-this.d*nt,this.d=at*nt+this.d*rt,this.tx=st*rt-this.ty*nt,this.ty=st*nt+this.ty*rt,this}append(et){const rt=this.a,nt=this.b,it=this.c,at=this.d;return this.a=et.a*rt+et.b*it,this.b=et.a*nt+et.b*at,this.c=et.c*rt+et.d*it,this.d=et.c*nt+et.d*at,this.tx=et.tx*rt+et.ty*it+this.tx,this.ty=et.tx*nt+et.ty*at+this.ty,this}setTransform(et,rt,nt,it,at,st,ot,lt,ht){return this.a=Math.cos(ot+ht)*at,this.b=Math.sin(ot+ht)*at,this.c=-Math.sin(ot-lt)*st,this.d=Math.cos(ot-lt)*st,this.tx=et-(nt*this.a+it*this.c),this.ty=rt-(nt*this.b+it*this.d),this}prepend(et){const rt=this.tx;if(et.a!==1||et.b!==0||et.c!==0||et.d!==1){const nt=this.a,it=this.c;this.a=nt*et.a+this.b*et.c,this.b=nt*et.b+this.b*et.d,this.c=it*et.a+this.d*et.c,this.d=it*et.b+this.d*et.d}return this.tx=rt*et.a+this.ty*et.c+et.tx,this.ty=rt*et.b+this.ty*et.d+et.ty,this}decompose(et){const rt=this.a,nt=this.b,it=this.c,at=this.d,st=et.pivot,ot=-Math.atan2(-it,at),lt=Math.atan2(nt,rt),ht=Math.abs(ot+lt);return ht<1e-5||Math.abs(PI_2-ht)<1e-5?(et.rotation=lt,et.skew.x=et.skew.y=0):(et.rotation=0,et.skew.x=ot,et.skew.y=lt),et.scale.x=Math.sqrt(rt*rt+nt*nt),et.scale.y=Math.sqrt(it*it+at*at),et.position.x=this.tx+(st.x*rt+st.y*it),et.position.y=this.ty+(st.x*nt+st.y*at),et}invert(){const et=this.a,rt=this.b,nt=this.c,it=this.d,at=this.tx,st=et*it-rt*nt;return this.a=it/st,this.b=-rt/st,this.c=-nt/st,this.d=et/st,this.tx=(nt*this.ty-it*at)/st,this.ty=-(et*this.ty-rt*at)/st,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const et=new Matrix;return et.a=this.a,et.b=this.b,et.c=this.c,et.d=this.d,et.tx=this.tx,et.ty=this.ty,et}copyTo(et){return et.a=this.a,et.b=this.b,et.c=this.c,et.d=this.d,et.tx=this.tx,et.ty=this.ty,et}copyFrom(et){return this.a=et.a,this.b=et.b,this.c=et.c,this.d=et.d,this.tx=et.tx,this.ty=et.ty,this}static get IDENTITY(){return new Matrix}static get TEMP_MATRIX(){return new Matrix}}Matrix.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init$1(){for(let tt=0;tt<16;tt++){const et=[];rotationCayley.push(et);for(let rt=0;rt<16;rt++){const nt=signum(ux[tt]*ux[rt]+vx[tt]*uy[rt]),it=signum(uy[tt]*ux[rt]+vy[tt]*uy[rt]),at=signum(ux[tt]*vx[rt]+vx[tt]*vy[rt]),st=signum(uy[tt]*vx[rt]+vy[tt]*vy[rt]);for(let ot=0;ot<16;ot++)if(ux[ot]===nt&&uy[ot]===it&&vx[ot]===at&&vy[ot]===st){et.push(ot);break}}}for(let tt=0;tt<16;tt++){const et=new Matrix;et.set(ux[tt],uy[tt],vx[tt],vy[tt],0,0),rotationMatrices.push(et)}}init$1();const groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:tt=>ux[tt],uY:tt=>uy[tt],vX:tt=>vx[tt],vY:tt=>vy[tt],inv:tt=>tt&8?tt&15:-tt&7,add:(tt,et)=>rotationCayley[tt][et],sub:(tt,et)=>rotationCayley[tt][groupD8.inv(et)],rotate180:tt=>tt^4,isVertical:tt=>(tt&3)===2,byDirection:(tt,et)=>Math.abs(tt)*2<=Math.abs(et)?et>=0?groupD8.S:groupD8.N:Math.abs(et)*2<=Math.abs(tt)?tt>0?groupD8.E:groupD8.W:et>0?tt>0?groupD8.SE:groupD8.SW:tt>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(tt,et,rt=0,nt=0)=>{const it=rotationMatrices[groupD8.inv(et)];it.tx=rt,it.ty=nt,tt.append(it)}};class ObservablePoint{constructor(et,rt,nt=0,it=0){this._x=nt,this._y=it,this.cb=et,this.scope=rt}clone(et=this.cb,rt=this.scope){return new ObservablePoint(et,rt,this._x,this._y)}set(et=0,rt=et){return(this._x!==et||this._y!==rt)&&(this._x=et,this._y=rt,this.cb.call(this.scope)),this}copyFrom(et){return(this._x!==et.x||this._y!==et.y)&&(this._x=et.x,this._y=et.y,this.cb.call(this.scope)),this}copyTo(et){return et.set(this._x,this._y),et}equals(et){return et.x===this._x&&et.y===this._y}get x(){return this._x}set x(et){this._x!==et&&(this._x=et,this.cb.call(this.scope))}get y(){return this._y}set y(et){this._y!==et&&(this._y=et,this.cb.call(this.scope))}}ObservablePoint.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const _Transform=class{constructor(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const tt=this.localTransform;this._localID!==this._currentLocalID&&(tt.a=this._cx*this.scale.x,tt.b=this._sx*this.scale.x,tt.c=this._cy*this.scale.y,tt.d=this._sy*this.scale.y,tt.tx=this.position.x-(this.pivot.x*tt.a+this.pivot.y*tt.c),tt.ty=this.position.y-(this.pivot.x*tt.b+this.pivot.y*tt.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(tt){const et=this.localTransform;if(this._localID!==this._currentLocalID&&(et.a=this._cx*this.scale.x,et.b=this._sx*this.scale.x,et.c=this._cy*this.scale.y,et.d=this._sy*this.scale.y,et.tx=this.position.x-(this.pivot.x*et.a+this.pivot.y*et.c),et.ty=this.position.y-(this.pivot.x*et.b+this.pivot.y*et.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==tt._worldID){const rt=tt.worldTransform,nt=this.worldTransform;nt.a=et.a*rt.a+et.b*rt.c,nt.b=et.a*rt.b+et.b*rt.d,nt.c=et.c*rt.a+et.d*rt.c,nt.d=et.c*rt.b+et.d*rt.d,nt.tx=et.tx*rt.a+et.ty*rt.c+rt.tx,nt.ty=et.tx*rt.b+et.ty*rt.d+rt.ty,this._parentID=tt._worldID,this._worldID++}}setFromMatrix(tt){tt.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(tt){this._rotation!==tt&&(this._rotation=tt,this.updateSkew())}};_Transform.IDENTITY=new _Transform;let Transform=_Transform;Transform.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var defaultFragment$2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,defaultVertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function compileShader(tt,et,rt){const nt=tt.createShader(et);return tt.shaderSource(nt,rt),tt.compileShader(nt),nt}function booleanArray(tt){const et=new Array(tt);for(let rt=0;rt<et.length;rt++)et[rt]=!1;return et}function defaultValue(tt,et){switch(tt){case"float":return 0;case"vec2":return new Float32Array(2*et);case"vec3":return new Float32Array(3*et);case"vec4":return new Float32Array(4*et);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*et);case"ivec3":return new Int32Array(3*et);case"ivec4":return new Int32Array(4*et);case"uvec2":return new Uint32Array(2*et);case"uvec3":return new Uint32Array(3*et);case"uvec4":return new Uint32Array(4*et);case"bool":return!1;case"bvec2":return booleanArray(2*et);case"bvec3":return booleanArray(3*et);case"bvec4":return booleanArray(4*et);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const uniformParsers=[{test:tt=>tt.type==="float"&&tt.size===1&&!tt.isArray,code:tt=>`
            if(uv["${tt}"] !== ud["${tt}"].value)
            {
                ud["${tt}"].value = uv["${tt}"]
                gl.uniform1f(ud["${tt}"].location, uv["${tt}"])
            }
            `},{test:(tt,et)=>(tt.type==="sampler2D"||tt.type==="samplerCube"||tt.type==="sampler2DArray")&&tt.size===1&&!tt.isArray&&(et==null||et.castToBaseTexture!==void 0),code:tt=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${tt}"], t);

            if(ud["${tt}"].value !== t)
            {
                ud["${tt}"].value = t;
                gl.uniform1i(ud["${tt}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(tt,et)=>tt.type==="mat3"&&tt.size===1&&!tt.isArray&&et.a!==void 0,code:tt=>`
            gl.uniformMatrix3fv(ud["${tt}"].location, false, uv["${tt}"].toArray(true));
            `,codeUbo:tt=>`
                var ${tt}_matrix = uv.${tt}.toArray(true);

                data[offset] = ${tt}_matrix[0];
                data[offset+1] = ${tt}_matrix[1];
                data[offset+2] = ${tt}_matrix[2];
        
                data[offset + 4] = ${tt}_matrix[3];
                data[offset + 5] = ${tt}_matrix[4];
                data[offset + 6] = ${tt}_matrix[5];
        
                data[offset + 8] = ${tt}_matrix[6];
                data[offset + 9] = ${tt}_matrix[7];
                data[offset + 10] = ${tt}_matrix[8];
            `},{test:(tt,et)=>tt.type==="vec2"&&tt.size===1&&!tt.isArray&&et.x!==void 0,code:tt=>`
                cv = ud["${tt}"].value;
                v = uv["${tt}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${tt}"].location, v.x, v.y);
                }`,codeUbo:tt=>`
                v = uv.${tt};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:tt=>tt.type==="vec2"&&tt.size===1&&!tt.isArray,code:tt=>`
                cv = ud["${tt}"].value;
                v = uv["${tt}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${tt}"].location, v[0], v[1]);
                }
            `},{test:(tt,et)=>tt.type==="vec4"&&tt.size===1&&!tt.isArray&&et.width!==void 0,code:tt=>`
                cv = ud["${tt}"].value;
                v = uv["${tt}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${tt}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:tt=>`
                    v = uv.${tt};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(tt,et)=>tt.type==="vec4"&&tt.size===1&&!tt.isArray&&et.red!==void 0,code:tt=>`
                cv = ud["${tt}"].value;
                v = uv["${tt}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${tt}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:tt=>`
                    v = uv.${tt};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(tt,et)=>tt.type==="vec3"&&tt.size===1&&!tt.isArray&&et.red!==void 0,code:tt=>`
                cv = ud["${tt}"].value;
                v = uv["${tt}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${tt}"].location, v.red, v.green, v.blue)
                }`,codeUbo:tt=>`
                    v = uv.${tt};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:tt=>tt.type==="vec4"&&tt.size===1&&!tt.isArray,code:tt=>`
                cv = ud["${tt}"].value;
                v = uv["${tt}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${tt}"].location, v[0], v[1], v[2], v[3])
                }`}],GLSL_TO_SINGLE_SETTERS_CACHED={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(tt,et){const rt=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const nt in tt.uniforms){const it=et[nt];if(!it){tt.uniforms[nt]?.group===!0&&(tt.uniforms[nt].ubo?rt.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${nt}, '${nt}');
                    `):rt.push(`
                        renderer.shader.syncUniformGroup(uv.${nt}, syncData);
                    `));continue}const at=tt.uniforms[nt];let st=!1;for(let ot=0;ot<uniformParsers.length;ot++)if(uniformParsers[ot].test(it,at)){rt.push(uniformParsers[ot].code(nt,at)),st=!0;break}if(!st){const ot=(it.size===1&&!it.isArray?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS)[it.type].replace("location",`ud["${nt}"].location`);rt.push(`
            cu = ud["${nt}"];
            cv = cu.value;
            v = uv["${nt}"];
            ${ot};`)}}return new Function("ud","uv","renderer","syncData",rt.join(`
`))}const unknownContext={};let context=unknownContext;function getTestContext(){if(context===unknownContext||context?.isContextLost()){const tt=settings.ADAPTER.createCanvas();let et;settings.PREFER_ENV>=ENV.WEBGL2&&(et=tt.getContext("webgl2",{})),et||(et=tt.getContext("webgl",{})||tt.getContext("experimental-webgl",{}),et?et.getExtension("WEBGL_draw_buffers"):et=null),context=et}return context}let maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=PRECISION.MEDIUM;const tt=getTestContext();if(tt&&tt.getShaderPrecisionFormat){const et=tt.getShaderPrecisionFormat(tt.FRAGMENT_SHADER,tt.HIGH_FLOAT);et&&(maxFragmentPrecision=et.precision?PRECISION.HIGH:PRECISION.MEDIUM)}}return maxFragmentPrecision}function logPrettyShaderError(tt,et){const rt=tt.getShaderSource(et).split(`
`).map((ht,dt)=>`${dt}: ${ht}`),nt=tt.getShaderInfoLog(et),it=nt.split(`
`),at={},st=it.map(ht=>parseFloat(ht.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(ht=>ht&&!at[ht]?(at[ht]=!0,!0):!1),ot=[""];st.forEach(ht=>{rt[ht-1]=`%c${rt[ht-1]}%c`,ot.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const lt=rt.join(`
`);ot[0]=lt,console.error(nt),console.groupCollapsed("click to view full shader code"),console.warn(...ot),console.groupEnd()}function logProgramError(tt,et,rt,nt){tt.getProgramParameter(et,tt.LINK_STATUS)||(tt.getShaderParameter(rt,tt.COMPILE_STATUS)||logPrettyShaderError(tt,rt),tt.getShaderParameter(nt,tt.COMPILE_STATUS)||logPrettyShaderError(tt,nt),console.error("PixiJS Error: Could not initialize shader."),tt.getProgramInfoLog(et)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",tt.getProgramInfoLog(et)))}const GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(tt){return GLSL_TO_SIZE[tt]}let GL_TABLE=null;const GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType$1(tt,et){if(!GL_TABLE){const rt=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(let nt=0;nt<rt.length;++nt){const it=rt[nt];GL_TABLE[tt[it]]=GL_TO_GLSL_TYPES[it]}}return GL_TABLE[et]}function setPrecision(tt,et,rt){if(tt.substring(0,9)!=="precision"){let nt=et;return et===PRECISION.HIGH&&rt!==PRECISION.HIGH&&(nt=PRECISION.MEDIUM),`precision ${nt} float;
${tt}`}else if(rt!==PRECISION.HIGH&&tt.substring(0,15)==="precision highp")return tt.replace("precision highp","precision mediump");return tt}let unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval=="boolean")return unsafeEval;try{unsafeEval=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{unsafeEval=!1}return unsafeEval}let UID$2=0;const nameCache={},_Program=class uh{constructor(et,rt,nt="pixi-shader",it={}){this.extra={},this.id=UID$2++,this.vertexSrc=et||uh.defaultVertexSrc,this.fragmentSrc=rt||uh.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=it,this.vertexSrc.substring(0,8)!=="#version"&&(nt=nt.replace(/\s+/g,"-"),nameCache[nt]?(nameCache[nt]++,nt+=`-${nameCache[nt]}`):nameCache[nt]=1,this.vertexSrc=`#define SHADER_NAME ${nt}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${nt}
${this.fragmentSrc}`,this.vertexSrc=setPrecision(this.vertexSrc,uh.defaultVertexPrecision,PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,uh.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return defaultVertex$3}static get defaultFragmentSrc(){return defaultFragment$2}static from(et,rt,nt){const it=et+rt;let at=ProgramCache[it];return at||(ProgramCache[it]=at=new uh(et,rt,nt)),at}};_Program.defaultVertexPrecision=PRECISION.HIGH,_Program.defaultFragmentPrecision=isMobile.apple.device?PRECISION.HIGH:PRECISION.MEDIUM;let Program=_Program,UID$1=0;class UniformGroup{constructor(et,rt,nt){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$1++,this.static=!!rt,this.ubo=!!nt,et instanceof Buffer$2?(this.buffer=et,this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=et,this.ubo&&(this.buffer=new Buffer$2(new Float32Array(1)),this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(et,rt,nt){if(!this.ubo)this.uniforms[et]=new UniformGroup(rt,nt);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(et,rt,nt){return new UniformGroup(et,rt,nt)}static uboFrom(et,rt){return new UniformGroup(et,rt??!0,!0)}}class Shader{constructor(et,rt){this.uniformBindCount=0,this.program=et,rt?rt instanceof UniformGroup?this.uniformGroup=rt:this.uniformGroup=new UniformGroup(rt):this.uniformGroup=new UniformGroup({}),this.disposeRunner=new Runner("disposeShader")}checkUniformExists(et,rt){if(rt.uniforms[et])return!0;for(const nt in rt.uniforms){const it=rt.uniforms[nt];if(it.group===!0&&this.checkUniformExists(et,it))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(et,rt,nt){const it=Program.from(et,rt);return new Shader(it,nt)}}class BatchShaderGenerator{constructor(et,rt){if(this.vertexSrc=et,this.fragTemplate=rt,this.programCache={},this.defaultGroupCache={},!rt.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!rt.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(et){if(!this.programCache[et]){const nt=new Int32Array(et);for(let at=0;at<et;at++)nt[at]=at;this.defaultGroupCache[et]=UniformGroup.from({uSamplers:nt},!0);let it=this.fragTemplate;it=it.replace(/%count%/gi,`${et}`),it=it.replace(/%forloop%/gi,this.generateSampleSrc(et)),this.programCache[et]=new Program(this.vertexSrc,it)}const rt={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[et]};return new Shader(this.programCache[et],rt)}generateSampleSrc(et){let rt="";rt+=`
`,rt+=`
`;for(let nt=0;nt<et;nt++)nt>0&&(rt+=`
else `),nt<et-1&&(rt+=`if(vTextureId < ${nt}.5)`),rt+=`
{`,rt+=`
	color = texture2D(uSamplers[${nt}], vTextureCoord);`,rt+=`
}`;return rt+=`
`,rt+=`
`,rt}}class BatchTextureArray{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let et=0;et<this.count;et++)this.elements[et]=null;this.count=0}}function canUploadSameBuffer(){return!isMobile.apple.device}function maxRecommendedTextures(tt){let et=!0;const rt=settings.ADAPTER.getNavigator();if(isMobile.tablet||isMobile.phone){if(isMobile.apple.device){const nt=rt.userAgent.match(/OS (\d+)_(\d+)?/);nt&&parseInt(nt[1],10)<11&&(et=!1)}if(isMobile.android.device){const nt=rt.userAgent.match(/Android\s([0-9.]*)/);nt&&parseInt(nt[1],10)<7&&(et=!1)}}return et?tt:4}class ObjectRenderer{constructor(et){this.renderer=et}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(et){}}var defaultFragment$1=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,defaultVertex$2=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const _BatchRenderer=class Rl extends ObjectRenderer{constructor(et){super(et),this.setShaderGenerator(),this.geometryClass=BatchGeometry,this.vertexSize=6,this.state=State.for2d(),this.size=Rl.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),et.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??maxRecommendedTextures(32),this._defaultMaxTextures}static set defaultMaxTextures(et){this._defaultMaxTextures=et}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??canUploadSameBuffer(),this._canUploadSameBuffer}static set canUploadSameBuffer(et){this._canUploadSameBuffer=et}get MAX_TEXTURES(){return deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return defaultVertex$2}static get defaultFragmentTemplate(){return defaultFragment$1}setShaderGenerator({vertex:et=Rl.defaultVertexSrc,fragment:rt=Rl.defaultFragmentTemplate}={}){this.shaderGenerator=new BatchShaderGenerator(et,rt)}contextChange(){const et=this.renderer.gl;settings.PREFER_ENV===ENV.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(et.getParameter(et.MAX_TEXTURE_IMAGE_UNITS),Rl.defaultMaxTextures),this.maxTextures=checkMaxIfStatementsInShader(this.maxTextures,et)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let rt=0;rt<this._packedGeometryPoolSize;rt++)this._packedGeometries[rt]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:et,_textureArrayPool:rt}=Rl,nt=this.size/4,it=Math.floor(nt/this.maxTextures)+1;for(;et.length<nt;)et.push(new BatchDrawCall);for(;rt.length<it;)rt.push(new BatchTextureArray);for(let at=0;at<this.maxTextures;at++)this._tempBoundTextures[at]=null}onPrerender(){this._flushId=0}render(et){et._texture.valid&&(this._vertexCount+et.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=et.vertexData.length/2,this._indexCount+=et.indices.length,this._bufferedTextures[this._bufferSize]=et._texture.baseTexture,this._bufferedElements[this._bufferSize++]=et)}buildTexturesAndDrawCalls(){const{_bufferedTextures:et,maxTextures:rt}=this,nt=Rl._textureArrayPool,it=this.renderer.batch,at=this._tempBoundTextures,st=this.renderer.textureGC.count;let ot=++BaseTexture._globalBatch,lt=0,ht=nt[0],dt=0;it.copyBoundTextures(at,rt);for(let ut=0;ut<this._bufferSize;++ut){const ft=et[ut];et[ut]=null,ft._batchEnabled!==ot&&(ht.count>=rt&&(it.boundArray(ht,at,ot,rt),this.buildDrawCalls(ht,dt,ut),dt=ut,ht=nt[++lt],++ot),ft._batchEnabled=ot,ft.touched=st,ht.elements[ht.count++]=ft)}ht.count>0&&(it.boundArray(ht,at,ot,rt),this.buildDrawCalls(ht,dt,this._bufferSize),++lt,++ot);for(let ut=0;ut<at.length;ut++)at[ut]=null;BaseTexture._globalBatch=ot}buildDrawCalls(et,rt,nt){const{_bufferedElements:it,_attributeBuffer:at,_indexBuffer:st,vertexSize:ot}=this,lt=Rl._drawCallPool;let ht=this._dcIndex,dt=this._aIndex,ut=this._iIndex,ft=lt[ht];ft.start=this._iIndex,ft.texArray=et;for(let mt=rt;mt<nt;++mt){const gt=it[mt],vt=gt._texture.baseTexture,xt=premultiplyBlendMode[vt.alphaMode?1:0][gt.blendMode];it[mt]=null,rt<mt&&ft.blend!==xt&&(ft.size=ut-ft.start,rt=mt,ft=lt[++ht],ft.texArray=et,ft.start=ut),this.packInterleavedGeometry(gt,at,st,dt,ut),dt+=gt.vertexData.length/2*ot,ut+=gt.indices.length,ft.blend=xt}rt<nt&&(ft.size=ut-ft.start,++ht),this._dcIndex=ht,this._aIndex=dt,this._iIndex=ut}bindAndClearTexArray(et){const rt=this.renderer.texture;for(let nt=0;nt<et.count;nt++)rt.bind(et.elements[nt],et.ids[nt]),et.elements[nt]=null;et.count=0}updateGeometry(){const{_packedGeometries:et,_attributeBuffer:rt,_indexBuffer:nt}=this;Rl.canUploadSameBuffer?(et[this._flushId]._buffer.update(rt.rawBinaryData),et[this._flushId]._indexBuffer.update(nt),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,et[this._flushId]=new this.geometryClass),et[this._flushId]._buffer.update(rt.rawBinaryData),et[this._flushId]._indexBuffer.update(nt),this.renderer.geometry.bind(et[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const et=this._dcIndex,{gl:rt,state:nt}=this.renderer,it=Rl._drawCallPool;let at=null;for(let st=0;st<et;st++){const{texArray:ot,type:lt,size:ht,start:dt,blend:ut}=it[st];at!==ot&&(at=ot,this.bindAndClearTexArray(ot)),this.state.blendMode=ut,nt.set(this.state),rt.drawElements(lt,ht,rt.UNSIGNED_SHORT,dt*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Rl.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let et=0;et<this._packedGeometryPoolSize;et++)this._packedGeometries[et]&&this._packedGeometries[et].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(et){const rt=nextPow2(Math.ceil(et/8)),nt=log2(rt),it=rt*8;this._aBuffers.length<=nt&&(this._iBuffers.length=nt+1);let at=this._aBuffers[it];return at||(this._aBuffers[it]=at=new ViewableBuffer(it*this.vertexSize*4)),at}getIndexBuffer(et){const rt=nextPow2(Math.ceil(et/12)),nt=log2(rt),it=rt*12;this._iBuffers.length<=nt&&(this._iBuffers.length=nt+1);let at=this._iBuffers[nt];return at||(this._iBuffers[nt]=at=new Uint16Array(it)),at}packInterleavedGeometry(et,rt,nt,it,at){const{uint32View:st,float32View:ot}=rt,lt=it/this.vertexSize,ht=et.uvs,dt=et.indices,ut=et.vertexData,ft=et._texture.baseTexture._batchLocation,mt=Math.min(et.worldAlpha,1),gt=Color.shared.setValue(et._tintRGB).toPremultiplied(mt,et._texture.baseTexture.alphaMode>0);for(let vt=0;vt<ut.length;vt+=2)ot[it++]=ut[vt],ot[it++]=ut[vt+1],ot[it++]=ht[vt],ot[it++]=ht[vt+1],st[it++]=gt,ot[it++]=ft;for(let vt=0;vt<dt.length;vt++)nt[at++]=lt+dt[vt]}};_BatchRenderer.defaultBatchSize=4096,_BatchRenderer.extension={name:"batch",type:ExtensionType.RendererPlugin},_BatchRenderer._drawCallPool=[],_BatchRenderer._textureArrayPool=[];let BatchRenderer=_BatchRenderer;extensions$1.add(BatchRenderer);var defaultFragment=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,defaultVertex$1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const _Filter=class Gh extends Shader{constructor(et,rt,nt){const it=Program.from(et||Gh.defaultVertexSrc,rt||Gh.defaultFragmentSrc);super(it,nt),this.padding=0,this.resolution=Gh.defaultResolution,this.multisample=Gh.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new State}apply(et,rt,nt,it,at){et.applyFilter(this,rt,nt,it)}get blendMode(){return this.state.blendMode}set blendMode(et){this.state.blendMode=et}get resolution(){return this._resolution}set resolution(et){this._resolution=et}static get defaultVertexSrc(){return defaultVertex$1}static get defaultFragmentSrc(){return defaultFragment}};_Filter.defaultResolution=1,_Filter.defaultMultisample=MSAA_QUALITY.NONE;let Filter=_Filter;class BackgroundSystem{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Color(0),this.alpha=1}init(et){this.clearBeforeRender=et.clearBeforeRender;const{backgroundColor:rt,background:nt,backgroundAlpha:it}=et,at=nt??rt;at!==void 0&&(this.color=at),this.alpha=it}get color(){return this._backgroundColor.value}set color(et){this._backgroundColor.setValue(et)}get alpha(){return this._backgroundColor.alpha}set alpha(et){this._backgroundColor.setAlpha(et)}get backgroundColor(){return this._backgroundColor}destroy(){}}BackgroundSystem.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},BackgroundSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"background"};extensions$1.add(BackgroundSystem);class BatchSystem{constructor(et){this.renderer=et,this.emptyRenderer=new ObjectRenderer(et),this.currentRenderer=this.emptyRenderer}setObjectRenderer(et){this.currentRenderer!==et&&(this.currentRenderer.stop(),this.currentRenderer=et,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(et,rt){const{boundTextures:nt}=this.renderer.texture;for(let it=rt-1;it>=0;--it)et[it]=nt[it]||null,et[it]&&(et[it]._batchLocation=it)}boundArray(et,rt,nt,it){const{elements:at,ids:st,count:ot}=et;let lt=0;for(let ht=0;ht<ot;ht++){const dt=at[ht],ut=dt._batchLocation;if(ut>=0&&ut<it&&rt[ut]===dt){st[ht]=ut;continue}for(;lt<it;){const ft=rt[lt];if(ft&&ft._batchEnabled===nt&&ft._batchLocation===lt){lt++;continue}st[ht]=lt,dt._batchLocation=lt,rt[lt]=dt;break}}}destroy(){this.renderer=null}}BatchSystem.extension={type:ExtensionType.RendererSystem,name:"batch"};extensions$1.add(BatchSystem);let CONTEXT_UID_COUNTER=0;class ContextSystem{constructor(et){this.renderer=et,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(et){this.gl=et,this.renderer.gl=et,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++}init(et){if(et.context)this.initFromContext(et.context);else{const rt=this.renderer.background.alpha<1,nt=et.premultipliedAlpha;this.preserveDrawingBuffer=et.preserveDrawingBuffer,this.useContextAlpha=et.useContextAlpha,this.powerPreference=et.powerPreference,this.initFromOptions({alpha:rt,premultipliedAlpha:nt,antialias:et.antialias,stencil:!0,preserveDrawingBuffer:et.preserveDrawingBuffer,powerPreference:et.powerPreference})}}initFromContext(et){this.gl=et,this.validateContext(et),this.renderer.gl=et,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(et);const rt=this.renderer.view;rt.addEventListener!==void 0&&(rt.addEventListener("webglcontextlost",this.handleContextLost,!1),rt.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(et){const rt=this.createContext(this.renderer.view,et);this.initFromContext(rt)}createContext(et,rt){let nt;if(settings.PREFER_ENV>=ENV.WEBGL2&&(nt=et.getContext("webgl2",rt)),nt)this.webGLVersion=2;else if(this.webGLVersion=1,nt=et.getContext("webgl",rt)||et.getContext("experimental-webgl",rt),!nt)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=nt,this.getExtensions(),this.gl}getExtensions(){const{gl:et}=this,rt={loseContext:et.getExtension("WEBGL_lose_context"),anisotropicFiltering:et.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:et.getExtension("OES_texture_float_linear"),s3tc:et.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:et.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:et.getExtension("WEBGL_compressed_texture_etc"),etc1:et.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:et.getExtension("WEBGL_compressed_texture_pvrtc")||et.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:et.getExtension("WEBGL_compressed_texture_atc"),astc:et.getExtension("WEBGL_compressed_texture_astc"),bptc:et.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,rt,{drawBuffers:et.getExtension("WEBGL_draw_buffers"),depthTexture:et.getExtension("WEBGL_depth_texture"),vertexArrayObject:et.getExtension("OES_vertex_array_object")||et.getExtension("MOZ_OES_vertex_array_object")||et.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:et.getExtension("OES_element_index_uint"),floatTexture:et.getExtension("OES_texture_float"),floatTextureLinear:et.getExtension("OES_texture_float_linear"),textureHalfFloat:et.getExtension("OES_texture_half_float"),textureHalfFloatLinear:et.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,rt,{colorBufferFloat:et.getExtension("EXT_color_buffer_float")})}handleContextLost(et){et.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const et=this.renderer.view;this.renderer=null,et.removeEventListener!==void 0&&(et.removeEventListener("webglcontextlost",this.handleContextLost),et.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(et){const rt=et.getContextAttributes(),nt="WebGL2RenderingContext"in globalThis&&et instanceof globalThis.WebGL2RenderingContext;nt&&(this.webGLVersion=2),rt&&!rt.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const it=nt||!!et.getExtension("OES_element_index_uint");this.supports.uint32Indices=it,it||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ContextSystem.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},ContextSystem.extension={type:ExtensionType.RendererSystem,name:"context"};extensions$1.add(ContextSystem);class Framebuffer{constructor(et,rt){if(this.width=Math.round(et),this.height=Math.round(rt),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=MSAA_QUALITY.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(et=0,rt){return this.colorTextures[et]=rt||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,mipmap:MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(et){return this.depthTexture=et||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES.OFF,format:FORMATS.DEPTH_COMPONENT,type:TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(et,rt){if(et=Math.round(et),rt=Math.round(rt),!et||!rt)throw new Error("Framebuffer width and height must not be zero");if(!(et===this.width&&rt===this.height)){this.width=et,this.height=rt,this.dirtyId++,this.dirtySize++;for(let nt=0;nt<this.colorTextures.length;nt++){const it=this.colorTextures[nt],at=it.resolution;it.setSize(et/at,rt/at)}if(this.depthTexture){const nt=this.depthTexture.resolution;this.depthTexture.setSize(et/nt,rt/nt)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class BaseRenderTexture extends BaseTexture{constructor(et={}){if(typeof et=="number"){const rt=arguments[0],nt=arguments[1],it=arguments[2],at=arguments[3];et={width:rt,height:nt,scaleMode:it,resolution:at}}et.width=et.width??100,et.height=et.height??100,et.multisample??(et.multisample=MSAA_QUALITY.NONE),super(null,et),this.mipmap=MIPMAP_MODES.OFF,this.valid=!0,this._clear=new Color([0,0,0,0]),this.framebuffer=new Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=et.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(et){this._clear.setValue(et)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(et){this.framebuffer.multisample=et}resize(et,rt){this.framebuffer.resize(et*this.resolution,rt*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class BaseImageResource extends Resource{constructor(et){const rt=et,nt=rt.naturalWidth||rt.videoWidth||rt.displayWidth||rt.width,it=rt.naturalHeight||rt.videoHeight||rt.displayHeight||rt.height;super(nt,it),this.source=et,this.noSubImage=!1}static crossOrigin(et,rt,nt){nt===void 0&&!rt.startsWith("data:")?et.crossOrigin=determineCrossOrigin(rt):nt!==!1&&(et.crossOrigin=typeof nt=="string"?nt:"anonymous")}upload(et,rt,nt,it){const at=et.gl,st=rt.realWidth,ot=rt.realHeight;if(it=it||this.source,typeof HTMLImageElement<"u"&&it instanceof HTMLImageElement){if(!it.complete||it.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&it instanceof HTMLVideoElement&&it.readyState<=1)return!1;return at.pixelStorei(at.UNPACK_PREMULTIPLY_ALPHA_WEBGL,rt.alphaMode===ALPHA_MODES.UNPACK),!this.noSubImage&&rt.target===at.TEXTURE_2D&&nt.width===st&&nt.height===ot?at.texSubImage2D(at.TEXTURE_2D,0,0,0,rt.format,nt.type,it):(nt.width=st,nt.height=ot,at.texImage2D(rt.target,0,nt.internalFormat,rt.format,nt.type,it)),!0}update(){if(this.destroyed)return;const et=this.source,rt=et.naturalWidth||et.videoWidth||et.width,nt=et.naturalHeight||et.videoHeight||et.height;this.resize(rt,nt),super.update()}dispose(){this.source=null}}class ImageResource extends BaseImageResource{constructor(et,rt){if(rt=rt||{},typeof et=="string"){const nt=new Image;BaseImageResource.crossOrigin(nt,et,rt.crossorigin),nt.src=et,et=nt}super(et),!et.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=et.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(rt.createBitmap??settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof rt.alphaMode=="number"?rt.alphaMode:null,this.bitmap=null,this._load=null,rt.autoLoad!==!1&&this.load()}load(et){return this._load?this._load:(et!==void 0&&(this.createBitmap=et),this._load=new Promise((rt,nt)=>{const it=this.source;this.url=it.src;const at=()=>{this.destroyed||(it.onload=null,it.onerror=null,this.update(),this._load=null,this.createBitmap?rt(this.process()):rt(this))};it.complete&&it.src?at():(it.onload=at,it.onerror=st=>{nt(st),this.onError.emit(st)})}),this._load)}process(){const et=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const rt=globalThis.createImageBitmap,nt=!et.crossOrigin||et.crossOrigin==="anonymous";return this._process=fetch(et.src,{mode:nt?"cors":"no-cors"}).then(it=>it.blob()).then(it=>rt(it,0,0,et.width,et.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"})).then(it=>this.destroyed?Promise.reject():(this.bitmap=it,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(et,rt,nt){if(typeof this.alphaMode=="number"&&(rt.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(et,rt,nt);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(et,rt,nt,this.bitmap),!this.preserveBitmap){let it=!0;const at=rt._glTextures;for(const st in at){const ot=at[st];if(ot!==nt&&ot.dirtyId!==rt.dirtyId){it=!1;break}}it&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(et){return typeof HTMLImageElement<"u"&&(typeof et=="string"||et instanceof HTMLImageElement)}}class TextureUvs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(et,rt,nt){const it=rt.width,at=rt.height;if(nt){const st=et.width/2/it,ot=et.height/2/at,lt=et.x/it+st,ht=et.y/at+ot;nt=groupD8.add(nt,groupD8.NW),this.x0=lt+st*groupD8.uX(nt),this.y0=ht+ot*groupD8.uY(nt),nt=groupD8.add(nt,2),this.x1=lt+st*groupD8.uX(nt),this.y1=ht+ot*groupD8.uY(nt),nt=groupD8.add(nt,2),this.x2=lt+st*groupD8.uX(nt),this.y2=ht+ot*groupD8.uY(nt),nt=groupD8.add(nt,2),this.x3=lt+st*groupD8.uX(nt),this.y3=ht+ot*groupD8.uY(nt)}else this.x0=et.x/it,this.y0=et.y/at,this.x1=(et.x+et.width)/it,this.y1=et.y/at,this.x2=(et.x+et.width)/it,this.y2=(et.y+et.height)/at,this.x3=et.x/it,this.y3=(et.y+et.height)/at;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}TextureUvs.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const DEFAULT_UVS=new TextureUvs;function removeAllHandlers(tt){tt.destroy=function(){},tt.on=function(){},tt.once=function(){},tt.emit=function(){}}class Texture extends EventEmitter{constructor(et,rt,nt,it,at,st,ot){if(super(),this.noFrame=!1,rt||(this.noFrame=!0,rt=new Rectangle(0,0,1,1)),et instanceof Texture&&(et=et.baseTexture),this.baseTexture=et,this._frame=rt,this.trim=it,this.valid=!1,this.destroyed=!1,this._uvs=DEFAULT_UVS,this.uvMatrix=null,this.orig=nt||rt,this._rotate=Number(at||0),at===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=st?new Point$2(st.x,st.y):new Point$2(0,0),this.defaultBorders=ot,this._updateID=0,this.textureCacheIds=[],et.valid?this.noFrame?et.valid&&this.onBaseTextureUpdated(et):this.frame=rt:et.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&et.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(et){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=et.width,this._frame.height=et.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(et){if(this.baseTexture){if(et){const{resource:rt}=this.baseTexture;rt?.url&&TextureCache[rt.url]&&Texture.removeFromCache(rt.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const et=this._frame.clone(),rt=this._frame===this.orig?et:this.orig.clone(),nt=new Texture(this.baseTexture,!this.noFrame&&et,rt,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(nt._frame=et),nt}updateUvs(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(et,rt={},nt=settings.STRICT_TEXTURE_CACHE){const it=typeof et=="string";let at=null;if(it)at=et;else if(et instanceof BaseTexture){if(!et.cacheId){const ot=rt?.pixiIdPrefix||"pixiid";et.cacheId=`${ot}-${uid()}`,BaseTexture.addToCache(et,et.cacheId)}at=et.cacheId}else{if(!et._pixiId){const ot=rt?.pixiIdPrefix||"pixiid";et._pixiId=`${ot}_${uid()}`}at=et._pixiId}let st=TextureCache[at];if(it&&nt&&!st)throw new Error(`The cacheId "${at}" does not exist in TextureCache.`);return!st&&!(et instanceof BaseTexture)?(rt.resolution||(rt.resolution=getResolutionOfUrl(et)),st=new Texture(new BaseTexture(et,rt)),st.baseTexture.cacheId=at,BaseTexture.addToCache(st.baseTexture,at),Texture.addToCache(st,at)):!st&&et instanceof BaseTexture&&(st=new Texture(et),Texture.addToCache(st,at)),st}static fromURL(et,rt){const nt=Object.assign({autoLoad:!1},rt?.resourceOptions),it=Texture.from(et,Object.assign({resourceOptions:nt},rt),!1),at=it.baseTexture.resource;return it.baseTexture.valid?Promise.resolve(it):at.load().then(()=>Promise.resolve(it))}static fromBuffer(et,rt,nt,it){return new Texture(BaseTexture.fromBuffer(et,rt,nt,it))}static fromLoader(et,rt,nt,it){const at=new BaseTexture(et,Object.assign({scaleMode:BaseTexture.defaultOptions.scaleMode,resolution:getResolutionOfUrl(rt)},it)),{resource:st}=at;st instanceof ImageResource&&(st.url=rt);const ot=new Texture(at);return nt||(nt=rt),BaseTexture.addToCache(ot.baseTexture,nt),Texture.addToCache(ot,nt),nt!==rt&&(BaseTexture.addToCache(ot.baseTexture,rt),Texture.addToCache(ot,rt)),ot.baseTexture.valid?Promise.resolve(ot):new Promise(lt=>{ot.baseTexture.once("loaded",()=>lt(ot))})}static addToCache(et,rt){rt&&(et.textureCacheIds.includes(rt)||et.textureCacheIds.push(rt),TextureCache[rt]&&TextureCache[rt]!==et&&console.warn(`Texture added to the cache with an id [${rt}] that already had an entry`),TextureCache[rt]=et)}static removeFromCache(et){if(typeof et=="string"){const rt=TextureCache[et];if(rt){const nt=rt.textureCacheIds.indexOf(et);return nt>-1&&rt.textureCacheIds.splice(nt,1),delete TextureCache[et],rt}}else if(et?.textureCacheIds){for(let rt=0;rt<et.textureCacheIds.length;++rt)TextureCache[et.textureCacheIds[rt]]===et&&delete TextureCache[et.textureCacheIds[rt]];return et.textureCacheIds.length=0,et}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(et){this._frame=et,this.noFrame=!1;const{x:rt,y:nt,width:it,height:at}=et,st=rt+it>this.baseTexture.width,ot=nt+at>this.baseTexture.height;if(st||ot){const lt=st&&ot?"and":"or",ht=`X: ${rt} + ${it} = ${rt+it} > ${this.baseTexture.width}`,dt=`Y: ${nt} + ${at} = ${nt+at} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${ht} ${lt} ${dt}`)}this.valid=it&&at&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=et),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(et){this._rotate=et,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Texture._EMPTY||(Texture._EMPTY=new Texture(new BaseTexture),removeAllHandlers(Texture._EMPTY),removeAllHandlers(Texture._EMPTY.baseTexture)),Texture._EMPTY}static get WHITE(){if(!Texture._WHITE){const et=settings.ADAPTER.createCanvas(16,16),rt=et.getContext("2d");et.width=16,et.height=16,rt.fillStyle="white",rt.fillRect(0,0,16,16),Texture._WHITE=new Texture(BaseTexture.from(et)),removeAllHandlers(Texture._WHITE),removeAllHandlers(Texture._WHITE.baseTexture)}return Texture._WHITE}}class RenderTexture extends Texture{constructor(et,rt){super(et,rt),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(et){this.framebuffer.multisample=et}resize(et,rt,nt=!0){const it=this.baseTexture.resolution,at=Math.round(et*it)/it,st=Math.round(rt*it)/it;this.valid=at>0&&st>0,this._frame.width=this.orig.width=at,this._frame.height=this.orig.height=st,nt&&this.baseTexture.resize(at,st),this.updateUvs()}setResolution(et){const{baseTexture:rt}=this;rt.resolution!==et&&(rt.setResolution(et),this.resize(rt.width,rt.height,!1))}static create(et){return new RenderTexture(new BaseRenderTexture(et))}}class RenderTexturePool{constructor(et){this.texturePool={},this.textureOptions=et||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(et,rt,nt=MSAA_QUALITY.NONE){const it=new BaseRenderTexture(Object.assign({width:et,height:rt,resolution:1,multisample:nt},this.textureOptions));return new RenderTexture(it)}getOptimalTexture(et,rt,nt=1,it=MSAA_QUALITY.NONE){let at;et=Math.max(Math.ceil(et*nt-1e-6),1),rt=Math.max(Math.ceil(rt*nt-1e-6),1),!this.enableFullScreen||et!==this._pixelsWidth||rt!==this._pixelsHeight?(et=nextPow2(et),rt=nextPow2(rt),at=((et&65535)<<16|rt&65535)>>>0,it>1&&(at+=it*4294967296)):at=it>1?-it:-1,this.texturePool[at]||(this.texturePool[at]=[]);let st=this.texturePool[at].pop();return st||(st=this.createTexture(et,rt,it)),st.filterPoolKey=at,st.setResolution(nt),st}getFilterTexture(et,rt,nt){const it=this.getOptimalTexture(et.width,et.height,rt||et.resolution,nt||MSAA_QUALITY.NONE);return it.filterFrame=et.filterFrame,it}returnTexture(et){const rt=et.filterPoolKey;et.filterFrame=null,this.texturePool[rt].push(et)}returnFilterTexture(et){this.returnTexture(et)}clear(et){if(et=et!==!1,et)for(const rt in this.texturePool){const nt=this.texturePool[rt];if(nt)for(let it=0;it<nt.length;it++)nt[it].destroy(!0)}this.texturePool={}}setScreenSize(et){if(!(et.width===this._pixelsWidth&&et.height===this._pixelsHeight)){this.enableFullScreen=et.width>0&&et.height>0;for(const rt in this.texturePool){if(!(Number(rt)<0))continue;const nt=this.texturePool[rt];if(nt)for(let it=0;it<nt.length;it++)nt[it].destroy(!0);this.texturePool[rt]=[]}this._pixelsWidth=et.width,this._pixelsHeight=et.height}}}RenderTexturePool.SCREEN_KEY=-1;class Quad extends Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class QuadUv extends Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Buffer$2(this.vertices),this.uvBuffer=new Buffer$2(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(et,rt){let nt=0,it=0;return this.uvs[0]=nt,this.uvs[1]=it,this.uvs[2]=nt+rt.width/et.width,this.uvs[3]=it,this.uvs[4]=nt+rt.width/et.width,this.uvs[5]=it+rt.height/et.height,this.uvs[6]=nt,this.uvs[7]=it+rt.height/et.height,nt=rt.x,it=rt.y,this.vertices[0]=nt,this.vertices[1]=it,this.vertices[2]=nt+rt.width,this.vertices[3]=it,this.vertices[4]=nt+rt.width,this.vertices[5]=it+rt.height,this.vertices[6]=nt,this.vertices[7]=it+rt.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class FilterState{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=MSAA_QUALITY.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const tempPoints=[new Point$2,new Point$2,new Point$2,new Point$2],tempMatrix$2=new Matrix;class FilterSystem{constructor(et){this.renderer=et,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(et,rt){const nt=this.renderer,it=this.defaultFilterStack,at=this.statePool.pop()||new FilterState,st=nt.renderTexture;let ot,lt;if(st.current){const xt=st.current;ot=xt.resolution,lt=xt.multisample}else ot=nt.resolution,lt=nt.multisample;let ht=rt[0].resolution||ot,dt=rt[0].multisample??lt,ut=rt[0].padding,ft=rt[0].autoFit,mt=rt[0].legacy??!0;for(let xt=1;xt<rt.length;xt++){const wt=rt[xt];ht=Math.min(ht,wt.resolution||ot),dt=Math.min(dt,wt.multisample??lt),ut=this.useMaxPadding?Math.max(ut,wt.padding):ut+wt.padding,ft=ft&&wt.autoFit,mt=mt||(wt.legacy??!0)}it.length===1&&(this.defaultFilterStack[0].renderTexture=st.current),it.push(at),at.resolution=ht,at.multisample=dt,at.legacy=mt,at.target=et,at.sourceFrame.copyFrom(et.filterArea||et.getBounds(!0)),at.sourceFrame.pad(ut);const gt=this.tempRect.copyFrom(st.sourceFrame);nt.projection.transform&&this.transformAABB(tempMatrix$2.copyFrom(nt.projection.transform).invert(),gt),ft?(at.sourceFrame.fit(gt),(at.sourceFrame.width<=0||at.sourceFrame.height<=0)&&(at.sourceFrame.width=0,at.sourceFrame.height=0)):at.sourceFrame.intersects(gt)||(at.sourceFrame.width=0,at.sourceFrame.height=0),this.roundFrame(at.sourceFrame,st.current?st.current.resolution:nt.resolution,st.sourceFrame,st.destinationFrame,nt.projection.transform),at.renderTexture=this.getOptimalFilterTexture(at.sourceFrame.width,at.sourceFrame.height,ht,dt),at.filters=rt,at.destinationFrame.width=at.renderTexture.width,at.destinationFrame.height=at.renderTexture.height;const vt=this.tempRect;vt.x=0,vt.y=0,vt.width=at.sourceFrame.width,vt.height=at.sourceFrame.height,at.renderTexture.filterFrame=at.sourceFrame,at.bindingSourceFrame.copyFrom(st.sourceFrame),at.bindingDestinationFrame.copyFrom(st.destinationFrame),at.transform=nt.projection.transform,nt.projection.transform=null,st.bind(at.renderTexture,at.sourceFrame,vt),nt.framebuffer.clear(0,0,0,0)}pop(){const et=this.defaultFilterStack,rt=et.pop(),nt=rt.filters;this.activeState=rt;const it=this.globalUniforms.uniforms;it.outputFrame=rt.sourceFrame,it.resolution=rt.resolution;const at=it.inputSize,st=it.inputPixel,ot=it.inputClamp;if(at[0]=rt.destinationFrame.width,at[1]=rt.destinationFrame.height,at[2]=1/at[0],at[3]=1/at[1],st[0]=Math.round(at[0]*rt.resolution),st[1]=Math.round(at[1]*rt.resolution),st[2]=1/st[0],st[3]=1/st[1],ot[0]=.5*st[2],ot[1]=.5*st[3],ot[2]=rt.sourceFrame.width*at[2]-.5*st[2],ot[3]=rt.sourceFrame.height*at[3]-.5*st[3],rt.legacy){const ht=it.filterArea;ht[0]=rt.destinationFrame.width,ht[1]=rt.destinationFrame.height,ht[2]=rt.sourceFrame.x,ht[3]=rt.sourceFrame.y,it.filterClamp=it.inputClamp}this.globalUniforms.update();const lt=et[et.length-1];if(this.renderer.framebuffer.blit(),nt.length===1)nt[0].apply(this,rt.renderTexture,lt.renderTexture,CLEAR_MODES.BLEND,rt),this.returnFilterTexture(rt.renderTexture);else{let ht=rt.renderTexture,dt=this.getOptimalFilterTexture(ht.width,ht.height,rt.resolution);dt.filterFrame=ht.filterFrame;let ut=0;for(ut=0;ut<nt.length-1;++ut){ut===1&&rt.multisample>1&&(dt=this.getOptimalFilterTexture(ht.width,ht.height,rt.resolution),dt.filterFrame=ht.filterFrame),nt[ut].apply(this,ht,dt,CLEAR_MODES.CLEAR,rt);const ft=ht;ht=dt,dt=ft}nt[ut].apply(this,ht,lt.renderTexture,CLEAR_MODES.BLEND,rt),ut>1&&rt.multisample>1&&this.returnFilterTexture(rt.renderTexture),this.returnFilterTexture(ht),this.returnFilterTexture(dt)}rt.clear(),this.statePool.push(rt)}bindAndClear(et,rt=CLEAR_MODES.CLEAR){const{renderTexture:nt,state:it}=this.renderer;if(et===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,et?.filterFrame){const st=this.tempRect;st.x=0,st.y=0,st.width=et.filterFrame.width,st.height=et.filterFrame.height,nt.bind(et,et.filterFrame,st)}else et!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?nt.bind(et):this.renderer.renderTexture.bind(et,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const at=it.stateId&1||this.forceClear;(rt===CLEAR_MODES.CLEAR||rt===CLEAR_MODES.BLIT&&at)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(et,rt,nt,it){const at=this.renderer;at.state.set(et.state),this.bindAndClear(nt,it),et.uniforms.uSampler=rt,et.uniforms.filterGlobals=this.globalUniforms,at.shader.bind(et),et.legacy=!!et.program.attributeData.aTextureCoord,et.legacy?(this.quadUv.map(rt._frame,rt.filterFrame),at.geometry.bind(this.quadUv),at.geometry.draw(DRAW_MODES.TRIANGLES)):(at.geometry.bind(this.quad),at.geometry.draw(DRAW_MODES.TRIANGLE_STRIP))}calculateSpriteMatrix(et,rt){const{sourceFrame:nt,destinationFrame:it}=this.activeState,{orig:at}=rt._texture,st=et.set(it.width,0,0,it.height,nt.x,nt.y),ot=rt.worldTransform.copyTo(Matrix.TEMP_MATRIX);return ot.invert(),st.prepend(ot),st.scale(1/at.width,1/at.height),st.translate(rt.anchor.x,rt.anchor.y),st}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(et,rt,nt=1,it=MSAA_QUALITY.NONE){return this.texturePool.getOptimalTexture(et,rt,nt,it)}getFilterTexture(et,rt,nt){if(typeof et=="number"){const at=et;et=rt,rt=at}et=et||this.activeState.renderTexture;const it=this.texturePool.getOptimalTexture(et.width,et.height,rt||et.resolution,nt||MSAA_QUALITY.NONE);return it.filterFrame=et.filterFrame,it}returnFilterTexture(et){this.texturePool.returnTexture(et)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(et,rt){const nt=tempPoints[0],it=tempPoints[1],at=tempPoints[2],st=tempPoints[3];nt.set(rt.left,rt.top),it.set(rt.left,rt.bottom),at.set(rt.right,rt.top),st.set(rt.right,rt.bottom),et.apply(nt,nt),et.apply(it,it),et.apply(at,at),et.apply(st,st);const ot=Math.min(nt.x,it.x,at.x,st.x),lt=Math.min(nt.y,it.y,at.y,st.y),ht=Math.max(nt.x,it.x,at.x,st.x),dt=Math.max(nt.y,it.y,at.y,st.y);rt.x=ot,rt.y=lt,rt.width=ht-ot,rt.height=dt-lt}roundFrame(et,rt,nt,it,at){if(!(et.width<=0||et.height<=0||nt.width<=0||nt.height<=0)){if(at){const{a:st,b:ot,c:lt,d:ht}=at;if((Math.abs(ot)>1e-4||Math.abs(lt)>1e-4)&&(Math.abs(st)>1e-4||Math.abs(ht)>1e-4))return}at=at?tempMatrix$2.copyFrom(at):tempMatrix$2.identity(),at.translate(-nt.x,-nt.y).scale(it.width/nt.width,it.height/nt.height).translate(it.x,it.y),this.transformAABB(at,et),et.ceil(rt),this.transformAABB(at.invert(),et)}}}FilterSystem.extension={type:ExtensionType.RendererSystem,name:"filter"};extensions$1.add(FilterSystem);class GLFramebuffer{constructor(et){this.framebuffer=et,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const tempRectangle=new Rectangle;class FramebufferSystem{constructor(et){this.renderer=et,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const et=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let rt=this.renderer.context.extensions.drawBuffers,nt=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===ENV.WEBGL_LEGACY&&(rt=null,nt=null),rt?et.drawBuffers=it=>rt.drawBuffersWEBGL(it):(this.hasMRT=!1,et.drawBuffers=()=>{}),nt||(this.writeDepthTexture=!1)}else this.msaaSamples=et.getInternalformatParameter(et.RENDERBUFFER,et.RGBA8,et.SAMPLES)}bind(et,rt,nt=0){const{gl:it}=this;if(et){const at=et.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(et);this.current!==et&&(this.current=et,it.bindFramebuffer(it.FRAMEBUFFER,at.framebuffer)),at.mipLevel!==nt&&(et.dirtyId++,et.dirtyFormat++,at.mipLevel=nt),at.dirtyId!==et.dirtyId&&(at.dirtyId=et.dirtyId,at.dirtyFormat!==et.dirtyFormat?(at.dirtyFormat=et.dirtyFormat,at.dirtySize=et.dirtySize,this.updateFramebuffer(et,nt)):at.dirtySize!==et.dirtySize&&(at.dirtySize=et.dirtySize,this.resizeFramebuffer(et)));for(let st=0;st<et.colorTextures.length;st++){const ot=et.colorTextures[st];this.renderer.texture.unbind(ot.parentTextureArray||ot)}if(et.depthTexture&&this.renderer.texture.unbind(et.depthTexture),rt){const st=rt.width>>nt,ot=rt.height>>nt,lt=st/rt.width;this.setViewport(rt.x*lt,rt.y*lt,st,ot)}else{const st=et.width>>nt,ot=et.height>>nt;this.setViewport(0,0,st,ot)}}else this.current&&(this.current=null,it.bindFramebuffer(it.FRAMEBUFFER,null)),rt?this.setViewport(rt.x,rt.y,rt.width,rt.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(et,rt,nt,it){const at=this.viewport;et=Math.round(et),rt=Math.round(rt),nt=Math.round(nt),it=Math.round(it),(at.width!==nt||at.height!==it||at.x!==et||at.y!==rt)&&(at.x=et,at.y=rt,at.width=nt,at.height=it,this.gl.viewport(et,rt,nt,it))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(et,rt,nt,it,at=BUFFER_BITS.COLOR|BUFFER_BITS.DEPTH){const{gl:st}=this;st.clearColor(et,rt,nt,it),st.clear(at)}initFramebuffer(et){const{gl:rt}=this,nt=new GLFramebuffer(rt.createFramebuffer());return nt.multisample=this.detectSamples(et.multisample),et.glFramebuffers[this.CONTEXT_UID]=nt,this.managedFramebuffers.push(et),et.disposeRunner.add(this),nt}resizeFramebuffer(et){const{gl:rt}=this,nt=et.glFramebuffers[this.CONTEXT_UID];if(nt.stencil){rt.bindRenderbuffer(rt.RENDERBUFFER,nt.stencil);let st;this.renderer.context.webGLVersion===1?st=rt.DEPTH_STENCIL:et.depth&&et.stencil?st=rt.DEPTH24_STENCIL8:et.depth?st=rt.DEPTH_COMPONENT24:st=rt.STENCIL_INDEX8,nt.msaaBuffer?rt.renderbufferStorageMultisample(rt.RENDERBUFFER,nt.multisample,st,et.width,et.height):rt.renderbufferStorage(rt.RENDERBUFFER,st,et.width,et.height)}const it=et.colorTextures;let at=it.length;rt.drawBuffers||(at=Math.min(at,1));for(let st=0;st<at;st++){const ot=it[st],lt=ot.parentTextureArray||ot;this.renderer.texture.bind(lt,0),st===0&&nt.msaaBuffer&&(rt.bindRenderbuffer(rt.RENDERBUFFER,nt.msaaBuffer),rt.renderbufferStorageMultisample(rt.RENDERBUFFER,nt.multisample,lt._glTextures[this.CONTEXT_UID].internalFormat,et.width,et.height))}et.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(et.depthTexture,0)}updateFramebuffer(et,rt){const{gl:nt}=this,it=et.glFramebuffers[this.CONTEXT_UID],at=et.colorTextures;let st=at.length;nt.drawBuffers||(st=Math.min(st,1)),it.multisample>1&&this.canMultisampleFramebuffer(et)?it.msaaBuffer=it.msaaBuffer||nt.createRenderbuffer():it.msaaBuffer&&(nt.deleteRenderbuffer(it.msaaBuffer),it.msaaBuffer=null,it.blitFramebuffer&&(it.blitFramebuffer.dispose(),it.blitFramebuffer=null));const ot=[];for(let lt=0;lt<st;lt++){const ht=at[lt],dt=ht.parentTextureArray||ht;this.renderer.texture.bind(dt,0),lt===0&&it.msaaBuffer?(nt.bindRenderbuffer(nt.RENDERBUFFER,it.msaaBuffer),nt.renderbufferStorageMultisample(nt.RENDERBUFFER,it.multisample,dt._glTextures[this.CONTEXT_UID].internalFormat,et.width,et.height),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,nt.COLOR_ATTACHMENT0,nt.RENDERBUFFER,it.msaaBuffer)):(nt.framebufferTexture2D(nt.FRAMEBUFFER,nt.COLOR_ATTACHMENT0+lt,ht.target,dt._glTextures[this.CONTEXT_UID].texture,rt),ot.push(nt.COLOR_ATTACHMENT0+lt))}if(ot.length>1&&nt.drawBuffers(ot),et.depthTexture&&this.writeDepthTexture){const lt=et.depthTexture;this.renderer.texture.bind(lt,0),nt.framebufferTexture2D(nt.FRAMEBUFFER,nt.DEPTH_ATTACHMENT,nt.TEXTURE_2D,lt._glTextures[this.CONTEXT_UID].texture,rt)}if((et.stencil||et.depth)&&!(et.depthTexture&&this.writeDepthTexture)){it.stencil=it.stencil||nt.createRenderbuffer();let lt,ht;this.renderer.context.webGLVersion===1?(lt=nt.DEPTH_STENCIL_ATTACHMENT,ht=nt.DEPTH_STENCIL):et.depth&&et.stencil?(lt=nt.DEPTH_STENCIL_ATTACHMENT,ht=nt.DEPTH24_STENCIL8):et.depth?(lt=nt.DEPTH_ATTACHMENT,ht=nt.DEPTH_COMPONENT24):(lt=nt.STENCIL_ATTACHMENT,ht=nt.STENCIL_INDEX8),nt.bindRenderbuffer(nt.RENDERBUFFER,it.stencil),it.msaaBuffer?nt.renderbufferStorageMultisample(nt.RENDERBUFFER,it.multisample,ht,et.width,et.height):nt.renderbufferStorage(nt.RENDERBUFFER,ht,et.width,et.height),nt.framebufferRenderbuffer(nt.FRAMEBUFFER,lt,nt.RENDERBUFFER,it.stencil)}else it.stencil&&(nt.deleteRenderbuffer(it.stencil),it.stencil=null)}canMultisampleFramebuffer(et){return this.renderer.context.webGLVersion!==1&&et.colorTextures.length<=1&&!et.depthTexture}detectSamples(et){const{msaaSamples:rt}=this;let nt=MSAA_QUALITY.NONE;if(et<=1||rt===null)return nt;for(let it=0;it<rt.length;it++)if(rt[it]<=et){nt=rt[it];break}return nt===1&&(nt=MSAA_QUALITY.NONE),nt}blit(et,rt,nt){const{current:it,renderer:at,gl:st,CONTEXT_UID:ot}=this;if(at.context.webGLVersion!==2||!it)return;const lt=it.glFramebuffers[ot];if(!lt)return;if(!et){if(!lt.msaaBuffer)return;const dt=it.colorTextures[0];if(!dt)return;lt.blitFramebuffer||(lt.blitFramebuffer=new Framebuffer(it.width,it.height),lt.blitFramebuffer.addColorTexture(0,dt)),et=lt.blitFramebuffer,et.colorTextures[0]!==dt&&(et.colorTextures[0]=dt,et.dirtyId++,et.dirtyFormat++),(et.width!==it.width||et.height!==it.height)&&(et.width=it.width,et.height=it.height,et.dirtyId++,et.dirtySize++)}rt||(rt=tempRectangle,rt.width=it.width,rt.height=it.height),nt||(nt=rt);const ht=rt.width===nt.width&&rt.height===nt.height;this.bind(et),st.bindFramebuffer(st.READ_FRAMEBUFFER,lt.framebuffer),st.blitFramebuffer(rt.left,rt.top,rt.right,rt.bottom,nt.left,nt.top,nt.right,nt.bottom,st.COLOR_BUFFER_BIT,ht?st.NEAREST:st.LINEAR),st.bindFramebuffer(st.READ_FRAMEBUFFER,et.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(et,rt){const nt=et.glFramebuffers[this.CONTEXT_UID],it=this.gl;if(!nt)return;delete et.glFramebuffers[this.CONTEXT_UID];const at=this.managedFramebuffers.indexOf(et);at>=0&&this.managedFramebuffers.splice(at,1),et.disposeRunner.remove(this),rt||(it.deleteFramebuffer(nt.framebuffer),nt.msaaBuffer&&it.deleteRenderbuffer(nt.msaaBuffer),nt.stencil&&it.deleteRenderbuffer(nt.stencil)),nt.blitFramebuffer&&this.disposeFramebuffer(nt.blitFramebuffer,rt)}disposeAll(et){const rt=this.managedFramebuffers;this.managedFramebuffers=[];for(let nt=0;nt<rt.length;nt++)this.disposeFramebuffer(rt[nt],et)}forceStencil(){const et=this.current;if(!et)return;const rt=et.glFramebuffers[this.CONTEXT_UID];if(!rt||rt.stencil&&et.stencil)return;et.stencil=!0;const nt=et.width,it=et.height,at=this.gl,st=rt.stencil=at.createRenderbuffer();at.bindRenderbuffer(at.RENDERBUFFER,st);let ot,lt;this.renderer.context.webGLVersion===1?(ot=at.DEPTH_STENCIL_ATTACHMENT,lt=at.DEPTH_STENCIL):et.depth?(ot=at.DEPTH_STENCIL_ATTACHMENT,lt=at.DEPTH24_STENCIL8):(ot=at.STENCIL_ATTACHMENT,lt=at.STENCIL_INDEX8),rt.msaaBuffer?at.renderbufferStorageMultisample(at.RENDERBUFFER,rt.multisample,lt,nt,it):at.renderbufferStorage(at.RENDERBUFFER,lt,nt,it),at.framebufferRenderbuffer(at.FRAMEBUFFER,ot,at.RENDERBUFFER,st)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle}destroy(){this.renderer=null}}FramebufferSystem.extension={type:ExtensionType.RendererSystem,name:"framebuffer"};extensions$1.add(FramebufferSystem);const byteSizeMap={5126:4,5123:2,5121:1};class GeometrySystem{constructor(et){this.renderer=et,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const et=this.gl=this.renderer.gl,rt=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,rt.webGLVersion!==2){let nt=this.renderer.context.extensions.vertexArrayObject;settings.PREFER_ENV===ENV.WEBGL_LEGACY&&(nt=null),nt?(et.createVertexArray=()=>nt.createVertexArrayOES(),et.bindVertexArray=it=>nt.bindVertexArrayOES(it),et.deleteVertexArray=it=>nt.deleteVertexArrayOES(it)):(this.hasVao=!1,et.createVertexArray=()=>null,et.bindVertexArray=()=>null,et.deleteVertexArray=()=>null)}if(rt.webGLVersion!==2){const nt=et.getExtension("ANGLE_instanced_arrays");nt?(et.vertexAttribDivisor=(it,at)=>nt.vertexAttribDivisorANGLE(it,at),et.drawElementsInstanced=(it,at,st,ot,lt)=>nt.drawElementsInstancedANGLE(it,at,st,ot,lt),et.drawArraysInstanced=(it,at,st,ot)=>nt.drawArraysInstancedANGLE(it,at,st,ot)):this.hasInstance=!1}this.canUseUInt32ElementIndex=rt.webGLVersion===2||!!rt.extensions.uint32ElementIndex}bind(et,rt){rt=rt||this.renderer.shader.shader;const{gl:nt}=this;let it=et.glVertexArrayObjects[this.CONTEXT_UID],at=!1;it||(this.managedGeometries[et.id]=et,et.disposeRunner.add(this),et.glVertexArrayObjects[this.CONTEXT_UID]=it={},at=!0);const st=it[rt.program.id]||this.initGeometryVao(et,rt,at);this._activeGeometry=et,this._activeVao!==st&&(this._activeVao=st,this.hasVao?nt.bindVertexArray(st):this.activateVao(et,rt.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const et=this._activeGeometry,rt=this.renderer.buffer;for(let nt=0;nt<et.buffers.length;nt++){const it=et.buffers[nt];rt.update(it)}}checkCompatibility(et,rt){const nt=et.attributes,it=rt.attributeData;for(const at in it)if(!nt[at])throw new Error(`shader and geometry incompatible, geometry missing the "${at}" attribute`)}getSignature(et,rt){const nt=et.attributes,it=rt.attributeData,at=["g",et.id];for(const st in nt)it[st]&&at.push(st,it[st].location);return at.join("-")}initGeometryVao(et,rt,nt=!0){const it=this.gl,at=this.CONTEXT_UID,st=this.renderer.buffer,ot=rt.program;ot.glPrograms[at]||this.renderer.shader.generateProgram(rt),this.checkCompatibility(et,ot);const lt=this.getSignature(et,ot),ht=et.glVertexArrayObjects[this.CONTEXT_UID];let dt=ht[lt];if(dt)return ht[ot.id]=dt,dt;const ut=et.buffers,ft=et.attributes,mt={},gt={};for(const vt in ut)mt[vt]=0,gt[vt]=0;for(const vt in ft)!ft[vt].size&&ot.attributeData[vt]?ft[vt].size=ot.attributeData[vt].size:ft[vt].size||console.warn(`PIXI Geometry attribute '${vt}' size cannot be determined (likely the bound shader does not have the attribute)`),mt[ft[vt].buffer]+=ft[vt].size*byteSizeMap[ft[vt].type];for(const vt in ft){const xt=ft[vt],wt=xt.size;xt.stride===void 0&&(mt[xt.buffer]===wt*byteSizeMap[xt.type]?xt.stride=0:xt.stride=mt[xt.buffer]),xt.start===void 0&&(xt.start=gt[xt.buffer],gt[xt.buffer]+=wt*byteSizeMap[xt.type])}dt=it.createVertexArray(),it.bindVertexArray(dt);for(let vt=0;vt<ut.length;vt++){const xt=ut[vt];st.bind(xt),nt&&xt._glBuffers[at].refCount++}return this.activateVao(et,ot),ht[ot.id]=dt,ht[lt]=dt,it.bindVertexArray(null),st.unbind(BUFFER_TYPE.ARRAY_BUFFER),dt}disposeGeometry(et,rt){if(!this.managedGeometries[et.id])return;delete this.managedGeometries[et.id];const nt=et.glVertexArrayObjects[this.CONTEXT_UID],it=this.gl,at=et.buffers,st=this.renderer?.buffer;if(et.disposeRunner.remove(this),!!nt){if(st)for(let ot=0;ot<at.length;ot++){const lt=at[ot]._glBuffers[this.CONTEXT_UID];lt&&(lt.refCount--,lt.refCount===0&&!rt&&st.dispose(at[ot],rt))}if(!rt){for(const ot in nt)if(ot[0]==="g"){const lt=nt[ot];this._activeVao===lt&&this.unbind(),it.deleteVertexArray(lt)}}delete et.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(et){const rt=Object.keys(this.managedGeometries);for(let nt=0;nt<rt.length;nt++)this.disposeGeometry(this.managedGeometries[rt[nt]],et)}activateVao(et,rt){const nt=this.gl,it=this.CONTEXT_UID,at=this.renderer.buffer,st=et.buffers,ot=et.attributes;et.indexBuffer&&at.bind(et.indexBuffer);let lt=null;for(const ht in ot){const dt=ot[ht],ut=st[dt.buffer],ft=ut._glBuffers[it];if(rt.attributeData[ht]){lt!==ft&&(at.bind(ut),lt=ft);const mt=rt.attributeData[ht].location;if(nt.enableVertexAttribArray(mt),nt.vertexAttribPointer(mt,dt.size,dt.type||nt.FLOAT,dt.normalized,dt.stride,dt.start),dt.instance)if(this.hasInstance)nt.vertexAttribDivisor(mt,dt.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(et,rt,nt,it){const{gl:at}=this,st=this._activeGeometry;if(st.indexBuffer){const ot=st.indexBuffer.data.BYTES_PER_ELEMENT,lt=ot===2?at.UNSIGNED_SHORT:at.UNSIGNED_INT;ot===2||ot===4&&this.canUseUInt32ElementIndex?st.instanced?at.drawElementsInstanced(et,rt||st.indexBuffer.data.length,lt,(nt||0)*ot,it||1):at.drawElements(et,rt||st.indexBuffer.data.length,lt,(nt||0)*ot):console.warn("unsupported index buffer type: uint32")}else st.instanced?at.drawArraysInstanced(et,nt,rt||st.getSize(),it||1):at.drawArrays(et,nt,rt||st.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}GeometrySystem.extension={type:ExtensionType.RendererSystem,name:"geometry"};extensions$1.add(GeometrySystem);const tempMat$1=new Matrix;class TextureMatrix{constructor(et,rt){this._texture=et,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof rt>"u"?.5:rt,this.isSimple=!1}get texture(){return this._texture}set texture(et){this._texture=et,this._textureID=-1}multiplyUvs(et,rt){rt===void 0&&(rt=et);const nt=this.mapCoord;for(let it=0;it<et.length;it+=2){const at=et[it],st=et[it+1];rt[it]=at*nt.a+st*nt.c+nt.tx,rt[it+1]=at*nt.b+st*nt.d+nt.ty}return rt}update(et){const rt=this._texture;if(!rt||!rt.valid||!et&&this._textureID===rt._updateID)return!1;this._textureID=rt._updateID,this._updateID++;const nt=rt._uvs;this.mapCoord.set(nt.x1-nt.x0,nt.y1-nt.y0,nt.x3-nt.x0,nt.y3-nt.y0,nt.x0,nt.y0);const it=rt.orig,at=rt.trim;at&&(tempMat$1.set(it.width/at.width,0,0,it.height/at.height,-at.x/at.width,-at.y/at.height),this.mapCoord.append(tempMat$1));const st=rt.baseTexture,ot=this.uClampFrame,lt=this.clampMargin/st.resolution,ht=this.clampOffset;return ot[0]=(rt._frame.x+lt+ht)/st.width,ot[1]=(rt._frame.y+lt+ht)/st.height,ot[2]=(rt._frame.x+rt._frame.width-lt+ht)/st.width,ot[3]=(rt._frame.y+rt._frame.height-lt+ht)/st.height,this.uClampOffset[0]=ht/st.realWidth,this.uClampOffset[1]=ht/st.realHeight,this.isSimple=rt._frame.width===st.width&&rt._frame.height===st.height&&rt.rotate===0,!0}}var fragment$7=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,vertex$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class SpriteMaskFilter extends Filter{constructor(et,rt,nt){let it=null;typeof et!="string"&&rt===void 0&&nt===void 0&&(it=et,et=void 0,rt=void 0,nt=void 0),super(et||vertex$4,rt||fragment$7,nt),this.maskSprite=it,this.maskMatrix=new Matrix}get maskSprite(){return this._maskSprite}set maskSprite(et){this._maskSprite=et,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(et,rt,nt,it){const at=this._maskSprite,st=at._texture;st.valid&&(st.uvMatrix||(st.uvMatrix=new TextureMatrix(st,0)),st.uvMatrix.update(),this.uniforms.npmAlpha=st.baseTexture.alphaMode?0:1,this.uniforms.mask=st,this.uniforms.otherMatrix=et.calculateSpriteMatrix(this.maskMatrix,at).prepend(st.uvMatrix.mapCoord),this.uniforms.alpha=at.worldAlpha,this.uniforms.maskClamp=st.uvMatrix.uClampFrame,et.applyFilter(this,rt,nt,it))}}class MaskData{constructor(et=null){this.type=MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=et||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Filter.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(et){et?this._filters?this._filters[0]=et:this._filters=[et]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(et){et?(this._stencilCounter=et._stencilCounter,this._scissorCounter=et._scissorCounter,this._scissorRect=et._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class MaskSystem{constructor(et){this.renderer=et,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(et){this.maskStack=et,this.renderer.scissor.setMaskStack(et),this.renderer.stencil.setMaskStack(et)}push(et,rt){let nt=rt;if(!nt.isMaskData){const at=this.maskDataPool.pop()||new MaskData;at.pooled=!0,at.maskObject=rt,nt=at}const it=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(nt.copyCountersOrReset(it),nt._colorMask=it?it._colorMask:15,nt.autoDetect&&this.detect(nt),nt._target=et,nt.type!==MASK_TYPES.SPRITE&&this.maskStack.push(nt),nt.enabled)switch(nt.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.push(nt);break;case MASK_TYPES.STENCIL:this.renderer.stencil.push(nt);break;case MASK_TYPES.SPRITE:nt.copyCountersOrReset(null),this.pushSpriteMask(nt);break;case MASK_TYPES.COLOR:this.pushColorMask(nt);break}nt.type===MASK_TYPES.SPRITE&&this.maskStack.push(nt)}pop(et){const rt=this.maskStack.pop();if(!(!rt||rt._target!==et)){if(rt.enabled)switch(rt.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.pop(rt);break;case MASK_TYPES.STENCIL:this.renderer.stencil.pop(rt.maskObject);break;case MASK_TYPES.SPRITE:this.popSpriteMask(rt);break;case MASK_TYPES.COLOR:this.popColorMask(rt);break}if(rt.reset(),rt.pooled&&this.maskDataPool.push(rt),this.maskStack.length!==0){const nt=this.maskStack[this.maskStack.length-1];nt.type===MASK_TYPES.SPRITE&&nt._filters&&(nt._filters[0].maskSprite=nt.maskObject)}}}detect(et){const rt=et.maskObject;rt?rt.isSprite?et.type=MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(et)?et.type=MASK_TYPES.SCISSOR:et.type=MASK_TYPES.STENCIL:et.type=MASK_TYPES.COLOR}pushSpriteMask(et){const{maskObject:rt}=et,nt=et._target;let it=et._filters;it||(it=this.alphaMaskPool[this.alphaMaskIndex],it||(it=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter])),it[0].resolution=et.resolution,it[0].multisample=et.multisample,it[0].maskSprite=rt;const at=nt.filterArea;nt.filterArea=rt.getBounds(!0),this.renderer.filter.push(nt,it),nt.filterArea=at,et._filters||this.alphaMaskIndex++}popSpriteMask(et){this.renderer.filter.pop(),et._filters?et._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(et){const rt=et._colorMask,nt=et._colorMask=rt&et.colorMask;nt!==rt&&this.renderer.gl.colorMask((nt&1)!==0,(nt&2)!==0,(nt&4)!==0,(nt&8)!==0)}popColorMask(et){const rt=et._colorMask,nt=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;nt!==rt&&this.renderer.gl.colorMask((nt&1)!==0,(nt&2)!==0,(nt&4)!==0,(nt&8)!==0)}destroy(){this.renderer=null}}MaskSystem.extension={type:ExtensionType.RendererSystem,name:"mask"};extensions$1.add(MaskSystem);class AbstractMaskSystem{constructor(et){this.renderer=et,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(et){const{gl:rt}=this.renderer,nt=this.getStackLength();this.maskStack=et;const it=this.getStackLength();it!==nt&&(it===0?rt.disable(this.glConst):(rt.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const tempMatrix$1=new Matrix,rectPool=[],_ScissorSystem=class Sd extends AbstractMaskSystem{constructor(et){super(et),this.glConst=settings.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const et=this.maskStack[this.maskStack.length-1];return et?et._scissorCounter:0}calcScissorRect(et){if(et._scissorRectLocal)return;const rt=et._scissorRect,{maskObject:nt}=et,{renderer:it}=this,at=it.renderTexture,st=nt.getBounds(!0,rectPool.pop()??new Rectangle);this.roundFrameToPixels(st,at.current?at.current.resolution:it.resolution,at.sourceFrame,at.destinationFrame,it.projection.transform),rt&&st.fit(rt),et._scissorRectLocal=st}static isMatrixRotated(et){if(!et)return!1;const{a:rt,b:nt,c:it,d:at}=et;return(Math.abs(nt)>1e-4||Math.abs(it)>1e-4)&&(Math.abs(rt)>1e-4||Math.abs(at)>1e-4)}testScissor(et){const{maskObject:rt}=et;if(!rt.isFastRect||!rt.isFastRect()||Sd.isMatrixRotated(rt.worldTransform)||Sd.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(et);const nt=et._scissorRectLocal;return nt.width>0&&nt.height>0}roundFrameToPixels(et,rt,nt,it,at){Sd.isMatrixRotated(at)||(at=at?tempMatrix$1.copyFrom(at):tempMatrix$1.identity(),at.translate(-nt.x,-nt.y).scale(it.width/nt.width,it.height/nt.height).translate(it.x,it.y),this.renderer.filter.transformAABB(at,et),et.fit(it),et.x=Math.round(et.x*rt),et.y=Math.round(et.y*rt),et.width=Math.round(et.width*rt),et.height=Math.round(et.height*rt))}push(et){et._scissorRectLocal||this.calcScissorRect(et);const{gl:rt}=this.renderer;et._scissorRect||rt.enable(rt.SCISSOR_TEST),et._scissorCounter++,et._scissorRect=et._scissorRectLocal,this._useCurrent()}pop(et){const{gl:rt}=this.renderer;et&&rectPool.push(et._scissorRectLocal),this.getStackLength()>0?this._useCurrent():rt.disable(rt.SCISSOR_TEST)}_useCurrent(){const et=this.maskStack[this.maskStack.length-1]._scissorRect;let rt;this.renderer.renderTexture.current?rt=et.y:rt=this.renderer.height-et.height-et.y,this.renderer.gl.scissor(et.x,rt,et.width,et.height)}};_ScissorSystem.extension={type:ExtensionType.RendererSystem,name:"scissor"};let ScissorSystem=_ScissorSystem;extensions$1.add(ScissorSystem);class StencilSystem extends AbstractMaskSystem{constructor(et){super(et),this.glConst=settings.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const et=this.maskStack[this.maskStack.length-1];return et?et._stencilCounter:0}push(et){const rt=et.maskObject,{gl:nt}=this.renderer,it=et._stencilCounter;it===0&&(this.renderer.framebuffer.forceStencil(),nt.clearStencil(0),nt.clear(nt.STENCIL_BUFFER_BIT),nt.enable(nt.STENCIL_TEST)),et._stencilCounter++;const at=et._colorMask;at!==0&&(et._colorMask=0,nt.colorMask(!1,!1,!1,!1)),nt.stencilFunc(nt.EQUAL,it,4294967295),nt.stencilOp(nt.KEEP,nt.KEEP,nt.INCR),rt.renderable=!0,rt.render(this.renderer),this.renderer.batch.flush(),rt.renderable=!1,at!==0&&(et._colorMask=at,nt.colorMask((at&1)!==0,(at&2)!==0,(at&4)!==0,(at&8)!==0)),this._useCurrent()}pop(et){const rt=this.renderer.gl;if(this.getStackLength()===0)rt.disable(rt.STENCIL_TEST);else{const nt=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,it=nt?nt._colorMask:15;it!==0&&(nt._colorMask=0,rt.colorMask(!1,!1,!1,!1)),rt.stencilOp(rt.KEEP,rt.KEEP,rt.DECR),et.renderable=!0,et.render(this.renderer),this.renderer.batch.flush(),et.renderable=!1,it!==0&&(nt._colorMask=it,rt.colorMask((it&1)!==0,(it&2)!==0,(it&4)!==0,(it&8)!==0)),this._useCurrent()}}_useCurrent(){const et=this.renderer.gl;et.stencilFunc(et.EQUAL,this.getStackLength(),4294967295),et.stencilOp(et.KEEP,et.KEEP,et.KEEP)}}StencilSystem.extension={type:ExtensionType.RendererSystem,name:"stencil"};extensions$1.add(StencilSystem);class PluginSystem{constructor(et){this.renderer=et,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),et.extract}},prepare:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),et.prepare}},interaction:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),et.events}}})}init(){const et=this.rendererPlugins;for(const rt in et)this.plugins[rt]=new et[rt](this.renderer)}destroy(){for(const et in this.plugins)this.plugins[et].destroy(),this.plugins[et]=null}}PluginSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_plugin"};extensions$1.add(PluginSystem);class ProjectionSystem{constructor(et){this.renderer=et,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}update(et,rt,nt,it){this.destinationFrame=et||this.destinationFrame||this.defaultFrame,this.sourceFrame=rt||this.sourceFrame||et,this.calculateProjection(this.destinationFrame,this.sourceFrame,nt,it),this.transform&&this.projectionMatrix.append(this.transform);const at=this.renderer;at.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,at.globalUniforms.update(),at.shader.shader&&at.shader.syncUniformGroup(at.shader.shader.uniforms.globals)}calculateProjection(et,rt,nt,it){const at=this.projectionMatrix,st=it?-1:1;at.identity(),at.a=1/rt.width*2,at.d=st*(1/rt.height*2),at.tx=-1-rt.x*at.a,at.ty=-st-rt.y*at.d}setTransform(et){}destroy(){this.renderer=null}}ProjectionSystem.extension={type:ExtensionType.RendererSystem,name:"projection"};extensions$1.add(ProjectionSystem);const tempTransform=new Transform,tempRect$1=new Rectangle;class GenerateTextureSystem{constructor(et){this.renderer=et,this._tempMatrix=new Matrix}generateTexture(et,rt){const{region:nt,...it}=rt||{},at=nt?.copyTo(tempRect$1)||et.getLocalBounds(tempRect$1,!0),st=it.resolution||this.renderer.resolution;at.width=Math.max(at.width,1/st),at.height=Math.max(at.height,1/st),it.width=at.width,it.height=at.height,it.resolution=st,it.multisample??(it.multisample=this.renderer.multisample);const ot=RenderTexture.create(it);this._tempMatrix.tx=-at.x,this._tempMatrix.ty=-at.y;const lt=et.transform;return et.transform=tempTransform,this.renderer.render(et,{renderTexture:ot,transform:this._tempMatrix,skipUpdateTransform:!!et.parent,blit:!0}),et.transform=lt,ot}destroy(){}}GenerateTextureSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"textureGenerator"};extensions$1.add(GenerateTextureSystem);const tempRect=new Rectangle,tempRect2=new Rectangle;class RenderTextureSystem{constructor(et){this.renderer=et,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}contextChange(){const et=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(et&&et.alpha&&et.premultipliedAlpha)}bind(et=null,rt,nt){const it=this.renderer;this.current=et;let at,st,ot;et?(at=et.baseTexture,ot=at.resolution,rt||(tempRect.width=et.frame.width,tempRect.height=et.frame.height,rt=tempRect),nt||(tempRect2.x=et.frame.x,tempRect2.y=et.frame.y,tempRect2.width=rt.width,tempRect2.height=rt.height,nt=tempRect2),st=at.framebuffer):(ot=it.resolution,rt||(tempRect.width=it._view.screen.width,tempRect.height=it._view.screen.height,rt=tempRect),nt||(nt=tempRect,nt.width=rt.width,nt.height=rt.height));const lt=this.viewportFrame;lt.x=nt.x*ot,lt.y=nt.y*ot,lt.width=nt.width*ot,lt.height=nt.height*ot,et||(lt.y=it.view.height-(lt.y+lt.height)),lt.ceil(),this.renderer.framebuffer.bind(st,lt),this.renderer.projection.update(nt,rt,ot,!st),et?this.renderer.mask.setMaskStack(at.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(rt),this.destinationFrame.copyFrom(nt)}clear(et,rt){const nt=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,it=Color.shared.setValue(et||nt);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&it.premultiply(it.alpha);const at=this.destinationFrame,st=this.current?this.current.baseTexture:this.renderer._view.screen,ot=at.width!==st.width||at.height!==st.height;if(ot){let{x:lt,y:ht,width:dt,height:ut}=this.viewportFrame;lt=Math.round(lt),ht=Math.round(ht),dt=Math.round(dt),ut=Math.round(ut),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(lt,ht,dt,ut)}this.renderer.framebuffer.clear(it.red,it.green,it.blue,it.alpha,rt),ot&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}RenderTextureSystem.extension={type:ExtensionType.RendererSystem,name:"renderTexture"};extensions$1.add(RenderTextureSystem);class GLProgram{constructor(et,rt){this.program=et,this.uniformData=rt,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function getAttributeData(tt,et){const rt={},nt=et.getProgramParameter(tt,et.ACTIVE_ATTRIBUTES);for(let it=0;it<nt;it++){const at=et.getActiveAttrib(tt,it);if(at.name.startsWith("gl_"))continue;const st=mapType$1(et,at.type),ot={type:st,name:at.name,size:mapSize(st),location:et.getAttribLocation(tt,at.name)};rt[at.name]=ot}return rt}function getUniformData(tt,et){const rt={},nt=et.getProgramParameter(tt,et.ACTIVE_UNIFORMS);for(let it=0;it<nt;it++){const at=et.getActiveUniform(tt,it),st=at.name.replace(/\[.*?\]$/,""),ot=!!at.name.match(/\[.*?\]$/),lt=mapType$1(et,at.type);rt[st]={name:st,index:it,type:lt,size:at.size,isArray:ot,value:defaultValue(lt,at.size)}}return rt}function generateProgram(tt,et){const rt=compileShader(tt,tt.VERTEX_SHADER,et.vertexSrc),nt=compileShader(tt,tt.FRAGMENT_SHADER,et.fragmentSrc),it=tt.createProgram();tt.attachShader(it,rt),tt.attachShader(it,nt);const at=et.extra?.transformFeedbackVaryings;if(at&&(typeof tt.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):tt.transformFeedbackVaryings(it,at.names,at.bufferMode==="separate"?tt.SEPARATE_ATTRIBS:tt.INTERLEAVED_ATTRIBS)),tt.linkProgram(it),tt.getProgramParameter(it,tt.LINK_STATUS)||logProgramError(tt,it,rt,nt),et.attributeData=getAttributeData(it,tt),et.uniformData=getUniformData(it,tt),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(et.vertexSrc)){const ot=Object.keys(et.attributeData);ot.sort((lt,ht)=>lt>ht?1:-1);for(let lt=0;lt<ot.length;lt++)et.attributeData[ot[lt]].location=lt,tt.bindAttribLocation(it,lt,ot[lt]);tt.linkProgram(it)}tt.deleteShader(rt),tt.deleteShader(nt);const st={};for(const ot in et.uniformData){const lt=et.uniformData[ot];st[ot]={location:tt.getUniformLocation(it,ot),value:defaultValue(lt.type,lt.size)}}return new GLProgram(it,st)}function uboUpdate(tt,et,rt,nt,it){rt.buffer.update(it)}const UBO_TO_SINGLE_SETTERS={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function createUBOElements(tt){const et=tt.map(at=>({data:at,offset:0,dataLen:0,dirty:0}));let rt=0,nt=0,it=0;for(let at=0;at<et.length;at++){const st=et[at];if(rt=GLSL_TO_STD40_SIZE[st.data.type],st.data.size>1&&(rt=Math.max(rt,16)*st.data.size),st.dataLen=rt,nt%rt!==0&&nt<16){const ot=nt%rt%16;nt+=ot,it+=ot}nt+rt>16?(it=Math.ceil(it/16)*16,st.offset=it,it+=rt,nt=rt):(st.offset=it,nt+=rt,it+=rt)}return it=Math.ceil(it/16)*16,{uboElements:et,size:it}}function getUBOData(tt,et){const rt=[];for(const nt in tt)et[nt]&&rt.push(et[nt]);return rt.sort((nt,it)=>nt.index-it.index),rt}function generateUniformBufferSync(tt,et){if(!tt.autoManage)return{size:0,syncFunc:uboUpdate};const rt=getUBOData(tt.uniforms,et),{uboElements:nt,size:it}=createUBOElements(rt),at=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let st=0;st<nt.length;st++){const ot=nt[st],lt=tt.uniforms[ot.data.name],ht=ot.data.name;let dt=!1;for(let ut=0;ut<uniformParsers.length;ut++){const ft=uniformParsers[ut];if(ft.codeUbo&&ft.test(ot.data,lt)){at.push(`offset = ${ot.offset/4};`,uniformParsers[ut].codeUbo(ot.data.name,lt)),dt=!0;break}}if(!dt)if(ot.data.size>1){const ut=mapSize(ot.data.type),ft=Math.max(GLSL_TO_STD40_SIZE[ot.data.type]/16,1),mt=ut/ft,gt=(4-mt%4)%4;at.push(`
                cv = ud.${ht}.value;
                v = uv.${ht};
                offset = ${ot.offset/4};

                t = 0;

                for(var i=0; i < ${ot.data.size*ft}; i++)
                {
                    for(var j = 0; j < ${mt}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${gt};
                }

                `)}else{const ut=UBO_TO_SINGLE_SETTERS[ot.data.type];at.push(`
                cv = ud.${ht}.value;
                v = uv.${ht};
                offset = ${ot.offset/4};
                ${ut};
                `)}}return at.push(`
       renderer.buffer.update(buffer);
    `),{size:it,syncFunc:new Function("ud","uv","renderer","syncData","buffer",at.join(`
`))}}let UID=0;const defaultSyncData={textureCount:0,uboCount:0};class ShaderSystem{constructor(et){this.destroyed=!1,this.renderer=et,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UID++}systemCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(et){this.gl=et,this.reset()}bind(et,rt){et.disposeRunner.add(this),et.uniforms.globals=this.renderer.globalUniforms;const nt=et.program,it=nt.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(et);return this.shader=et,this.program!==nt&&(this.program=nt,this.gl.useProgram(it.program)),rt||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(et.uniformGroup,defaultSyncData)),it}setUniforms(et){const rt=this.shader.program,nt=rt.glPrograms[this.renderer.CONTEXT_UID];rt.syncUniforms(nt.uniformData,et,this.renderer)}syncUniformGroup(et,rt){const nt=this.getGlProgram();(!et.static||et.dirtyId!==nt.uniformDirtyGroups[et.id])&&(nt.uniformDirtyGroups[et.id]=et.dirtyId,this.syncUniforms(et,nt,rt))}syncUniforms(et,rt,nt){(et.syncUniforms[this.shader.program.id]||this.createSyncGroups(et))(rt.uniformData,et.uniforms,this.renderer,nt)}createSyncGroups(et){const rt=this.getSignature(et,this.shader.program.uniformData,"u");return this.cache[rt]||(this.cache[rt]=generateUniformsSync(et,this.shader.program.uniformData)),et.syncUniforms[this.shader.program.id]=this.cache[rt],et.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(et,rt){const nt=this.getGlProgram();if(!et.static||et.dirtyId!==0||!nt.uniformGroups[et.id]){et.dirtyId=0;const it=nt.uniformGroups[et.id]||this.createSyncBufferGroup(et,nt,rt);et.buffer.update(),it(nt.uniformData,et.uniforms,this.renderer,defaultSyncData,et.buffer)}this.renderer.buffer.bindBufferBase(et.buffer,nt.uniformBufferBindings[rt])}createSyncBufferGroup(et,rt,nt){const{gl:it}=this.renderer;this.renderer.buffer.bind(et.buffer);const at=this.gl.getUniformBlockIndex(rt.program,nt);rt.uniformBufferBindings[nt]=this.shader.uniformBindCount,it.uniformBlockBinding(rt.program,at,this.shader.uniformBindCount),this.shader.uniformBindCount++;const st=this.getSignature(et,this.shader.program.uniformData,"ubo");let ot=this._uboCache[st];if(ot||(ot=this._uboCache[st]=generateUniformBufferSync(et,this.shader.program.uniformData)),et.autoManage){const lt=new Float32Array(ot.size/4);et.buffer.update(lt)}return rt.uniformGroups[et.id]=ot.syncFunc,rt.uniformGroups[et.id]}getSignature(et,rt,nt){const it=et.uniforms,at=[`${nt}-`];for(const st in it)at.push(st),rt[st]&&at.push(rt[st].type);return at.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(et){const rt=this.gl,nt=et.program,it=generateProgram(rt,nt);return nt.glPrograms[this.renderer.CONTEXT_UID]=it,it}reset(){this.program=null,this.shader=null}disposeShader(et){this.shader===et&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ShaderSystem.extension={type:ExtensionType.RendererSystem,name:"shader"};extensions$1.add(ShaderSystem);class StartupSystem{constructor(et){this.renderer=et}run(et){const{renderer:rt}=this;rt.runners.init.emit(rt.options),et.hello&&console.log(`PixiJS 7.4.3 - ${rt.rendererLogId} - https://pixijs.com`),rt.resize(rt.screen.width,rt.screen.height)}destroy(){}}StartupSystem.defaultOptions={hello:!1},StartupSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"startup"};extensions$1.add(StartupSystem);function mapWebGLBlendModesToPixi(tt,et=[]){return et[BLEND_MODES.NORMAL]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.ADD]=[tt.ONE,tt.ONE],et[BLEND_MODES.MULTIPLY]=[tt.DST_COLOR,tt.ONE_MINUS_SRC_ALPHA,tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.SCREEN]=[tt.ONE,tt.ONE_MINUS_SRC_COLOR,tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.OVERLAY]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.DARKEN]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.LIGHTEN]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.COLOR_DODGE]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.COLOR_BURN]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.HARD_LIGHT]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.SOFT_LIGHT]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.DIFFERENCE]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.EXCLUSION]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.HUE]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.SATURATION]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.COLOR]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.LUMINOSITY]=[tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.NONE]=[0,0],et[BLEND_MODES.NORMAL_NPM]=[tt.SRC_ALPHA,tt.ONE_MINUS_SRC_ALPHA,tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.ADD_NPM]=[tt.SRC_ALPHA,tt.ONE,tt.ONE,tt.ONE],et[BLEND_MODES.SCREEN_NPM]=[tt.SRC_ALPHA,tt.ONE_MINUS_SRC_COLOR,tt.ONE,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.SRC_IN]=[tt.DST_ALPHA,tt.ZERO],et[BLEND_MODES.SRC_OUT]=[tt.ONE_MINUS_DST_ALPHA,tt.ZERO],et[BLEND_MODES.SRC_ATOP]=[tt.DST_ALPHA,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.DST_OVER]=[tt.ONE_MINUS_DST_ALPHA,tt.ONE],et[BLEND_MODES.DST_IN]=[tt.ZERO,tt.SRC_ALPHA],et[BLEND_MODES.DST_OUT]=[tt.ZERO,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.DST_ATOP]=[tt.ONE_MINUS_DST_ALPHA,tt.SRC_ALPHA],et[BLEND_MODES.XOR]=[tt.ONE_MINUS_DST_ALPHA,tt.ONE_MINUS_SRC_ALPHA],et[BLEND_MODES.SUBTRACT]=[tt.ONE,tt.ONE,tt.ONE,tt.ONE,tt.FUNC_REVERSE_SUBTRACT,tt.FUNC_ADD],et}const BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,_StateSystem=class uf{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[BLEND]=this.setBlend,this.map[OFFSET]=this.setOffset,this.map[CULLING]=this.setCullFace,this.map[DEPTH_TEST]=this.setDepthTest,this.map[WINDING]=this.setFrontFace,this.map[DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=new State,this.defaultState.blend=!0}contextChange(et){this.gl=et,this.blendModes=mapWebGLBlendModesToPixi(et),this.set(this.defaultState),this.reset()}set(et){if(et=et||this.defaultState,this.stateId!==et.data){let rt=this.stateId^et.data,nt=0;for(;rt;)rt&1&&this.map[nt].call(this,!!(et.data&1<<nt)),rt=rt>>1,nt++;this.stateId=et.data}for(let rt=0;rt<this.checks.length;rt++)this.checks[rt](this,et)}forceState(et){et=et||this.defaultState;for(let rt=0;rt<this.map.length;rt++)this.map[rt].call(this,!!(et.data&1<<rt));for(let rt=0;rt<this.checks.length;rt++)this.checks[rt](this,et);this.stateId=et.data}setBlend(et){this.updateCheck(uf.checkBlendMode,et),this.gl[et?"enable":"disable"](this.gl.BLEND)}setOffset(et){this.updateCheck(uf.checkPolygonOffset,et),this.gl[et?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(et){this.gl[et?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(et){this.gl.depthMask(et)}setCullFace(et){this.gl[et?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(et){this.gl.frontFace(this.gl[et?"CW":"CCW"])}setBlendMode(et){if(et===this.blendMode)return;this.blendMode=et;const rt=this.blendModes[et],nt=this.gl;rt.length===2?nt.blendFunc(rt[0],rt[1]):nt.blendFuncSeparate(rt[0],rt[1],rt[2],rt[3]),rt.length===6?(this._blendEq=!0,nt.blendEquationSeparate(rt[4],rt[5])):this._blendEq&&(this._blendEq=!1,nt.blendEquationSeparate(nt.FUNC_ADD,nt.FUNC_ADD))}setPolygonOffset(et,rt){this.gl.polygonOffset(et,rt)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(et,rt){const nt=this.checks.indexOf(et);rt&&nt===-1?this.checks.push(et):!rt&&nt!==-1&&this.checks.splice(nt,1)}static checkBlendMode(et,rt){et.setBlendMode(rt.blendMode)}static checkPolygonOffset(et,rt){et.setPolygonOffset(1,rt.polygonOffset)}destroy(){this.gl=null}};_StateSystem.extension={type:ExtensionType.RendererSystem,name:"state"};let StateSystem=_StateSystem;extensions$1.add(StateSystem);class SystemManager extends EventEmitter{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(et){this.addRunners(...et.runners);const rt=(et.priority??[]).filter(it=>et.systems[it]),nt=[...rt,...Object.keys(et.systems).filter(it=>!rt.includes(it))];for(const it of nt)this.addSystem(et.systems[it],it)}addRunners(...et){et.forEach(rt=>{this.runners[rt]=new Runner(rt)})}addSystem(et,rt){const nt=new et(this);if(this[rt])throw new Error(`Whoops! The name "${rt}" is already in use`);this[rt]=nt,this._systemsHash[rt]=nt;for(const it in this.runners)this.runners[it].add(nt);return this}emitWithCustomOptions(et,rt){const nt=Object.keys(this._systemsHash);et.items.forEach(it=>{const at=nt.find(st=>this._systemsHash[st]===it);it[et.name](rt[at])})}destroy(){Object.values(this.runners).forEach(et=>{et.destroy()}),this._systemsHash={}}}const _TextureGCSystem=class Td{constructor(et){this.renderer=et,this.count=0,this.checkCount=0,this.maxIdle=Td.defaultMaxIdle,this.checkCountMax=Td.defaultCheckCountMax,this.mode=Td.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const et=this.renderer.texture,rt=et.managedTextures;let nt=!1;for(let it=0;it<rt.length;it++){const at=rt[it];at.resource&&this.count-at.touched>this.maxIdle&&(et.destroyTexture(at,!0),rt[it]=null,nt=!0)}if(nt){let it=0;for(let at=0;at<rt.length;at++)rt[at]!==null&&(rt[it++]=rt[at]);rt.length=it}}unload(et){const rt=this.renderer.texture,nt=et._texture;nt&&!nt.framebuffer&&rt.destroyTexture(nt);for(let it=et.children.length-1;it>=0;it--)this.unload(et.children[it])}destroy(){this.renderer=null}};_TextureGCSystem.defaultMode=GC_MODES.AUTO,_TextureGCSystem.defaultMaxIdle=3600,_TextureGCSystem.defaultCheckCountMax=600,_TextureGCSystem.extension={type:ExtensionType.RendererSystem,name:"textureGC"};let TextureGCSystem=_TextureGCSystem;extensions$1.add(TextureGCSystem);class GLTexture{constructor(et){this.texture=et,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=TYPES.UNSIGNED_BYTE,this.internalFormat=FORMATS.RGBA,this.samplerType=0}}function mapInternalFormatToSamplerType(tt){let et;return"WebGL2RenderingContext"in globalThis&&tt instanceof globalThis.WebGL2RenderingContext?et={[tt.RGB]:SAMPLER_TYPES.FLOAT,[tt.RGBA]:SAMPLER_TYPES.FLOAT,[tt.ALPHA]:SAMPLER_TYPES.FLOAT,[tt.LUMINANCE]:SAMPLER_TYPES.FLOAT,[tt.LUMINANCE_ALPHA]:SAMPLER_TYPES.FLOAT,[tt.R8]:SAMPLER_TYPES.FLOAT,[tt.R8_SNORM]:SAMPLER_TYPES.FLOAT,[tt.RG8]:SAMPLER_TYPES.FLOAT,[tt.RG8_SNORM]:SAMPLER_TYPES.FLOAT,[tt.RGB8]:SAMPLER_TYPES.FLOAT,[tt.RGB8_SNORM]:SAMPLER_TYPES.FLOAT,[tt.RGB565]:SAMPLER_TYPES.FLOAT,[tt.RGBA4]:SAMPLER_TYPES.FLOAT,[tt.RGB5_A1]:SAMPLER_TYPES.FLOAT,[tt.RGBA8]:SAMPLER_TYPES.FLOAT,[tt.RGBA8_SNORM]:SAMPLER_TYPES.FLOAT,[tt.RGB10_A2]:SAMPLER_TYPES.FLOAT,[tt.RGB10_A2UI]:SAMPLER_TYPES.FLOAT,[tt.SRGB8]:SAMPLER_TYPES.FLOAT,[tt.SRGB8_ALPHA8]:SAMPLER_TYPES.FLOAT,[tt.R16F]:SAMPLER_TYPES.FLOAT,[tt.RG16F]:SAMPLER_TYPES.FLOAT,[tt.RGB16F]:SAMPLER_TYPES.FLOAT,[tt.RGBA16F]:SAMPLER_TYPES.FLOAT,[tt.R32F]:SAMPLER_TYPES.FLOAT,[tt.RG32F]:SAMPLER_TYPES.FLOAT,[tt.RGB32F]:SAMPLER_TYPES.FLOAT,[tt.RGBA32F]:SAMPLER_TYPES.FLOAT,[tt.R11F_G11F_B10F]:SAMPLER_TYPES.FLOAT,[tt.RGB9_E5]:SAMPLER_TYPES.FLOAT,[tt.R8I]:SAMPLER_TYPES.INT,[tt.R8UI]:SAMPLER_TYPES.UINT,[tt.R16I]:SAMPLER_TYPES.INT,[tt.R16UI]:SAMPLER_TYPES.UINT,[tt.R32I]:SAMPLER_TYPES.INT,[tt.R32UI]:SAMPLER_TYPES.UINT,[tt.RG8I]:SAMPLER_TYPES.INT,[tt.RG8UI]:SAMPLER_TYPES.UINT,[tt.RG16I]:SAMPLER_TYPES.INT,[tt.RG16UI]:SAMPLER_TYPES.UINT,[tt.RG32I]:SAMPLER_TYPES.INT,[tt.RG32UI]:SAMPLER_TYPES.UINT,[tt.RGB8I]:SAMPLER_TYPES.INT,[tt.RGB8UI]:SAMPLER_TYPES.UINT,[tt.RGB16I]:SAMPLER_TYPES.INT,[tt.RGB16UI]:SAMPLER_TYPES.UINT,[tt.RGB32I]:SAMPLER_TYPES.INT,[tt.RGB32UI]:SAMPLER_TYPES.UINT,[tt.RGBA8I]:SAMPLER_TYPES.INT,[tt.RGBA8UI]:SAMPLER_TYPES.UINT,[tt.RGBA16I]:SAMPLER_TYPES.INT,[tt.RGBA16UI]:SAMPLER_TYPES.UINT,[tt.RGBA32I]:SAMPLER_TYPES.INT,[tt.RGBA32UI]:SAMPLER_TYPES.UINT,[tt.DEPTH_COMPONENT16]:SAMPLER_TYPES.FLOAT,[tt.DEPTH_COMPONENT24]:SAMPLER_TYPES.FLOAT,[tt.DEPTH_COMPONENT32F]:SAMPLER_TYPES.FLOAT,[tt.DEPTH_STENCIL]:SAMPLER_TYPES.FLOAT,[tt.DEPTH24_STENCIL8]:SAMPLER_TYPES.FLOAT,[tt.DEPTH32F_STENCIL8]:SAMPLER_TYPES.FLOAT}:et={[tt.RGB]:SAMPLER_TYPES.FLOAT,[tt.RGBA]:SAMPLER_TYPES.FLOAT,[tt.ALPHA]:SAMPLER_TYPES.FLOAT,[tt.LUMINANCE]:SAMPLER_TYPES.FLOAT,[tt.LUMINANCE_ALPHA]:SAMPLER_TYPES.FLOAT,[tt.DEPTH_STENCIL]:SAMPLER_TYPES.FLOAT},et}function mapTypeAndFormatToInternalFormat(tt){let et;return"WebGL2RenderingContext"in globalThis&&tt instanceof globalThis.WebGL2RenderingContext?et={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:tt.RGBA8,[FORMATS.RGB]:tt.RGB8,[FORMATS.RG]:tt.RG8,[FORMATS.RED]:tt.R8,[FORMATS.RGBA_INTEGER]:tt.RGBA8UI,[FORMATS.RGB_INTEGER]:tt.RGB8UI,[FORMATS.RG_INTEGER]:tt.RG8UI,[FORMATS.RED_INTEGER]:tt.R8UI,[FORMATS.ALPHA]:tt.ALPHA,[FORMATS.LUMINANCE]:tt.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:tt.LUMINANCE_ALPHA},[TYPES.BYTE]:{[FORMATS.RGBA]:tt.RGBA8_SNORM,[FORMATS.RGB]:tt.RGB8_SNORM,[FORMATS.RG]:tt.RG8_SNORM,[FORMATS.RED]:tt.R8_SNORM,[FORMATS.RGBA_INTEGER]:tt.RGBA8I,[FORMATS.RGB_INTEGER]:tt.RGB8I,[FORMATS.RG_INTEGER]:tt.RG8I,[FORMATS.RED_INTEGER]:tt.R8I},[TYPES.UNSIGNED_SHORT]:{[FORMATS.RGBA_INTEGER]:tt.RGBA16UI,[FORMATS.RGB_INTEGER]:tt.RGB16UI,[FORMATS.RG_INTEGER]:tt.RG16UI,[FORMATS.RED_INTEGER]:tt.R16UI,[FORMATS.DEPTH_COMPONENT]:tt.DEPTH_COMPONENT16},[TYPES.SHORT]:{[FORMATS.RGBA_INTEGER]:tt.RGBA16I,[FORMATS.RGB_INTEGER]:tt.RGB16I,[FORMATS.RG_INTEGER]:tt.RG16I,[FORMATS.RED_INTEGER]:tt.R16I},[TYPES.UNSIGNED_INT]:{[FORMATS.RGBA_INTEGER]:tt.RGBA32UI,[FORMATS.RGB_INTEGER]:tt.RGB32UI,[FORMATS.RG_INTEGER]:tt.RG32UI,[FORMATS.RED_INTEGER]:tt.R32UI,[FORMATS.DEPTH_COMPONENT]:tt.DEPTH_COMPONENT24},[TYPES.INT]:{[FORMATS.RGBA_INTEGER]:tt.RGBA32I,[FORMATS.RGB_INTEGER]:tt.RGB32I,[FORMATS.RG_INTEGER]:tt.RG32I,[FORMATS.RED_INTEGER]:tt.R32I},[TYPES.FLOAT]:{[FORMATS.RGBA]:tt.RGBA32F,[FORMATS.RGB]:tt.RGB32F,[FORMATS.RG]:tt.RG32F,[FORMATS.RED]:tt.R32F,[FORMATS.DEPTH_COMPONENT]:tt.DEPTH_COMPONENT32F},[TYPES.HALF_FLOAT]:{[FORMATS.RGBA]:tt.RGBA16F,[FORMATS.RGB]:tt.RGB16F,[FORMATS.RG]:tt.RG16F,[FORMATS.RED]:tt.R16F},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:tt.RGB565},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:tt.RGBA4},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:tt.RGB5_A1},[TYPES.UNSIGNED_INT_2_10_10_10_REV]:{[FORMATS.RGBA]:tt.RGB10_A2,[FORMATS.RGBA_INTEGER]:tt.RGB10_A2UI},[TYPES.UNSIGNED_INT_10F_11F_11F_REV]:{[FORMATS.RGB]:tt.R11F_G11F_B10F},[TYPES.UNSIGNED_INT_5_9_9_9_REV]:{[FORMATS.RGB]:tt.RGB9_E5},[TYPES.UNSIGNED_INT_24_8]:{[FORMATS.DEPTH_STENCIL]:tt.DEPTH24_STENCIL8},[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[FORMATS.DEPTH_STENCIL]:tt.DEPTH32F_STENCIL8}}:et={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:tt.RGBA,[FORMATS.RGB]:tt.RGB,[FORMATS.ALPHA]:tt.ALPHA,[FORMATS.LUMINANCE]:tt.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:tt.LUMINANCE_ALPHA},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:tt.RGB},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:tt.RGBA},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:tt.RGBA}},et}class TextureSystem{constructor(et){this.renderer=et,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new BaseTexture,this.hasIntegerTextures=!1}contextChange(){const et=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(et),this.samplerTypes=mapInternalFormatToSamplerType(et);const rt=et.getParameter(et.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=rt;for(let it=0;it<rt;it++)this.boundTextures[it]=null;this.emptyTextures={};const nt=new GLTexture(et.createTexture());et.bindTexture(et.TEXTURE_2D,nt.texture),et.texImage2D(et.TEXTURE_2D,0,et.RGBA,1,1,0,et.RGBA,et.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[et.TEXTURE_2D]=nt,this.emptyTextures[et.TEXTURE_CUBE_MAP]=new GLTexture(et.createTexture()),et.bindTexture(et.TEXTURE_CUBE_MAP,this.emptyTextures[et.TEXTURE_CUBE_MAP].texture);for(let it=0;it<6;it++)et.texImage2D(et.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,et.RGBA,1,1,0,et.RGBA,et.UNSIGNED_BYTE,null);et.texParameteri(et.TEXTURE_CUBE_MAP,et.TEXTURE_MAG_FILTER,et.LINEAR),et.texParameteri(et.TEXTURE_CUBE_MAP,et.TEXTURE_MIN_FILTER,et.LINEAR);for(let it=0;it<this.boundTextures.length;it++)this.bind(null,it)}bind(et,rt=0){const{gl:nt}=this;if(et=et?.castToBaseTexture(),et?.valid&&!et.parentTextureArray){et.touched=this.renderer.textureGC.count;const it=et._glTextures[this.CONTEXT_UID]||this.initTexture(et);this.boundTextures[rt]!==et&&(this.currentLocation!==rt&&(this.currentLocation=rt,nt.activeTexture(nt.TEXTURE0+rt)),nt.bindTexture(et.target,it.texture)),it.dirtyId!==et.dirtyId?(this.currentLocation!==rt&&(this.currentLocation=rt,nt.activeTexture(nt.TEXTURE0+rt)),this.updateTexture(et)):it.dirtyStyleId!==et.dirtyStyleId&&this.updateTextureStyle(et),this.boundTextures[rt]=et}else this.currentLocation!==rt&&(this.currentLocation=rt,nt.activeTexture(nt.TEXTURE0+rt)),nt.bindTexture(nt.TEXTURE_2D,this.emptyTextures[nt.TEXTURE_2D].texture),this.boundTextures[rt]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let et=0;et<this.boundTextures.length;et++)this.boundTextures[et]=this.unknownTexture}unbind(et){const{gl:rt,boundTextures:nt}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let it=0;it<nt.length;it++)nt[it]===this.unknownTexture&&this.bind(null,it)}for(let it=0;it<nt.length;it++)nt[it]===et&&(this.currentLocation!==it&&(rt.activeTexture(rt.TEXTURE0+it),this.currentLocation=it),rt.bindTexture(et.target,this.emptyTextures[et.target].texture),nt[it]=null)}ensureSamplerType(et){const{boundTextures:rt,hasIntegerTextures:nt,CONTEXT_UID:it}=this;if(nt)for(let at=et-1;at>=0;--at){const st=rt[at];st&&st._glTextures[it].samplerType!==SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(st)}}initTexture(et){const rt=new GLTexture(this.gl.createTexture());return rt.dirtyId=-1,et._glTextures[this.CONTEXT_UID]=rt,this.managedTextures.push(et),et.on("dispose",this.destroyTexture,this),rt}initTextureType(et,rt){rt.internalFormat=this.internalFormats[et.type]?.[et.format]??et.format,rt.samplerType=this.samplerTypes[rt.internalFormat]??SAMPLER_TYPES.FLOAT,this.webGLVersion===2&&et.type===TYPES.HALF_FLOAT?rt.type=this.gl.HALF_FLOAT:rt.type=et.type}updateTexture(et){const rt=et._glTextures[this.CONTEXT_UID];if(!rt)return;const nt=this.renderer;if(this.initTextureType(et,rt),et.resource?.upload(nt,et,rt))rt.samplerType!==SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{const it=et.realWidth,at=et.realHeight,st=nt.gl;(rt.width!==it||rt.height!==at||rt.dirtyId<0)&&(rt.width=it,rt.height=at,st.texImage2D(et.target,0,rt.internalFormat,it,at,0,et.format,rt.type,null))}et.dirtyStyleId!==rt.dirtyStyleId&&this.updateTextureStyle(et),rt.dirtyId=et.dirtyId}destroyTexture(et,rt){const{gl:nt}=this;if(et=et.castToBaseTexture(),et._glTextures[this.CONTEXT_UID]&&(this.unbind(et),nt.deleteTexture(et._glTextures[this.CONTEXT_UID].texture),et.off("dispose",this.destroyTexture,this),delete et._glTextures[this.CONTEXT_UID],!rt)){const it=this.managedTextures.indexOf(et);it!==-1&&removeItems(this.managedTextures,it,1)}}updateTextureStyle(et){const rt=et._glTextures[this.CONTEXT_UID];rt&&((et.mipmap===MIPMAP_MODES.POW2||this.webGLVersion!==2)&&!et.isPowerOfTwo?rt.mipmap=!1:rt.mipmap=et.mipmap>=1,this.webGLVersion!==2&&!et.isPowerOfTwo?rt.wrapMode=WRAP_MODES.CLAMP:rt.wrapMode=et.wrapMode,et.resource?.style(this.renderer,et,rt)||this.setStyle(et,rt),rt.dirtyStyleId=et.dirtyStyleId)}setStyle(et,rt){const nt=this.gl;if(rt.mipmap&&et.mipmap!==MIPMAP_MODES.ON_MANUAL&&nt.generateMipmap(et.target),nt.texParameteri(et.target,nt.TEXTURE_WRAP_S,rt.wrapMode),nt.texParameteri(et.target,nt.TEXTURE_WRAP_T,rt.wrapMode),rt.mipmap){nt.texParameteri(et.target,nt.TEXTURE_MIN_FILTER,et.scaleMode===SCALE_MODES.LINEAR?nt.LINEAR_MIPMAP_LINEAR:nt.NEAREST_MIPMAP_NEAREST);const it=this.renderer.context.extensions.anisotropicFiltering;if(it&&et.anisotropicLevel>0&&et.scaleMode===SCALE_MODES.LINEAR){const at=Math.min(et.anisotropicLevel,nt.getParameter(it.MAX_TEXTURE_MAX_ANISOTROPY_EXT));nt.texParameterf(et.target,it.TEXTURE_MAX_ANISOTROPY_EXT,at)}}else nt.texParameteri(et.target,nt.TEXTURE_MIN_FILTER,et.scaleMode===SCALE_MODES.LINEAR?nt.LINEAR:nt.NEAREST);nt.texParameteri(et.target,nt.TEXTURE_MAG_FILTER,et.scaleMode===SCALE_MODES.LINEAR?nt.LINEAR:nt.NEAREST)}destroy(){this.renderer=null}}TextureSystem.extension={type:ExtensionType.RendererSystem,name:"texture"};extensions$1.add(TextureSystem);class TransformFeedbackSystem{constructor(et){this.renderer=et}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(et){const{gl:rt,CONTEXT_UID:nt}=this,it=et._glTransformFeedbacks[nt]||this.createGLTransformFeedback(et);rt.bindTransformFeedback(rt.TRANSFORM_FEEDBACK,it)}unbind(){const{gl:et}=this;et.bindTransformFeedback(et.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(et,rt){const{gl:nt,renderer:it}=this;rt&&it.shader.bind(rt),nt.beginTransformFeedback(et)}endTransformFeedback(){const{gl:et}=this;et.endTransformFeedback()}createGLTransformFeedback(et){const{gl:rt,renderer:nt,CONTEXT_UID:it}=this,at=rt.createTransformFeedback();et._glTransformFeedbacks[it]=at,rt.bindTransformFeedback(rt.TRANSFORM_FEEDBACK,at);for(let st=0;st<et.buffers.length;st++){const ot=et.buffers[st];ot&&(nt.buffer.update(ot),ot._glBuffers[it].refCount++,rt.bindBufferBase(rt.TRANSFORM_FEEDBACK_BUFFER,st,ot._glBuffers[it].buffer||null))}return rt.bindTransformFeedback(rt.TRANSFORM_FEEDBACK,null),et.disposeRunner.add(this),at}disposeTransformFeedback(et,rt){const nt=et._glTransformFeedbacks[this.CONTEXT_UID],it=this.gl;et.disposeRunner.remove(this);const at=this.renderer.buffer;if(at)for(let st=0;st<et.buffers.length;st++){const ot=et.buffers[st];if(!ot)continue;const lt=ot._glBuffers[this.CONTEXT_UID];lt&&(lt.refCount--,lt.refCount===0&&!rt&&at.dispose(ot,rt))}nt&&(rt||it.deleteTransformFeedback(nt),delete et._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}TransformFeedbackSystem.extension={type:ExtensionType.RendererSystem,name:"transformFeedback"};extensions$1.add(TransformFeedbackSystem);class ViewSystem{constructor(et){this.renderer=et}init(et){this.screen=new Rectangle(0,0,et.width,et.height),this.element=et.view||settings.ADAPTER.createCanvas(),this.resolution=et.resolution||settings.RESOLUTION,this.autoDensity=!!et.autoDensity}resizeView(et,rt){this.element.width=Math.round(et*this.resolution),this.element.height=Math.round(rt*this.resolution);const nt=this.element.width/this.resolution,it=this.element.height/this.resolution;this.screen.width=nt,this.screen.height=it,this.autoDensity&&(this.element.style.width=`${nt}px`,this.element.style.height=`${it}px`),this.renderer.emit("resize",nt,it),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(et){et&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}ViewSystem.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ViewSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_view"};extensions$1.add(ViewSystem);settings.PREFER_ENV=ENV.WEBGL2;settings.STRICT_TEXTURE_CACHE=!1;settings.RENDER_OPTIONS={...ContextSystem.defaultOptions,...BackgroundSystem.defaultOptions,...ViewSystem.defaultOptions,...StartupSystem.defaultOptions};Object.defineProperties(settings,{WRAP_MODE:{get(){return BaseTexture.defaultOptions.wrapMode},set(tt){deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),BaseTexture.defaultOptions.wrapMode=tt}},SCALE_MODE:{get(){return BaseTexture.defaultOptions.scaleMode},set(tt){deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),BaseTexture.defaultOptions.scaleMode=tt}},MIPMAP_TEXTURES:{get(){return BaseTexture.defaultOptions.mipmap},set(tt){deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),BaseTexture.defaultOptions.mipmap=tt}},ANISOTROPIC_LEVEL:{get(){return BaseTexture.defaultOptions.anisotropicLevel},set(tt){deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),BaseTexture.defaultOptions.anisotropicLevel=tt}},FILTER_RESOLUTION:{get(){return deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Filter.defaultResolution},set(tt){Filter.defaultResolution=tt}},FILTER_MULTISAMPLE:{get(){return deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Filter.defaultMultisample},set(tt){Filter.defaultMultisample=tt}},SPRITE_MAX_TEXTURES:{get(){return BatchRenderer.defaultMaxTextures},set(tt){deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),BatchRenderer.defaultMaxTextures=tt}},SPRITE_BATCH_SIZE:{get(){return BatchRenderer.defaultBatchSize},set(tt){deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),BatchRenderer.defaultBatchSize=tt}},CAN_UPLOAD_SAME_BUFFER:{get(){return BatchRenderer.canUploadSameBuffer},set(tt){deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),BatchRenderer.canUploadSameBuffer=tt}},GC_MODE:{get(){return TextureGCSystem.defaultMode},set(tt){deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),TextureGCSystem.defaultMode=tt}},GC_MAX_IDLE:{get(){return TextureGCSystem.defaultMaxIdle},set(tt){deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),TextureGCSystem.defaultMaxIdle=tt}},GC_MAX_CHECK_COUNT:{get(){return TextureGCSystem.defaultCheckCountMax},set(tt){deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),TextureGCSystem.defaultCheckCountMax=tt}},PRECISION_VERTEX:{get(){return Program.defaultVertexPrecision},set(tt){deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Program.defaultVertexPrecision=tt}},PRECISION_FRAGMENT:{get(){return Program.defaultFragmentPrecision},set(tt){deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Program.defaultFragmentPrecision=tt}}});var UPDATE_PRIORITY=(tt=>(tt[tt.INTERACTION=50]="INTERACTION",tt[tt.HIGH=25]="HIGH",tt[tt.NORMAL=0]="NORMAL",tt[tt.LOW=-25]="LOW",tt[tt.UTILITY=-50]="UTILITY",tt))(UPDATE_PRIORITY||{});class TickerListener{constructor(et,rt=null,nt=0,it=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=et,this.context=rt,this.priority=nt,this.once=it}match(et,rt=null){return this.fn===et&&this.context===rt}emit(et){this.fn&&(this.context?this.fn.call(this.context,et):this.fn(et));const rt=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),rt}connect(et){this.previous=et,et.next&&(et.next.previous=this),this.next=et.next,et.next=this}destroy(et=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const rt=this.next;return this.next=et?null:rt,this.previous=null,rt}}const _Ticker=class $o{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/$o.targetFPMS,this.elapsedMS=1/$o.targetFPMS,this._tick=et=>{this._requestId=null,this.started&&(this.update(et),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(et,rt,nt=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(et,rt,nt))}addOnce(et,rt,nt=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(et,rt,nt,!0))}_addListener(et){let rt=this._head.next,nt=this._head;if(!rt)et.connect(nt);else{for(;rt;){if(et.priority>rt.priority){et.connect(nt);break}nt=rt,rt=rt.next}et.previous||et.connect(nt)}return this._startIfPossible(),this}remove(et,rt){let nt=this._head.next;for(;nt;)nt.match(et,rt)?nt=nt.destroy():nt=nt.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let et=0,rt=this._head;for(;rt=rt.next;)et++;return et}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let et=this._head.next;for(;et;)et=et.destroy(!0);this._head.destroy(),this._head=null}}update(et=performance.now()){let rt;if(et>this.lastTime){if(rt=this.elapsedMS=et-this.lastTime,rt>this._maxElapsedMS&&(rt=this._maxElapsedMS),rt*=this.speed,this._minElapsedMS){const at=et-this._lastFrame|0;if(at<this._minElapsedMS)return;this._lastFrame=et-at%this._minElapsedMS}this.deltaMS=rt,this.deltaTime=this.deltaMS*$o.targetFPMS;const nt=this._head;let it=nt.next;for(;it;)it=it.emit(this.deltaTime);nt.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=et}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(et){const rt=Math.min(this.maxFPS,et),nt=Math.min(Math.max(0,rt)/1e3,$o.targetFPMS);this._maxElapsedMS=1/nt}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(et){if(et===0)this._minElapsedMS=0;else{const rt=Math.max(this.minFPS,et);this._minElapsedMS=1/(rt/1e3)}}static get shared(){if(!$o._shared){const et=$o._shared=new $o;et.autoStart=!0,et._protected=!0}return $o._shared}static get system(){if(!$o._system){const et=$o._system=new $o;et.autoStart=!0,et._protected=!0}return $o._system}};_Ticker.targetFPMS=.06;let Ticker=_Ticker;Object.defineProperties(settings,{TARGET_FPMS:{get(){return Ticker.targetFPMS},set(tt){deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ticker.targetFPMS=tt}}});class TickerPlugin{static init(et){et=Object.assign({autoStart:!0,sharedTicker:!1},et),Object.defineProperty(this,"ticker",{set(rt){this._ticker&&this._ticker.remove(this.render,this),this._ticker=rt,rt&&rt.add(this.render,this,UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=et.sharedTicker?Ticker.shared:new Ticker,et.autoStart&&this.start()}static destroy(){if(this._ticker){const et=this._ticker;this.ticker=null,et.destroy()}}}TickerPlugin.extension=ExtensionType.Application;extensions$1.add(TickerPlugin);const renderers=[];extensions$1.handleByList(ExtensionType.Renderer,renderers);function autoDetectRenderer(tt){for(const et of renderers)if(et.test(tt))return new et(tt);throw new Error("Unable to auto-detect a suitable renderer.")}var $defaultVertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$defaultFilterVertex=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const defaultVertex=$defaultVertex,defaultFilterVertex=$defaultFilterVertex;class MultisampleSystem{constructor(et){this.renderer=et}contextChange(et){let rt;if(this.renderer.context.webGLVersion===1){const nt=et.getParameter(et.FRAMEBUFFER_BINDING);et.bindFramebuffer(et.FRAMEBUFFER,null),rt=et.getParameter(et.SAMPLES),et.bindFramebuffer(et.FRAMEBUFFER,nt)}else{const nt=et.getParameter(et.DRAW_FRAMEBUFFER_BINDING);et.bindFramebuffer(et.DRAW_FRAMEBUFFER,null),rt=et.getParameter(et.SAMPLES),et.bindFramebuffer(et.DRAW_FRAMEBUFFER,nt)}rt>=MSAA_QUALITY.HIGH?this.multisample=MSAA_QUALITY.HIGH:rt>=MSAA_QUALITY.MEDIUM?this.multisample=MSAA_QUALITY.MEDIUM:rt>=MSAA_QUALITY.LOW?this.multisample=MSAA_QUALITY.LOW:this.multisample=MSAA_QUALITY.NONE}destroy(){}}MultisampleSystem.extension={type:ExtensionType.RendererSystem,name:"_multisample"};extensions$1.add(MultisampleSystem);class GLBuffer{constructor(et){this.buffer=et||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class BufferSystem{constructor(et){this.renderer=et,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(et){const{gl:rt,CONTEXT_UID:nt}=this,it=et._glBuffers[nt]||this.createGLBuffer(et);rt.bindBuffer(et.type,it.buffer)}unbind(et){const{gl:rt}=this;rt.bindBuffer(et,null)}bindBufferBase(et,rt){const{gl:nt,CONTEXT_UID:it}=this;if(this.boundBufferBases[rt]!==et){const at=et._glBuffers[it]||this.createGLBuffer(et);this.boundBufferBases[rt]=et,nt.bindBufferBase(nt.UNIFORM_BUFFER,rt,at.buffer)}}bindBufferRange(et,rt,nt){const{gl:it,CONTEXT_UID:at}=this;nt=nt||0;const st=et._glBuffers[at]||this.createGLBuffer(et);it.bindBufferRange(it.UNIFORM_BUFFER,rt||0,st.buffer,nt*256,256)}update(et){const{gl:rt,CONTEXT_UID:nt}=this,it=et._glBuffers[nt]||this.createGLBuffer(et);if(et._updateID!==it.updateID)if(it.updateID=et._updateID,rt.bindBuffer(et.type,it.buffer),it.byteLength>=et.data.byteLength)rt.bufferSubData(et.type,0,et.data);else{const at=et.static?rt.STATIC_DRAW:rt.DYNAMIC_DRAW;it.byteLength=et.data.byteLength,rt.bufferData(et.type,et.data,at)}}dispose(et,rt){if(!this.managedBuffers[et.id])return;delete this.managedBuffers[et.id];const nt=et._glBuffers[this.CONTEXT_UID],it=this.gl;et.disposeRunner.remove(this),nt&&(rt||it.deleteBuffer(nt.buffer),delete et._glBuffers[this.CONTEXT_UID])}disposeAll(et){const rt=Object.keys(this.managedBuffers);for(let nt=0;nt<rt.length;nt++)this.dispose(this.managedBuffers[rt[nt]],et)}createGLBuffer(et){const{CONTEXT_UID:rt,gl:nt}=this;return et._glBuffers[rt]=new GLBuffer(nt.createBuffer()),this.managedBuffers[et.id]=et,et.disposeRunner.add(this),et._glBuffers[rt]}}BufferSystem.extension={type:ExtensionType.RendererSystem,name:"buffer"};extensions$1.add(BufferSystem);class ObjectRendererSystem{constructor(et){this.renderer=et}render(et,rt){const nt=this.renderer;let it,at,st,ot;if(rt&&(it=rt.renderTexture,at=rt.clear,st=rt.transform,ot=rt.skipUpdateTransform),this.renderingToScreen=!it,nt.runners.prerender.emit(),nt.emit("prerender"),nt.projection.transform=st,!nt.context.isLost){if(it||(this.lastObjectRendered=et),!ot){const lt=et.enableTempParent();et.updateTransform(),et.disableTempParent(lt)}nt.renderTexture.bind(it),nt.batch.currentRenderer.start(),(at??nt.background.clearBeforeRender)&&nt.renderTexture.clear(),et.render(nt),nt.batch.currentRenderer.flush(),it&&(rt.blit&&nt.framebuffer.blit(),it.baseTexture.update()),nt.runners.postrender.emit(),nt.projection.transform=null,nt.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ObjectRendererSystem.extension={type:ExtensionType.RendererSystem,name:"objectRenderer"};extensions$1.add(ObjectRendererSystem);const _Renderer=class cf extends SystemManager{constructor(et){super(),this.type=RENDERER_TYPE.WEBGL,et=Object.assign({},settings.RENDER_OPTIONS,et),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0);const rt={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:cf.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(rt),"useContextAlpha"in et&&(deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),et.premultipliedAlpha=et.useContextAlpha&&et.useContextAlpha!=="notMultiplied",et.backgroundAlpha=et.useContextAlpha===!1?1:et.backgroundAlpha),this._plugin.rendererPlugins=cf.__plugins,this.options=et,this.startup.run(this.options)}static test(et){return et?.forceCanvas?!1:isWebGLSupported()}render(et,rt){this.objectRenderer.render(et,rt)}resize(et,rt){this._view.resizeView(et,rt)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(et=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:et}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(et){this._view.resolution=et,this.runners.resolutionChange.emit(et)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(et){deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=et}get backgroundAlpha(){return deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(et){deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=et}get powerPreference(){return deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(et,rt){return this.textureGenerator.generateTexture(et,rt)}};_Renderer.extension={type:ExtensionType.Renderer,priority:1},_Renderer.__plugins={},_Renderer.__systems={};let Renderer=_Renderer;extensions$1.handleByMap(ExtensionType.RendererPlugin,Renderer.__plugins);extensions$1.handleByMap(ExtensionType.RendererSystem,Renderer.__systems);extensions$1.add(Renderer);class AbstractMultiResource extends Resource{constructor(et,rt){const{width:nt,height:it}=rt||{};super(nt,it),this.items=[],this.itemDirtyIds=[];for(let at=0;at<et;at++){const st=new BaseTexture;this.items.push(st),this.itemDirtyIds.push(-2)}this.length=et,this._load=null,this.baseTexture=null}initFromArray(et,rt){for(let nt=0;nt<this.length;nt++)et[nt]&&(et[nt].castToBaseTexture?this.addBaseTextureAt(et[nt].castToBaseTexture(),nt):et[nt]instanceof Resource?this.addResourceAt(et[nt],nt):this.addResourceAt(autoDetectResource(et[nt],rt),nt))}dispose(){for(let et=0,rt=this.length;et<rt;et++)this.items[et].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(et,rt){if(!this.items[rt])throw new Error(`Index ${rt} is out of bounds`);return et.valid&&!this.valid&&this.resize(et.width,et.height),this.items[rt].setResource(et),this}bind(et){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(et);for(let rt=0;rt<this.length;rt++)this.items[rt].parentTextureArray=et,this.items[rt].on("update",et.update,et)}unbind(et){super.unbind(et);for(let rt=0;rt<this.length;rt++)this.items[rt].parentTextureArray=null,this.items[rt].off("update",et.update,et)}load(){if(this._load)return this._load;const et=this.items.map(rt=>rt.resource).filter(rt=>rt).map(rt=>rt.load());return this._load=Promise.all(et).then(()=>{const{realWidth:rt,realHeight:nt}=this.items[0];return this.resize(rt,nt),this.update(),Promise.resolve(this)}),this._load}}class ArrayResource extends AbstractMultiResource{constructor(et,rt){const{width:nt,height:it}=rt||{};let at,st;Array.isArray(et)?(at=et,st=et.length):st=et,super(st,{width:nt,height:it}),at&&this.initFromArray(at,rt)}addBaseTextureAt(et,rt){if(et.resource)this.addResourceAt(et.resource,rt);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(et){super.bind(et),et.target=TARGETS.TEXTURE_2D_ARRAY}upload(et,rt,nt){const{length:it,itemDirtyIds:at,items:st}=this,{gl:ot}=et;nt.dirtyId<0&&ot.texImage3D(ot.TEXTURE_2D_ARRAY,0,nt.internalFormat,this._width,this._height,it,0,rt.format,nt.type,null);for(let lt=0;lt<it;lt++){const ht=st[lt];at[lt]<ht.dirtyId&&(at[lt]=ht.dirtyId,ht.valid&&ot.texSubImage3D(ot.TEXTURE_2D_ARRAY,0,0,0,lt,ht.resource.width,ht.resource.height,1,rt.format,nt.type,ht.resource.source))}return!0}}class CanvasResource extends BaseImageResource{constructor(et){super(et)}static test(et){const{OffscreenCanvas:rt}=globalThis;return rt&&et instanceof rt?!0:globalThis.HTMLCanvasElement&&et instanceof HTMLCanvasElement}}const _CubeResource=class Hh extends AbstractMultiResource{constructor(et,rt){const{width:nt,height:it,autoLoad:at,linkBaseTexture:st}=rt||{};if(et&&et.length!==Hh.SIDES)throw new Error(`Invalid length. Got ${et.length}, expected 6`);super(6,{width:nt,height:it});for(let ot=0;ot<Hh.SIDES;ot++)this.items[ot].target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+ot;this.linkBaseTexture=st!==!1,et&&this.initFromArray(et,rt),at!==!1&&this.load()}bind(et){super.bind(et),et.target=TARGETS.TEXTURE_CUBE_MAP}addBaseTextureAt(et,rt,nt){if(nt===void 0&&(nt=this.linkBaseTexture),!this.items[rt])throw new Error(`Index ${rt} is out of bounds`);if(!this.linkBaseTexture||et.parentTextureArray||Object.keys(et._glTextures).length>0)if(et.resource)this.addResourceAt(et.resource,rt);else throw new Error("CubeResource does not support copying of renderTexture.");else et.target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+rt,et.parentTextureArray=this.baseTexture,this.items[rt]=et;return et.valid&&!this.valid&&this.resize(et.realWidth,et.realHeight),this.items[rt]=et,this}upload(et,rt,nt){const it=this.itemDirtyIds;for(let at=0;at<Hh.SIDES;at++){const st=this.items[at];(it[at]<st.dirtyId||nt.dirtyId<rt.dirtyId)&&(st.valid&&st.resource?(st.resource.upload(et,st,nt),it[at]=st.dirtyId):it[at]<-1&&(et.gl.texImage2D(st.target,0,nt.internalFormat,rt.realWidth,rt.realHeight,0,rt.format,nt.type,null),it[at]=-1))}return!0}static test(et){return Array.isArray(et)&&et.length===Hh.SIDES}};_CubeResource.SIDES=6;let CubeResource=_CubeResource;class ImageBitmapResource extends BaseImageResource{constructor(et,rt){rt=rt||{};let nt,it,at;typeof et=="string"?(nt=ImageBitmapResource.EMPTY,it=et,at=!0):(nt=et,it=null,at=!1),super(nt),this.url=it,this.crossOrigin=rt.crossOrigin??!0,this.alphaMode=typeof rt.alphaMode=="number"?rt.alphaMode:null,this.ownsImageBitmap=rt.ownsImageBitmap??at,this._load=null,rt.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(et,rt)=>{if(this.url===null){et(this);return}try{const nt=await settings.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const it=await nt.blob();if(this.destroyed)return;const at=await createImageBitmap(it,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"});if(this.destroyed){at.close();return}this.source=at,this.update(),et(this)}catch(nt){if(this.destroyed)return;rt(nt),this.onError.emit(nt)}}),this._load)}upload(et,rt,nt){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(rt.alphaMode=this.alphaMode),super.upload(et,rt,nt)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(et){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof et=="string"||et instanceof ImageBitmap)}static get EMPTY(){return ImageBitmapResource._EMPTY=ImageBitmapResource._EMPTY??settings.ADAPTER.createCanvas(0,0),ImageBitmapResource._EMPTY}}const _SVGResource=class Ad extends BaseImageResource{constructor(et,rt){rt=rt||{},super(settings.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=et,this.scale=rt.scale||1,this._overrideWidth=rt.width,this._overrideHeight=rt.height,this._resolve=null,this._crossorigin=rt.crossorigin,this._load=null,rt.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(et=>{if(this._resolve=()=>{this.update(),et(this)},Ad.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const et=new Image;BaseImageResource.crossOrigin(et,this.svg,this._crossorigin),et.src=this.svg,et.onerror=rt=>{this._resolve&&(et.onerror=null,this.onError.emit(rt))},et.onload=()=>{if(!this._resolve)return;const rt=et.width,nt=et.height;if(!rt||!nt)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let it=rt*this.scale,at=nt*this.scale;(this._overrideWidth||this._overrideHeight)&&(it=this._overrideWidth||this._overrideHeight/nt*rt,at=this._overrideHeight||this._overrideWidth/rt*nt),it=Math.round(it),at=Math.round(at);const st=this.source;st.width=it,st.height=at,st._pixiId=`canvas_${uid()}`,st.getContext("2d").drawImage(et,0,0,rt,nt,0,0,it,at),this._resolve(),this._resolve=null}}static getSize(et){const rt=Ad.SVG_SIZE.exec(et),nt={};return rt&&(nt[rt[1]]=Math.round(parseFloat(rt[3])),nt[rt[5]]=Math.round(parseFloat(rt[7]))),nt}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(et,rt){return rt==="svg"||typeof et=="string"&&et.startsWith("data:image/svg+xml")||typeof et=="string"&&Ad.SVG_XML.test(et)}};_SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,_SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let SVGResource=_SVGResource;class VideoFrameResource extends BaseImageResource{constructor(et){super(et)}static test(et){return!!globalThis.VideoFrame&&et instanceof globalThis.VideoFrame}}const _VideoResource=class hf extends BaseImageResource{constructor(et,rt){if(rt=rt||{},!(et instanceof HTMLVideoElement)){const nt=document.createElement("video");rt.autoLoad!==!1&&nt.setAttribute("preload","auto"),rt.playsinline!==!1&&(nt.setAttribute("webkit-playsinline",""),nt.setAttribute("playsinline","")),rt.muted===!0&&(nt.setAttribute("muted",""),nt.muted=!0),rt.loop===!0&&nt.setAttribute("loop",""),rt.autoPlay!==!1&&nt.setAttribute("autoplay",""),typeof et=="string"&&(et=[et]);const it=et[0].src||et[0];BaseImageResource.crossOrigin(nt,it,rt.crossorigin);for(let at=0;at<et.length;++at){const st=document.createElement("source");let{src:ot,mime:lt}=et[at];if(ot=ot||et[at],ot.startsWith("data:"))lt=ot.slice(5,ot.indexOf(";"));else if(!ot.startsWith("blob:")){const ht=ot.split("?").shift().toLowerCase(),dt=ht.slice(ht.lastIndexOf(".")+1);lt=lt||hf.MIME_TYPES[dt]||`video/${dt}`}st.src=ot,lt&&(st.type=lt),nt.appendChild(st)}et=nt}super(et),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=rt.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=rt.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),rt.autoLoad!==!1&&this.load()}update(et=0){if(!this.destroyed){if(this._updateFPS){const rt=Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-rt)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const et=this.source;return(et.readyState===et.HAVE_ENOUGH_DATA||et.readyState===et.HAVE_FUTURE_DATA)&&et.width&&et.height&&(et.complete=!0),et.addEventListener("play",this._onPlayStart),et.addEventListener("pause",this._onPlayStop),et.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(et.addEventListener("canplay",this._onCanPlay),et.addEventListener("canplaythrough",this._onCanPlay),et.addEventListener("error",this._onError,!0)),this._load=new Promise((rt,nt)=>{this.valid?rt(this):(this._resolve=rt,this._reject=nt,et.load())}),this._load}_onError(et){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(et),this._reject&&(this._reject(et),this._reject=null,this._resolve=null)}_isSourcePlaying(){const et=this.source;return!et.paused&&!et.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const et=this.source;et.removeEventListener("canplay",this._onCanPlay),et.removeEventListener("canplaythrough",this._onCanPlay);const rt=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!rt&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&et.play()}dispose(){this._configureAutoUpdate();const et=this.source;et&&(et.removeEventListener("play",this._onPlayStart),et.removeEventListener("pause",this._onPlayStop),et.removeEventListener("seeked",this._onSeeked),et.removeEventListener("canplay",this._onCanPlay),et.removeEventListener("canplaythrough",this._onCanPlay),et.removeEventListener("error",this._onError,!0),et.pause(),et.src="",et.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(et){et!==this._autoUpdate&&(this._autoUpdate=et,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(et){et!==this._updateFPS&&(this._updateFPS=et,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(et,rt){return globalThis.HTMLVideoElement&&et instanceof HTMLVideoElement||hf.TYPES.includes(rt)}};_VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],_VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let VideoResource=_VideoResource;INSTALLED.push(ImageBitmapResource,ImageResource,CanvasResource,VideoResource,VideoFrameResource,SVGResource,BufferResource,CubeResource,ArrayResource);class Bounds{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(et){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:(et=et||new Rectangle(0,0,1,1),et.x=this.minX,et.y=this.minY,et.width=this.maxX-this.minX,et.height=this.maxY-this.minY,et)}addPoint(et){this.minX=Math.min(this.minX,et.x),this.maxX=Math.max(this.maxX,et.x),this.minY=Math.min(this.minY,et.y),this.maxY=Math.max(this.maxY,et.y)}addPointMatrix(et,rt){const{a:nt,b:it,c:at,d:st,tx:ot,ty:lt}=et,ht=nt*rt.x+at*rt.y+ot,dt=it*rt.x+st*rt.y+lt;this.minX=Math.min(this.minX,ht),this.maxX=Math.max(this.maxX,ht),this.minY=Math.min(this.minY,dt),this.maxY=Math.max(this.maxY,dt)}addQuad(et){let rt=this.minX,nt=this.minY,it=this.maxX,at=this.maxY,st=et[0],ot=et[1];rt=st<rt?st:rt,nt=ot<nt?ot:nt,it=st>it?st:it,at=ot>at?ot:at,st=et[2],ot=et[3],rt=st<rt?st:rt,nt=ot<nt?ot:nt,it=st>it?st:it,at=ot>at?ot:at,st=et[4],ot=et[5],rt=st<rt?st:rt,nt=ot<nt?ot:nt,it=st>it?st:it,at=ot>at?ot:at,st=et[6],ot=et[7],rt=st<rt?st:rt,nt=ot<nt?ot:nt,it=st>it?st:it,at=ot>at?ot:at,this.minX=rt,this.minY=nt,this.maxX=it,this.maxY=at}addFrame(et,rt,nt,it,at){this.addFrameMatrix(et.worldTransform,rt,nt,it,at)}addFrameMatrix(et,rt,nt,it,at){const st=et.a,ot=et.b,lt=et.c,ht=et.d,dt=et.tx,ut=et.ty;let ft=this.minX,mt=this.minY,gt=this.maxX,vt=this.maxY,xt=st*rt+lt*nt+dt,wt=ot*rt+ht*nt+ut;ft=xt<ft?xt:ft,mt=wt<mt?wt:mt,gt=xt>gt?xt:gt,vt=wt>vt?wt:vt,xt=st*it+lt*nt+dt,wt=ot*it+ht*nt+ut,ft=xt<ft?xt:ft,mt=wt<mt?wt:mt,gt=xt>gt?xt:gt,vt=wt>vt?wt:vt,xt=st*rt+lt*at+dt,wt=ot*rt+ht*at+ut,ft=xt<ft?xt:ft,mt=wt<mt?wt:mt,gt=xt>gt?xt:gt,vt=wt>vt?wt:vt,xt=st*it+lt*at+dt,wt=ot*it+ht*at+ut,ft=xt<ft?xt:ft,mt=wt<mt?wt:mt,gt=xt>gt?xt:gt,vt=wt>vt?wt:vt,this.minX=ft,this.minY=mt,this.maxX=gt,this.maxY=vt}addVertexData(et,rt,nt){let it=this.minX,at=this.minY,st=this.maxX,ot=this.maxY;for(let lt=rt;lt<nt;lt+=2){const ht=et[lt],dt=et[lt+1];it=ht<it?ht:it,at=dt<at?dt:at,st=ht>st?ht:st,ot=dt>ot?dt:ot}this.minX=it,this.minY=at,this.maxX=st,this.maxY=ot}addVertices(et,rt,nt,it){this.addVerticesMatrix(et.worldTransform,rt,nt,it)}addVerticesMatrix(et,rt,nt,it,at=0,st=at){const ot=et.a,lt=et.b,ht=et.c,dt=et.d,ut=et.tx,ft=et.ty;let mt=this.minX,gt=this.minY,vt=this.maxX,xt=this.maxY;for(let wt=nt;wt<it;wt+=2){const At=rt[wt],Tt=rt[wt+1],Pt=ot*At+ht*Tt+ut,Rt=dt*Tt+lt*At+ft;mt=Math.min(mt,Pt-at),vt=Math.max(vt,Pt+at),gt=Math.min(gt,Rt-st),xt=Math.max(xt,Rt+st)}this.minX=mt,this.minY=gt,this.maxX=vt,this.maxY=xt}addBounds(et){const rt=this.minX,nt=this.minY,it=this.maxX,at=this.maxY;this.minX=et.minX<rt?et.minX:rt,this.minY=et.minY<nt?et.minY:nt,this.maxX=et.maxX>it?et.maxX:it,this.maxY=et.maxY>at?et.maxY:at}addBoundsMask(et,rt){const nt=et.minX>rt.minX?et.minX:rt.minX,it=et.minY>rt.minY?et.minY:rt.minY,at=et.maxX<rt.maxX?et.maxX:rt.maxX,st=et.maxY<rt.maxY?et.maxY:rt.maxY;if(nt<=at&&it<=st){const ot=this.minX,lt=this.minY,ht=this.maxX,dt=this.maxY;this.minX=nt<ot?nt:ot,this.minY=it<lt?it:lt,this.maxX=at>ht?at:ht,this.maxY=st>dt?st:dt}}addBoundsMatrix(et,rt){this.addFrameMatrix(rt,et.minX,et.minY,et.maxX,et.maxY)}addBoundsArea(et,rt){const nt=et.minX>rt.x?et.minX:rt.x,it=et.minY>rt.y?et.minY:rt.y,at=et.maxX<rt.x+rt.width?et.maxX:rt.x+rt.width,st=et.maxY<rt.y+rt.height?et.maxY:rt.y+rt.height;if(nt<=at&&it<=st){const ot=this.minX,lt=this.minY,ht=this.maxX,dt=this.maxY;this.minX=nt<ot?nt:ot,this.minY=it<lt?it:lt,this.maxX=at>ht?at:ht,this.maxY=st>dt?st:dt}}pad(et=0,rt=et){this.isEmpty()||(this.minX-=et,this.maxX+=et,this.minY-=rt,this.maxY+=rt)}addFramePad(et,rt,nt,it,at,st){et-=at,rt-=st,nt+=at,it+=st,this.minX=this.minX<et?this.minX:et,this.maxX=this.maxX>nt?this.maxX:nt,this.minY=this.minY<rt?this.minY:rt,this.maxY=this.maxY>it?this.maxY:it}}class DisplayObject extends EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Transform,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(et){const rt=Object.keys(et);for(let nt=0;nt<rt.length;++nt){const it=rt[nt];Object.defineProperty(DisplayObject.prototype,it,Object.getOwnPropertyDescriptor(et,it))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(et,rt){return et||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),rt||(this._boundsRect||(this._boundsRect=new Rectangle),rt=this._boundsRect),this._bounds.getRectangle(rt)}getLocalBounds(et){et||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),et=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);const rt=this.transform,nt=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=nt?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const it=this._bounds,at=this._boundsID;this._bounds=this._localBounds;const st=this.getBounds(!1,et);return this.parent=nt,this.transform=rt,this._bounds=it,this._bounds.updateID+=this._boundsID-at,st}toGlobal(et,rt,nt=!1){return nt||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(et,rt)}toLocal(et,rt,nt,it){return rt&&(et=rt.toGlobal(et,nt,it)),it||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(et,nt)}setParent(et){if(!et||!et.addChild)throw new Error("setParent: Argument must be a Container");return et.addChild(this),et}removeFromParent(){this.parent?.removeChild(this)}setTransform(et=0,rt=0,nt=1,it=1,at=0,st=0,ot=0,lt=0,ht=0){return this.position.x=et,this.position.y=rt,this.scale.x=nt||1,this.scale.y=it||1,this.rotation=at,this.skew.x=st,this.skew.y=ot,this.pivot.x=lt,this.pivot.y=ht,this}destroy(et){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent}enableTempParent(){const et=this.parent;return this.parent=this._tempDisplayObjectParent,et}disableTempParent(et){this.parent=et}get x(){return this.position.x}set x(et){this.transform.position.x=et}get y(){return this.position.y}set y(et){this.transform.position.y=et}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(et){this.transform.position.copyFrom(et)}get scale(){return this.transform.scale}set scale(et){this.transform.scale.copyFrom(et)}get pivot(){return this.transform.pivot}set pivot(et){this.transform.pivot.copyFrom(et)}get skew(){return this.transform.skew}set skew(et){this.transform.skew.copyFrom(et)}get rotation(){return this.transform.rotation}set rotation(et){this.transform.rotation=et}get angle(){return this.transform.rotation*RAD_TO_DEG}set angle(et){this.transform.rotation=et*DEG_TO_RAD}get zIndex(){return this._zIndex}set zIndex(et){this._zIndex!==et&&(this._zIndex=et,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let et=this;do{if(!et.visible)return!1;et=et.parent}while(et);return!0}get mask(){return this._mask}set mask(et){if(this._mask!==et){if(this._mask){const rt=this._mask.isMaskData?this._mask.maskObject:this._mask;rt&&(rt._maskRefCount--,rt._maskRefCount===0&&(rt.renderable=!0,rt.isMask=!1))}if(this._mask=et,this._mask){const rt=this._mask.isMaskData?this._mask.maskObject:this._mask;rt&&(rt._maskRefCount===0&&(rt.renderable=!1,rt.isMask=!0),rt._maskRefCount++)}}}}class TemporaryDisplayObject extends DisplayObject{constructor(){super(...arguments),this.sortDirty=null}}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;const tempMatrix=new Matrix;function sortChildren(tt,et){return tt.zIndex===et.zIndex?tt._lastSortedIndex-et._lastSortedIndex:tt.zIndex-et.zIndex}const _Container=class df extends DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=df.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(et){}addChild(...et){if(et.length>1)for(let rt=0;rt<et.length;rt++)this.addChild(et[rt]);else{const rt=et[0];rt.parent&&rt.parent.removeChild(rt),rt.parent=this,this.sortDirty=!0,rt.transform._parentID=-1,this.children.push(rt),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",rt,this,this.children.length-1),rt.emit("added",this)}return et[0]}addChildAt(et,rt){if(rt<0||rt>this.children.length)throw new Error(`${et}addChildAt: The index ${rt} supplied is out of bounds ${this.children.length}`);return et.parent&&et.parent.removeChild(et),et.parent=this,this.sortDirty=!0,et.transform._parentID=-1,this.children.splice(rt,0,et),this._boundsID++,this.onChildrenChange(rt),et.emit("added",this),this.emit("childAdded",et,this,rt),et}swapChildren(et,rt){if(et===rt)return;const nt=this.getChildIndex(et),it=this.getChildIndex(rt);this.children[nt]=rt,this.children[it]=et,this.onChildrenChange(nt<it?nt:it)}getChildIndex(et){const rt=this.children.indexOf(et);if(rt===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return rt}setChildIndex(et,rt){if(rt<0||rt>=this.children.length)throw new Error(`The index ${rt} supplied is out of bounds ${this.children.length}`);const nt=this.getChildIndex(et);removeItems(this.children,nt,1),this.children.splice(rt,0,et),this.onChildrenChange(rt)}getChildAt(et){if(et<0||et>=this.children.length)throw new Error(`getChildAt: Index (${et}) does not exist.`);return this.children[et]}removeChild(...et){if(et.length>1)for(let rt=0;rt<et.length;rt++)this.removeChild(et[rt]);else{const rt=et[0],nt=this.children.indexOf(rt);if(nt===-1)return null;rt.parent=null,rt.transform._parentID=-1,removeItems(this.children,nt,1),this._boundsID++,this.onChildrenChange(nt),rt.emit("removed",this),this.emit("childRemoved",rt,this,nt)}return et[0]}removeChildAt(et){const rt=this.getChildAt(et);return rt.parent=null,rt.transform._parentID=-1,removeItems(this.children,et,1),this._boundsID++,this.onChildrenChange(et),rt.emit("removed",this),this.emit("childRemoved",rt,this,et),rt}removeChildren(et=0,rt=this.children.length){const nt=et,it=rt,at=it-nt;let st;if(at>0&&at<=it){st=this.children.splice(nt,at);for(let ot=0;ot<st.length;++ot)st[ot].parent=null,st[ot].transform&&(st[ot].transform._parentID=-1);this._boundsID++,this.onChildrenChange(et);for(let ot=0;ot<st.length;++ot)st[ot].emit("removed",this),this.emit("childRemoved",st[ot],this,ot);return st}else if(at===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let et=!1;for(let rt=0,nt=this.children.length;rt<nt;++rt){const it=this.children[rt];it._lastSortedIndex=rt,!et&&it.zIndex!==0&&(et=!0)}et&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let et=0,rt=this.children.length;et<rt;++et){const nt=this.children[et];nt.visible&&nt.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let et=0;et<this.children.length;et++){const rt=this.children[et];if(!(!rt.visible||!rt.renderable))if(rt.calculateBounds(),rt._mask){const nt=rt._mask.isMaskData?rt._mask.maskObject:rt._mask;nt?(nt.calculateBounds(),this._bounds.addBoundsMask(rt._bounds,nt._bounds)):this._bounds.addBounds(rt._bounds)}else rt.filterArea?this._bounds.addBoundsArea(rt._bounds,rt.filterArea):this._bounds.addBounds(rt._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(et,rt=!1){const nt=super.getLocalBounds(et);if(!rt)for(let it=0,at=this.children.length;it<at;++it){const st=this.children[it];st.visible&&st.updateTransform()}return nt}_calculateBounds(){}_renderWithCulling(et){const rt=et.renderTexture.sourceFrame;if(!(rt.width>0&&rt.height>0))return;let nt,it;this.cullArea?(nt=this.cullArea,it=this.worldTransform):this._render!==df.prototype._render&&(nt=this.getBounds(!0));const at=et.projection.transform;if(at&&(it?(it=tempMatrix.copyFrom(it),it.prepend(at)):it=at),nt&&rt.intersects(nt,it))this._render(et);else if(this.cullArea)return;for(let st=0,ot=this.children.length;st<ot;++st){const lt=this.children[st],ht=lt.cullable;lt.cullable=ht||!this.cullArea,lt.render(et),lt.cullable=ht}}render(et){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(et);else if(this.cullable)this._renderWithCulling(et);else{this._render(et);for(let rt=0,nt=this.children.length;rt<nt;++rt)this.children[rt].render(et)}}renderAdvanced(et){const rt=this.filters,nt=this._mask;if(rt){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let at=0;at<rt.length;at++)rt[at].enabled&&this._enabledFilters.push(rt[at])}const it=rt&&this._enabledFilters?.length||nt&&(!nt.isMaskData||nt.enabled&&(nt.autoDetect||nt.type!==MASK_TYPES.NONE));if(it&&et.batch.flush(),rt&&this._enabledFilters?.length&&et.filter.push(this,this._enabledFilters),nt&&et.mask.push(this,this._mask),this.cullable)this._renderWithCulling(et);else{this._render(et);for(let at=0,st=this.children.length;at<st;++at)this.children[at].render(et)}it&&et.batch.flush(),nt&&et.mask.pop(this),rt&&this._enabledFilters?.length&&et.filter.pop()}_render(et){}destroy(et){super.destroy(),this.sortDirty=!1;const rt=typeof et=="boolean"?et:et?.children,nt=this.removeChildren(0,this.children.length);if(rt)for(let it=0;it<nt.length;++it)nt[it].destroy(et)}get width(){return this.scale.x*this.getLocalBounds().width}set width(et){const rt=this.getLocalBounds().width;rt!==0?this.scale.x=et/rt:this.scale.x=1,this._width=et}get height(){return this.scale.y*this.getLocalBounds().height}set height(et){const rt=this.getLocalBounds().height;rt!==0?this.scale.y=et/rt:this.scale.y=1,this._height=et}};_Container.defaultSortableChildren=!1;let Container=_Container;Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;Object.defineProperties(settings,{SORTABLE_CHILDREN:{get(){return Container.defaultSortableChildren},set(tt){deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Container.defaultSortableChildren=tt}}});const tempPoint$2=new Point$2,indices=new Uint16Array([0,1,2,0,2,3]);class Sprite extends Container{constructor(et){super(),this._anchor=new ObservablePoint(this._onAnchorUpdate,this,et?et.defaultAnchor.x:0,et?et.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Color(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=et||Texture.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=indices,this.pluginName="batch",this.isSprite=!0,this._roundPixels=settings.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const et=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===et._updateID)return;this._textureID!==et._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=et._updateID;const rt=this.transform.worldTransform,nt=rt.a,it=rt.b,at=rt.c,st=rt.d,ot=rt.tx,lt=rt.ty,ht=this.vertexData,dt=et.trim,ut=et.orig,ft=this._anchor;let mt=0,gt=0,vt=0,xt=0;if(dt?(gt=dt.x-ft._x*ut.width,mt=gt+dt.width,xt=dt.y-ft._y*ut.height,vt=xt+dt.height):(gt=-ft._x*ut.width,mt=gt+ut.width,xt=-ft._y*ut.height,vt=xt+ut.height),ht[0]=nt*gt+at*xt+ot,ht[1]=st*xt+it*gt+lt,ht[2]=nt*mt+at*xt+ot,ht[3]=st*xt+it*mt+lt,ht[4]=nt*mt+at*vt+ot,ht[5]=st*vt+it*mt+lt,ht[6]=nt*gt+at*vt+ot,ht[7]=st*vt+it*gt+lt,this._roundPixels){const wt=settings.RESOLUTION;for(let At=0;At<ht.length;++At)ht[At]=Math.round(ht[At]*wt)/wt}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const et=this._texture,rt=this.vertexTrimmedData,nt=et.orig,it=this._anchor,at=this.transform.worldTransform,st=at.a,ot=at.b,lt=at.c,ht=at.d,dt=at.tx,ut=at.ty,ft=-it._x*nt.width,mt=ft+nt.width,gt=-it._y*nt.height,vt=gt+nt.height;if(rt[0]=st*ft+lt*gt+dt,rt[1]=ht*gt+ot*ft+ut,rt[2]=st*mt+lt*gt+dt,rt[3]=ht*gt+ot*mt+ut,rt[4]=st*mt+lt*vt+dt,rt[5]=ht*vt+ot*mt+ut,rt[6]=st*ft+lt*vt+dt,rt[7]=ht*vt+ot*ft+ut,this._roundPixels){const xt=settings.RESOLUTION;for(let wt=0;wt<rt.length;++wt)rt[wt]=Math.round(rt[wt]*xt)/xt}}_render(et){this.calculateVertices(),et.batch.setObjectRenderer(et.plugins[this.pluginName]),et.plugins[this.pluginName].render(this)}_calculateBounds(){const et=this._texture.trim,rt=this._texture.orig;!et||et.width===rt.width&&et.height===rt.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(et){return this.children.length===0?(this._localBounds||(this._localBounds=new Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),et||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),et=this._localBoundsRect),this._localBounds.getRectangle(et)):super.getLocalBounds.call(this,et)}containsPoint(et){this.worldTransform.applyInverse(et,tempPoint$2);const rt=this._texture.orig.width,nt=this._texture.orig.height,it=-rt*this.anchor.x;let at=0;return tempPoint$2.x>=it&&tempPoint$2.x<it+rt&&(at=-nt*this.anchor.y,tempPoint$2.y>=at&&tempPoint$2.y<at+nt)}destroy(et){if(super.destroy(et),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof et=="boolean"?et:et?.texture){const rt=typeof et=="boolean"?et:et?.baseTexture;this._texture.destroy(!!rt)}this._texture=null}static from(et,rt){const nt=et instanceof Texture?et:Texture.from(et,rt);return new Sprite(nt)}set roundPixels(et){this._roundPixels!==et&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=et}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(et){const rt=sign(this.scale.x)||1;this.scale.x=rt*et/this._texture.orig.width,this._width=et}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(et){const rt=sign(this.scale.y)||1;this.scale.y=rt*et/this._texture.orig.height,this._height=et}get anchor(){return this._anchor}set anchor(et){this._anchor.copyFrom(et)}get tint(){return this._tintColor.value}set tint(et){this._tintColor.setValue(et),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(et){this._texture!==et&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=et||Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,et&&(et.baseTexture.valid?this._onTextureUpdate():et.once("update",this._onTextureUpdate,this)))}}const _tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1;DisplayObject.prototype._cacheData=null;DisplayObject.prototype._cacheAsBitmapResolution=null;DisplayObject.prototype._cacheAsBitmapMultisample=null;class CacheData{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(tt){tt!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=tt,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(tt){tt!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=tt,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(tt){if(this._cacheAsBitmap===tt)return;this._cacheAsBitmap=tt;let et;tt?(this._cacheData||(this._cacheData=new CacheData),et=this._cacheData,et.originalRender=this.render,et.originalRenderCanvas=this.renderCanvas,et.originalUpdateTransform=this.updateTransform,et.originalCalculateBounds=this.calculateBounds,et.originalGetLocalBounds=this.getLocalBounds,et.originalDestroy=this.destroy,et.originalContainsPoint=this.containsPoint,et.originalMask=this._mask,et.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(et=this._cacheData,et.sprite&&this._destroyCachedDisplayObject(),this.render=et.originalRender,this.renderCanvas=et.originalRenderCanvas,this.calculateBounds=et.originalCalculateBounds,this.getLocalBounds=et.originalGetLocalBounds,this.destroy=et.originalDestroy,this.updateTransform=et.originalUpdateTransform,this.containsPoint=et.originalContainsPoint,this._mask=et.originalMask,this.filterArea=et.originalFilterArea)}}});DisplayObject.prototype._renderCached=function(tt){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(tt),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(tt))};DisplayObject.prototype._initCachedDisplayObject=function(tt){if(this._cacheData?.sprite)return;const et=this.alpha;this.alpha=1,tt.batch.flush();const rt=this.getLocalBounds(new Rectangle,!0);if(this.filters?.length){const ft=this.filters[0].padding;rt.pad(ft)}const nt=this.cacheAsBitmapResolution||tt.resolution;rt.ceil(nt),rt.width=Math.max(rt.width,1/nt),rt.height=Math.max(rt.height,1/nt);const it=tt.renderTexture.current,at=tt.renderTexture.sourceFrame.clone(),st=tt.renderTexture.destinationFrame.clone(),ot=tt.projection.transform,lt=RenderTexture.create({width:rt.width,height:rt.height,resolution:nt,multisample:this.cacheAsBitmapMultisample??tt.multisample}),ht=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=ht,BaseTexture.addToCache(lt.baseTexture,ht),Texture.addToCache(lt,ht);const dt=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-rt.x,-rt.y);this.render=this._cacheData.originalRender,tt.render(this,{renderTexture:lt,clear:!0,transform:dt,skipUpdateTransform:!1}),tt.framebuffer.blit(),tt.projection.transform=ot,tt.renderTexture.bind(it,at,st),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=et;const ut=new Sprite(lt);ut.transform.worldTransform=this.transform.worldTransform,ut.anchor.x=-(rt.x/rt.width),ut.anchor.y=-(rt.y/rt.height),ut.alpha=et,ut._bounds=this._bounds,this._cacheData.sprite=ut,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=ut.containsPoint.bind(ut)};DisplayObject.prototype._renderCachedCanvas=function(tt){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(tt),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(tt))};DisplayObject.prototype._initCachedDisplayObjectCanvas=function(tt){if(this._cacheData?.sprite)return;const et=this.getLocalBounds(new Rectangle,!0),rt=this.alpha;this.alpha=1;const nt=tt.canvasContext.activeContext,it=tt._projTransform,at=this.cacheAsBitmapResolution||tt.resolution;et.ceil(at),et.width=Math.max(et.width,1/at),et.height=Math.max(et.height,1/at);const st=RenderTexture.create({width:et.width,height:et.height,resolution:at}),ot=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=ot,BaseTexture.addToCache(st.baseTexture,ot),Texture.addToCache(st,ot);const lt=_tempMatrix;this.transform.localTransform.copyTo(lt),lt.invert(),lt.tx-=et.x,lt.ty-=et.y,this.renderCanvas=this._cacheData.originalRenderCanvas,tt.render(this,{renderTexture:st,clear:!0,transform:lt,skipUpdateTransform:!1}),tt.canvasContext.activeContext=nt,tt._projTransform=it,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=rt;const ht=new Sprite(st);ht.transform.worldTransform=this.transform.worldTransform,ht.anchor.x=-(et.x/et.width),ht.anchor.y=-(et.y/et.height),ht.alpha=rt,ht._bounds=this._bounds,this._cacheData.sprite=ht,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=tt._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=ht.containsPoint.bind(ht)};DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};DisplayObject.prototype._cacheAsBitmapDestroy=function(tt){this.cacheAsBitmap=!1,this.destroy(tt)};DisplayObject.prototype.name=null;Container.prototype.getChildByName=function(tt,et){for(let rt=0,nt=this.children.length;rt<nt;rt++)if(this.children[rt].name===tt)return this.children[rt];if(et)for(let rt=0,nt=this.children.length;rt<nt;rt++){const it=this.children[rt];if(!it.getChildByName)continue;const at=it.getChildByName(tt,!0);if(at)return at}return null};DisplayObject.prototype.getGlobalPosition=function(tt=new Point$2,et=!1){return this.parent?this.parent.toGlobal(this.position,tt,et):(tt.x=this.position.x,tt.y=this.position.y),tt};var fragment$6=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class AlphaFilter extends Filter{constructor(et=1){super(defaultVertex,fragment$6,{uAlpha:1}),this.alpha=et}get alpha(){return this.uniforms.uAlpha}set alpha(et){this.uniforms.uAlpha=et}}const GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function generateBlurFragSource(tt){const et=GAUSSIAN_VALUES[tt],rt=et.length;let nt=fragTemplate,it="";const at="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let st;for(let ot=0;ot<tt;ot++){let lt=at.replace("%index%",ot.toString());st=ot,ot>=rt&&(st=tt-ot-1),lt=lt.replace("%value%",et[st].toString()),it+=lt,it+=`
`}return nt=nt.replace("%blur%",it),nt=nt.replace("%size%",tt.toString()),nt}const vertTemplate=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function generateBlurVertSource(tt,et){const rt=Math.ceil(tt/2);let nt=vertTemplate,it="",at;et?at="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":at="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let st=0;st<tt;st++){let ot=at.replace("%index%",st.toString());ot=ot.replace("%sampleIndex%",`${st-(rt-1)}.0`),it+=ot,it+=`
`}return nt=nt.replace("%blur%",it),nt=nt.replace("%size%",tt.toString()),nt}class BlurFilterPass extends Filter{constructor(et,rt=8,nt=4,it=Filter.defaultResolution,at=5){const st=generateBlurVertSource(at,et),ot=generateBlurFragSource(at);super(st,ot),this.horizontal=et,this.resolution=it,this._quality=0,this.quality=nt,this.blur=rt}apply(et,rt,nt,it){if(nt?this.horizontal?this.uniforms.strength=1/nt.width*(nt.width/rt.width):this.uniforms.strength=1/nt.height*(nt.height/rt.height):this.horizontal?this.uniforms.strength=1/et.renderer.width*(et.renderer.width/rt.width):this.uniforms.strength=1/et.renderer.height*(et.renderer.height/rt.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)et.applyFilter(this,rt,nt,it);else{const at=et.getFilterTexture(),st=et.renderer;let ot=rt,lt=at;this.state.blend=!1,et.applyFilter(this,ot,lt,CLEAR_MODES.CLEAR);for(let ht=1;ht<this.passes-1;ht++){et.bindAndClear(ot,CLEAR_MODES.BLIT),this.uniforms.uSampler=lt;const dt=lt;lt=ot,ot=dt,st.shader.bind(this),st.geometry.draw(5)}this.state.blend=!0,et.applyFilter(this,lt,nt,it),et.returnFilterTexture(at)}}get blur(){return this.strength}set blur(et){this.padding=1+Math.abs(et)*2,this.strength=et}get quality(){return this._quality}set quality(et){this._quality=et,this.passes=et}}class BlurFilter extends Filter{constructor(et=8,rt=4,nt=Filter.defaultResolution,it=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new BlurFilterPass(!0,et,rt,nt,it),this.blurYFilter=new BlurFilterPass(!1,et,rt,nt,it),this.resolution=nt,this.quality=rt,this.blur=et,this.repeatEdgePixels=!1}apply(et,rt,nt,it){const at=Math.abs(this.blurXFilter.strength),st=Math.abs(this.blurYFilter.strength);if(at&&st){const ot=et.getFilterTexture();this.blurXFilter.apply(et,rt,ot,CLEAR_MODES.CLEAR),this.blurYFilter.apply(et,ot,nt,it),et.returnFilterTexture(ot)}else st?this.blurYFilter.apply(et,rt,nt,it):this.blurXFilter.apply(et,rt,nt,it)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(et){this.blurXFilter.blur=this.blurYFilter.blur=et,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(et){this.blurXFilter.quality=this.blurYFilter.quality=et}get blurX(){return this.blurXFilter.blur}set blurX(et){this.blurXFilter.blur=et,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(et){this.blurYFilter.blur=et,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(et){this.blurYFilter.blendMode=et}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(et){this._repeatEdgePixels=et,this.updatePadding()}}var fragment$5=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ColorMatrixFilter extends Filter{constructor(){const et={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(defaultFilterVertex,fragment$5,et),this.alpha=1}_loadMatrix(et,rt=!1){let nt=et;rt&&(this._multiply(nt,this.uniforms.m,et),nt=this._colorMatrix(nt)),this.uniforms.m=nt}_multiply(et,rt,nt){return et[0]=rt[0]*nt[0]+rt[1]*nt[5]+rt[2]*nt[10]+rt[3]*nt[15],et[1]=rt[0]*nt[1]+rt[1]*nt[6]+rt[2]*nt[11]+rt[3]*nt[16],et[2]=rt[0]*nt[2]+rt[1]*nt[7]+rt[2]*nt[12]+rt[3]*nt[17],et[3]=rt[0]*nt[3]+rt[1]*nt[8]+rt[2]*nt[13]+rt[3]*nt[18],et[4]=rt[0]*nt[4]+rt[1]*nt[9]+rt[2]*nt[14]+rt[3]*nt[19]+rt[4],et[5]=rt[5]*nt[0]+rt[6]*nt[5]+rt[7]*nt[10]+rt[8]*nt[15],et[6]=rt[5]*nt[1]+rt[6]*nt[6]+rt[7]*nt[11]+rt[8]*nt[16],et[7]=rt[5]*nt[2]+rt[6]*nt[7]+rt[7]*nt[12]+rt[8]*nt[17],et[8]=rt[5]*nt[3]+rt[6]*nt[8]+rt[7]*nt[13]+rt[8]*nt[18],et[9]=rt[5]*nt[4]+rt[6]*nt[9]+rt[7]*nt[14]+rt[8]*nt[19]+rt[9],et[10]=rt[10]*nt[0]+rt[11]*nt[5]+rt[12]*nt[10]+rt[13]*nt[15],et[11]=rt[10]*nt[1]+rt[11]*nt[6]+rt[12]*nt[11]+rt[13]*nt[16],et[12]=rt[10]*nt[2]+rt[11]*nt[7]+rt[12]*nt[12]+rt[13]*nt[17],et[13]=rt[10]*nt[3]+rt[11]*nt[8]+rt[12]*nt[13]+rt[13]*nt[18],et[14]=rt[10]*nt[4]+rt[11]*nt[9]+rt[12]*nt[14]+rt[13]*nt[19]+rt[14],et[15]=rt[15]*nt[0]+rt[16]*nt[5]+rt[17]*nt[10]+rt[18]*nt[15],et[16]=rt[15]*nt[1]+rt[16]*nt[6]+rt[17]*nt[11]+rt[18]*nt[16],et[17]=rt[15]*nt[2]+rt[16]*nt[7]+rt[17]*nt[12]+rt[18]*nt[17],et[18]=rt[15]*nt[3]+rt[16]*nt[8]+rt[17]*nt[13]+rt[18]*nt[18],et[19]=rt[15]*nt[4]+rt[16]*nt[9]+rt[17]*nt[14]+rt[18]*nt[19]+rt[19],et}_colorMatrix(et){const rt=new Float32Array(et);return rt[4]/=255,rt[9]/=255,rt[14]/=255,rt[19]/=255,rt}brightness(et,rt){const nt=[et,0,0,0,0,0,et,0,0,0,0,0,et,0,0,0,0,0,1,0];this._loadMatrix(nt,rt)}tint(et,rt){const[nt,it,at]=Color.shared.setValue(et).toArray(),st=[nt,0,0,0,0,0,it,0,0,0,0,0,at,0,0,0,0,0,1,0];this._loadMatrix(st,rt)}greyscale(et,rt){const nt=[et,et,et,0,0,et,et,et,0,0,et,et,et,0,0,0,0,0,1,0];this._loadMatrix(nt,rt)}blackAndWhite(et){const rt=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(rt,et)}hue(et,rt){et=(et||0)/180*Math.PI;const nt=Math.cos(et),it=Math.sin(et),at=Math.sqrt,st=1/3,ot=at(st),lt=nt+(1-nt)*st,ht=st*(1-nt)-ot*it,dt=st*(1-nt)+ot*it,ut=st*(1-nt)+ot*it,ft=nt+st*(1-nt),mt=st*(1-nt)-ot*it,gt=st*(1-nt)-ot*it,vt=st*(1-nt)+ot*it,xt=nt+st*(1-nt),wt=[lt,ht,dt,0,0,ut,ft,mt,0,0,gt,vt,xt,0,0,0,0,0,1,0];this._loadMatrix(wt,rt)}contrast(et,rt){const nt=(et||0)+1,it=-.5*(nt-1),at=[nt,0,0,0,it,0,nt,0,0,it,0,0,nt,0,it,0,0,0,1,0];this._loadMatrix(at,rt)}saturate(et=0,rt){const nt=et*2/3+1,it=(nt-1)*-.5,at=[nt,it,it,0,0,it,nt,it,0,0,it,it,nt,0,0,0,0,0,1,0];this._loadMatrix(at,rt)}desaturate(){this.saturate(-1)}negative(et){const rt=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(rt,et)}sepia(et){const rt=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(rt,et)}technicolor(et){const rt=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(rt,et)}polaroid(et){const rt=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(rt,et)}toBGR(et){const rt=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(rt,et)}kodachrome(et){const rt=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(rt,et)}browni(et){const rt=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(rt,et)}vintage(et){const rt=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(rt,et)}colorTone(et,rt,nt,it,at){et=et||.2,rt=rt||.15,nt=nt||16770432,it=it||3375104;const st=Color.shared,[ot,lt,ht]=st.setValue(nt).toArray(),[dt,ut,ft]=st.setValue(it).toArray(),mt=[.3,.59,.11,0,0,ot,lt,ht,et,0,dt,ut,ft,rt,0,ot-dt,lt-ut,ht-ft,0,0];this._loadMatrix(mt,at)}night(et,rt){et=et||.1;const nt=[et*-2,-et,0,0,0,-et,0,et,0,0,0,et,et*2,0,0,0,0,0,1,0];this._loadMatrix(nt,rt)}predator(et,rt){const nt=[11.224130630493164*et,-4.794486999511719*et,-2.8746118545532227*et,0*et,.40342438220977783*et,-3.6330697536468506*et,9.193157196044922*et,-2.951810836791992*et,0*et,-1.316135048866272*et,-3.2184197902679443*et,-4.2375030517578125*et,7.476448059082031*et,0*et,.8044459223747253*et,0,0,0,1,0];this._loadMatrix(nt,rt)}lsd(et){const rt=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(rt,et)}reset(){const et=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(et,!1)}get matrix(){return this.uniforms.m}set matrix(et){this.uniforms.m=et}get alpha(){return this.uniforms.uAlpha}set alpha(et){this.uniforms.uAlpha=et}}ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var fragment$4=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,vertex$3=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class DisplacementFilter extends Filter{constructor(et,rt){const nt=new Matrix;et.renderable=!1,super(vertex$3,fragment$4,{mapSampler:et._texture,filterMatrix:nt,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=et,this.maskMatrix=nt,rt==null&&(rt=20),this.scale=new Point$2(rt,rt)}apply(et,rt,nt,it){this.uniforms.filterMatrix=et.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const at=this.maskSprite.worldTransform,st=Math.sqrt(at.a*at.a+at.b*at.b),ot=Math.sqrt(at.c*at.c+at.d*at.d);st!==0&&ot!==0&&(this.uniforms.rotation[0]=at.a/st,this.uniforms.rotation[1]=at.b/st,this.uniforms.rotation[2]=at.c/ot,this.uniforms.rotation[3]=at.d/ot),et.applyFilter(this,rt,nt,it)}get map(){return this.uniforms.mapSampler}set map(et){this.uniforms.mapSampler=et}}var fragment$3=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,vertex$2=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class FXAAFilter extends Filter{constructor(){super(vertex$2,fragment$3)}}var fragment$2=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class NoiseFilter extends Filter{constructor(et=.5,rt=Math.random()){super(defaultFilterVertex,fragment$2,{uNoise:0,uSeed:0}),this.noise=et,this.seed=rt}get noise(){return this.uniforms.uNoise}set noise(et){this.uniforms.uNoise=et}get seed(){return this.uniforms.uSeed}set seed(et){this.uniforms.uSeed=et}}const filters={AlphaFilter,BlurFilter,BlurFilterPass,ColorMatrixFilter,DisplacementFilter,FXAAFilter,NoiseFilter};Object.entries(filters).forEach(([tt,et])=>{Object.defineProperty(filters,tt,{get(){return deprecation("7.1.0",`filters.${tt} has moved to ${tt}`),et}})});class EventsTickerClass{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(et){this.removeTickerListener(),this.events=et,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(et){this._pauseUpdate=et}addTickerListener(){this.tickerAdded||!this.domElement||(Ticker.system.add(this.tickerUpdate,this,UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ticker.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const et=this.events.rootPointerEvent;this.events.supportsTouchEvents&&et.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:et.clientX,clientY:et.clientY}))}tickerUpdate(et){this._deltaTime+=et,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const EventsTicker=new EventsTickerClass;class FederatedEvent{constructor(et){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point$2,this.page=new Point$2,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=et}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(et,rt,nt){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(et,rt,nt,it,at){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client=new Point$2,this.movement=new Point$2,this.offset=new Point$2,this.global=new Point$2,this.screen=new Point$2}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(et,rt,nt){return et.worldTransform.applyInverse(nt||this.global,rt)}getModifierState(et){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(et)}initMouseEvent(et,rt,nt,it,at,st,ot,lt,ht,dt,ut,ft,mt,gt,vt){throw new Error("Method not implemented.")}}class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2;const PROPAGATION_LIMIT=2048,tempHitLocation=new Point$2,tempLocalMapping=new Point$2;class EventBoundary{constructor(et){this.dispatch=new EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=et,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(et,rt){this.mappingTable[et]||(this.mappingTable[et]=[]),this.mappingTable[et].push({fn:rt,priority:0}),this.mappingTable[et].sort((nt,it)=>nt.priority-it.priority)}dispatchEvent(et,rt){et.propagationStopped=!1,et.propagationImmediatelyStopped=!1,this.propagate(et,rt),this.dispatch.emit(rt||et.type,et)}mapEvent(et){if(!this.rootTarget)return;const rt=this.mappingTable[et.type];if(rt)for(let nt=0,it=rt.length;nt<it;nt++)rt[nt].fn(et);else console.warn(`[EventBoundary]: Event mapping not defined for ${et.type}`)}hitTest(et,rt){EventsTicker.pauseUpdate=!0;const nt=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",it=this[nt](this.rootTarget,this.rootTarget.eventMode,tempHitLocation.set(et,rt),this.hitTestFn,this.hitPruneFn);return it&&it[0]}propagate(et,rt){if(!et.target)return;const nt=et.composedPath();et.eventPhase=et.CAPTURING_PHASE;for(let it=0,at=nt.length-1;it<at;it++)if(et.currentTarget=nt[it],this.notifyTarget(et,rt),et.propagationStopped||et.propagationImmediatelyStopped)return;if(et.eventPhase=et.AT_TARGET,et.currentTarget=et.target,this.notifyTarget(et,rt),!(et.propagationStopped||et.propagationImmediatelyStopped)){et.eventPhase=et.BUBBLING_PHASE;for(let it=nt.length-2;it>=0;it--)if(et.currentTarget=nt[it],this.notifyTarget(et,rt),et.propagationStopped||et.propagationImmediatelyStopped)return}}all(et,rt,nt=this._allInteractiveElements){if(nt.length===0)return;et.eventPhase=et.BUBBLING_PHASE;const it=Array.isArray(rt)?rt:[rt];for(let at=nt.length-1;at>=0;at--)it.forEach(st=>{et.currentTarget=nt[at],this.notifyTarget(et,st)})}propagationPath(et){const rt=[et];for(let nt=0;nt<PROPAGATION_LIMIT&&et!==this.rootTarget;nt++){if(!et.parent)throw new Error("Cannot find propagation path to disconnected target");rt.push(et.parent),et=et.parent}return rt.reverse(),rt}hitTestMoveRecursive(et,rt,nt,it,at,st=!1){let ot=!1;if(this._interactivePrune(et))return null;if((et.eventMode==="dynamic"||rt==="dynamic")&&(EventsTicker.pauseUpdate=!1),et.interactiveChildren&&et.children){const dt=et.children;for(let ut=dt.length-1;ut>=0;ut--){const ft=dt[ut],mt=this.hitTestMoveRecursive(ft,this._isInteractive(rt)?rt:ft.eventMode,nt,it,at,st||at(et,nt));if(mt){if(mt.length>0&&!mt[mt.length-1].parent)continue;const gt=et.isInteractive();(mt.length>0||gt)&&(gt&&this._allInteractiveElements.push(et),mt.push(et)),this._hitElements.length===0&&(this._hitElements=mt),ot=!0}}}const lt=this._isInteractive(rt),ht=et.isInteractive();return lt&&ht&&this._allInteractiveElements.push(et),st||this._hitElements.length>0?null:ot?this._hitElements:lt&&!at(et,nt)&&it(et,nt)?ht?[et]:[]:null}hitTestRecursive(et,rt,nt,it,at){if(this._interactivePrune(et)||at(et,nt))return null;if((et.eventMode==="dynamic"||rt==="dynamic")&&(EventsTicker.pauseUpdate=!1),et.interactiveChildren&&et.children){const lt=et.children;for(let ht=lt.length-1;ht>=0;ht--){const dt=lt[ht],ut=this.hitTestRecursive(dt,this._isInteractive(rt)?rt:dt.eventMode,nt,it,at);if(ut){if(ut.length>0&&!ut[ut.length-1].parent)continue;const ft=et.isInteractive();return(ut.length>0||ft)&&ut.push(et),ut}}}const st=this._isInteractive(rt),ot=et.isInteractive();return st&&it(et,nt)?ot?[et]:[]:null}_isInteractive(et){return et==="static"||et==="dynamic"}_interactivePrune(et){return!!(!et||et.isMask||!et.visible||!et.renderable||et.eventMode==="none"||et.eventMode==="passive"&&!et.interactiveChildren||et.isMask)}hitPruneFn(et,rt){if(et.hitArea&&(et.worldTransform.applyInverse(rt,tempLocalMapping),!et.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(et._mask){const nt=et._mask.isMaskData?et._mask.maskObject:et._mask;if(nt&&!nt.containsPoint?.(rt))return!0}return!1}hitTestFn(et,rt){return et.eventMode==="passive"?!1:et.hitArea?!0:et.containsPoint?et.containsPoint(rt):!1}notifyTarget(et,rt){rt=rt??et.type;const nt=`on${rt}`;et.currentTarget[nt]?.(et);const it=et.eventPhase===et.CAPTURING_PHASE||et.eventPhase===et.AT_TARGET?`${rt}capture`:rt;this.notifyListeners(et,it),et.eventPhase===et.AT_TARGET&&this.notifyListeners(et,rt)}mapPointerDown(et){if(!(et instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const rt=this.createPointerEvent(et);if(this.dispatchEvent(rt,"pointerdown"),rt.pointerType==="touch")this.dispatchEvent(rt,"touchstart");else if(rt.pointerType==="mouse"||rt.pointerType==="pen"){const it=rt.button===2;this.dispatchEvent(rt,it?"rightdown":"mousedown")}const nt=this.trackingData(et.pointerId);nt.pressTargetsByButton[et.button]=rt.composedPath(),this.freeEvent(rt)}mapPointerMove(et){if(!(et instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const rt=this.createPointerEvent(et);this._isPointerMoveEvent=!1;const nt=rt.pointerType==="mouse"||rt.pointerType==="pen",it=this.trackingData(et.pointerId),at=this.findMountedTarget(it.overTargets);if(it.overTargets?.length>0&&at!==rt.target){const lt=et.type==="mousemove"?"mouseout":"pointerout",ht=this.createPointerEvent(et,lt,at);if(this.dispatchEvent(ht,"pointerout"),nt&&this.dispatchEvent(ht,"mouseout"),!rt.composedPath().includes(at)){const dt=this.createPointerEvent(et,"pointerleave",at);for(dt.eventPhase=dt.AT_TARGET;dt.target&&!rt.composedPath().includes(dt.target);)dt.currentTarget=dt.target,this.notifyTarget(dt),nt&&this.notifyTarget(dt,"mouseleave"),dt.target=dt.target.parent;this.freeEvent(dt)}this.freeEvent(ht)}if(at!==rt.target){const lt=et.type==="mousemove"?"mouseover":"pointerover",ht=this.clonePointerEvent(rt,lt);this.dispatchEvent(ht,"pointerover"),nt&&this.dispatchEvent(ht,"mouseover");let dt=at?.parent;for(;dt&&dt!==this.rootTarget.parent&&dt!==rt.target;)dt=dt.parent;if(!dt||dt===this.rootTarget.parent){const ut=this.clonePointerEvent(rt,"pointerenter");for(ut.eventPhase=ut.AT_TARGET;ut.target&&ut.target!==at&&ut.target!==this.rootTarget.parent;)ut.currentTarget=ut.target,this.notifyTarget(ut),nt&&this.notifyTarget(ut,"mouseenter"),ut.target=ut.target.parent;this.freeEvent(ut)}this.freeEvent(ht)}const st=[],ot=this.enableGlobalMoveEvents??!0;this.moveOnAll?st.push("pointermove"):this.dispatchEvent(rt,"pointermove"),ot&&st.push("globalpointermove"),rt.pointerType==="touch"&&(this.moveOnAll?st.splice(1,0,"touchmove"):this.dispatchEvent(rt,"touchmove"),ot&&st.push("globaltouchmove")),nt&&(this.moveOnAll?st.splice(1,0,"mousemove"):this.dispatchEvent(rt,"mousemove"),ot&&st.push("globalmousemove"),this.cursor=rt.target?.cursor),st.length>0&&this.all(rt,st),this._allInteractiveElements.length=0,this._hitElements.length=0,it.overTargets=rt.composedPath(),this.freeEvent(rt)}mapPointerOver(et){if(!(et instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const rt=this.trackingData(et.pointerId),nt=this.createPointerEvent(et),it=nt.pointerType==="mouse"||nt.pointerType==="pen";this.dispatchEvent(nt,"pointerover"),it&&this.dispatchEvent(nt,"mouseover"),nt.pointerType==="mouse"&&(this.cursor=nt.target?.cursor);const at=this.clonePointerEvent(nt,"pointerenter");for(at.eventPhase=at.AT_TARGET;at.target&&at.target!==this.rootTarget.parent;)at.currentTarget=at.target,this.notifyTarget(at),it&&this.notifyTarget(at,"mouseenter"),at.target=at.target.parent;rt.overTargets=nt.composedPath(),this.freeEvent(nt),this.freeEvent(at)}mapPointerOut(et){if(!(et instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const rt=this.trackingData(et.pointerId);if(rt.overTargets){const nt=et.pointerType==="mouse"||et.pointerType==="pen",it=this.findMountedTarget(rt.overTargets),at=this.createPointerEvent(et,"pointerout",it);this.dispatchEvent(at),nt&&this.dispatchEvent(at,"mouseout");const st=this.createPointerEvent(et,"pointerleave",it);for(st.eventPhase=st.AT_TARGET;st.target&&st.target!==this.rootTarget.parent;)st.currentTarget=st.target,this.notifyTarget(st),nt&&this.notifyTarget(st,"mouseleave"),st.target=st.target.parent;rt.overTargets=null,this.freeEvent(at),this.freeEvent(st)}this.cursor=null}mapPointerUp(et){if(!(et instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const rt=performance.now(),nt=this.createPointerEvent(et);if(this.dispatchEvent(nt,"pointerup"),nt.pointerType==="touch")this.dispatchEvent(nt,"touchend");else if(nt.pointerType==="mouse"||nt.pointerType==="pen"){const ot=nt.button===2;this.dispatchEvent(nt,ot?"rightup":"mouseup")}const it=this.trackingData(et.pointerId),at=this.findMountedTarget(it.pressTargetsByButton[et.button]);let st=at;if(at&&!nt.composedPath().includes(at)){let ot=at;for(;ot&&!nt.composedPath().includes(ot);){if(nt.currentTarget=ot,this.notifyTarget(nt,"pointerupoutside"),nt.pointerType==="touch")this.notifyTarget(nt,"touchendoutside");else if(nt.pointerType==="mouse"||nt.pointerType==="pen"){const lt=nt.button===2;this.notifyTarget(nt,lt?"rightupoutside":"mouseupoutside")}ot=ot.parent}delete it.pressTargetsByButton[et.button],st=ot}if(st){const ot=this.clonePointerEvent(nt,"click");ot.target=st,ot.path=null,it.clicksByButton[et.button]||(it.clicksByButton[et.button]={clickCount:0,target:ot.target,timeStamp:rt});const lt=it.clicksByButton[et.button];if(lt.target===ot.target&&rt-lt.timeStamp<200?++lt.clickCount:lt.clickCount=1,lt.target=ot.target,lt.timeStamp=rt,ot.detail=lt.clickCount,ot.pointerType==="mouse"){const ht=ot.button===2;this.dispatchEvent(ot,ht?"rightclick":"click")}else ot.pointerType==="touch"&&this.dispatchEvent(ot,"tap");this.dispatchEvent(ot,"pointertap"),this.freeEvent(ot)}this.freeEvent(nt)}mapPointerUpOutside(et){if(!(et instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const rt=this.trackingData(et.pointerId),nt=this.findMountedTarget(rt.pressTargetsByButton[et.button]),it=this.createPointerEvent(et);if(nt){let at=nt;for(;at;)it.currentTarget=at,this.notifyTarget(it,"pointerupoutside"),it.pointerType==="touch"?this.notifyTarget(it,"touchendoutside"):(it.pointerType==="mouse"||it.pointerType==="pen")&&this.notifyTarget(it,it.button===2?"rightupoutside":"mouseupoutside"),at=at.parent;delete rt.pressTargetsByButton[et.button]}this.freeEvent(it)}mapWheel(et){if(!(et instanceof FederatedWheelEvent)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const rt=this.createWheelEvent(et);this.dispatchEvent(rt),this.freeEvent(rt)}findMountedTarget(et){if(!et)return null;let rt=et[0];for(let nt=1;nt<et.length&&et[nt].parent===rt;nt++)rt=et[nt];return rt}createPointerEvent(et,rt,nt){const it=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(et,it),this.copyMouseData(et,it),this.copyData(et,it),it.nativeEvent=et.nativeEvent,it.originalEvent=et,it.target=nt??this.hitTest(it.global.x,it.global.y)??this._hitElements[0],typeof rt=="string"&&(it.type=rt),it}createWheelEvent(et){const rt=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(et,rt),this.copyMouseData(et,rt),this.copyData(et,rt),rt.nativeEvent=et.nativeEvent,rt.originalEvent=et,rt.target=this.hitTest(rt.global.x,rt.global.y),rt}clonePointerEvent(et,rt){const nt=this.allocateEvent(FederatedPointerEvent);return nt.nativeEvent=et.nativeEvent,nt.originalEvent=et.originalEvent,this.copyPointerData(et,nt),this.copyMouseData(et,nt),this.copyData(et,nt),nt.target=et.target,nt.path=et.composedPath().slice(),nt.type=rt??nt.type,nt}copyWheelData(et,rt){rt.deltaMode=et.deltaMode,rt.deltaX=et.deltaX,rt.deltaY=et.deltaY,rt.deltaZ=et.deltaZ}copyPointerData(et,rt){et instanceof FederatedPointerEvent&&rt instanceof FederatedPointerEvent&&(rt.pointerId=et.pointerId,rt.width=et.width,rt.height=et.height,rt.isPrimary=et.isPrimary,rt.pointerType=et.pointerType,rt.pressure=et.pressure,rt.tangentialPressure=et.tangentialPressure,rt.tiltX=et.tiltX,rt.tiltY=et.tiltY,rt.twist=et.twist)}copyMouseData(et,rt){et instanceof FederatedMouseEvent&&rt instanceof FederatedMouseEvent&&(rt.altKey=et.altKey,rt.button=et.button,rt.buttons=et.buttons,rt.client.copyFrom(et.client),rt.ctrlKey=et.ctrlKey,rt.metaKey=et.metaKey,rt.movement.copyFrom(et.movement),rt.screen.copyFrom(et.screen),rt.shiftKey=et.shiftKey,rt.global.copyFrom(et.global))}copyData(et,rt){rt.isTrusted=et.isTrusted,rt.srcElement=et.srcElement,rt.timeStamp=performance.now(),rt.type=et.type,rt.detail=et.detail,rt.view=et.view,rt.which=et.which,rt.layer.copyFrom(et.layer),rt.page.copyFrom(et.page)}trackingData(et){return this.mappingState.trackingData[et]||(this.mappingState.trackingData[et]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[et]}allocateEvent(et){this.eventPool.has(et)||this.eventPool.set(et,[]);const rt=this.eventPool.get(et).pop()||new et(this);return rt.eventPhase=rt.NONE,rt.currentTarget=null,rt.path=null,rt.target=null,rt}freeEvent(et){if(et.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const rt=et.constructor;this.eventPool.has(rt)||this.eventPool.set(rt,[]),this.eventPool.get(rt).push(et)}notifyListeners(et,rt){const nt=et.currentTarget._events[rt];if(nt&&et.currentTarget.isInteractive())if("fn"in nt)nt.once&&et.currentTarget.removeListener(rt,nt.fn,void 0,!0),nt.fn.call(nt.context,et);else for(let it=0,at=nt.length;it<at&&!et.propagationImmediatelyStopped;it++)nt[it].once&&et.currentTarget.removeListener(rt,nt[it].fn,void 0,!0),nt[it].fn.call(nt[it].context,et)}}const MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},_EventSystem=class ff{constructor(et){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=et,this.rootBoundary=new EventBoundary(null),EventsTicker.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...ff.defaultEventFeatures},{set:(rt,nt,it)=>(nt==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=it),rt[nt]=it,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(et){const{view:rt,resolution:nt}=this.renderer;this.setTargetElement(rt),this.resolution=nt,ff._defaultEventMode=et.eventMode??"auto",Object.assign(this.features,et.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(et){this.resolution=et}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(et){et=et||"default";let rt=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(rt=!1),this.currentCursor===et)return;this.currentCursor=et;const nt=this.cursorStyles[et];if(nt)switch(typeof nt){case"string":rt&&(this.domElement.style.cursor=nt);break;case"function":nt(et);break;case"object":rt&&Object.assign(this.domElement.style,nt);break}else rt&&typeof et=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,et)&&(this.domElement.style.cursor=et)}get pointer(){return this.rootPointerEvent}onPointerDown(et){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const rt=this.normalizeToPointerData(et);this.autoPreventDefault&&rt[0].isNormalized&&(et.cancelable||!("cancelable"in et))&&et.preventDefault();for(let nt=0,it=rt.length;nt<it;nt++){const at=rt[nt],st=this.bootstrapEvent(this.rootPointerEvent,at);this.rootBoundary.mapEvent(st)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(et){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,EventsTicker.pointerMoved();const rt=this.normalizeToPointerData(et);for(let nt=0,it=rt.length;nt<it;nt++){const at=this.bootstrapEvent(this.rootPointerEvent,rt[nt]);this.rootBoundary.mapEvent(at)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(et){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let rt=et.target;et.composedPath&&et.composedPath().length>0&&(rt=et.composedPath()[0]);const nt=rt!==this.domElement?"outside":"",it=this.normalizeToPointerData(et);for(let at=0,st=it.length;at<st;at++){const ot=this.bootstrapEvent(this.rootPointerEvent,it[at]);ot.type+=nt,this.rootBoundary.mapEvent(ot)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(et){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const rt=this.normalizeToPointerData(et);for(let nt=0,it=rt.length;nt<it;nt++){const at=this.bootstrapEvent(this.rootPointerEvent,rt[nt]);this.rootBoundary.mapEvent(at)}this.setCursor(this.rootBoundary.cursor)}onWheel(et){if(!this.features.wheel)return;const rt=this.normalizeWheelEvent(et);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(rt)}setTargetElement(et){this.removeEvents(),this.domElement=et,EventsTicker.domElement=et,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;EventsTicker.addTickerListener();const et=this.domElement.style;et&&(globalThis.navigator.msPointerEnabled?(et.msContentZooming="none",et.msTouchAction="none"):this.supportsPointerEvents&&(et.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;EventsTicker.removeTickerListener();const et=this.domElement.style;globalThis.navigator.msPointerEnabled?(et.msContentZooming="",et.msTouchAction=""):this.supportsPointerEvents&&(et.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(et,rt,nt){const it=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},at=1/this.resolution;et.x=(rt-it.left)*(this.domElement.width/it.width)*at,et.y=(nt-it.top)*(this.domElement.height/it.height)*at}normalizeToPointerData(et){const rt=[];if(this.supportsTouchEvents&&et instanceof TouchEvent)for(let nt=0,it=et.changedTouches.length;nt<it;nt++){const at=et.changedTouches[nt];typeof at.button>"u"&&(at.button=0),typeof at.buttons>"u"&&(at.buttons=1),typeof at.isPrimary>"u"&&(at.isPrimary=et.touches.length===1&&et.type==="touchstart"),typeof at.width>"u"&&(at.width=at.radiusX||1),typeof at.height>"u"&&(at.height=at.radiusY||1),typeof at.tiltX>"u"&&(at.tiltX=0),typeof at.tiltY>"u"&&(at.tiltY=0),typeof at.pointerType>"u"&&(at.pointerType="touch"),typeof at.pointerId>"u"&&(at.pointerId=at.identifier||0),typeof at.pressure>"u"&&(at.pressure=at.force||.5),typeof at.twist>"u"&&(at.twist=0),typeof at.tangentialPressure>"u"&&(at.tangentialPressure=0),typeof at.layerX>"u"&&(at.layerX=at.offsetX=at.clientX),typeof at.layerY>"u"&&(at.layerY=at.offsetY=at.clientY),at.isNormalized=!0,at.type=et.type,rt.push(at)}else if(!globalThis.MouseEvent||et instanceof MouseEvent&&(!this.supportsPointerEvents||!(et instanceof globalThis.PointerEvent))){const nt=et;typeof nt.isPrimary>"u"&&(nt.isPrimary=!0),typeof nt.width>"u"&&(nt.width=1),typeof nt.height>"u"&&(nt.height=1),typeof nt.tiltX>"u"&&(nt.tiltX=0),typeof nt.tiltY>"u"&&(nt.tiltY=0),typeof nt.pointerType>"u"&&(nt.pointerType="mouse"),typeof nt.pointerId>"u"&&(nt.pointerId=MOUSE_POINTER_ID),typeof nt.pressure>"u"&&(nt.pressure=.5),typeof nt.twist>"u"&&(nt.twist=0),typeof nt.tangentialPressure>"u"&&(nt.tangentialPressure=0),nt.isNormalized=!0,rt.push(nt)}else rt.push(et);return rt}normalizeWheelEvent(et){const rt=this.rootWheelEvent;return this.transferMouseData(rt,et),rt.deltaX=et.deltaX,rt.deltaY=et.deltaY,rt.deltaZ=et.deltaZ,rt.deltaMode=et.deltaMode,this.mapPositionToPoint(rt.screen,et.clientX,et.clientY),rt.global.copyFrom(rt.screen),rt.offset.copyFrom(rt.screen),rt.nativeEvent=et,rt.type=et.type,rt}bootstrapEvent(et,rt){return et.originalEvent=null,et.nativeEvent=rt,et.pointerId=rt.pointerId,et.width=rt.width,et.height=rt.height,et.isPrimary=rt.isPrimary,et.pointerType=rt.pointerType,et.pressure=rt.pressure,et.tangentialPressure=rt.tangentialPressure,et.tiltX=rt.tiltX,et.tiltY=rt.tiltY,et.twist=rt.twist,this.transferMouseData(et,rt),this.mapPositionToPoint(et.screen,rt.clientX,rt.clientY),et.global.copyFrom(et.screen),et.offset.copyFrom(et.screen),et.isTrusted=rt.isTrusted,et.type==="pointerleave"&&(et.type="pointerout"),et.type.startsWith("mouse")&&(et.type=et.type.replace("mouse","pointer")),et.type.startsWith("touch")&&(et.type=TOUCH_TO_POINTER[et.type]||et.type),et}transferMouseData(et,rt){et.isTrusted=rt.isTrusted,et.srcElement=rt.srcElement,et.timeStamp=performance.now(),et.type=rt.type,et.altKey=rt.altKey,et.button=rt.button,et.buttons=rt.buttons,et.client.x=rt.clientX,et.client.y=rt.clientY,et.ctrlKey=rt.ctrlKey,et.metaKey=rt.metaKey,et.movement.x=rt.movementX,et.movement.y=rt.movementY,et.page.x=rt.pageX,et.page.y=rt.pageY,et.relatedTarget=null,et.shiftKey=rt.shiftKey}};_EventSystem.extension={name:"events",type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem]},_EventSystem.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let EventSystem=_EventSystem;extensions$1.add(EventSystem);function convertEventModeToInteractiveMode(tt){return tt==="dynamic"||tt==="static"}const FederatedDisplayObject={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??convertEventModeToInteractiveMode(EventSystem.defaultEventMode)},set interactive(tt){deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=tt,this.eventMode=tt?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??EventSystem.defaultEventMode},set eventMode(tt){this._internalInteractive=convertEventModeToInteractiveMode(tt),this._internalEventMode=tt},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(tt,et,rt){const nt=typeof rt=="boolean"&&rt||typeof rt=="object"&&rt.capture,it=typeof rt=="object"?rt.signal:void 0,at=typeof rt=="object"?rt.once===!0:!1,st=typeof et=="function"?void 0:et;tt=nt?`${tt}capture`:tt;const ot=typeof et=="function"?et:et.handleEvent,lt=this;it&&it.addEventListener("abort",()=>{lt.off(tt,ot,st)}),at?lt.once(tt,ot,st):lt.on(tt,ot,st)},removeEventListener(tt,et,rt){const nt=typeof rt=="boolean"&&rt||typeof rt=="object"&&rt.capture,it=typeof et=="function"?void 0:et;tt=nt?`${tt}capture`:tt,et=typeof et=="function"?et:et.handleEvent,this.off(tt,et,it)},dispatchEvent(tt){if(!(tt instanceof FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return tt.defaultPrevented=!1,tt.path=null,tt.target=this,tt.manager.dispatchEvent(tt),!tt.defaultPrevented}};DisplayObject.mixin(FederatedDisplayObject);const accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};DisplayObject.mixin(accessibleTarget);const KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2;class AccessibilityManager{constructor(et){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile.tablet||isMobile.phone)&&this.createTouchHook();const rt=document.createElement("div");rt.style.width=`${DIV_TOUCH_SIZE}px`,rt.style.height=`${DIV_TOUCH_SIZE}px`,rt.style.position="absolute",rt.style.top=`${DIV_TOUCH_POS_X}px`,rt.style.left=`${DIV_TOUCH_POS_Y}px`,rt.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=rt,this.renderer=et,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const et=document.createElement("button");et.style.width=`${DIV_HOOK_SIZE}px`,et.style.height=`${DIV_HOOK_SIZE}px`,et.style.position="absolute",et.style.top=`${DIV_HOOK_POS_X}px`,et.style.left=`${DIV_HOOK_POS_Y}px`,et.style.zIndex=DIV_HOOK_ZINDEX.toString(),et.style.backgroundColor="#FF0000",et.title="select to enable accessibility for this content",et.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(et),this._hookDiv=et}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(et){if(!et.visible||!et.accessibleChildren)return;et.accessible&&et.isInteractive()&&(et._accessibleActive||this.addChild(et),et.renderId=this.renderId);const rt=et.children;if(rt)for(let nt=0;nt<rt.length;nt++)this.updateAccessibleObjects(rt[nt])}update(){const et=performance.now();if(isMobile.android.device&&et<this.androidUpdateCount||(this.androidUpdateCount=et+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:rt,y:nt,width:it,height:at}=this.renderer.view.getBoundingClientRect(),{width:st,height:ot,resolution:lt}=this.renderer,ht=it/st*lt,dt=at/ot*lt;let ut=this.div;ut.style.left=`${rt}px`,ut.style.top=`${nt}px`,ut.style.width=`${st}px`,ut.style.height=`${ot}px`;for(let ft=0;ft<this.children.length;ft++){const mt=this.children[ft];if(mt.renderId!==this.renderId)mt._accessibleActive=!1,removeItems(this.children,ft,1),this.div.removeChild(mt._accessibleDiv),this.pool.push(mt._accessibleDiv),mt._accessibleDiv=null,ft--;else{ut=mt._accessibleDiv;let gt=mt.hitArea;const vt=mt.worldTransform;mt.hitArea?(ut.style.left=`${(vt.tx+gt.x*vt.a)*ht}px`,ut.style.top=`${(vt.ty+gt.y*vt.d)*dt}px`,ut.style.width=`${gt.width*vt.a*ht}px`,ut.style.height=`${gt.height*vt.d*dt}px`):(gt=mt.getBounds(),this.capHitArea(gt),ut.style.left=`${gt.x*ht}px`,ut.style.top=`${gt.y*dt}px`,ut.style.width=`${gt.width*ht}px`,ut.style.height=`${gt.height*dt}px`,ut.title!==mt.accessibleTitle&&mt.accessibleTitle!==null&&(ut.title=mt.accessibleTitle),ut.getAttribute("aria-label")!==mt.accessibleHint&&mt.accessibleHint!==null&&ut.setAttribute("aria-label",mt.accessibleHint)),(mt.accessibleTitle!==ut.title||mt.tabIndex!==ut.tabIndex)&&(ut.title=mt.accessibleTitle,ut.tabIndex=mt.tabIndex,this.debug&&this.updateDebugHTML(ut))}}this.renderId++}updateDebugHTML(et){et.innerHTML=`type: ${et.type}</br> title : ${et.title}</br> tabIndex: ${et.tabIndex}`}capHitArea(et){et.x<0&&(et.width+=et.x,et.x=0),et.y<0&&(et.height+=et.y,et.y=0);const{width:rt,height:nt}=this.renderer;et.x+et.width>rt&&(et.width=rt-et.x),et.y+et.height>nt&&(et.height=nt-et.y)}addChild(et){let rt=this.pool.pop();rt||(rt=document.createElement("button"),rt.style.width=`${DIV_TOUCH_SIZE}px`,rt.style.height=`${DIV_TOUCH_SIZE}px`,rt.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",rt.style.position="absolute",rt.style.zIndex=DIV_TOUCH_ZINDEX.toString(),rt.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?rt.setAttribute("aria-live","off"):rt.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?rt.setAttribute("aria-relevant","additions"):rt.setAttribute("aria-relevant","text"),rt.addEventListener("click",this._onClick.bind(this)),rt.addEventListener("focus",this._onFocus.bind(this)),rt.addEventListener("focusout",this._onFocusOut.bind(this))),rt.style.pointerEvents=et.accessiblePointerEvents,rt.type=et.accessibleType,et.accessibleTitle&&et.accessibleTitle!==null?rt.title=et.accessibleTitle:(!et.accessibleHint||et.accessibleHint===null)&&(rt.title=`displayObject ${et.tabIndex}`),et.accessibleHint&&et.accessibleHint!==null&&rt.setAttribute("aria-label",et.accessibleHint),this.debug&&this.updateDebugHTML(rt),et._accessibleActive=!0,et._accessibleDiv=rt,rt.displayObject=et,this.children.push(et),this.div.appendChild(et._accessibleDiv),et._accessibleDiv.tabIndex=et.tabIndex}_dispatchEvent(et,rt){const{displayObject:nt}=et.target,it=this.renderer.events.rootBoundary,at=Object.assign(new FederatedEvent(it),{target:nt});it.rootTarget=this.renderer.lastObjectRendered,rt.forEach(st=>it.dispatchEvent(at,st))}_onClick(et){this._dispatchEvent(et,["click","pointertap","tap"])}_onFocus(et){et.target.getAttribute("aria-live")||et.target.setAttribute("aria-live","assertive"),this._dispatchEvent(et,["mouseover"])}_onFocusOut(et){et.target.getAttribute("aria-live")||et.target.setAttribute("aria-live","polite"),this._dispatchEvent(et,["mouseout"])}_onKeyDown(et){et.keyCode===KEY_CODE_TAB&&this.activate()}_onMouseMove(et){et.movementX===0&&et.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}AccessibilityManager.extension={name:"accessibility",type:[ExtensionType.RendererPlugin,ExtensionType.CanvasRendererPlugin]};extensions$1.add(AccessibilityManager);const _Application=class pf{constructor(et){this.stage=new Container,et=Object.assign({forceCanvas:!1},et),this.renderer=autoDetectRenderer(et),pf._plugins.forEach(rt=>{rt.init.call(this,et)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(et,rt){const nt=pf._plugins.slice(0);nt.reverse(),nt.forEach(it=>{it.destroy.call(this)}),this.stage.destroy(rt),this.stage=null,this.renderer.destroy(et),this.renderer=null}};_Application._plugins=[];let Application=_Application;extensions$1.handleByList(ExtensionType.Application,Application._plugins);class ResizePlugin{static init(et){Object.defineProperty(this,"resizeTo",{set(rt){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=rt,rt&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let rt,nt;if(this._resizeTo===globalThis.window)rt=globalThis.innerWidth,nt=globalThis.innerHeight;else{const{clientWidth:it,clientHeight:at}=this._resizeTo;rt=it,nt=at}this.renderer.resize(rt,nt),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=et.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ResizePlugin.extension=ExtensionType.Application;extensions$1.add(ResizePlugin);const assetKeyMap={loader:ExtensionType.LoadParser,resolver:ExtensionType.ResolveParser,cache:ExtensionType.CacheParser,detection:ExtensionType.DetectionParser};extensions$1.handle(ExtensionType.Asset,tt=>{const et=tt.ref;Object.entries(assetKeyMap).filter(([rt])=>!!et[rt]).forEach(([rt,nt])=>extensions$1.add(Object.assign(et[rt],{extension:et[rt].extension??nt})))},tt=>{const et=tt.ref;Object.keys(assetKeyMap).filter(rt=>!!et[rt]).forEach(rt=>extensions$1.remove(et[rt]))});class BackgroundLoader{constructor(et,rt=!1){this._loader=et,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=rt}add(et){et.forEach(rt=>{this._assetList.push(rt)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const et=[],rt=Math.min(this._assetList.length,this._maxConcurrent);for(let nt=0;nt<rt;nt++)et.push(this._assetList.pop());await this._loader.load(et),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(et){this._isActive!==et&&(this._isActive=et,et&&!this._isLoading&&this._next())}}function checkDataUrl(tt,et){if(Array.isArray(et)){for(const rt of et)if(tt.startsWith(`data:${rt}`))return!0;return!1}return tt.startsWith(`data:${et}`)}function checkExtension(tt,et){const rt=tt.split("?")[0],nt=path.extname(rt).toLowerCase();return Array.isArray(et)?et.includes(nt):nt===et}const convertToList=(tt,et,rt=!1)=>(Array.isArray(tt)||(tt=[tt]),et?tt.map(nt=>typeof nt=="string"||rt?et(nt):nt):tt),copySearchParams=(tt,et)=>{const rt=et.split("?")[1];return rt&&(tt+=`?${rt}`),tt};function processX(tt,et,rt,nt,it){const at=et[rt];for(let st=0;st<at.length;st++){const ot=at[st];rt<et.length-1?processX(tt.replace(nt[rt],ot),et,rt+1,nt,it):it.push(tt.replace(nt[rt],ot))}}function createStringVariations(tt){const et=/\{(.*?)\}/g,rt=tt.match(et),nt=[];if(rt){const it=[];rt.forEach(at=>{const st=at.substring(1,at.length-1).split(",");it.push(st)}),processX(tt,it,0,rt,nt)}else nt.push(tt);return nt}const isSingleItem=tt=>!Array.isArray(tt);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(et){return this._cache.has(et)}get(et){const rt=this._cache.get(et);return rt||console.warn(`[Assets] Asset id ${et} was not found in the Cache`),rt}set(et,rt){const nt=convertToList(et);let it;for(let ot=0;ot<this.parsers.length;ot++){const lt=this.parsers[ot];if(lt.test(rt)){it=lt.getCacheableAssets(nt,rt);break}}it||(it={},nt.forEach(ot=>{it[ot]=rt}));const at=Object.keys(it),st={cacheKeys:at,keys:nt};if(nt.forEach(ot=>{this._cacheMap.set(ot,st)}),at.forEach(ot=>{const lt=it?it[ot]:rt;this._cache.has(ot)&&this._cache.get(ot)!==lt&&console.warn("[Cache] already has key:",ot),this._cache.set(ot,it[ot])}),rt instanceof Texture){const ot=rt;nt.forEach(lt=>{ot.baseTexture!==Texture.EMPTY.baseTexture&&BaseTexture.addToCache(ot.baseTexture,lt),Texture.addToCache(ot,lt)})}}remove(et){if(!this._cacheMap.has(et)){console.warn(`[Assets] Asset id ${et} was not found in the Cache`);return}const rt=this._cacheMap.get(et);rt.cacheKeys.forEach(nt=>{this._cache.delete(nt)}),rt.keys.forEach(nt=>{this._cacheMap.delete(nt)})}get parsers(){return this._parsers}}const Cache=new CacheClass;class Loader{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(et,rt,nt)=>(this._parsersValidated=!1,et[rt]=nt,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(et,rt){const nt={promise:null,parser:null};return nt.promise=(async()=>{let it=null,at=null;if(rt.loadParser&&(at=this._parserHash[rt.loadParser],at||console.warn(`[Assets] specified load parser "${rt.loadParser}" not found while loading ${et}`)),!at){for(let st=0;st<this.parsers.length;st++){const ot=this.parsers[st];if(ot.load&&ot.test?.(et,rt,this)){at=ot;break}}if(!at)return console.warn(`[Assets] ${et} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}it=await at.load(et,rt,this),nt.parser=at;for(let st=0;st<this.parsers.length;st++){const ot=this.parsers[st];ot.parse&&ot.parse&&await ot.testParse?.(it,rt,this)&&(it=await ot.parse(it,rt,this)||it,nt.parser=ot)}return it})(),nt}async load(et,rt){this._parsersValidated||this._validateParsers();let nt=0;const it={},at=isSingleItem(et),st=convertToList(et,ht=>({alias:[ht],src:ht})),ot=st.length,lt=st.map(async ht=>{const dt=path.toAbsolute(ht.src);if(!it[ht.src])try{this.promiseCache[dt]||(this.promiseCache[dt]=this._getLoadPromiseAndParser(dt,ht)),it[ht.src]=await this.promiseCache[dt].promise,rt&&rt(++nt/ot)}catch(ut){throw delete this.promiseCache[dt],delete it[ht.src],new Error(`[Loader.load] Failed to load ${dt}.
${ut}`)}});return await Promise.all(lt),at?it[st[0].src]:it}async unload(et){const rt=convertToList(et,nt=>({alias:[nt],src:nt})).map(async nt=>{const it=path.toAbsolute(nt.src),at=this.promiseCache[it];if(at){const st=await at.promise;delete this.promiseCache[it],at.parser?.unload?.(st,nt,this)}});await Promise.all(rt)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(et=>et.name).reduce((et,rt)=>(et[rt.name]&&console.warn(`[Assets] loadParser name conflict "${rt.name}"`),{...et,[rt.name]:rt}),{})}}var LoaderParserPriority=(tt=>(tt[tt.Low=0]="Low",tt[tt.Normal=1]="Normal",tt[tt.High=2]="High",tt))(LoaderParserPriority||{});const validJSONExtension=".json",validJSONMIME="application/json",loadJson={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadJson",test(tt){return checkDataUrl(tt,validJSONMIME)||checkExtension(tt,validJSONExtension)},async load(tt){return await(await settings.ADAPTER.fetch(tt)).json()}};extensions$1.add(loadJson);const validTXTExtension=".txt",validTXTMIME="text/plain",loadTxt={name:"loadTxt",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(tt){return checkDataUrl(tt,validTXTMIME)||checkExtension(tt,validTXTExtension)},async load(tt){return await(await settings.ADAPTER.fetch(tt)).text()}};extensions$1.add(loadTxt);const validWeights=["normal","bold","100","200","300","400","500","600","700","800","900"],validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"],CSS_IDENT_TOKEN_REGEX=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function getFontFamilyName(tt){const et=path.extname(tt),rt=path.basename(tt,et).replace(/(-|_)/g," ").toLowerCase().split(" ").map(at=>at.charAt(0).toUpperCase()+at.slice(1));let nt=rt.length>0;for(const at of rt)if(!at.match(CSS_IDENT_TOKEN_REGEX)){nt=!1;break}let it=rt.join(" ");return nt||(it=`"${it.replace(/[\\"]/g,"\\$&")}"`),it}const validURICharactersRegex=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function encodeURIWhenNeeded(tt){return validURICharactersRegex.test(tt)?tt:encodeURI(tt)}const loadWebFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadWebFont",test(tt){return checkDataUrl(tt,validFontMIMEs)||checkExtension(tt,validFontExtensions)},async load(tt,et){const rt=settings.ADAPTER.getFontFaceSet();if(rt){const nt=[],it=et.data?.family??getFontFamilyName(tt),at=et.data?.weights?.filter(ot=>validWeights.includes(ot))??["normal"],st=et.data??{};for(let ot=0;ot<at.length;ot++){const lt=at[ot],ht=new FontFace(it,`url(${encodeURIWhenNeeded(tt)})`,{...st,weight:lt});await ht.load(),rt.add(ht),nt.push(ht)}return nt.length===1?nt[0]:nt}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(tt){(Array.isArray(tt)?tt:[tt]).forEach(et=>settings.ADAPTER.getFontFaceSet().delete(et))}};extensions$1.add(loadWebFont);const WORKER_CODE$1=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let WORKER_URL$1=null,WorkerInstance$1=class{constructor(){WORKER_URL$1||(WORKER_URL$1=URL.createObjectURL(new Blob([WORKER_CODE$1],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL$1)}};WorkerInstance$1.revokeObjectURL=function(){WORKER_URL$1&&(URL.revokeObjectURL(WORKER_URL$1),WORKER_URL$1=null)};const WORKER_CODE=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let WORKER_URL=null;class WorkerInstance{constructor(){WORKER_URL||(WORKER_URL=URL.createObjectURL(new Blob([WORKER_CODE],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL)}}WorkerInstance.revokeObjectURL=function(){WORKER_URL&&(URL.revokeObjectURL(WORKER_URL),WORKER_URL=null)};let UUID=0,MAX_WORKERS;class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(et=>{const{worker:rt}=new WorkerInstance$1;rt.addEventListener("message",nt=>{rt.terminate(),WorkerInstance$1.revokeObjectURL(),et(nt.data)})}),this._isImageBitmapSupported)}loadImageBitmap(et){return this._run("loadImageBitmap",[et])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){MAX_WORKERS===void 0&&(MAX_WORKERS=navigator.hardwareConcurrency||4);let et=this.workerPool.pop();return!et&&this._createdWorkers<MAX_WORKERS&&(this._createdWorkers++,et=new WorkerInstance().worker,et.addEventListener("message",rt=>{this.complete(rt.data),this.returnWorker(rt.target),this.next()})),et}returnWorker(et){this.workerPool.push(et)}complete(et){et.error!==void 0?this.resolveHash[et.uuid].reject(et.error):this.resolveHash[et.uuid].resolve(et.data),this.resolveHash[et.uuid]=null}async _run(et,rt){await this._initWorkers();const nt=new Promise((it,at)=>{this.queue.push({id:et,arguments:rt,resolve:it,reject:at})});return this.next(),nt}next(){if(!this.queue.length)return;const et=this.getWorker();if(!et)return;const rt=this.queue.pop(),nt=rt.id;this.resolveHash[UUID]={resolve:rt.resolve,reject:rt.reject},et.postMessage({data:rt.arguments,uuid:UUID++,id:nt})}}const WorkerManager=new WorkerManagerClass;function createTexture(tt,et,rt){tt.resource.internal=!0;const nt=new Texture(tt),it=()=>{delete et.promiseCache[rt],Cache.has(rt)&&Cache.remove(rt)};return nt.baseTexture.once("destroyed",()=>{rt in et.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),it())}),nt.once("destroyed",()=>{tt.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),it())}),nt}const validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(tt){const et=await settings.ADAPTER.fetch(tt);if(!et.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${tt}: ${et.status} ${et.statusText}`);const rt=await et.blob();return await createImageBitmap(rt)}const loadTextures={name:"loadTextures",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(tt){return checkDataUrl(tt,validImageMIMEs)||checkExtension(tt,validImageExtensions)},async load(tt,et,rt){const nt=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let it;nt?this.config.preferWorkers&&await WorkerManager.isImageBitmapSupported()?it=await WorkerManager.loadImageBitmap(tt):it=await loadImageBitmap(tt):it=await new Promise((ot,lt)=>{const ht=new Image;ht.crossOrigin=this.config.crossOrigin,ht.src=tt,ht.complete?ot(ht):(ht.onload=()=>ot(ht),ht.onerror=dt=>lt(dt))});const at={...et.data};at.resolution??(at.resolution=getResolutionOfUrl(tt)),nt&&at.resourceOptions?.ownsImageBitmap===void 0&&(at.resourceOptions={...at.resourceOptions},at.resourceOptions.ownsImageBitmap=!0);const st=new BaseTexture(it,at);return st.resource.src=tt,createTexture(st,rt,tt)},unload(tt){tt.destroy(!0)}};extensions$1.add(loadTextures);const validSVGExtension=".svg",validSVGMIME="image/svg+xml",loadSVG={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadSVG",test(tt){return checkDataUrl(tt,validSVGMIME)||checkExtension(tt,validSVGExtension)},async testParse(tt){return SVGResource.test(tt)},async parse(tt,et,rt){const nt=new SVGResource(tt,et?.data?.resourceOptions);await nt.load();const it=new BaseTexture(nt,{resolution:getResolutionOfUrl(tt),...et?.data});return it.resource.src=et.src,createTexture(it,rt,et.src)},async load(tt,et){return(await settings.ADAPTER.fetch(tt)).text()},unload:loadTextures.unload};extensions$1.add(loadSVG);const validVideoExtensions=[".mp4",".m4v",".webm",".ogv"],validVideoMIMEs=["video/mp4","video/webm","video/ogg"],loadVideo={name:"loadVideo",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(tt){return checkDataUrl(tt,validVideoMIMEs)||checkExtension(tt,validVideoExtensions)},async load(tt,et,rt){let nt;const it=await(await settings.ADAPTER.fetch(tt)).blob(),at=URL.createObjectURL(it);try{const st={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...et?.data?.resourceOptions,autoLoad:!0},ot=new VideoResource(at,st);await ot.load();const lt=new BaseTexture(ot,{alphaMode:await detectVideoAlphaMode(),resolution:getResolutionOfUrl(tt),...et?.data});lt.resource.src=tt,nt=createTexture(lt,rt,tt),nt.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(at)})}catch(st){throw URL.revokeObjectURL(at),st}return nt},unload(tt){tt.destroy(!0)}};extensions$1.add(loadVideo);class Resolver{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(et,rt)=>`${et}${this._bundleIdConnector}${rt}`,extractAssetIdFromBundle:(et,rt)=>rt.replace(`${et}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(et){if(this._bundleIdConnector=et.connector??this._bundleIdConnector,this._createBundleAssetId=et.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=et.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...et){et.forEach(rt=>{this._preferredOrder.push(rt),rt.priority||(rt.priority=Object.keys(rt.params))}),this._resolverHash={}}set basePath(et){this._basePath=et}get basePath(){return this._basePath}set rootPath(et){this._rootPath=et}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(et){if(typeof et=="string")this._defaultSearchParams=et;else{const rt=et;this._defaultSearchParams=Object.keys(rt).map(nt=>`${encodeURIComponent(nt)}=${encodeURIComponent(rt[nt])}`).join("&")}}getAlias(et){const{alias:rt,name:nt,src:it,srcs:at}=et;return convertToList(rt||nt||it||at,st=>typeof st=="string"?st:Array.isArray(st)?st.map(ot=>ot?.src??ot?.srcs??ot):st?.src||st?.srcs?st.src??st.srcs:st,!0)}addManifest(et){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=et,et.bundles.forEach(rt=>{this.addBundle(rt.name,rt.assets)})}addBundle(et,rt){const nt=[];Array.isArray(rt)?rt.forEach(it=>{const at=it.src??it.srcs,st=it.alias??it.name;let ot;if(typeof st=="string"){const lt=this._createBundleAssetId(et,st);nt.push(lt),ot=[st,lt]}else{const lt=st.map(ht=>this._createBundleAssetId(et,ht));nt.push(...lt),ot=[...st,...lt]}this.add({...it,alias:ot,src:at})}):Object.keys(rt).forEach(it=>{const at=[it,this._createBundleAssetId(et,it)];if(typeof rt[it]=="string")this.add({alias:at,src:rt[it]});else if(Array.isArray(rt[it]))this.add({alias:at,src:rt[it]});else{const st=rt[it],ot=st.src??st.srcs;this.add({...st,alias:at,src:Array.isArray(ot)?ot:[ot]})}nt.push(...at)}),this._bundles[et]=nt}add(et,rt,nt,it,at){const st=[];typeof et=="string"||Array.isArray(et)&&typeof et[0]=="string"?(deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),st.push({alias:et,src:rt,data:nt,format:it,loadParser:at})):Array.isArray(et)?st.push(...et):st.push(et);let ot;ot=lt=>{this.hasKey(lt)&&console.warn(`[Resolver] already has key: ${lt} overwriting`)},convertToList(st).forEach(lt=>{const{src:ht,srcs:dt}=lt;let{data:ut,format:ft,loadParser:mt}=lt;const gt=convertToList(ht||dt).map(wt=>typeof wt=="string"?createStringVariations(wt):Array.isArray(wt)?wt:[wt]),vt=this.getAlias(lt);Array.isArray(vt)?vt.forEach(ot):ot(vt);const xt=[];gt.forEach(wt=>{wt.forEach(At=>{let Tt={};if(typeof At!="object"){Tt.src=At;for(let Pt=0;Pt<this._parsers.length;Pt++){const Rt=this._parsers[Pt];if(Rt.test(At)){Tt=Rt.parse(At);break}}}else ut=At.data??ut,ft=At.format??ft,mt=At.loadParser??mt,Tt={...Tt,...At};if(!vt)throw new Error(`[Resolver] alias is undefined for this asset: ${Tt.src}`);Tt=this.buildResolvedAsset(Tt,{aliases:vt,data:ut,format:ft,loadParser:mt}),xt.push(Tt)})}),vt.forEach(wt=>{this._assetMap[wt]=xt})})}resolveBundle(et){const rt=isSingleItem(et);et=convertToList(et);const nt={};return et.forEach(it=>{const at=this._bundles[it];if(at){const st=this.resolve(at),ot={};for(const lt in st){const ht=st[lt];ot[this._extractAssetIdFromBundle(it,lt)]=ht}nt[it]=ot}}),rt?nt[et[0]]:nt}resolveUrl(et){const rt=this.resolve(et);if(typeof et!="string"){const nt={};for(const it in rt)nt[it]=rt[it].src;return nt}return rt.src}resolve(et){const rt=isSingleItem(et);et=convertToList(et);const nt={};return et.forEach(it=>{if(!this._resolverHash[it])if(this._assetMap[it]){let at=this._assetMap[it];const st=at[0],ot=this._getPreferredOrder(at);ot?.priority.forEach(lt=>{ot.params[lt].forEach(ht=>{const dt=at.filter(ut=>ut[lt]?ut[lt]===ht:!1);dt.length&&(at=dt)})}),this._resolverHash[it]=at[0]??st}else this._resolverHash[it]=this.buildResolvedAsset({alias:[it],src:it},{});nt[it]=this._resolverHash[it]}),rt?nt[et[0]]:nt}hasKey(et){return!!this._assetMap[et]}hasBundle(et){return!!this._bundles[et]}_getPreferredOrder(et){for(let rt=0;rt<et.length;rt++){const nt=et[0],it=this._preferredOrder.find(at=>at.params.format.includes(nt.format));if(it)return it}return this._preferredOrder[0]}_appendDefaultSearchParams(et){if(!this._defaultSearchParams)return et;const rt=/\?/.test(et)?"&":"?";return`${et}${rt}${this._defaultSearchParams}`}buildResolvedAsset(et,rt){const{aliases:nt,data:it,loadParser:at,format:st}=rt;return(this._basePath||this._rootPath)&&(et.src=path.toAbsolute(et.src,this._basePath,this._rootPath)),et.alias=nt??et.alias??[et.src],et.src=this._appendDefaultSearchParams(et.src),et.data={...it||{},...et.data},et.loadParser=at??et.loadParser,et.format=st??et.format??path.extname(et.src).slice(1),et.srcs=et.src,et.name=et.alias,et}}class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader,this.cache=Cache,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(et={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,et.defaultSearchParams&&this.resolver.setDefaultSearchParams(et.defaultSearchParams),et.basePath&&(this.resolver.basePath=et.basePath),et.bundleIdentifier&&this.resolver.setBundleIdentifier(et.bundleIdentifier),et.manifest){let at=et.manifest;typeof at=="string"&&(at=await this.load(at)),this.resolver.addManifest(at)}const rt=et.texturePreference?.resolution??1,nt=typeof rt=="number"?[rt]:rt,it=await this._detectFormats({preferredFormats:et.texturePreference?.format,skipDetections:et.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:it,resolution:nt}}),et.preferences&&this.setPreferences(et.preferences)}add(et,rt,nt,it,at){this.resolver.add(et,rt,nt,it,at)}async load(et,rt){this._initialized||await this.init();const nt=isSingleItem(et),it=convertToList(et).map(ot=>{if(typeof ot!="string"){const lt=this.resolver.getAlias(ot);return lt.some(ht=>!this.resolver.hasKey(ht))&&this.add(ot),Array.isArray(lt)?lt[0]:lt}return this.resolver.hasKey(ot)||this.add({alias:ot,src:ot}),ot}),at=this.resolver.resolve(it),st=await this._mapLoadToResolve(at,rt);return nt?st[it[0]]:st}addBundle(et,rt){this.resolver.addBundle(et,rt)}async loadBundle(et,rt){this._initialized||await this.init();let nt=!1;typeof et=="string"&&(nt=!0,et=[et]);const it=this.resolver.resolveBundle(et),at={},st=Object.keys(it);let ot=0,lt=0;const ht=()=>{rt?.(++ot/lt)},dt=st.map(ut=>{const ft=it[ut];return lt+=Object.keys(ft).length,this._mapLoadToResolve(ft,ht).then(mt=>{at[ut]=mt})});return await Promise.all(dt),nt?at[et[0]]:at}async backgroundLoad(et){this._initialized||await this.init(),typeof et=="string"&&(et=[et]);const rt=this.resolver.resolve(et);this._backgroundLoader.add(Object.values(rt))}async backgroundLoadBundle(et){this._initialized||await this.init(),typeof et=="string"&&(et=[et]);const rt=this.resolver.resolveBundle(et);Object.values(rt).forEach(nt=>{this._backgroundLoader.add(Object.values(nt))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(et){if(typeof et=="string")return Cache.get(et);const rt={};for(let nt=0;nt<et.length;nt++)rt[nt]=Cache.get(et[nt]);return rt}async _mapLoadToResolve(et,rt){const nt=Object.values(et),it=Object.keys(et);this._backgroundLoader.active=!1;const at=await this.loader.load(nt,rt);this._backgroundLoader.active=!0;const st={};return nt.forEach((ot,lt)=>{const ht=at[ot.src],dt=[ot.src];ot.alias&&dt.push(...ot.alias),st[it[lt]]=ht,Cache.set(dt,ht)}),st}async unload(et){this._initialized||await this.init();const rt=convertToList(et).map(it=>typeof it!="string"?it.src:it),nt=this.resolver.resolve(rt);await this._unloadFromResolved(nt)}async unloadBundle(et){this._initialized||await this.init(),et=convertToList(et);const rt=this.resolver.resolveBundle(et),nt=Object.keys(rt).map(it=>this._unloadFromResolved(rt[it]));await Promise.all(nt)}async _unloadFromResolved(et){const rt=Object.values(et);rt.forEach(nt=>{Cache.remove(nt.src)}),await this.loader.unload(rt)}async _detectFormats(et){let rt=[];et.preferredFormats&&(rt=Array.isArray(et.preferredFormats)?et.preferredFormats:[et.preferredFormats]);for(const nt of et.detections)et.skipDetections||await nt.test()?rt=await nt.add(rt):et.skipDetections||(rt=await nt.remove(rt));return rt=rt.filter((nt,it)=>rt.indexOf(nt)===it),rt}get detections(){return this._detections}get preferWorkers(){return loadTextures.config.preferWorkers}set preferWorkers(et){deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:et})}setPreferences(et){this.loader.parsers.forEach(rt=>{rt.config&&Object.keys(rt.config).filter(nt=>nt in et).forEach(nt=>{rt.config[nt]=et[nt]})})}}const Assets=new AssetsClass;extensions$1.handleByList(ExtensionType.LoadParser,Assets.loader.parsers).handleByList(ExtensionType.ResolveParser,Assets.resolver.parsers).handleByList(ExtensionType.CacheParser,Assets.cache.parsers).handleByList(ExtensionType.DetectionParser,Assets.detections);const cacheTextureArray={extension:ExtensionType.CacheParser,test:tt=>Array.isArray(tt)&&tt.every(et=>et instanceof Texture),getCacheableAssets:(tt,et)=>{const rt={};return tt.forEach(nt=>{et.forEach((it,at)=>{rt[nt+(at===0?"":at+1)]=it})}),rt}};extensions$1.add(cacheTextureArray);async function testImageFormat(tt){if("Image"in globalThis)return new Promise(et=>{const rt=new Image;rt.onload=()=>{et(!0)},rt.onerror=()=>{et(!1)},rt.src=tt});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const et=await(await fetch(tt)).blob();await createImageBitmap(et)}catch{return!1}return!0}return!1}const detectAvif={extension:{type:ExtensionType.DetectionParser,priority:1},test:async()=>testImageFormat("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async tt=>[...tt,"avif"],remove:async tt=>tt.filter(et=>et!=="avif")};extensions$1.add(detectAvif);const detectWebp={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testImageFormat("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async tt=>[...tt,"webp"],remove:async tt=>tt.filter(et=>et!=="webp")};extensions$1.add(detectWebp);const imageFormats=["png","jpg","jpeg"],detectDefaults={extension:{type:ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async tt=>[...tt,...imageFormats],remove:async tt=>tt.filter(et=>!imageFormats.includes(et))};extensions$1.add(detectDefaults);const inWorker="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function testVideoFormat(tt){return inWorker?!1:document.createElement("video").canPlayType(tt)!==""}const detectWebm={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/webm"),add:async tt=>[...tt,"webm"],remove:async tt=>tt.filter(et=>et!=="webm")};extensions$1.add(detectWebm);const detectMp4={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/mp4"),add:async tt=>[...tt,"mp4","m4v"],remove:async tt=>tt.filter(et=>et!=="mp4"&&et!=="m4v")};extensions$1.add(detectMp4);const detectOgv={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/ogg"),add:async tt=>[...tt,"ogv"],remove:async tt=>tt.filter(et=>et!=="ogv")};extensions$1.add(detectOgv);const resolveTextureUrl={extension:ExtensionType.ResolveParser,test:loadTextures.test,parse:tt=>({resolution:parseFloat(settings.RETINA_PREFIX.exec(tt)?.[1]??"1"),format:path.extname(tt).slice(1),src:tt})};extensions$1.add(resolveTextureUrl);var INTERNAL_FORMATS=(tt=>(tt[tt.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",tt[tt.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",tt[tt.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",tt[tt.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",tt[tt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",tt[tt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",tt[tt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",tt[tt.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",tt[tt.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",tt[tt.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",tt[tt.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",tt[tt.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",tt[tt.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",tt[tt.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",tt[tt.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",tt[tt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",tt[tt.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",tt[tt.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",tt[tt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",tt[tt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",tt[tt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",tt[tt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",tt[tt.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",tt[tt.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",tt[tt.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",tt[tt.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",tt[tt.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",tt[tt.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",tt[tt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",tt[tt.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",tt[tt.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",tt))(INTERNAL_FORMATS||{});const INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let storedGl,extensions;function getCompressedTextureExtensions(){extensions={bptc:storedGl.getExtension("EXT_texture_compression_bptc"),astc:storedGl.getExtension("WEBGL_compressed_texture_astc"),etc:storedGl.getExtension("WEBGL_compressed_texture_etc"),s3tc:storedGl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:storedGl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:storedGl.getExtension("WEBGL_compressed_texture_pvrtc")||storedGl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:storedGl.getExtension("WEBGL_compressed_texture_etc1"),atc:storedGl.getExtension("WEBGL_compressed_texture_atc")}}const detectCompressedTextures={extension:{type:ExtensionType.DetectionParser,priority:2},test:async()=>{const tt=settings.ADAPTER.createCanvas().getContext("webgl");return tt?(storedGl=tt,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async tt=>{extensions||getCompressedTextureExtensions();const et=[];for(const rt in extensions)extensions[rt]&&et.push(rt);return[...et,...tt]},remove:async tt=>(extensions||getCompressedTextureExtensions(),tt.filter(et=>!(et in extensions)))};extensions$1.add(detectCompressedTextures);class BlobResource extends BufferResource{constructor(et,rt={width:1,height:1,autoLoad:!0}){let nt,it;typeof et=="string"?(nt=et,it=new Uint8Array):(nt=null,it=et),super(it,rt),this.origin=nt,this.buffer=it?new ViewableBuffer(it):null,this._load=null,this.loaded=!1,this.origin!==null&&rt.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(et){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(et=>et.blob()).then(et=>et.arrayBuffer()).then(et=>(this.data=new Uint32Array(et),this.buffer=new ViewableBuffer(et),this.loaded=!0,this.onBlobLoaded(et),this.update(),this)),this._load)}}class CompressedTextureResource extends BlobResource{constructor(et,rt){super(et,rt),this.format=rt.format,this.levels=rt.levels||1,this._width=rt.width,this._height=rt.height,this._extension=CompressedTextureResource._formatToExtension(this.format),(rt.levelBuffers||this.buffer)&&(this._levelBuffers=rt.levelBuffers||CompressedTextureResource._createLevelBuffers(et instanceof Uint8Array?et:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(et,rt,nt){const it=et.gl;if(!et.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;it.pixelStorei(it.UNPACK_ALIGNMENT,4);for(let at=0,st=this.levels;at<st;at++){const{levelID:ot,levelWidth:lt,levelHeight:ht,levelBuffer:dt}=this._levelBuffers[at];it.compressedTexImage2D(it.TEXTURE_2D,ot,this.format,lt,ht,0,dt)}return!0}onBlobLoaded(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(et){if(et>=33776&&et<=33779)return"s3tc";if(et>=35916&&et<=35919)return"s3tc_sRGB";if(et>=37488&&et<=37497)return"etc";if(et>=35840&&et<=35843)return"pvrtc";if(et===36196)return"etc1";if(et===35986||et===35987||et===34798)return"atc";if(et>=36492&&et<=36495)return"bptc";if(et===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${et}`)}static _createLevelBuffers(et,rt,nt,it,at,st,ot){const lt=new Array(nt);let ht=et.byteOffset,dt=st,ut=ot,ft=dt+it-1&~(it-1),mt=ut+at-1&~(at-1),gt=ft*mt*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[rt];for(let vt=0;vt<nt;vt++)lt[vt]={levelID:vt,levelWidth:nt>1?dt:ft,levelHeight:nt>1?ut:mt,levelBuffer:new Uint8Array(et.buffer,ht,gt)},ht+=gt,dt=dt>>1||1,ut=ut>>1||1,ft=dt+it-1&~(it-1),mt=ut+at-1&~(at-1),gt=ft*mt*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[rt];return lt}}const DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={FOURCC:2},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT={[FOURCC_DXT1]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[FOURCC_DXT3]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[FOURCC_DXT5]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT},DXGI_TO_FORMAT={70:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:INTERNAL_FORMATS.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function parseDDS(tt){const et=new Uint32Array(tt);if(et[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");const rt=new Uint32Array(tt,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),nt=rt[DDS_FIELDS.HEIGHT],it=rt[DDS_FIELDS.WIDTH],at=rt[DDS_FIELDS.MIPMAP_COUNT],st=new Uint32Array(tt,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),ot=st[PF_FLAGS];if(ot&DDPF_FOURCC){const lt=st[DDS_PF_FIELDS.FOURCC];if(lt!==FOURCC_DX10){const At=FOURCC_TO_FORMAT[lt],Tt=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,Pt=new Uint8Array(tt,Tt);return[new CompressedTextureResource(Pt,{format:At,width:it,height:nt,levels:at})]}const ht=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,dt=new Uint32Array(et.buffer,ht,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),ut=dt[DDS_DX10_FIELDS.DXGI_FORMAT],ft=dt[DDS_DX10_FIELDS.RESOURCE_DIMENSION],mt=dt[DDS_DX10_FIELDS.MISC_FLAG],gt=dt[DDS_DX10_FIELDS.ARRAY_SIZE],vt=DXGI_TO_FORMAT[ut];if(vt===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${ut}`);if(mt===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(ft===6)throw new Error("DDSParser does not supported 3D texture data");const xt=new Array,wt=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(gt===1)xt.push(new Uint8Array(tt,wt));else{const At=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[vt];let Tt=0,Pt=it,Rt=nt;for(let Et=0;Et<at;Et++){const Lt=Math.max(1,Pt+3&-4),kt=Math.max(1,Rt+3&-4),jt=Lt*kt*At;Tt+=jt,Pt=Pt>>>1,Rt=Rt>>>1}let Ot=wt;for(let Et=0;Et<gt;Et++)xt.push(new Uint8Array(tt,Ot,Tt)),Ot+=Tt}return xt.map(At=>new CompressedTextureResource(At,{format:vt,width:it,height:nt,levels:at}))}throw ot&DDPF_RGB?new Error("DDSParser does not support uncompressed texture data."):ot&DDPF_YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):ot&DDPF_LUMINANCE?new Error("DDSParser does not support single-channel (lumninance) texture data!"):ot&DDPF_ALPHA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,TYPES_TO_BYTES_PER_COMPONENT={[TYPES.UNSIGNED_BYTE]:1,[TYPES.UNSIGNED_SHORT]:2,[TYPES.INT]:4,[TYPES.UNSIGNED_INT]:4,[TYPES.FLOAT]:4,[TYPES.HALF_FLOAT]:8},FORMATS_TO_COMPONENTS={[FORMATS.RGBA]:4,[FORMATS.RGB]:3,[FORMATS.RG]:2,[FORMATS.RED]:1,[FORMATS.LUMINANCE]:1,[FORMATS.LUMINANCE_ALPHA]:2,[FORMATS.ALPHA]:1},TYPES_TO_BYTES_PER_PIXEL={[TYPES.UNSIGNED_SHORT_4_4_4_4]:2,[TYPES.UNSIGNED_SHORT_5_5_5_1]:2,[TYPES.UNSIGNED_SHORT_5_6_5]:2};function parseKTX(tt,et,rt=!1){const nt=new DataView(et);if(!validate(tt,nt))return null;const it=nt.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,at=nt.getUint32(KTX_FIELDS.GL_TYPE,it),st=nt.getUint32(KTX_FIELDS.GL_FORMAT,it),ot=nt.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,it),lt=nt.getUint32(KTX_FIELDS.PIXEL_WIDTH,it),ht=nt.getUint32(KTX_FIELDS.PIXEL_HEIGHT,it)||1,dt=nt.getUint32(KTX_FIELDS.PIXEL_DEPTH,it)||1,ut=nt.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,it)||1,ft=nt.getUint32(KTX_FIELDS.NUMBER_OF_FACES,it),mt=nt.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,it),gt=nt.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,it);if(ht===0||dt!==1)throw new Error("Only 2D textures are supported");if(ft!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(ut!==1)throw new Error("WebGL does not support array textures");const vt=4,xt=4,wt=lt+3&-4,At=ht+3&-4,Tt=new Array(ut);let Pt=lt*ht;at===0&&(Pt=wt*At);let Rt;if(at!==0?TYPES_TO_BYTES_PER_COMPONENT[at]?Rt=TYPES_TO_BYTES_PER_COMPONENT[at]*FORMATS_TO_COMPONENTS[st]:Rt=TYPES_TO_BYTES_PER_PIXEL[at]:Rt=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[ot],Rt===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const Ot=rt?parseKvData(nt,gt,it):null;let Et=Pt*Rt,Lt=lt,kt=ht,jt=wt,Mt=At,$t=FILE_HEADER_SIZE+gt;for(let Qt=0;Qt<mt;Qt++){const Ht=nt.getUint32($t,it);let qt=$t+4;for(let Bt=0;Bt<ut;Bt++){let Xt=Tt[Bt];Xt||(Xt=Tt[Bt]=new Array(mt)),Xt[Qt]={levelID:Qt,levelWidth:mt>1||at!==0?Lt:jt,levelHeight:mt>1||at!==0?kt:Mt,levelBuffer:new Uint8Array(et,qt,Et)},qt+=Et}$t+=Ht+4,$t=$t%4!==0?$t+4-$t%4:$t,Lt=Lt>>1||1,kt=kt>>1||1,jt=Lt+vt-1&-4,Mt=kt+xt-1&-4,Et=jt*Mt*Rt}return at!==0?{uncompressed:Tt.map(Qt=>{let Ht=Qt[0].levelBuffer,qt=!1;return at===TYPES.FLOAT?Ht=new Float32Array(Qt[0].levelBuffer.buffer,Qt[0].levelBuffer.byteOffset,Qt[0].levelBuffer.byteLength/4):at===TYPES.UNSIGNED_INT?(qt=!0,Ht=new Uint32Array(Qt[0].levelBuffer.buffer,Qt[0].levelBuffer.byteOffset,Qt[0].levelBuffer.byteLength/4)):at===TYPES.INT&&(qt=!0,Ht=new Int32Array(Qt[0].levelBuffer.buffer,Qt[0].levelBuffer.byteOffset,Qt[0].levelBuffer.byteLength/4)),{resource:new BufferResource(Ht,{width:Qt[0].levelWidth,height:Qt[0].levelHeight}),type:at,format:qt?convertFormatToInteger(st):st}}),kvData:Ot}:{compressed:Tt.map(Qt=>new CompressedTextureResource(null,{format:ot,width:lt,height:ht,levels:mt,levelBuffers:Qt})),kvData:Ot}}function validate(tt,et){for(let rt=0;rt<FILE_IDENTIFIER.length;rt++)if(et.getUint8(rt)!==FILE_IDENTIFIER[rt])return console.error(`${tt} is not a valid *.ktx file!`),!1;return!0}function convertFormatToInteger(tt){switch(tt){case FORMATS.RGBA:return FORMATS.RGBA_INTEGER;case FORMATS.RGB:return FORMATS.RGB_INTEGER;case FORMATS.RG:return FORMATS.RG_INTEGER;case FORMATS.RED:return FORMATS.RED_INTEGER;default:return tt}}function parseKvData(tt,et,rt){const nt=new Map;let it=0;for(;it<et;){const at=tt.getUint32(FILE_HEADER_SIZE+it,rt),st=FILE_HEADER_SIZE+it+4,ot=3-(at+3)%4;if(at===0||at>et-it){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let lt=0;for(;lt<at&&tt.getUint8(st+lt)!==0;lt++);if(lt===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const ht=new TextDecoder().decode(new Uint8Array(tt.buffer,st,lt)),dt=new DataView(tt.buffer,st+lt+1,at-lt-1);nt.set(ht,dt),it+=4+at+ot}return nt}const loadDDS={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadDDS",test(tt){return checkExtension(tt,".dds")},async load(tt,et,rt){const nt=await(await settings.ADAPTER.fetch(tt)).arrayBuffer(),it=parseDDS(nt).map(at=>{const st=new BaseTexture(at,{mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(tt),...et.data});return createTexture(st,rt,tt)});return it.length===1?it[0]:it},unload(tt){Array.isArray(tt)?tt.forEach(et=>et.destroy(!0)):tt.destroy(!0)}};extensions$1.add(loadDDS);const loadKTX={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadKTX",test(tt){return checkExtension(tt,".ktx")},async load(tt,et,rt){const nt=await(await settings.ADAPTER.fetch(tt)).arrayBuffer(),{compressed:it,uncompressed:at,kvData:st}=parseKTX(tt,nt),ot=it??at,lt={mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(tt),...et.data},ht=ot.map(dt=>{ot===at&&Object.assign(lt,{type:dt.type,format:dt.format});const ut=dt.resource??dt,ft=new BaseTexture(ut,lt);return ft.ktxKeyValueData=st,createTexture(ft,rt,tt)});return ht.length===1?ht[0]:ht},unload(tt){Array.isArray(tt)?tt.forEach(et=>et.destroy(!0)):tt.destroy(!0)}};extensions$1.add(loadKTX);const knownFormats=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],resolveCompressedTextureUrl={extension:ExtensionType.ResolveParser,test:tt=>{const et=path.extname(tt).slice(1);return["basis","ktx","dds"].includes(et)},parse:tt=>{const et=tt.split("."),rt=et.pop();if(["ktx","dds"].includes(rt)){const nt=et.pop();if(knownFormats.includes(nt))return{resolution:parseFloat(settings.RETINA_PREFIX.exec(tt)?.[1]??"1"),format:nt,src:tt}}return{resolution:parseFloat(settings.RETINA_PREFIX.exec(tt)?.[1]??"1"),format:rt,src:tt}}};extensions$1.add(resolveCompressedTextureUrl);const TEMP_RECT=new Rectangle,BYTES_PER_PIXEL=4,_Extract=class Vh{constructor(et){this.renderer=et,this._rendererPremultipliedAlpha=!1}contextChange(){const et=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(et&&et.alpha&&et.premultipliedAlpha)}async image(et,rt,nt,it){const at=new Image;return at.src=await this.base64(et,rt,nt,it),at}async base64(et,rt,nt,it){const at=this.canvas(et,it);if(at.toBlob!==void 0)return new Promise((st,ot)=>{at.toBlob(lt=>{if(!lt){ot(new Error("ICanvas.toBlob failed!"));return}const ht=new FileReader;ht.onload=()=>st(ht.result),ht.onerror=ot,ht.readAsDataURL(lt)},rt,nt)});if(at.toDataURL!==void 0)return at.toDataURL(rt,nt);if(at.convertToBlob!==void 0){const st=await at.convertToBlob({type:rt,quality:nt});return new Promise((ot,lt)=>{const ht=new FileReader;ht.onload=()=>ot(ht.result),ht.onerror=lt,ht.readAsDataURL(st)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(et,rt){const{pixels:nt,width:it,height:at,flipY:st,premultipliedAlpha:ot}=this._rawPixels(et,rt);st&&Vh._flipY(nt,it,at),ot&&Vh._unpremultiplyAlpha(nt);const lt=new CanvasRenderTarget(it,at,1),ht=new ImageData(new Uint8ClampedArray(nt.buffer),it,at);return lt.context.putImageData(ht,0,0),lt.canvas}pixels(et,rt){const{pixels:nt,width:it,height:at,flipY:st,premultipliedAlpha:ot}=this._rawPixels(et,rt);return st&&Vh._flipY(nt,it,at),ot&&Vh._unpremultiplyAlpha(nt),nt}_rawPixels(et,rt){const nt=this.renderer;if(!nt)throw new Error("The Extract has already been destroyed");let it,at=!1,st=!1,ot,lt=!1;et&&(et instanceof RenderTexture?ot=et:(ot=nt.generateTexture(et,{region:rt,resolution:nt.resolution,multisample:nt.multisample}),lt=!0,rt&&(TEMP_RECT.width=rt.width,TEMP_RECT.height=rt.height,rt=TEMP_RECT)));const ht=nt.gl;if(ot){if(it=ot.baseTexture.resolution,rt=rt??ot.frame,at=!1,st=ot.baseTexture.alphaMode>0&&ot.baseTexture.format===FORMATS.RGBA,!lt){nt.renderTexture.bind(ot);const mt=ot.framebuffer.glFramebuffers[nt.CONTEXT_UID];mt.blitFramebuffer&&nt.framebuffer.bind(mt.blitFramebuffer)}}else it=nt.resolution,rt||(rt=TEMP_RECT,rt.width=nt.width/it,rt.height=nt.height/it),at=!0,st=this._rendererPremultipliedAlpha,nt.renderTexture.bind();const dt=Math.max(Math.round(rt.width*it),1),ut=Math.max(Math.round(rt.height*it),1),ft=new Uint8Array(BYTES_PER_PIXEL*dt*ut);return ht.readPixels(Math.round(rt.x*it),Math.round(rt.y*it),dt,ut,ht.RGBA,ht.UNSIGNED_BYTE,ft),lt&&ot?.destroy(!0),{pixels:ft,width:dt,height:ut,flipY:at,premultipliedAlpha:st}}destroy(){this.renderer=null}static _flipY(et,rt,nt){const it=rt<<2,at=nt>>1,st=new Uint8Array(it);for(let ot=0;ot<at;ot++){const lt=ot*it,ht=(nt-ot-1)*it;st.set(et.subarray(lt,lt+it)),et.copyWithin(lt,ht,ht+it),et.set(st,ht)}}static _unpremultiplyAlpha(et){et instanceof Uint8ClampedArray&&(et=new Uint8Array(et.buffer));const rt=et.length;for(let nt=0;nt<rt;nt+=4){const it=et[nt+3];if(it!==0){const at=255.001/it;et[nt]=et[nt]*at+.5,et[nt+1]=et[nt+1]*at+.5,et[nt+2]=et[nt+2]*at+.5}}}};_Extract.extension={name:"extract",type:ExtensionType.RendererSystem};let Extract=_Extract;extensions$1.add(Extract);const buildCircle={build(tt){const et=tt.points;let rt,nt,it,at,st,ot;if(tt.type===SHAPES.CIRC){const gt=tt.shape;rt=gt.x,nt=gt.y,st=ot=gt.radius,it=at=0}else if(tt.type===SHAPES.ELIP){const gt=tt.shape;rt=gt.x,nt=gt.y,st=gt.width,ot=gt.height,it=at=0}else{const gt=tt.shape,vt=gt.width/2,xt=gt.height/2;rt=gt.x+vt,nt=gt.y+xt,st=ot=Math.max(0,Math.min(gt.radius,Math.min(vt,xt))),it=vt-st,at=xt-ot}if(!(st>=0&&ot>=0&&it>=0&&at>=0)){et.length=0;return}const lt=Math.ceil(2.3*Math.sqrt(st+ot)),ht=lt*8+(it?4:0)+(at?4:0);if(et.length=ht,ht===0)return;if(lt===0){et.length=8,et[0]=et[6]=rt+it,et[1]=et[3]=nt+at,et[2]=et[4]=rt-it,et[5]=et[7]=nt-at;return}let dt=0,ut=lt*4+(it?2:0)+2,ft=ut,mt=ht;{const gt=it+st,vt=at,xt=rt+gt,wt=rt-gt,At=nt+vt;if(et[dt++]=xt,et[dt++]=At,et[--ut]=At,et[--ut]=wt,at){const Tt=nt-vt;et[ft++]=wt,et[ft++]=Tt,et[--mt]=Tt,et[--mt]=xt}}for(let gt=1;gt<lt;gt++){const vt=Math.PI/2*(gt/lt),xt=it+Math.cos(vt)*st,wt=at+Math.sin(vt)*ot,At=rt+xt,Tt=rt-xt,Pt=nt+wt,Rt=nt-wt;et[dt++]=At,et[dt++]=Pt,et[--ut]=Pt,et[--ut]=Tt,et[ft++]=Tt,et[ft++]=Rt,et[--mt]=Rt,et[--mt]=At}{const gt=it,vt=at+ot,xt=rt+gt,wt=rt-gt,At=nt+vt,Tt=nt-vt;et[dt++]=xt,et[dt++]=At,et[--mt]=Tt,et[--mt]=xt,it&&(et[dt++]=wt,et[dt++]=At,et[--mt]=Tt,et[--mt]=wt)}},triangulate(tt,et){const rt=tt.points,nt=et.points,it=et.indices;if(rt.length===0)return;let at=nt.length/2;const st=at;let ot,lt;if(tt.type!==SHAPES.RREC){const dt=tt.shape;ot=dt.x,lt=dt.y}else{const dt=tt.shape;ot=dt.x+dt.width/2,lt=dt.y+dt.height/2}const ht=tt.matrix;nt.push(tt.matrix?ht.a*ot+ht.c*lt+ht.tx:ot,tt.matrix?ht.b*ot+ht.d*lt+ht.ty:lt),at++,nt.push(rt[0],rt[1]);for(let dt=2;dt<rt.length;dt+=2)nt.push(rt[dt],rt[dt+1]),it.push(at++,st,at);it.push(st+1,st,at)}};function fixOrientation(tt,et=!1){const rt=tt.length;if(rt<6)return;let nt=0;for(let it=0,at=tt[rt-2],st=tt[rt-1];it<rt;it+=2){const ot=tt[it],lt=tt[it+1];nt+=(ot-at)*(lt+st),at=ot,st=lt}if(!et&&nt>0||et&&nt<=0){const it=rt/2;for(let at=it+it%2;at<rt;at+=2){const st=rt-at-2,ot=rt-at-1,lt=at,ht=at+1;[tt[st],tt[lt]]=[tt[lt],tt[st]],[tt[ot],tt[ht]]=[tt[ht],tt[ot]]}}}const buildPoly={build(tt){tt.points=tt.shape.points.slice()},triangulate(tt,et){let rt=tt.points;const nt=tt.holes,it=et.points,at=et.indices;if(rt.length>=6){fixOrientation(rt,!1);const st=[];for(let ht=0;ht<nt.length;ht++){const dt=nt[ht];fixOrientation(dt.points,!0),st.push(rt.length/2),rt=rt.concat(dt.points)}const ot=earcut(rt,st,2);if(!ot)return;const lt=it.length/2;for(let ht=0;ht<ot.length;ht+=3)at.push(ot[ht]+lt),at.push(ot[ht+1]+lt),at.push(ot[ht+2]+lt);for(let ht=0;ht<rt.length;ht++)it.push(rt[ht])}}},buildRectangle={build(tt){const et=tt.shape,rt=et.x,nt=et.y,it=et.width,at=et.height,st=tt.points;st.length=0,it>=0&&at>=0&&st.push(rt,nt,rt+it,nt,rt+it,nt+at,rt,nt+at)},triangulate(tt,et){const rt=tt.points,nt=et.points;if(rt.length===0)return;const it=nt.length/2;nt.push(rt[0],rt[1],rt[2],rt[3],rt[6],rt[7],rt[4],rt[5]),et.indices.push(it,it+1,it+2,it+1,it+2,it+3)}},buildRoundedRectangle={build(tt){buildCircle.build(tt)},triangulate(tt,et){buildCircle.triangulate(tt,et)}};var LINE_JOIN=(tt=>(tt.MITER="miter",tt.BEVEL="bevel",tt.ROUND="round",tt))(LINE_JOIN||{}),LINE_CAP=(tt=>(tt.BUTT="butt",tt.ROUND="round",tt.SQUARE="square",tt))(LINE_CAP||{});const curves={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(tt,et=20){if(!this.adaptive||!tt||isNaN(tt))return et;let rt=Math.ceil(tt/this.maxLength);return rt<this.minSegments?rt=this.minSegments:rt>this.maxSegments&&(rt=this.maxSegments),rt}};class ArcUtils{static curveTo(et,rt,nt,it,at,st){const ot=st[st.length-2],lt=st[st.length-1]-rt,ht=ot-et,dt=it-rt,ut=nt-et,ft=Math.abs(lt*ut-ht*dt);if(ft<1e-8||at===0)return(st[st.length-2]!==et||st[st.length-1]!==rt)&&st.push(et,rt),null;const mt=lt*lt+ht*ht,gt=dt*dt+ut*ut,vt=lt*dt+ht*ut,xt=at*Math.sqrt(mt)/ft,wt=at*Math.sqrt(gt)/ft,At=xt*vt/mt,Tt=wt*vt/gt,Pt=xt*ut+wt*ht,Rt=xt*dt+wt*lt,Ot=ht*(wt+At),Et=lt*(wt+At),Lt=ut*(xt+Tt),kt=dt*(xt+Tt),jt=Math.atan2(Et-Rt,Ot-Pt),Mt=Math.atan2(kt-Rt,Lt-Pt);return{cx:Pt+et,cy:Rt+rt,radius:at,startAngle:jt,endAngle:Mt,anticlockwise:ht*dt>ut*lt}}static arc(et,rt,nt,it,at,st,ot,lt,ht){const dt=ot-st,ut=curves._segmentsCount(Math.abs(dt)*at,Math.ceil(Math.abs(dt)/PI_2)*40),ft=dt/(ut*2),mt=ft*2,gt=Math.cos(ft),vt=Math.sin(ft),xt=ut-1,wt=xt%1/xt;for(let At=0;At<=xt;++At){const Tt=At+wt*At,Pt=ft+st+mt*Tt,Rt=Math.cos(Pt),Ot=-Math.sin(Pt);ht.push((gt*Rt+vt*Ot)*at+nt,(gt*-Ot+vt*Rt)*at+it)}}}class BatchPart{constructor(){this.reset()}begin(et,rt,nt){this.reset(),this.style=et,this.start=rt,this.attribStart=nt}end(et,rt){this.attribSize=rt-this.attribStart,this.size=et-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class BezierUtils{static curveLength(et,rt,nt,it,at,st,ot,lt){let ht=0,dt=0,ut=0,ft=0,mt=0,gt=0,vt=0,xt=0,wt=0,At=0,Tt=0,Pt=et,Rt=rt;for(let Ot=1;Ot<=10;++Ot)dt=Ot/10,ut=dt*dt,ft=ut*dt,mt=1-dt,gt=mt*mt,vt=gt*mt,xt=vt*et+3*gt*dt*nt+3*mt*ut*at+ft*ot,wt=vt*rt+3*gt*dt*it+3*mt*ut*st+ft*lt,At=Pt-xt,Tt=Rt-wt,Pt=xt,Rt=wt,ht+=Math.sqrt(At*At+Tt*Tt);return ht}static curveTo(et,rt,nt,it,at,st,ot){const lt=ot[ot.length-2],ht=ot[ot.length-1];ot.length-=2;const dt=curves._segmentsCount(BezierUtils.curveLength(lt,ht,et,rt,nt,it,at,st));let ut=0,ft=0,mt=0,gt=0,vt=0;ot.push(lt,ht);for(let xt=1,wt=0;xt<=dt;++xt)wt=xt/dt,ut=1-wt,ft=ut*ut,mt=ft*ut,gt=wt*wt,vt=gt*wt,ot.push(mt*lt+3*ft*wt*et+3*ut*gt*nt+vt*at,mt*ht+3*ft*wt*rt+3*ut*gt*it+vt*st)}}function square(tt,et,rt,nt,it,at,st,ot){const lt=tt-rt*it,ht=et-nt*it,dt=tt+rt*at,ut=et+nt*at;let ft,mt;st?(ft=nt,mt=-rt):(ft=-nt,mt=rt);const gt=lt+ft,vt=ht+mt,xt=dt+ft,wt=ut+mt;return ot.push(gt,vt,xt,wt),2}function round(tt,et,rt,nt,it,at,st,ot){const lt=rt-tt,ht=nt-et;let dt=Math.atan2(lt,ht),ut=Math.atan2(it-tt,at-et);ot&&dt<ut?dt+=Math.PI*2:!ot&&dt>ut&&(ut+=Math.PI*2);let ft=dt;const mt=ut-dt,gt=Math.abs(mt),vt=Math.sqrt(lt*lt+ht*ht),xt=(15*gt*Math.sqrt(vt)/Math.PI>>0)+1,wt=mt/xt;if(ft+=wt,ot){st.push(tt,et,rt,nt);for(let At=1,Tt=ft;At<xt;At++,Tt+=wt)st.push(tt,et,tt+Math.sin(Tt)*vt,et+Math.cos(Tt)*vt);st.push(tt,et,it,at)}else{st.push(rt,nt,tt,et);for(let At=1,Tt=ft;At<xt;At++,Tt+=wt)st.push(tt+Math.sin(Tt)*vt,et+Math.cos(Tt)*vt,tt,et);st.push(it,at,tt,et)}return xt*2}function buildNonNativeLine(tt,et){const rt=tt.shape;let nt=tt.points||rt.points.slice();const it=et.closePointEps;if(nt.length===0)return;const at=tt.lineStyle,st=new Point$2(nt[0],nt[1]),ot=new Point$2(nt[nt.length-2],nt[nt.length-1]),lt=rt.type!==SHAPES.POLY||rt.closeStroke,ht=Math.abs(st.x-ot.x)<it&&Math.abs(st.y-ot.y)<it;if(lt){nt=nt.slice(),ht&&(nt.pop(),nt.pop(),ot.set(nt[nt.length-2],nt[nt.length-1]));const Xt=(st.x+ot.x)*.5,Ft=(ot.y+st.y)*.5;nt.unshift(Xt,Ft),nt.push(Xt,Ft)}const dt=et.points,ut=nt.length/2;let ft=nt.length;const mt=dt.length/2,gt=at.width/2,vt=gt*gt,xt=at.miterLimit*at.miterLimit;let wt=nt[0],At=nt[1],Tt=nt[2],Pt=nt[3],Rt=0,Ot=0,Et=-(At-Pt),Lt=wt-Tt,kt=0,jt=0,Mt=Math.sqrt(Et*Et+Lt*Lt);Et/=Mt,Lt/=Mt,Et*=gt,Lt*=gt;const $t=at.alignment,Qt=(1-$t)*2,Ht=$t*2;lt||(at.cap===LINE_CAP.ROUND?ft+=round(wt-Et*(Qt-Ht)*.5,At-Lt*(Qt-Ht)*.5,wt-Et*Qt,At-Lt*Qt,wt+Et*Ht,At+Lt*Ht,dt,!0)+2:at.cap===LINE_CAP.SQUARE&&(ft+=square(wt,At,Et,Lt,Qt,Ht,!0,dt))),dt.push(wt-Et*Qt,At-Lt*Qt,wt+Et*Ht,At+Lt*Ht);for(let Xt=1;Xt<ut-1;++Xt){wt=nt[(Xt-1)*2],At=nt[(Xt-1)*2+1],Tt=nt[Xt*2],Pt=nt[Xt*2+1],Rt=nt[(Xt+1)*2],Ot=nt[(Xt+1)*2+1],Et=-(At-Pt),Lt=wt-Tt,Mt=Math.sqrt(Et*Et+Lt*Lt),Et/=Mt,Lt/=Mt,Et*=gt,Lt*=gt,kt=-(Pt-Ot),jt=Tt-Rt,Mt=Math.sqrt(kt*kt+jt*jt),kt/=Mt,jt/=Mt,kt*=gt,jt*=gt;const Ft=Tt-wt,Wt=At-Pt,Yt=Tt-Rt,zt=Ot-Pt,er=Ft*Yt+Wt*zt,dr=Wt*Yt-zt*Ft,fr=dr<0;if(Math.abs(dr)<.001*Math.abs(er)){dt.push(Tt-Et*Qt,Pt-Lt*Qt,Tt+Et*Ht,Pt+Lt*Ht),er>=0&&(at.join===LINE_JOIN.ROUND?ft+=round(Tt,Pt,Tt-Et*Qt,Pt-Lt*Qt,Tt-kt*Qt,Pt-jt*Qt,dt,!1)+4:ft+=2,dt.push(Tt-kt*Ht,Pt-jt*Ht,Tt+kt*Qt,Pt+jt*Qt));continue}const lr=(-Et+wt)*(-Lt+Pt)-(-Et+Tt)*(-Lt+At),mr=(-kt+Rt)*(-jt+Pt)-(-kt+Tt)*(-jt+Ot),br=(Ft*mr-Yt*lr)/dr,Sr=(zt*lr-Wt*mr)/dr,Ir=(br-Tt)*(br-Tt)+(Sr-Pt)*(Sr-Pt),cr=Tt+(br-Tt)*Qt,Nt=Pt+(Sr-Pt)*Qt,pr=Tt-(br-Tt)*Ht,rr=Pt-(Sr-Pt)*Ht,ar=Math.min(Ft*Ft+Wt*Wt,Yt*Yt+zt*zt),nr=fr?Qt:Ht,ur=ar+nr*nr*vt,Er=Ir<=ur;let Ut=at.join;if(Ut===LINE_JOIN.MITER&&Ir/vt>xt&&(Ut=LINE_JOIN.BEVEL),Er)switch(Ut){case LINE_JOIN.MITER:{dt.push(cr,Nt,pr,rr);break}case LINE_JOIN.BEVEL:{fr?dt.push(cr,Nt,Tt+Et*Ht,Pt+Lt*Ht,cr,Nt,Tt+kt*Ht,Pt+jt*Ht):dt.push(Tt-Et*Qt,Pt-Lt*Qt,pr,rr,Tt-kt*Qt,Pt-jt*Qt,pr,rr),ft+=2;break}case LINE_JOIN.ROUND:{fr?(dt.push(cr,Nt,Tt+Et*Ht,Pt+Lt*Ht),ft+=round(Tt,Pt,Tt+Et*Ht,Pt+Lt*Ht,Tt+kt*Ht,Pt+jt*Ht,dt,!0)+4,dt.push(cr,Nt,Tt+kt*Ht,Pt+jt*Ht)):(dt.push(Tt-Et*Qt,Pt-Lt*Qt,pr,rr),ft+=round(Tt,Pt,Tt-Et*Qt,Pt-Lt*Qt,Tt-kt*Qt,Pt-jt*Qt,dt,!1)+4,dt.push(Tt-kt*Qt,Pt-jt*Qt,pr,rr));break}}else{switch(dt.push(Tt-Et*Qt,Pt-Lt*Qt,Tt+Et*Ht,Pt+Lt*Ht),Ut){case LINE_JOIN.MITER:{fr?dt.push(pr,rr,pr,rr):dt.push(cr,Nt,cr,Nt),ft+=2;break}case LINE_JOIN.ROUND:{fr?ft+=round(Tt,Pt,Tt+Et*Ht,Pt+Lt*Ht,Tt+kt*Ht,Pt+jt*Ht,dt,!0)+2:ft+=round(Tt,Pt,Tt-Et*Qt,Pt-Lt*Qt,Tt-kt*Qt,Pt-jt*Qt,dt,!1)+2;break}}dt.push(Tt-kt*Qt,Pt-jt*Qt,Tt+kt*Ht,Pt+jt*Ht),ft+=2}}wt=nt[(ut-2)*2],At=nt[(ut-2)*2+1],Tt=nt[(ut-1)*2],Pt=nt[(ut-1)*2+1],Et=-(At-Pt),Lt=wt-Tt,Mt=Math.sqrt(Et*Et+Lt*Lt),Et/=Mt,Lt/=Mt,Et*=gt,Lt*=gt,dt.push(Tt-Et*Qt,Pt-Lt*Qt,Tt+Et*Ht,Pt+Lt*Ht),lt||(at.cap===LINE_CAP.ROUND?ft+=round(Tt-Et*(Qt-Ht)*.5,Pt-Lt*(Qt-Ht)*.5,Tt-Et*Qt,Pt-Lt*Qt,Tt+Et*Ht,Pt+Lt*Ht,dt,!1)+2:at.cap===LINE_CAP.SQUARE&&(ft+=square(Tt,Pt,Et,Lt,Qt,Ht,!1,dt)));const qt=et.indices,Bt=curves.epsilon*curves.epsilon;for(let Xt=mt;Xt<ft+mt-2;++Xt)wt=dt[Xt*2],At=dt[Xt*2+1],Tt=dt[(Xt+1)*2],Pt=dt[(Xt+1)*2+1],Rt=dt[(Xt+2)*2],Ot=dt[(Xt+2)*2+1],!(Math.abs(wt*(Pt-Ot)+Tt*(Ot-At)+Rt*(At-Pt))<Bt)&&qt.push(Xt,Xt+1,Xt+2)}function buildNativeLine(tt,et){let rt=0;const nt=tt.shape,it=tt.points||nt.points,at=nt.type!==SHAPES.POLY||nt.closeStroke;if(it.length===0)return;const st=et.points,ot=et.indices,lt=it.length/2,ht=st.length/2;let dt=ht;for(st.push(it[0],it[1]),rt=1;rt<lt;rt++)st.push(it[rt*2],it[rt*2+1]),ot.push(dt,dt+1),dt++;at&&ot.push(dt,ht)}function buildLine(tt,et){tt.lineStyle.native?buildNativeLine(tt,et):buildNonNativeLine(tt,et)}class QuadraticUtils{static curveLength(et,rt,nt,it,at,st){const ot=et-2*nt+at,lt=rt-2*it+st,ht=2*nt-2*et,dt=2*it-2*rt,ut=4*(ot*ot+lt*lt),ft=4*(ot*ht+lt*dt),mt=ht*ht+dt*dt,gt=2*Math.sqrt(ut+ft+mt),vt=Math.sqrt(ut),xt=2*ut*vt,wt=2*Math.sqrt(mt),At=ft/vt;return(xt*gt+vt*ft*(gt-wt)+(4*mt*ut-ft*ft)*Math.log((2*vt+At+gt)/(At+wt)))/(4*xt)}static curveTo(et,rt,nt,it,at){const st=at[at.length-2],ot=at[at.length-1],lt=curves._segmentsCount(QuadraticUtils.curveLength(st,ot,et,rt,nt,it));let ht=0,dt=0;for(let ut=1;ut<=lt;++ut){const ft=ut/lt;ht=st+(et-st)*ft,dt=ot+(rt-ot)*ft,at.push(ht+(et+(nt-et)*ft-ht)*ft,dt+(rt+(it-rt)*ft-dt)*ft)}}}const FILL_COMMANDS={[SHAPES.POLY]:buildPoly,[SHAPES.CIRC]:buildCircle,[SHAPES.ELIP]:buildCircle,[SHAPES.RECT]:buildRectangle,[SHAPES.RREC]:buildRoundedRectangle},BATCH_POOL=[],DRAW_CALL_POOL=[];class GraphicsData{constructor(et,rt=null,nt=null,it=null){this.points=[],this.holes=[],this.shape=et,this.lineStyle=nt,this.fillStyle=rt,this.matrix=it,this.type=et.type}clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const tmpPoint=new Point$2,_GraphicsGeometry=class Kf extends BatchGeometry{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Bounds,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let et=0;et<this.drawCalls.length;et++)this.drawCalls[et].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[et]);this.drawCalls.length=0;for(let et=0;et<this.batches.length;et++){const rt=this.batches[et];rt.reset(),BATCH_POOL.push(rt)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(et,rt=null,nt=null,it=null){const at=new GraphicsData(et,rt,nt,it);return this.graphicsData.push(at),this.dirty++,this}drawHole(et,rt=null){if(!this.graphicsData.length)return null;const nt=new GraphicsData(et,null,null,rt),it=this.graphicsData[this.graphicsData.length-1];return nt.lineStyle=it.lineStyle,it.holes.push(nt),this.dirty++,this}destroy(){super.destroy();for(let et=0;et<this.graphicsData.length;++et)this.graphicsData[et].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(et){const rt=this.graphicsData;for(let nt=0;nt<rt.length;++nt){const it=rt[nt];if(it.fillStyle.visible&&it.shape&&(it.matrix?it.matrix.applyInverse(et,tmpPoint):tmpPoint.copyFrom(et),it.shape.contains(tmpPoint.x,tmpPoint.y))){let at=!1;if(it.holes){for(let st=0;st<it.holes.length;st++)if(it.holes[st].shape.contains(tmpPoint.x,tmpPoint.y)){at=!0;break}}if(!at)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const et=this.uvs,rt=this.graphicsData;let nt=null,it=null;this.batches.length>0&&(nt=this.batches[this.batches.length-1],it=nt.style);for(let lt=this.shapeIndex;lt<rt.length;lt++){this.shapeIndex++;const ht=rt[lt],dt=ht.fillStyle,ut=ht.lineStyle;FILL_COMMANDS[ht.type].build(ht),ht.matrix&&this.transformPoints(ht.points,ht.matrix),(dt.visible||ut.visible)&&this.processHoles(ht.holes);for(let ft=0;ft<2;ft++){const mt=ft===0?dt:ut;if(!mt.visible)continue;const gt=mt.texture.baseTexture,vt=this.indices.length,xt=this.points.length/2;gt.wrapMode=WRAP_MODES.REPEAT,ft===0?this.processFill(ht):this.processLine(ht);const wt=this.points.length/2-xt;wt!==0&&(nt&&!this._compareStyles(it,mt)&&(nt.end(vt,xt),nt=null),nt||(nt=BATCH_POOL.pop()||new BatchPart,nt.begin(mt,vt,xt),this.batches.push(nt),it=mt),this.addUvs(this.points,et,mt.texture,xt,wt,mt.matrix))}}const at=this.indices.length,st=this.points.length/2;if(nt&&nt.end(at,st),this.batches.length===0){this.batchable=!0;return}const ot=st>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&ot===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=ot?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(et,rt){return!(!et||!rt||et.texture.baseTexture!==rt.texture.baseTexture||et.color+et.alpha!==rt.color+rt.alpha||!!et.native!=!!rt.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let et=0,rt=this.graphicsData.length;et<rt;et++){const nt=this.graphicsData[et],it=nt.fillStyle,at=nt.lineStyle;if(it&&!it.texture.baseTexture.valid||at&&!at.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const et=this.batches;for(let rt=0,nt=et.length;rt<nt;rt++){const it=et[rt];for(let at=0;at<it.size;at++){const st=it.start+at;this.indicesUint16[st]=this.indicesUint16[st]-it.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const et=this.batches;for(let rt=0;rt<et.length;rt++)if(et[rt].style.native)return!1;return this.points.length<Kf.BATCHABLE_SIZE*2}buildDrawCalls(){let et=++BaseTexture._globalBatch;for(let ut=0;ut<this.drawCalls.length;ut++)this.drawCalls[ut].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[ut]);this.drawCalls.length=0;const rt=this.colors,nt=this.textureIds;let it=DRAW_CALL_POOL.pop();it||(it=new BatchDrawCall,it.texArray=new BatchTextureArray),it.texArray.count=0,it.start=0,it.size=0,it.type=DRAW_MODES.TRIANGLES;let at=0,st=null,ot=0,lt=!1,ht=DRAW_MODES.TRIANGLES,dt=0;this.drawCalls.push(it);for(let ut=0;ut<this.batches.length;ut++){const ft=this.batches[ut],mt=8,gt=ft.style,vt=gt.texture.baseTexture;lt!==!!gt.native&&(lt=!!gt.native,ht=lt?DRAW_MODES.LINES:DRAW_MODES.TRIANGLES,st=null,at=mt,et++),st!==vt&&(st=vt,vt._batchEnabled!==et&&(at===mt&&(et++,at=0,it.size>0&&(it=DRAW_CALL_POOL.pop(),it||(it=new BatchDrawCall,it.texArray=new BatchTextureArray),this.drawCalls.push(it)),it.start=dt,it.size=0,it.texArray.count=0,it.type=ht),vt.touched=1,vt._batchEnabled=et,vt._batchLocation=at,vt.wrapMode=WRAP_MODES.REPEAT,it.texArray.elements[it.texArray.count++]=vt,at++)),it.size+=ft.size,dt+=ft.size,ot=vt._batchLocation,this.addColors(rt,gt.color,gt.alpha,ft.attribSize,ft.attribStart),this.addTextureIds(nt,ot,ft.attribSize,ft.attribStart)}BaseTexture._globalBatch=et,this.packAttributes()}packAttributes(){const et=this.points,rt=this.uvs,nt=this.colors,it=this.textureIds,at=new ArrayBuffer(et.length*3*4),st=new Float32Array(at),ot=new Uint32Array(at);let lt=0;for(let ht=0;ht<et.length/2;ht++)st[lt++]=et[ht*2],st[lt++]=et[ht*2+1],st[lt++]=rt[ht*2],st[lt++]=rt[ht*2+1],ot[lt++]=nt[ht],st[lt++]=it[ht];this._buffer.update(at),this._indexBuffer.update(this.indicesUint16)}processFill(et){et.holes.length?buildPoly.triangulate(et,this):FILL_COMMANDS[et.type].triangulate(et,this)}processLine(et){buildLine(et,this);for(let rt=0;rt<et.holes.length;rt++)buildLine(et.holes[rt],this)}processHoles(et){for(let rt=0;rt<et.length;rt++){const nt=et[rt];FILL_COMMANDS[nt.type].build(nt),nt.matrix&&this.transformPoints(nt.points,nt.matrix)}}calculateBounds(){const et=this._bounds;et.clear(),et.addVertexData(this.points,0,this.points.length),et.pad(this.boundsPadding,this.boundsPadding)}transformPoints(et,rt){for(let nt=0;nt<et.length/2;nt++){const it=et[nt*2],at=et[nt*2+1];et[nt*2]=rt.a*it+rt.c*at+rt.tx,et[nt*2+1]=rt.b*it+rt.d*at+rt.ty}}addColors(et,rt,nt,it,at=0){const st=Color.shared.setValue(rt).toLittleEndianNumber(),ot=Color.shared.setValue(st).toPremultiplied(nt);et.length=Math.max(et.length,at+it);for(let lt=0;lt<it;lt++)et[at+lt]=ot}addTextureIds(et,rt,nt,it=0){et.length=Math.max(et.length,it+nt);for(let at=0;at<nt;at++)et[it+at]=rt}addUvs(et,rt,nt,it,at,st=null){let ot=0;const lt=rt.length,ht=nt.frame;for(;ot<at;){let ut=et[(it+ot)*2],ft=et[(it+ot)*2+1];if(st){const mt=st.a*ut+st.c*ft+st.tx;ft=st.b*ut+st.d*ft+st.ty,ut=mt}ot++,rt.push(ut/ht.width,ft/ht.height)}const dt=nt.baseTexture;(ht.width<dt.width||ht.height<dt.height)&&this.adjustUvs(rt,nt,lt,at)}adjustUvs(et,rt,nt,it){const at=rt.baseTexture,st=1e-6,ot=nt+it*2,lt=rt.frame,ht=lt.width/at.width,dt=lt.height/at.height;let ut=lt.x/lt.width,ft=lt.y/lt.height,mt=Math.floor(et[nt]+st),gt=Math.floor(et[nt+1]+st);for(let vt=nt+2;vt<ot;vt+=2)mt=Math.min(mt,Math.floor(et[vt]+st)),gt=Math.min(gt,Math.floor(et[vt+1]+st));ut-=mt,ft-=gt;for(let vt=nt;vt<ot;vt+=2)et[vt]=(et[vt]+ut)*ht,et[vt+1]=(et[vt+1]+ft)*dt}};_GraphicsGeometry.BATCHABLE_SIZE=100;let GraphicsGeometry=_GraphicsGeometry;class FillStyle{constructor(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const et=new FillStyle;return et.color=this.color,et.alpha=this.alpha,et.texture=this.texture,et.matrix=this.matrix,et.visible=this.visible,et}reset(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class LineStyle extends FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}clone(){const et=new LineStyle;return et.color=this.color,et.alpha=this.alpha,et.texture=this.texture,et.matrix=this.matrix,et.visible=this.visible,et.width=this.width,et.alignment=this.alignment,et.native=this.native,et.cap=this.cap,et.join=this.join,et.miterLimit=this.miterLimit,et}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}}const DEFAULT_SHADERS={},_Graphics=class Rd extends Container{constructor(et=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new FillStyle,this._lineStyle=new LineStyle,this._matrix=null,this._holeMode=!1,this.state=State.for2d(),this._geometry=et||new GraphicsGeometry,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Color(16777215),this.blendMode=BLEND_MODES.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Rd(this._geometry)}set blendMode(et){this.state.blendMode=et}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(et){this._tintColor.setValue(et)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(et=null,rt=0,nt,it=.5,at=!1){return typeof et=="number"&&(et={width:et,color:rt,alpha:nt,alignment:it,native:at}),this.lineTextureStyle(et)}lineTextureStyle(et){const rt={width:0,texture:Texture.WHITE,color:et?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10};et=Object.assign(rt,et),this.normalizeColor(et),this.currentPath&&this.startPoly();const nt=et.width>0&&et.alpha>0;return nt?(et.matrix&&(et.matrix=et.matrix.clone(),et.matrix.invert()),Object.assign(this._lineStyle,{visible:nt},et)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const et=this.currentPath.points,rt=this.currentPath.points.length;rt>2&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(et[rt-2],et[rt-1]))}else this.currentPath=new Polygon,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(et,rt){return this.startPoly(),this.currentPath.points[0]=et,this.currentPath.points[1]=rt,this}lineTo(et,rt){this.currentPath||this.moveTo(0,0);const nt=this.currentPath.points,it=nt[nt.length-2],at=nt[nt.length-1];return(it!==et||at!==rt)&&nt.push(et,rt),this}_initCurve(et=0,rt=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[et,rt]):this.moveTo(et,rt)}quadraticCurveTo(et,rt,nt,it){this._initCurve();const at=this.currentPath.points;return at.length===0&&this.moveTo(0,0),QuadraticUtils.curveTo(et,rt,nt,it,at),this}bezierCurveTo(et,rt,nt,it,at,st){return this._initCurve(),BezierUtils.curveTo(et,rt,nt,it,at,st,this.currentPath.points),this}arcTo(et,rt,nt,it,at){this._initCurve(et,rt);const st=this.currentPath.points,ot=ArcUtils.curveTo(et,rt,nt,it,at,st);if(ot){const{cx:lt,cy:ht,radius:dt,startAngle:ut,endAngle:ft,anticlockwise:mt}=ot;this.arc(lt,ht,dt,ut,ft,mt)}return this}arc(et,rt,nt,it,at,st=!1){if(it===at)return this;if(!st&&at<=it?at+=PI_2:st&&it<=at&&(it+=PI_2),at-it===0)return this;const ot=et+Math.cos(it)*nt,lt=rt+Math.sin(it)*nt,ht=this._geometry.closePointEps;let dt=this.currentPath?this.currentPath.points:null;if(dt){const ut=Math.abs(dt[dt.length-2]-ot),ft=Math.abs(dt[dt.length-1]-lt);ut<ht&&ft<ht||dt.push(ot,lt)}else this.moveTo(ot,lt),dt=this.currentPath.points;return ArcUtils.arc(ot,lt,et,rt,nt,it,at,st,dt),this}beginFill(et=0,rt){return this.beginTextureFill({texture:Texture.WHITE,color:et,alpha:rt})}normalizeColor(et){const rt=Color.shared.setValue(et.color??0);et.color=rt.toNumber(),et.alpha??(et.alpha=rt.alpha)}beginTextureFill(et){const rt={texture:Texture.WHITE,color:16777215,matrix:null};et=Object.assign(rt,et),this.normalizeColor(et),this.currentPath&&this.startPoly();const nt=et.alpha>0;return nt?(et.matrix&&(et.matrix=et.matrix.clone(),et.matrix.invert()),Object.assign(this._fillStyle,{visible:nt},et)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(et,rt,nt,it){return this.drawShape(new Rectangle(et,rt,nt,it))}drawRoundedRect(et,rt,nt,it,at){return this.drawShape(new RoundedRectangle(et,rt,nt,it,at))}drawCircle(et,rt,nt){return this.drawShape(new Circle(et,rt,nt))}drawEllipse(et,rt,nt,it){return this.drawShape(new Ellipse(et,rt,nt,it))}drawPolygon(...et){let rt,nt=!0;const it=et[0];it.points?(nt=it.closeStroke,rt=it.points):Array.isArray(et[0])?rt=et[0]:rt=et;const at=new Polygon(rt);return at.closeStroke=nt,this.drawShape(at),this}drawShape(et){return this._holeMode?this._geometry.drawHole(et,this._matrix):this._geometry.drawShape(et,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const et=this._geometry.graphicsData;return et.length===1&&et[0].shape.type===SHAPES.RECT&&!et[0].matrix&&!et[0].holes.length&&!(et[0].lineStyle.visible&&et[0].lineStyle.width)}_render(et){this.finishPoly();const rt=this._geometry;rt.updateBatches(),rt.batchable?(this.batchDirty!==rt.batchDirty&&this._populateBatches(),this._renderBatched(et)):(et.batch.flush(),this._renderDirect(et))}_populateBatches(){const et=this._geometry,rt=this.blendMode,nt=et.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=et.batchDirty,this.batches.length=nt,this.vertexData=new Float32Array(et.points);for(let it=0;it<nt;it++){const at=et.batches[it],st=at.style.color,ot=new Float32Array(this.vertexData.buffer,at.attribStart*4*2,at.attribSize*2),lt=new Float32Array(et.uvsFloat32.buffer,at.attribStart*4*2,at.attribSize*2),ht=new Uint16Array(et.indicesUint16.buffer,at.start*2,at.size),dt={vertexData:ot,blendMode:rt,indices:ht,uvs:lt,_batchRGB:Color.shared.setValue(st).toRgbArray(),_tintRGB:st,_texture:at.style.texture,alpha:at.style.alpha,worldAlpha:1};this.batches[it]=dt}}_renderBatched(et){if(this.batches.length){et.batch.setObjectRenderer(et.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let rt=0,nt=this.batches.length;rt<nt;rt++){const it=this.batches[rt];it.worldAlpha=this.worldAlpha*it.alpha,et.plugins[this.pluginName].render(it)}}}_renderDirect(et){const rt=this._resolveDirectShader(et),nt=this._geometry,it=this.worldAlpha,at=rt.uniforms,st=nt.drawCalls;at.translationMatrix=this.transform.worldTransform,Color.shared.setValue(this._tintColor).premultiply(it).toArray(at.tint),et.shader.bind(rt),et.geometry.bind(nt,rt),et.state.set(this.state);for(let ot=0,lt=st.length;ot<lt;ot++)this._renderDrawCallDirect(et,nt.drawCalls[ot])}_renderDrawCallDirect(et,rt){const{texArray:nt,type:it,size:at,start:st}=rt,ot=nt.count;for(let lt=0;lt<ot;lt++)et.texture.bind(nt.elements[lt],lt);et.geometry.draw(it,at,st)}_resolveDirectShader(et){let rt=this.shader;const nt=this.pluginName;if(!rt){if(!DEFAULT_SHADERS[nt]){const{maxTextures:it}=et.plugins[nt],at=new Int32Array(it);for(let lt=0;lt<it;lt++)at[lt]=lt;const st={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:at},!0)},ot=et.plugins[nt]._shader.program;DEFAULT_SHADERS[nt]=new Shader(ot,st)}rt=DEFAULT_SHADERS[nt]}return rt}_calculateBounds(){this.finishPoly();const et=this._geometry;if(!et.graphicsData.length)return;const{minX:rt,minY:nt,maxX:it,maxY:at}=et.bounds;this._bounds.addFrame(this.transform,rt,nt,it,at)}containsPoint(et){return this.worldTransform.applyInverse(et,Rd._TEMP_POINT),this._geometry.containsPoint(Rd._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let et=0;et<this.batches.length;et++){const rt=this.batches[et];rt._tintRGB=Color.shared.setValue(this._tintColor).multiply(rt._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const et=this.transform._worldID;if(this._transformID===et)return;this._transformID=et;const rt=this.transform.worldTransform,nt=rt.a,it=rt.b,at=rt.c,st=rt.d,ot=rt.tx,lt=rt.ty,ht=this._geometry.points,dt=this.vertexData;let ut=0;for(let ft=0;ft<ht.length;ft+=2){const mt=ht[ft],gt=ht[ft+1];dt[ut++]=nt*mt+at*gt+ot,dt[ut++]=st*gt+it*mt+lt}}closePath(){const et=this.currentPath;return et&&(et.closeStroke=!0,this.finishPoly()),this}setMatrix(et){return this._matrix=et,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(et){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(et)}};_Graphics.curves=curves,_Graphics._TEMP_POINT=new Point$2;let Graphics=_Graphics;class MeshBatchUvs{constructor(et,rt){this.uvBuffer=et,this.uvMatrix=rt,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(et){if(!et&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const rt=this.uvBuffer.data;(!this.data||this.data.length!==rt.length)&&(this.data=new Float32Array(rt.length)),this.uvMatrix.multiplyUvs(rt,this.data),this._updateID++}}const tempPoint$1=new Point$2,tempPolygon=new Polygon,_Mesh=class Jf extends Container{constructor(et,rt,nt,it=DRAW_MODES.TRIANGLES){super(),this.geometry=et,this.shader=rt,this.state=nt||State.for2d(),this.drawMode=it,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=settings.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(et){this._geometry!==et&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=et,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(et){this.shader=et}get material(){return this.shader}set blendMode(et){this.state.blendMode=et}get blendMode(){return this.state.blendMode}set roundPixels(et){this._roundPixels!==et&&(this._transformID=-1),this._roundPixels=et}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(et){this.shader.tint=et}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(et){this.shader.texture=et}_render(et){const rt=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===DRAW_MODES.TRIANGLES&&rt.length<Jf.BATCHABLE_SIZE*2?this._renderToBatch(et):this._renderDefault(et)}_renderDefault(et){const rt=this.shader;rt.alpha=this.worldAlpha,rt.update&&rt.update(),et.batch.flush(),rt.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),et.shader.bind(rt),et.state.set(this.state),et.geometry.bind(this.geometry,rt),et.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(et){const rt=this.geometry,nt=this.shader;nt.uvMatrix&&(nt.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=rt.indexBuffer.data,this._tintRGB=nt._tintRGB,this._texture=nt.texture;const it=this.material.pluginName;et.batch.setObjectRenderer(et.plugins[it]),et.plugins[it].render(this)}calculateVertices(){const et=this.geometry.buffers[0],rt=et.data,nt=et._updateID;if(nt===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==rt.length&&(this.vertexData=new Float32Array(rt.length));const it=this.transform.worldTransform,at=it.a,st=it.b,ot=it.c,lt=it.d,ht=it.tx,dt=it.ty,ut=this.vertexData;for(let ft=0;ft<ut.length/2;ft++){const mt=rt[ft*2],gt=rt[ft*2+1];ut[ft*2]=at*mt+ot*gt+ht,ut[ft*2+1]=st*mt+lt*gt+dt}if(this._roundPixels){const ft=settings.RESOLUTION;for(let mt=0;mt<ut.length;++mt)ut[mt]=Math.round(ut[mt]*ft)/ft}this.vertexDirty=nt}calculateUvs(){const et=this.geometry.buffers[1],rt=this.shader;rt.uvMatrix.isSimple?this.uvs=et.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(et,rt.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(et){if(!this.getBounds().contains(et.x,et.y))return!1;this.worldTransform.applyInverse(et,tempPoint$1);const rt=this.geometry.getBuffer("aVertexPosition").data,nt=tempPolygon.points,it=this.geometry.getIndex().data,at=it.length,st=this.drawMode===4?3:1;for(let ot=0;ot+2<at;ot+=st){const lt=it[ot]*2,ht=it[ot+1]*2,dt=it[ot+2]*2;if(nt[0]=rt[lt],nt[1]=rt[lt+1],nt[2]=rt[ht],nt[3]=rt[ht+1],nt[4]=rt[dt],nt[5]=rt[dt+1],tempPolygon.contains(tempPoint$1.x,tempPoint$1.y))return!0}return!1}destroy(et){super.destroy(et),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};_Mesh.BATCHABLE_SIZE=100;let Mesh=_Mesh;class MeshGeometry extends Geometry{constructor(et,rt,nt){super();const it=new Buffer$2(et),at=new Buffer$2(rt,!0),st=new Buffer$2(nt,!0,!0);this.addAttribute("aVertexPosition",it,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",at,2,!1,TYPES.FLOAT).addIndex(st),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fragment$1=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,vertex$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class MeshMaterial extends Shader{constructor(et,rt){const nt={uSampler:et,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};rt=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},rt),rt.uniforms&&Object.assign(nt,rt.uniforms),super(rt.program||Program.from(vertex$1,fragment$1),nt),this._colorDirty=!1,this.uvMatrix=new TextureMatrix(et),this.batchable=rt.program===void 0,this.pluginName=rt.pluginName,this._tintColor=new Color(rt.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=rt.alpha}get texture(){return this.uniforms.uSampler}set texture(et){this.uniforms.uSampler!==et&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!et.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=et,this.uvMatrix.texture=et)}set alpha(et){et!==this._alpha&&(this._alpha=et,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(et){et!==this.tint&&(this._tintColor.setValue(et),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const et=this.texture.baseTexture.alphaMode;Color.shared.setValue(this._tintColor).premultiply(this._alpha,et).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class PlaneGeometry extends MeshGeometry{constructor(et=100,rt=100,nt=10,it=10){super(),this.segWidth=nt,this.segHeight=it,this.width=et,this.height=rt,this.build()}build(){const et=this.segWidth*this.segHeight,rt=[],nt=[],it=[],at=this.segWidth-1,st=this.segHeight-1,ot=this.width/at,lt=this.height/st;for(let dt=0;dt<et;dt++){const ut=dt%this.segWidth,ft=dt/this.segWidth|0;rt.push(ut*ot,ft*lt),nt.push(ut/at,ft/st)}const ht=at*st;for(let dt=0;dt<ht;dt++){const ut=dt%at,ft=dt/at|0,mt=ft*this.segWidth+ut,gt=ft*this.segWidth+ut+1,vt=(ft+1)*this.segWidth+ut,xt=(ft+1)*this.segWidth+ut+1;it.push(mt,gt,vt,gt,xt,vt)}this.buffers[0].data=new Float32Array(rt),this.buffers[1].data=new Float32Array(nt),this.indexBuffer.data=new Uint16Array(it),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class RopeGeometry extends MeshGeometry{constructor(et=200,rt,nt=0){super(new Float32Array(rt.length*4),new Float32Array(rt.length*4),new Uint16Array((rt.length-1)*6)),this.points=rt,this._width=et,this.textureScale=nt,this.build()}get width(){return this._width}build(){const et=this.points;if(!et)return;const rt=this.getBuffer("aVertexPosition"),nt=this.getBuffer("aTextureCoord"),it=this.getIndex();if(et.length<1)return;rt.data.length/4!==et.length&&(rt.data=new Float32Array(et.length*4),nt.data=new Float32Array(et.length*4),it.data=new Uint16Array((et.length-1)*6));const at=nt.data,st=it.data;at[0]=0,at[1]=0,at[2]=0,at[3]=1;let ot=0,lt=et[0];const ht=this._width*this.textureScale,dt=et.length;for(let ft=0;ft<dt;ft++){const mt=ft*4;if(this.textureScale>0){const gt=lt.x-et[ft].x,vt=lt.y-et[ft].y,xt=Math.sqrt(gt*gt+vt*vt);lt=et[ft],ot+=xt/ht}else ot=ft/(dt-1);at[mt]=ot,at[mt+1]=0,at[mt+2]=ot,at[mt+3]=1}let ut=0;for(let ft=0;ft<dt-1;ft++){const mt=ft*2;st[ut++]=mt,st[ut++]=mt+1,st[ut++]=mt+2,st[ut++]=mt+2,st[ut++]=mt+1,st[ut++]=mt+3}nt.update(),it.update(),this.updateVertices()}updateVertices(){const et=this.points;if(et.length<1)return;let rt=et[0],nt,it=0,at=0;const st=this.buffers[0].data,ot=et.length,lt=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let ht=0;ht<ot;ht++){const dt=et[ht],ut=ht*4;ht<et.length-1?nt=et[ht+1]:nt=dt,at=-(nt.x-rt.x),it=nt.y-rt.y;const ft=Math.sqrt(it*it+at*at);ft<1e-6?(it=0,at=0):(it/=ft,at/=ft,it*=lt,at*=lt),st[ut]=dt.x+it,st[ut+1]=dt.y+at,st[ut+2]=dt.x-it,st[ut+3]=dt.y-at,rt=dt}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class SimplePlane extends Mesh{constructor(et,rt,nt){const it=new PlaneGeometry(et.width,et.height,rt,nt),at=new MeshMaterial(Texture.WHITE);super(it,at),this.texture=et,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const et=this.geometry,{width:rt,height:nt}=this.shader.texture;this.autoResize&&(et.width!==rt||et.height!==nt)&&(et.width=this.shader.texture.width,et.height=this.shader.texture.height,et.build())}set texture(et){this.shader.texture!==et&&(this.shader.texture=et,this._textureID=-1,et.baseTexture.valid?this.textureUpdated():et.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(et){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(et)}destroy(et){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(et)}}const DEFAULT_BORDER_SIZE=10;class NineSlicePlane extends SimplePlane{constructor(et,rt,nt,it,at){super(Texture.WHITE,4,4),this._origWidth=et.orig.width,this._origHeight=et.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=rt??et.defaultBorders?.left??DEFAULT_BORDER_SIZE,this._rightWidth=it??et.defaultBorders?.right??DEFAULT_BORDER_SIZE,this._topHeight=nt??et.defaultBorders?.top??DEFAULT_BORDER_SIZE,this._bottomHeight=at??et.defaultBorders?.bottom??DEFAULT_BORDER_SIZE,this.texture=et}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(et){this.geometry.getBuffer("aVertexPosition").data=et}updateHorizontalVertices(){const et=this.vertices,rt=this._getMinScale();et[9]=et[11]=et[13]=et[15]=this._topHeight*rt,et[17]=et[19]=et[21]=et[23]=this._height-this._bottomHeight*rt,et[25]=et[27]=et[29]=et[31]=this._height}updateVerticalVertices(){const et=this.vertices,rt=this._getMinScale();et[2]=et[10]=et[18]=et[26]=this._leftWidth*rt,et[4]=et[12]=et[20]=et[28]=this._width-this._rightWidth*rt,et[6]=et[14]=et[22]=et[30]=this._width}_getMinScale(){const et=this._leftWidth+this._rightWidth,rt=this._width>et?1:this._width/et,nt=this._topHeight+this._bottomHeight,it=this._height>nt?1:this._height/nt;return Math.min(rt,it)}get width(){return this._width}set width(et){this._width=et,this._refresh()}get height(){return this._height}set height(et){this._height=et,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(et){this._leftWidth=et,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(et){this._rightWidth=et,this._refresh()}get topHeight(){return this._topHeight}set topHeight(et){this._topHeight=et,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(et){this._bottomHeight=et,this._refresh()}_refresh(){const et=this.texture,rt=this.geometry.buffers[1].data;this._origWidth=et.orig.width,this._origHeight=et.orig.height;const nt=1/this._origWidth,it=1/this._origHeight;rt[0]=rt[8]=rt[16]=rt[24]=0,rt[1]=rt[3]=rt[5]=rt[7]=0,rt[6]=rt[14]=rt[22]=rt[30]=1,rt[25]=rt[27]=rt[29]=rt[31]=1,rt[2]=rt[10]=rt[18]=rt[26]=nt*this._leftWidth,rt[4]=rt[12]=rt[20]=rt[28]=1-nt*this._rightWidth,rt[9]=rt[11]=rt[13]=rt[15]=it*this._topHeight,rt[17]=rt[19]=rt[21]=rt[23]=1-it*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class SimpleMesh extends Mesh{constructor(et=Texture.EMPTY,rt,nt,it,at){const st=new MeshGeometry(rt,nt,it);st.getBuffer("aVertexPosition").static=!1;const ot=new MeshMaterial(et);super(st,ot,null,at),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(et){this.geometry.getBuffer("aVertexPosition").data=et}_render(et){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(et)}}class SimpleRope extends Mesh{constructor(et,rt,nt=0){const it=new RopeGeometry(et.height,rt,nt),at=new MeshMaterial(et);nt>0&&(et.baseTexture.wrapMode=WRAP_MODES.REPEAT),super(it,at),this.autoUpdate=!0}_render(et){const rt=this.geometry;(this.autoUpdate||rt._width!==this.shader.texture.height)&&(rt._width=this.shader.texture.height,rt.update()),super._render(et)}}class ParticleContainer extends Container{constructor(et=1500,rt,nt=16384,it=!1){super();const at=16384;nt>at&&(nt=at),this._properties=[!1,!0,!1,!1,!1],this._maxSize=et,this._batchSize=nt,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=BLEND_MODES.NORMAL,this.autoResize=it,this.roundPixels=!0,this.baseTexture=null,this.setProperties(rt),this._tintColor=new Color(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(et){et&&(this._properties[0]="vertices"in et||"scale"in et?!!et.vertices||!!et.scale:this._properties[0],this._properties[1]="position"in et?!!et.position:this._properties[1],this._properties[2]="rotation"in et?!!et.rotation:this._properties[2],this._properties[3]="uvs"in et?!!et.uvs:this._properties[3],this._properties[4]="tint"in et||"alpha"in et?!!et.tint||!!et.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(et){this._tintColor.setValue(et),this._tintColor.toRgbArray(this.tintRgb)}render(et){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),et.batch.setObjectRenderer(et.plugins.particle),et.plugins.particle.render(this))}onChildrenChange(et){const rt=Math.floor(et/this._batchSize);for(;this._bufferUpdateIDs.length<rt;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[rt]=++this._updateID}dispose(){if(this._buffers){for(let et=0;et<this._buffers.length;++et)this._buffers[et].destroy();this._buffers=null}}destroy(et){super.destroy(et),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class ParticleBuffer{constructor(et,rt,nt){this.geometry=new Geometry,this.indexBuffer=null,this.size=nt,this.dynamicProperties=[],this.staticProperties=[];for(let it=0;it<et.length;++it){let at=et[it];at={attributeName:at.attributeName,size:at.size,uploadFunction:at.uploadFunction,type:at.type||TYPES.FLOAT,offset:at.offset},rt[it]?this.dynamicProperties.push(at):this.staticProperties.push(at)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const et=this.geometry;let rt=0;this.indexBuffer=new Buffer$2(createIndicesForQuads(this.size),!0,!0),et.addIndex(this.indexBuffer),this.dynamicStride=0;for(let st=0;st<this.dynamicProperties.length;++st){const ot=this.dynamicProperties[st];ot.offset=rt,rt+=ot.size,this.dynamicStride+=ot.size}const nt=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(nt),this.dynamicDataUint32=new Uint32Array(nt),this.dynamicBuffer=new Buffer$2(this.dynamicData,!1,!1);let it=0;this.staticStride=0;for(let st=0;st<this.staticProperties.length;++st){const ot=this.staticProperties[st];ot.offset=it,it+=ot.size,this.staticStride+=ot.size}const at=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(at),this.staticDataUint32=new Uint32Array(at),this.staticBuffer=new Buffer$2(this.staticData,!0,!1);for(let st=0;st<this.dynamicProperties.length;++st){const ot=this.dynamicProperties[st];et.addAttribute(ot.attributeName,this.dynamicBuffer,0,ot.type===TYPES.UNSIGNED_BYTE,ot.type,this.dynamicStride*4,ot.offset*4)}for(let st=0;st<this.staticProperties.length;++st){const ot=this.staticProperties[st];et.addAttribute(ot.attributeName,this.staticBuffer,0,ot.type===TYPES.UNSIGNED_BYTE,ot.type,this.staticStride*4,ot.offset*4)}}uploadDynamic(et,rt,nt){for(let it=0;it<this.dynamicProperties.length;it++){const at=this.dynamicProperties[it];at.uploadFunction(et,rt,nt,at.type===TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,at.offset)}this.dynamicBuffer._updateID++}uploadStatic(et,rt,nt){for(let it=0;it<this.staticProperties.length;it++){const at=this.staticProperties[it];at.uploadFunction(et,rt,nt,at.type===TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,at.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var fragment=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ParticleRenderer extends ObjectRenderer{constructor(et){super(et),this.shader=null,this.properties=null,this.tempMatrix=new Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Shader.from(vertex,fragment,{}),this.state=State.for2d()}render(et){const rt=et.children,nt=et._maxSize,it=et._batchSize,at=this.renderer;let st=rt.length;if(st===0)return;st>nt&&!et.autoResize&&(st=nt);let ot=et._buffers;ot||(ot=et._buffers=this.generateBuffers(et));const lt=rt[0]._texture.baseTexture,ht=lt.alphaMode>0;this.state.blendMode=correctBlendMode(et.blendMode,ht),at.state.set(this.state);const dt=at.gl,ut=et.worldTransform.copyTo(this.tempMatrix);ut.prepend(at.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=ut.toArray(!0),this.shader.uniforms.uColor=Color.shared.setValue(et.tintRgb).premultiply(et.worldAlpha,ht).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=lt,this.renderer.shader.bind(this.shader);let ft=!1;for(let mt=0,gt=0;mt<st;mt+=it,gt+=1){let vt=st-mt;vt>it&&(vt=it),gt>=ot.length&&ot.push(this._generateOneMoreBuffer(et));const xt=ot[gt];xt.uploadDynamic(rt,mt,vt);const wt=et._bufferUpdateIDs[gt]||0;ft=ft||xt._updateID<wt,ft&&(xt._updateID=et._updateID,xt.uploadStatic(rt,mt,vt)),at.geometry.bind(xt.geometry),dt.drawElements(dt.TRIANGLES,vt*6,dt.UNSIGNED_SHORT,0)}}generateBuffers(et){const rt=[],nt=et._maxSize,it=et._batchSize,at=et._properties;for(let st=0;st<nt;st+=it)rt.push(new ParticleBuffer(this.properties,at,it));return rt}_generateOneMoreBuffer(et){const rt=et._batchSize,nt=et._properties;return new ParticleBuffer(this.properties,nt,rt)}uploadVertices(et,rt,nt,it,at,st){let ot=0,lt=0,ht=0,dt=0;for(let ut=0;ut<nt;++ut){const ft=et[rt+ut],mt=ft._texture,gt=ft.scale.x,vt=ft.scale.y,xt=mt.trim,wt=mt.orig;xt?(lt=xt.x-ft.anchor.x*wt.width,ot=lt+xt.width,dt=xt.y-ft.anchor.y*wt.height,ht=dt+xt.height):(ot=wt.width*(1-ft.anchor.x),lt=wt.width*-ft.anchor.x,ht=wt.height*(1-ft.anchor.y),dt=wt.height*-ft.anchor.y),it[st]=lt*gt,it[st+1]=dt*vt,it[st+at]=ot*gt,it[st+at+1]=dt*vt,it[st+at*2]=ot*gt,it[st+at*2+1]=ht*vt,it[st+at*3]=lt*gt,it[st+at*3+1]=ht*vt,st+=at*4}}uploadPosition(et,rt,nt,it,at,st){for(let ot=0;ot<nt;ot++){const lt=et[rt+ot].position;it[st]=lt.x,it[st+1]=lt.y,it[st+at]=lt.x,it[st+at+1]=lt.y,it[st+at*2]=lt.x,it[st+at*2+1]=lt.y,it[st+at*3]=lt.x,it[st+at*3+1]=lt.y,st+=at*4}}uploadRotation(et,rt,nt,it,at,st){for(let ot=0;ot<nt;ot++){const lt=et[rt+ot].rotation;it[st]=lt,it[st+at]=lt,it[st+at*2]=lt,it[st+at*3]=lt,st+=at*4}}uploadUvs(et,rt,nt,it,at,st){for(let ot=0;ot<nt;++ot){const lt=et[rt+ot]._texture._uvs;lt?(it[st]=lt.x0,it[st+1]=lt.y0,it[st+at]=lt.x1,it[st+at+1]=lt.y1,it[st+at*2]=lt.x2,it[st+at*2+1]=lt.y2,it[st+at*3]=lt.x3,it[st+at*3+1]=lt.y3,st+=at*4):(it[st]=0,it[st+1]=0,it[st+at]=0,it[st+at+1]=0,it[st+at*2]=0,it[st+at*2+1]=0,it[st+at*3]=0,it[st+at*3+1]=0,st+=at*4)}}uploadTint(et,rt,nt,it,at,st){for(let ot=0;ot<nt;++ot){const lt=et[rt+ot],ht=Color.shared.setValue(lt._tintRGB).toPremultiplied(lt.alpha,lt.texture.baseTexture.alphaMode>0);it[st]=ht,it[st+at]=ht,it[st+at*2]=ht,it[st+at*3]=ht,st+=at*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ParticleRenderer.extension={name:"particle",type:ExtensionType.RendererPlugin};extensions$1.add(ParticleRenderer);var TEXT_GRADIENT=(tt=>(tt[tt.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",tt[tt.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",tt))(TEXT_GRADIENT||{});const contextSettings={willReadFrequently:!0},_TextMetrics=class Oi{static get experimentalLetterSpacingSupported(){let et=Oi._experimentalLetterSpacingSupported;if(et!==void 0){const rt=settings.ADAPTER.getCanvasRenderingContext2D().prototype;et=Oi._experimentalLetterSpacingSupported="letterSpacing"in rt||"textLetterSpacing"in rt}return et}constructor(et,rt,nt,it,at,st,ot,lt,ht){this.text=et,this.style=rt,this.width=nt,this.height=it,this.lines=at,this.lineWidths=st,this.lineHeight=ot,this.maxLineWidth=lt,this.fontProperties=ht}static measureText(et,rt,nt,it=Oi._canvas){nt=nt??rt.wordWrap;const at=rt.toFontString(),st=Oi.measureFont(at);st.fontSize===0&&(st.fontSize=rt.fontSize,st.ascent=rt.fontSize);const ot=it.getContext("2d",contextSettings);ot.font=at;const lt=(nt?Oi.wordWrap(et,rt,it):et).split(/(?:\r\n|\r|\n)/),ht=new Array(lt.length);let dt=0;for(let gt=0;gt<lt.length;gt++){const vt=Oi._measureText(lt[gt],rt.letterSpacing,ot);ht[gt]=vt,dt=Math.max(dt,vt)}let ut=dt+rt.strokeThickness;rt.dropShadow&&(ut+=rt.dropShadowDistance);const ft=rt.lineHeight||st.fontSize+rt.strokeThickness;let mt=Math.max(ft,st.fontSize+rt.strokeThickness*2)+rt.leading+(lt.length-1)*(ft+rt.leading);return rt.dropShadow&&(mt+=rt.dropShadowDistance),new Oi(et,rt,ut,mt,lt,ht,ft+rt.leading,dt,st)}static _measureText(et,rt,nt){let it=!1;Oi.experimentalLetterSpacingSupported&&(Oi.experimentalLetterSpacing?(nt.letterSpacing=`${rt}px`,nt.textLetterSpacing=`${rt}px`,it=!0):(nt.letterSpacing="0px",nt.textLetterSpacing="0px"));let at=nt.measureText(et).width;return at>0&&(it?at-=rt:at+=(Oi.graphemeSegmenter(et).length-1)*rt),at}static wordWrap(et,rt,nt=Oi._canvas){const it=nt.getContext("2d",contextSettings);let at=0,st="",ot="";const lt=Object.create(null),{letterSpacing:ht,whiteSpace:dt}=rt,ut=Oi.collapseSpaces(dt),ft=Oi.collapseNewlines(dt);let mt=!ut;const gt=rt.wordWrapWidth+ht,vt=Oi.tokenize(et);for(let xt=0;xt<vt.length;xt++){let wt=vt[xt];if(Oi.isNewline(wt)){if(!ft){ot+=Oi.addLine(st),mt=!ut,st="",at=0;continue}wt=" "}if(ut){const Tt=Oi.isBreakingSpace(wt),Pt=Oi.isBreakingSpace(st[st.length-1]);if(Tt&&Pt)continue}const At=Oi.getFromCache(wt,ht,lt,it);if(At>gt)if(st!==""&&(ot+=Oi.addLine(st),st="",at=0),Oi.canBreakWords(wt,rt.breakWords)){const Tt=Oi.wordWrapSplit(wt);for(let Pt=0;Pt<Tt.length;Pt++){let Rt=Tt[Pt],Ot=Rt,Et=1;for(;Tt[Pt+Et];){const kt=Tt[Pt+Et];if(!Oi.canBreakChars(Ot,kt,wt,Pt,rt.breakWords))Rt+=kt;else break;Ot=kt,Et++}Pt+=Et-1;const Lt=Oi.getFromCache(Rt,ht,lt,it);Lt+at>gt&&(ot+=Oi.addLine(st),mt=!1,st="",at=0),st+=Rt,at+=Lt}}else{st.length>0&&(ot+=Oi.addLine(st),st="",at=0);const Tt=xt===vt.length-1;ot+=Oi.addLine(wt,!Tt),mt=!1,st="",at=0}else At+at>gt&&(mt=!1,ot+=Oi.addLine(st),st="",at=0),(st.length>0||!Oi.isBreakingSpace(wt)||mt)&&(st+=wt,at+=At)}return ot+=Oi.addLine(st,!1),ot}static addLine(et,rt=!0){return et=Oi.trimRight(et),et=rt?`${et}
`:et,et}static getFromCache(et,rt,nt,it){let at=nt[et];return typeof at!="number"&&(at=Oi._measureText(et,rt,it)+rt,nt[et]=at),at}static collapseSpaces(et){return et==="normal"||et==="pre-line"}static collapseNewlines(et){return et==="normal"}static trimRight(et){if(typeof et!="string")return"";for(let rt=et.length-1;rt>=0;rt--){const nt=et[rt];if(!Oi.isBreakingSpace(nt))break;et=et.slice(0,-1)}return et}static isNewline(et){return typeof et!="string"?!1:Oi._newlines.includes(et.charCodeAt(0))}static isBreakingSpace(et,rt){return typeof et!="string"?!1:Oi._breakingSpaces.includes(et.charCodeAt(0))}static tokenize(et){const rt=[];let nt="";if(typeof et!="string")return rt;for(let it=0;it<et.length;it++){const at=et[it],st=et[it+1];if(Oi.isBreakingSpace(at,st)||Oi.isNewline(at)){nt!==""&&(rt.push(nt),nt=""),rt.push(at);continue}nt+=at}return nt!==""&&rt.push(nt),rt}static canBreakWords(et,rt){return rt}static canBreakChars(et,rt,nt,it,at){return!0}static wordWrapSplit(et){return Oi.graphemeSegmenter(et)}static measureFont(et){if(Oi._fonts[et])return Oi._fonts[et];const rt={ascent:0,descent:0,fontSize:0},nt=Oi._canvas,it=Oi._context;it.font=et;const at=Oi.METRICS_STRING+Oi.BASELINE_SYMBOL,st=Math.ceil(it.measureText(at).width);let ot=Math.ceil(it.measureText(Oi.BASELINE_SYMBOL).width);const lt=Math.ceil(Oi.HEIGHT_MULTIPLIER*ot);if(ot=ot*Oi.BASELINE_MULTIPLIER|0,st===0||lt===0)return Oi._fonts[et]=rt,rt;nt.width=st,nt.height=lt,it.fillStyle="#f00",it.fillRect(0,0,st,lt),it.font=et,it.textBaseline="alphabetic",it.fillStyle="#000",it.fillText(at,0,ot);const ht=it.getImageData(0,0,st,lt).data,dt=ht.length,ut=st*4;let ft=0,mt=0,gt=!1;for(ft=0;ft<ot;++ft){for(let vt=0;vt<ut;vt+=4)if(ht[mt+vt]!==255){gt=!0;break}if(!gt)mt+=ut;else break}for(rt.ascent=ot-ft,mt=dt-ut,gt=!1,ft=lt;ft>ot;--ft){for(let vt=0;vt<ut;vt+=4)if(ht[mt+vt]!==255){gt=!0;break}if(!gt)mt-=ut;else break}return rt.descent=ft-ot,rt.fontSize=rt.ascent+rt.descent,Oi._fonts[et]=rt,rt}static clearMetrics(et=""){et?delete Oi._fonts[et]:Oi._fonts={}}static get _canvas(){if(!Oi.__canvas){let et;try{const rt=new OffscreenCanvas(0,0);if(rt.getContext("2d",contextSettings)?.measureText)return Oi.__canvas=rt,rt;et=settings.ADAPTER.createCanvas()}catch{et=settings.ADAPTER.createCanvas()}et.width=et.height=10,Oi.__canvas=et}return Oi.__canvas}static get _context(){return Oi.__context||(Oi.__context=Oi._canvas.getContext("2d",contextSettings)),Oi.__context}};_TextMetrics.METRICS_STRING="|q",_TextMetrics.BASELINE_SYMBOL="M",_TextMetrics.BASELINE_MULTIPLIER=1.4,_TextMetrics.HEIGHT_MULTIPLIER=2,_TextMetrics.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const tt=new Intl.Segmenter;return et=>[...tt.segment(et)].map(rt=>rt.segment)}return tt=>[...tt]})(),_TextMetrics.experimentalLetterSpacing=!1,_TextMetrics._fonts={},_TextMetrics._newlines=[10,13],_TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let TextMetrics=_TextMetrics;const genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_TextStyle=class Wh{constructor(et){this.styleID=0,this.reset(),deepCopyProperties(this,et,et)}clone(){const et={};return deepCopyProperties(et,this,Wh.defaultStyle),new Wh(et)}reset(){deepCopyProperties(this,Wh.defaultStyle,Wh.defaultStyle)}get align(){return this._align}set align(et){this._align!==et&&(this._align=et,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(et){this._breakWords!==et&&(this._breakWords=et,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(et){this._dropShadow!==et&&(this._dropShadow=et,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(et){this._dropShadowAlpha!==et&&(this._dropShadowAlpha=et,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(et){this._dropShadowAngle!==et&&(this._dropShadowAngle=et,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(et){this._dropShadowBlur!==et&&(this._dropShadowBlur=et,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(et){const rt=getColor(et);this._dropShadowColor!==rt&&(this._dropShadowColor=rt,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(et){this._dropShadowDistance!==et&&(this._dropShadowDistance=et,this.styleID++)}get fill(){return this._fill}set fill(et){const rt=getColor(et);this._fill!==rt&&(this._fill=rt,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(et){this._fillGradientType!==et&&(this._fillGradientType=et,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(et){areArraysEqual(this._fillGradientStops,et)||(this._fillGradientStops=et,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(et){this.fontFamily!==et&&(this._fontFamily=et,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(et){this._fontSize!==et&&(this._fontSize=et,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(et){this._fontStyle!==et&&(this._fontStyle=et,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(et){this._fontVariant!==et&&(this._fontVariant=et,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(et){this._fontWeight!==et&&(this._fontWeight=et,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(et){this._letterSpacing!==et&&(this._letterSpacing=et,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(et){this._lineHeight!==et&&(this._lineHeight=et,this.styleID++)}get leading(){return this._leading}set leading(et){this._leading!==et&&(this._leading=et,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(et){this._lineJoin!==et&&(this._lineJoin=et,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(et){this._miterLimit!==et&&(this._miterLimit=et,this.styleID++)}get padding(){return this._padding}set padding(et){this._padding!==et&&(this._padding=et,this.styleID++)}get stroke(){return this._stroke}set stroke(et){const rt=getColor(et);this._stroke!==rt&&(this._stroke=rt,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(et){this._strokeThickness!==et&&(this._strokeThickness=et,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(et){this._textBaseline!==et&&(this._textBaseline=et,this.styleID++)}get trim(){return this._trim}set trim(et){this._trim!==et&&(this._trim=et,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(et){this._whiteSpace!==et&&(this._whiteSpace=et,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(et){this._wordWrap!==et&&(this._wordWrap=et,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(et){this._wordWrapWidth!==et&&(this._wordWrapWidth=et,this.styleID++)}toFontString(){const et=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let rt=this.fontFamily;Array.isArray(this.fontFamily)||(rt=this.fontFamily.split(","));for(let nt=rt.length-1;nt>=0;nt--){let it=rt[nt].trim();!/([\"\'])[^\'\"]+\1/.test(it)&&!genericFontFamilies.includes(it)&&(it=`"${it}"`),rt[nt]=it}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${et} ${rt.join(",")}`}};_TextStyle.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let TextStyle=_TextStyle;function getColor(tt){const et=Color.shared,rt=nt=>{const it=et.setValue(nt);return it.alpha===1?it.toHex():it.toRgbaString()};return Array.isArray(tt)?tt.map(rt):rt(tt)}function areArraysEqual(tt,et){if(!Array.isArray(tt)||!Array.isArray(et)||tt.length!==et.length)return!1;for(let rt=0;rt<tt.length;++rt)if(tt[rt]!==et[rt])return!1;return!0}function deepCopyProperties(tt,et,rt){for(const nt in rt)Array.isArray(et[nt])?tt[nt]=et[nt].slice():tt[nt]=et[nt]}const defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_Text=class mf extends Sprite{constructor(et,rt,nt){let it=!1;nt||(nt=settings.ADAPTER.createCanvas(),it=!0),nt.width=3,nt.height=3;const at=Texture.from(nt);at.orig=new Rectangle,at.trim=new Rectangle,super(at),this._ownCanvas=it,this.canvas=nt,this.context=nt.getContext("2d",{willReadFrequently:!0}),this._resolution=mf.defaultResolution??settings.RESOLUTION,this._autoResolution=mf.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=et,this.style=rt,this.localStyleID=-1}static get experimentalLetterSpacing(){return TextMetrics.experimentalLetterSpacing}static set experimentalLetterSpacing(et){deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),TextMetrics.experimentalLetterSpacing=et}updateText(et){const rt=this._style;if(this.localStyleID!==rt.styleID&&(this.dirty=!0,this.localStyleID=rt.styleID),!this.dirty&&et)return;this._font=this._style.toFontString();const nt=this.context,it=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),at=it.width,st=it.height,ot=it.lines,lt=it.lineHeight,ht=it.lineWidths,dt=it.maxLineWidth,ut=it.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,at)+rt.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,st)+rt.padding*2)*this._resolution),nt.scale(this._resolution,this._resolution),nt.clearRect(0,0,this.canvas.width,this.canvas.height),nt.font=this._font,nt.lineWidth=rt.strokeThickness,nt.textBaseline=rt.textBaseline,nt.lineJoin=rt.lineJoin,nt.miterLimit=rt.miterLimit;let ft,mt;const gt=rt.dropShadow?2:1;for(let vt=0;vt<gt;++vt){const xt=rt.dropShadow&&vt===0,wt=xt?Math.ceil(Math.max(1,st)+rt.padding*2):0,At=wt*this._resolution;if(xt){nt.fillStyle="black",nt.strokeStyle="black";const Pt=rt.dropShadowColor,Rt=rt.dropShadowBlur*this._resolution,Ot=rt.dropShadowDistance*this._resolution;nt.shadowColor=Color.shared.setValue(Pt).setAlpha(rt.dropShadowAlpha).toRgbaString(),nt.shadowBlur=Rt,nt.shadowOffsetX=Math.cos(rt.dropShadowAngle)*Ot,nt.shadowOffsetY=Math.sin(rt.dropShadowAngle)*Ot+At}else nt.fillStyle=this._generateFillStyle(rt,ot,it),nt.strokeStyle=rt.stroke,nt.shadowColor="black",nt.shadowBlur=0,nt.shadowOffsetX=0,nt.shadowOffsetY=0;let Tt=(lt-ut.fontSize)/2;lt-ut.fontSize<0&&(Tt=0);for(let Pt=0;Pt<ot.length;Pt++)ft=rt.strokeThickness/2,mt=rt.strokeThickness/2+Pt*lt+ut.ascent+Tt,rt.align==="right"?ft+=dt-ht[Pt]:rt.align==="center"&&(ft+=(dt-ht[Pt])/2),rt.stroke&&rt.strokeThickness&&this.drawLetterSpacing(ot[Pt],ft+rt.padding,mt+rt.padding-wt,!0),rt.fill&&this.drawLetterSpacing(ot[Pt],ft+rt.padding,mt+rt.padding-wt)}this.updateTexture()}drawLetterSpacing(et,rt,nt,it=!1){const at=this._style.letterSpacing;let st=!1;if(TextMetrics.experimentalLetterSpacingSupported&&(TextMetrics.experimentalLetterSpacing?(this.context.letterSpacing=`${at}px`,this.context.textLetterSpacing=`${at}px`,st=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),at===0||st){it?this.context.strokeText(et,rt,nt):this.context.fillText(et,rt,nt);return}let ot=rt;const lt=TextMetrics.graphemeSegmenter(et);let ht=this.context.measureText(et).width,dt=0;for(let ut=0;ut<lt.length;++ut){const ft=lt[ut];it?this.context.strokeText(ft,ot,nt):this.context.fillText(ft,ot,nt);let mt="";for(let gt=ut+1;gt<lt.length;++gt)mt+=lt[gt];dt=this.context.measureText(mt).width,ot+=ht-dt+at,ht=dt}}updateTexture(){const et=this.canvas;if(this._style.trim){const st=trimCanvas(et);st.data&&(et.width=st.width,et.height=st.height,this.context.putImageData(st.data,0,0))}const rt=this._texture,nt=this._style,it=nt.trim?0:nt.padding,at=rt.baseTexture;rt.trim.width=rt._frame.width=et.width/this._resolution,rt.trim.height=rt._frame.height=et.height/this._resolution,rt.trim.x=-it,rt.trim.y=-it,rt.orig.width=rt._frame.width-it*2,rt.orig.height=rt._frame.height-it*2,this._onTextureUpdate(),at.setRealSize(et.width,et.height,this._resolution),rt.updateUvs(),this.dirty=!1}_render(et){this._autoResolution&&this._resolution!==et.resolution&&(this._resolution=et.resolution,this.dirty=!0),this.updateText(!0),super._render(et)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(et,rt){return this.updateText(!0),this._textureID===-1&&(et=!1),super.getBounds(et,rt)}getLocalBounds(et){return this.updateText(!0),super.getLocalBounds.call(this,et)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(et,rt,nt){const it=et.fill;if(Array.isArray(it)){if(it.length===1)return it[0]}else return it;let at;const st=et.dropShadow?et.dropShadowDistance:0,ot=et.padding||0,lt=this.canvas.width/this._resolution-st-ot*2,ht=this.canvas.height/this._resolution-st-ot*2,dt=it.slice(),ut=et.fillGradientStops.slice();if(!ut.length){const ft=dt.length+1;for(let mt=1;mt<ft;++mt)ut.push(mt/ft)}if(dt.unshift(it[0]),ut.unshift(0),dt.push(it[it.length-1]),ut.push(1),et.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){at=this.context.createLinearGradient(lt/2,ot,lt/2,ht+ot);const ft=nt.fontProperties.fontSize+et.strokeThickness;for(let mt=0;mt<rt.length;mt++){const gt=nt.lineHeight*(mt-1)+ft,vt=nt.lineHeight*mt;let xt=vt;mt>0&&gt>vt&&(xt=(vt+gt)/2);const wt=vt+ft,At=nt.lineHeight*(mt+1);let Tt=wt;mt+1<rt.length&&At<wt&&(Tt=(wt+At)/2);const Pt=(Tt-xt)/ht;for(let Rt=0;Rt<dt.length;Rt++){let Ot=0;typeof ut[Rt]=="number"?Ot=ut[Rt]:Ot=Rt/dt.length;let Et=Math.min(1,Math.max(0,xt/ht+Ot*Pt));Et=Number(Et.toFixed(5)),at.addColorStop(Et,dt[Rt])}}}else{at=this.context.createLinearGradient(ot,ht/2,lt+ot,ht/2);const ft=dt.length+1;let mt=1;for(let gt=0;gt<dt.length;gt++){let vt;typeof ut[gt]=="number"?vt=ut[gt]:vt=mt/ft,at.addColorStop(vt,dt[gt]),mt++}}return at}destroy(et){typeof et=="boolean"&&(et={children:et}),et=Object.assign({},defaultDestroyOptions,et),super.destroy(et),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(et){this.updateText(!0);const rt=sign(this.scale.x)||1;this.scale.x=rt*et/this._texture.orig.width,this._width=et}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(et){this.updateText(!0);const rt=sign(this.scale.y)||1;this.scale.y=rt*et/this._texture.orig.height,this._height=et}get style(){return this._style}set style(et){et=et||{},et instanceof TextStyle?this._style=et:this._style=new TextStyle(et),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(et){et=String(et??""),this._text!==et&&(this._text=et,this.dirty=!0)}get resolution(){return this._resolution}set resolution(et){this._autoResolution=!1,this._resolution!==et&&(this._resolution=et,this.dirty=!0)}};_Text.defaultAutoResolution=!0;let Text=_Text;class CountLimiter{constructor(et){this.maxItemsPerFrame=et,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function findMultipleBaseTextures(tt,et){let rt=!1;if(tt?._textures?.length){for(let nt=0;nt<tt._textures.length;nt++)if(tt._textures[nt]instanceof Texture){const it=tt._textures[nt].baseTexture;et.includes(it)||(et.push(it),rt=!0)}}return rt}function findBaseTexture(tt,et){if(tt.baseTexture instanceof BaseTexture){const rt=tt.baseTexture;return et.includes(rt)||et.push(rt),!0}return!1}function findTexture(tt,et){if(tt._texture&&tt._texture instanceof Texture){const rt=tt._texture.baseTexture;return et.includes(rt)||et.push(rt),!0}return!1}function drawText(tt,et){return et instanceof Text?(et.updateText(!0),!0):!1}function calculateTextStyle(tt,et){if(et instanceof TextStyle){const rt=et.toFontString();return TextMetrics.measureFont(rt),!0}return!1}function findText(tt,et){if(tt instanceof Text){et.includes(tt.style)||et.push(tt.style),et.includes(tt)||et.push(tt);const rt=tt._texture.baseTexture;return et.includes(rt)||et.push(rt),!0}return!1}function findTextStyle(tt,et){return tt instanceof TextStyle?(et.includes(tt)||et.push(tt),!0):!1}const _BasePrepare=class ep{constructor(et){this.limiter=new CountLimiter(ep.uploadsPerFrame),this.renderer=et,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}upload(et){return new Promise(rt=>{et&&this.add(et),this.queue.length?(this.completes.push(rt),this.ticking||(this.ticking=!0,Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):rt()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const et=this.queue[0];let rt=!1;if(et&&!et._destroyed){for(let nt=0,it=this.uploadHooks.length;nt<it;nt++)if(this.uploadHooks[nt](this.uploadHookHelper,et)){this.queue.shift(),rt=!0;break}}rt||this.queue.shift()}if(this.queue.length)Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;const et=this.completes.slice(0);this.completes.length=0;for(let rt=0,nt=et.length;rt<nt;rt++)et[rt]()}}registerFindHook(et){return et&&this.addHooks.push(et),this}registerUploadHook(et){return et&&this.uploadHooks.push(et),this}add(et){for(let rt=0,nt=this.addHooks.length;rt<nt&&!this.addHooks[rt](et,this.queue);rt++);if(et instanceof Container)for(let rt=et.children.length-1;rt>=0;rt--)this.add(et.children[rt]);return this}destroy(){this.ticking&&Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};_BasePrepare.uploadsPerFrame=4;let BasePrepare=_BasePrepare;Object.defineProperties(settings,{UPLOADS_PER_FRAME:{get(){return BasePrepare.uploadsPerFrame},set(tt){deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),BasePrepare.uploadsPerFrame=tt}}});function uploadBaseTextures(tt,et){return et instanceof BaseTexture?(et._glTextures[tt.CONTEXT_UID]||tt.texture.bind(et),!0):!1}function uploadGraphics(tt,et){if(!(et instanceof Graphics))return!1;const{geometry:rt}=et;et.finishPoly(),rt.updateBatches();const{batches:nt}=rt;for(let it=0;it<nt.length;it++){const{texture:at}=nt[it].style;at&&uploadBaseTextures(tt,at.baseTexture)}return rt.batchable||tt.geometry.bind(rt,et._resolveDirectShader(tt)),!0}function findGraphics(tt,et){return tt instanceof Graphics?(et.push(tt),!0):!1}class Prepare extends BasePrepare{constructor(et){super(et),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}}Prepare.extension={name:"prepare",type:ExtensionType.RendererSystem};extensions$1.add(Prepare);class AnimatedSprite extends Sprite{constructor(et,rt=!0){super(et[0]instanceof Texture?et[0]:et[0].texture),this._textures=null,this._durations=null,this._autoUpdate=rt,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=et}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this,UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(et){this.stop(),this.currentFrame=et}gotoAndPlay(et){this.currentFrame=et,this.play()}update(et){if(!this._playing)return;const rt=this.animationSpeed*et,nt=this.currentFrame;if(this._durations!==null){let it=this._currentTime%1*this._durations[this.currentFrame];for(it+=rt/60*1e3;it<0;)this._currentTime--,it+=this._durations[this.currentFrame];const at=Math.sign(this.animationSpeed*et);for(this._currentTime=Math.floor(this._currentTime);it>=this._durations[this.currentFrame];)it-=this._durations[this.currentFrame]*at,this._currentTime+=at;this._currentTime+=it/this._durations[this.currentFrame]}else this._currentTime+=rt;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):nt!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<nt||this.animationSpeed<0&&this.currentFrame>nt)&&this.onLoop(),this.updateTexture())}updateTexture(){const et=this.currentFrame;this._previousFrame!==et&&(this._previousFrame=et,this._texture=this._textures[et],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(et){this.stop(),super.destroy(et),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(et){const rt=[];for(let nt=0;nt<et.length;++nt)rt.push(Texture.from(et[nt]));return new AnimatedSprite(rt)}static fromImages(et){const rt=[];for(let nt=0;nt<et.length;++nt)rt.push(Texture.from(et[nt]));return new AnimatedSprite(rt)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(et){if(et[0]instanceof Texture)this._textures=et,this._durations=null;else{this._textures=[],this._durations=[];for(let rt=0;rt<et.length;rt++)this._textures.push(et[rt].texture),this._durations.push(et[rt].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let et=Math.floor(this._currentTime)%this._textures.length;return et<0&&(et+=this._textures.length),et}set currentFrame(et){if(et<0||et>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${et}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const rt=this.currentFrame;this._currentTime=et,rt!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(et){et!==this._autoUpdate&&(this._autoUpdate=et,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const tempPoint=new Point$2;class TilingSprite extends Sprite{constructor(et,rt=100,nt=100){super(et),this.tileTransform=new Transform,this._width=rt,this._height=nt,this.uvMatrix=this.texture.uvMatrix||new TextureMatrix(et),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(et){this.uvMatrix.clampMargin=et,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(et){this.tileTransform.scale.copyFrom(et)}get tilePosition(){return this.tileTransform.position}set tilePosition(et){this.tileTransform.position.copyFrom(et)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(et){const rt=this._texture;!rt||!rt.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),et.batch.setObjectRenderer(et.plugins[this.pluginName]),et.plugins[this.pluginName].render(this))}_calculateBounds(){const et=this._width*-this._anchor._x,rt=this._height*-this._anchor._y,nt=this._width*(1-this._anchor._x),it=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,et,rt,nt,it)}getLocalBounds(et){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),et||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),et=this._localBoundsRect),this._bounds.getRectangle(et)):super.getLocalBounds.call(this,et)}containsPoint(et){this.worldTransform.applyInverse(et,tempPoint);const rt=this._width,nt=this._height,it=-rt*this.anchor._x;if(tempPoint.x>=it&&tempPoint.x<it+rt){const at=-nt*this.anchor._y;if(tempPoint.y>=at&&tempPoint.y<at+nt)return!0}return!1}destroy(et){super.destroy(et),this.tileTransform=null,this.uvMatrix=null}static from(et,rt){const nt=et instanceof Texture?et:Texture.from(et,rt);return new TilingSprite(nt,rt.width,rt.height)}get width(){return this._width}set width(et){this._width=et}get height(){return this._height}set height(et){this._height=et}}var gl2FragmentSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,gl2VertexSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gl1FragmentSrc=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gl1VertexSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,fragmentSimpleSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const tempMat=new Matrix;class TilingSpriteRenderer extends ObjectRenderer{constructor(et){super(et),et.runners.contextChange.add(this),this.quad=new QuadUv,this.state=State.for2d()}contextChange(){const et=this.renderer,rt={globals:et.globalUniforms};this.simpleShader=Shader.from(gl1VertexSrc,fragmentSimpleSrc,rt),this.shader=et.context.webGLVersion>1?Shader.from(gl2VertexSrc,gl2FragmentSrc,rt):Shader.from(gl1VertexSrc,gl1FragmentSrc,rt)}render(et){const rt=this.renderer,nt=this.quad;let it=nt.vertices;it[0]=it[6]=et._width*-et.anchor.x,it[1]=it[3]=et._height*-et.anchor.y,it[2]=it[4]=et._width*(1-et.anchor.x),it[5]=it[7]=et._height*(1-et.anchor.y);const at=et.uvRespectAnchor?et.anchor.x:0,st=et.uvRespectAnchor?et.anchor.y:0;it=nt.uvs,it[0]=it[6]=-at,it[1]=it[3]=-st,it[2]=it[4]=1-at,it[5]=it[7]=1-st,nt.invalidate();const ot=et._texture,lt=ot.baseTexture,ht=lt.alphaMode>0,dt=et.tileTransform.localTransform,ut=et.uvMatrix;let ft=lt.isPowerOfTwo&&ot.frame.width===lt.width&&ot.frame.height===lt.height;ft&&(lt._glTextures[rt.CONTEXT_UID]?ft=lt.wrapMode!==WRAP_MODES.CLAMP:lt.wrapMode===WRAP_MODES.CLAMP&&(lt.wrapMode=WRAP_MODES.REPEAT));const mt=ft?this.simpleShader:this.shader,gt=ot.width,vt=ot.height,xt=et._width,wt=et._height;tempMat.set(dt.a*gt/xt,dt.b*gt/wt,dt.c*vt/xt,dt.d*vt/wt,dt.tx/xt,dt.ty/wt),tempMat.invert(),ft?tempMat.prepend(ut.mapCoord):(mt.uniforms.uMapCoord=ut.mapCoord.toArray(!0),mt.uniforms.uClampFrame=ut.uClampFrame,mt.uniforms.uClampOffset=ut.uClampOffset),mt.uniforms.uTransform=tempMat.toArray(!0),mt.uniforms.uColor=Color.shared.setValue(et.tint).premultiply(et.worldAlpha,ht).toArray(mt.uniforms.uColor),mt.uniforms.translationMatrix=et.transform.worldTransform.toArray(!0),mt.uniforms.uSampler=ot,rt.shader.bind(mt),rt.geometry.bind(nt),this.state.blendMode=correctBlendMode(et.blendMode,ht),rt.state.set(this.state),rt.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}TilingSpriteRenderer.extension={name:"tilingSprite",type:ExtensionType.RendererPlugin};extensions$1.add(TilingSpriteRenderer);const _Spritesheet=class qh{constructor(et,rt,nt){this.linkedSheets=[],(et instanceof BaseTexture||et instanceof Texture)&&(et={texture:et,data:rt,resolutionFilename:nt});const{texture:it,data:at,resolutionFilename:st=null,cachePrefix:ot=""}=et;this.cachePrefix=ot,this._texture=it instanceof Texture?it:null,this.baseTexture=it instanceof BaseTexture?it:this._texture.baseTexture,this.textures={},this.animations={},this.data=at;const lt=this.baseTexture.resource;this.resolution=this._updateResolution(st||(lt?lt.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(et=null){const{scale:rt}=this.data.meta;let nt=getResolutionOfUrl(et,null);return nt===null&&(nt=typeof rt=="number"?rt:parseFloat(rt??"1")),nt!==1&&this.baseTexture.setResolution(nt),nt}parse(){return new Promise(et=>{this._callback=et,this._batchIndex=0,this._frameKeys.length<=qh.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(et){let rt=et;const nt=qh.BATCH_SIZE;for(;rt-et<nt&&rt<this._frameKeys.length;){const it=this._frameKeys[rt],at=this._frames[it],st=at.frame;if(st){let ot=null,lt=null;const ht=at.trimmed!==!1&&at.sourceSize?at.sourceSize:at.frame,dt=new Rectangle(0,0,Math.floor(ht.w)/this.resolution,Math.floor(ht.h)/this.resolution);at.rotated?ot=new Rectangle(Math.floor(st.x)/this.resolution,Math.floor(st.y)/this.resolution,Math.floor(st.h)/this.resolution,Math.floor(st.w)/this.resolution):ot=new Rectangle(Math.floor(st.x)/this.resolution,Math.floor(st.y)/this.resolution,Math.floor(st.w)/this.resolution,Math.floor(st.h)/this.resolution),at.trimmed!==!1&&at.spriteSourceSize&&(lt=new Rectangle(Math.floor(at.spriteSourceSize.x)/this.resolution,Math.floor(at.spriteSourceSize.y)/this.resolution,Math.floor(st.w)/this.resolution,Math.floor(st.h)/this.resolution)),this.textures[it]=new Texture(this.baseTexture,ot,dt,lt,at.rotated?2:0,at.anchor,at.borders),Texture.addToCache(this.textures[it],this.cachePrefix+it.toString())}rt++}}_processAnimations(){const et=this.data.animations||{};for(const rt in et){this.animations[rt]=[];for(let nt=0;nt<et[rt].length;nt++){const it=et[rt][nt];this.animations[rt].push(this.textures[it])}}}_parseComplete(){const et=this._callback;this._callback=null,this._batchIndex=0,et.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*qh.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*qh.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(et=!1){for(const rt in this.textures)this.textures[rt].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,et&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};_Spritesheet.BATCH_SIZE=1e3;let Spritesheet=_Spritesheet;const validImages=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function getCacheableAssets(tt,et,rt){const nt={};if(tt.forEach(it=>{nt[it]=et}),Object.keys(et.textures).forEach(it=>{nt[`${et.cachePrefix}${it}`]=et.textures[it]}),!rt){const it=path.dirname(tt[0]);et.linkedSheets.forEach((at,st)=>{Object.assign(nt,getCacheableAssets([`${it}/${et.data.meta.related_multi_packs[st]}`],at,!0))})}return nt}const spritesheetAsset={extension:ExtensionType.Asset,cache:{test:tt=>tt instanceof Spritesheet,getCacheableAssets:(tt,et)=>getCacheableAssets(tt,et,!1)},resolver:{test:tt=>{const et=tt.split("?")[0].split("."),rt=et.pop(),nt=et.pop();return rt==="json"&&validImages.includes(nt)},parse:tt=>{const et=tt.split(".");return{resolution:parseFloat(settings.RETINA_PREFIX.exec(tt)?.[1]??"1"),format:et[et.length-2],src:tt}}},loader:{name:"spritesheetLoader",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},async testParse(tt,et){return path.extname(et.src).toLowerCase()===".json"&&!!tt.frames},async parse(tt,et,rt){const{texture:nt,imageFilename:it,cachePrefix:at}=et?.data??{};let st=path.dirname(et.src);st&&st.lastIndexOf("/")!==st.length-1&&(st+="/");let ot;if(nt&&nt.baseTexture)ot=nt;else{const dt=copySearchParams(st+(it??tt.meta.image),et.src);ot=(await rt.load([dt]))[dt]}const lt=new Spritesheet({texture:ot.baseTexture,data:tt,resolutionFilename:et.src,cachePrefix:at});await lt.parse();const ht=tt?.meta?.related_multi_packs;if(Array.isArray(ht)){const dt=[];for(const ft of ht){if(typeof ft!="string")continue;let mt=st+ft;et.data?.ignoreMultiPack||(mt=copySearchParams(mt,et.src),dt.push(rt.load({src:mt,data:{ignoreMultiPack:!0}})))}const ut=await Promise.all(dt);lt.linkedSheets=ut,ut.forEach(ft=>{ft.linkedSheets=[lt].concat(lt.linkedSheets.filter(mt=>mt!==ft))})}return lt},unload(tt){tt.destroy(!0)}}};extensions$1.add(spritesheetAsset);class BitmapFontData{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class TextFormat{static test(et){return typeof et=="string"&&et.startsWith("info face=")}static parse(et){const rt=et.match(/^[a-z]+\s+.+$/gm),nt={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const at in rt){const st=rt[at].match(/^[a-z]+/gm)[0],ot=rt[at].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),lt={};for(const ht in ot){const dt=ot[ht].split("="),ut=dt[0],ft=dt[1].replace(/"/gm,""),mt=parseFloat(ft),gt=isNaN(mt)?ft:mt;lt[ut]=gt}nt[st].push(lt)}const it=new BitmapFontData;return nt.info.forEach(at=>it.info.push({face:at.face,size:parseInt(at.size,10)})),nt.common.forEach(at=>it.common.push({lineHeight:parseInt(at.lineHeight,10)})),nt.page.forEach(at=>it.page.push({id:parseInt(at.id,10),file:at.file})),nt.char.forEach(at=>it.char.push({id:parseInt(at.id,10),page:parseInt(at.page,10),x:parseInt(at.x,10),y:parseInt(at.y,10),width:parseInt(at.width,10),height:parseInt(at.height,10),xoffset:parseInt(at.xoffset,10),yoffset:parseInt(at.yoffset,10),xadvance:parseInt(at.xadvance,10)})),nt.kerning.forEach(at=>it.kerning.push({first:parseInt(at.first,10),second:parseInt(at.second,10),amount:parseInt(at.amount,10)})),nt.distanceField.forEach(at=>it.distanceField.push({distanceRange:parseInt(at.distanceRange,10),fieldType:at.fieldType})),it}}class XMLFormat{static test(et){const rt=et;return typeof et!="string"&&"getElementsByTagName"in et&&rt.getElementsByTagName("page").length&&rt.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(et){const rt=new BitmapFontData,nt=et.getElementsByTagName("info"),it=et.getElementsByTagName("common"),at=et.getElementsByTagName("page"),st=et.getElementsByTagName("char"),ot=et.getElementsByTagName("kerning"),lt=et.getElementsByTagName("distanceField");for(let ht=0;ht<nt.length;ht++)rt.info.push({face:nt[ht].getAttribute("face"),size:parseInt(nt[ht].getAttribute("size"),10)});for(let ht=0;ht<it.length;ht++)rt.common.push({lineHeight:parseInt(it[ht].getAttribute("lineHeight"),10)});for(let ht=0;ht<at.length;ht++)rt.page.push({id:parseInt(at[ht].getAttribute("id"),10)||0,file:at[ht].getAttribute("file")});for(let ht=0;ht<st.length;ht++){const dt=st[ht];rt.char.push({id:parseInt(dt.getAttribute("id"),10),page:parseInt(dt.getAttribute("page"),10)||0,x:parseInt(dt.getAttribute("x"),10),y:parseInt(dt.getAttribute("y"),10),width:parseInt(dt.getAttribute("width"),10),height:parseInt(dt.getAttribute("height"),10),xoffset:parseInt(dt.getAttribute("xoffset"),10),yoffset:parseInt(dt.getAttribute("yoffset"),10),xadvance:parseInt(dt.getAttribute("xadvance"),10)})}for(let ht=0;ht<ot.length;ht++)rt.kerning.push({first:parseInt(ot[ht].getAttribute("first"),10),second:parseInt(ot[ht].getAttribute("second"),10),amount:parseInt(ot[ht].getAttribute("amount"),10)});for(let ht=0;ht<lt.length;ht++)rt.distanceField.push({fieldType:lt[ht].getAttribute("fieldType"),distanceRange:parseInt(lt[ht].getAttribute("distanceRange"),10)});return rt}}class XMLStringFormat{static test(et){return typeof et=="string"&&et.includes("<font>")?XMLFormat.test(settings.ADAPTER.parseXML(et)):!1}static parse(et){return XMLFormat.parse(settings.ADAPTER.parseXML(et))}}const formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(tt){for(let et=0;et<formats.length;et++)if(formats[et].test(tt))return formats[et];return null}function generateFillStyle(tt,et,rt,nt,it,at){const st=rt.fill;if(Array.isArray(st)){if(st.length===1)return st[0]}else return st;let ot;const lt=rt.dropShadow?rt.dropShadowDistance:0,ht=rt.padding||0,dt=tt.width/nt-lt-ht*2,ut=tt.height/nt-lt-ht*2,ft=st.slice(),mt=rt.fillGradientStops.slice();if(!mt.length){const gt=ft.length+1;for(let vt=1;vt<gt;++vt)mt.push(vt/gt)}if(ft.unshift(st[0]),mt.unshift(0),ft.push(st[st.length-1]),mt.push(1),rt.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){ot=et.createLinearGradient(dt/2,ht,dt/2,ut+ht);let gt=0;const vt=(at.fontProperties.fontSize+rt.strokeThickness)/ut;for(let xt=0;xt<it.length;xt++){const wt=at.lineHeight*xt;for(let At=0;At<ft.length;At++){let Tt=0;typeof mt[At]=="number"?Tt=mt[At]:Tt=At/ft.length;const Pt=wt/ut+Tt*vt;let Rt=Math.max(gt,Pt);Rt=Math.min(Rt,1),ot.addColorStop(Rt,ft[At]),gt=Rt}}}else{ot=et.createLinearGradient(ht,ut/2,dt+ht,ut/2);const gt=ft.length+1;let vt=1;for(let xt=0;xt<ft.length;xt++){let wt;typeof mt[xt]=="number"?wt=mt[xt]:wt=vt/gt,ot.addColorStop(wt,ft[xt]),vt++}}return ot}function drawGlyph(tt,et,rt,nt,it,at,st){const ot=rt.text,lt=rt.fontProperties;et.translate(nt,it),et.scale(at,at);const ht=st.strokeThickness/2,dt=-(st.strokeThickness/2);if(et.font=st.toFontString(),et.lineWidth=st.strokeThickness,et.textBaseline=st.textBaseline,et.lineJoin=st.lineJoin,et.miterLimit=st.miterLimit,et.fillStyle=generateFillStyle(tt,et,st,at,[ot],rt),et.strokeStyle=st.stroke,st.dropShadow){const ut=st.dropShadowColor,ft=st.dropShadowBlur*at,mt=st.dropShadowDistance*at;et.shadowColor=Color.shared.setValue(ut).setAlpha(st.dropShadowAlpha).toRgbaString(),et.shadowBlur=ft,et.shadowOffsetX=Math.cos(st.dropShadowAngle)*mt,et.shadowOffsetY=Math.sin(st.dropShadowAngle)*mt}else et.shadowColor="black",et.shadowBlur=0,et.shadowOffsetX=0,et.shadowOffsetY=0;st.stroke&&st.strokeThickness&&et.strokeText(ot,ht,dt+rt.lineHeight-lt.descent),st.fill&&et.fillText(ot,ht,dt+rt.lineHeight-lt.descent),et.setTransform(1,0,0,1,0,0),et.fillStyle="rgba(0, 0, 0, 0)"}function extractCharCode(tt){return tt.codePointAt?tt.codePointAt(0):tt.charCodeAt(0)}function splitTextToCharacters(tt){return Array.from?Array.from(tt):tt.split("")}function resolveCharacters(tt){typeof tt=="string"&&(tt=[tt]);const et=[];for(let rt=0,nt=tt.length;rt<nt;rt++){const it=tt[rt];if(Array.isArray(it)){if(it.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${it.length}.`);const at=it[0].charCodeAt(0),st=it[1].charCodeAt(0);if(st<at)throw new Error("[BitmapFont]: Invalid character range.");for(let ot=at,lt=st;ot<=lt;ot++)et.push(String.fromCharCode(ot))}else et.push(...splitTextToCharacters(it))}if(et.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return et}const _BitmapFont=class iu{constructor(et,rt,nt){const[it]=et.info,[at]=et.common,[st]=et.page,[ot]=et.distanceField,lt=getResolutionOfUrl(st.file),ht={};this._ownsTextures=nt,this.font=it.face,this.size=it.size,this.lineHeight=at.lineHeight/lt,this.chars={},this.pageTextures=ht;for(let dt=0;dt<et.page.length;dt++){const{id:ut,file:ft}=et.page[dt];ht[ut]=rt instanceof Array?rt[dt]:rt[ft],ot?.fieldType&&ot.fieldType!=="none"&&(ht[ut].baseTexture.alphaMode=ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,ht[ut].baseTexture.mipmap=MIPMAP_MODES.OFF)}for(let dt=0;dt<et.char.length;dt++){const{id:ut,page:ft}=et.char[dt];let{x:mt,y:gt,width:vt,height:xt,xoffset:wt,yoffset:At,xadvance:Tt}=et.char[dt];mt/=lt,gt/=lt,vt/=lt,xt/=lt,wt/=lt,At/=lt,Tt/=lt;const Pt=new Rectangle(mt+ht[ft].frame.x/lt,gt+ht[ft].frame.y/lt,vt,xt);this.chars[ut]={xOffset:wt,yOffset:At,xAdvance:Tt,kerning:{},texture:new Texture(ht[ft].baseTexture,Pt),page:ft}}for(let dt=0;dt<et.kerning.length;dt++){let{first:ut,second:ft,amount:mt}=et.kerning[dt];ut/=lt,ft/=lt,mt/=lt,this.chars[ft]&&(this.chars[ft].kerning[ut]=mt)}this.distanceFieldRange=ot?.distanceRange,this.distanceFieldType=ot?.fieldType?.toLowerCase()??"none"}destroy(){for(const et in this.chars)this.chars[et].texture.destroy(),this.chars[et].texture=null;for(const et in this.pageTextures)this._ownsTextures&&this.pageTextures[et].destroy(!0),this.pageTextures[et]=null;this.chars=null,this.pageTextures=null}static install(et,rt,nt){let it;if(et instanceof BitmapFontData)it=et;else{const st=autoDetectFormat(et);if(!st)throw new Error("Unrecognized data format for font.");it=st.parse(et)}rt instanceof Texture&&(rt=[rt]);const at=new iu(it,rt,nt);return iu.available[at.font]=at,at}static uninstall(et){const rt=iu.available[et];if(!rt)throw new Error(`No font found named '${et}'`);rt.destroy(),delete iu.available[et]}static from(et,rt,nt){if(!et)throw new Error("[BitmapFont] Property `name` is required.");const{chars:it,padding:at,resolution:st,textureWidth:ot,textureHeight:lt,...ht}=Object.assign({},iu.defaultOptions,nt),dt=resolveCharacters(it),ut=rt instanceof TextStyle?rt:new TextStyle(rt),ft=ot,mt=new BitmapFontData;mt.info[0]={face:ut.fontFamily,size:ut.fontSize},mt.common[0]={lineHeight:ut.fontSize};let gt=0,vt=0,xt,wt,At,Tt=0;const Pt=[];for(let Ot=0;Ot<dt.length;Ot++){xt||(xt=settings.ADAPTER.createCanvas(),xt.width=ot,xt.height=lt,wt=xt.getContext("2d"),At=new BaseTexture(xt,{resolution:st,...ht}),Pt.push(new Texture(At)),mt.page.push({id:Pt.length-1,file:""}));const Et=dt[Ot],Lt=TextMetrics.measureText(Et,ut,!1,xt),kt=Lt.width,jt=Math.ceil(Lt.height),Mt=Math.ceil((ut.fontStyle==="italic"?2:1)*kt);if(vt>=lt-jt*st){if(vt===0)throw new Error(`[BitmapFont] textureHeight ${lt}px is too small (fontFamily: '${ut.fontFamily}', fontSize: ${ut.fontSize}px, char: '${Et}')`);--Ot,xt=null,wt=null,At=null,vt=0,gt=0,Tt=0;continue}if(Tt=Math.max(jt+Lt.fontProperties.descent,Tt),Mt*st+gt>=ft){if(gt===0)throw new Error(`[BitmapFont] textureWidth ${ot}px is too small (fontFamily: '${ut.fontFamily}', fontSize: ${ut.fontSize}px, char: '${Et}')`);--Ot,vt+=Tt*st,vt=Math.ceil(vt),gt=0,Tt=0;continue}drawGlyph(xt,wt,Lt,gt,vt,st,ut);const $t=extractCharCode(Lt.text);mt.char.push({id:$t,page:Pt.length-1,x:gt/st,y:vt/st,width:Mt,height:jt,xoffset:0,yoffset:0,xadvance:kt-(ut.dropShadow?ut.dropShadowDistance:0)-(ut.stroke?ut.strokeThickness:0)}),gt+=(Mt+2*at)*st,gt=Math.ceil(gt)}if(!nt?.skipKerning)for(let Ot=0,Et=dt.length;Ot<Et;Ot++){const Lt=dt[Ot];for(let kt=0;kt<Et;kt++){const jt=dt[kt],Mt=wt.measureText(Lt).width,$t=wt.measureText(jt).width,Qt=wt.measureText(Lt+jt).width-(Mt+$t);Qt&&mt.kerning.push({first:extractCharCode(Lt),second:extractCharCode(jt),amount:Qt})}}const Rt=new iu(mt,Pt,!0);return iu.available[et]!==void 0&&iu.uninstall(et),iu.available[et]=Rt,Rt}};_BitmapFont.ALPHA=[["a","z"],["A","Z"]," "],_BitmapFont.NUMERIC=[["0","9"]],_BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],_BitmapFont.ASCII=[[" ","~"]],_BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_BitmapFont.ALPHANUMERIC},_BitmapFont.available={};let BitmapFont=_BitmapFont;var msdfFrag=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,msdfVert=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],_BitmapText=class tp extends Container{constructor(et,rt={}){super();const{align:nt,tint:it,maxWidth:at,letterSpacing:st,fontName:ot,fontSize:lt}=Object.assign({},tp.styleDefaults,rt);if(!BitmapFont.available[ot])throw new Error(`Missing BitmapFont "${ot}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=nt,this._tintColor=new Color(it),this._font=void 0,this._fontName=ot,this._fontSize=lt,this.text=et,this._maxWidth=at,this._maxLineHeight=0,this._letterSpacing=st,this._anchor=new ObservablePoint(()=>{this.dirty=!0},this,0,0),this._roundPixels=settings.ROUND_PIXELS,this.dirty=!0,this._resolution=settings.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const et=BitmapFont.available[this._fontName],rt=this.fontSize,nt=rt/et.size,it=new Point$2,at=[],st=[],ot=[],lt=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",ht=splitTextToCharacters(lt),dt=this._maxWidth*et.size/rt,ut=et.distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;let ft=null,mt=0,gt=0,vt=0,xt=-1,wt=0,At=0,Tt=0,Pt=0;for(let Mt=0;Mt<ht.length;Mt++){const $t=ht[Mt],Qt=extractCharCode($t);if(/(?:\s)/.test($t)&&(xt=Mt,wt=mt,Pt++),$t==="\r"||$t===`
`){st.push(mt),ot.push(-1),gt=Math.max(gt,mt),++vt,++At,it.x=0,it.y+=et.lineHeight,ft=null,Pt=0;continue}const Ht=et.chars[Qt];if(!Ht)continue;ft&&Ht.kerning[ft]&&(it.x+=Ht.kerning[ft]);const qt=charRenderDataPool.pop()||{texture:Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point$2};qt.texture=Ht.texture,qt.line=vt,qt.charCode=Qt,qt.position.x=Math.round(it.x+Ht.xOffset+this._letterSpacing/2),qt.position.y=Math.round(it.y+Ht.yOffset),qt.prevSpaces=Pt,at.push(qt),mt=qt.position.x+Math.max(Ht.xAdvance-Ht.xOffset,Ht.texture.orig.width),it.x+=Ht.xAdvance+this._letterSpacing,Tt=Math.max(Tt,Ht.yOffset+Ht.texture.height),ft=Qt,xt!==-1&&dt>0&&it.x>dt&&(++At,removeItems(at,1+xt-At,1+Mt-xt),Mt=xt,xt=-1,st.push(wt),ot.push(at.length>0?at[at.length-1].prevSpaces:0),gt=Math.max(gt,wt),vt++,it.x=0,it.y+=et.lineHeight,ft=null,Pt=0)}const Rt=ht[ht.length-1];Rt!=="\r"&&Rt!==`
`&&(/(?:\s)/.test(Rt)&&(mt=wt),st.push(mt),gt=Math.max(gt,mt),ot.push(-1));const Ot=[];for(let Mt=0;Mt<=vt;Mt++){let $t=0;this._align==="right"?$t=gt-st[Mt]:this._align==="center"?$t=(gt-st[Mt])/2:this._align==="justify"&&($t=ot[Mt]<0?0:(gt-st[Mt])/ot[Mt]),Ot.push($t)}const Et=at.length,Lt={},kt=[],jt=this._activePagesMeshData;ut.push(...jt);for(let Mt=0;Mt<Et;Mt++){const $t=at[Mt].texture,Qt=$t.baseTexture.uid;if(!Lt[Qt]){let Ht=ut.pop();if(!Ht){const Bt=new MeshGeometry;let Xt,Ft;et.distanceFieldType==="none"?(Xt=new MeshMaterial(Texture.EMPTY),Ft=BLEND_MODES.NORMAL):(Xt=new MeshMaterial(Texture.EMPTY,{program:Program.from(msdfVert,msdfFrag),uniforms:{uFWidth:0}}),Ft=BLEND_MODES.NORMAL_NPM);const Wt=new Mesh(Bt,Xt);Wt.blendMode=Ft,Ht={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Wt,vertices:null,uvs:null,indices:null}}Ht.index=0,Ht.indexCount=0,Ht.vertexCount=0,Ht.uvsCount=0,Ht.total=0;const{_textureCache:qt}=this;qt[Qt]=qt[Qt]||new Texture($t.baseTexture),Ht.mesh.texture=qt[Qt],Ht.mesh.tint=this._tintColor.value,kt.push(Ht),Lt[Qt]=Ht}Lt[Qt].total++}for(let Mt=0;Mt<jt.length;Mt++)kt.includes(jt[Mt])||this.removeChild(jt[Mt].mesh);for(let Mt=0;Mt<kt.length;Mt++)kt[Mt].mesh.parent!==this&&this.addChild(kt[Mt].mesh);this._activePagesMeshData=kt;for(const Mt in Lt){const $t=Lt[Mt],Qt=$t.total;if(!($t.indices?.length>6*Qt)||$t.vertices.length<Mesh.BATCHABLE_SIZE*2)$t.vertices=new Float32Array(8*Qt),$t.uvs=new Float32Array(8*Qt),$t.indices=new Uint16Array(6*Qt);else{const Ht=$t.total,qt=$t.vertices;for(let Bt=Ht*4*2;Bt<qt.length;Bt++)qt[Bt]=0}$t.mesh.size=6*Qt}for(let Mt=0;Mt<Et;Mt++){const $t=at[Mt];let Qt=$t.position.x+Ot[$t.line]*(this._align==="justify"?$t.prevSpaces:1);this._roundPixels&&(Qt=Math.round(Qt));const Ht=Qt*nt,qt=$t.position.y*nt,Bt=$t.texture,Xt=Lt[Bt.baseTexture.uid],Ft=Bt.frame,Wt=Bt._uvs,Yt=Xt.index++;Xt.indices[Yt*6+0]=0+Yt*4,Xt.indices[Yt*6+1]=1+Yt*4,Xt.indices[Yt*6+2]=2+Yt*4,Xt.indices[Yt*6+3]=0+Yt*4,Xt.indices[Yt*6+4]=2+Yt*4,Xt.indices[Yt*6+5]=3+Yt*4,Xt.vertices[Yt*8+0]=Ht,Xt.vertices[Yt*8+1]=qt,Xt.vertices[Yt*8+2]=Ht+Ft.width*nt,Xt.vertices[Yt*8+3]=qt,Xt.vertices[Yt*8+4]=Ht+Ft.width*nt,Xt.vertices[Yt*8+5]=qt+Ft.height*nt,Xt.vertices[Yt*8+6]=Ht,Xt.vertices[Yt*8+7]=qt+Ft.height*nt,Xt.uvs[Yt*8+0]=Wt.x0,Xt.uvs[Yt*8+1]=Wt.y0,Xt.uvs[Yt*8+2]=Wt.x1,Xt.uvs[Yt*8+3]=Wt.y1,Xt.uvs[Yt*8+4]=Wt.x2,Xt.uvs[Yt*8+5]=Wt.y2,Xt.uvs[Yt*8+6]=Wt.x3,Xt.uvs[Yt*8+7]=Wt.y3}this._textWidth=gt*nt,this._textHeight=(it.y+et.lineHeight)*nt;for(const Mt in Lt){const $t=Lt[Mt];if(this.anchor.x!==0||this.anchor.y!==0){let Bt=0;const Xt=this._textWidth*this.anchor.x,Ft=this._textHeight*this.anchor.y;for(let Wt=0;Wt<$t.total;Wt++)$t.vertices[Bt++]-=Xt,$t.vertices[Bt++]-=Ft,$t.vertices[Bt++]-=Xt,$t.vertices[Bt++]-=Ft,$t.vertices[Bt++]-=Xt,$t.vertices[Bt++]-=Ft,$t.vertices[Bt++]-=Xt,$t.vertices[Bt++]-=Ft}this._maxLineHeight=Tt*nt;const Qt=$t.mesh.geometry.getBuffer("aVertexPosition"),Ht=$t.mesh.geometry.getBuffer("aTextureCoord"),qt=$t.mesh.geometry.getIndex();Qt.data=$t.vertices,Ht.data=$t.uvs,qt.data=$t.indices,Qt.update(),Ht.update(),qt.update()}for(let Mt=0;Mt<at.length;Mt++)charRenderDataPool.push(at[Mt]);this._font=et,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(et){this._autoResolution&&this._resolution!==et.resolution&&(this._resolution=et.resolution,this.dirty=!0);const{distanceFieldRange:rt,distanceFieldType:nt,size:it}=BitmapFont.available[this._fontName];if(nt!=="none"){const{a:at,b:st,c:ot,d:lt}=this.worldTransform,ht=Math.sqrt(at*at+st*st),dt=Math.sqrt(ot*ot+lt*lt),ut=(Math.abs(ht)+Math.abs(dt))/2,ft=this.fontSize/it,mt=et._view.resolution;for(const gt of this._activePagesMeshData)gt.mesh.shader.uniforms.uFWidth=ut*rt*ft*mt}super._render(et)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const et=BitmapFont.available[this._fontName];if(!et)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==et&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(et){if(this.tint!==et){this._tintColor.setValue(et);for(let rt=0;rt<this._activePagesMeshData.length;rt++)this._activePagesMeshData[rt].mesh.tint=et}}get align(){return this._align}set align(et){this._align!==et&&(this._align=et,this.dirty=!0)}get fontName(){return this._fontName}set fontName(et){if(!BitmapFont.available[et])throw new Error(`Missing BitmapFont "${et}"`);this._fontName!==et&&(this._fontName=et,this.dirty=!0)}get fontSize(){return this._fontSize??BitmapFont.available[this._fontName].size}set fontSize(et){this._fontSize!==et&&(this._fontSize=et,this.dirty=!0)}get anchor(){return this._anchor}set anchor(et){typeof et=="number"?this._anchor.set(et):this._anchor.copyFrom(et)}get text(){return this._text}set text(et){et=String(et??""),this._text!==et&&(this._text=et,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(et){this._maxWidth!==et&&(this._maxWidth=et,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(et){this._letterSpacing!==et&&(this._letterSpacing=et,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(et){et!==this._roundPixels&&(this._roundPixels=et,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(et){this._autoResolution=!1,this._resolution!==et&&(this._resolution=et,this.dirty=!0)}destroy(et){const{_textureCache:rt}=this,nt=BitmapFont.available[this._fontName].distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;nt.push(...this._activePagesMeshData);for(const it of this._activePagesMeshData)this.removeChild(it.mesh);this._activePagesMeshData=[],nt.filter(it=>rt[it.mesh.texture.baseTexture.uid]).forEach(it=>{it.mesh.texture=Texture.EMPTY});for(const it in rt)rt[it].destroy(),delete rt[it];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(et)}};_BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let BitmapText=_BitmapText;const validExtensions=[".xml",".fnt"],loadBitmapFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},name:"loadBitmapFont",test(tt){return validExtensions.includes(path.extname(tt).toLowerCase())},async testParse(tt){return TextFormat.test(tt)||XMLStringFormat.test(tt)},async parse(tt,et,rt){const nt=TextFormat.test(tt)?TextFormat.parse(tt):XMLStringFormat.parse(tt),{src:it}=et,{page:at}=nt,st=[];for(let ht=0;ht<at.length;++ht){const dt=at[ht].file;let ut=path.join(path.dirname(it),dt);ut=copySearchParams(ut,it),st.push(ut)}const ot=await rt.load(st),lt=st.map(ht=>ot[ht]);return BitmapFont.install(nt,lt,!0)},async load(tt,et){return(await settings.ADAPTER.fetch(tt)).text()},unload(tt){tt.destroy()}};extensions$1.add(loadBitmapFont);const _HTMLTextStyle=class ch extends TextStyle{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(et){return new ch(Object.keys(ch.defaultOptions).reduce((rt,nt)=>({...rt,[nt]:et[nt]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(et=>{URL.revokeObjectURL(et.src),et.refs--,et.refs===0&&(et.fontFace&&document.fonts.delete(et.fontFace),delete ch.availableFonts[et.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(et,rt={}){const{availableFonts:nt}=ch;if(nt[et]){const it=nt[et];return this._fonts.push(it),it.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return settings.ADAPTER.fetch(et).then(it=>it.blob()).then(async it=>new Promise((at,st)=>{const ot=URL.createObjectURL(it),lt=new FileReader;lt.onload=()=>at([ot,lt.result]),lt.onerror=st,lt.readAsDataURL(it)})).then(async([it,at])=>{const st=Object.assign({family:path.basename(et,path.extname(et)),weight:"normal",style:"normal",display:"auto",src:it,dataSrc:at,refs:1,originalUrl:et,fontFace:null},rt);nt[et]=st,this._fonts.push(st),this.styleID++;const ot=new FontFace(st.family,`url(${st.src})`,{weight:st.weight,style:st.style,display:st.display});st.fontFace=ot,await ot.load(),document.fonts.add(ot),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...et){const rt=et.filter(nt=>!this._overrides.includes(nt));rt.length>0&&(this._overrides.push(...rt),this.styleID++)}removeOverride(...et){const rt=et.filter(nt=>this._overrides.includes(nt));rt.length>0&&(this._overrides=this._overrides.filter(nt=>!rt.includes(nt)),this.styleID++)}toCSS(et){return[`transform: scale(${et})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((et,rt)=>`${et}
            @font-face {
                font-family: "${rt.family}";
                src: url('${rt.dataSrc}');
                font-weight: ${rt.weight};
                font-style: ${rt.style};
                font-display: ${rt.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(et){this._stylesheet!==et&&(this._stylesheet=et,this.styleID++)}normalizeColor(et){return Array.isArray(et)&&(et=rgb2hex(et)),typeof et=="number"?hex2string(et):et}dropShadowToCSS(){let et=this.normalizeColor(this.dropShadowColor);const rt=this.dropShadowAlpha,nt=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),it=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);et.startsWith("#")&&rt<1&&(et+=(rt*255|0).toString(16).padStart(2,"0"));const at=`${nt}px ${it}px`;return this.dropShadowBlur>0?`text-shadow: ${at} ${this.dropShadowBlur}px ${et}`:`text-shadow: ${at} ${et}`}reset(){Object.assign(this,ch.defaultOptions)}onBeforeDraw(){const{fontsDirty:et}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&et?new Promise(rt=>setTimeout(rt,100)):Promise.resolve()}get isSafari(){const{userAgent:et}=settings.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(et)}set fillGradientStops(et){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(et){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(et){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(et){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(et){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(et){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(et){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};_HTMLTextStyle.availableFonts={},_HTMLTextStyle.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let HTMLTextStyle=_HTMLTextStyle;const _HTMLText=class hh extends Sprite{constructor(et="",rt={}){super(Texture.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const nt=new Image,it=Texture.from(nt,{scaleMode:settings.SCALE_MODE,resourceOptions:{autoLoad:!1}});it.orig=new Rectangle,it.trim=new Rectangle,this.texture=it;const at="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml",ot=document.createElementNS(at,"svg"),lt=document.createElementNS(at,"foreignObject"),ht=document.createElementNS(st,"div"),dt=document.createElementNS(st,"style");lt.setAttribute("width","10000"),lt.setAttribute("height","10000"),lt.style.overflow="hidden",ot.appendChild(lt),this.maxWidth=hh.defaultMaxWidth,this.maxHeight=hh.defaultMaxHeight,this._domElement=ht,this._styleElement=dt,this._svgRoot=ot,this._foreignObject=lt,this._foreignObject.appendChild(dt),this._foreignObject.appendChild(ht),this._image=nt,this._loadImage=new Image,this._autoResolution=hh.defaultAutoResolution,this._resolution=hh.defaultResolution??settings.RESOLUTION,this.text=et,this.style=rt}measureText(et){const{text:rt,style:nt,resolution:it}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},et);Object.assign(this._domElement,{innerHTML:rt,style:nt.toCSS(it)}),this._styleElement.textContent=nt.toGlobalCSS(),document.body.appendChild(this._svgRoot);const at=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:st,height:ot}=at;(st>this.maxWidth||ot>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const lt=Math.min(this.maxWidth,Math.ceil(st)),ht=Math.min(this.maxHeight,Math.ceil(ot));return this._svgRoot.setAttribute("width",lt.toString()),this._svgRoot.setAttribute("height",ht.toString()),rt!==this._text&&(this._domElement.innerHTML=this._text),nt!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(it)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:lt+nt.padding*2,height:ht+nt.padding*2}}async updateText(et=!0){const{style:rt,_image:nt,_loadImage:it}=this;if(this.localStyleID!==rt.styleID&&(this.dirty=!0,this.localStyleID=rt.styleID),!this.dirty&&et)return;const{width:at,height:st}=this.measureText();nt.width=it.width=Math.ceil(Math.max(1,at)),nt.height=it.height=Math.ceil(Math.max(1,st)),this._updateID++;const ot=this._updateID;await new Promise(lt=>{it.onload=async()=>{if(ot<this._updateID){lt();return}await rt.onBeforeDraw(),nt.src=it.src,it.onload=null,it.src="",this.updateTexture(),lt()};const ht=new XMLSerializer().serializeToString(this._svgRoot);it.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(ht)}`})}get source(){return this._image}updateTexture(){const{style:et,texture:rt,_image:nt,resolution:it}=this,{padding:at}=et,{baseTexture:st}=rt;rt.trim.width=rt._frame.width=nt.width/it,rt.trim.height=rt._frame.height=nt.height/it,rt.trim.x=-at,rt.trim.y=-at,rt.orig.width=rt._frame.width-at*2,rt.orig.height=rt._frame.height-at*2,this._onTextureUpdate(),st.setRealSize(nt.width,nt.height,it),this.dirty=!1}_render(et){this._autoResolution&&this._resolution!==et.resolution&&(this._resolution=et.resolution,this.dirty=!0),this.updateText(!0),super._render(et)}_renderCanvas(et){this._autoResolution&&this._resolution!==et.resolution&&(this._resolution=et.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(et)}getLocalBounds(et){return this.updateText(!0),super.getLocalBounds(et)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(et){typeof et=="boolean"&&(et={children:et}),et=Object.assign({},hh.defaultDestroyOptions,et),super.destroy(et);const rt=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=rt,this._svgRoot?.remove(),this._svgRoot=rt,this._domElement?.remove(),this._domElement=rt,this._foreignObject?.remove(),this._foreignObject=rt,this._styleElement?.remove(),this._styleElement=rt,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=rt,this._image.src="",this._image=rt}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(et){this.updateText(!0);const rt=sign(this.scale.x)||1;this.scale.x=rt*et/this._image.width/this.resolution,this._width=et}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(et){this.updateText(!0);const rt=sign(this.scale.y)||1;this.scale.y=rt*et/this._image.height/this.resolution,this._height=et}get style(){return this._style}set style(et){this._style!==et&&(et=et||{},et instanceof HTMLTextStyle?(this.ownsStyle=!1,this._style=et):et instanceof TextStyle?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=HTMLTextStyle.from(et)):(this.ownsStyle=!0,this._style=new HTMLTextStyle(et)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(et){et=String(et===""||et===null||et===void 0?" ":et),et=this.sanitiseText(et),this._text!==et&&(this._text=et,this.dirty=!0)}get resolution(){return this._resolution}set resolution(et){this._autoResolution=!1,this._resolution!==et&&(this._resolution=et,this.dirty=!0)}sanitiseText(et){return et.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};_HTMLText.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_HTMLText.defaultMaxWidth=2024,_HTMLText.defaultMaxHeight=2024,_HTMLText.defaultAutoResolution=!0;class SpriteManager{static instance;textures=new Map;animations=new Map;stateAssets=new Map;static getInstance(){return this.instance||(this.instance=new SpriteManager),this.instance}async loadManifest(et,rt,nt){if(this.stateAssets.has(rt)&&this.stateAssets.get(rt).size>0){nt&&nt(1);return}const at=await(await fetch(et)).json();this.stateAssets.has(rt)||this.stateAssets.set(rt,new Set);const st=this.stateAssets.get(rt),ot=Object.keys(at.spritesheets||{}).length+Object.keys(at.images||{}).length;let lt=0;const ht=()=>{lt++,nt&&nt(lt/ot)};for(const[dt,ut]of Object.entries(at.spritesheets)){const ft=await Assets.load(ut.url);st.add(ut.url);for(const[mt,gt]of Object.entries(ut.frames)){const vt=new Texture(ft,new Rectangle(gt.x,gt.y,gt.w,gt.h));this.textures.set(mt,vt),st.add(mt)}for(const[mt,gt]of Object.entries(ut.animations)){const vt=`${dt}_${mt}`,xt=gt.map(wt=>this.textures.get(wt)).filter(wt=>!!wt);this.animations.set(vt,xt),st.add(vt)}ht()}if(at.images)for(const[dt,ut]of Object.entries(at.images)){const ft=await Assets.load(ut);this.textures.set(dt,ft),st.add(dt),st.add(ut),ht()}}uncacheByState(et){const rt=this.stateAssets.get(et);rt&&(rt.forEach(nt=>{(nt.includes(".")||nt.includes("/"))&&Assets.unload(nt),this.textures.delete(nt),this.animations.delete(nt)}),this.stateAssets.delete(et))}getTexture(et){return this.textures.get(et)||Texture.WHITE}getAnimation(et){return this.animations.get(et)||[]}}var howler={};var hasRequiredHowler;function requireHowler(){return hasRequiredHowler||(hasRequiredHowler=1,(function(tt){(function(){var et=function(){this.init()};et.prototype={init:function(){var ut=this||rt;return ut._counter=1e3,ut._html5AudioPool=[],ut.html5PoolSize=10,ut._codecs={},ut._howls=[],ut._muted=!1,ut._volume=1,ut._canPlayEvent="canplaythrough",ut._navigator=typeof window<"u"&&window.navigator?window.navigator:null,ut.masterGain=null,ut.noAudio=!1,ut.usingWebAudio=!0,ut.autoSuspend=!0,ut.ctx=null,ut.autoUnlock=!0,ut._setup(),ut},volume:function(ut){var ft=this||rt;if(ut=parseFloat(ut),ft.ctx||dt(),typeof ut<"u"&&ut>=0&&ut<=1){if(ft._volume=ut,ft._muted)return ft;ft.usingWebAudio&&ft.masterGain.gain.setValueAtTime(ut,rt.ctx.currentTime);for(var mt=0;mt<ft._howls.length;mt++)if(!ft._howls[mt]._webAudio)for(var gt=ft._howls[mt]._getSoundIds(),vt=0;vt<gt.length;vt++){var xt=ft._howls[mt]._soundById(gt[vt]);xt&&xt._node&&(xt._node.volume=xt._volume*ut)}return ft}return ft._volume},mute:function(ut){var ft=this||rt;ft.ctx||dt(),ft._muted=ut,ft.usingWebAudio&&ft.masterGain.gain.setValueAtTime(ut?0:ft._volume,rt.ctx.currentTime);for(var mt=0;mt<ft._howls.length;mt++)if(!ft._howls[mt]._webAudio)for(var gt=ft._howls[mt]._getSoundIds(),vt=0;vt<gt.length;vt++){var xt=ft._howls[mt]._soundById(gt[vt]);xt&&xt._node&&(xt._node.muted=ut?!0:xt._muted)}return ft},stop:function(){for(var ut=this||rt,ft=0;ft<ut._howls.length;ft++)ut._howls[ft].stop();return ut},unload:function(){for(var ut=this||rt,ft=ut._howls.length-1;ft>=0;ft--)ut._howls[ft].unload();return ut.usingWebAudio&&ut.ctx&&typeof ut.ctx.close<"u"&&(ut.ctx.close(),ut.ctx=null,dt()),ut},codecs:function(ut){return(this||rt)._codecs[ut.replace(/^x-/,"")]},_setup:function(){var ut=this||rt;if(ut.state=ut.ctx&&ut.ctx.state||"suspended",ut._autoSuspend(),!ut.usingWebAudio)if(typeof Audio<"u")try{var ft=new Audio;typeof ft.oncanplaythrough>"u"&&(ut._canPlayEvent="canplay")}catch{ut.noAudio=!0}else ut.noAudio=!0;try{var ft=new Audio;ft.muted&&(ut.noAudio=!0)}catch{}return ut.noAudio||ut._setupCodecs(),ut},_setupCodecs:function(){var ut=this||rt,ft=null;try{ft=typeof Audio<"u"?new Audio:null}catch{return ut}if(!ft||typeof ft.canPlayType!="function")return ut;var mt=ft.canPlayType("audio/mpeg;").replace(/^no$/,""),gt=ut._navigator?ut._navigator.userAgent:"",vt=gt.match(/OPR\/(\d+)/g),xt=vt&&parseInt(vt[0].split("/")[1],10)<33,wt=gt.indexOf("Safari")!==-1&&gt.indexOf("Chrome")===-1,At=gt.match(/Version\/(.*?) /),Tt=wt&&At&&parseInt(At[1],10)<15;return ut._codecs={mp3:!!(!xt&&(mt||ft.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!mt,opus:!!ft.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!ft.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!ft.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(ft.canPlayType('audio/wav; codecs="1"')||ft.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!ft.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!ft.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(ft.canPlayType("audio/x-m4a;")||ft.canPlayType("audio/m4a;")||ft.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(ft.canPlayType("audio/x-m4b;")||ft.canPlayType("audio/m4b;")||ft.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(ft.canPlayType("audio/x-mp4;")||ft.canPlayType("audio/mp4;")||ft.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!Tt&&ft.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!Tt&&ft.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!ft.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(ft.canPlayType("audio/x-flac;")||ft.canPlayType("audio/flac;")).replace(/^no$/,"")},ut},_unlockAudio:function(){var ut=this||rt;if(!(ut._audioUnlocked||!ut.ctx)){ut._audioUnlocked=!1,ut.autoUnlock=!1,!ut._mobileUnloaded&&ut.ctx.sampleRate!==44100&&(ut._mobileUnloaded=!0,ut.unload()),ut._scratchBuffer=ut.ctx.createBuffer(1,1,22050);var ft=function(mt){for(;ut._html5AudioPool.length<ut.html5PoolSize;)try{var gt=new Audio;gt._unlocked=!0,ut._releaseHtml5Audio(gt)}catch{ut.noAudio=!0;break}for(var vt=0;vt<ut._howls.length;vt++)if(!ut._howls[vt]._webAudio)for(var xt=ut._howls[vt]._getSoundIds(),wt=0;wt<xt.length;wt++){var At=ut._howls[vt]._soundById(xt[wt]);At&&At._node&&!At._node._unlocked&&(At._node._unlocked=!0,At._node.load())}ut._autoResume();var Tt=ut.ctx.createBufferSource();Tt.buffer=ut._scratchBuffer,Tt.connect(ut.ctx.destination),typeof Tt.start>"u"?Tt.noteOn(0):Tt.start(0),typeof ut.ctx.resume=="function"&&ut.ctx.resume(),Tt.onended=function(){Tt.disconnect(0),ut._audioUnlocked=!0,document.removeEventListener("touchstart",ft,!0),document.removeEventListener("touchend",ft,!0),document.removeEventListener("click",ft,!0),document.removeEventListener("keydown",ft,!0);for(var Pt=0;Pt<ut._howls.length;Pt++)ut._howls[Pt]._emit("unlock")}};return document.addEventListener("touchstart",ft,!0),document.addEventListener("touchend",ft,!0),document.addEventListener("click",ft,!0),document.addEventListener("keydown",ft,!0),ut}},_obtainHtml5Audio:function(){var ut=this||rt;if(ut._html5AudioPool.length)return ut._html5AudioPool.pop();var ft=new Audio().play();return ft&&typeof Promise<"u"&&(ft instanceof Promise||typeof ft.then=="function")&&ft.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(ut){var ft=this||rt;return ut._unlocked&&ft._html5AudioPool.push(ut),ft},_autoSuspend:function(){var ut=this;if(!(!ut.autoSuspend||!ut.ctx||typeof ut.ctx.suspend>"u"||!rt.usingWebAudio)){for(var ft=0;ft<ut._howls.length;ft++)if(ut._howls[ft]._webAudio){for(var mt=0;mt<ut._howls[ft]._sounds.length;mt++)if(!ut._howls[ft]._sounds[mt]._paused)return ut}return ut._suspendTimer&&clearTimeout(ut._suspendTimer),ut._suspendTimer=setTimeout(function(){if(ut.autoSuspend){ut._suspendTimer=null,ut.state="suspending";var gt=function(){ut.state="suspended",ut._resumeAfterSuspend&&(delete ut._resumeAfterSuspend,ut._autoResume())};ut.ctx.suspend().then(gt,gt)}},3e4),ut}},_autoResume:function(){var ut=this;if(!(!ut.ctx||typeof ut.ctx.resume>"u"||!rt.usingWebAudio))return ut.state==="running"&&ut.ctx.state!=="interrupted"&&ut._suspendTimer?(clearTimeout(ut._suspendTimer),ut._suspendTimer=null):ut.state==="suspended"||ut.state==="running"&&ut.ctx.state==="interrupted"?(ut.ctx.resume().then(function(){ut.state="running";for(var ft=0;ft<ut._howls.length;ft++)ut._howls[ft]._emit("resume")}),ut._suspendTimer&&(clearTimeout(ut._suspendTimer),ut._suspendTimer=null)):ut.state==="suspending"&&(ut._resumeAfterSuspend=!0),ut}};var rt=new et,nt=function(ut){var ft=this;if(!ut.src||ut.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}ft.init(ut)};nt.prototype={init:function(ut){var ft=this;return rt.ctx||dt(),ft._autoplay=ut.autoplay||!1,ft._format=typeof ut.format!="string"?ut.format:[ut.format],ft._html5=ut.html5||!1,ft._muted=ut.mute||!1,ft._loop=ut.loop||!1,ft._pool=ut.pool||5,ft._preload=typeof ut.preload=="boolean"||ut.preload==="metadata"?ut.preload:!0,ft._rate=ut.rate||1,ft._sprite=ut.sprite||{},ft._src=typeof ut.src!="string"?ut.src:[ut.src],ft._volume=ut.volume!==void 0?ut.volume:1,ft._xhr={method:ut.xhr&&ut.xhr.method?ut.xhr.method:"GET",headers:ut.xhr&&ut.xhr.headers?ut.xhr.headers:null,withCredentials:ut.xhr&&ut.xhr.withCredentials?ut.xhr.withCredentials:!1},ft._duration=0,ft._state="unloaded",ft._sounds=[],ft._endTimers={},ft._queue=[],ft._playLock=!1,ft._onend=ut.onend?[{fn:ut.onend}]:[],ft._onfade=ut.onfade?[{fn:ut.onfade}]:[],ft._onload=ut.onload?[{fn:ut.onload}]:[],ft._onloaderror=ut.onloaderror?[{fn:ut.onloaderror}]:[],ft._onplayerror=ut.onplayerror?[{fn:ut.onplayerror}]:[],ft._onpause=ut.onpause?[{fn:ut.onpause}]:[],ft._onplay=ut.onplay?[{fn:ut.onplay}]:[],ft._onstop=ut.onstop?[{fn:ut.onstop}]:[],ft._onmute=ut.onmute?[{fn:ut.onmute}]:[],ft._onvolume=ut.onvolume?[{fn:ut.onvolume}]:[],ft._onrate=ut.onrate?[{fn:ut.onrate}]:[],ft._onseek=ut.onseek?[{fn:ut.onseek}]:[],ft._onunlock=ut.onunlock?[{fn:ut.onunlock}]:[],ft._onresume=[],ft._webAudio=rt.usingWebAudio&&!ft._html5,typeof rt.ctx<"u"&&rt.ctx&&rt.autoUnlock&&rt._unlockAudio(),rt._howls.push(ft),ft._autoplay&&ft._queue.push({event:"play",action:function(){ft.play()}}),ft._preload&&ft._preload!=="none"&&ft.load(),ft},load:function(){var ut=this,ft=null;if(rt.noAudio){ut._emit("loaderror",null,"No audio support.");return}typeof ut._src=="string"&&(ut._src=[ut._src]);for(var mt=0;mt<ut._src.length;mt++){var gt,vt;if(ut._format&&ut._format[mt])gt=ut._format[mt];else{if(vt=ut._src[mt],typeof vt!="string"){ut._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}gt=/^data:audio\/([^;,]+);/i.exec(vt),gt||(gt=/\.([^.]+)$/.exec(vt.split("?",1)[0])),gt&&(gt=gt[1].toLowerCase())}if(gt||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),gt&&rt.codecs(gt)){ft=ut._src[mt];break}}if(!ft){ut._emit("loaderror",null,"No codec support for selected audio sources.");return}return ut._src=ft,ut._state="loading",window.location.protocol==="https:"&&ft.slice(0,5)==="http:"&&(ut._html5=!0,ut._webAudio=!1),new it(ut),ut._webAudio&&st(ut),ut},play:function(ut,ft){var mt=this,gt=null;if(typeof ut=="number")gt=ut,ut=null;else{if(typeof ut=="string"&&mt._state==="loaded"&&!mt._sprite[ut])return null;if(typeof ut>"u"&&(ut="__default",!mt._playLock)){for(var vt=0,xt=0;xt<mt._sounds.length;xt++)mt._sounds[xt]._paused&&!mt._sounds[xt]._ended&&(vt++,gt=mt._sounds[xt]._id);vt===1?ut=null:gt=null}}var wt=gt?mt._soundById(gt):mt._inactiveSound();if(!wt)return null;if(gt&&!ut&&(ut=wt._sprite||"__default"),mt._state!=="loaded"){wt._sprite=ut,wt._ended=!1;var At=wt._id;return mt._queue.push({event:"play",action:function(){mt.play(At)}}),At}if(gt&&!wt._paused)return ft||mt._loadQueue("play"),wt._id;mt._webAudio&&rt._autoResume();var Tt=Math.max(0,wt._seek>0?wt._seek:mt._sprite[ut][0]/1e3),Pt=Math.max(0,(mt._sprite[ut][0]+mt._sprite[ut][1])/1e3-Tt),Rt=Pt*1e3/Math.abs(wt._rate),Ot=mt._sprite[ut][0]/1e3,Et=(mt._sprite[ut][0]+mt._sprite[ut][1])/1e3;wt._sprite=ut,wt._ended=!1;var Lt=function(){wt._paused=!1,wt._seek=Tt,wt._start=Ot,wt._stop=Et,wt._loop=!!(wt._loop||mt._sprite[ut][2])};if(Tt>=Et){mt._ended(wt);return}var kt=wt._node;if(mt._webAudio){var jt=function(){mt._playLock=!1,Lt(),mt._refreshBuffer(wt);var Ht=wt._muted||mt._muted?0:wt._volume;kt.gain.setValueAtTime(Ht,rt.ctx.currentTime),wt._playStart=rt.ctx.currentTime,typeof kt.bufferSource.start>"u"?wt._loop?kt.bufferSource.noteGrainOn(0,Tt,86400):kt.bufferSource.noteGrainOn(0,Tt,Pt):wt._loop?kt.bufferSource.start(0,Tt,86400):kt.bufferSource.start(0,Tt,Pt),Rt!==1/0&&(mt._endTimers[wt._id]=setTimeout(mt._ended.bind(mt,wt),Rt)),ft||setTimeout(function(){mt._emit("play",wt._id),mt._loadQueue()},0)};rt.state==="running"&&rt.ctx.state!=="interrupted"?jt():(mt._playLock=!0,mt.once("resume",jt),mt._clearTimer(wt._id))}else{var Mt=function(){kt.currentTime=Tt,kt.muted=wt._muted||mt._muted||rt._muted||kt.muted,kt.volume=wt._volume*rt.volume(),kt.playbackRate=wt._rate;try{var Ht=kt.play();if(Ht&&typeof Promise<"u"&&(Ht instanceof Promise||typeof Ht.then=="function")?(mt._playLock=!0,Lt(),Ht.then(function(){mt._playLock=!1,kt._unlocked=!0,ft?mt._loadQueue():mt._emit("play",wt._id)}).catch(function(){mt._playLock=!1,mt._emit("playerror",wt._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),wt._ended=!0,wt._paused=!0})):ft||(mt._playLock=!1,Lt(),mt._emit("play",wt._id)),kt.playbackRate=wt._rate,kt.paused){mt._emit("playerror",wt._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}ut!=="__default"||wt._loop?mt._endTimers[wt._id]=setTimeout(mt._ended.bind(mt,wt),Rt):(mt._endTimers[wt._id]=function(){mt._ended(wt),kt.removeEventListener("ended",mt._endTimers[wt._id],!1)},kt.addEventListener("ended",mt._endTimers[wt._id],!1))}catch(qt){mt._emit("playerror",wt._id,qt)}};kt.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(kt.src=mt._src,kt.load());var $t=window&&window.ejecta||!kt.readyState&&rt._navigator.isCocoonJS;if(kt.readyState>=3||$t)Mt();else{mt._playLock=!0,mt._state="loading";var Qt=function(){mt._state="loaded",Mt(),kt.removeEventListener(rt._canPlayEvent,Qt,!1)};kt.addEventListener(rt._canPlayEvent,Qt,!1),mt._clearTimer(wt._id)}}return wt._id},pause:function(ut){var ft=this;if(ft._state!=="loaded"||ft._playLock)return ft._queue.push({event:"pause",action:function(){ft.pause(ut)}}),ft;for(var mt=ft._getSoundIds(ut),gt=0;gt<mt.length;gt++){ft._clearTimer(mt[gt]);var vt=ft._soundById(mt[gt]);if(vt&&!vt._paused&&(vt._seek=ft.seek(mt[gt]),vt._rateSeek=0,vt._paused=!0,ft._stopFade(mt[gt]),vt._node))if(ft._webAudio){if(!vt._node.bufferSource)continue;typeof vt._node.bufferSource.stop>"u"?vt._node.bufferSource.noteOff(0):vt._node.bufferSource.stop(0),ft._cleanBuffer(vt._node)}else(!isNaN(vt._node.duration)||vt._node.duration===1/0)&&vt._node.pause();arguments[1]||ft._emit("pause",vt?vt._id:null)}return ft},stop:function(ut,ft){var mt=this;if(mt._state!=="loaded"||mt._playLock)return mt._queue.push({event:"stop",action:function(){mt.stop(ut)}}),mt;for(var gt=mt._getSoundIds(ut),vt=0;vt<gt.length;vt++){mt._clearTimer(gt[vt]);var xt=mt._soundById(gt[vt]);xt&&(xt._seek=xt._start||0,xt._rateSeek=0,xt._paused=!0,xt._ended=!0,mt._stopFade(gt[vt]),xt._node&&(mt._webAudio?xt._node.bufferSource&&(typeof xt._node.bufferSource.stop>"u"?xt._node.bufferSource.noteOff(0):xt._node.bufferSource.stop(0),mt._cleanBuffer(xt._node)):(!isNaN(xt._node.duration)||xt._node.duration===1/0)&&(xt._node.currentTime=xt._start||0,xt._node.pause(),xt._node.duration===1/0&&mt._clearSound(xt._node))),ft||mt._emit("stop",xt._id))}return mt},mute:function(ut,ft){var mt=this;if(mt._state!=="loaded"||mt._playLock)return mt._queue.push({event:"mute",action:function(){mt.mute(ut,ft)}}),mt;if(typeof ft>"u")if(typeof ut=="boolean")mt._muted=ut;else return mt._muted;for(var gt=mt._getSoundIds(ft),vt=0;vt<gt.length;vt++){var xt=mt._soundById(gt[vt]);xt&&(xt._muted=ut,xt._interval&&mt._stopFade(xt._id),mt._webAudio&&xt._node?xt._node.gain.setValueAtTime(ut?0:xt._volume,rt.ctx.currentTime):xt._node&&(xt._node.muted=rt._muted?!0:ut),mt._emit("mute",xt._id))}return mt},volume:function(){var ut=this,ft=arguments,mt,gt;if(ft.length===0)return ut._volume;if(ft.length===1||ft.length===2&&typeof ft[1]>"u"){var vt=ut._getSoundIds(),xt=vt.indexOf(ft[0]);xt>=0?gt=parseInt(ft[0],10):mt=parseFloat(ft[0])}else ft.length>=2&&(mt=parseFloat(ft[0]),gt=parseInt(ft[1],10));var wt;if(typeof mt<"u"&&mt>=0&&mt<=1){if(ut._state!=="loaded"||ut._playLock)return ut._queue.push({event:"volume",action:function(){ut.volume.apply(ut,ft)}}),ut;typeof gt>"u"&&(ut._volume=mt),gt=ut._getSoundIds(gt);for(var At=0;At<gt.length;At++)wt=ut._soundById(gt[At]),wt&&(wt._volume=mt,ft[2]||ut._stopFade(gt[At]),ut._webAudio&&wt._node&&!wt._muted?wt._node.gain.setValueAtTime(mt,rt.ctx.currentTime):wt._node&&!wt._muted&&(wt._node.volume=mt*rt.volume()),ut._emit("volume",wt._id))}else return wt=gt?ut._soundById(gt):ut._sounds[0],wt?wt._volume:0;return ut},fade:function(ut,ft,mt,gt){var vt=this;if(vt._state!=="loaded"||vt._playLock)return vt._queue.push({event:"fade",action:function(){vt.fade(ut,ft,mt,gt)}}),vt;ut=Math.min(Math.max(0,parseFloat(ut)),1),ft=Math.min(Math.max(0,parseFloat(ft)),1),mt=parseFloat(mt),vt.volume(ut,gt);for(var xt=vt._getSoundIds(gt),wt=0;wt<xt.length;wt++){var At=vt._soundById(xt[wt]);if(At){if(gt||vt._stopFade(xt[wt]),vt._webAudio&&!At._muted){var Tt=rt.ctx.currentTime,Pt=Tt+mt/1e3;At._volume=ut,At._node.gain.setValueAtTime(ut,Tt),At._node.gain.linearRampToValueAtTime(ft,Pt)}vt._startFadeInterval(At,ut,ft,mt,xt[wt],typeof gt>"u")}}return vt},_startFadeInterval:function(ut,ft,mt,gt,vt,xt){var wt=this,At=ft,Tt=mt-ft,Pt=Math.abs(Tt/.01),Rt=Math.max(4,Pt>0?gt/Pt:gt),Ot=Date.now();ut._fadeTo=mt,ut._interval=setInterval(function(){var Et=(Date.now()-Ot)/gt;Ot=Date.now(),At+=Tt*Et,At=Math.round(At*100)/100,Tt<0?At=Math.max(mt,At):At=Math.min(mt,At),wt._webAudio?ut._volume=At:wt.volume(At,ut._id,!0),xt&&(wt._volume=At),(mt<ft&&At<=mt||mt>ft&&At>=mt)&&(clearInterval(ut._interval),ut._interval=null,ut._fadeTo=null,wt.volume(mt,ut._id),wt._emit("fade",ut._id))},Rt)},_stopFade:function(ut){var ft=this,mt=ft._soundById(ut);return mt&&mt._interval&&(ft._webAudio&&mt._node.gain.cancelScheduledValues(rt.ctx.currentTime),clearInterval(mt._interval),mt._interval=null,ft.volume(mt._fadeTo,ut),mt._fadeTo=null,ft._emit("fade",ut)),ft},loop:function(){var ut=this,ft=arguments,mt,gt,vt;if(ft.length===0)return ut._loop;if(ft.length===1)if(typeof ft[0]=="boolean")mt=ft[0],ut._loop=mt;else return vt=ut._soundById(parseInt(ft[0],10)),vt?vt._loop:!1;else ft.length===2&&(mt=ft[0],gt=parseInt(ft[1],10));for(var xt=ut._getSoundIds(gt),wt=0;wt<xt.length;wt++)vt=ut._soundById(xt[wt]),vt&&(vt._loop=mt,ut._webAudio&&vt._node&&vt._node.bufferSource&&(vt._node.bufferSource.loop=mt,mt&&(vt._node.bufferSource.loopStart=vt._start||0,vt._node.bufferSource.loopEnd=vt._stop,ut.playing(xt[wt])&&(ut.pause(xt[wt],!0),ut.play(xt[wt],!0)))));return ut},rate:function(){var ut=this,ft=arguments,mt,gt;if(ft.length===0)gt=ut._sounds[0]._id;else if(ft.length===1){var vt=ut._getSoundIds(),xt=vt.indexOf(ft[0]);xt>=0?gt=parseInt(ft[0],10):mt=parseFloat(ft[0])}else ft.length===2&&(mt=parseFloat(ft[0]),gt=parseInt(ft[1],10));var wt;if(typeof mt=="number"){if(ut._state!=="loaded"||ut._playLock)return ut._queue.push({event:"rate",action:function(){ut.rate.apply(ut,ft)}}),ut;typeof gt>"u"&&(ut._rate=mt),gt=ut._getSoundIds(gt);for(var At=0;At<gt.length;At++)if(wt=ut._soundById(gt[At]),wt){ut.playing(gt[At])&&(wt._rateSeek=ut.seek(gt[At]),wt._playStart=ut._webAudio?rt.ctx.currentTime:wt._playStart),wt._rate=mt,ut._webAudio&&wt._node&&wt._node.bufferSource?wt._node.bufferSource.playbackRate.setValueAtTime(mt,rt.ctx.currentTime):wt._node&&(wt._node.playbackRate=mt);var Tt=ut.seek(gt[At]),Pt=(ut._sprite[wt._sprite][0]+ut._sprite[wt._sprite][1])/1e3-Tt,Rt=Pt*1e3/Math.abs(wt._rate);(ut._endTimers[gt[At]]||!wt._paused)&&(ut._clearTimer(gt[At]),ut._endTimers[gt[At]]=setTimeout(ut._ended.bind(ut,wt),Rt)),ut._emit("rate",wt._id)}}else return wt=ut._soundById(gt),wt?wt._rate:ut._rate;return ut},seek:function(){var ut=this,ft=arguments,mt,gt;if(ft.length===0)ut._sounds.length&&(gt=ut._sounds[0]._id);else if(ft.length===1){var vt=ut._getSoundIds(),xt=vt.indexOf(ft[0]);xt>=0?gt=parseInt(ft[0],10):ut._sounds.length&&(gt=ut._sounds[0]._id,mt=parseFloat(ft[0]))}else ft.length===2&&(mt=parseFloat(ft[0]),gt=parseInt(ft[1],10));if(typeof gt>"u")return 0;if(typeof mt=="number"&&(ut._state!=="loaded"||ut._playLock))return ut._queue.push({event:"seek",action:function(){ut.seek.apply(ut,ft)}}),ut;var wt=ut._soundById(gt);if(wt)if(typeof mt=="number"&&mt>=0){var At=ut.playing(gt);At&&ut.pause(gt,!0),wt._seek=mt,wt._ended=!1,ut._clearTimer(gt),!ut._webAudio&&wt._node&&!isNaN(wt._node.duration)&&(wt._node.currentTime=mt);var Tt=function(){At&&ut.play(gt,!0),ut._emit("seek",gt)};if(At&&!ut._webAudio){var Pt=function(){ut._playLock?setTimeout(Pt,0):Tt()};setTimeout(Pt,0)}else Tt()}else if(ut._webAudio){var Rt=ut.playing(gt)?rt.ctx.currentTime-wt._playStart:0,Ot=wt._rateSeek?wt._rateSeek-wt._seek:0;return wt._seek+(Ot+Rt*Math.abs(wt._rate))}else return wt._node.currentTime;return ut},playing:function(ut){var ft=this;if(typeof ut=="number"){var mt=ft._soundById(ut);return mt?!mt._paused:!1}for(var gt=0;gt<ft._sounds.length;gt++)if(!ft._sounds[gt]._paused)return!0;return!1},duration:function(ut){var ft=this,mt=ft._duration,gt=ft._soundById(ut);return gt&&(mt=ft._sprite[gt._sprite][1]/1e3),mt},state:function(){return this._state},unload:function(){for(var ut=this,ft=ut._sounds,mt=0;mt<ft.length;mt++)ft[mt]._paused||ut.stop(ft[mt]._id),ut._webAudio||(ut._clearSound(ft[mt]._node),ft[mt]._node.removeEventListener("error",ft[mt]._errorFn,!1),ft[mt]._node.removeEventListener(rt._canPlayEvent,ft[mt]._loadFn,!1),ft[mt]._node.removeEventListener("ended",ft[mt]._endFn,!1),rt._releaseHtml5Audio(ft[mt]._node)),delete ft[mt]._node,ut._clearTimer(ft[mt]._id);var gt=rt._howls.indexOf(ut);gt>=0&&rt._howls.splice(gt,1);var vt=!0;for(mt=0;mt<rt._howls.length;mt++)if(rt._howls[mt]._src===ut._src||ut._src.indexOf(rt._howls[mt]._src)>=0){vt=!1;break}return at&&vt&&delete at[ut._src],rt.noAudio=!1,ut._state="unloaded",ut._sounds=[],ut=null,null},on:function(ut,ft,mt,gt){var vt=this,xt=vt["_on"+ut];return typeof ft=="function"&&xt.push(gt?{id:mt,fn:ft,once:gt}:{id:mt,fn:ft}),vt},off:function(ut,ft,mt){var gt=this,vt=gt["_on"+ut],xt=0;if(typeof ft=="number"&&(mt=ft,ft=null),ft||mt)for(xt=0;xt<vt.length;xt++){var wt=mt===vt[xt].id;if(ft===vt[xt].fn&&wt||!ft&&wt){vt.splice(xt,1);break}}else if(ut)gt["_on"+ut]=[];else{var At=Object.keys(gt);for(xt=0;xt<At.length;xt++)At[xt].indexOf("_on")===0&&Array.isArray(gt[At[xt]])&&(gt[At[xt]]=[])}return gt},once:function(ut,ft,mt){var gt=this;return gt.on(ut,ft,mt,1),gt},_emit:function(ut,ft,mt){for(var gt=this,vt=gt["_on"+ut],xt=vt.length-1;xt>=0;xt--)(!vt[xt].id||vt[xt].id===ft||ut==="load")&&(setTimeout((function(wt){wt.call(this,ft,mt)}).bind(gt,vt[xt].fn),0),vt[xt].once&&gt.off(ut,vt[xt].fn,vt[xt].id));return gt._loadQueue(ut),gt},_loadQueue:function(ut){var ft=this;if(ft._queue.length>0){var mt=ft._queue[0];mt.event===ut&&(ft._queue.shift(),ft._loadQueue()),ut||mt.action()}return ft},_ended:function(ut){var ft=this,mt=ut._sprite;if(!ft._webAudio&&ut._node&&!ut._node.paused&&!ut._node.ended&&ut._node.currentTime<ut._stop)return setTimeout(ft._ended.bind(ft,ut),100),ft;var gt=!!(ut._loop||ft._sprite[mt][2]);if(ft._emit("end",ut._id),!ft._webAudio&&gt&&ft.stop(ut._id,!0).play(ut._id),ft._webAudio&&gt){ft._emit("play",ut._id),ut._seek=ut._start||0,ut._rateSeek=0,ut._playStart=rt.ctx.currentTime;var vt=(ut._stop-ut._start)*1e3/Math.abs(ut._rate);ft._endTimers[ut._id]=setTimeout(ft._ended.bind(ft,ut),vt)}return ft._webAudio&&!gt&&(ut._paused=!0,ut._ended=!0,ut._seek=ut._start||0,ut._rateSeek=0,ft._clearTimer(ut._id),ft._cleanBuffer(ut._node),rt._autoSuspend()),!ft._webAudio&&!gt&&ft.stop(ut._id,!0),ft},_clearTimer:function(ut){var ft=this;if(ft._endTimers[ut]){if(typeof ft._endTimers[ut]!="function")clearTimeout(ft._endTimers[ut]);else{var mt=ft._soundById(ut);mt&&mt._node&&mt._node.removeEventListener("ended",ft._endTimers[ut],!1)}delete ft._endTimers[ut]}return ft},_soundById:function(ut){for(var ft=this,mt=0;mt<ft._sounds.length;mt++)if(ut===ft._sounds[mt]._id)return ft._sounds[mt];return null},_inactiveSound:function(){var ut=this;ut._drain();for(var ft=0;ft<ut._sounds.length;ft++)if(ut._sounds[ft]._ended)return ut._sounds[ft].reset();return new it(ut)},_drain:function(){var ut=this,ft=ut._pool,mt=0,gt=0;if(!(ut._sounds.length<ft)){for(gt=0;gt<ut._sounds.length;gt++)ut._sounds[gt]._ended&&mt++;for(gt=ut._sounds.length-1;gt>=0;gt--){if(mt<=ft)return;ut._sounds[gt]._ended&&(ut._webAudio&&ut._sounds[gt]._node&&ut._sounds[gt]._node.disconnect(0),ut._sounds.splice(gt,1),mt--)}}},_getSoundIds:function(ut){var ft=this;if(typeof ut>"u"){for(var mt=[],gt=0;gt<ft._sounds.length;gt++)mt.push(ft._sounds[gt]._id);return mt}else return[ut]},_refreshBuffer:function(ut){var ft=this;return ut._node.bufferSource=rt.ctx.createBufferSource(),ut._node.bufferSource.buffer=at[ft._src],ut._panner?ut._node.bufferSource.connect(ut._panner):ut._node.bufferSource.connect(ut._node),ut._node.bufferSource.loop=ut._loop,ut._loop&&(ut._node.bufferSource.loopStart=ut._start||0,ut._node.bufferSource.loopEnd=ut._stop||0),ut._node.bufferSource.playbackRate.setValueAtTime(ut._rate,rt.ctx.currentTime),ft},_cleanBuffer:function(ut){var ft=this,mt=rt._navigator&&rt._navigator.vendor.indexOf("Apple")>=0;if(!ut.bufferSource)return ft;if(rt._scratchBuffer&&ut.bufferSource&&(ut.bufferSource.onended=null,ut.bufferSource.disconnect(0),mt))try{ut.bufferSource.buffer=rt._scratchBuffer}catch{}return ut.bufferSource=null,ft},_clearSound:function(ut){var ft=/MSIE |Trident\//.test(rt._navigator&&rt._navigator.userAgent);ft||(ut.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var it=function(ut){this._parent=ut,this.init()};it.prototype={init:function(){var ut=this,ft=ut._parent;return ut._muted=ft._muted,ut._loop=ft._loop,ut._volume=ft._volume,ut._rate=ft._rate,ut._seek=0,ut._paused=!0,ut._ended=!0,ut._sprite="__default",ut._id=++rt._counter,ft._sounds.push(ut),ut.create(),ut},create:function(){var ut=this,ft=ut._parent,mt=rt._muted||ut._muted||ut._parent._muted?0:ut._volume;return ft._webAudio?(ut._node=typeof rt.ctx.createGain>"u"?rt.ctx.createGainNode():rt.ctx.createGain(),ut._node.gain.setValueAtTime(mt,rt.ctx.currentTime),ut._node.paused=!0,ut._node.connect(rt.masterGain)):rt.noAudio||(ut._node=rt._obtainHtml5Audio(),ut._errorFn=ut._errorListener.bind(ut),ut._node.addEventListener("error",ut._errorFn,!1),ut._loadFn=ut._loadListener.bind(ut),ut._node.addEventListener(rt._canPlayEvent,ut._loadFn,!1),ut._endFn=ut._endListener.bind(ut),ut._node.addEventListener("ended",ut._endFn,!1),ut._node.src=ft._src,ut._node.preload=ft._preload===!0?"auto":ft._preload,ut._node.volume=mt*rt.volume(),ut._node.load()),ut},reset:function(){var ut=this,ft=ut._parent;return ut._muted=ft._muted,ut._loop=ft._loop,ut._volume=ft._volume,ut._rate=ft._rate,ut._seek=0,ut._rateSeek=0,ut._paused=!0,ut._ended=!0,ut._sprite="__default",ut._id=++rt._counter,ut},_errorListener:function(){var ut=this;ut._parent._emit("loaderror",ut._id,ut._node.error?ut._node.error.code:0),ut._node.removeEventListener("error",ut._errorFn,!1)},_loadListener:function(){var ut=this,ft=ut._parent;ft._duration=Math.ceil(ut._node.duration*10)/10,Object.keys(ft._sprite).length===0&&(ft._sprite={__default:[0,ft._duration*1e3]}),ft._state!=="loaded"&&(ft._state="loaded",ft._emit("load"),ft._loadQueue()),ut._node.removeEventListener(rt._canPlayEvent,ut._loadFn,!1)},_endListener:function(){var ut=this,ft=ut._parent;ft._duration===1/0&&(ft._duration=Math.ceil(ut._node.duration*10)/10,ft._sprite.__default[1]===1/0&&(ft._sprite.__default[1]=ft._duration*1e3),ft._ended(ut)),ut._node.removeEventListener("ended",ut._endFn,!1)}};var at={},st=function(ut){var ft=ut._src;if(at[ft]){ut._duration=at[ft].duration,ht(ut);return}if(/^data:[^;]+;base64,/.test(ft)){for(var mt=atob(ft.split(",")[1]),gt=new Uint8Array(mt.length),vt=0;vt<mt.length;++vt)gt[vt]=mt.charCodeAt(vt);lt(gt.buffer,ut)}else{var xt=new XMLHttpRequest;xt.open(ut._xhr.method,ft,!0),xt.withCredentials=ut._xhr.withCredentials,xt.responseType="arraybuffer",ut._xhr.headers&&Object.keys(ut._xhr.headers).forEach(function(wt){xt.setRequestHeader(wt,ut._xhr.headers[wt])}),xt.onload=function(){var wt=(xt.status+"")[0];if(wt!=="0"&&wt!=="2"&&wt!=="3"){ut._emit("loaderror",null,"Failed loading audio file with status: "+xt.status+".");return}lt(xt.response,ut)},xt.onerror=function(){ut._webAudio&&(ut._html5=!0,ut._webAudio=!1,ut._sounds=[],delete at[ft],ut.load())},ot(xt)}},ot=function(ut){try{ut.send()}catch{ut.onerror()}},lt=function(ut,ft){var mt=function(){ft._emit("loaderror",null,"Decoding audio data failed.")},gt=function(vt){vt&&ft._sounds.length>0?(at[ft._src]=vt,ht(ft,vt)):mt()};typeof Promise<"u"&&rt.ctx.decodeAudioData.length===1?rt.ctx.decodeAudioData(ut).then(gt).catch(mt):rt.ctx.decodeAudioData(ut,gt,mt)},ht=function(ut,ft){ft&&!ut._duration&&(ut._duration=ft.duration),Object.keys(ut._sprite).length===0&&(ut._sprite={__default:[0,ut._duration*1e3]}),ut._state!=="loaded"&&(ut._state="loaded",ut._emit("load"),ut._loadQueue())},dt=function(){if(rt.usingWebAudio){try{typeof AudioContext<"u"?rt.ctx=new AudioContext:typeof webkitAudioContext<"u"?rt.ctx=new webkitAudioContext:rt.usingWebAudio=!1}catch{rt.usingWebAudio=!1}rt.ctx||(rt.usingWebAudio=!1);var ut=/iP(hone|od|ad)/.test(rt._navigator&&rt._navigator.platform),ft=rt._navigator&&rt._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),mt=ft?parseInt(ft[1],10):null;if(ut&&mt&&mt<9){var gt=/safari/.test(rt._navigator&&rt._navigator.userAgent.toLowerCase());rt._navigator&&!gt&&(rt.usingWebAudio=!1)}rt.usingWebAudio&&(rt.masterGain=typeof rt.ctx.createGain>"u"?rt.ctx.createGainNode():rt.ctx.createGain(),rt.masterGain.gain.setValueAtTime(rt._muted?0:rt._volume,rt.ctx.currentTime),rt.masterGain.connect(rt.ctx.destination)),rt._setup()}};tt.Howler=rt,tt.Howl=nt,typeof commonjsGlobal$1<"u"?(commonjsGlobal$1.HowlerGlobal=et,commonjsGlobal$1.Howler=rt,commonjsGlobal$1.Howl=nt,commonjsGlobal$1.Sound=it):typeof window<"u"&&(window.HowlerGlobal=et,window.Howler=rt,window.Howl=nt,window.Sound=it)})();(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(rt){var nt=this;if(!nt.ctx||!nt.ctx.listener)return nt;for(var it=nt._howls.length-1;it>=0;it--)nt._howls[it].stereo(rt);return nt},HowlerGlobal.prototype.pos=function(rt,nt,it){var at=this;if(!at.ctx||!at.ctx.listener)return at;if(nt=typeof nt!="number"?at._pos[1]:nt,it=typeof it!="number"?at._pos[2]:it,typeof rt=="number")at._pos=[rt,nt,it],typeof at.ctx.listener.positionX<"u"?(at.ctx.listener.positionX.setTargetAtTime(at._pos[0],Howler.ctx.currentTime,.1),at.ctx.listener.positionY.setTargetAtTime(at._pos[1],Howler.ctx.currentTime,.1),at.ctx.listener.positionZ.setTargetAtTime(at._pos[2],Howler.ctx.currentTime,.1)):at.ctx.listener.setPosition(at._pos[0],at._pos[1],at._pos[2]);else return at._pos;return at},HowlerGlobal.prototype.orientation=function(rt,nt,it,at,st,ot){var lt=this;if(!lt.ctx||!lt.ctx.listener)return lt;var ht=lt._orientation;if(nt=typeof nt!="number"?ht[1]:nt,it=typeof it!="number"?ht[2]:it,at=typeof at!="number"?ht[3]:at,st=typeof st!="number"?ht[4]:st,ot=typeof ot!="number"?ht[5]:ot,typeof rt=="number")lt._orientation=[rt,nt,it,at,st,ot],typeof lt.ctx.listener.forwardX<"u"?(lt.ctx.listener.forwardX.setTargetAtTime(rt,Howler.ctx.currentTime,.1),lt.ctx.listener.forwardY.setTargetAtTime(nt,Howler.ctx.currentTime,.1),lt.ctx.listener.forwardZ.setTargetAtTime(it,Howler.ctx.currentTime,.1),lt.ctx.listener.upX.setTargetAtTime(at,Howler.ctx.currentTime,.1),lt.ctx.listener.upY.setTargetAtTime(st,Howler.ctx.currentTime,.1),lt.ctx.listener.upZ.setTargetAtTime(ot,Howler.ctx.currentTime,.1)):lt.ctx.listener.setOrientation(rt,nt,it,at,st,ot);else return ht;return lt},Howl.prototype.init=(function(rt){return function(nt){var it=this;return it._orientation=nt.orientation||[1,0,0],it._stereo=nt.stereo||null,it._pos=nt.pos||null,it._pannerAttr={coneInnerAngle:typeof nt.coneInnerAngle<"u"?nt.coneInnerAngle:360,coneOuterAngle:typeof nt.coneOuterAngle<"u"?nt.coneOuterAngle:360,coneOuterGain:typeof nt.coneOuterGain<"u"?nt.coneOuterGain:0,distanceModel:typeof nt.distanceModel<"u"?nt.distanceModel:"inverse",maxDistance:typeof nt.maxDistance<"u"?nt.maxDistance:1e4,panningModel:typeof nt.panningModel<"u"?nt.panningModel:"HRTF",refDistance:typeof nt.refDistance<"u"?nt.refDistance:1,rolloffFactor:typeof nt.rolloffFactor<"u"?nt.rolloffFactor:1},it._onstereo=nt.onstereo?[{fn:nt.onstereo}]:[],it._onpos=nt.onpos?[{fn:nt.onpos}]:[],it._onorientation=nt.onorientation?[{fn:nt.onorientation}]:[],rt.call(this,nt)}})(Howl.prototype.init),Howl.prototype.stereo=function(rt,nt){var it=this;if(!it._webAudio)return it;if(it._state!=="loaded")return it._queue.push({event:"stereo",action:function(){it.stereo(rt,nt)}}),it;var at=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof nt>"u")if(typeof rt=="number")it._stereo=rt,it._pos=[rt,0,0];else return it._stereo;for(var st=it._getSoundIds(nt),ot=0;ot<st.length;ot++){var lt=it._soundById(st[ot]);if(lt)if(typeof rt=="number")lt._stereo=rt,lt._pos=[rt,0,0],lt._node&&(lt._pannerAttr.panningModel="equalpower",(!lt._panner||!lt._panner.pan)&&et(lt,at),at==="spatial"?typeof lt._panner.positionX<"u"?(lt._panner.positionX.setValueAtTime(rt,Howler.ctx.currentTime),lt._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),lt._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):lt._panner.setPosition(rt,0,0):lt._panner.pan.setValueAtTime(rt,Howler.ctx.currentTime)),it._emit("stereo",lt._id);else return lt._stereo}return it},Howl.prototype.pos=function(rt,nt,it,at){var st=this;if(!st._webAudio)return st;if(st._state!=="loaded")return st._queue.push({event:"pos",action:function(){st.pos(rt,nt,it,at)}}),st;if(nt=typeof nt!="number"?0:nt,it=typeof it!="number"?-.5:it,typeof at>"u")if(typeof rt=="number")st._pos=[rt,nt,it];else return st._pos;for(var ot=st._getSoundIds(at),lt=0;lt<ot.length;lt++){var ht=st._soundById(ot[lt]);if(ht)if(typeof rt=="number")ht._pos=[rt,nt,it],ht._node&&((!ht._panner||ht._panner.pan)&&et(ht,"spatial"),typeof ht._panner.positionX<"u"?(ht._panner.positionX.setValueAtTime(rt,Howler.ctx.currentTime),ht._panner.positionY.setValueAtTime(nt,Howler.ctx.currentTime),ht._panner.positionZ.setValueAtTime(it,Howler.ctx.currentTime)):ht._panner.setPosition(rt,nt,it)),st._emit("pos",ht._id);else return ht._pos}return st},Howl.prototype.orientation=function(rt,nt,it,at){var st=this;if(!st._webAudio)return st;if(st._state!=="loaded")return st._queue.push({event:"orientation",action:function(){st.orientation(rt,nt,it,at)}}),st;if(nt=typeof nt!="number"?st._orientation[1]:nt,it=typeof it!="number"?st._orientation[2]:it,typeof at>"u")if(typeof rt=="number")st._orientation=[rt,nt,it];else return st._orientation;for(var ot=st._getSoundIds(at),lt=0;lt<ot.length;lt++){var ht=st._soundById(ot[lt]);if(ht)if(typeof rt=="number")ht._orientation=[rt,nt,it],ht._node&&(ht._panner||(ht._pos||(ht._pos=st._pos||[0,0,-.5]),et(ht,"spatial")),typeof ht._panner.orientationX<"u"?(ht._panner.orientationX.setValueAtTime(rt,Howler.ctx.currentTime),ht._panner.orientationY.setValueAtTime(nt,Howler.ctx.currentTime),ht._panner.orientationZ.setValueAtTime(it,Howler.ctx.currentTime)):ht._panner.setOrientation(rt,nt,it)),st._emit("orientation",ht._id);else return ht._orientation}return st},Howl.prototype.pannerAttr=function(){var rt=this,nt=arguments,it,at,st;if(!rt._webAudio)return rt;if(nt.length===0)return rt._pannerAttr;if(nt.length===1)if(typeof nt[0]=="object")it=nt[0],typeof at>"u"&&(it.pannerAttr||(it.pannerAttr={coneInnerAngle:it.coneInnerAngle,coneOuterAngle:it.coneOuterAngle,coneOuterGain:it.coneOuterGain,distanceModel:it.distanceModel,maxDistance:it.maxDistance,refDistance:it.refDistance,rolloffFactor:it.rolloffFactor,panningModel:it.panningModel}),rt._pannerAttr={coneInnerAngle:typeof it.pannerAttr.coneInnerAngle<"u"?it.pannerAttr.coneInnerAngle:rt._coneInnerAngle,coneOuterAngle:typeof it.pannerAttr.coneOuterAngle<"u"?it.pannerAttr.coneOuterAngle:rt._coneOuterAngle,coneOuterGain:typeof it.pannerAttr.coneOuterGain<"u"?it.pannerAttr.coneOuterGain:rt._coneOuterGain,distanceModel:typeof it.pannerAttr.distanceModel<"u"?it.pannerAttr.distanceModel:rt._distanceModel,maxDistance:typeof it.pannerAttr.maxDistance<"u"?it.pannerAttr.maxDistance:rt._maxDistance,refDistance:typeof it.pannerAttr.refDistance<"u"?it.pannerAttr.refDistance:rt._refDistance,rolloffFactor:typeof it.pannerAttr.rolloffFactor<"u"?it.pannerAttr.rolloffFactor:rt._rolloffFactor,panningModel:typeof it.pannerAttr.panningModel<"u"?it.pannerAttr.panningModel:rt._panningModel});else return st=rt._soundById(parseInt(nt[0],10)),st?st._pannerAttr:rt._pannerAttr;else nt.length===2&&(it=nt[0],at=parseInt(nt[1],10));for(var ot=rt._getSoundIds(at),lt=0;lt<ot.length;lt++)if(st=rt._soundById(ot[lt]),st){var ht=st._pannerAttr;ht={coneInnerAngle:typeof it.coneInnerAngle<"u"?it.coneInnerAngle:ht.coneInnerAngle,coneOuterAngle:typeof it.coneOuterAngle<"u"?it.coneOuterAngle:ht.coneOuterAngle,coneOuterGain:typeof it.coneOuterGain<"u"?it.coneOuterGain:ht.coneOuterGain,distanceModel:typeof it.distanceModel<"u"?it.distanceModel:ht.distanceModel,maxDistance:typeof it.maxDistance<"u"?it.maxDistance:ht.maxDistance,refDistance:typeof it.refDistance<"u"?it.refDistance:ht.refDistance,rolloffFactor:typeof it.rolloffFactor<"u"?it.rolloffFactor:ht.rolloffFactor,panningModel:typeof it.panningModel<"u"?it.panningModel:ht.panningModel};var dt=st._panner;dt||(st._pos||(st._pos=rt._pos||[0,0,-.5]),et(st,"spatial"),dt=st._panner),dt.coneInnerAngle=ht.coneInnerAngle,dt.coneOuterAngle=ht.coneOuterAngle,dt.coneOuterGain=ht.coneOuterGain,dt.distanceModel=ht.distanceModel,dt.maxDistance=ht.maxDistance,dt.refDistance=ht.refDistance,dt.rolloffFactor=ht.rolloffFactor,dt.panningModel=ht.panningModel}return rt},Sound.prototype.init=(function(rt){return function(){var nt=this,it=nt._parent;nt._orientation=it._orientation,nt._stereo=it._stereo,nt._pos=it._pos,nt._pannerAttr=it._pannerAttr,rt.call(this),nt._stereo?it.stereo(nt._stereo):nt._pos&&it.pos(nt._pos[0],nt._pos[1],nt._pos[2],nt._id)}})(Sound.prototype.init),Sound.prototype.reset=(function(rt){return function(){var nt=this,it=nt._parent;return nt._orientation=it._orientation,nt._stereo=it._stereo,nt._pos=it._pos,nt._pannerAttr=it._pannerAttr,nt._stereo?it.stereo(nt._stereo):nt._pos?it.pos(nt._pos[0],nt._pos[1],nt._pos[2],nt._id):nt._panner&&(nt._panner.disconnect(0),nt._panner=void 0,it._refreshBuffer(nt)),rt.call(this)}})(Sound.prototype.reset);var et=function(rt,nt){nt=nt||"spatial",nt==="spatial"?(rt._panner=Howler.ctx.createPanner(),rt._panner.coneInnerAngle=rt._pannerAttr.coneInnerAngle,rt._panner.coneOuterAngle=rt._pannerAttr.coneOuterAngle,rt._panner.coneOuterGain=rt._pannerAttr.coneOuterGain,rt._panner.distanceModel=rt._pannerAttr.distanceModel,rt._panner.maxDistance=rt._pannerAttr.maxDistance,rt._panner.refDistance=rt._pannerAttr.refDistance,rt._panner.rolloffFactor=rt._pannerAttr.rolloffFactor,rt._panner.panningModel=rt._pannerAttr.panningModel,typeof rt._panner.positionX<"u"?(rt._panner.positionX.setValueAtTime(rt._pos[0],Howler.ctx.currentTime),rt._panner.positionY.setValueAtTime(rt._pos[1],Howler.ctx.currentTime),rt._panner.positionZ.setValueAtTime(rt._pos[2],Howler.ctx.currentTime)):rt._panner.setPosition(rt._pos[0],rt._pos[1],rt._pos[2]),typeof rt._panner.orientationX<"u"?(rt._panner.orientationX.setValueAtTime(rt._orientation[0],Howler.ctx.currentTime),rt._panner.orientationY.setValueAtTime(rt._orientation[1],Howler.ctx.currentTime),rt._panner.orientationZ.setValueAtTime(rt._orientation[2],Howler.ctx.currentTime)):rt._panner.setOrientation(rt._orientation[0],rt._orientation[1],rt._orientation[2])):(rt._panner=Howler.ctx.createStereoPanner(),rt._panner.pan.setValueAtTime(rt._stereo,Howler.ctx.currentTime)),rt._panner.connect(rt._node),rt._paused||rt._parent.pause(rt._id,!0).play(rt._id,!0)}})()})(howler)),howler}var howlerExports=requireHowler();class AudioManager{static instance;sounds=new Map;stateAssets=new Map;volumes={master:1,ost:.7,sfx:1};constructor(){const et=SharedSession.getInstance();this.volumes.master=et.get("master_volume",1)??1,this.volumes.ost=et.get("ost_volume",.7)??.7,this.volumes.sfx=et.get("sfx_volume",1)??1}static getInstance(){return this.instance||(this.instance=new AudioManager),this.instance}async loadManifest(et,rt){const it=await(await fetch(et)).json();if(!it.audio)return;this.stateAssets.has(rt)||this.stateAssets.set(rt,new Set);const at=this.stateAssets.get(rt);Object.entries(it.audio).forEach(([st,ot])=>{if(this.sounds.has(st))return;const lt=new howlerExports.Howl({src:[ot.url],loop:ot.loop||!1,volume:ot.volume*this.volumes[ot.type]*this.volumes.master,html5:ot.type==="ost"});this.sounds.set(st,{howl:lt,type:ot.type,baseVol:ot.volume||1}),at.add(st)})}play(et){const rt=this.sounds.get(et);rt&&rt.howl.play()}stop(et){this.sounds.get(et)?.howl.stop()}stopAllByState(et){const rt=this.stateAssets.get(et);rt&&rt.forEach(nt=>this.sounds.get(nt)?.howl.stop())}uncacheByState(et){const rt=this.stateAssets.get(et);rt&&(rt.forEach(nt=>{const it=this.sounds.get(nt);it&&(it.howl.stop(),it.howl.unload(),this.sounds.delete(nt))}),this.stateAssets.delete(et))}setVolume(et,rt){this.volumes[et]=rt,SharedSession.getInstance().set(`settings_${et}_vol`,rt),this.sounds.forEach(nt=>{const it=nt.type==="ost"?this.volumes.ost:this.volumes.sfx;nt.howl.volume(nt.baseVol*it*this.volumes.master)})}getVolumes(){return{...this.volumes}}}class LoadingState extends State$1{constructor(et,rt){super(),this.targetState=et,this.config=rt,this.isRendering=!0}name="LoadingState";isTargetReady=!1;async init(){this.config.manifestPath&&await Promise.all([SpriteManager.getInstance().loadManifest(this.config.manifestPath,this.name),AudioManager.getInstance().loadManifest(this.config.manifestPath,this.name)]),this.startTargetInit()}async startTargetInit(){try{await this.targetState.init(),this.isTargetReady=!0,StateManager.getInstance().notify()}catch(et){console.error("Failed to load target state:",et)}}update(et,rt){}getView(){const et=this.config.view||DefaultLoadingView;return React.createElement(et,{key:"loading-view",...this.config.props,isFinished:this.isTargetReady,onTransitionComplete:()=>this.finishLoading()})}finishLoading(){StateManager.getInstance().replace(this.targetState)}destroy(){SpriteManager.getInstance().uncacheByState(this.name),AudioManager.getInstance().uncacheByState(this.name)}}class StateManager{static instance;stack=[];listeners=[];constructor(){}static getInstance(){return StateManager.instance||(StateManager.instance=new StateManager),StateManager.instance}async push(et,rt=!0){rt&&this.stack.length>0&&(this.stack[this.stack.length-1].isUpdating=!1,this.stack[this.stack.length-1].isRendering=!0),await et.init(),this.stack.push(et),this.notify()}pop(){if(this.stack.length<=1)return;const et=this.stack.pop();et&&et.destroy(),this.stack.length>0&&(this.stack[this.stack.length-1].isUpdating=!0,this.stack[this.stack.length-1].isRendering=!0),this.notify()}async replace(et,rt){this.stack.forEach(it=>it.destroy()),this.stack=[],this.notify();const nt=rt?new LoadingState(et,rt):et;await nt.init(),this.stack.push(nt),this.notify(),Engine.getInstance().start()}updateAll(et,rt){this.stack.forEach(nt=>{nt.isUpdating&&nt.update(et,rt)})}getActiveUpdateStates(){return this.stack.filter(et=>et.isUpdating)}getCurrentStateName(){return this.stack.length>0?this.stack[this.stack.length-1].name:null}subscribe(et){return this.listeners.push(et),this.notify(),()=>{this.listeners=this.listeners.filter(rt=>rt!==et)}}getUnderlyingStateName(){if(this.stack.length===0)return null;for(let et=this.stack.length-1;et>=0;et--){const rt=this.stack[et];if(rt.name!=="PauseMenu"&&rt.name!=="SaveMenu"&&rt.name!=="SettingsMenu")return rt.name}return this.stack[0].name}getActiveState(){return this.stack.length>0?this.stack[this.stack.length-1]:null}notify(){const et=this.stack.filter(rt=>rt.isRendering).map(rt=>rt.getView());this.listeners.forEach(rt=>rt(et))}}const DebugOverlay=()=>{const tt=reactExports.useRef(null),et=Engine.getInstance(),rt=StateManager.getInstance(),nt=reactExports.useRef(0),it=reactExports.useRef([]),at=reactExports.useRef(new Set);return reactExports.useEffect(()=>{const st=dt=>at.current.add(dt.key.toUpperCase()),ot=dt=>at.current.delete(dt.key.toUpperCase());window.addEventListener("keydown",st),window.addEventListener("keyup",ot);let lt;const ht=()=>{if(tt.current){const dt=et.fps||0,ut=et.frameCount||0,ft=rt.stack||[];if(ft.length!==nt.current){const xt=new Date().toLocaleTimeString().split(" ")[0],wt=ft.length>nt.current?"PUSH":"POP",At=ft[ft.length-1]?.name||"NULL";it.current.unshift(`[${xt}] ${wt}: ${At}`),it.current.length>3&&it.current.pop(),nt.current=ft.length}const mt=ft.map((xt,wt)=>`${wt===ft.length-1?" ACTIVE >":"        -"} [${wt}] ${xt.name}`).reverse().join(`
`),gt=Array.from(at.current),vt=gt.length>0?gt.join(" | "):"IDLE";tt.current.innerText=`// ENGINE_STATS
FPS:    ${dt}
FRAME:  ${ut}

// STATE_STACK
${mt||"EMPTY"}

// INPUT_MONITOR
KEYS:   ${vt}

// RECENT_TRANSITIONS
${it.current.join(`
`)||"NONE"}`}lt=requestAnimationFrame(ht)};return lt=requestAnimationFrame(ht),()=>{cancelAnimationFrame(lt),window.removeEventListener("keydown",st),window.removeEventListener("keyup",ot)}},[et,rt]),jsxRuntimeExports.jsx("div",{ref:tt,style:{position:"absolute",top:"1cqw",right:"1cqw",color:"#0f0",fontFamily:"monospace",whiteSpace:"pre",textAlign:"left",fontSize:"0.95cqw",lineHeight:"1.4",textShadow:"0 0 5px rgba(0, 255, 0, 0.5)",backgroundColor:"rgba(5, 5, 5, 0.9)",padding:"1.2cqw",borderRadius:"0.2cqw",pointerEvents:"none",zIndex:9999,borderLeft:"3px solid #0f0",minWidth:"22cqw",boxShadow:"0 10px 30px rgba(0,0,0,0.8)",letterSpacing:"0.05cqw"}})};class StateRegistry{static states=new Map;static register(et){this.states.set(et.id,et)}static get(et){return this.states.get(et)}static create(et,rt){const nt=this.get(et);if(!nt)throw new Error(`StateRegistry: ID "${et}" not found.`);return nt.factory(rt)}static getAllGames(){return Array.from(this.states.values()).filter(et=>et.type==="GAME")}}var StateId=(tt=>(tt.GAME_1="Game1",tt.GAME_2="Game2",tt.GAME_3="Game3",tt.BH_GAME="BHGame",tt.DEV_MENU="DevMenu",tt.PAUSE_MENU="PauseMenu",tt.SAVE_MENU="SaveMenu",tt.SETTINGS_MENU="SettingsMenu",tt.CONTINUE="ContinueScreen",tt.GAME_OVER="GameOverScreen",tt))(StateId||{});const GLOBAL_SESSION_MAP={hp:"global_hp",energy:"global_energy"};class BaseGameState extends State$1{constructor(et=!1){super(),this.forceReset=et,this.isRendering=!1,this.isUpdating=!1}vm;controller;instanceId="";isLoadedFromSave=!1;async init(){if(this.isInitialized){this.isUpdating=!0,this.isRendering=!0;return}const et=WorkerManager$1.getInstance(),rt=ViewWorkerManager.getInstance(),nt=SharedSession.getInstance();et.activeStateName===this.name&&(this.isLoadedFromSave=!0),this.instanceId=et.prepareForState(this.name),et.setupBuffers(this.logicSchema,this.forceReset),rt.prepareForState(this.name),rt.setupBuffers(et.getBuffers(),this.viewSchema);try{await this.internalLoadResources()}catch(it){console.warn(`[${this.name}] Resource load warning:`,it)}this.initMVC(),et.createState(this.name),rt.createState(this.name),await this.internalPostInit(et,nt),nt.unlock(),this.isInitialized=!0,this.isUpdating=!0,this.isRendering=!0}update(et,rt){this.isUpdating&&(this.controller&&this.controller.update(),this.vm&&this.vm.update&&this.vm.update())}getView(){return React.createElement(this.viewComponent,{key:this.instanceId,vm:this.vm,controller:this.controller})}destroy(){const et=SharedSession.getInstance(),rt=WorkerManager$1.getInstance(),nt=ViewWorkerManager.getInstance();this.isUpdating=!1,this.isRendering=!1,this.isInitialized=!1,this.syncGlobalsToSession(et),AudioManager.getInstance().stopAllByState(this.name),AudioManager.getInstance().uncacheByState(this.name),SpriteManager.getInstance().uncacheByState(this.name),this.controller&&this.controller.destroy(),this.onBeforeDestroy(et,rt),rt.terminateState(this.name,this.instanceId),nt.terminateState(this.name),InputManager.getInstance().reset()}async onCustomLoadResources(){}onBeforeDestroy(et,rt){}async internalLoadResources(){const et=this.getConfig();et.manifestPath&&await Promise.all([SpriteManager.getInstance().loadManifest(et.manifestPath,this.name),AudioManager.getInstance().loadManifest(et.manifestPath,this.name)]),await this.onCustomLoadResources()}async internalPostInit(et,rt){const nt=this.getConfig();if(this.isLoadedFromSave)et.isInitialized=!0;else if(this.forceReset)rt.clearSavableKeys(),et.sendInput(this.name,"INITIALIZE",nt);else{const it=this.getSessionOverrides(rt),at={...nt,...it};et.sendInput(this.name,"INITIALIZE",at)}this.vm&&this.vm.notify&&this.vm.notify(),nt.bgmKey&&AudioManager.getInstance().play(nt.bgmKey)}syncGlobalsToSession(et){this.vm&&Object.entries(GLOBAL_SESSION_MAP).forEach(([rt,nt])=>{rt in this.vm&&et.set(nt,this.vm[rt])})}}var dexie_min$1={exports:{}},dexie_min=dexie_min$1.exports,hasRequiredDexie_min;function requireDexie_min(){return hasRequiredDexie_min||(hasRequiredDexie_min=1,(function(tt,et){((rt,nt)=>{tt.exports=nt()})(dexie_min,function(){var rt=function(St,Dt){return(rt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(Jt,sr){Jt.__proto__=sr}:function(Jt,sr){for(var gr in sr)Object.prototype.hasOwnProperty.call(sr,gr)&&(Jt[gr]=sr[gr])}))(St,Dt)},nt=function(){return(nt=Object.assign||function(St){for(var Dt,Jt=1,sr=arguments.length;Jt<sr;Jt++)for(var gr in Dt=arguments[Jt])Object.prototype.hasOwnProperty.call(Dt,gr)&&(St[gr]=Dt[gr]);return St}).apply(this,arguments)};function it(St,Dt,Jt){for(var sr,gr=0,xr=Dt.length;gr<xr;gr++)!sr&&gr in Dt||((sr=sr||Array.prototype.slice.call(Dt,0,gr))[gr]=Dt[gr]);return St.concat(sr||Array.prototype.slice.call(Dt))}var at=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal$1,st=Object.keys,ot=Array.isArray;function lt(St,Dt){return typeof Dt=="object"&&st(Dt).forEach(function(Jt){St[Jt]=Dt[Jt]}),St}typeof Promise>"u"||at.Promise||(at.Promise=Promise);var ht=Object.getPrototypeOf,dt={}.hasOwnProperty;function ut(St,Dt){return dt.call(St,Dt)}function ft(St,Dt){typeof Dt=="function"&&(Dt=Dt(ht(St))),(typeof Reflect>"u"?st:Reflect.ownKeys)(Dt).forEach(function(Jt){gt(St,Jt,Dt[Jt])})}var mt=Object.defineProperty;function gt(St,Dt,Jt,sr){mt(St,Dt,lt(Jt&&ut(Jt,"get")&&typeof Jt.get=="function"?{get:Jt.get,set:Jt.set,configurable:!0}:{value:Jt,configurable:!0,writable:!0},sr))}function vt(St){return{from:function(Dt){return St.prototype=Object.create(Dt.prototype),gt(St.prototype,"constructor",St),{extend:ft.bind(null,St.prototype)}}}}var xt=Object.getOwnPropertyDescriptor,wt=[].slice;function At(St,Dt,Jt){return wt.call(St,Dt,Jt)}function Tt(St,Dt){return Dt(St)}function Pt(St){if(!St)throw new Error("Assertion Failed")}function Rt(St){at.setImmediate?setImmediate(St):setTimeout(St,0)}function Ot(St,Dt){if(typeof Dt=="string"&&ut(St,Dt))return St[Dt];if(!Dt)return St;if(typeof Dt!="string"){for(var Jt=[],sr=0,gr=Dt.length;sr<gr;++sr){var xr=Ot(St,Dt[sr]);Jt.push(xr)}return Jt}var Ar,Mr=Dt.indexOf(".");return Mr===-1||(Ar=St[Dt.substr(0,Mr)])==null?void 0:Ot(Ar,Dt.substr(Mr+1))}function Et(St,Dt,Jt){if(St&&Dt!==void 0&&!("isFrozen"in Object&&Object.isFrozen(St)))if(typeof Dt!="string"&&"length"in Dt){Pt(typeof Jt!="string"&&"length"in Jt);for(var sr=0,gr=Dt.length;sr<gr;++sr)Et(St,Dt[sr],Jt[sr])}else{var xr,Ar,Mr=Dt.indexOf(".");Mr!==-1?(xr=Dt.substr(0,Mr),(Mr=Dt.substr(Mr+1))===""?Jt===void 0?ot(St)&&!isNaN(parseInt(xr))?St.splice(xr,1):delete St[xr]:St[xr]=Jt:Et(Ar=(Ar=St[xr])&&ut(St,xr)?Ar:St[xr]={},Mr,Jt)):Jt===void 0?ot(St)&&!isNaN(parseInt(Dt))?St.splice(Dt,1):delete St[Dt]:St[Dt]=Jt}}function Lt(St){var Dt,Jt={};for(Dt in St)ut(St,Dt)&&(Jt[Dt]=St[Dt]);return Jt}var kt=[].concat;function jt(St){return kt.apply([],St)}var er="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(jt([8,16,32,64].map(function(St){return["Int","Uint","Float"].map(function(Dt){return Dt+St+"Array"})}))).filter(function(St){return at[St]}),Mt=new Set(er.map(function(St){return at[St]})),$t=null;function Qt(St){return $t=new WeakMap,St=(function Dt(Jt){if(!Jt||typeof Jt!="object")return Jt;var sr=$t.get(Jt);if(sr)return sr;if(ot(Jt)){sr=[],$t.set(Jt,sr);for(var gr=0,xr=Jt.length;gr<xr;++gr)sr.push(Dt(Jt[gr]))}else if(Mt.has(Jt.constructor))sr=Jt;else{var Ar,Mr=ht(Jt);for(Ar in sr=Mr===Object.prototype?{}:Object.create(Mr),$t.set(Jt,sr),Jt)ut(Jt,Ar)&&(sr[Ar]=Dt(Jt[Ar]))}return sr})(St),$t=null,St}var Ht={}.toString;function qt(St){return Ht.call(St).slice(8,-1)}var Bt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Xt=typeof Bt=="symbol"?function(St){var Dt;return St!=null&&(Dt=St[Bt])&&Dt.apply(St)}:function(){return null};function Ft(St,Dt){Dt=St.indexOf(Dt),0<=Dt&&St.splice(Dt,1)}var Wt={};function Yt(St){var Dt,Jt,sr,gr;if(arguments.length===1){if(ot(St))return St.slice();if(this===Wt&&typeof St=="string")return[St];if(gr=Xt(St))for(Jt=[];!(sr=gr.next()).done;)Jt.push(sr.value);else{if(St==null)return[St];if(typeof(Dt=St.length)!="number")return[St];for(Jt=new Array(Dt);Dt--;)Jt[Dt]=St[Dt]}}else for(Dt=arguments.length,Jt=new Array(Dt);Dt--;)Jt[Dt]=arguments[Dt];return Jt}var zt=typeof Symbol<"u"?function(St){return St[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},er=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Mn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(er),dr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function fr(St,Dt){this.name=St,this.message=Dt}function lr(St,Dt){return St+". Errors: "+Object.keys(Dt).map(function(Jt){return Dt[Jt].toString()}).filter(function(Jt,sr,gr){return gr.indexOf(Jt)===sr}).join(`
`)}function mr(St,Dt,Jt,sr){this.failures=Dt,this.failedKeys=sr,this.successCount=Jt,this.message=lr(St,Dt)}function br(St,Dt){this.name="BulkError",this.failures=Object.keys(Dt).map(function(Jt){return Dt[Jt]}),this.failuresByPos=Dt,this.message=lr(St,this.failures)}vt(fr).from(Error).extend({toString:function(){return this.name+": "+this.message}}),vt(mr).from(fr),vt(br).from(fr);var Sr=Mn.reduce(function(St,Dt){return St[Dt]=Dt+"Error",St},{}),Ir=fr,cr=Mn.reduce(function(St,Dt){var Jt=Dt+"Error";function sr(gr,xr){this.name=Jt,gr?typeof gr=="string"?(this.message="".concat(gr).concat(xr?`
 `+xr:""),this.inner=xr||null):typeof gr=="object"&&(this.message="".concat(gr.name," ").concat(gr.message),this.inner=gr):(this.message=dr[Dt]||Jt,this.inner=null)}return vt(sr).from(Ir),St[Dt]=sr,St},{}),Nt=(cr.Syntax=SyntaxError,cr.Type=TypeError,cr.Range=RangeError,er.reduce(function(St,Dt){return St[Dt+"Error"]=cr[Dt],St},{}));er=Mn.reduce(function(St,Dt){return["Syntax","Type","Range"].indexOf(Dt)===-1&&(St[Dt+"Error"]=cr[Dt]),St},{});function pr(){}function rr(St){return St}function ar(St,Dt){return St==null||St===rr?Dt:function(Jt){return Dt(St(Jt))}}function nr(St,Dt){return function(){St.apply(this,arguments),Dt.apply(this,arguments)}}function ur(St,Dt){return St===pr?Dt:function(){var Jt=St.apply(this,arguments),sr=(Jt!==void 0&&(arguments[0]=Jt),this.onsuccess),gr=this.onerror,xr=(this.onsuccess=null,this.onerror=null,Dt.apply(this,arguments));return sr&&(this.onsuccess=this.onsuccess?nr(sr,this.onsuccess):sr),gr&&(this.onerror=this.onerror?nr(gr,this.onerror):gr),xr!==void 0?xr:Jt}}function Er(St,Dt){return St===pr?Dt:function(){St.apply(this,arguments);var Jt=this.onsuccess,sr=this.onerror;this.onsuccess=this.onerror=null,Dt.apply(this,arguments),Jt&&(this.onsuccess=this.onsuccess?nr(Jt,this.onsuccess):Jt),sr&&(this.onerror=this.onerror?nr(sr,this.onerror):sr)}}function Ut(St,Dt){return St===pr?Dt:function(gr){var sr=St.apply(this,arguments),gr=(lt(gr,sr),this.onsuccess),xr=this.onerror,Ar=(this.onsuccess=null,this.onerror=null,Dt.apply(this,arguments));return gr&&(this.onsuccess=this.onsuccess?nr(gr,this.onsuccess):gr),xr&&(this.onerror=this.onerror?nr(xr,this.onerror):xr),sr===void 0?Ar===void 0?void 0:Ar:lt(sr,Ar)}}function Kt(St,Dt){return St===pr?Dt:function(){return Dt.apply(this,arguments)!==!1&&St.apply(this,arguments)}}function or(St,Dt){return St===pr?Dt:function(){var Jt=St.apply(this,arguments);if(Jt&&typeof Jt.then=="function"){for(var sr=this,gr=arguments.length,xr=new Array(gr);gr--;)xr[gr]=arguments[gr];return Jt.then(function(){return Dt.apply(sr,xr)})}return Dt.apply(this,arguments)}}er.ModifyError=mr,er.DexieError=fr,er.BulkError=br;var hr=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function kr(St){hr=St}var Br={},Gn=100,Xn=typeof Promise>"u"?[]:(Mn=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Xn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),ht(Xn),Mn]:[Mn,ht(Mn),Mn]),Mn=Xn[0],Hs=Xn[1],Hs=Hs&&Hs.then,Kn=Mn&&Mn.constructor,Vn=!!Xn[2],vi=function(St,Dt){Rr.push([St,Dt]),_i&&(queueMicrotask(bi),_i=!1)},mi=!0,_i=!0,Ri=[],pi=[],Tr=rr,qn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pr,pgp:!1,env:{},finalize:pr},_r=qn,Rr=[],yr=0,Kr=[];function Jr(St){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var Dt=this._PSD=_r;if(typeof St!="function"){if(St!==Br)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Dr(this,this._value)}else this._state=null,this._value=null,++Dt.ref,(function Jt(sr,gr){try{gr(function(xr){if(sr._state===null){if(xr===sr)throw new TypeError("A promise cannot be resolved with itself.");var Ar=sr._lib&&ri();xr&&typeof xr.then=="function"?Jt(sr,function(Mr,jr){xr instanceof Jr?xr._then(Mr,jr):xr.then(Mr,jr)}):(sr._state=!0,sr._value=xr,Pr(sr)),Ar&&yi()}},Dr.bind(null,sr))}catch(xr){Dr(sr,xr)}})(this,St)}var Zt={get:function(){var St=_r,Dt=Oa;function Jt(sr,gr){var xr=this,Ar=!St.global&&(St!==_r||Dt!==Oa),Mr=Ar&&!Xi(),jr=new Jr(function(Zr,$r){Hr(xr,new Qr(zo(sr,St,Ar,Mr),zo(gr,St,Ar,Mr),Zr,$r,St))});return this._consoleTask&&(jr._consoleTask=this._consoleTask),jr}return Jt.prototype=Br,Jt},set:function(St){gt(this,"then",St&&St.prototype===Br?Zt:{get:function(){return St},set:Zt.set})}};function Qr(St,Dt,Jt,sr,gr){this.onFulfilled=typeof St=="function"?St:null,this.onRejected=typeof Dt=="function"?Dt:null,this.resolve=Jt,this.reject=sr,this.psd=gr}function Dr(St,Dt){var Jt,sr;pi.push(Dt),St._state===null&&(Jt=St._lib&&ri(),Dt=Tr(Dt),St._state=!1,St._value=Dt,sr=St,Ri.some(function(gr){return gr._value===sr._value})||Ri.push(sr),Pr(St),Jt)&&yi()}function Pr(St){var Dt=St._listeners;St._listeners=[];for(var Jt=0,sr=Dt.length;Jt<sr;++Jt)Hr(St,Dt[Jt]);var gr=St._PSD;--gr.ref||gr.finalize(),yr===0&&(++yr,vi(function(){--yr==0&&Li()},[]))}function Hr(St,Dt){if(St._state===null)St._listeners.push(Dt);else{var Jt=St._state?Dt.onFulfilled:Dt.onRejected;if(Jt===null)return(St._state?Dt.resolve:Dt.reject)(St._value);++Dt.psd.ref,++yr,vi(qr,[Jt,St,Dt])}}function qr(St,Dt,Jt){try{var sr,gr=Dt._value;!Dt._state&&pi.length&&(pi=[]),sr=hr&&Dt._consoleTask?Dt._consoleTask.run(function(){return St(gr)}):St(gr),Dt._state||pi.indexOf(gr)!==-1||(xr=>{for(var Ar=Ri.length;Ar;)if(Ri[--Ar]._value===xr._value)return Ri.splice(Ar,1)})(Dt),Jt.resolve(sr)}catch(xr){Jt.reject(xr)}finally{--yr==0&&Li(),--Jt.psd.ref||Jt.psd.finalize()}}function bi(){is(qn,function(){ri()&&yi()})}function ri(){var St=mi;return _i=mi=!1,St}function yi(){var St,Dt,Jt;do for(;0<Rr.length;)for(St=Rr,Rr=[],Jt=St.length,Dt=0;Dt<Jt;++Dt){var sr=St[Dt];sr[0].apply(null,sr[1])}while(0<Rr.length);_i=mi=!0}function Li(){for(var St=Ri,Dt=(Ri=[],St.forEach(function(sr){sr._PSD.onunhandled.call(null,sr._value,sr)}),Kr.slice(0)),Jt=Dt.length;Jt;)Dt[--Jt]()}function xa(St){return new Jr(Br,!1,St)}function Ti(St,Dt){var Jt=_r;return function(){var sr=ri(),gr=_r;try{return Ua(Jt,!0),St.apply(this,arguments)}catch(xr){Dt&&Dt(xr)}finally{Ua(gr,!1),sr&&yi()}}}ft(Jr.prototype,{then:Zt,_then:function(St,Dt){Hr(this,new Qr(null,null,St,Dt,_r))},catch:function(St){var Dt,Jt;return arguments.length===1?this.then(null,St):(Dt=St,Jt=arguments[1],typeof Dt=="function"?this.then(null,function(sr){return(sr instanceof Dt?Jt:xa)(sr)}):this.then(null,function(sr){return(sr&&sr.name===Dt?Jt:xa)(sr)}))},finally:function(St){return this.then(function(Dt){return Jr.resolve(St()).then(function(){return Dt})},function(Dt){return Jr.resolve(St()).then(function(){return xa(Dt)})})},timeout:function(St,Dt){var Jt=this;return St<1/0?new Jr(function(sr,gr){var xr=setTimeout(function(){return gr(new cr.Timeout(Dt))},St);Jt.then(sr,gr).finally(clearTimeout.bind(null,xr))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&gt(Jr.prototype,Symbol.toStringTag,"Dexie.Promise"),qn.env=Es(),ft(Jr,{all:function(){var St=Yt.apply(null,arguments).map(ca);return new Jr(function(Dt,Jt){St.length===0&&Dt([]);var sr=St.length;St.forEach(function(gr,xr){return Jr.resolve(gr).then(function(Ar){St[xr]=Ar,--sr||Dt(St)},Jt)})})},resolve:function(St){return St instanceof Jr?St:St&&typeof St.then=="function"?new Jr(function(Dt,Jt){St.then(Dt,Jt)}):new Jr(Br,!0,St)},reject:xa,race:function(){var St=Yt.apply(null,arguments).map(ca);return new Jr(function(Dt,Jt){St.map(function(sr){return Jr.resolve(sr).then(Dt,Jt)})})},PSD:{get:function(){return _r},set:function(St){return _r=St}},totalEchoes:{get:function(){return Oa}},newPSD:ua,usePSD:is,scheduler:{get:function(){return vi},set:function(St){vi=St}},rejectionMapper:{get:function(){return Tr},set:function(St){Tr=St}},follow:function(St,Dt){return new Jr(function(Jt,sr){return ua(function(gr,xr){var Ar=_r;Ar.unhandleds=[],Ar.onunhandled=xr,Ar.finalize=nr(function(){var Mr,jr=this;Mr=function(){jr.unhandleds.length===0?gr():xr(jr.unhandleds[0])},Kr.push(function Zr(){Mr(),Kr.splice(Kr.indexOf(Zr),1)}),++yr,vi(function(){--yr==0&&Li()},[])},Ar.finalize),St()},Dt,Jt,sr)})}}),Kn&&(Kn.allSettled&&gt(Jr,"allSettled",function(){var St=Yt.apply(null,arguments).map(ca);return new Jr(function(Dt){St.length===0&&Dt([]);var Jt=St.length,sr=new Array(Jt);St.forEach(function(gr,xr){return Jr.resolve(gr).then(function(Ar){return sr[xr]={status:"fulfilled",value:Ar}},function(Ar){return sr[xr]={status:"rejected",reason:Ar}}).then(function(){return--Jt||Dt(sr)})})})}),Kn.any&&typeof AggregateError<"u"&&gt(Jr,"any",function(){var St=Yt.apply(null,arguments).map(ca);return new Jr(function(Dt,Jt){St.length===0&&Jt(new AggregateError([]));var sr=St.length,gr=new Array(sr);St.forEach(function(xr,Ar){return Jr.resolve(xr).then(function(Mr){return Dt(Mr)},function(Mr){gr[Ar]=Mr,--sr||Jt(new AggregateError(gr))})})})}),Kn.withResolvers)&&(Jr.withResolvers=Kn.withResolvers);var $i={awaits:0,echoes:0,id:0},Ji=0,ea=[],Na=0,Oa=0,la=0;function ua(St,Ar,Jt,sr){var gr=_r,xr=Object.create(gr),Ar=(xr.parent=gr,xr.ref=0,xr.global=!1,xr.id=++la,qn.env,xr.env=Vn?{Promise:Jr,PromiseProp:{value:Jr,configurable:!0,writable:!0},all:Jr.all,race:Jr.race,allSettled:Jr.allSettled,any:Jr.any,resolve:Jr.resolve,reject:Jr.reject}:{},Ar&&lt(xr,Ar),++gr.ref,xr.finalize=function(){--this.parent.ref||this.parent.finalize()},is(xr,St,Jt,sr));return xr.ref===0&&xr.finalize(),Ar}function ka(){return $i.id||($i.id=++Ji),++$i.awaits,$i.echoes+=Gn,$i.id}function Xi(){return!!$i.awaits&&(--$i.awaits==0&&($i.id=0),$i.echoes=$i.awaits*Gn,!0)}function ca(St){return $i.echoes&&St&&St.constructor===Kn?(ka(),St.then(function(Dt){return Xi(),Dt},function(Dt){return Xi(),wa(Dt)})):St}function _a(){var St=ea[ea.length-1];ea.pop(),Ua(St,!1)}function Ua(St,Dt){var Jt,sr,gr=_r;(Dt?!$i.echoes||Na++&&St===_r:!Na||--Na&&St===_r)||queueMicrotask(Dt?(function(xr){++Oa,$i.echoes&&--$i.echoes!=0||($i.echoes=$i.awaits=$i.id=0),ea.push(_r),Ua(xr,!0)}).bind(null,St):_a),St!==_r&&(_r=St,gr===qn&&(qn.env=Es()),Vn)&&(Jt=qn.env.Promise,sr=St.env,gr.global||St.global)&&(Object.defineProperty(at,"Promise",sr.PromiseProp),Jt.all=sr.all,Jt.race=sr.race,Jt.resolve=sr.resolve,Jt.reject=sr.reject,sr.allSettled&&(Jt.allSettled=sr.allSettled),sr.any)&&(Jt.any=sr.any)}function Es(){var St=at.Promise;return Vn?{Promise:St,PromiseProp:Object.getOwnPropertyDescriptor(at,"Promise"),all:St.all,race:St.race,allSettled:St.allSettled,any:St.any,resolve:St.resolve,reject:St.reject}:{}}function is(St,Dt,Jt,sr,gr){var xr=_r;try{return Ua(St,!0),Dt(Jt,sr,gr)}finally{Ua(xr,!1)}}function zo(St,Dt,Jt,sr){return typeof St!="function"?St:function(){var gr=_r;Jt&&ka(),Ua(Dt,!0);try{return St.apply(this,arguments)}finally{Ua(gr,!1),sr&&queueMicrotask(Xi)}}}function Xs(St){Promise===Kn&&$i.echoes===0?Na===0?St():enqueueNativeMicroTask(St):setTimeout(St,0)}(""+Hs).indexOf("[native code]")===-1&&(ka=Xi=pr);var wa=Jr.reject,Qs="",ta="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Il="String expected.",Ks=[],ol="__dbnames",Pl="readonly",au="readwrite";function Ss(St,Dt){return St?Dt?function(){return St.apply(this,arguments)&&Dt.apply(this,arguments)}:St:Dt}var Ps={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function qi(St){return typeof St!="string"||/\./.test(St)?function(Dt){return Dt}:function(Dt){return Dt[St]===void 0&&St in Dt&&delete(Dt=Qt(Dt))[St],Dt}}function pa(){throw cr.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Fi(St,Dt){try{var Jt=Za(St),sr=Za(Dt);if(Jt!==sr)return Jt==="Array"?1:sr==="Array"?-1:Jt==="binary"?1:sr==="binary"?-1:Jt==="string"?1:sr==="string"?-1:Jt==="Date"?1:sr!=="Date"?NaN:-1;switch(Jt){case"number":case"Date":case"string":return Dt<St?1:St<Dt?-1:0;case"binary":for(var gr=ls(St),xr=ls(Dt),Ar=gr.length,Mr=xr.length,jr=Ar<Mr?Ar:Mr,Zr=0;Zr<jr;++Zr)if(gr[Zr]!==xr[Zr])return gr[Zr]<xr[Zr]?-1:1;return Ar===Mr?0:Ar<Mr?-1:1;case"Array":for(var $r=St,Ur=Dt,Gr=$r.length,Nr=Ur.length,Fr=Gr<Nr?Gr:Nr,Lr=0;Lr<Fr;++Lr){var An=Fi($r[Lr],Ur[Lr]);if(An!==0)return An}return Gr===Nr?0:Gr<Nr?-1:1}}catch{}return NaN}function Za(St){var Dt=typeof St;return Dt=="object"&&(ArrayBuffer.isView(St)||(Dt=qt(St))==="ArrayBuffer")?"binary":Dt}function ls(St){return St instanceof Uint8Array?St:ArrayBuffer.isView(St)?new Uint8Array(St.buffer,St.byteOffset,St.byteLength):new Uint8Array(St)}function Js(St,Dt,Jt){var sr=St.schema.yProps;return sr?(Dt&&0<Jt.numFailures&&(Dt=Dt.filter(function(gr,xr){return!Jt.failures[xr]})),Promise.all(sr.map(function(gr){return gr=gr.updatesTable,Dt?St.db.table(gr).where("k").anyOf(Dt).delete():St.db.table(gr).clear()})).then(function(){return Jt})):Jt}Ya.prototype.execute=function(St){var Dt=this["@@propmod"];if(Dt.add!==void 0){var Jt=Dt.add;if(ot(Jt))return it(it([],ot(St)?St:[],!0),Jt).sort();if(typeof Jt=="number")return(Number(St)||0)+Jt;if(typeof Jt=="bigint")try{return BigInt(St)+Jt}catch{return BigInt(0)+Jt}throw new TypeError("Invalid term ".concat(Jt))}if(Dt.remove!==void 0){var sr=Dt.remove;if(ot(sr))return ot(St)?St.filter(function(gr){return!sr.includes(gr)}).sort():[];if(typeof sr=="number")return Number(St)-sr;if(typeof sr=="bigint")try{return BigInt(St)-sr}catch{return BigInt(0)-sr}throw new TypeError("Invalid subtrahend ".concat(sr))}return Jt=(Jt=Dt.replacePrefix)==null?void 0:Jt[0],Jt&&typeof St=="string"&&St.startsWith(Jt)?Dt.replacePrefix[1]+St.substring(Jt.length):St};var Ts=Ya;function Ya(St){this["@@propmod"]=St}function jo(St,Dt){for(var Jt=st(Dt),sr=Jt.length,gr=!1,xr=0;xr<sr;++xr){var Ar=Jt[xr],Mr=Dt[Ar],jr=Ot(St,Ar);Mr instanceof Ts?(Et(St,Ar,Mr.execute(jr)),gr=!0):jr!==Mr&&(Et(St,Ar,Mr),gr=!0)}return gr}ma.prototype._trans=function(St,Dt,Jt){var sr=this._tx||_r.trans,gr=this.name,xr=hr&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(St==="readonly"?"read":"write"," ").concat(this.name));function Ar(Zr,$r,Ur){if(Ur.schema[gr])return Dt(Ur.idbtrans,Ur);throw new cr.NotFound("Table "+gr+" not part of transaction")}var Mr=ri();try{var jr=sr&&sr.db._novip===this.db._novip?sr===_r.trans?sr._promise(St,Ar,Jt):ua(function(){return sr._promise(St,Ar,Jt)},{trans:sr,transless:_r.transless||_r}):(function Zr($r,Ur,Gr,Nr){if($r.idbdb&&($r._state.openComplete||_r.letThrough||$r._vip)){var Fr=$r._createTransaction(Ur,Gr,$r._dbSchema);try{Fr.create(),$r._state.PR1398_maxLoop=3}catch(Lr){return Lr.name===Sr.InvalidState&&$r.isOpen()&&0<--$r._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$r.close({disableAutoOpen:!1}),$r.open().then(function(){return Zr($r,Ur,Gr,Nr)})):wa(Lr)}return Fr._promise(Ur,function(Lr,An){return ua(function(){return _r.trans=Fr,Nr(Lr,An,Fr)})}).then(function(Lr){if(Ur==="readwrite")try{Fr.idbtrans.commit()}catch{}return Ur==="readonly"?Lr:Fr._completion.then(function(){return Lr})})}if($r._state.openComplete)return wa(new cr.DatabaseClosed($r._state.dbOpenError));if(!$r._state.isBeingOpened){if(!$r._state.autoOpen)return wa(new cr.DatabaseClosed);$r.open().catch(pr)}return $r._state.dbReadyPromise.then(function(){return Zr($r,Ur,Gr,Nr)})})(this.db,St,[this.name],Ar);return xr&&(jr._consoleTask=xr,jr=jr.catch(function(Zr){return console.trace(Zr),wa(Zr)})),jr}finally{Mr&&yi()}},ma.prototype.get=function(St,Dt){var Jt=this;return St&&St.constructor===Object?this.where(St).first(Dt):St==null?wa(new cr.Type("Invalid argument to Table.get()")):this._trans("readonly",function(sr){return Jt.core.get({trans:sr,key:St}).then(function(gr){return Jt.hook.reading.fire(gr)})}).then(Dt)},ma.prototype.where=function(St){if(typeof St=="string")return new this.db.WhereClause(this,St);if(ot(St))return new this.db.WhereClause(this,"[".concat(St.join("+"),"]"));var Dt=st(St);if(Dt.length===1)return this.where(Dt[0]).equals(St[Dt[0]]);var Jt=this.schema.indexes.concat(this.schema.primKey).filter(function(Mr){if(Mr.compound&&Dt.every(function(Zr){return 0<=Mr.keyPath.indexOf(Zr)})){for(var jr=0;jr<Dt.length;++jr)if(Dt.indexOf(Mr.keyPath[jr])===-1)return!1;return!0}return!1}).sort(function(Mr,jr){return Mr.keyPath.length-jr.keyPath.length})[0];if(Jt&&this.db._maxKey!==Qs)return Ar=Jt.keyPath.slice(0,Dt.length),this.where(Ar).equals(Ar.map(function(Mr){return St[Mr]}));!Jt&&hr&&console.warn("The query ".concat(JSON.stringify(St)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(Dt.join("+"),"]"));var sr=this.schema.idxByName;function gr(Mr,jr){return Fi(Mr,jr)===0}var Ar=Dt.reduce(function($r,jr){var Zr=$r[0],$r=$r[1],Ur=sr[jr],Gr=St[jr];return[Zr||Ur,Zr||!Ur?Ss($r,Ur&&Ur.multi?function(Nr){return Nr=Ot(Nr,jr),ot(Nr)&&Nr.some(function(Fr){return gr(Gr,Fr)})}:function(Nr){return gr(Gr,Ot(Nr,jr))}):$r]},[null,null]),xr=Ar[0],Ar=Ar[1];return xr?this.where(xr.name).equals(St[xr.keyPath]).filter(Ar):Jt?this.filter(Ar):this.where(Dt).equals("")},ma.prototype.filter=function(St){return this.toCollection().and(St)},ma.prototype.count=function(St){return this.toCollection().count(St)},ma.prototype.offset=function(St){return this.toCollection().offset(St)},ma.prototype.limit=function(St){return this.toCollection().limit(St)},ma.prototype.each=function(St){return this.toCollection().each(St)},ma.prototype.toArray=function(St){return this.toCollection().toArray(St)},ma.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ma.prototype.orderBy=function(St){return new this.db.Collection(new this.db.WhereClause(this,ot(St)?"[".concat(St.join("+"),"]"):St))},ma.prototype.reverse=function(){return this.toCollection().reverse()},ma.prototype.mapToClass=function(St){for(var Dt=this.db,Jt=this.name,sr=((this.schema.mappedClass=St).prototype instanceof pa&&(St=(Ar=>{var Mr=$r,jr=Ar;if(typeof jr!="function"&&jr!==null)throw new TypeError("Class extends value "+String(jr)+" is not a constructor or null");function Zr(){this.constructor=Mr}function $r(){return Ar!==null&&Ar.apply(this,arguments)||this}return rt(Mr,jr),Mr.prototype=jr===null?Object.create(jr):(Zr.prototype=jr.prototype,new Zr),Object.defineProperty($r.prototype,"db",{get:function(){return Dt},enumerable:!1,configurable:!0}),$r.prototype.table=function(){return Jt},$r})(St)),new Set),gr=St.prototype;gr;gr=ht(gr))Object.getOwnPropertyNames(gr).forEach(function(Ar){return sr.add(Ar)});function xr(Ar){if(!Ar)return Ar;var Mr,jr=Object.create(St.prototype);for(Mr in Ar)if(!sr.has(Mr))try{jr[Mr]=Ar[Mr]}catch{}return jr}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=xr,this.hook("reading",xr),St},ma.prototype.defineClass=function(){return this.mapToClass(function(St){lt(this,St)})},ma.prototype.add=function(St,Dt){var Jt=this,sr=this.schema.primKey,gr=sr.auto,xr=sr.keyPath,Ar=St;return xr&&gr&&(Ar=qi(xr)(St)),this._trans("readwrite",function(Mr){return Jt.core.mutate({trans:Mr,type:"add",keys:Dt!=null?[Dt]:null,values:[Ar]})}).then(function(Mr){return Mr.numFailures?Jr.reject(Mr.failures[0]):Mr.lastResult}).then(function(Mr){if(xr)try{Et(St,xr,Mr)}catch{}return Mr})},ma.prototype.upsert=function(St,Dt){var Jt=this,sr=this.schema.primKey.keyPath;return this._trans("readwrite",function(gr){return Jt.core.get({trans:gr,key:St}).then(function(xr){var Ar=xr??{};return jo(Ar,Dt),sr&&Et(Ar,sr,St),Jt.core.mutate({trans:gr,type:"put",values:[Ar],keys:[St],upsert:!0,updates:{keys:[St],changeSpecs:[Dt]}}).then(function(Mr){return Mr.numFailures?Jr.reject(Mr.failures[0]):!!xr})})})},ma.prototype.update=function(St,Dt){return typeof St!="object"||ot(St)?this.where(":id").equals(St).modify(Dt):(St=Ot(St,this.schema.primKey.keyPath))===void 0?wa(new cr.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(St).modify(Dt)},ma.prototype.put=function(St,Dt){var Jt=this,sr=this.schema.primKey,gr=sr.auto,xr=sr.keyPath,Ar=St;return xr&&gr&&(Ar=qi(xr)(St)),this._trans("readwrite",function(Mr){return Jt.core.mutate({trans:Mr,type:"put",values:[Ar],keys:Dt!=null?[Dt]:null})}).then(function(Mr){return Mr.numFailures?Jr.reject(Mr.failures[0]):Mr.lastResult}).then(function(Mr){if(xr)try{Et(St,xr,Mr)}catch{}return Mr})},ma.prototype.delete=function(St){var Dt=this;return this._trans("readwrite",function(Jt){return Dt.core.mutate({trans:Jt,type:"delete",keys:[St]}).then(function(sr){return Js(Dt,[St],sr)}).then(function(sr){return sr.numFailures?Jr.reject(sr.failures[0]):void 0})})},ma.prototype.clear=function(){var St=this;return this._trans("readwrite",function(Dt){return St.core.mutate({trans:Dt,type:"deleteRange",range:Ps}).then(function(Jt){return Js(St,null,Jt)})}).then(function(Dt){return Dt.numFailures?Jr.reject(Dt.failures[0]):void 0})},ma.prototype.bulkGet=function(St){var Dt=this;return this._trans("readonly",function(Jt){return Dt.core.getMany({keys:St,trans:Jt}).then(function(sr){return sr.map(function(gr){return Dt.hook.reading.fire(gr)})})})},ma.prototype.bulkAdd=function(St,Dt,Jt){var sr=this,gr=Array.isArray(Dt)?Dt:void 0,xr=(Jt=Jt||(gr?void 0:Dt))?Jt.allKeys:void 0;return this._trans("readwrite",function(Ar){var Mr=sr.schema.primKey,Zr=Mr.auto,Mr=Mr.keyPath;if(Mr&&gr)throw new cr.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(gr&&gr.length!==St.length)throw new cr.InvalidArgument("Arguments objects and keys must have the same length");var jr=St.length,Zr=Mr&&Zr?St.map(qi(Mr)):St;return sr.core.mutate({trans:Ar,type:"add",keys:gr,values:Zr,wantResults:xr}).then(function($r){var Ur=$r.numFailures,Gr=$r.failures;if(Ur===0)return xr?$r.results:$r.lastResult;throw new br("".concat(sr.name,".bulkAdd(): ").concat(Ur," of ").concat(jr," operations failed"),Gr)})})},ma.prototype.bulkPut=function(St,Dt,Jt){var sr=this,gr=Array.isArray(Dt)?Dt:void 0,xr=(Jt=Jt||(gr?void 0:Dt))?Jt.allKeys:void 0;return this._trans("readwrite",function(Ar){var Mr=sr.schema.primKey,Zr=Mr.auto,Mr=Mr.keyPath;if(Mr&&gr)throw new cr.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(gr&&gr.length!==St.length)throw new cr.InvalidArgument("Arguments objects and keys must have the same length");var jr=St.length,Zr=Mr&&Zr?St.map(qi(Mr)):St;return sr.core.mutate({trans:Ar,type:"put",keys:gr,values:Zr,wantResults:xr}).then(function($r){var Ur=$r.numFailures,Gr=$r.failures;if(Ur===0)return xr?$r.results:$r.lastResult;throw new br("".concat(sr.name,".bulkPut(): ").concat(Ur," of ").concat(jr," operations failed"),Gr)})})},ma.prototype.bulkUpdate=function(St){var Dt=this,Jt=this.core,sr=St.map(function(Ar){return Ar.key}),gr=St.map(function(Ar){return Ar.changes}),xr=[];return this._trans("readwrite",function(Ar){return Jt.getMany({trans:Ar,keys:sr,cache:"clone"}).then(function(Mr){var jr=[],Zr=[],$r=(St.forEach(function(Ur,Gr){var Nr=Ur.key,Fr=Ur.changes,Lr=Mr[Gr];if(Lr){for(var An=0,Fn=Object.keys(Fr);An<Fn.length;An++){var Yr=Fn[An],Zn=Fr[Yr];if(Yr===Dt.schema.primKey.keyPath){if(Fi(Zn,Nr)!==0)throw new cr.Constraint("Cannot update primary key in bulkUpdate()")}else Et(Lr,Yr,Zn)}xr.push(Gr),jr.push(Nr),Zr.push(Lr)}}),jr.length);return Jt.mutate({trans:Ar,type:"put",keys:jr,values:Zr,updates:{keys:sr,changeSpecs:gr}}).then(function(Ur){var Gr=Ur.numFailures,Nr=Ur.failures;if(Gr===0)return $r;for(var Fr=0,Lr=Object.keys(Nr);Fr<Lr.length;Fr++){var An,Fn=Lr[Fr],Yr=xr[Number(Fn)];Yr!=null&&(An=Nr[Fn],delete Nr[Fn],Nr[Yr]=An)}throw new br("".concat(Dt.name,".bulkUpdate(): ").concat(Gr," of ").concat($r," operations failed"),Nr)})})})},ma.prototype.bulkDelete=function(St){var Dt=this,Jt=St.length;return this._trans("readwrite",function(sr){return Dt.core.mutate({trans:sr,type:"delete",keys:St}).then(function(gr){return Js(Dt,St,gr)})}).then(function(sr){var gr=sr.numFailures,xr=sr.failures;if(gr===0)return sr.lastResult;throw new br("".concat(Dt.name,".bulkDelete(): ").concat(gr," of ").concat(Jt," operations failed"),xr)})};var Cl=ma;function ma(){}function Go(St){function Dt(Ar,Mr){if(Mr){for(var jr=arguments.length,Zr=new Array(jr-1);--jr;)Zr[jr-1]=arguments[jr];return Jt[Ar].subscribe.apply(null,Zr),St}if(typeof Ar=="string")return Jt[Ar]}var Jt={};Dt.addEventType=xr;for(var sr=1,gr=arguments.length;sr<gr;++sr)xr(arguments[sr]);return Dt;function xr(Ar,Mr,jr){var Zr,$r;if(typeof Ar!="object")return Mr=Mr||Kt,$r={subscribers:[],fire:jr=jr||pr,subscribe:function(Ur){$r.subscribers.indexOf(Ur)===-1&&($r.subscribers.push(Ur),$r.fire=Mr($r.fire,Ur))},unsubscribe:function(Ur){$r.subscribers=$r.subscribers.filter(function(Gr){return Gr!==Ur}),$r.fire=$r.subscribers.reduce(Mr,jr)}},Jt[Ar]=Dt[Ar]=$r;st(Zr=Ar).forEach(function(Ur){var Gr=Zr[Ur];if(ot(Gr))xr(Ur,Zr[Ur][0],Zr[Ur][1]);else{if(Gr!=="asap")throw new cr.InvalidArgument("Invalid event config");var Nr=xr(Ur,rr,function(){for(var Fr=arguments.length,Lr=new Array(Fr);Fr--;)Lr[Fr]=arguments[Fr];Nr.subscribers.forEach(function(An){Rt(function(){An.apply(null,Lr)})})})}})}}function Ho(St,Dt){return vt(Dt).from({prototype:St}),Dt}function Xa(St,Dt){return!(St.filter||St.algorithm||St.or)&&(Dt?St.justLimit:!St.replayFilter)}function su(St,Dt){St.filter=Ss(St.filter,Dt)}function ll(St,Dt,Jt){var sr=St.replayFilter;St.replayFilter=sr?function(){return Ss(sr(),Dt())}:Dt,St.justLimit=Jt&&!sr}function Ml(St,Dt){if(St.isPrimKey)return Dt.primaryKey;var Jt=Dt.getIndexByKeyPath(St.index);if(Jt)return Jt;throw new cr.Schema("KeyPath "+St.index+" on object store "+Dt.name+" is not indexed")}function kl(St,Dt,Jt){var sr=Ml(St,Dt.schema);return Dt.openCursor({trans:Jt,values:!St.keysOnly,reverse:St.dir==="prev",unique:!!St.unique,query:{index:sr,range:St.range}})}function Zi(St,Dt,Jt,sr){var gr,xr,Ar=St.replayFilter?Ss(St.filter,St.replayFilter()):St.filter;return St.or?(gr={},xr=function(Mr,jr,Zr){var $r,Ur;Ar&&!Ar(jr,Zr,function(Gr){return jr.stop(Gr)},function(Gr){return jr.fail(Gr)})||((Ur=""+($r=jr.primaryKey))=="[object ArrayBuffer]"&&(Ur=""+new Uint8Array($r)),ut(gr,Ur))||(gr[Ur]=!0,Dt(Mr,jr,Zr))},Promise.all([St.or._iterate(xr,Jt),Ol(kl(St,sr,Jt),St.algorithm,xr,!St.keysOnly&&St.valueMapper)])):Ol(kl(St,sr,Jt),Ss(St.algorithm,Ar),Dt,!St.keysOnly&&St.valueMapper)}function Ol(St,Dt,Jt,sr){var gr=Ti(sr?function(xr,Ar,Mr){return Jt(sr(xr),Ar,Mr)}:Jt);return St.then(function(xr){if(xr)return xr.start(function(){var Ar=function(){return xr.continue()};Dt&&!Dt(xr,function(Mr){return Ar=Mr},function(Mr){xr.stop(Mr),Ar=pr},function(Mr){xr.fail(Mr),Ar=pr})||gr(xr.value,xr,function(Mr){return Ar=Mr}),Ar()})})}Yi.prototype._read=function(St,Dt){var Jt=this._ctx;return Jt.error?Jt.table._trans(null,wa.bind(null,Jt.error)):Jt.table._trans("readonly",St).then(Dt)},Yi.prototype._write=function(St){var Dt=this._ctx;return Dt.error?Dt.table._trans(null,wa.bind(null,Dt.error)):Dt.table._trans("readwrite",St,"locked")},Yi.prototype._addAlgorithm=function(St){var Dt=this._ctx;Dt.algorithm=Ss(Dt.algorithm,St)},Yi.prototype._iterate=function(St,Dt){return Zi(this._ctx,St,Dt,this._ctx.table.core)},Yi.prototype.clone=function(St){var Dt=Object.create(this.constructor.prototype),Jt=Object.create(this._ctx);return St&&lt(Jt,St),Dt._ctx=Jt,Dt},Yi.prototype.raw=function(){return this._ctx.valueMapper=null,this},Yi.prototype.each=function(St){var Dt=this._ctx;return this._read(function(Jt){return Zi(Dt,St,Jt,Dt.table.core)})},Yi.prototype.count=function(St){var Dt=this;return this._read(function(Jt){var sr,gr=Dt._ctx,xr=gr.table.core;return Xa(gr,!0)?xr.count({trans:Jt,query:{index:Ml(gr,xr.schema),range:gr.range}}).then(function(Ar){return Math.min(Ar,gr.limit)}):(sr=0,Zi(gr,function(){return++sr,!1},Jt,xr).then(function(){return sr}))}).then(St)},Yi.prototype.sortBy=function(St,Dt){var Jt=St.split(".").reverse(),sr=Jt[0],gr=Jt.length-1;function xr(jr,Zr){return Zr?xr(jr[Jt[Zr]],Zr-1):jr[sr]}var Ar=this._ctx.dir==="next"?1:-1;function Mr(jr,Zr){return Fi(xr(jr,gr),xr(Zr,gr))*Ar}return this.toArray(function(jr){return jr.sort(Mr)}).then(Dt)},Yi.prototype.toArray=function(St){var Dt=this;return this._read(function(Jt){var sr,gr,xr,Ar=Dt._ctx;return Ar.dir==="next"&&Xa(Ar,!0)&&0<Ar.limit?(sr=Ar.valueMapper,gr=Ml(Ar,Ar.table.core.schema),Ar.table.core.query({trans:Jt,limit:Ar.limit,values:!0,query:{index:gr,range:Ar.range}}).then(function(Mr){return Mr=Mr.result,sr?Mr.map(sr):Mr})):(xr=[],Zi(Ar,function(Mr){return xr.push(Mr)},Jt,Ar.table.core).then(function(){return xr}))},St)},Yi.prototype.offset=function(St){var Dt=this._ctx;return St<=0||(Dt.offset+=St,Xa(Dt)?ll(Dt,function(){var Jt=St;return function(sr,gr){return Jt===0||(Jt===1?--Jt:gr(function(){sr.advance(Jt),Jt=0}),!1)}}):ll(Dt,function(){var Jt=St;return function(){return--Jt<0}})),this},Yi.prototype.limit=function(St){return this._ctx.limit=Math.min(this._ctx.limit,St),ll(this._ctx,function(){var Dt=St;return function(Jt,sr,gr){return--Dt<=0&&sr(gr),0<=Dt}},!0),this},Yi.prototype.until=function(St,Dt){return su(this._ctx,function(Jt,sr,gr){return!St(Jt.value)||(sr(gr),Dt)}),this},Yi.prototype.first=function(St){return this.limit(1).toArray(function(Dt){return Dt[0]}).then(St)},Yi.prototype.last=function(St){return this.reverse().first(St)},Yi.prototype.filter=function(St){var Dt;return su(this._ctx,function(Jt){return St(Jt.value)}),(Dt=this._ctx).isMatch=Ss(Dt.isMatch,St),this},Yi.prototype.and=function(St){return this.filter(St)},Yi.prototype.or=function(St){return new this.db.WhereClause(this._ctx.table,St,this)},Yi.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Yi.prototype.desc=function(){return this.reverse()},Yi.prototype.eachKey=function(St){var Dt=this._ctx;return Dt.keysOnly=!Dt.isMatch,this.each(function(Jt,sr){St(sr.key,sr)})},Yi.prototype.eachUniqueKey=function(St){return this._ctx.unique="unique",this.eachKey(St)},Yi.prototype.eachPrimaryKey=function(St){var Dt=this._ctx;return Dt.keysOnly=!Dt.isMatch,this.each(function(Jt,sr){St(sr.primaryKey,sr)})},Yi.prototype.keys=function(St){var Dt=this._ctx,Jt=(Dt.keysOnly=!Dt.isMatch,[]);return this.each(function(sr,gr){Jt.push(gr.key)}).then(function(){return Jt}).then(St)},Yi.prototype.primaryKeys=function(St){var Dt=this._ctx;if(Dt.dir==="next"&&Xa(Dt,!0)&&0<Dt.limit)return this._read(function(sr){var gr=Ml(Dt,Dt.table.core.schema);return Dt.table.core.query({trans:sr,values:!1,limit:Dt.limit,query:{index:gr,range:Dt.range}})}).then(function(sr){return sr.result}).then(St);Dt.keysOnly=!Dt.isMatch;var Jt=[];return this.each(function(sr,gr){Jt.push(gr.primaryKey)}).then(function(){return Jt}).then(St)},Yi.prototype.uniqueKeys=function(St){return this._ctx.unique="unique",this.keys(St)},Yi.prototype.firstKey=function(St){return this.limit(1).keys(function(Dt){return Dt[0]}).then(St)},Yi.prototype.lastKey=function(St){return this.reverse().firstKey(St)},Yi.prototype.distinct=function(){var St,Dt=this._ctx,Dt=Dt.index&&Dt.table.schema.idxByName[Dt.index];return Dt&&Dt.multi&&(St={},su(this._ctx,function(sr){var sr=sr.primaryKey.toString(),gr=ut(St,sr);return St[sr]=!0,!gr})),this},Yi.prototype.modify=function(St){var Dt=this,Jt=this._ctx;return this._write(function(sr){function gr(Lr,An){var Fn=An.failures;Gr+=Lr-An.numFailures;for(var Yr=0,Zn=st(Fn);Yr<Zn.length;Yr++){var Qn=Zn[Yr];Ur.push(Fn[Qn])}}var xr=typeof St=="function"?St:function(Lr){return jo(Lr,St)},Ar=Jt.table.core,$r=Ar.schema.primaryKey,Mr=$r.outbound,jr=$r.extractKey,Zr=200,$r=Dt.db._options.modifyChunkSize,Ur=($r&&(Zr=typeof $r=="object"?$r[Ar.name]||$r["*"]||200:$r),[]),Gr=0,Nr=[],Fr=St===Pu;return Dt.clone().primaryKeys().then(function(Lr){function An(Yr){var Zn=Math.min(Zr,Lr.length-Yr),Qn=Lr.slice(Yr,Yr+Zn);return(Fr?Promise.resolve([]):Ar.getMany({trans:sr,keys:Qn,cache:"immutable"})).then(function(ci){var di=[],ni=[],gi=Mr?[]:null,hi=Fr?Qn:[];if(!Fr)for(var oi=0;oi<Zn;++oi){var wi=ci[oi],Wi={value:Qt(wi),primKey:Lr[Yr+oi]};xr.call(Wi,Wi.value,Wi)!==!1&&(Wi.value==null?hi.push(Lr[Yr+oi]):Mr||Fi(jr(wi),jr(Wi.value))===0?(ni.push(Wi.value),Mr&&gi.push(Lr[Yr+oi])):(hi.push(Lr[Yr+oi]),di.push(Wi.value)))}return Promise.resolve(0<di.length&&Ar.mutate({trans:sr,type:"add",values:di}).then(function(Ki){for(var Bi in Ki.failures)hi.splice(parseInt(Bi),1);gr(di.length,Ki)})).then(function(){return(0<ni.length||Fn&&typeof St=="object")&&Ar.mutate({trans:sr,type:"put",keys:gi,values:ni,criteria:Fn,changeSpec:typeof St!="function"&&St,isAdditionalChunk:0<Yr}).then(function(Ki){return gr(ni.length,Ki)})}).then(function(){return(0<hi.length||Fn&&Fr)&&Ar.mutate({trans:sr,type:"delete",keys:hi,criteria:Fn,isAdditionalChunk:0<Yr}).then(function(Ki){return Js(Jt.table,hi,Ki)}).then(function(Ki){return gr(hi.length,Ki)})}).then(function(){return Lr.length>Yr+Zn&&An(Yr+Zr)})})}var Fn=Xa(Jt)&&Jt.limit===1/0&&(typeof St!="function"||Fr)&&{index:Jt.index,range:Jt.range};return An(0).then(function(){if(0<Ur.length)throw new mr("Error modifying one or more objects",Ur,Gr,Nr);return Lr.length})})})},Yi.prototype.delete=function(){var St=this._ctx,Dt=St.range;return!Xa(St)||St.table.schema.yProps||!St.isPrimKey&&Dt.type!==3?this.modify(Pu):this._write(function(Jt){var sr=St.table.core.schema.primaryKey,gr=Dt;return St.table.core.count({trans:Jt,query:{index:sr,range:gr}}).then(function(xr){return St.table.core.mutate({trans:Jt,type:"deleteRange",range:gr}).then(function(jr){var Mr=jr.failures,jr=jr.numFailures;if(jr)throw new mr("Could not delete some values",Object.keys(Mr).map(function(Zr){return Mr[Zr]}),xr-jr);return xr-jr})})})};var Fc=Yi;function Yi(){}var Pu=function(St,Dt){return Dt.value=null};function Cu(St,Dt){return St<Dt?-1:St===Dt?0:1}function Bl(St,Dt){return Dt<St?-1:St===Dt?0:1}function Qa(St,Dt,Jt){return St=St instanceof Dl?new St.Collection(St):St,St._ctx.error=new(Jt||TypeError)(Dt),St}function Gi(St){return new St.Collection(St,function(){return eo("")}).limit(0)}function Cs(Nr,Dt,Jt,sr){var gr,xr,Ar,Mr,jr,Zr,$r,Ur=Jt.length;if(!Jt.every(function(Lr){return typeof Lr=="string"}))return Qa(Nr,Il);function Gr(Lr){gr=Lr==="next"?function(Fn){return Fn.toUpperCase()}:function(Fn){return Fn.toLowerCase()},xr=Lr==="next"?function(Fn){return Fn.toLowerCase()}:function(Fn){return Fn.toUpperCase()},Ar=Lr==="next"?Cu:Bl;var An=Jt.map(function(Fn){return{lower:xr(Fn),upper:gr(Fn)}}).sort(function(Fn,Yr){return Ar(Fn.lower,Yr.lower)});Mr=An.map(function(Fn){return Fn.upper}),jr=An.map(function(Fn){return Fn.lower}),$r=(Zr=Lr)==="next"?"":sr}Gr("next");var Nr=new Nr.Collection(Nr,function(){return Ka(Mr[0],jr[Ur-1]+sr)}),Fr=(Nr._ondirectionchange=function(Lr){Gr(Lr)},0);return Nr._addAlgorithm(function(Lr,An,Fn){var Yr=Lr.key;if(typeof Yr=="string"){var Zn=xr(Yr);if(Dt(Zn,jr,Fr))return!0;for(var Qn=null,ci=Fr;ci<Ur;++ci){var di=((ni,gi,hi,oi,wi,Wi)=>{for(var Ki=Math.min(ni.length,oi.length),Bi=-1,ji=0;ji<Ki;++ji){var ya=gi[ji];if(ya!==oi[ji])return wi(ni[ji],hi[ji])<0?ni.substr(0,ji)+hi[ji]+hi.substr(ji+1):wi(ni[ji],oi[ji])<0?ni.substr(0,ji)+oi[ji]+hi.substr(ji+1):0<=Bi?ni.substr(0,Bi)+gi[Bi]+hi.substr(Bi+1):null;wi(ni[ji],ya)<0&&(Bi=ji)}return Ki<oi.length&&Wi==="next"?ni+hi.substr(ni.length):Ki<ni.length&&Wi==="prev"?ni.substr(0,hi.length):Bi<0?null:ni.substr(0,Bi)+oi[Bi]+hi.substr(Bi+1)})(Yr,Zn,Mr[ci],jr[ci],Ar,Zr);di===null&&Qn===null?Fr=ci+1:(Qn===null||0<Ar(Qn,di))&&(Qn=di)}An(Qn!==null?function(){Lr.continue(Qn+$r)}:Fn)}return!1}),Nr}function Ka(St,Dt,Jt,sr){return{type:2,lower:St,upper:Dt,lowerOpen:Jt,upperOpen:sr}}function eo(St){return{type:1,lower:St,upper:St}}Object.defineProperty(Pa.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Pa.prototype.between=function(St,Dt,Jt,sr){Jt=Jt!==!1,sr=sr===!0;try{return 0<this._cmp(St,Dt)||this._cmp(St,Dt)===0&&(Jt||sr)&&(!Jt||!sr)?Gi(this):new this.Collection(this,function(){return Ka(St,Dt,!Jt,!sr)})}catch{return Qa(this,ta)}},Pa.prototype.equals=function(St){return St==null?Qa(this,ta):new this.Collection(this,function(){return eo(St)})},Pa.prototype.above=function(St){return St==null?Qa(this,ta):new this.Collection(this,function(){return Ka(St,void 0,!0)})},Pa.prototype.aboveOrEqual=function(St){return St==null?Qa(this,ta):new this.Collection(this,function(){return Ka(St,void 0,!1)})},Pa.prototype.below=function(St){return St==null?Qa(this,ta):new this.Collection(this,function(){return Ka(void 0,St,!1,!0)})},Pa.prototype.belowOrEqual=function(St){return St==null?Qa(this,ta):new this.Collection(this,function(){return Ka(void 0,St)})},Pa.prototype.startsWith=function(St){return typeof St!="string"?Qa(this,Il):this.between(St,St+Qs,!0,!0)},Pa.prototype.startsWithIgnoreCase=function(St){return St===""?this.startsWith(St):Cs(this,function(Dt,Jt){return Dt.indexOf(Jt[0])===0},[St],Qs)},Pa.prototype.equalsIgnoreCase=function(St){return Cs(this,function(Dt,Jt){return Dt===Jt[0]},[St],"")},Pa.prototype.anyOfIgnoreCase=function(){var St=Yt.apply(Wt,arguments);return St.length===0?Gi(this):Cs(this,function(Dt,Jt){return Jt.indexOf(Dt)!==-1},St,"")},Pa.prototype.startsWithAnyOfIgnoreCase=function(){var St=Yt.apply(Wt,arguments);return St.length===0?Gi(this):Cs(this,function(Dt,Jt){return Jt.some(function(sr){return Dt.indexOf(sr)===0})},St,Qs)},Pa.prototype.anyOf=function(){var St,Dt,Jt=this,sr=Yt.apply(Wt,arguments),gr=this._cmp;try{sr.sort(gr)}catch{return Qa(this,ta)}return sr.length===0?Gi(this):((St=new this.Collection(this,function(){return Ka(sr[0],sr[sr.length-1])}))._ondirectionchange=function(xr){gr=xr==="next"?Jt._ascending:Jt._descending,sr.sort(gr)},Dt=0,St._addAlgorithm(function(xr,Ar,Mr){for(var jr=xr.key;0<gr(jr,sr[Dt]);)if(++Dt===sr.length)return Ar(Mr),!1;return gr(jr,sr[Dt])===0||(Ar(function(){xr.continue(sr[Dt])}),!1)}),St)},Pa.prototype.notEqual=function(St){return this.inAnyRange([[-1/0,St],[St,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Pa.prototype.noneOf=function(){var St=Yt.apply(Wt,arguments);if(St.length===0)return new this.Collection(this);try{St.sort(this._ascending)}catch{return Qa(this,ta)}var Dt=St.reduce(function(Jt,sr){return Jt?Jt.concat([[Jt[Jt.length-1][1],sr]]):[[-1/0,sr]]},null);return Dt.push([St[St.length-1],this.db._maxKey]),this.inAnyRange(Dt,{includeLowers:!1,includeUppers:!1})},Pa.prototype.inAnyRange=function(St,Fn){var Jt=this,sr=this._cmp,gr=this._ascending,xr=this._descending,Ar=this._min,Mr=this._max;if(St.length===0)return Gi(this);if(!St.every(function(Yr){return Yr[0]!==void 0&&Yr[1]!==void 0&&gr(Yr[0],Yr[1])<=0}))return Qa(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",cr.InvalidArgument);var jr=!Fn||Fn.includeLowers!==!1,Zr=Fn&&Fn.includeUppers===!0,$r,Ur=gr;function Gr(Yr,Zn){return Ur(Yr[0],Zn[0])}try{($r=St.reduce(function(Yr,Zn){for(var Qn=0,ci=Yr.length;Qn<ci;++Qn){var di=Yr[Qn];if(sr(Zn[0],di[1])<0&&0<sr(Zn[1],di[0])){di[0]=Ar(di[0],Zn[0]),di[1]=Mr(di[1],Zn[1]);break}}return Qn===ci&&Yr.push(Zn),Yr},[])).sort(Gr)}catch{return Qa(this,ta)}var Nr=0,Fr=Zr?function(Yr){return 0<gr(Yr,$r[Nr][1])}:function(Yr){return 0<=gr(Yr,$r[Nr][1])},Lr=jr?function(Yr){return 0<xr(Yr,$r[Nr][0])}:function(Yr){return 0<=xr(Yr,$r[Nr][0])},An=Fr,Fn=new this.Collection(this,function(){return Ka($r[0][0],$r[$r.length-1][1],!jr,!Zr)});return Fn._ondirectionchange=function(Yr){Ur=Yr==="next"?(An=Fr,gr):(An=Lr,xr),$r.sort(Gr)},Fn._addAlgorithm(function(Yr,Zn,Qn){for(var ci,di=Yr.key;An(di);)if(++Nr===$r.length)return Zn(Qn),!1;return!Fr(ci=di)&&!Lr(ci)||(Jt._cmp(di,$r[Nr][1])===0||Jt._cmp(di,$r[Nr][0])===0||Zn(function(){Ur===gr?Yr.continue($r[Nr][0]):Yr.continue($r[Nr][1])}),!1)}),Fn},Pa.prototype.startsWithAnyOf=function(){var St=Yt.apply(Wt,arguments);return St.every(function(Dt){return typeof Dt=="string"})?St.length===0?Gi(this):this.inAnyRange(St.map(function(Dt){return[Dt,Dt+Qs]})):Qa(this,"startsWithAnyOf() only works with strings")};var Dl=Pa;function Pa(){}function Qi(St){return Ti(function(Dt){return ul(Dt),St(Dt.target.error),!1})}function ul(St){St.stopPropagation&&St.stopPropagation(),St.preventDefault&&St.preventDefault()}var Ll="storagemutated",Vo="x-storagemutated-1",Wo=Go(null,Ll),ou=(Ca.prototype._lock=function(){return Pt(!_r.global),++this._reculock,this._reculock!==1||_r.global||(_r.lockOwnerFor=this),this},Ca.prototype._unlock=function(){if(Pt(!_r.global),--this._reculock==0)for(_r.global||(_r.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var St=this._blockedFuncs.shift();try{is(St[1],St[0])}catch{}}return this},Ca.prototype._locked=function(){return this._reculock&&_r.lockOwnerFor!==this},Ca.prototype.create=function(St){var Dt=this;if(this.mode){var Jt=this.db.idbdb,sr=this.db._state.dbOpenError;if(Pt(!this.idbtrans),!St&&!Jt)switch(sr&&sr.name){case"DatabaseClosedError":throw new cr.DatabaseClosed(sr);case"MissingAPIError":throw new cr.MissingAPI(sr.message,sr);default:throw new cr.OpenFailed(sr)}if(!this.active)throw new cr.TransactionInactive;Pt(this._completion._state===null),(St=this.idbtrans=St||(this.db.core||Jt).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ti(function(gr){ul(gr),Dt._reject(St.error)}),St.onabort=Ti(function(gr){ul(gr),Dt.active&&Dt._reject(new cr.Abort(St.error)),Dt.active=!1,Dt.on("abort").fire(gr)}),St.oncomplete=Ti(function(){Dt.active=!1,Dt._resolve(),"mutatedParts"in St&&Wo.storagemutated.fire(St.mutatedParts)})}return this},Ca.prototype._promise=function(St,Dt,Jt){var sr,gr=this;return St==="readwrite"&&this.mode!=="readwrite"?wa(new cr.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Jr(function(xr,Ar){gr._blockedFuncs.push([function(){gr._promise(St,Dt,Jt).then(xr,Ar)},_r])}):Jt?ua(function(){var xr=new Jr(function(Ar,Mr){gr._lock();var jr=Dt(Ar,Mr,gr);jr&&jr.then&&jr.then(Ar,Mr)});return xr.finally(function(){return gr._unlock()}),xr._lib=!0,xr}):((sr=new Jr(function(xr,Ar){var Mr=Dt(xr,Ar,gr);Mr&&Mr.then&&Mr.then(xr,Ar)}))._lib=!0,sr):wa(new cr.TransactionInactive)},Ca.prototype._root=function(){return this.parent?this.parent._root():this},Ca.prototype.waitFor=function(St){var Dt,Jt=this._root(),sr=Jr.resolve(St),gr=(Jt._waitingFor?Jt._waitingFor=Jt._waitingFor.then(function(){return sr}):(Jt._waitingFor=sr,Jt._waitingQueue=[],Dt=Jt.idbtrans.objectStore(Jt.storeNames[0]),(function xr(){for(++Jt._spinCount;Jt._waitingQueue.length;)Jt._waitingQueue.shift()();Jt._waitingFor&&(Dt.get(-1/0).onsuccess=xr)})()),Jt._waitingFor);return new Jr(function(xr,Ar){sr.then(function(Mr){return Jt._waitingQueue.push(Ti(xr.bind(null,Mr)))},function(Mr){return Jt._waitingQueue.push(Ti(Ar.bind(null,Mr)))}).finally(function(){Jt._waitingFor===gr&&(Jt._waitingFor=null)})})},Ca.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new cr.Abort))},Ca.prototype.table=function(St){var Dt=this._memoizedTables||(this._memoizedTables={});if(ut(Dt,St))return Dt[St];var Jt=this.schema[St];if(Jt)return(Jt=new this.db.Table(St,Jt,this)).core=this.db.core.table(St),Dt[St]=Jt;throw new cr.NotFound("Table "+St+" not part of transaction")},Ca);function Ca(){}function ps(St,Dt,Jt,sr,gr,xr,Ar,Mr){return{name:St,keyPath:Dt,unique:Jt,multi:sr,auto:gr,compound:xr,src:(Jt&&!Ar?"&":"")+(sr?"*":"")+(gr?"++":"")+ro(Dt),type:Mr}}function ro(St){return typeof St=="string"?St:St?"["+[].join.call(St,"+")+"]":""}function no(St,Dt,Jt){return{name:St,primKey:Dt,indexes:Jt,mappedClass:null,idxByName:(sr=function(gr){return[gr.name,gr]},Jt.reduce(function(gr,xr,Ar){return xr=sr(xr,Ar),xr&&(gr[xr[0]]=xr[1]),gr},{}))};var sr}var zs=function(St){try{return St.only([[]]),zs=function(){return[[]]},[[]]}catch{return zs=function(){return Qs},Qs}};function Po(St){return St==null?function(){}:typeof St=="string"?(Dt=St).split(".").length===1?function(Jt){return Jt[Dt]}:function(Jt){return Ot(Jt,Dt)}:function(Jt){return Ot(Jt,St)};var Dt}function ms(St){return[].slice.call(St)}var Fl=0;function io(St){return St==null?":id":typeof St=="string"?St:"[".concat(St.join("+"),"]")}function Nl(St,Dt,jr){function sr(Fr){if(Fr.type===3)return null;if(Fr.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Ur=Fr.lower,Gr=Fr.upper,Nr=Fr.lowerOpen,Fr=Fr.upperOpen;return Ur===void 0?Gr===void 0?null:Dt.upperBound(Gr,!!Fr):Gr===void 0?Dt.lowerBound(Ur,!!Nr):Dt.bound(Ur,Gr,!!Nr,!!Fr)}function gr($r){var Ur,Gr=$r.name;return{name:Gr,schema:$r,mutate:function(Nr){var Fr=Nr.trans,Lr=Nr.type,An=Nr.keys,Fn=Nr.values,Yr=Nr.range;return new Promise(function(Zn,Qn){Zn=Ti(Zn);var ci=Fr.objectStore(Gr),di=ci.keyPath==null,ni=Lr==="put"||Lr==="add";if(!ni&&Lr!=="delete"&&Lr!=="deleteRange")throw new Error("Invalid operation type: "+Lr);var gi,hi=(An||Fn||{length:1}).length;if(An&&Fn&&An.length!==Fn.length)throw new Error("Given keys array must have same length as given values array.");if(hi===0)return Zn({numFailures:0,failures:{},results:[],lastResult:void 0});function oi(na){++Ki,ul(na)}var wi=[],Wi=[],Ki=0;if(Lr==="deleteRange"){if(Yr.type===4)return Zn({numFailures:Ki,failures:Wi,results:[],lastResult:void 0});Yr.type===3?wi.push(gi=ci.clear()):wi.push(gi=ci.delete(sr(Yr)))}else{var di=ni?di?[Fn,An]:[Fn,null]:[An,null],Bi=di[0],ji=di[1];if(ni)for(var ya=0;ya<hi;++ya)wi.push(gi=ji&&ji[ya]!==void 0?ci[Lr](Bi[ya],ji[ya]):ci[Lr](Bi[ya])),gi.onerror=oi;else for(ya=0;ya<hi;++ya)wi.push(gi=ci[Lr](Bi[ya])),gi.onerror=oi}function _s(na){na=na.target.result,wi.forEach(function(po,ql){return po.error!=null&&(Wi[ql]=po.error)}),Zn({numFailures:Ki,failures:Wi,results:Lr==="delete"?An:wi.map(function(po){return po.result}),lastResult:na})}gi.onerror=function(na){oi(na),_s(na)},gi.onsuccess=_s})},getMany:function(Nr){var Fr=Nr.trans,Lr=Nr.keys;return new Promise(function(An,Fn){An=Ti(An);for(var Yr,Zn=Fr.objectStore(Gr),Qn=Lr.length,ci=new Array(Qn),di=0,ni=0,gi=function(wi){wi=wi.target,ci[wi._pos]=wi.result,++ni===di&&An(ci)},hi=Qi(Fn),oi=0;oi<Qn;++oi)Lr[oi]!=null&&((Yr=Zn.get(Lr[oi]))._pos=oi,Yr.onsuccess=gi,Yr.onerror=hi,++di);di===0&&An(ci)})},get:function(Nr){var Fr=Nr.trans,Lr=Nr.key;return new Promise(function(An,Fn){An=Ti(An);var Yr=Fr.objectStore(Gr).get(Lr);Yr.onsuccess=function(Zn){return An(Zn.target.result)},Yr.onerror=Qi(Fn)})},query:(Ur=Mr,function(Nr){return new Promise(function(Fr,Lr){Fr=Ti(Fr);var An,Fn,Yr,ni=Nr.trans,Zn=Nr.values,Qn=Nr.limit,di=Nr.query,ci=Qn===1/0?void 0:Qn,gi=di.index,di=di.range,ni=ni.objectStore(Gr),ni=gi.isPrimaryKey?ni:ni.index(gi.name),gi=sr(di);if(Qn===0)return Fr({result:[]});Ur?((di=Zn?ni.getAll(gi,ci):ni.getAllKeys(gi,ci)).onsuccess=function(hi){return Fr({result:hi.target.result})},di.onerror=Qi(Lr)):(An=0,Fn=!Zn&&"openKeyCursor"in ni?ni.openKeyCursor(gi):ni.openCursor(gi),Yr=[],Fn.onsuccess=function(hi){var oi=Fn.result;return!oi||(Yr.push(Zn?oi.value:oi.primaryKey),++An===Qn)?Fr({result:Yr}):void oi.continue()},Fn.onerror=Qi(Lr))})}),openCursor:function(Nr){var Fr=Nr.trans,Lr=Nr.values,An=Nr.query,Fn=Nr.reverse,Yr=Nr.unique;return new Promise(function(Zn,Qn){Zn=Ti(Zn);var ni=An.index,ci=An.range,di=Fr.objectStore(Gr),di=ni.isPrimaryKey?di:di.index(ni.name),ni=Fn?Yr?"prevunique":"prev":Yr?"nextunique":"next",gi=!Lr&&"openKeyCursor"in di?di.openKeyCursor(sr(ci),ni):di.openCursor(sr(ci),ni);gi.onerror=Qi(Qn),gi.onsuccess=Ti(function(hi){var oi,wi,Wi,Ki,Bi=gi.result;Bi?(Bi.___id=++Fl,Bi.done=!1,oi=Bi.continue.bind(Bi),wi=(wi=Bi.continuePrimaryKey)&&wi.bind(Bi),Wi=Bi.advance.bind(Bi),Ki=function(){throw new Error("Cursor not stopped")},Bi.trans=Fr,Bi.stop=Bi.continue=Bi.continuePrimaryKey=Bi.advance=function(){throw new Error("Cursor not started")},Bi.fail=Ti(Qn),Bi.next=function(){var ji=this,ya=1;return this.start(function(){return ya--?ji.continue():ji.stop()}).then(function(){return ji})},Bi.start=function(ji){function ya(){if(gi.result)try{ji()}catch(na){Bi.fail(na)}else Bi.done=!0,Bi.start=function(){throw new Error("Cursor behind last entry")},Bi.stop()}var _s=new Promise(function(na,po){na=Ti(na),gi.onerror=Qi(po),Bi.fail=po,Bi.stop=function(ql){Bi.stop=Bi.continue=Bi.continuePrimaryKey=Bi.advance=Ki,na(ql)}});return gi.onsuccess=Ti(function(na){gi.onsuccess=ya,ya()}),Bi.continue=oi,Bi.continuePrimaryKey=wi,Bi.advance=Wi,ya(),_s},Zn(Bi)):Zn(null)},Qn)})},count:function(Nr){var Fr=Nr.query,Lr=Nr.trans,An=Fr.index,Fn=Fr.range;return new Promise(function(Yr,Zn){var Qn=Lr.objectStore(Gr),Qn=An.isPrimaryKey?Qn:Qn.index(An.name),ci=sr(Fn),ci=ci?Qn.count(ci):Qn.count();ci.onsuccess=Ti(function(di){return Yr(di.target.result)}),ci.onerror=Qi(Zn)})}}}xr=jr,Ar=ms((jr=St).objectStoreNames);var xr,jr={schema:{name:jr.name,tables:Ar.map(function($r){return xr.objectStore($r)}).map(function($r){var Ur=$r.keyPath,Gr=$r.autoIncrement,Fr=ot(Ur),Nr={},Fr={name:$r.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Ur==null,compound:Fr,keyPath:Ur,autoIncrement:Gr,unique:!0,extractKey:Po(Ur)},indexes:ms($r.indexNames).map(function(Lr){return $r.index(Lr)}).map(function(Yr){var Zn=Yr.name,An=Yr.unique,Fn=Yr.multiEntry,Yr=Yr.keyPath,Zn={name:Zn,compound:ot(Yr),keyPath:Yr,unique:An,multiEntry:Fn,extractKey:Po(Yr)};return Nr[io(Yr)]=Zn}),getIndexByKeyPath:function(Lr){return Nr[io(Lr)]}};return Nr[":id"]=Fr.primaryKey,Ur!=null&&(Nr[io(Ur)]=Fr.primaryKey),Fr})},hasGetAll:0<Ar.length&&"getAll"in xr.objectStore(Ar[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},Ar=jr.schema,Mr=jr.hasGetAll,jr=Ar.tables.map(gr),Zr={};return jr.forEach(function($r){return Zr[$r.name]=$r}),{stack:"dbcore",transaction:St.transaction.bind(St),table:function($r){if(Zr[$r])return Zr[$r];throw new Error("Table '".concat($r,"' not found"))},MIN_KEY:-1/0,MAX_KEY:zs(Dt),schema:Ar}}function cl(St,Dt,Jt,sr){return Jt=Jt.IDBKeyRange,Dt=Nl(Dt,Jt,sr),{dbcore:St.dbcore.reduce(function(gr,xr){return xr=xr.create,nt(nt({},gr),xr(gr))},Dt)}}function Ja(St,Dt){var Jt=Dt.db,Jt=cl(St._middlewares,Jt,St._deps,Dt);St.core=Jt.dbcore,St.tables.forEach(function(sr){var gr=sr.name;St.core.schema.tables.some(function(xr){return xr.name===gr})&&(sr.core=St.core.table(gr),St[gr]instanceof St.Table)&&(St[gr].core=sr.core)})}function as(St,Dt,Jt,sr){Jt.forEach(function(gr){var xr=sr[gr];Dt.forEach(function(Ar){var Mr=(function jr(Zr,$r){return xt(Zr,$r)||(Zr=ht(Zr))&&jr(Zr,$r)})(Ar,gr);(!Mr||"value"in Mr&&Mr.value===void 0)&&(Ar===St.Transaction.prototype||Ar instanceof St.Transaction?gt(Ar,gr,{get:function(){return this.table(gr)},set:function(jr){mt(this,gr,{value:jr,writable:!0,configurable:!0,enumerable:!0})}}):Ar[gr]=new St.Table(gr,xr))})})}function ss(St,Dt){Dt.forEach(function(Jt){for(var sr in Jt)Jt[sr]instanceof St.Table&&delete Jt[sr]})}function Ms(St,Dt){return St._cfg.version-Dt._cfg.version}function ks(St,Dt,Jt,sr){var gr=St._dbSchema,xr=(Jt.objectStoreNames.contains("$meta")&&!gr.$meta&&(gr.$meta=no("$meta",ao("")[0],[]),St._storeNames.push("$meta")),St._createTransaction("readwrite",St._storeNames,gr)),Ar=(xr.create(Jt),xr._completion.catch(sr),xr._reject.bind(xr)),Mr=_r.transless||_r;ua(function(){if(_r.trans=xr,_r.transless=Mr,Dt!==0)return Ja(St,Jt),Zr=Dt,((jr=xr).storeNames.includes("$meta")?jr.table("$meta").get("version").then(function($r){return $r??Zr}):Jr.resolve(Zr)).then(function(An){var Ur=St,Gr=An,Nr=xr,Fr=Jt,Lr=[],An=Ur._versions,Fn=Ur._dbSchema=Ba(0,Ur.idbdb,Fr);return(An=An.filter(function(Yr){return Yr._cfg.version>=Gr})).length===0?Jr.resolve():(An.forEach(function(Yr){Lr.push(function(){var Zn,Qn,ci,di=Fn,ni=Yr._cfg.dbschema,gi=(ia(Ur,di,Fr),ia(Ur,ni,Fr),Fn=Ur._dbSchema=ni,hl(di,ni)),hi=(gi.add.forEach(function(oi){Zo(Fr,oi[0],oi[1].primKey,oi[1].indexes)}),gi.change.forEach(function(oi){if(oi.recreate)throw new cr.Upgrade("Not yet support for changing primary key");var wi=Fr.objectStore(oi.name);oi.add.forEach(function(Wi){return ha(wi,Wi)}),oi.change.forEach(function(Wi){wi.deleteIndex(Wi.name),ha(wi,Wi)}),oi.del.forEach(function(Wi){return wi.deleteIndex(Wi)})}),Yr._cfg.contentUpgrade);if(hi&&Yr._cfg.version>Gr)return Ja(Ur,Fr),Nr._memoizedTables={},Zn=Lt(ni),gi.del.forEach(function(oi){Zn[oi]=di[oi]}),ss(Ur,[Ur.Transaction.prototype]),as(Ur,[Ur.Transaction.prototype],st(Zn),Zn),Nr.schema=Zn,(Qn=zt(hi))&&ka(),ni=Jr.follow(function(){var oi;(ci=hi(Nr))&&Qn&&(oi=Xi.bind(null,null),ci.then(oi,oi))}),ci&&typeof ci.then=="function"?Jr.resolve(ci):ni.then(function(){return ci})}),Lr.push(function(Zn){var Qn,ci,di=Yr._cfg.dbschema;Qn=di,ci=Zn,[].slice.call(ci.db.objectStoreNames).forEach(function(ni){return Qn[ni]==null&&ci.db.deleteObjectStore(ni)}),ss(Ur,[Ur.Transaction.prototype]),as(Ur,[Ur.Transaction.prototype],Ur._storeNames,Ur._dbSchema),Nr.schema=Ur._dbSchema}),Lr.push(function(Zn){Ur.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Ur.idbdb.version/10)===Yr._cfg.version?(Ur.idbdb.deleteObjectStore("$meta"),delete Ur._dbSchema.$meta,Ur._storeNames=Ur._storeNames.filter(function(Qn){return Qn!=="$meta"})):Zn.objectStore("$meta").put(Yr._cfg.version,"version"))})}),(function Yr(){return Lr.length?Jr.resolve(Lr.shift()(Nr.idbtrans)).then(Yr):Jr.resolve()})().then(function(){lu(Fn,Fr)}))}).catch(Ar);var jr,Zr;st(gr).forEach(function($r){Zo(Jt,$r,gr[$r].primKey,gr[$r].indexes)}),Ja(St,Jt),Jr.follow(function(){return St.on.populate.fire(xr)}).catch(Ar)})}function qo(St,Dt){lu(St._dbSchema,Dt),Dt.db.version%10!=0||Dt.objectStoreNames.contains("$meta")||Dt.db.createObjectStore("$meta").add(Math.ceil(Dt.db.version/10-1),"version");var Jt=Ba(0,St.idbdb,Dt);ia(St,St._dbSchema,Dt);for(var sr=0,gr=hl(Jt,St._dbSchema).change;sr<gr.length;sr++){var xr=(Ar=>{if(Ar.change.length||Ar.recreate)return console.warn("Unable to patch indexes of table ".concat(Ar.name," because it has changes on the type of index or primary key.")),{value:void 0};var Mr=Dt.objectStore(Ar.name);Ar.add.forEach(function(jr){hr&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Ar.name,".").concat(jr.src)),ha(Mr,jr)})})(gr[sr]);if(typeof xr=="object")return xr.value}}function hl(St,Dt){var Jt,sr={del:[],add:[],change:[]};for(Jt in St)Dt[Jt]||sr.del.push(Jt);for(Jt in Dt){var gr=St[Jt],xr=Dt[Jt];if(gr){var Ar={name:Jt,def:xr,recreate:!1,del:[],add:[],change:[]};if(""+(gr.primKey.keyPath||"")!=""+(xr.primKey.keyPath||"")||gr.primKey.auto!==xr.primKey.auto)Ar.recreate=!0,sr.change.push(Ar);else{var Mr=gr.idxByName,jr=xr.idxByName,Zr=void 0;for(Zr in Mr)jr[Zr]||Ar.del.push(Zr);for(Zr in jr){var $r=Mr[Zr],Ur=jr[Zr];$r?$r.src!==Ur.src&&Ar.change.push(Ur):Ar.add.push(Ur)}(0<Ar.del.length||0<Ar.add.length||0<Ar.change.length)&&sr.change.push(Ar)}}else sr.add.push([Jt,xr])}return sr}function Zo(St,Dt,Jt,sr){var gr=St.db.createObjectStore(Dt,Jt.keyPath?{keyPath:Jt.keyPath,autoIncrement:Jt.auto}:{autoIncrement:Jt.auto});sr.forEach(function(xr){return ha(gr,xr)})}function lu(St,Dt){st(St).forEach(function(Jt){Dt.db.objectStoreNames.contains(Jt)||(hr&&console.debug("Dexie: Creating missing table",Jt),Zo(Dt,Jt,St[Jt].primKey,St[Jt].indexes))})}function ha(St,Dt){St.createIndex(Dt.name,Dt.keyPath,{unique:Dt.unique,multiEntry:Dt.multi})}function Ba(St,Dt,Jt){var sr={};return At(Dt.objectStoreNames,0).forEach(function(gr){for(var xr=Jt.objectStore(gr),Ar=ps(ro(Zr=xr.keyPath),Zr||"",!0,!1,!!xr.autoIncrement,Zr&&typeof Zr!="string",!0),Mr=[],jr=0;jr<xr.indexNames.length;++jr){var $r=xr.index(xr.indexNames[jr]),Zr=$r.keyPath,$r=ps($r.name,Zr,!!$r.unique,!!$r.multiEntry,!1,Zr&&typeof Zr!="string",!1);Mr.push($r)}sr[gr]=no(gr,Ar,Mr)}),sr}function ia(St,Dt,Jt){for(var sr=Jt.db.objectStoreNames,gr=0;gr<sr.length;++gr){var xr=sr[gr],Ar=Jt.objectStore(xr);St._hasGetAll="getAll"in Ar;for(var Mr=0;Mr<Ar.indexNames.length;++Mr){var jr,Zr=Ar.indexNames[Mr],$r=Ar.index(Zr).keyPath,$r=typeof $r=="string"?$r:"["+At($r).join("+")+"]";Dt[xr]&&(jr=Dt[xr].idxByName[$r])&&(jr.name=Zr,delete Dt[xr].idxByName[$r],Dt[xr].idxByName[Zr]=jr)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&at.WorkerGlobalScope&&at instanceof at.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(St._hasGetAll=!1)}function ao(St){return St.split(",").map(function(Dt,Jt){var gr=Dt.split(":"),sr=(sr=gr[1])==null?void 0:sr.trim(),gr=(Dt=gr[0].trim()).replace(/([&*]|\+\+)/g,""),xr=/^\[/.test(gr)?gr.match(/^\[(.*)\]$/)[1].split("+"):gr;return ps(gr,xr||null,/\&/.test(Dt),/\*/.test(Dt),/\+\+/.test(Dt),ot(xr),Jt===0,sr)})}Co.prototype._createTableSchema=no,Co.prototype._parseIndexSyntax=ao,Co.prototype._parseStoresSpec=function(St,Dt){var Jt=this;st(St).forEach(function(sr){if(St[sr]!==null){var gr=Jt._parseIndexSyntax(St[sr]),xr=gr.shift();if(!xr)throw new cr.Schema("Invalid schema for table "+sr+": "+St[sr]);if(xr.unique=!0,xr.multi)throw new cr.Schema("Primary key cannot be multiEntry*");gr.forEach(function(Ar){if(Ar.auto)throw new cr.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ar.keyPath)throw new cr.Schema("Index must have a name and cannot be an empty string")}),xr=Jt._createTableSchema(sr,xr,gr),Dt[sr]=xr}})},Co.prototype.stores=function(Jt){var Dt=this.db,Jt=(this._cfg.storesSource=this._cfg.storesSource?lt(this._cfg.storesSource,Jt):Jt,Dt._versions),sr={},gr={};return Jt.forEach(function(xr){lt(sr,xr._cfg.storesSource),gr=xr._cfg.dbschema={},xr._parseStoresSpec(sr,gr)}),Dt._dbSchema=gr,ss(Dt,[Dt._allTables,Dt,Dt.Transaction.prototype]),as(Dt,[Dt._allTables,Dt,Dt.Transaction.prototype,this._cfg.tables],st(gr),gr),Dt._storeNames=st(gr),this},Co.prototype.upgrade=function(St){return this._cfg.contentUpgrade=or(this._cfg.contentUpgrade||pr,St),this};var js=Co;function Co(){}function Ul(St,Dt){var Jt=St._dbNamesDB;return Jt||(Jt=St._dbNamesDB=new ho(ol,{addons:[],indexedDB:St,IDBKeyRange:Dt})).version(1).stores({dbnames:"name"}),Jt.table("dbnames")}function Mo(St){return St&&typeof St.databases=="function"}function Yo(St){return ua(function(){return _r.letThrough=!0,St()})}function uu(St){return!("from"in St)}var $a=function(St,Dt){var Jt;if(!this)return Jt=new $a,St&&"d"in St&&lt(Jt,St),Jt;lt(this,arguments.length?{d:1,from:St,to:1<arguments.length?Dt:St}:{d:0})};function $l(St,Dt,Jt){var sr=Fi(Dt,Jt);if(!isNaN(sr)){if(0<sr)throw RangeError();if(uu(St))return lt(St,{from:Dt,to:Jt,d:1});var sr=St.l,gr=St.r;if(Fi(Jt,St.from)<0)return sr?$l(sr,Dt,Jt):St.l={from:Dt,to:Jt,d:1,l:null,r:null},cu(St);if(0<Fi(Dt,St.to))return gr?$l(gr,Dt,Jt):St.r={from:Dt,to:Jt,d:1,l:null,r:null},cu(St);Fi(Dt,St.from)<0&&(St.from=Dt,St.l=null,St.d=gr?gr.d+1:1),0<Fi(Jt,St.to)&&(St.to=Jt,St.r=null,St.d=St.l?St.l.d+1:1),Dt=!St.r,sr&&!St.l&&so(St,sr),gr&&Dt&&so(St,gr)}}function so(St,Dt){uu(Dt)||(function Jt(sr,gr){var xr=gr.from,Ar=gr.l,Mr=gr.r;$l(sr,xr,gr.to),Ar&&Jt(sr,Ar),Mr&&Jt(sr,Mr)})(St,Dt)}function zl(St,Dt){var Jt=Mu(Dt),sr=Jt.next();if(!sr.done)for(var gr=sr.value,xr=Mu(St),Ar=xr.next(gr.from),Mr=Ar.value;!sr.done&&!Ar.done;){if(Fi(Mr.from,gr.to)<=0&&0<=Fi(Mr.to,gr.from))return!0;Fi(gr.from,Mr.from)<0?gr=(sr=Jt.next(Mr.from)).value:Mr=(Ar=xr.next(gr.from)).value}return!1}function Mu(St){var Dt=uu(St)?null:{s:0,n:St};return{next:function(Jt){for(var sr=0<arguments.length;Dt;)switch(Dt.s){case 0:if(Dt.s=1,sr)for(;Dt.n.l&&Fi(Jt,Dt.n.from)<0;)Dt={up:Dt,n:Dt.n.l,s:1};else for(;Dt.n.l;)Dt={up:Dt,n:Dt.n.l,s:1};case 1:if(Dt.s=2,!sr||Fi(Jt,Dt.n.to)<=0)return{value:Dt.n,done:!1};case 2:if(Dt.n.r){Dt.s=3,Dt={up:Dt,n:Dt.n.r,s:0};continue}case 3:Dt=Dt.up}return{done:!0}}}}function cu(St){var Dt,Jt,sr,gr=(((gr=St.r)==null?void 0:gr.d)||0)-(((gr=St.l)==null?void 0:gr.d)||0),gr=1<gr?"r":gr<-1?"l":"";gr&&(Dt=gr=="r"?"l":"r",Jt=nt({},St),sr=St[gr],St.from=sr.from,St.to=sr.to,St[gr]=sr[gr],Jt[gr]=sr[Dt],(St[Dt]=Jt).d=Nc(Jt)),St.d=Nc(St)}function Nc(Jt){var Dt=Jt.r,Jt=Jt.l;return(Dt?Jt?Math.max(Dt.d,Jt.d):Dt.d:Jt?Jt.d:0)+1}function gs(St,Dt){return st(Dt).forEach(function(Jt){St[Jt]?so(St[Jt],Dt[Jt]):St[Jt]=(function sr(gr){var xr,Ar,Mr={};for(xr in gr)ut(gr,xr)&&(Ar=gr[xr],Mr[xr]=!Ar||typeof Ar!="object"||Mt.has(Ar.constructor)?Ar:sr(Ar));return Mr})(Dt[Jt])}),St}function jl(St,Dt){return St.all||Dt.all||Object.keys(St).some(function(Jt){return Dt[Jt]&&zl(Dt[Jt],St[Jt])})}ft($a.prototype,((Mn={add:function(St){return so(this,St),this},addKey:function(St){return $l(this,St,St),this},addKeys:function(St){var Dt=this;return St.forEach(function(Jt){return $l(Dt,Jt,Jt)}),this},hasKey:function(St){var Dt=Mu(this).next(St).value;return Dt&&Fi(Dt.from,St)<=0&&0<=Fi(Dt.to,St)}})[Bt]=function(){return Mu(this)},Mn));var Gs={},Xo={},hu=!1;function Gl(St){gs(Xo,St),hu||(hu=!0,setTimeout(function(){hu=!1,ku(Xo,!(Xo={}))},0))}function ku(St,Dt){Dt===void 0&&(Dt=!1);var Jt=new Set;if(St.all)for(var sr=0,gr=Object.values(Gs);sr<gr.length;sr++)Hl(Mr=gr[sr],St,Jt,Dt);else for(var xr in St){var Ar,Mr,xr=/^idb\:\/\/(.*)\/(.*)\//.exec(xr);xr&&(Ar=xr[1],xr=xr[2],Mr=Gs["idb://".concat(Ar,"/").concat(xr)])&&Hl(Mr,St,Jt,Dt)}Jt.forEach(function(jr){return jr()})}function Hl(St,Dt,Jt,sr){for(var gr=[],xr=0,Ar=Object.entries(St.queries.query);xr<Ar.length;xr++){for(var Mr=Ar[xr],jr=Mr[0],Zr=[],$r=0,Ur=Mr[1];$r<Ur.length;$r++){var Gr=Ur[$r];jl(Dt,Gr.obsSet)?Gr.subscribers.forEach(function(An){return Jt.add(An)}):sr&&Zr.push(Gr)}sr&&gr.push([jr,Zr])}if(sr)for(var Nr=0,Fr=gr;Nr<Fr.length;Nr++){var Lr=Fr[Nr],jr=Lr[0],Zr=Lr[1];St.queries.query[jr]=Zr}}function oc(St){var Dt=St._state,Jt=St._deps.indexedDB;if(Dt.isBeingOpened||St.idbdb)return Dt.dbReadyPromise.then(function(){return Dt.dbOpenError?wa(Dt.dbOpenError):St});Dt.isBeingOpened=!0,Dt.dbOpenError=null,Dt.openComplete=!1;var sr=Dt.openCanceller,gr=Math.round(10*St.verno),xr=!1;function Ar(){if(Dt.openCanceller!==sr)throw new cr.DatabaseClosed("db.open() was cancelled")}function Mr(){return new Jr(function(Gr,Nr){if(Ar(),!Jt)throw new cr.MissingAPI;var Fr=St.name,Lr=Dt.autoSchema||!gr?Jt.open(Fr):Jt.open(Fr,gr);if(!Lr)throw new cr.MissingAPI;Lr.onerror=Qi(Nr),Lr.onblocked=Ti(St._fireOnBlocked),Lr.onupgradeneeded=Ti(function(An){var Fn;$r=Lr.transaction,Dt.autoSchema&&!St._options.allowEmptyDB?(Lr.onerror=ul,$r.abort(),Lr.result.close(),(Fn=Jt.deleteDatabase(Fr)).onsuccess=Fn.onerror=Ti(function(){Nr(new cr.NoSuchDatabase("Database ".concat(Fr," doesnt exist")))})):($r.onerror=Qi(Nr),Fn=An.oldVersion>Math.pow(2,62)?0:An.oldVersion,Ur=Fn<1,St.idbdb=Lr.result,xr&&qo(St,$r),ks(St,Fn/10,$r,Nr))},Nr),Lr.onsuccess=Ti(function(){$r=null;var An,Fn,Yr,Zn,Qn,ci,di=St.idbdb=Lr.result,ni=At(di.objectStoreNames);if(0<ni.length)try{var gi=di.transaction((Qn=ni).length===1?Qn[0]:Qn,"readonly");if(Dt.autoSchema)ci=di,Zn=gi,(Yr=St).verno=ci.version/10,Zn=Yr._dbSchema=Ba(0,ci,Zn),Yr._storeNames=At(ci.objectStoreNames,0),as(Yr,[Yr._allTables],st(Zn),Zn);else if(ia(St,St._dbSchema,gi),Fn=gi,((Fn=hl(Ba(0,(An=St).idbdb,Fn),An._dbSchema)).add.length||Fn.change.some(function(hi){return hi.add.length||hi.change.length}))&&!xr)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),di.close(),gr=di.version+1,xr=!0,Gr(Mr());Ja(St,gi)}catch{}Ks.push(St),di.onversionchange=Ti(function(hi){Dt.vcFired=!0,St.on("versionchange").fire(hi)}),di.onclose=Ti(function(){St.close({disableAutoOpen:!1})}),Ur&&(ni=St._deps,Qn=Fr,Mo(ci=ni.indexedDB)||Qn===ol||Ul(ci,ni.IDBKeyRange).put({name:Qn}).catch(pr)),Gr()},Nr)}).catch(function(Gr){switch(Gr?.name){case"UnknownError":if(0<Dt.PR1398_maxLoop)return Dt.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Mr();break;case"VersionError":if(0<gr)return gr=0,Mr()}return Jr.reject(Gr)})}var jr,Zr=Dt.dbReadyResolve,$r=null,Ur=!1;return Jr.race([sr,(typeof navigator>"u"?Jr.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Gr){function Nr(){return indexedDB.databases().finally(Gr)}jr=setInterval(Nr,100),Nr()}).finally(function(){return clearInterval(jr)}):Promise.resolve()).then(Mr)]).then(function(){return Ar(),Dt.onReadyBeingFired=[],Jr.resolve(Yo(function(){return St.on.ready.fire(St.vip)})).then(function Gr(){var Nr;if(0<Dt.onReadyBeingFired.length)return Nr=Dt.onReadyBeingFired.reduce(or,pr),Dt.onReadyBeingFired=[],Jr.resolve(Yo(function(){return Nr(St.vip)})).then(Gr)})}).finally(function(){Dt.openCanceller===sr&&(Dt.onReadyBeingFired=null,Dt.isBeingOpened=!1)}).catch(function(Gr){Dt.dbOpenError=Gr;try{$r&&$r.abort()}catch{}return sr===Dt.openCanceller&&St._close(),wa(Gr)}).finally(function(){Dt.openComplete=!0,Zr()}).then(function(){var Gr;return Ur&&(Gr={},St.tables.forEach(function(Nr){Nr.schema.indexes.forEach(function(Fr){Fr.name&&(Gr["idb://".concat(St.name,"/").concat(Nr.name,"/").concat(Fr.name)]=new $a(-1/0,[[[]]]))}),Gr["idb://".concat(St.name,"/").concat(Nr.name,"/")]=Gr["idb://".concat(St.name,"/").concat(Nr.name,"/:dels")]=new $a(-1/0,[[[]]])}),Wo(Ll).fire(Gr),ku(Gr,!0)),St})}function Qo(St){function Dt(xr){return St.next(xr)}var Jt=gr(Dt),sr=gr(function(xr){return St.throw(xr)});function gr(xr){return function(Mr){var Mr=xr(Mr),jr=Mr.value;return Mr.done?jr:jr&&typeof jr.then=="function"?jr.then(Jt,sr):ot(jr)?Promise.all(jr).then(Jt,sr):Jt(jr)}}return gr(Dt)()}function us(St,Dt,Jt){for(var sr=ot(St)?St.slice():[St],gr=0;gr<Jt;++gr)sr.push(Dt);return sr}var Ko={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(St){return nt(nt({},St),{table:function(sr){var Jt=St.table(sr),sr=Jt.schema,gr={},xr=[];function Ar(Gr,Nr,Fr){var Yr=io(Gr),Lr=gr[Yr]=gr[Yr]||[],An=Gr==null?0:typeof Gr=="string"?1:Gr.length,Fn=0<Nr,Yr=nt(nt({},Fr),{name:Fn?"".concat(Yr,"(virtual-from:").concat(Fr.name,")"):Fr.name,lowLevelIndex:Fr,isVirtual:Fn,keyTail:Nr,keyLength:An,extractKey:Po(Gr),unique:!Fn&&Fr.unique});return Lr.push(Yr),Yr.isPrimaryKey||xr.push(Yr),1<An&&Ar(An===2?Gr[0]:Gr.slice(0,An-1),Nr+1,Fr),Lr.sort(function(Zn,Qn){return Zn.keyTail-Qn.keyTail}),Yr}var Mr=Ar(sr.primaryKey.keyPath,0,sr.primaryKey);gr[":id"]=[Mr];for(var jr=0,Zr=sr.indexes;jr<Zr.length;jr++){var $r=Zr[jr];Ar($r.keyPath,0,$r)}function Ur(Gr){var Nr,Fr=Gr.query.index;return Fr.isVirtual?nt(nt({},Gr),{query:{index:Fr.lowLevelIndex,range:(Nr=Gr.query.range,Fr=Fr.keyTail,{type:Nr.type===1?2:Nr.type,lower:us(Nr.lower,Nr.lowerOpen?St.MAX_KEY:St.MIN_KEY,Fr),lowerOpen:!0,upper:us(Nr.upper,Nr.upperOpen?St.MIN_KEY:St.MAX_KEY,Fr),upperOpen:!0})}}):Gr}return nt(nt({},Jt),{schema:nt(nt({},sr),{primaryKey:Mr,indexes:xr,getIndexByKeyPath:function(Gr){return(Gr=gr[io(Gr)])&&Gr[0]}}),count:function(Gr){return Jt.count(Ur(Gr))},query:function(Gr){return Jt.query(Ur(Gr))},openCursor:function(Gr){var Nr=Gr.query.index,Fr=Nr.keyTail,Lr=Nr.keyLength;return Nr.isVirtual?Jt.openCursor(Ur(Gr)).then(function(Fn){return Fn&&An(Fn)}):Jt.openCursor(Gr);function An(Fn){return Object.create(Fn,{continue:{value:function(Yr){Yr!=null?Fn.continue(us(Yr,Gr.reverse?St.MAX_KEY:St.MIN_KEY,Fr)):Gr.unique?Fn.continue(Fn.key.slice(0,Lr).concat(Gr.reverse?St.MIN_KEY:St.MAX_KEY,Fr)):Fn.continue()}},continuePrimaryKey:{value:function(Yr,Zn){Fn.continuePrimaryKey(us(Yr,St.MAX_KEY,Fr),Zn)}},primaryKey:{get:function(){return Fn.primaryKey}},key:{get:function(){var Yr=Fn.key;return Lr===1?Yr[0]:Yr.slice(0,Lr)}},value:{get:function(){return Fn.value}}})}}})}})}};function du(St,Dt,Jt,sr){return Jt=Jt||{},sr=sr||"",st(St).forEach(function(gr){var xr,Ar,Mr;ut(Dt,gr)?(xr=St[gr],Ar=Dt[gr],typeof xr=="object"&&typeof Ar=="object"&&xr&&Ar?(Mr=qt(xr))!==qt(Ar)?Jt[sr+gr]=Dt[gr]:Mr==="Object"?du(xr,Ar,Jt,sr+gr+"."):xr!==Ar&&(Jt[sr+gr]=Dt[gr]):xr!==Ar&&(Jt[sr+gr]=Dt[gr])):Jt[sr+gr]=void 0}),st(Dt).forEach(function(gr){ut(St,gr)||(Jt[sr+gr]=Dt[gr])}),Jt}function Ou(St,Dt){return Dt.type==="delete"?Dt.keys:Dt.keys||Dt.values.map(St.extractKey)}var oo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(St){return nt(nt({},St),{table:function(Dt){var Jt=St.table(Dt),sr=Jt.schema.primaryKey;return nt(nt({},Jt),{mutate:function(gr){var xr=_r.trans,Ar=xr.table(Dt).hook,Mr=Ar.deleting,jr=Ar.creating,Zr=Ar.updating;switch(gr.type){case"add":if(jr.fire===pr)break;return xr._promise("readwrite",function(){return $r(gr)},!0);case"put":if(jr.fire===pr&&Zr.fire===pr)break;return xr._promise("readwrite",function(){return $r(gr)},!0);case"delete":if(Mr.fire===pr)break;return xr._promise("readwrite",function(){return $r(gr)},!0);case"deleteRange":if(Mr.fire===pr)break;return xr._promise("readwrite",function(){return(function Ur(Gr,Nr,Fr){return Jt.query({trans:Gr,values:!1,query:{index:sr,range:Nr},limit:Fr}).then(function(Lr){var An=Lr.result;return $r({type:"delete",keys:An,trans:Gr}).then(function(Fn){return 0<Fn.numFailures?Promise.reject(Fn.failures[0]):An.length<Fr?{failures:[],numFailures:0,lastResult:void 0}:Ur(Gr,nt(nt({},Nr),{lower:An[An.length-1],lowerOpen:!0}),Fr)})})})(gr.trans,gr.range,1e4)},!0)}return Jt.mutate(gr);function $r(Ur){var Gr,Nr,Fr,Lr=_r.trans,An=Ur.keys||Ou(sr,Ur);if(An)return(Ur=Ur.type==="add"||Ur.type==="put"?nt(nt({},Ur),{keys:An}):nt({},Ur)).type!=="delete"&&(Ur.values=it([],Ur.values)),Ur.keys&&(Ur.keys=it([],Ur.keys)),Gr=Jt,Fr=An,((Nr=Ur).type==="add"?Promise.resolve([]):Gr.getMany({trans:Nr.trans,keys:Fr,cache:"immutable"})).then(function(Fn){var Yr=An.map(function(Zn,Qn){var ci,di,ni,gi=Fn[Qn],hi={onerror:null,onsuccess:null};return Ur.type==="delete"?Mr.fire.call(hi,Zn,gi,Lr):Ur.type==="add"||gi===void 0?(ci=jr.fire.call(hi,Zn,Ur.values[Qn],Lr),Zn==null&&ci!=null&&(Ur.keys[Qn]=Zn=ci,sr.outbound||Et(Ur.values[Qn],sr.keyPath,Zn))):(ci=du(gi,Ur.values[Qn]),(di=Zr.fire.call(hi,ci,Zn,gi,Lr))&&(ni=Ur.values[Qn],Object.keys(di).forEach(function(oi){ut(ni,oi)?ni[oi]=di[oi]:Et(ni,oi,di[oi])}))),hi});return Jt.mutate(Ur).then(function(Zn){for(var Qn=Zn.failures,ci=Zn.results,di=Zn.numFailures,Zn=Zn.lastResult,ni=0;ni<An.length;++ni){var gi=(ci||An)[ni],hi=Yr[ni];gi==null?hi.onerror&&hi.onerror(Qn[ni]):hi.onsuccess&&hi.onsuccess(Ur.type==="put"&&Fn[ni]?Ur.values[ni]:gi)}return{failures:Qn,results:ci,numFailures:di,lastResult:Zn}}).catch(function(Zn){return Yr.forEach(function(Qn){return Qn.onerror&&Qn.onerror(Zn)}),Promise.reject(Zn)})});throw new Error("Keys missing")}}})}})}};function ko(St,Dt,Jt){try{if(!Dt||Dt.keys.length<St.length)return null;for(var sr=[],gr=0,xr=0;gr<Dt.keys.length&&xr<St.length;++gr)Fi(Dt.keys[gr],St[xr])===0&&(sr.push(Jt?Qt(Dt.values[gr]):Dt.values[gr]),++xr);return sr.length===St.length?sr:null}catch{return null}}var lc={stack:"dbcore",level:-1,create:function(St){return{table:function(Dt){var Jt=St.table(Dt);return nt(nt({},Jt),{getMany:function(sr){var gr;return sr.cache?(gr=ko(sr.keys,sr.trans._cache,sr.cache==="clone"))?Jr.resolve(gr):Jt.getMany(sr).then(function(xr){return sr.trans._cache={keys:sr.keys,values:sr.cache==="clone"?Qt(xr):xr},xr}):Jt.getMany(sr)},mutate:function(sr){return sr.type!=="add"&&(sr.trans._cache=null),Jt.mutate(sr)}})}}}};function uc(St,Dt){return St.trans.mode==="readonly"&&!!St.subscr&&!St.trans.explicit&&St.trans.db._options.cache!=="disabled"&&!Dt.schema.primaryKey.outbound}function lo(St,Dt){switch(St){case"query":return Dt.values&&!Dt.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var uo={stack:"dbcore",level:0,name:"Observability",create:function(St){var Dt=St.schema.name,Jt=new $a(St.MIN_KEY,St.MAX_KEY);return nt(nt({},St),{transaction:function(sr,gr,xr){if(_r.subscr&&gr!=="readonly")throw new cr.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(_r.querier));return St.transaction(sr,gr,xr)},table:function(sr){function gr(An){var Lr,An=An.query;return[Lr=An.index,new $a((Lr=(An=An.range).lower)!=null?Lr:St.MIN_KEY,(Lr=An.upper)!=null?Lr:St.MAX_KEY)]}var xr=St.table(sr),Ar=xr.schema,Mr=Ar.primaryKey,jr=Ar.indexes,Zr=Mr.extractKey,$r=Mr.outbound,Ur=Mr.autoIncrement&&jr.filter(function(Fr){return Fr.compound&&Fr.keyPath.includes(Mr.keyPath)}),Gr=nt(nt({},xr),{mutate:function(Fr){function Lr(wi){return wi="idb://".concat(Dt,"/").concat(sr,"/").concat(wi),Qn[wi]||(Qn[wi]=new $a)}var An,Fn,Yr,Zn=Fr.trans,Qn=Fr.mutatedParts||(Fr.mutatedParts={}),ci=Lr(""),di=Lr(":dels"),ni=Fr.type,hi=Fr.type==="deleteRange"?[Fr.range]:Fr.type==="delete"?[Fr.keys]:Fr.values.length<50?[Ou(Mr,Fr).filter(function(wi){return wi}),Fr.values]:[],gi=hi[0],hi=hi[1],oi=Fr.trans._cache;return ot(gi)?(ci.addKeys(gi),(ni=ni==="delete"||gi.length===hi.length?ko(gi,oi):null)||di.addKeys(gi),(ni||hi)&&(An=Lr,Fn=ni,Yr=hi,Ar.indexes.forEach(function(wi){var Wi=An(wi.name||"");function Ki(ji){return ji!=null?wi.extractKey(ji):null}function Bi(ji){wi.multiEntry&&ot(ji)?ji.forEach(function(ya){return Wi.addKey(ya)}):Wi.addKey(ji)}(Fn||Yr).forEach(function(ji,na){var _s=Fn&&Ki(Fn[na]),na=Yr&&Ki(Yr[na]);Fi(_s,na)!==0&&(_s!=null&&Bi(_s),na!=null)&&Bi(na)})}))):gi?(hi={from:(oi=gi.lower)!=null?oi:St.MIN_KEY,to:(ni=gi.upper)!=null?ni:St.MAX_KEY},di.add(hi),ci.add(hi)):(ci.add(Jt),di.add(Jt),Ar.indexes.forEach(function(wi){return Lr(wi.name).add(Jt)})),xr.mutate(Fr).then(function(wi){return!gi||Fr.type!=="add"&&Fr.type!=="put"||(ci.addKeys(wi.results),Ur&&Ur.forEach(function(Wi){for(var Ki=Fr.values.map(function(_s){return Wi.extractKey(_s)}),Bi=Wi.keyPath.findIndex(function(_s){return _s===Mr.keyPath}),ji=0,ya=wi.results.length;ji<ya;++ji)Ki[ji][Bi]=wi.results[ji];Lr(Wi.name).addKeys(Ki)})),Zn.mutatedParts=gs(Zn.mutatedParts||{},Qn),wi})}}),Nr={get:function(Fr){return[Mr,new $a(Fr.key)]},getMany:function(Fr){return[Mr,new $a().addKeys(Fr.keys)]},count:gr,query:gr,openCursor:gr};return st(Nr).forEach(function(Fr){Gr[Fr]=function(Lr){var An=_r.subscr,Fn=!!An,Yr=uc(_r,xr)&&lo(Fr,Lr)?Lr.obsSet={}:An;if(Fn){var Zn,An=function(hi){return hi="idb://".concat(Dt,"/").concat(sr,"/").concat(hi),Yr[hi]||(Yr[hi]=new $a)},Qn=An(""),ci=An(":dels"),Fn=Nr[Fr](Lr),di=Fn[0],Fn=Fn[1];if((Fr==="query"&&di.isPrimaryKey&&!Lr.values?ci:An(di.name||"")).add(Fn),!di.isPrimaryKey){if(Fr!=="count")return Zn=Fr==="query"&&$r&&Lr.values&&xr.query(nt(nt({},Lr),{values:!1})),xr[Fr].apply(this,arguments).then(function(hi){if(Fr==="query"){if($r&&Lr.values)return Zn.then(function(Ki){return Ki=Ki.result,Qn.addKeys(Ki),hi});var oi=Lr.values?hi.result.map(Zr):hi.result;(Lr.values?Qn:ci).addKeys(oi)}else{var wi,Wi;if(Fr==="openCursor")return Wi=Lr.values,(wi=hi)&&Object.create(wi,{key:{get:function(){return ci.addKey(wi.primaryKey),wi.key}},primaryKey:{get:function(){var Ki=wi.primaryKey;return ci.addKey(Ki),Ki}},value:{get:function(){return Wi&&Qn.addKey(wi.primaryKey),wi.value}}})}return hi});ci.add(Jt)}}return xr[Fr].apply(this,arguments)}}),Gr}})}};function Oo(St,Dt,Jt){var sr;return Jt.numFailures===0?Dt:Dt.type==="deleteRange"||(sr=Dt.keys?Dt.keys.length:"values"in Dt&&Dt.values?Dt.values.length:1,Jt.numFailures===sr)?null:(sr=nt({},Dt),ot(sr.keys)&&(sr.keys=sr.keys.filter(function(gr,xr){return!(xr in Jt.failures)})),"values"in sr&&ot(sr.values)&&(sr.values=sr.values.filter(function(gr,xr){return!(xr in Jt.failures)})),sr)}function Bu(St,Dt){return Jt=St,((sr=Dt).lower===void 0||(sr.lowerOpen?0<Fi(Jt,sr.lower):0<=Fi(Jt,sr.lower)))&&(Jt=St,(sr=Dt).upper===void 0||(sr.upperOpen?Fi(Jt,sr.upper)<0:Fi(Jt,sr.upper)<=0));var Jt,sr}function Vl(St,Dt,Jt,sr,gr,xr){var Ar,Mr,jr,Zr,$r,Ur;return!Jt||Jt.length===0||(Ar=Dt.query.index,Mr=Ar.multiEntry,jr=Dt.query.range,Zr=sr.schema.primaryKey.extractKey,$r=Ar.extractKey,Ur=(Ar.lowLevelIndex||Ar).extractKey,(sr=Jt.reduce(function(Gr,Nr){var Fr=Gr,Lr=[];if(Nr.type==="add"||Nr.type==="put")for(var An=new $a,Fn=Nr.values.length-1;0<=Fn;--Fn){var Yr,Zn=Nr.values[Fn],Qn=Zr(Zn);!An.hasKey(Qn)&&(Yr=$r(Zn),Mr&&ot(Yr)?Yr.some(function(hi){return Bu(hi,jr)}):Bu(Yr,jr))&&(An.addKey(Qn),Lr.push(Zn))}switch(Nr.type){case"add":var ci=new $a().addKeys(Dt.values?Gr.map(function(oi){return Zr(oi)}):Gr),Fr=Gr.concat(Dt.values?Lr.filter(function(oi){return oi=Zr(oi),!ci.hasKey(oi)&&(ci.addKey(oi),!0)}):Lr.map(function(oi){return Zr(oi)}).filter(function(oi){return!ci.hasKey(oi)&&(ci.addKey(oi),!0)}));break;case"put":var di=new $a().addKeys(Nr.values.map(function(oi){return Zr(oi)}));Fr=Gr.filter(function(oi){return!di.hasKey(Dt.values?Zr(oi):oi)}).concat(Dt.values?Lr:Lr.map(function(oi){return Zr(oi)}));break;case"delete":var ni=new $a().addKeys(Nr.keys);Fr=Gr.filter(function(oi){return!ni.hasKey(Dt.values?Zr(oi):oi)});break;case"deleteRange":var gi=Nr.range;Fr=Gr.filter(function(oi){return!Bu(Zr(oi),gi)})}return Fr},St))===St)?St:(sr.sort(function(Gr,Nr){return Fi(Ur(Gr),Ur(Nr))||Fi(Zr(Gr),Zr(Nr))}),Dt.limit&&Dt.limit<1/0&&(sr.length>Dt.limit?sr.length=Dt.limit:St.length===Dt.limit&&sr.length<Dt.limit&&(gr.dirty=!0)),xr?Object.freeze(sr):sr)}function Du(St,Dt){return Fi(St.lower,Dt.lower)===0&&Fi(St.upper,Dt.upper)===0&&!!St.lowerOpen==!!Dt.lowerOpen&&!!St.upperOpen==!!Dt.upperOpen}function cc(St,Dt){return((Jt,sr,gr,xr)=>{if(Jt===void 0)return sr!==void 0?-1:0;if(sr===void 0)return 1;if((Jt=Fi(Jt,sr))===0){if(gr&&xr)return 0;if(gr)return 1;if(xr)return-1}return Jt})(St.lower,Dt.lower,St.lowerOpen,Dt.lowerOpen)<=0&&0<=((Jt,sr,gr,xr)=>{if(Jt===void 0)return sr!==void 0?1:0;if(sr===void 0)return-1;if((Jt=Fi(Jt,sr))===0){if(gr&&xr)return 0;if(gr)return-1;if(xr)return 1}return Jt})(St.upper,Dt.upper,St.upperOpen,Dt.upperOpen)}function Lu(St,Dt,Jt,sr){St.subscribers.add(Jt),sr.addEventListener("abort",function(){var gr,xr;St.subscribers.delete(Jt),St.subscribers.size===0&&(gr=St,xr=Dt,setTimeout(function(){gr.subscribers.size===0&&Ft(xr,gr)},3e3))})}var fu={stack:"dbcore",level:0,name:"Cache",create:function(St){var Dt=St.schema.name;return nt(nt({},St),{transaction:function(Jt,sr,gr){var xr,Ar,Mr=St.transaction(Jt,sr,gr);return sr==="readwrite"&&(gr=(xr=new AbortController).signal,Mr.addEventListener("abort",(Ar=function(jr){return function(){if(xr.abort(),sr==="readwrite"){for(var Zr=new Set,$r=0,Ur=Jt;$r<Ur.length;$r++){var Gr=Ur[$r],Nr=Gs["idb://".concat(Dt,"/").concat(Gr)];if(Nr){var Fr=St.table(Gr),Lr=Nr.optimisticOps.filter(function(wi){return wi.trans===Mr});if(Mr._explicit&&jr&&Mr.mutatedParts)for(var An=0,Fn=Object.values(Nr.queries.query);An<Fn.length;An++)for(var Yr=0,Zn=(di=Fn[An]).slice();Yr<Zn.length;Yr++)jl((ni=Zn[Yr]).obsSet,Mr.mutatedParts)&&(Ft(di,ni),ni.subscribers.forEach(function(wi){return Zr.add(wi)}));else if(0<Lr.length){Nr.optimisticOps=Nr.optimisticOps.filter(function(wi){return wi.trans!==Mr});for(var Qn=0,ci=Object.values(Nr.queries.query);Qn<ci.length;Qn++)for(var di,ni,gi,hi=0,oi=(di=ci[Qn]).slice();hi<oi.length;hi++)(ni=oi[hi]).res!=null&&Mr.mutatedParts&&(jr&&!ni.dirty?(gi=Object.isFrozen(ni.res),gi=Vl(ni.res,ni.req,Lr,Fr,ni,gi),ni.dirty?(Ft(di,ni),ni.subscribers.forEach(function(wi){return Zr.add(wi)})):gi!==ni.res&&(ni.res=gi,ni.promise=Jr.resolve({result:gi}))):(ni.dirty&&Ft(di,ni),ni.subscribers.forEach(function(wi){return Zr.add(wi)})))}}}Zr.forEach(function(wi){return wi()})}}})(!1),{signal:gr}),Mr.addEventListener("error",Ar(!1),{signal:gr}),Mr.addEventListener("complete",Ar(!0),{signal:gr})),Mr},table:function(Jt){var sr=St.table(Jt),gr=sr.schema.primaryKey;return nt(nt({},sr),{mutate:function(xr){var Ar,Mr=_r.trans;return!gr.outbound&&Mr.db._options.cache!=="disabled"&&!Mr.explicit&&Mr.idbtrans.mode==="readwrite"&&(Ar=Gs["idb://".concat(Dt,"/").concat(Jt)])?(Mr=sr.mutate(xr),xr.type!=="add"&&xr.type!=="put"||!(50<=xr.values.length||Ou(gr,xr).some(function(jr){return jr==null}))?(Ar.optimisticOps.push(xr),xr.mutatedParts&&Gl(xr.mutatedParts),Mr.then(function(jr){0<jr.numFailures&&(Ft(Ar.optimisticOps,xr),(jr=Oo(0,xr,jr))&&Ar.optimisticOps.push(jr),xr.mutatedParts)&&Gl(xr.mutatedParts)}),Mr.catch(function(){Ft(Ar.optimisticOps,xr),xr.mutatedParts&&Gl(xr.mutatedParts)})):Mr.then(function(jr){var Zr=Oo(0,nt(nt({},xr),{values:xr.values.map(function($r,Ur){var Gr;return jr.failures[Ur]?$r:(Et(Gr=(Gr=gr.keyPath)!=null&&Gr.includes(".")?Qt($r):nt({},$r),gr.keyPath,jr.results[Ur]),Gr)})}),jr);Ar.optimisticOps.push(Zr),queueMicrotask(function(){return xr.mutatedParts&&Gl(xr.mutatedParts)})}),Mr):sr.mutate(xr)},query:function(xr){var Ar,Mr,jr,Zr,$r,Ur,Gr;return uc(_r,sr)&&lo("query",xr)?(Ar=((jr=_r.trans)==null?void 0:jr.db._options.cache)==="immutable",Mr=(jr=_r).requery,jr=jr.signal,Ur=((Nr,Fr,Lr,An)=>{var Fn=Gs["idb://".concat(Nr,"/").concat(Fr)];if(!Fn)return[];if(!(Nr=Fn.queries[Lr]))return[null,!1,Fn,null];var Yr=Nr[(An.query?An.query.index.name:null)||""];if(!Yr)return[null,!1,Fn,null];switch(Lr){case"query":var Zn=Yr.find(function(Qn){return Qn.req.limit===An.limit&&Qn.req.values===An.values&&Du(Qn.req.query.range,An.query.range)});return Zn?[Zn,!0,Fn,Yr]:[Yr.find(function(Qn){return("limit"in Qn.req?Qn.req.limit:1/0)>=An.limit&&(!An.values||Qn.req.values)&&cc(Qn.req.query.range,An.query.range)}),!1,Fn,Yr];case"count":return Zn=Yr.find(function(Qn){return Du(Qn.req.query.range,An.query.range)}),[Zn,!!Zn,Fn,Yr]}})(Dt,Jt,"query",xr),Gr=Ur[0],Zr=Ur[2],$r=Ur[3],Gr&&Ur[1]?Gr.obsSet=xr.obsSet:(Ur=sr.query(xr).then(function(Nr){var Fr=Nr.result;if(Gr&&(Gr.res=Fr),Ar){for(var Lr=0,An=Fr.length;Lr<An;++Lr)Object.freeze(Fr[Lr]);Object.freeze(Fr)}else Nr.result=Qt(Fr);return Nr}).catch(function(Nr){return $r&&Gr&&Ft($r,Gr),Promise.reject(Nr)}),Gr={obsSet:xr.obsSet,promise:Ur,subscribers:new Set,type:"query",req:xr,dirty:!1},$r?$r.push(Gr):($r=[Gr],(Zr=Zr||(Gs["idb://".concat(Dt,"/").concat(Jt)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[xr.query.index.name||""]=$r)),Lu(Gr,$r,Mr,jr),Gr.promise.then(function(Nr){return{result:Vl(Nr.result,xr,Zr?.optimisticOps,sr,Gr,Ar)}})):sr.query(xr)}})}})}};function co(St,Dt){return new Proxy(St,{get:function(Jt,sr,gr){return sr==="db"?Dt:Reflect.get(Jt,sr,gr)}})}Ma.prototype.version=function(St){if(isNaN(St)||St<.1)throw new cr.Type("Given version is not a positive number");if(St=Math.round(10*St)/10,this.idbdb||this._state.isBeingOpened)throw new cr.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,St);var Dt=this._versions,Jt=Dt.filter(function(sr){return sr._cfg.version===St})[0];return Jt||(Jt=new this.Version(St),Dt.push(Jt),Dt.sort(Ms),Jt.stores({}),this._state.autoSchema=!1),Jt},Ma.prototype._whenReady=function(St){var Dt=this;return this.idbdb&&(this._state.openComplete||_r.letThrough||this._vip)?St():new Jr(function(Jt,sr){if(Dt._state.openComplete)return sr(new cr.DatabaseClosed(Dt._state.dbOpenError));if(!Dt._state.isBeingOpened){if(!Dt._state.autoOpen)return void sr(new cr.DatabaseClosed);Dt.open().catch(pr)}Dt._state.dbReadyPromise.then(Jt,sr)}).then(St)},Ma.prototype.use=function(gr){var Dt=gr.stack,Jt=gr.create,sr=gr.level,gr=gr.name,xr=(gr&&this.unuse({stack:Dt,name:gr}),this._middlewares[Dt]||(this._middlewares[Dt]=[]));return xr.push({stack:Dt,create:Jt,level:sr??10,name:gr}),xr.sort(function(Ar,Mr){return Ar.level-Mr.level}),this},Ma.prototype.unuse=function(St){var Dt=St.stack,Jt=St.name,sr=St.create;return Dt&&this._middlewares[Dt]&&(this._middlewares[Dt]=this._middlewares[Dt].filter(function(gr){return sr?gr.create!==sr:!!Jt&&gr.name!==Jt})),this},Ma.prototype.open=function(){var St=this;return is(qn,function(){return oc(St)})},Ma.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var St=this._state,Dt=Ks.indexOf(this);if(0<=Dt&&Ks.splice(Dt,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}St.isBeingOpened||(St.dbReadyPromise=new Jr(function(Jt){St.dbReadyResolve=Jt}),St.openCanceller=new Jr(function(Jt,sr){St.cancelOpen=sr}))},Ma.prototype.close=function(Dt){var Dt=(Dt===void 0?{disableAutoOpen:!0}:Dt).disableAutoOpen,Jt=this._state;Dt?(Jt.isBeingOpened&&Jt.cancelOpen(new cr.DatabaseClosed),this._close(),Jt.autoOpen=!1,Jt.dbOpenError=new cr.DatabaseClosed):(this._close(),Jt.autoOpen=this._options.autoOpen||Jt.isBeingOpened,Jt.openComplete=!1,Jt.dbOpenError=null)},Ma.prototype.delete=function(St){var Dt=this,Jt=(St===void 0&&(St={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),sr=this._state;return new Jr(function(gr,xr){function Ar(){Dt.close(St);var Mr=Dt._deps.indexedDB.deleteDatabase(Dt.name);Mr.onsuccess=Ti(function(){var jr,Zr,$r;jr=Dt._deps,Zr=Dt.name,Mo($r=jr.indexedDB)||Zr===ol||Ul($r,jr.IDBKeyRange).delete(Zr).catch(pr),gr()}),Mr.onerror=Qi(xr),Mr.onblocked=Dt._fireOnBlocked}if(Jt)throw new cr.InvalidArgument("Invalid closeOptions argument to db.delete()");sr.isBeingOpened?sr.dbReadyPromise.then(Ar):Ar()})},Ma.prototype.backendDB=function(){return this.idbdb},Ma.prototype.isOpen=function(){return this.idbdb!==null},Ma.prototype.hasBeenClosed=function(){var St=this._state.dbOpenError;return St&&St.name==="DatabaseClosed"},Ma.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ma.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ma.prototype,"tables",{get:function(){var St=this;return st(this._allTables).map(function(Dt){return St._allTables[Dt]})},enumerable:!1,configurable:!0}),Ma.prototype.transaction=function(){var St=(function(Dt,Jt,sr){var gr=arguments.length;if(gr<2)throw new cr.InvalidArgument("Too few arguments");for(var xr=new Array(gr-1);--gr;)xr[gr-1]=arguments[gr];return sr=xr.pop(),[Dt,jt(xr),sr]}).apply(this,arguments);return this._transaction.apply(this,St)},Ma.prototype._transaction=function(St,Dt,Jt){var sr,gr,xr=this,Ar=_r.trans,Mr=(Ar&&Ar.db===this&&St.indexOf("!")===-1||(Ar=null),St.indexOf("?")!==-1);St=St.replace("!","").replace("?","");try{if(gr=Dt.map(function(Zr){if(Zr=Zr instanceof xr.Table?Zr.name:Zr,typeof Zr!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Zr}),St=="r"||St===Pl)sr=Pl;else{if(St!="rw"&&St!=au)throw new cr.InvalidArgument("Invalid transaction mode: "+St);sr=au}if(Ar){if(Ar.mode===Pl&&sr===au){if(!Mr)throw new cr.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");Ar=null}Ar&&gr.forEach(function(Zr){if(Ar&&Ar.storeNames.indexOf(Zr)===-1){if(!Mr)throw new cr.SubTransaction("Table "+Zr+" not included in parent transaction.");Ar=null}}),Mr&&Ar&&!Ar.active&&(Ar=null)}}catch(Zr){return Ar?Ar._promise(null,function($r,Ur){Ur(Zr)}):wa(Zr)}var jr=(function Zr($r,Ur,Gr,Nr,Fr){return Jr.resolve().then(function(){var Yr=_r.transless||_r,Lr=$r._createTransaction(Ur,Gr,$r._dbSchema,Nr),Yr=(Lr.explicit=!0,{trans:Lr,transless:Yr});if(Nr)Lr.idbtrans=Nr.idbtrans;else try{Lr.create(),Lr.idbtrans._explicit=!0,$r._state.PR1398_maxLoop=3}catch(Zn){return Zn.name===Sr.InvalidState&&$r.isOpen()&&0<--$r._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$r.close({disableAutoOpen:!1}),$r.open().then(function(){return Zr($r,Ur,Gr,null,Fr)})):wa(Zn)}var An,Fn=zt(Fr),Yr=(Fn&&ka(),Jr.follow(function(){var Zn;(An=Fr.call(Lr,Lr))&&(Fn?(Zn=Xi.bind(null,null),An.then(Zn,Zn)):typeof An.next=="function"&&typeof An.throw=="function"&&(An=Qo(An)))},Yr));return(An&&typeof An.then=="function"?Jr.resolve(An).then(function(Zn){return Lr.active?Zn:wa(new cr.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Yr.then(function(){return An})).then(function(Zn){return Nr&&Lr._resolve(),Lr._completion.then(function(){return Zn})}).catch(function(Zn){return Lr._reject(Zn),wa(Zn)})})}).bind(null,this,sr,gr,Ar,Jt);return Ar?Ar._promise(sr,jr,"lock"):_r.trans?is(_r.transless,function(){return xr._whenReady(jr)}):this._whenReady(jr)},Ma.prototype.table=function(St){if(ut(this._allTables,St))return this._allTables[St];throw new cr.InvalidTable("Table ".concat(St," does not exist"))};var ho=Ma;function Ma(St,Dt){var Jt,sr,gr,xr,Ar,Mr=this,jr=(this._middlewares={},this.verno=0,Ma.dependencies),jr=(this._options=Dt=nt({addons:Ma.addons,autoOpen:!0,indexedDB:jr.indexedDB,IDBKeyRange:jr.IDBKeyRange,cache:"cloned"},Dt),this._deps={indexedDB:Dt.indexedDB,IDBKeyRange:Dt.IDBKeyRange},Dt.addons),Zr=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:pr,dbReadyPromise:null,cancelOpen:pr,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:Dt.autoOpen}),$r=(Zr.dbReadyPromise=new Jr(function(Ur){Zr.dbReadyResolve=Ur}),Zr.openCanceller=new Jr(function(Ur,Gr){Zr.cancelOpen=Gr}),this._state=Zr,this.name=St,this.on=Go(this,"populate","blocked","versionchange","close",{ready:[or,pr]}),this.once=function(Ur,Gr){var Nr=function(){for(var Fr=[],Lr=0;Lr<arguments.length;Lr++)Fr[Lr]=arguments[Lr];Mr.on(Ur).unsubscribe(Nr),Gr.apply(Mr,Fr)};return Mr.on(Ur,Nr)},this.on.ready.subscribe=Tt(this.on.ready.subscribe,function(Ur){return function(Gr,Nr){Ma.vip(function(){var Fr,Lr=Mr._state;Lr.openComplete?(Lr.dbOpenError||Jr.resolve().then(Gr),Nr&&Ur(Gr)):Lr.onReadyBeingFired?(Lr.onReadyBeingFired.push(Gr),Nr&&Ur(Gr)):(Ur(Gr),Fr=Mr,Nr||Ur(function An(){Fr.on.ready.unsubscribe(Gr),Fr.on.ready.unsubscribe(An)}))})}}),this.Collection=(Jt=this,Ho(Fc.prototype,function(An,Lr){this.db=Jt;var Nr=Ps,Fr=null;if(Lr)try{Nr=Lr()}catch(Yr){Fr=Yr}var Lr=An._ctx,An=Lr.table,Fn=An.hook.reading.fire;this._ctx={table:An,index:Lr.index,isPrimKey:!Lr.index||An.schema.primKey.keyPath&&Lr.index===An.schema.primKey.name,range:Nr,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Fr,or:Lr.or,valueMapper:Fn!==rr?Fn:null}})),this.Table=(sr=this,Ho(Cl.prototype,function(Ur,Gr,Nr){this.db=sr,this._tx=Nr,this.name=Ur,this.schema=Gr,this.hook=sr._allTables[Ur]?sr._allTables[Ur].hook:Go(null,{creating:[ur,pr],reading:[ar,rr],updating:[Ut,pr],deleting:[Er,pr]})})),this.Transaction=(gr=this,Ho(ou.prototype,function(Ur,Gr,Nr,Fr,Lr){var An=this;Ur!=="readonly"&&Gr.forEach(function(Fn){Fn=(Fn=Nr[Fn])==null?void 0:Fn.yProps,Fn&&(Gr=Gr.concat(Fn.map(function(Yr){return Yr.updatesTable})))}),this.db=gr,this.mode=Ur,this.storeNames=Gr,this.schema=Nr,this.chromeTransactionDurability=Fr,this.idbtrans=null,this.on=Go(this,"complete","error","abort"),this.parent=Lr||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Jr(function(Fn,Yr){An._resolve=Fn,An._reject=Yr}),this._completion.then(function(){An.active=!1,An.on.complete.fire()},function(Fn){var Yr=An.active;return An.active=!1,An.on.error.fire(Fn),An.parent?An.parent._reject(Fn):Yr&&An.idbtrans&&An.idbtrans.abort(),wa(Fn)})})),this.Version=(xr=this,Ho(js.prototype,function(Ur){this.db=xr,this._cfg={version:Ur,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Ar=this,Ho(Dl.prototype,function(Ur,Gr,Nr){if(this.db=Ar,this._ctx={table:Ur,index:Gr===":id"?null:Gr,or:Nr},this._cmp=this._ascending=Fi,this._descending=function(Fr,Lr){return Fi(Lr,Fr)},this._max=function(Fr,Lr){return 0<Fi(Fr,Lr)?Fr:Lr},this._min=function(Fr,Lr){return Fi(Fr,Lr)<0?Fr:Lr},this._IDBKeyRange=Ar._deps.IDBKeyRange,!this._IDBKeyRange)throw new cr.MissingAPI})),this.on("versionchange",function(Ur){0<Ur.newVersion?console.warn("Another connection wants to upgrade database '".concat(Mr.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(Mr.name,"'. Closing db now to resume the delete request.")),Mr.close({disableAutoOpen:!1})}),this.on("blocked",function(Ur){!Ur.newVersion||Ur.newVersion<Ur.oldVersion?console.warn("Dexie.delete('".concat(Mr.name,"') was blocked")):console.warn("Upgrade '".concat(Mr.name,"' blocked by other connection holding version ").concat(Ur.oldVersion/10))}),this._maxKey=zs(Dt.IDBKeyRange),this._createTransaction=function(Ur,Gr,Nr,Fr){return new Mr.Transaction(Ur,Gr,Nr,Mr._options.chromeTransactionDurability,Fr)},this._fireOnBlocked=function(Ur){Mr.on("blocked").fire(Ur),Ks.filter(function(Gr){return Gr.name===Mr.name&&Gr!==Mr&&!Gr._state.vcFired}).map(function(Gr){return Gr.on("versionchange").fire(Ur)})},this.use(lc),this.use(fu),this.use(uo),this.use(Ko),this.use(oo),new Proxy(this,{get:function(Ur,Gr,Nr){var Fr;return Gr==="_vip"||(Gr==="table"?function(Lr){return co(Mr.table(Lr),$r)}:(Fr=Reflect.get(Ur,Gr,Nr))instanceof Cl?co(Fr,$r):Gr==="tables"?Fr.map(function(Lr){return co(Lr,$r)}):Gr==="_createTransaction"?function(){return co(Fr.apply(this,arguments),$r)}:Fr)}}));this.vip=$r,jr.forEach(function(Ur){return Ur(Mr)})}var Wl,Hs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",pu=(Jo.prototype.subscribe=function(St,Dt,Jt){return this._subscribe(St&&typeof St!="function"?St:{next:St,error:Dt,complete:Jt})},Jo.prototype[Hs]=function(){return this},Jo);function Jo(St){this._subscribe=St}try{Wl={indexedDB:at.indexedDB||at.mozIndexedDB||at.webkitIndexedDB||at.msIndexedDB,IDBKeyRange:at.IDBKeyRange||at.webkitIDBKeyRange}}catch{Wl={indexedDB:null,IDBKeyRange:null}}function dl(St){var Dt,Jt=!1,sr=new pu(function(gr){var xr=zt(St),Ar,Mr=!1,jr={},Zr={},$r={get closed(){return Mr},unsubscribe:function(){Mr||(Mr=!0,Ar&&Ar.abort(),Ur&&Wo.storagemutated.unsubscribe(Nr))}},Ur=(gr.start&&gr.start($r),!1),Gr=function(){return Xs(Fr)},Nr=function(Lr){gs(jr,Lr),jl(Zr,jr)&&Gr()},Fr=function(){var Lr,An,Fn;!Mr&&Wl.indexedDB&&(jr={},Lr={},Ar&&Ar.abort(),Ar=new AbortController,Fn=(Yr=>{var Zn=ri();try{xr&&ka();var Qn=ua(St,Yr);return Qn=xr?Qn.finally(Xi):Qn}finally{Zn&&yi()}})(An={subscr:Lr,signal:Ar.signal,requery:Gr,querier:St,trans:null}),Promise.resolve(Fn).then(function(Yr){Jt=!0,Dt=Yr,Mr||An.signal.aborted||(jr={},(Zn=>{for(var Qn in Zn)if(ut(Zn,Qn))return;return 1})(Zr=Lr)||Ur||(Wo(Ll,Nr),Ur=!0),Xs(function(){return!Mr&&gr.next&&gr.next(Yr)}))},function(Yr){Jt=!1,["DatabaseClosedError","AbortError"].includes(Yr?.name)||Mr||Xs(function(){Mr||gr.error&&gr.error(Yr)})}))};return setTimeout(Gr,0),$r});return sr.hasValue=function(){return Jt},sr.getValue=function(){return Dt},sr}var Os=ho;function fl(St){var Dt=Da;try{Da=!0,Wo.storagemutated.fire(St),ku(St,!0)}finally{Da=Dt}}ft(Os,nt(nt({},er),{delete:function(St){return new Os(St,{addons:[]}).delete()},exists:function(St){return new Os(St,{addons:[]}).open().then(function(Dt){return Dt.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(St){try{return Dt=Os.dependencies,Jt=Dt.indexedDB,Dt=Dt.IDBKeyRange,(Mo(Jt)?Promise.resolve(Jt.databases()).then(function(sr){return sr.map(function(gr){return gr.name}).filter(function(gr){return gr!==ol})}):Ul(Jt,Dt).toCollection().primaryKeys()).then(St)}catch{return wa(new cr.MissingAPI)}var Dt,Jt},defineClass:function(){return function(St){lt(this,St)}},ignoreTransaction:function(St){return _r.trans?is(_r.transless,St):St()},vip:Yo,async:function(St){return function(){try{var Dt=Qo(St.apply(this,arguments));return Dt&&typeof Dt.then=="function"?Dt:Jr.resolve(Dt)}catch(Jt){return wa(Jt)}}},spawn:function(St,Dt,Jt){try{var sr=Qo(St.apply(Jt,Dt||[]));return sr&&typeof sr.then=="function"?sr:Jr.resolve(sr)}catch(gr){return wa(gr)}},currentTransaction:{get:function(){return _r.trans||null}},waitFor:function(St,Dt){return St=Jr.resolve(typeof St=="function"?Os.ignoreTransaction(St):St).timeout(Dt||6e4),_r.trans?_r.trans.waitFor(St):St},Promise:Jr,debug:{get:function(){return hr},set:function(St){kr(St)}},derive:vt,extend:lt,props:ft,override:Tt,Events:Go,on:Wo,liveQuery:dl,extendObservabilitySet:gs,getByKeyPath:Ot,setByKeyPath:Et,delByKeyPath:function(St,Dt){typeof Dt=="string"?Et(St,Dt,void 0):"length"in Dt&&[].map.call(Dt,function(Jt){Et(St,Jt,void 0)})},shallowClone:Lt,deepClone:Qt,getObjectDiff:du,cmp:Fi,asap:Rt,minKey:-1/0,addons:[],connections:Ks,errnames:Sr,dependencies:Wl,cache:Gs,semVer:"4.3.0",version:"4.3.0".split(".").map(function(St){return parseInt(St)}).reduce(function(St,Dt,Jt){return St+Dt/Math.pow(10,2*Jt)})})),Os.maxKey=zs(Os.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Wo(Ll,function(St){Da||(St=new CustomEvent(Vo,{detail:St}),Da=!0,dispatchEvent(St),Da=!1)}),addEventListener(Vo,function(St){St=St.detail,Da||fl(St)}));var fo,Da=!1,el=function(){};return typeof BroadcastChannel<"u"&&((el=function(){(fo=new BroadcastChannel(Vo)).onmessage=function(St){return St.data&&fl(St.data)}})(),typeof fo.unref=="function"&&fo.unref(),Wo(Ll,function(St){Da||fo.postMessage(St)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(St){if(!ho.disableBfCache&&St.persisted){hr&&console.debug("Dexie: handling persisted pagehide"),fo?.close();for(var Dt=0,Jt=Ks;Dt<Jt.length;Dt++)Jt[Dt].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(St){!ho.disableBfCache&&St.persisted&&(hr&&console.debug("Dexie: handling persisted pageshow"),el(),fl({all:new $a(-1/0,[[]])}))})),Jr.rejectionMapper=function(St,Dt){return!St||St instanceof fr||St instanceof TypeError||St instanceof SyntaxError||!St.name||!Nt[St.name]?St:(Dt=new Nt[St.name](Dt||St.message,St),"stack"in St&&gt(Dt,"stack",{get:function(){return this.inner.stack}}),Dt)},kr(hr),nt(ho,Object.freeze({__proto__:null,Dexie:ho,Entity:pa,PropModification:Ts,RangeSet:$a,add:function(St){return new Ts({add:St})},cmp:Fi,default:ho,liveQuery:dl,mergeRanges:so,rangesOverlap:zl,remove:function(St){return new Ts({remove:St})},replacePrefix:function(St,Dt){return new Ts({replacePrefix:[St,Dt]})}}),{default:ho}),ho})})(dexie_min$1)),dexie_min$1.exports}var dexie_minExports=requireDexie_min();const _Dexie=getDefaultExportFromCjs$1(dexie_minExports),DexieSymbol=Symbol.for("Dexie"),Dexie=globalThis[DexieSymbol]||(globalThis[DexieSymbol]=_Dexie);if(_Dexie.semVer!==Dexie.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);const{liveQuery,mergeRanges,rangesOverlap,RangeSet,cmp,Entity,PropModification,replacePrefix,add:add$1,remove,DexieYProvider}=Dexie;class SaveDatabase extends Dexie{saves;constructor(){super("GameEngineDB"),this.version(2).stores({saves:"saveName, timestamp"})}}const db=new SaveDatabase,SAVE_EXTENSION=".brsv";class SaveManager{static instance;static getInstance(){return SaveManager.instance||(SaveManager.instance=new SaveManager),SaveManager.instance}async performSave(et,rt){const nt=WorkerManager$1.getInstance(),it=ViewWorkerManager.getInstance(),at=SharedSession.getInstance(),st=await this.requestSnapshot(nt.logic,rt),ot=await this.requestSnapshot(it.worker,rt),lt=at.get("campaign_id"),ht=at.get("campaign_step_index"),dt={saveName:et,stateName:rt,timestamp:Date.now(),preview:`Save ${new Date().toLocaleTimeString()}`,campaignId:lt||void 0,campaignIndex:ht!==void 0?ht:void 0,sessionData:at.exportSaveData(),logicSnapshot:st,viewSnapshot:ot};await db.saves.put(dt)}async performLoad(et){const rt=await db.saves.get(et);if(!rt)throw new Error(`Save '${et}' not found`);const nt=SharedSession.getInstance(),it=WorkerManager$1.getInstance(),at=ViewWorkerManager.getInstance();return nt.lockForLoad(),nt.clearSavableKeys(),nt.importSaveData(rt.sessionData),it.prepareForState(rt.stateName),it.createState(rt.stateName),it.sendInput(rt.stateName,"LOAD_SNAPSHOT",{data:rt.logicSnapshot}),at.prepareForState(rt.stateName),at.createState(rt.stateName),at.loadSnapshot(rt.stateName,rt.viewSnapshot),it.isInitialized=!0,at.isInitialized=!0,rt}async deleteSave(et){await db.saves.delete(et)}async exportSave(et){const rt=await db.saves.get(et);if(!rt)throw new Error("Save not found");return JSON.stringify(rt,null,2)}async importSave(et){try{const rt=JSON.parse(et);if(!rt.saveName||!rt.stateName)throw new Error("Invalid .brsv file format");rt.timestamp=Date.now(),await db.saves.put(rt)}catch(rt){throw console.error("Failed to import .brsv",rt),rt}}requestSnapshot(et,rt){return new Promise(nt=>{const it=new MessageChannel;it.port1.onmessage=at=>{it.port1.close(),nt(at.data)},et.postMessage({type:"INPUT",stateName:rt,payload:{action:"GET_SNAPSHOT"}},[it.port2])})}}class BaseController{constructor(et,rt){this.vm=et,this.stateName=rt,this.workers=WorkerManager$1.getInstance(),window.addEventListener("keydown",this.handleKeyDown),this.workers.logic.addEventListener("message",this.handleWorkerMessage),this.captureInitialState()}workers;QUICK_SAVE_KEY="quick_save";update(){this.vm.update()}destroy(){window.removeEventListener("keydown",this.handleKeyDown),this.workers.logic.removeEventListener("message",this.handleWorkerMessage),this.onInternalDestroy()}send(et,rt={}){this.workers.sendInput(this.stateName,et,rt)}onInternalDestroy(){}captureInitialState(){setTimeout(async()=>{await SaveManager.getInstance().performSave(this.QUICK_SAVE_KEY,this.stateName)},200)}handleWorkerMessage=et=>{const{type:rt,name:nt,payload:it}=et.data;rt==="EVENT"&&this.onWorkerEvent(nt,it)};handleKeyDown=et=>{this.onKeyDown(et)}}const levelData$3={"Level 1":{width:960,height:540,initialHP:100,spawnCount:10,heroStartX:480,heroStartY:270,moveSpeed:5,manifestPath:"res/manifest.json",bgmKey:"bgm_level1",levelLabel:"Level 1"},"Level 2":{width:960,height:540,initialHP:80,spawnCount:20,heroStartX:100,heroStartY:100,moveSpeed:6,manifestPath:"res/manifest.json",bgmKey:"bgm_level1",levelLabel:"Level 2"},"Level 3":{width:960,height:540,initialHP:50,spawnCount:35,heroStartX:800,heroStartY:450,moveSpeed:8,manifestPath:"res/manifest.json",bgmKey:"bgm_level1",levelLabel:"Level 3"}};var Game1Level=(tt=>(tt.Level1="Level 1",tt.Level2="Level 2",tt.Level3="Level 3",tt))(Game1Level||{});const getGame1Config=tt=>{const et=levelData$3[tt];return et||(console.warn(`Config for ${tt} not found, falling back to Level 1`),levelData$3["Level 1"])};class CampaignRegistry{static campaigns=new Map;static register(et){this.campaigns.set(et.id,et)}static get(et){return this.campaigns.get(et)}static getAll(){return Array.from(this.campaigns.values())}}class CampaignManager{static instance;constructor(){}static getInstance(){return CampaignManager.instance||(CampaignManager.instance=new CampaignManager),CampaignManager.instance}startCampaign(et){const rt=CampaignRegistry.get(et);if(!rt){console.error(`[CampaignManager] Could not find campaign: ${et}`);return}console.log(`[CampaignManager] Starting Campaign: ${et}`);const nt=SharedSession.getInstance();nt.clearSavableKeys(),nt.set("campaign_id",et),nt.set("campaign_step_index",0),this.loadCurrentStep(rt,0)}completeCurrentStep(){const et=SharedSession.getInstance(),rt=et.get("campaign_id");let nt=et.get("campaign_step_index");if(!rt||nt===void 0){console.error("[CampaignManager] Cannot advance: No active campaign session.");return}const it=CampaignRegistry.get(rt);it&&(nt++,et.set("campaign_step_index",nt),nt>=it.steps.length?this.quitCampaign():this.loadCurrentStep(it,nt))}retryCurrentStep(){const et=SharedSession.getInstance(),rt=et.get("campaign_id"),nt=et.get("campaign_step_index");if(!rt||nt===void 0)return;const it=CampaignRegistry.get(rt);it&&(console.log(`[CampaignManager] Retrying step ${nt}`),et.clearSavableKeys(),et.set("campaign_id",rt),et.set("campaign_step_index",nt),this.loadCurrentStep(it,nt))}failCurrentStep(et){const nt=SharedSession.getInstance().get("campaign_id");if(!nt){console.error("No active campaign to fail."),this.quitCampaign();return}const it=CampaignRegistry.get(nt);if(it&&it.failFactory){console.log("[CampaignManager] Campaign Failed. Loading Fail State.");const at=it.failFactory(et);StateManager.getInstance().replace(at)}else console.warn("No failFactory defined for this campaign. Quitting."),this.quitCampaign()}quitCampaign(){const et=SharedSession.getInstance();et.clearSavableKeys(),et.set("campaign_id",null),et.set("campaign_step_index",0),console.log("[CampaignManager] Quitting to Menu."),StateManager.getInstance().replace(StateRegistry.create(StateId.DEV_MENU))}loadCurrentStep(et,rt){const nt=et.steps[rt];console.log(`[CampaignManager] Loading Step ${rt}: ${nt.name}`);const it=nt.factory(nt.config);StateManager.getInstance().replace(it,nt.loadingConfig)}}class Game1Controller extends BaseController{constructor(et){super(et,StateId.GAME_1)}takeDamage(){this.send("TAKE_DAMAGE",{amount:15})}async jumpToGame2(){const et=StateRegistry.create(StateId.GAME_2,{reset:!1});await StateManager.getInstance().replace(et)}async loadLevel(et){const rt=StateRegistry.create(StateId.GAME_1,{reset:!1,level:et});await StateManager.getInstance().replace(rt)}nextLevel(){CampaignManager.getInstance().completeCurrentStep()}failLevel(){CampaignManager.getInstance().failCurrentStep()}async resetLevel(){await SaveManager.getInstance().performLoad(this.QUICK_SAVE_KEY);const et=this.vm.currentLevel||Game1Level.Level1,rt=StateRegistry.create(StateId.GAME_1,{reset:!1,level:et});await StateManager.getInstance().replace(rt)}onKeyDown(et){InputManager.getInstance().isKeyAction(et.key,"PAUSE")&&this.openPauseMenu()}onWorkerEvent(et){et==="EXPLOSION_REQ"&&AudioManager.getInstance().play("sfx_explosion")}async openPauseMenu(){const et=StateManager.getInstance();et.getCurrentStateName()===this.stateName&&await et.push(StateRegistry.create(StateId.PAUSE_MENU))}}class BasePresenter{listeners=[];_sharedViews;constructor(){this._sharedViews=ViewWorkerManager.getInstance().sharedViews}get sharedView(){const et=this._sharedViews.get("main")||this._sharedViews.values().next().value;return et||new Float32Array(0)}getBuffer(et){return this._sharedViews.get(et)}setBuffers(et){this._sharedViews=et}subscribe(et){return this.listeners.push(et),()=>{this.listeners=this.listeners.filter(rt=>rt!==et)}}update(){this.notify()}notify(){for(let et=0;et<this.listeners.length;et++)this.listeners[et]()}}const Game1ViewMainSchema={HERO_X:0,HERO_Y:1,HERO_ROTATION:2,HERO_SCALE:3,HERO_HP_DISPLAY:4,HERO_FRAME:5,ACTIVE_ROCK_COUNT:6,BUFFER_SIZE:128},Game1ViewRocksSchema={START_INDEX:0,STRIDE:3,BUFFER_SIZE:3e3},Game1ViewSchema={main:Game1ViewMainSchema,rocks:Game1ViewRocksSchema};class Game1Presenter extends BasePresenter{get pos(){return{x:this.sharedView[Game1ViewMainSchema.HERO_X]||0,y:this.sharedView[Game1ViewMainSchema.HERO_Y]||0}}get hp(){return this.sharedView[Game1ViewMainSchema.HERO_HP_DISPLAY]||0}get entityCount(){return Math.floor(this.sharedView[Game1ViewMainSchema.ACTIVE_ROCK_COUNT]||0)}get heroVisuals(){return{x:this.sharedView[Game1ViewMainSchema.HERO_X]||0,y:this.sharedView[Game1ViewMainSchema.HERO_Y]||0,rotation:this.sharedView[Game1ViewMainSchema.HERO_ROTATION]||0,scale:this.sharedView[Game1ViewMainSchema.HERO_SCALE]||1,currentFrame:this.sharedView[Game1ViewMainSchema.HERO_FRAME]||0}}getRockViewData(et){const rt=this.getBuffer("rocks");if(!rt)return{x:0,y:0,rotation:0};const nt=et*Game1ViewRocksSchema.STRIDE;return{x:rt[nt]||0,y:rt[nt+1]||0,rotation:rt[nt+2]||0}}}var module$2={exports:{}},propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var tt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=tt,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var tt=requireReactPropTypesSecret();function et(){}function rt(){}return rt.resetWarningCache=et,factoryWithThrowingShims=function(){function nt(st,ot,lt,ht,dt,ut){if(ut!==tt){var ft=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ft.name="Invariant Violation",ft}}nt.isRequired=nt;function it(){return nt}var at={array:nt,bigint:nt,bool:nt,func:nt,number:nt,object:nt,string:nt,symbol:nt,any:nt,arrayOf:it,element:nt,elementType:nt,instanceOf:it,node:nt,objectOf:it,oneOf:it,oneOfType:it,shape:it,exact:it,checkPropTypes:rt,resetWarningCache:et};return at.PropTypes=at,at},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes.exports=requireFactoryWithThrowingShims()()),propTypes.exports}var propTypesExports=requirePropTypes();const k$1=getDefaultExportFromCjs$1(propTypesExports);function P(tt){return P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et},P(tt)}function E$1(tt){var et=(function(rt,nt){if(P(rt)!=="object"||rt===null)return rt;var it=rt[Symbol.toPrimitive];if(it!==void 0){var at=it.call(rt,nt);if(P(at)!=="object")return at;throw new TypeError("@@toPrimitive must return a primitive value.")}return(nt==="string"?String:Number)(rt)})(tt,"string");return P(et)==="symbol"?et:String(et)}function _$1(tt,et,rt){return(et=E$1(et))in tt?Object.defineProperty(tt,et,{value:rt,enumerable:!0,configurable:!0,writable:!0}):tt[et]=rt,tt}function C$1(tt,et){(et==null||et>tt.length)&&(et=tt.length);for(var rt=0,nt=new Array(et);rt<et;rt++)nt[rt]=tt[rt];return nt}function z$1(tt){return(function(et){if(Array.isArray(et))return C$1(et)})(tt)||(function(et){if(typeof Symbol<"u"&&et[Symbol.iterator]!=null||et["@@iterator"]!=null)return Array.from(et)})(tt)||(function(et,rt){if(et){if(typeof et=="string")return C$1(et,rt);var nt=Object.prototype.toString.call(et).slice(8,-1);return nt==="Object"&&et.constructor&&(nt=et.constructor.name),nt==="Map"||nt==="Set"?Array.from(et):nt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(nt)?C$1(et,rt):void 0}})(tt)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function N$1(tt,et){for(var rt=arguments.length,nt=new Array(rt>2?rt-2:0),it=2;it<rt;it++)nt[it-2]=arguments[it]}var T$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function I(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}var R$1=function(tt){return tt==null};function O$1(tt){var et=[];if(tt===void 0)return et;if(typeof tt=="string")et=tt.split(",");else if(typeof tt=="number")et=[tt];else if(Array.isArray(tt))et=z$1(tt);else{if(tt===null||P(tt)!=="object")return et;et=[tt&&tt?.x||0,tt&&tt?.y||0]}return et.filter((function(rt){return!R$1(rt)&&!isNaN(rt)})).map(Number)}function j(tt,et){if(tt.length!==et.length)return!1;for(var rt=0;rt<tt.length;rt++)if(tt[rt]!==et[rt])return!1;return!0}function L$1(tt){return tt instanceof Point$2||tt instanceof ObservablePoint}var D=["click","mousedown","mousemove","mouseout","mouseover","mouseup","mouseupoutside","tap","touchstart","touchmove","touchend","touchendoutside","pointercancel","pointerout","pointerover","pointertap","pointerdown","pointerup","pointerupoutside","pointermove","rightclick","rightdown","rightup","rightupoutside","touchcancel","touchendoutside","touchmove","touchstart"];function M$1(tt,et,rt){if(L$1(tt[et])&&L$1(rt))tt[et].copyFrom(rt);else if(L$1(tt[et])){var nt=O$1(rt);N$1(nt!==void 0&&nt.length>0&&nt.length<3,"The property `%s` is a `Point` and must be set to a comma-separated string of either coordinates, an array containing coordinates, or a Point.",et,JSON.stringify(rt),P(rt)),tt[et].set(nt.shift(),nt.shift())}else tt[et]=rt}var U,F=function(tt){var et,rt=tt;if(!Array.isArray(rt)){if(et=tt,Object.prototype.toString.call(et)!=="[object Object]")throw new Error("collection needs to be an Array or Object");rt=Object.keys(tt)}var nt={};return rt.forEach((function(it){nt[it]=!0})),function(it){return nt[it]!==void 0}},A$1=function(tt){return function(){return!tt.apply(void 0,arguments)}},Q="children",H=(_$1(U={},Q,!0),_$1(U,"parent",!0),_$1(U,"worldAlpha",!0),_$1(U,"worldTransform",!0),_$1(U,"worldVisible",!0),U),B$1={alpha:1,buttonMode:!1,cacheAsBitmap:!1,cursor:null,filterArea:null,filters:null,hitArea:null,interactive:!1,mask:null,pivot:0,position:0,renderable:!0,rotation:0,scale:1,skew:0,transform:null,visible:!0,x:0,y:0},W=function(tt,et){var rt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},nt=function(ot){return requestAnimationFrame((function(){var lt,ht;ot==null||(lt=ot.__reactpixi)===null||lt===void 0||(ht=lt.root)===null||ht===void 0||ht.emit("__REACT_PIXI_REQUEST_RENDER__")}))},it=function(ot,lt){if(rt.hasOwnProperty(ot))return N$1(lt.typeofs.some((function(ht){return P(rt[ot])===ht}))||lt.instanceofs.some((function(ht){return rt[ot]instanceof ht})),"".concat(tt," ").concat(ot," prop is invalid")),rt[ot]};if(rt.texture)return N$1(rt.texture instanceof Texture,"".concat(tt," texture needs to be typeof `Texture`")),rt.texture;var at=it("image",{typeofs:["string"],instanceofs:[HTMLImageElement]})||it("video",{typeofs:["string"],instanceofs:[HTMLVideoElement]})||it("source",{typeofs:["string","number"],instanceofs:[HTMLImageElement,HTMLVideoElement,HTMLCanvasElement,Texture]});N$1(!!at,"".concat(tt," could not get texture from props"));var st=Texture.from(at);return st.__reactpixi={root:et},st.once("update",nt),st.once("loaded",nt),st.valid&&nt(st),st},$=A$1(F([].concat(z$1(Object.keys(H)),z$1(D))));function V(tt,et,rt){var nt=!1;if(N$1(DisplayObject.prototype.isPrototypeOf(tt),"instance needs to be typeof `DisplayObject`, got `%s`",P(tt)),!rt.ignoreEvents)for(var it=typeof tt.removeListener=="function",at=typeof tt.on=="function",st=0;st<D.length;st++){var ot=D[st];et[ot]!==rt[ot]&&(nt=!0,typeof et[ot]=="function"&&it&&tt.removeListener(ot,et[ot]),typeof rt[ot]=="function"&&at&&tt.on(ot,rt[ot]))}var lt=Object.keys(rt||{});if(rt.overwriteProps){for(var ht=0;ht<lt.length;ht++){var dt=lt[ht];et[dt]!==rt[dt]&&(nt=!0,M$1(tt,dt,rt[dt]))}return nt}for(var ut=lt.filter($),ft=0;ft<ut.length;ft++){var mt=ut[ft],gt=rt[mt];rt[mt]!==et[mt]&&(nt=!0),gt!==void 0?M$1(tt,mt,gt):mt in B$1?(console.warn("setting default value: ".concat(mt,", from: ").concat(tt[mt]," to: ").concat(gt," for"),tt),nt=!0,M$1(tt,mt,B$1[mt])):console.warn("ignoring prop: ".concat(mt,", from ").concat(tt[mt]," to ").concat(gt," for"),tt)}return nt}var q=function(tt,et){var rt=et.text,nt=et.style;return new BitmapText(rt,nt)},X=function(){return new Container};function G(tt,et){if(tt==null)return{};var rt,nt,it=(function(st,ot){if(st==null)return{};var lt,ht,dt={},ut=Object.keys(st);for(ht=0;ht<ut.length;ht++)lt=ut[ht],ot.indexOf(lt)>=0||(dt[lt]=st[lt]);return dt})(tt,et);if(Object.getOwnPropertySymbols){var at=Object.getOwnPropertySymbols(tt);for(nt=0;nt<at.length;nt++)rt=at[nt],et.indexOf(rt)>=0||Object.prototype.propertyIsEnumerable.call(tt,rt)&&(it[rt]=tt[rt])}return it}var Y$2=["draw","geometry"],K=function(tt,et){var rt=et.geometry;N$1(!rt||rt instanceof Graphics,"Graphics geometry needs to be a `Graphics`");var nt=rt?new Graphics(rt.geometry):new Graphics;return nt.applyProps=function(it,at,st){var ot=st.draw;st.geometry;var lt=V(it,at,G(st,Y$2));return at.draw!==ot&&typeof ot=="function"&&(lt=!0,ot.call(nt,nt)),lt},nt},J=["image","texture"],Z=function(tt,et){var rt=et.leftWidth,nt=rt===void 0?10:rt,it=et.topHeight,at=it===void 0?10:it,st=et.rightWidth,ot=st===void 0?10:st,lt=et.bottomHeight,ht=lt===void 0?10:lt,dt=W("NineSlicePlane",tt,et),ut=new NineSlicePlane(dt,nt,at,ot,ht);return ut.applyProps=function(ft,mt,gt){var vt=gt.image,xt=gt.texture,wt=V(ft,mt,G(gt,J));return(vt||xt)&&(xt!==mt.texture&&(wt=!0),ft.texture=W("NineSlicePlane",tt,gt)),wt},ut};function ee(tt,et){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);et&&(nt=nt.filter((function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable}))),rt.push.apply(rt,nt)}return rt}function ne(tt){for(var et=1;et<arguments.length;et++){var rt=arguments[et]!=null?arguments[et]:{};et%2?ee(Object(rt),!0).forEach((function(nt){_$1(tt,nt,rt[nt])})):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):ee(Object(rt)).forEach((function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))}))}return tt}var te=function(tt,et){var rt=et.maxSize,nt=rt===void 0?1500:rt,it=et.batchSize,at=it===void 0?16384:it,st=et.autoResize,ot=st!==void 0&&st,lt=ne(ne({},{vertices:!1,scale:!0,position:!0,rotation:!0,uvs:!0,tint:!0}),et.properties||{}),ht=ne(ne({},{children:!1,texture:!1,baseTexture:!1}),et.destroyOptions||{}),dt=new ParticleContainer(nt,lt,at,ot);return dt.willUnmount=function(ut,ft,mt){ut.destroy(ht)},dt},re=["image","texture"],le=function(tt,et){var rt=new Sprite(W("Sprite",tt,et));return rt.applyProps=function(nt,it,at){var st=at.image,ot=at.texture,lt=V(nt,it,G(at,re));return(ot&&it.texture!==at.texture||st&&it.image!==at.image)&&(it.texture!==at.texture&&(lt=!0),nt.texture=W("Sprite",tt,at)),lt},rt},ae=["textures","isPlaying","initialFrame","images"],ie=function(tt,et){var rt=et.textures,nt=et.images,it=et.isPlaying,at=it===void 0||it,st=et.initialFrame,ot=function(ht){return ht.map((function(dt){return N$1(dt instanceof Texture||dt?.texture,"AnimationSprite texture needs to be an array of `Texture` or `{ texture: Texture, time:\n                number }`"),dt}))},lt=nt?AnimatedSprite.fromImages(nt):new AnimatedSprite(ot(rt));return lt[at?"gotoAndPlay":"gotoAndStop"](st||0),lt.applyProps=function(ht,dt,ut){var ft=ut.textures,mt=ut.isPlaying,gt=ut.initialFrame,vt=ut.images,xt=V(ht,dt,G(ut,ae));if(vt&&dt.images!==vt){for(var wt=[],At=0;At<vt.length;++At)wt.push(Texture.from(vt[At]));ht.textures=wt,xt=!0}if(ft&&dt.textures!==ft&&(ht.textures=ot(ft),xt=!0),mt!==dt.isPlaying||gt!==dt.initialFrame){var Tt=typeof gt=="number"?gt:lt.currentFrame||0;lt[mt?"gotoAndPlay":"gotoAndStop"](Tt),xt=!0}return xt},lt},oe=function(tt,et){var rt=et.text,nt=rt===void 0?"":rt,it=et.style,at=it===void 0?{}:it,st=et.isSprite,ot=new Text(nt,at);return st?(ot.updateText(),new Sprite(ot.texture)):ot},ue=["tileScale","tilePosition","image","texture"],se=function(tt,et){var rt=et.width,nt=rt===void 0?100:rt,it=et.height,at=it===void 0?100:it,st=W("TilingSprite",tt,et),ot=new TilingSprite(st,nt,at);return ot.applyProps=function(lt,ht,dt){var ut=dt.tileScale,ft=dt.tilePosition,mt=dt.image,gt=dt.texture,vt=V(lt,ht,G(dt,ue));if(ft){var xt,wt=O$1(ft);(xt=lt.tilePosition).set.apply(xt,z$1(wt)),vt=!j(O$1(ht.tilePosition),wt)||vt}if(ut){var At,Tt=O$1(ut);(At=lt.tileScale).set.apply(At,z$1(Tt)),vt=!j(O$1(ht.tileScale),Tt)||vt}return(mt||gt)&&(gt!==ht.texture&&(vt=!0),lt.texture=W("Sprite",tt,dt)),vt},ot},ce=["image","texture"],fe=function(tt,et){var rt=W("Mesh",tt,et),nt=et.vertices,it=et.uvs,at=et.indices,st=et.drawMode,ot=st===void 0?DRAW_MODES.TRIANGLES:st,lt=new SimpleMesh(rt,nt,it,at,ot);return lt.applyProps=function(ht,dt,ut){var ft=ut.image,mt=ut.texture,gt=V(ht,dt,G(ut,ce));return(ft||mt)&&(mt!==dt.texture&&(gt=!0),ht.texture=W("Mesh",tt,ut)),gt},lt},de=["image","texture"],pe=function(tt,et){var rt=W("SimpleRope",tt,et),nt=et.points,it=new SimpleRope(rt,nt);return it.applyProps=function(at,st,ot){var lt=ot.image,ht=ot.texture,dt=G(ot,de);N$1(Array.isArray(ot.points),"SimpleRope points needs to be %s","Array<Point>");var ut=V(at,st,dt);return(lt||ht)&&(ht!==st.texture&&(ut=!0),at.texture=W("SimpleRope",tt,ot)),ut},it},me=Object.freeze({__proto__:null,BitmapText:q,Container:X,Graphics:K,NineSlicePlane:Z,ParticleContainer:te,Sprite:le,Text:oe,TilingSprite:se,SimpleMesh:fe,SimpleRope:pe,AnimatedSprite:ie});function he(tt,et){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);et&&(nt=nt.filter((function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable}))),rt.push.apply(rt,nt)}return rt}function ge(tt){for(var et=1;et<arguments.length;et++){var rt=arguments[et]!=null?arguments[et]:{};et%2?he(Object(rt),!0).forEach((function(nt){_$1(tt,nt,rt[nt])})):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):he(Object(rt)).forEach((function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))}))}return tt}var ve={BitmapText:"BitmapText",Container:"Container",Graphics:"Graphics",NineSlicePlane:"NineSlicePlane",ParticleContainer:"ParticleContainer",Sprite:"Sprite",AnimatedSprite:"AnimatedSprite",Text:"Text",TilingSprite:"TilingSprite",SimpleMesh:"SimpleMesh",SimpleRope:"SimpleRope"},ye=Object.keys(ve).reduce((function(tt,et){return ge(ge({},tt),{},_$1({},et,me[et]))}),{}),be={};function Se(tt,et){return N$1(!!tt,"Expect type to be defined, got `%s`",tt),N$1(!ve[tt],"Component `%s` could not be created, already exists in default components.",tt),be[tt]=et,tt}var xe,we,ke,Pe,Ee={},_e={},Ce={get exports(){return _e},set exports(tt){_e=tt}},ze={};function Ne(){return we||(we=1,Ce.exports=(xe||(xe=1,(function(tt){function et(Ft,Wt){var Yt=Ft.length;Ft.push(Wt);e:for(;0<Yt;){var zt=Yt-1>>>1,er=Ft[zt];if(!(0<it(er,Wt)))break e;Ft[zt]=Wt,Ft[Yt]=er,Yt=zt}}function rt(Ft){return Ft.length===0?null:Ft[0]}function nt(Ft){if(Ft.length===0)return null;var Wt=Ft[0],Yt=Ft.pop();if(Yt!==Wt){Ft[0]=Yt;e:for(var zt=0,er=Ft.length,dr=er>>>1;zt<dr;){var fr=2*(zt+1)-1,lr=Ft[fr],mr=fr+1,br=Ft[mr];if(0>it(lr,Yt))mr<er&&0>it(br,lr)?(Ft[zt]=br,Ft[mr]=Yt,zt=mr):(Ft[zt]=lr,Ft[fr]=Yt,zt=fr);else{if(!(mr<er&&0>it(br,Yt)))break e;Ft[zt]=br,Ft[mr]=Yt,zt=mr}}}return Wt}function it(Ft,Wt){var Yt=Ft.sortIndex-Wt.sortIndex;return Yt!==0?Yt:Ft.id-Wt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var at=performance;tt.unstable_now=function(){return at.now()}}else{var st=Date,ot=st.now();tt.unstable_now=function(){return st.now()-ot}}var lt=[],ht=[],dt=1,ut=null,ft=3,mt=!1,gt=!1,vt=!1,xt=typeof setTimeout=="function"?setTimeout:null,wt=typeof clearTimeout=="function"?clearTimeout:null,At=typeof setImmediate<"u"?setImmediate:null;function Tt(Ft){for(var Wt=rt(ht);Wt!==null;){if(Wt.callback===null)nt(ht);else{if(!(Wt.startTime<=Ft))break;nt(ht),Wt.sortIndex=Wt.expirationTime,et(lt,Wt)}Wt=rt(ht)}}function Pt(Ft){if(vt=!1,Tt(Ft),!gt)if(rt(lt)!==null)gt=!0,Bt(Rt);else{var Wt=rt(ht);Wt!==null&&Xt(Pt,Wt.startTime-Ft)}}function Rt(Ft,Wt){gt=!1,vt&&(vt=!1,wt(kt),kt=-1),mt=!0;var Yt=ft;try{for(Tt(Wt),ut=rt(lt);ut!==null&&(!(ut.expirationTime>Wt)||Ft&&!$t());){var zt=ut.callback;if(typeof zt=="function"){ut.callback=null,ft=ut.priorityLevel;var er=zt(ut.expirationTime<=Wt);Wt=tt.unstable_now(),typeof er=="function"?ut.callback=er:ut===rt(lt)&&nt(lt),Tt(Wt)}else nt(lt);ut=rt(lt)}if(ut!==null)var dr=!0;else{var fr=rt(ht);fr!==null&&Xt(Pt,fr.startTime-Wt),dr=!1}return dr}finally{ut=null,ft=Yt,mt=!1}}typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var Ot,Et=!1,Lt=null,kt=-1,jt=5,Mt=-1;function $t(){return!(tt.unstable_now()-Mt<jt)}function Qt(){if(Lt!==null){var Ft=tt.unstable_now();Mt=Ft;var Wt=!0;try{Wt=Lt(!0,Ft)}finally{Wt?Ot():(Et=!1,Lt=null)}}else Et=!1}if(typeof At=="function")Ot=function(){At(Qt)};else if(typeof MessageChannel<"u"){var Ht=new MessageChannel,qt=Ht.port2;Ht.port1.onmessage=Qt,Ot=function(){qt.postMessage(null)}}else Ot=function(){xt(Qt,0)};function Bt(Ft){Lt=Ft,Et||(Et=!0,Ot())}function Xt(Ft,Wt){kt=xt((function(){Ft(tt.unstable_now())}),Wt)}tt.unstable_IdlePriority=5,tt.unstable_ImmediatePriority=1,tt.unstable_LowPriority=4,tt.unstable_NormalPriority=3,tt.unstable_Profiling=null,tt.unstable_UserBlockingPriority=2,tt.unstable_cancelCallback=function(Ft){Ft.callback=null},tt.unstable_continueExecution=function(){gt||mt||(gt=!0,Bt(Rt))},tt.unstable_forceFrameRate=function(Ft){0>Ft||125<Ft?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):jt=0<Ft?Math.floor(1e3/Ft):5},tt.unstable_getCurrentPriorityLevel=function(){return ft},tt.unstable_getFirstCallbackNode=function(){return rt(lt)},tt.unstable_next=function(Ft){switch(ft){case 1:case 2:case 3:var Wt=3;break;default:Wt=ft}var Yt=ft;ft=Wt;try{return Ft()}finally{ft=Yt}},tt.unstable_pauseExecution=function(){},tt.unstable_requestPaint=function(){},tt.unstable_runWithPriority=function(Ft,Wt){switch(Ft){case 1:case 2:case 3:case 4:case 5:break;default:Ft=3}var Yt=ft;ft=Ft;try{return Wt()}finally{ft=Yt}},tt.unstable_scheduleCallback=function(Ft,Wt,Yt){var zt=tt.unstable_now();switch(Yt=typeof Yt=="object"&&Yt!==null&&typeof(Yt=Yt.delay)=="number"&&0<Yt?zt+Yt:zt,Ft){case 1:var er=-1;break;case 2:er=250;break;case 5:er=1073741823;break;case 4:er=1e4;break;default:er=5e3}return Ft={id:dt++,callback:Wt,priorityLevel:Ft,startTime:Yt,expirationTime:er=Yt+er,sortIndex:-1},Yt>zt?(Ft.sortIndex=Yt,et(ht,Ft),rt(lt)===null&&Ft===rt(ht)&&(vt?(wt(kt),kt=-1):vt=!0,Xt(Pt,Yt-zt))):(Ft.sortIndex=er,et(lt,Ft),gt||mt||(gt=!0,Bt(Rt))),Ft},tt.unstable_shouldYield=$t,tt.unstable_wrapCallback=function(Ft){var Wt=ft;return function(){var Yt=ft;ft=Wt;try{return Ft.apply(this,arguments)}finally{ft=Yt}}}})(ze)),ze)),_e}function Te(){return Pe||(Pe=1,ke=function(tt){var et={},rt=React,nt=Ne(),it=Object.assign;function at(_t){for(var yt="https://reactjs.org/docs/error-decoder.html?invariant="+_t,Ct=1;Ct<arguments.length;Ct++)yt+="&args[]="+encodeURIComponent(arguments[Ct]);return"Minified React error #"+_t+"; visit "+yt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var st=rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ot=Symbol.for("react.element"),lt=Symbol.for("react.portal"),ht=Symbol.for("react.fragment"),dt=Symbol.for("react.strict_mode"),ut=Symbol.for("react.profiler"),ft=Symbol.for("react.provider"),mt=Symbol.for("react.context"),gt=Symbol.for("react.forward_ref"),vt=Symbol.for("react.suspense"),xt=Symbol.for("react.suspense_list"),wt=Symbol.for("react.memo"),At=Symbol.for("react.lazy"),Tt=Symbol.for("react.offscreen"),Pt=Symbol.iterator;function Rt(_t){return _t===null||typeof _t!="object"?null:typeof(_t=Pt&&_t[Pt]||_t["@@iterator"])=="function"?_t:null}function Ot(_t){if(_t==null)return null;if(typeof _t=="function")return _t.displayName||_t.name||null;if(typeof _t=="string")return _t;switch(_t){case ht:return"Fragment";case lt:return"Portal";case ut:return"Profiler";case dt:return"StrictMode";case vt:return"Suspense";case xt:return"SuspenseList"}if(typeof _t=="object")switch(_t.$$typeof){case mt:return(_t.displayName||"Context")+".Consumer";case ft:return(_t._context.displayName||"Context")+".Provider";case gt:var yt=_t.render;return(_t=_t.displayName)||(_t=(_t=yt.displayName||yt.name||"")!==""?"ForwardRef("+_t+")":"ForwardRef"),_t;case wt:return(yt=_t.displayName||null)!==null?yt:Ot(_t.type)||"Memo";case At:yt=_t._payload,_t=_t._init;try{return Ot(_t(yt))}catch{}}return null}function Et(_t){var yt=_t.type;switch(_t.tag){case 24:return"Cache";case 9:return(yt.displayName||"Context")+".Consumer";case 10:return(yt._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _t=(_t=yt.render).displayName||_t.name||"",yt.displayName||(_t!==""?"ForwardRef("+_t+")":"ForwardRef");case 7:return"Fragment";case 5:return yt;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ot(yt);case 8:return yt===dt?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof yt=="function")return yt.displayName||yt.name||null;if(typeof yt=="string")return yt}return null}function Lt(_t){var yt=_t,Ct=_t;if(_t.alternate)for(;yt.return;)yt=yt.return;else{_t=yt;do(4098&(yt=_t).flags)!=0&&(Ct=yt.return),_t=yt.return;while(_t)}return yt.tag===3?Ct:null}function kt(_t){if(Lt(_t)!==_t)throw Error(at(188))}function jt(_t){var yt=_t.alternate;if(!yt){if((yt=Lt(_t))===null)throw Error(at(188));return yt!==_t?null:_t}for(var Ct=_t,Vt=yt;;){var tr=Ct.return;if(tr===null)break;var vr=tr.alternate;if(vr===null){if((Vt=tr.return)!==null){Ct=Vt;continue}break}if(tr.child===vr.child){for(vr=tr.child;vr;){if(vr===Ct)return kt(tr),_t;if(vr===Vt)return kt(tr),yt;vr=vr.sibling}throw Error(at(188))}if(Ct.return!==Vt.return)Ct=tr,Vt=vr;else{for(var Cr=!1,Vr=tr.child;Vr;){if(Vr===Ct){Cr=!0,Ct=tr,Vt=vr;break}if(Vr===Vt){Cr=!0,Vt=tr,Ct=vr;break}Vr=Vr.sibling}if(!Cr){for(Vr=vr.child;Vr;){if(Vr===Ct){Cr=!0,Ct=vr,Vt=tr;break}if(Vr===Vt){Cr=!0,Vt=vr,Ct=tr;break}Vr=Vr.sibling}if(!Cr)throw Error(at(189))}}if(Ct.alternate!==Vt)throw Error(at(190))}if(Ct.tag!==3)throw Error(at(188));return Ct.stateNode.current===Ct?_t:yt}function Mt(_t){return(_t=jt(_t))!==null?$t(_t):null}function $t(_t){if(_t.tag===5||_t.tag===6)return _t;for(_t=_t.child;_t!==null;){var yt=$t(_t);if(yt!==null)return yt;_t=_t.sibling}return null}function Qt(_t){if(_t.tag===5||_t.tag===6)return _t;for(_t=_t.child;_t!==null;){if(_t.tag!==4){var yt=Qt(_t);if(yt!==null)return yt}_t=_t.sibling}return null}var Ht,qt=Array.isArray,Bt=tt.getPublicInstance,Xt=tt.getRootHostContext,Ft=tt.getChildHostContext,Wt=tt.prepareForCommit,Yt=tt.resetAfterCommit,zt=tt.createInstance,er=tt.appendInitialChild,dr=tt.finalizeInitialChildren,fr=tt.prepareUpdate,lr=tt.shouldSetTextContent,mr=tt.createTextInstance,br=tt.scheduleTimeout,Sr=tt.cancelTimeout,Ir=tt.noTimeout,cr=tt.isPrimaryRenderer,Nt=tt.supportsMutation,pr=tt.supportsPersistence,rr=tt.supportsHydration,ar=tt.getInstanceFromNode,nr=tt.preparePortalMount,ur=tt.getCurrentEventPriority,Er=tt.detachDeletedInstance,Ut=tt.supportsMicrotasks,Kt=tt.scheduleMicrotask,or=tt.supportsTestSelectors,hr=tt.findFiberRoot,kr=tt.getBoundingRect,Br=tt.getTextContent,Gn=tt.isHiddenSubtree,Xn=tt.matchAccessibilityRole,Mn=tt.setFocusIfFocusable,Kn=tt.setupIntersectionObserver,Vn=tt.appendChild,vi=tt.appendChildToContainer,mi=tt.commitTextUpdate,_i=tt.commitMount,Ri=tt.commitUpdate,pi=tt.insertBefore,Tr=tt.insertInContainerBefore,qn=tt.removeChild,_r=tt.removeChildFromContainer,Rr=tt.resetTextContent,yr=tt.hideInstance,Kr=tt.hideTextInstance,Jr=tt.unhideInstance,Zt=tt.unhideTextInstance,Qr=tt.clearContainer,Dr=tt.cloneInstance,Pr=tt.createContainerChildSet,Hr=tt.appendChildToContainerChildSet,qr=tt.finalizeContainerChildren,bi=tt.replaceContainerChildren,ri=tt.cloneHiddenInstance,yi=tt.cloneHiddenTextInstance,Li=tt.canHydrateInstance,xa=tt.canHydrateTextInstance,Ti=tt.canHydrateSuspenseInstance,$i=tt.isSuspenseInstancePending,Ji=tt.isSuspenseInstanceFallback,ea=tt.getSuspenseInstanceFallbackErrorDetails,Na=tt.registerSuspenseInstanceRetry,Oa=tt.getNextHydratableSibling,la=tt.getFirstHydratableChild,ua=tt.getFirstHydratableChildWithinContainer,ka=tt.getFirstHydratableChildWithinSuspenseInstance,Xi=tt.hydrateInstance,ca=tt.hydrateTextInstance,_a=tt.hydrateSuspenseInstance,Ua=tt.getNextHydratableInstanceAfterSuspenseInstance,Es=tt.commitHydratedContainer,is=tt.commitHydratedSuspenseInstance,zo=tt.clearSuspenseBoundary,Xs=tt.clearSuspenseBoundaryFromContainer,wa=tt.shouldDeleteUnhydratedTailInstances,Qs=tt.didNotMatchHydratedContainerTextInstance,ta=tt.didNotMatchHydratedTextInstance;function Il(_t){if(Ht===void 0)try{throw Error()}catch(Ct){var yt=Ct.stack.trim().match(/\n( *(at )?)/);Ht=yt&&yt[1]||""}return`
`+Ht+_t}var Ks=!1;function ol(_t,yt){if(!_t||Ks)return"";Ks=!0;var Ct=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(yt)if(yt=function(){throw Error()},Object.defineProperty(yt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(yt,[])}catch(Yn){var Vt=Yn}Reflect.construct(_t,[],yt)}else{try{yt.call()}catch(Yn){Vt=Yn}_t.call(yt.prototype)}else{try{throw Error()}catch(Yn){Vt=Yn}_t()}}catch(Yn){if(Yn&&Vt&&typeof Yn.stack=="string"){for(var tr=Yn.stack.split(`
`),vr=Vt.stack.split(`
`),Cr=tr.length-1,Vr=vr.length-1;1<=Cr&&0<=Vr&&tr[Cr]!==vr[Vr];)Vr--;for(;1<=Cr&&0<=Vr;Cr--,Vr--)if(tr[Cr]!==vr[Vr]){if(Cr!==1||Vr!==1)do if(Cr--,0>--Vr||tr[Cr]!==vr[Vr]){var Un=`
`+tr[Cr].replace(" at new "," at ");return _t.displayName&&Un.includes("<anonymous>")&&(Un=Un.replace("<anonymous>",_t.displayName)),Un}while(1<=Cr&&0<=Vr);break}}}finally{Ks=!1,Error.prepareStackTrace=Ct}return(_t=_t?_t.displayName||_t.name:"")?Il(_t):""}var Pl=Object.prototype.hasOwnProperty,au=[],Ss=-1;function Ps(_t){return{current:_t}}function qi(_t){0>Ss||(_t.current=au[Ss],au[Ss]=null,Ss--)}function pa(_t,yt){Ss++,au[Ss]=_t.current,_t.current=yt}var Fi={},Za=Ps(Fi),ls=Ps(!1),Js=Fi;function Ts(_t,yt){var Ct=_t.type.contextTypes;if(!Ct)return Fi;var Vt=_t.stateNode;if(Vt&&Vt.__reactInternalMemoizedUnmaskedChildContext===yt)return Vt.__reactInternalMemoizedMaskedChildContext;var tr,vr={};for(tr in Ct)vr[tr]=yt[tr];return Vt&&((_t=_t.stateNode).__reactInternalMemoizedUnmaskedChildContext=yt,_t.__reactInternalMemoizedMaskedChildContext=vr),vr}function Ya(_t){return(_t=_t.childContextTypes)!=null}function jo(){qi(ls),qi(Za)}function Cl(_t,yt,Ct){if(Za.current!==Fi)throw Error(at(168));pa(Za,yt),pa(ls,Ct)}function ma(_t,yt,Ct){var Vt=_t.stateNode;if(yt=yt.childContextTypes,typeof Vt.getChildContext!="function")return Ct;for(var tr in Vt=Vt.getChildContext())if(!(tr in yt))throw Error(at(108,Et(_t)||"Unknown",tr));return it({},Ct,Vt)}function Go(_t){return _t=(_t=_t.stateNode)&&_t.__reactInternalMemoizedMergedChildContext||Fi,Js=Za.current,pa(Za,_t),pa(ls,ls.current),!0}function Ho(_t,yt,Ct){var Vt=_t.stateNode;if(!Vt)throw Error(at(169));Ct?(_t=ma(_t,yt,Js),Vt.__reactInternalMemoizedMergedChildContext=_t,qi(ls),qi(Za),pa(Za,_t)):qi(ls),pa(ls,Ct)}var Xa=Math.clz32?Math.clz32:function(_t){return(_t>>>=0)===0?32:31-(su(_t)/ll|0)|0},su=Math.log,ll=Math.LN2,Ml=64,kl=4194304;function Zi(_t){switch(_t&-_t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&_t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&_t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _t}}function Ol(_t,yt){var Ct=_t.pendingLanes;if(Ct===0)return 0;var Vt=0,tr=_t.suspendedLanes,vr=_t.pingedLanes,Cr=268435455&Ct;if(Cr!==0){var Vr=Cr&~tr;Vr!==0?Vt=Zi(Vr):(vr&=Cr)!==0&&(Vt=Zi(vr))}else(Cr=Ct&~tr)!==0?Vt=Zi(Cr):vr!==0&&(Vt=Zi(vr));if(Vt===0)return 0;if(yt!==0&&yt!==Vt&&(yt&tr)==0&&((tr=Vt&-Vt)>=(vr=yt&-yt)||tr===16&&(4194240&vr)!=0))return yt;if((4&Vt)!=0&&(Vt|=16&Ct),(yt=_t.entangledLanes)!==0)for(_t=_t.entanglements,yt&=Vt;0<yt;)tr=1<<(Ct=31-Xa(yt)),Vt|=_t[Ct],yt&=~tr;return Vt}function Fc(_t,yt){switch(_t){case 1:case 2:case 4:return yt+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return yt+5e3;default:return-1}}function Yi(_t){return(_t=-1073741825&_t.pendingLanes)!==0?_t:1073741824&_t?1073741824:0}function Pu(){var _t=Ml;return(4194240&(Ml<<=1))==0&&(Ml=64),_t}function Cu(_t){for(var yt=[],Ct=0;31>Ct;Ct++)yt.push(_t);return yt}function Bl(_t,yt,Ct){_t.pendingLanes|=yt,yt!==536870912&&(_t.suspendedLanes=0,_t.pingedLanes=0),(_t=_t.eventTimes)[yt=31-Xa(yt)]=Ct}function Qa(_t,yt){var Ct=_t.entangledLanes|=yt;for(_t=_t.entanglements;Ct;){var Vt=31-Xa(Ct),tr=1<<Vt;tr&yt|_t[Vt]&yt&&(_t[Vt]|=yt),Ct&=~tr}}var Gi=0;function Cs(_t){return 1<(_t&=-_t)?4<_t?(268435455&_t)!=0?16:536870912:4:1}var Ka=nt.unstable_scheduleCallback,eo=nt.unstable_cancelCallback,Dl=nt.unstable_shouldYield,Pa=nt.unstable_requestPaint,Qi=nt.unstable_now,ul=nt.unstable_ImmediatePriority,Ll=nt.unstable_UserBlockingPriority,Vo=nt.unstable_NormalPriority,Wo=nt.unstable_IdlePriority,ou=null,Ca=null,ps=typeof Object.is=="function"?Object.is:function(_t,yt){return _t===yt&&(_t!==0||1/_t==1/yt)||_t!=_t&&yt!=yt},ro=null,no=!1,zs=!1;function Po(_t){ro===null?ro=[_t]:ro.push(_t)}function ms(){if(!zs&&ro!==null){zs=!0;var _t=0,yt=Gi;try{var Ct=ro;for(Gi=1;_t<Ct.length;_t++){var Vt=Ct[_t];do Vt=Vt(!0);while(Vt!==null)}ro=null,no=!1}catch(tr){throw ro!==null&&(ro=ro.slice(_t+1)),Ka(ul,ms),tr}finally{Gi=yt,zs=!1}}return null}var Fl=[],io=0,Nl=null,cl=0,Ja=[],as=0,ss=null,Ms=1,ks="";function qo(_t,yt){Fl[io++]=cl,Fl[io++]=Nl,Nl=_t,cl=yt}function hl(_t,yt,Ct){Ja[as++]=Ms,Ja[as++]=ks,Ja[as++]=ss,ss=_t;var Vt=Ms;_t=ks;var tr=32-Xa(Vt)-1;Vt&=~(1<<tr),Ct+=1;var vr=32-Xa(yt)+tr;if(30<vr){var Cr=tr-tr%5;vr=(Vt&(1<<Cr)-1).toString(32),Vt>>=Cr,tr-=Cr,Ms=1<<32-Xa(yt)+tr|Ct<<tr|Vt,ks=vr+_t}else Ms=1<<vr|Ct<<tr|Vt,ks=_t}function Zo(_t){_t.return!==null&&(qo(_t,1),hl(_t,1,0))}function lu(_t){for(;_t===Nl;)Nl=Fl[--io],Fl[io]=null,cl=Fl[--io],Fl[io]=null;for(;_t===ss;)ss=Ja[--as],Ja[as]=null,ks=Ja[--as],Ja[as]=null,Ms=Ja[--as],Ja[as]=null}var ha=null,Ba=null,ia=!1,ao=!1,js=null;function Co(_t,yt){var Ct=Zs(5,null,null,0);Ct.elementType="DELETED",Ct.stateNode=yt,Ct.return=_t,(yt=_t.deletions)===null?(_t.deletions=[Ct],_t.flags|=16):yt.push(Ct)}function Ul(_t,yt){switch(_t.tag){case 5:return(yt=Li(yt,_t.type,_t.pendingProps))!==null&&(_t.stateNode=yt,ha=_t,Ba=la(yt),!0);case 6:return(yt=xa(yt,_t.pendingProps))!==null&&(_t.stateNode=yt,ha=_t,Ba=null,!0);case 13:if((yt=Ti(yt))!==null){var Ct=ss!==null?{id:Ms,overflow:ks}:null;return _t.memoizedState={dehydrated:yt,treeContext:Ct,retryLane:1073741824},(Ct=Zs(18,null,null,0)).stateNode=yt,Ct.return=_t,_t.child=Ct,ha=_t,Ba=null,!0}return!1;default:return!1}}function Mo(_t){return(1&_t.mode)!=0&&(128&_t.flags)==0}function Yo(_t){if(ia){var yt=Ba;if(yt){var Ct=yt;if(!Ul(_t,yt)){if(Mo(_t))throw Error(at(418));yt=Oa(Ct);var Vt=ha;yt&&Ul(_t,yt)?Co(Vt,Ct):(_t.flags=-4097&_t.flags|2,ia=!1,ha=_t)}}else{if(Mo(_t))throw Error(at(418));_t.flags=-4097&_t.flags|2,ia=!1,ha=_t}}}function uu(_t){for(_t=_t.return;_t!==null&&_t.tag!==5&&_t.tag!==3&&_t.tag!==13;)_t=_t.return;ha=_t}function $a(_t){if(!rr||_t!==ha)return!1;if(!ia)return uu(_t),ia=!0,!1;if(_t.tag!==3&&(_t.tag!==5||wa(_t.type)&&!lr(_t.type,_t.memoizedProps))){var yt=Ba;if(yt){if(Mo(_t))throw $l(),Error(at(418));for(;yt;)Co(_t,yt),yt=Oa(yt)}}if(uu(_t),_t.tag===13){if(!rr)throw Error(at(316));if(!(_t=(_t=_t.memoizedState)!==null?_t.dehydrated:null))throw Error(at(317));Ba=Ua(_t)}else Ba=ha?Oa(_t.stateNode):null;return!0}function $l(){for(var _t=Ba;_t;)_t=Oa(_t)}function so(){rr&&(Ba=ha=null,ao=ia=!1)}function zl(_t){js===null?js=[_t]:js.push(_t)}var Mu=st.ReactCurrentBatchConfig;function cu(_t,yt){if(ps(_t,yt))return!0;if(typeof _t!="object"||_t===null||typeof yt!="object"||yt===null)return!1;var Ct=Object.keys(_t),Vt=Object.keys(yt);if(Ct.length!==Vt.length)return!1;for(Vt=0;Vt<Ct.length;Vt++){var tr=Ct[Vt];if(!Pl.call(yt,tr)||!ps(_t[tr],yt[tr]))return!1}return!0}function Nc(_t){switch(_t.tag){case 5:return Il(_t.type);case 16:return Il("Lazy");case 13:return Il("Suspense");case 19:return Il("SuspenseList");case 0:case 2:case 15:return _t=ol(_t.type,!1);case 11:return _t=ol(_t.type.render,!1);case 1:return _t=ol(_t.type,!0);default:return""}}function gs(_t,yt){if(_t&&_t.defaultProps){for(var Ct in yt=it({},yt),_t=_t.defaultProps)yt[Ct]===void 0&&(yt[Ct]=_t[Ct]);return yt}return yt}var jl=Ps(null),Gs=null,Xo=null,hu=null;function Gl(){hu=Xo=Gs=null}function ku(_t,yt,Ct){cr?(pa(jl,yt._currentValue),yt._currentValue=Ct):(pa(jl,yt._currentValue2),yt._currentValue2=Ct)}function Hl(_t){var yt=jl.current;qi(jl),cr?_t._currentValue=yt:_t._currentValue2=yt}function oc(_t,yt,Ct){for(;_t!==null;){var Vt=_t.alternate;if((_t.childLanes&yt)!==yt?(_t.childLanes|=yt,Vt!==null&&(Vt.childLanes|=yt)):Vt!==null&&(Vt.childLanes&yt)!==yt&&(Vt.childLanes|=yt),_t===Ct)break;_t=_t.return}}function Qo(_t,yt){Gs=_t,hu=Xo=null,(_t=_t.dependencies)!==null&&_t.firstContext!==null&&((_t.lanes&yt)!=0&&(La=!0),_t.firstContext=null)}function us(_t){var yt=cr?_t._currentValue:_t._currentValue2;if(hu!==_t)if(_t={context:_t,memoizedValue:yt,next:null},Xo===null){if(Gs===null)throw Error(at(308));Xo=_t,Gs.dependencies={lanes:0,firstContext:_t}}else Xo=Xo.next=_t;return yt}var Ko=null;function du(_t){Ko===null?Ko=[_t]:Ko.push(_t)}function Ou(_t,yt,Ct,Vt){var tr=yt.interleaved;return tr===null?(Ct.next=Ct,du(yt)):(Ct.next=tr.next,tr.next=Ct),yt.interleaved=Ct,oo(_t,Vt)}function oo(_t,yt){_t.lanes|=yt;var Ct=_t.alternate;for(Ct!==null&&(Ct.lanes|=yt),Ct=_t,_t=_t.return;_t!==null;)_t.childLanes|=yt,(Ct=_t.alternate)!==null&&(Ct.childLanes|=yt),Ct=_t,_t=_t.return;return Ct.tag===3?Ct.stateNode:null}var ko=!1;function lc(_t){_t.updateQueue={baseState:_t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uc(_t,yt){_t=_t.updateQueue,yt.updateQueue===_t&&(yt.updateQueue={baseState:_t.baseState,firstBaseUpdate:_t.firstBaseUpdate,lastBaseUpdate:_t.lastBaseUpdate,shared:_t.shared,effects:_t.effects})}function lo(_t,yt){return{eventTime:_t,lane:yt,tag:0,payload:null,callback:null,next:null}}function uo(_t,yt,Ct){var Vt=_t.updateQueue;if(Vt===null)return null;if(Vt=Vt.shared,(2&Hi)!=0){var tr=Vt.pending;return tr===null?yt.next=yt:(yt.next=tr.next,tr.next=yt),Vt.pending=yt,oo(_t,Ct)}return(tr=Vt.interleaved)===null?(yt.next=yt,du(Vt)):(yt.next=tr.next,tr.next=yt),Vt.interleaved=yt,oo(_t,Ct)}function Oo(_t,yt,Ct){if((yt=yt.updateQueue)!==null&&(yt=yt.shared,(4194240&Ct)!=0)){var Vt=yt.lanes;Ct|=Vt&=_t.pendingLanes,yt.lanes=Ct,Qa(_t,Ct)}}function Bu(_t,yt){var Ct=_t.updateQueue,Vt=_t.alternate;if(Vt!==null&&Ct===(Vt=Vt.updateQueue)){var tr=null,vr=null;if((Ct=Ct.firstBaseUpdate)!==null){do{var Cr={eventTime:Ct.eventTime,lane:Ct.lane,tag:Ct.tag,payload:Ct.payload,callback:Ct.callback,next:null};vr===null?tr=vr=Cr:vr=vr.next=Cr,Ct=Ct.next}while(Ct!==null);vr===null?tr=vr=yt:vr=vr.next=yt}else tr=vr=yt;return Ct={baseState:Vt.baseState,firstBaseUpdate:tr,lastBaseUpdate:vr,shared:Vt.shared,effects:Vt.effects},void(_t.updateQueue=Ct)}(_t=Ct.lastBaseUpdate)===null?Ct.firstBaseUpdate=yt:_t.next=yt,Ct.lastBaseUpdate=yt}function Vl(_t,yt,Ct,Vt){var tr=_t.updateQueue;ko=!1;var vr=tr.firstBaseUpdate,Cr=tr.lastBaseUpdate,Vr=tr.shared.pending;if(Vr!==null){tr.shared.pending=null;var Un=Vr,Yn=Un.next;Un.next=null,Cr===null?vr=Yn:Cr.next=Yn,Cr=Un;var ei=_t.alternate;ei!==null&&(Vr=(ei=ei.updateQueue).lastBaseUpdate)!==Cr&&(Vr===null?ei.firstBaseUpdate=Yn:Vr.next=Yn,ei.lastBaseUpdate=Un)}if(vr!==null){var xi=tr.baseState;for(Cr=0,ei=Yn=Un=null,Vr=vr;;){var Jn=Vr.lane,ui=Vr.eventTime;if((Vt&Jn)===Jn){ei!==null&&(ei=ei.next={eventTime:ui,lane:0,tag:Vr.tag,payload:Vr.payload,callback:Vr.callback,next:null});e:{var Ii=_t,Vi=Vr;switch(Jn=yt,ui=Ct,Vi.tag){case 1:if(typeof(Ii=Vi.payload)=="function"){xi=Ii.call(ui,xi,Jn);break e}xi=Ii;break e;case 3:Ii.flags=-65537&Ii.flags|128;case 0:if((Jn=typeof(Ii=Vi.payload)=="function"?Ii.call(ui,xi,Jn):Ii)==null)break e;xi=it({},xi,Jn);break e;case 2:ko=!0}}Vr.callback!==null&&Vr.lane!==0&&(_t.flags|=64,(Jn=tr.effects)===null?tr.effects=[Vr]:Jn.push(Vr))}else ui={eventTime:ui,lane:Jn,tag:Vr.tag,payload:Vr.payload,callback:Vr.callback,next:null},ei===null?(Yn=ei=ui,Un=xi):ei=ei.next=ui,Cr|=Jn;if((Vr=Vr.next)===null){if((Vr=tr.shared.pending)===null)break;Vr=(Jn=Vr).next,Jn.next=null,tr.lastBaseUpdate=Jn,tr.shared.pending=null}}if(ei===null&&(Un=xi),tr.baseState=Un,tr.firstBaseUpdate=Yn,tr.lastBaseUpdate=ei,(yt=tr.shared.interleaved)!==null){tr=yt;do Cr|=tr.lane,tr=tr.next;while(tr!==yt)}else vr===null&&(tr.shared.lanes=0);eu|=Cr,_t.lanes=Cr,_t.memoizedState=xi}}function Du(_t,yt,Ct){if(_t=yt.effects,yt.effects=null,_t!==null)for(yt=0;yt<_t.length;yt++){var Vt=_t[yt],tr=Vt.callback;if(tr!==null){if(Vt.callback=null,Vt=Ct,typeof tr!="function")throw Error(at(191,tr));tr.call(Vt)}}}var cc=new rt.Component().refs;function Lu(_t,yt,Ct,Vt){Ct=(Ct=Ct(Vt,yt=_t.memoizedState))==null?yt:it({},yt,Ct),_t.memoizedState=Ct,_t.lanes===0&&(_t.updateQueue.baseState=Ct)}var fu={isMounted:function(_t){return!!(_t=_t._reactInternals)&&Lt(_t)===_t},enqueueSetState:function(_t,yt,Ct){_t=_t._reactInternals;var Vt=ts(),tr=Ao(_t),vr=lo(Vt,tr);vr.payload=yt,Ct!=null&&(vr.callback=Ct),(yt=uo(_t,vr,tr))!==null&&(bs(yt,_t,tr,Vt),Oo(yt,_t,tr))},enqueueReplaceState:function(_t,yt,Ct){_t=_t._reactInternals;var Vt=ts(),tr=Ao(_t),vr=lo(Vt,tr);vr.tag=1,vr.payload=yt,Ct!=null&&(vr.callback=Ct),(yt=uo(_t,vr,tr))!==null&&(bs(yt,_t,tr,Vt),Oo(yt,_t,tr))},enqueueForceUpdate:function(_t,yt){_t=_t._reactInternals;var Ct=ts(),Vt=Ao(_t),tr=lo(Ct,Vt);tr.tag=2,yt!=null&&(tr.callback=yt),(yt=uo(_t,tr,Vt))!==null&&(bs(yt,_t,Vt,Ct),Oo(yt,_t,Vt))}};function co(_t,yt,Ct,Vt,tr,vr,Cr){return typeof(_t=_t.stateNode).shouldComponentUpdate=="function"?_t.shouldComponentUpdate(Vt,vr,Cr):!yt.prototype||!yt.prototype.isPureReactComponent||!cu(Ct,Vt)||!cu(tr,vr)}function ho(_t,yt,Ct){var Vt=!1,tr=Fi,vr=yt.contextType;return typeof vr=="object"&&vr!==null?vr=us(vr):(tr=Ya(yt)?Js:Za.current,vr=(Vt=(Vt=yt.contextTypes)!=null)?Ts(_t,tr):Fi),yt=new yt(Ct,vr),_t.memoizedState=yt.state!==null&&yt.state!==void 0?yt.state:null,yt.updater=fu,_t.stateNode=yt,yt._reactInternals=_t,Vt&&((_t=_t.stateNode).__reactInternalMemoizedUnmaskedChildContext=tr,_t.__reactInternalMemoizedMaskedChildContext=vr),yt}function Ma(_t,yt,Ct,Vt){_t=yt.state,typeof yt.componentWillReceiveProps=="function"&&yt.componentWillReceiveProps(Ct,Vt),typeof yt.UNSAFE_componentWillReceiveProps=="function"&&yt.UNSAFE_componentWillReceiveProps(Ct,Vt),yt.state!==_t&&fu.enqueueReplaceState(yt,yt.state,null)}function Wl(_t,yt,Ct,Vt){var tr=_t.stateNode;tr.props=Ct,tr.state=_t.memoizedState,tr.refs=cc,lc(_t);var vr=yt.contextType;typeof vr=="object"&&vr!==null?tr.context=us(vr):(vr=Ya(yt)?Js:Za.current,tr.context=Ts(_t,vr)),tr.state=_t.memoizedState,typeof(vr=yt.getDerivedStateFromProps)=="function"&&(Lu(_t,yt,vr,Ct),tr.state=_t.memoizedState),typeof yt.getDerivedStateFromProps=="function"||typeof tr.getSnapshotBeforeUpdate=="function"||typeof tr.UNSAFE_componentWillMount!="function"&&typeof tr.componentWillMount!="function"||(yt=tr.state,typeof tr.componentWillMount=="function"&&tr.componentWillMount(),typeof tr.UNSAFE_componentWillMount=="function"&&tr.UNSAFE_componentWillMount(),yt!==tr.state&&fu.enqueueReplaceState(tr,tr.state,null),Vl(_t,Ct,tr,Vt),tr.state=_t.memoizedState),typeof tr.componentDidMount=="function"&&(_t.flags|=4194308)}function Hs(_t,yt,Ct){if((_t=Ct.ref)!==null&&typeof _t!="function"&&typeof _t!="object"){if(Ct._owner){if(Ct=Ct._owner){if(Ct.tag!==1)throw Error(at(309));var Vt=Ct.stateNode}if(!Vt)throw Error(at(147,_t));var tr=Vt,vr=""+_t;return yt!==null&&yt.ref!==null&&typeof yt.ref=="function"&&yt.ref._stringRef===vr?yt.ref:(yt=function(Cr){var Vr=tr.refs;Vr===cc&&(Vr=tr.refs={}),Cr===null?delete Vr[vr]:Vr[vr]=Cr},yt._stringRef=vr,yt)}if(typeof _t!="string")throw Error(at(284));if(!Ct._owner)throw Error(at(290,_t))}return _t}function pu(_t,yt){throw _t=Object.prototype.toString.call(yt),Error(at(31,_t==="[object Object]"?"object with keys {"+Object.keys(yt).join(", ")+"}":_t))}function Jo(_t){return(0,_t._init)(_t._payload)}function dl(_t){function yt(ti,Xr){if(_t){var Wn=ti.deletions;Wn===null?(ti.deletions=[Xr],ti.flags|=16):Wn.push(Xr)}}function Ct(ti,Xr){if(!_t)return null;for(;Xr!==null;)yt(ti,Xr),Xr=Xr.sibling;return null}function Vt(ti,Xr){for(ti=new Map;Xr!==null;)Xr.key!==null?ti.set(Xr.key,Xr):ti.set(Xr.index,Xr),Xr=Xr.sibling;return ti}function tr(ti,Xr){return(ti=El(ti,Xr)).index=0,ti.sibling=null,ti}function vr(ti,Xr,Wn){return ti.index=Wn,_t?(Wn=ti.alternate)!==null?(Wn=Wn.index)<Xr?(ti.flags|=2,Xr):Wn:(ti.flags|=2,Xr):(ti.flags|=1048576,Xr)}function Cr(ti){return _t&&ti.alternate===null&&(ti.flags|=2),ti}function Vr(ti,Xr,Wn,si){return Xr===null||Xr.tag!==6?((Xr=rh(Wn,ti.mode,si)).return=ti,Xr):((Xr=tr(Xr,Wn)).return=ti,Xr)}function Un(ti,Xr,Wn,si){var Di=Wn.type;return Di===ht?ei(ti,Xr,Wn.props.children,si,Wn.key):Xr!==null&&(Xr.elementType===Di||typeof Di=="object"&&Di!==null&&Di.$$typeof===At&&Jo(Di)===Xr.type)?((si=tr(Xr,Wn.props)).ref=Hs(ti,Xr,Wn),si.return=ti,si):((si=Cc(Wn.type,Wn.key,Wn.props,null,ti.mode,si)).ref=Hs(ti,Xr,Wn),si.return=ti,si)}function Yn(ti,Xr,Wn,si){return Xr===null||Xr.tag!==4||Xr.stateNode.containerInfo!==Wn.containerInfo||Xr.stateNode.implementation!==Wn.implementation?((Xr=kh(Wn,ti.mode,si)).return=ti,Xr):((Xr=tr(Xr,Wn.children||[])).return=ti,Xr)}function ei(ti,Xr,Wn,si,Di){return Xr===null||Xr.tag!==7?((Xr=ru(Wn,ti.mode,si,Di)).return=ti,Xr):((Xr=tr(Xr,Wn)).return=ti,Xr)}function xi(ti,Xr,Wn){if(typeof Xr=="string"&&Xr!==""||typeof Xr=="number")return(Xr=rh(""+Xr,ti.mode,Wn)).return=ti,Xr;if(typeof Xr=="object"&&Xr!==null){switch(Xr.$$typeof){case ot:return(Wn=Cc(Xr.type,Xr.key,Xr.props,null,ti.mode,Wn)).ref=Hs(ti,null,Xr),Wn.return=ti,Wn;case lt:return(Xr=kh(Xr,ti.mode,Wn)).return=ti,Xr;case At:return xi(ti,(0,Xr._init)(Xr._payload),Wn)}if(qt(Xr)||Rt(Xr))return(Xr=ru(Xr,ti.mode,Wn,null)).return=ti,Xr;pu(ti,Xr)}return null}function Jn(ti,Xr,Wn,si){var Di=Xr!==null?Xr.key:null;if(typeof Wn=="string"&&Wn!==""||typeof Wn=="number")return Di!==null?null:Vr(ti,Xr,""+Wn,si);if(typeof Wn=="object"&&Wn!==null){switch(Wn.$$typeof){case ot:return Wn.key===Di?Un(ti,Xr,Wn,si):null;case lt:return Wn.key===Di?Yn(ti,Xr,Wn,si):null;case At:return Jn(ti,Xr,(Di=Wn._init)(Wn._payload),si)}if(qt(Wn)||Rt(Wn))return Di!==null?null:ei(ti,Xr,Wn,si,null);pu(ti,Wn)}return null}function ui(ti,Xr,Wn,si,Di){if(typeof si=="string"&&si!==""||typeof si=="number")return Vr(Xr,ti=ti.get(Wn)||null,""+si,Di);if(typeof si=="object"&&si!==null){switch(si.$$typeof){case ot:return Un(Xr,ti=ti.get(si.key===null?Wn:si.key)||null,si,Di);case lt:return Yn(Xr,ti=ti.get(si.key===null?Wn:si.key)||null,si,Di);case At:return ui(ti,Xr,Wn,(0,si._init)(si._payload),Di)}if(qt(si)||Rt(si))return ei(Xr,ti=ti.get(Wn)||null,si,Di,null);pu(Xr,si)}return null}function Ii(ti,Xr,Wn,si){for(var Di=null,aa=null,Ci=Xr,ra=Xr=0,rs=null;Ci!==null&&ra<Wn.length;ra++){Ci.index>ra?(rs=Ci,Ci=null):rs=Ci.sibling;var sa=Jn(ti,Ci,Wn[ra],si);if(sa===null){Ci===null&&(Ci=rs);break}_t&&Ci&&sa.alternate===null&&yt(ti,Ci),Xr=vr(sa,Xr,ra),aa===null?Di=sa:aa.sibling=sa,aa=sa,Ci=rs}if(ra===Wn.length)return Ct(ti,Ci),ia&&qo(ti,ra),Di;if(Ci===null){for(;ra<Wn.length;ra++)(Ci=xi(ti,Wn[ra],si))!==null&&(Xr=vr(Ci,Xr,ra),aa===null?Di=Ci:aa.sibling=Ci,aa=Ci);return ia&&qo(ti,ra),Di}for(Ci=Vt(ti,Ci);ra<Wn.length;ra++)(rs=ui(Ci,ti,ra,Wn[ra],si))!==null&&(_t&&rs.alternate!==null&&Ci.delete(rs.key===null?ra:rs.key),Xr=vr(rs,Xr,ra),aa===null?Di=rs:aa.sibling=rs,aa=rs);return _t&&Ci.forEach((function(il){return yt(ti,il)})),ia&&qo(ti,ra),Di}function Vi(ti,Xr,Wn,si){var Di=Rt(Wn);if(typeof Di!="function")throw Error(at(150));if((Wn=Di.call(Wn))==null)throw Error(at(151));for(var aa=Di=null,Ci=Xr,ra=Xr=0,rs=null,sa=Wn.next();Ci!==null&&!sa.done;ra++,sa=Wn.next()){Ci.index>ra?(rs=Ci,Ci=null):rs=Ci.sibling;var il=Jn(ti,Ci,sa.value,si);if(il===null){Ci===null&&(Ci=rs);break}_t&&Ci&&il.alternate===null&&yt(ti,Ci),Xr=vr(il,Xr,ra),aa===null?Di=il:aa.sibling=il,aa=il,Ci=rs}if(sa.done)return Ct(ti,Ci),ia&&qo(ti,ra),Di;if(Ci===null){for(;!sa.done;ra++,sa=Wn.next())(sa=xi(ti,sa.value,si))!==null&&(Xr=vr(sa,Xr,ra),aa===null?Di=sa:aa.sibling=sa,aa=sa);return ia&&qo(ti,ra),Di}for(Ci=Vt(ti,Ci);!sa.done;ra++,sa=Wn.next())(sa=ui(Ci,ti,ra,sa.value,si))!==null&&(_t&&sa.alternate!==null&&Ci.delete(sa.key===null?ra:sa.key),Xr=vr(sa,Xr,ra),aa===null?Di=sa:aa.sibling=sa,aa=sa);return _t&&Ci.forEach((function(rd){return yt(ti,rd)})),ia&&qo(ti,ra),Di}return function ti(Xr,Wn,si,Di){if(typeof si=="object"&&si!==null&&si.type===ht&&si.key===null&&(si=si.props.children),typeof si=="object"&&si!==null){switch(si.$$typeof){case ot:e:{for(var aa=si.key,Ci=Wn;Ci!==null;){if(Ci.key===aa){if((aa=si.type)===ht){if(Ci.tag===7){Ct(Xr,Ci.sibling),(Wn=tr(Ci,si.props.children)).return=Xr,Xr=Wn;break e}}else if(Ci.elementType===aa||typeof aa=="object"&&aa!==null&&aa.$$typeof===At&&Jo(aa)===Ci.type){Ct(Xr,Ci.sibling),(Wn=tr(Ci,si.props)).ref=Hs(Xr,Ci,si),Wn.return=Xr,Xr=Wn;break e}Ct(Xr,Ci);break}yt(Xr,Ci),Ci=Ci.sibling}si.type===ht?((Wn=ru(si.props.children,Xr.mode,Di,si.key)).return=Xr,Xr=Wn):((Di=Cc(si.type,si.key,si.props,null,Xr.mode,Di)).ref=Hs(Xr,Wn,si),Di.return=Xr,Xr=Di)}return Cr(Xr);case lt:e:{for(Ci=si.key;Wn!==null;){if(Wn.key===Ci){if(Wn.tag===4&&Wn.stateNode.containerInfo===si.containerInfo&&Wn.stateNode.implementation===si.implementation){Ct(Xr,Wn.sibling),(Wn=tr(Wn,si.children||[])).return=Xr,Xr=Wn;break e}Ct(Xr,Wn);break}yt(Xr,Wn),Wn=Wn.sibling}(Wn=kh(si,Xr.mode,Di)).return=Xr,Xr=Wn}return Cr(Xr);case At:return ti(Xr,Wn,(Ci=si._init)(si._payload),Di)}if(qt(si))return Ii(Xr,Wn,si,Di);if(Rt(si))return Vi(Xr,Wn,si,Di);pu(Xr,si)}return typeof si=="string"&&si!==""||typeof si=="number"?(si=""+si,Wn!==null&&Wn.tag===6?(Ct(Xr,Wn.sibling),(Wn=tr(Wn,si)).return=Xr,Xr=Wn):(Ct(Xr,Wn),(Wn=rh(si,Xr.mode,Di)).return=Xr,Xr=Wn),Cr(Xr)):Ct(Xr,Wn)}}var Os=dl(!0),fl=dl(!1),fo={},Da=Ps(fo),el=Ps(fo),St=Ps(fo);function Dt(_t){if(_t===fo)throw Error(at(174));return _t}function Jt(_t,yt){pa(St,yt),pa(el,_t),pa(Da,fo),_t=Xt(yt),qi(Da),pa(Da,_t)}function sr(){qi(Da),qi(el),qi(St)}function gr(_t){var yt=Dt(St.current),Ct=Dt(Da.current);Ct!==(yt=Ft(Ct,_t.type,yt))&&(pa(el,_t),pa(Da,yt))}function xr(_t){el.current===_t&&(qi(Da),qi(el))}var Ar=Ps(0);function Mr(_t){for(var yt=_t;yt!==null;){if(yt.tag===13){var Ct=yt.memoizedState;if(Ct!==null&&((Ct=Ct.dehydrated)===null||$i(Ct)||Ji(Ct)))return yt}else if(yt.tag===19&&yt.memoizedProps.revealOrder!==void 0){if((128&yt.flags)!=0)return yt}else if(yt.child!==null){yt.child.return=yt,yt=yt.child;continue}if(yt===_t)break;for(;yt.sibling===null;){if(yt.return===null||yt.return===_t)return null;yt=yt.return}yt.sibling.return=yt.return,yt=yt.sibling}return null}var jr=[];function Zr(){for(var _t=0;_t<jr.length;_t++){var yt=jr[_t];cr?yt._workInProgressVersionPrimary=null:yt._workInProgressVersionSecondary=null}jr.length=0}var $r=st.ReactCurrentDispatcher,Ur=st.ReactCurrentBatchConfig,Gr=0,Nr=null,Fr=null,Lr=null,An=!1,Fn=!1,Yr=0,Zn=0;function Qn(){throw Error(at(321))}function ci(_t,yt){if(yt===null)return!1;for(var Ct=0;Ct<yt.length&&Ct<_t.length;Ct++)if(!ps(_t[Ct],yt[Ct]))return!1;return!0}function di(_t,yt,Ct,Vt,tr,vr){if(Gr=vr,Nr=yt,yt.memoizedState=null,yt.updateQueue=null,yt.lanes=0,$r.current=_t===null||_t.memoizedState===null?mh:gh,_t=Ct(Vt,tr),Fn){vr=0;do{if(Fn=!1,Yr=0,25<=vr)throw Error(at(301));vr+=1,Lr=Fr=null,yt.updateQueue=null,$r.current=_h,_t=Ct(Vt,tr)}while(Fn)}if($r.current=$u,yt=Fr!==null&&Fr.next!==null,Gr=0,Lr=Fr=Nr=null,An=!1,yt)throw Error(at(300));return _t}function ni(){var _t=Yr!==0;return Yr=0,_t}function gi(){var _t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lr===null?Nr.memoizedState=Lr=_t:Lr=Lr.next=_t,Lr}function hi(){if(Fr===null){var _t=Nr.alternate;_t=_t!==null?_t.memoizedState:null}else _t=Fr.next;var yt=Lr===null?Nr.memoizedState:Lr.next;if(yt!==null)Lr=yt,Fr=_t;else{if(_t===null)throw Error(at(310));_t={memoizedState:(Fr=_t).memoizedState,baseState:Fr.baseState,baseQueue:Fr.baseQueue,queue:Fr.queue,next:null},Lr===null?Nr.memoizedState=Lr=_t:Lr=Lr.next=_t}return Lr}function oi(_t,yt){return typeof yt=="function"?yt(_t):yt}function wi(_t){var yt=hi(),Ct=yt.queue;if(Ct===null)throw Error(at(311));Ct.lastRenderedReducer=_t;var Vt=Fr,tr=Vt.baseQueue,vr=Ct.pending;if(vr!==null){if(tr!==null){var Cr=tr.next;tr.next=vr.next,vr.next=Cr}Vt.baseQueue=tr=vr,Ct.pending=null}if(tr!==null){vr=tr.next,Vt=Vt.baseState;var Vr=Cr=null,Un=null,Yn=vr;do{var ei=Yn.lane;if((Gr&ei)===ei)Un!==null&&(Un=Un.next={lane:0,action:Yn.action,hasEagerState:Yn.hasEagerState,eagerState:Yn.eagerState,next:null}),Vt=Yn.hasEagerState?Yn.eagerState:_t(Vt,Yn.action);else{var xi={lane:ei,action:Yn.action,hasEagerState:Yn.hasEagerState,eagerState:Yn.eagerState,next:null};Un===null?(Vr=Un=xi,Cr=Vt):Un=Un.next=xi,Nr.lanes|=ei,eu|=ei}Yn=Yn.next}while(Yn!==null&&Yn!==vr);Un===null?Cr=Vt:Un.next=Vr,ps(Vt,yt.memoizedState)||(La=!0),yt.memoizedState=Vt,yt.baseState=Cr,yt.baseQueue=Un,Ct.lastRenderedState=Vt}if((_t=Ct.interleaved)!==null){tr=_t;do vr=tr.lane,Nr.lanes|=vr,eu|=vr,tr=tr.next;while(tr!==_t)}else tr===null&&(Ct.lanes=0);return[yt.memoizedState,Ct.dispatch]}function Wi(_t){var yt=hi(),Ct=yt.queue;if(Ct===null)throw Error(at(311));Ct.lastRenderedReducer=_t;var Vt=Ct.dispatch,tr=Ct.pending,vr=yt.memoizedState;if(tr!==null){Ct.pending=null;var Cr=tr=tr.next;do vr=_t(vr,Cr.action),Cr=Cr.next;while(Cr!==tr);ps(vr,yt.memoizedState)||(La=!0),yt.memoizedState=vr,yt.baseQueue===null&&(yt.baseState=vr),Ct.lastRenderedState=vr}return[vr,Vt]}function Ki(){}function Bi(_t,yt){var Ct=Nr,Vt=hi(),tr=yt(),vr=!ps(Vt.memoizedState,tr);if(vr&&(Vt.memoizedState=tr,La=!0),Vt=Vt.queue,$c(_s.bind(null,Ct,Vt,_t),[_t]),Vt.getSnapshot!==yt||vr||Lr!==null&&1&Lr.memoizedState.tag){if(Ct.flags|=2048,hc(9,ya.bind(null,Ct,Vt,tr,yt),void 0,null),Ha===null)throw Error(at(349));(30&Gr)!=0||ji(Ct,yt,tr)}return tr}function ji(_t,yt,Ct){_t.flags|=16384,_t={getSnapshot:yt,value:Ct},(yt=Nr.updateQueue)===null?(yt={lastEffect:null,stores:null},Nr.updateQueue=yt,yt.stores=[_t]):(Ct=yt.stores)===null?yt.stores=[_t]:Ct.push(_t)}function ya(_t,yt,Ct,Vt){yt.value=Ct,yt.getSnapshot=Vt,na(yt)&&po(_t)}function _s(_t,yt,Ct){return Ct((function(){na(yt)&&po(_t)}))}function na(_t){var yt=_t.getSnapshot;_t=_t.value;try{var Ct=yt();return!ps(_t,Ct)}catch{return!0}}function po(_t){var yt=oo(_t,1);yt!==null&&bs(yt,_t,1,-1)}function ql(_t){var yt=gi();return typeof _t=="function"&&(_t=_t()),yt.memoizedState=yt.baseState=_t,_t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:_t},yt.queue=_t,_t=_t.dispatch=Cd.bind(null,Nr,_t),[yt.memoizedState,_t]}function hc(_t,yt,Ct,Vt){return _t={tag:_t,create:yt,destroy:Ct,deps:Vt,next:null},(yt=Nr.updateQueue)===null?(yt={lastEffect:null,stores:null},Nr.updateQueue=yt,yt.lastEffect=_t.next=_t):(Ct=yt.lastEffect)===null?yt.lastEffect=_t.next=_t:(Vt=Ct.next,Ct.next=_t,_t.next=Vt,yt.lastEffect=_t),_t}function Zh(){return hi().memoizedState}function Zl(_t,yt,Ct,Vt){var tr=gi();Nr.flags|=_t,tr.memoizedState=hc(1|yt,Ct,void 0,Vt===void 0?null:Vt)}function Uc(_t,yt,Ct,Vt){var tr=hi();Vt=Vt===void 0?null:Vt;var vr=void 0;if(Fr!==null){var Cr=Fr.memoizedState;if(vr=Cr.destroy,Vt!==null&&ci(Vt,Cr.deps))return void(tr.memoizedState=hc(yt,Ct,vr,Vt))}Nr.flags|=_t,tr.memoizedState=hc(1|yt,Ct,vr,Vt)}function dh(_t,yt){return Zl(8390656,8,_t,yt)}function $c(_t,yt){return Uc(2048,8,_t,yt)}function Ea(_t,yt){return Uc(4,2,_t,yt)}function zc(_t,yt){return Uc(4,4,_t,yt)}function dc(_t,yt){return typeof yt=="function"?(_t=_t(),yt(_t),function(){yt(null)}):yt!=null?(_t=_t(),yt.current=_t,function(){yt.current=null}):void 0}function Fu(_t,yt,Ct){return Ct=Ct!=null?Ct.concat([_t]):null,Uc(4,4,dc.bind(null,yt,_t),Ct)}function jc(){}function Gc(_t,yt){var Ct=hi();yt=yt===void 0?null:yt;var Vt=Ct.memoizedState;return Vt!==null&&yt!==null&&ci(yt,Vt[1])?Vt[0]:(Ct.memoizedState=[_t,yt],_t)}function Nu(_t,yt){var Ct=hi();yt=yt===void 0?null:yt;var Vt=Ct.memoizedState;return Vt!==null&&yt!==null&&ci(yt,Vt[1])?Vt[0]:(_t=_t(),Ct.memoizedState=[_t,yt],_t)}function fc(_t,yt,Ct){return(21&Gr)==0?(_t.baseState&&(_t.baseState=!1,La=!0),_t.memoizedState=Ct):(ps(Ct,yt)||(Ct=Pu(),Nr.lanes|=Ct,eu|=Ct,_t.baseState=!0),yt)}function Uu(_t,yt){var Ct=Gi;Gi=Ct!==0&&4>Ct?Ct:4,_t(!0);var Vt=Ur.transition;Ur.transition={};try{_t(!1),yt()}finally{Gi=Ct,Ur.transition=Vt}}function fh(){return hi().memoizedState}function Pd(_t,yt,Ct){var Vt=Ao(_t);Ct={lane:Vt,action:Ct,hasEagerState:!1,eagerState:null,next:null},ph(_t)?pc(yt,Ct):(Ct=Ou(_t,yt,Ct,Vt))!==null&&(bs(Ct,_t,Vt,ts()),mc(Ct,yt,Vt))}function Cd(_t,yt,Ct){var Vt=Ao(_t),tr={lane:Vt,action:Ct,hasEagerState:!1,eagerState:null,next:null};if(ph(_t))pc(yt,tr);else{var vr=_t.alternate;if(_t.lanes===0&&(vr===null||vr.lanes===0)&&(vr=yt.lastRenderedReducer)!==null)try{var Cr=yt.lastRenderedState,Vr=vr(Cr,Ct);if(tr.hasEagerState=!0,tr.eagerState=Vr,ps(Vr,Cr)){var Un=yt.interleaved;return Un===null?(tr.next=tr,du(yt)):(tr.next=Un.next,Un.next=tr),void(yt.interleaved=tr)}}catch{}(Ct=Ou(_t,yt,tr,Vt))!==null&&(bs(Ct,_t,Vt,tr=ts()),mc(Ct,yt,Vt))}}function ph(_t){var yt=_t.alternate;return _t===Nr||yt!==null&&yt===Nr}function pc(_t,yt){Fn=An=!0;var Ct=_t.pending;Ct===null?yt.next=yt:(yt.next=Ct.next,Ct.next=yt),_t.pending=yt}function mc(_t,yt,Ct){if((4194240&Ct)!=0){var Vt=yt.lanes;Ct|=Vt&=_t.pendingLanes,yt.lanes=Ct,Qa(_t,Ct)}}var $u={readContext:us,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},mh={readContext:us,useCallback:function(_t,yt){return gi().memoizedState=[_t,yt===void 0?null:yt],_t},useContext:us,useEffect:dh,useImperativeHandle:function(_t,yt,Ct){return Ct=Ct!=null?Ct.concat([_t]):null,Zl(4194308,4,dc.bind(null,yt,_t),Ct)},useLayoutEffect:function(_t,yt){return Zl(4194308,4,_t,yt)},useInsertionEffect:function(_t,yt){return Zl(4,2,_t,yt)},useMemo:function(_t,yt){var Ct=gi();return yt=yt===void 0?null:yt,_t=_t(),Ct.memoizedState=[_t,yt],_t},useReducer:function(_t,yt,Ct){var Vt=gi();return yt=Ct!==void 0?Ct(yt):yt,Vt.memoizedState=Vt.baseState=yt,_t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_t,lastRenderedState:yt},Vt.queue=_t,_t=_t.dispatch=Pd.bind(null,Nr,_t),[Vt.memoizedState,_t]},useRef:function(_t){return _t={current:_t},gi().memoizedState=_t},useState:ql,useDebugValue:jc,useDeferredValue:function(_t){return gi().memoizedState=_t},useTransition:function(){var _t=ql(!1),yt=_t[0];return _t=Uu.bind(null,_t[1]),gi().memoizedState=_t,[yt,_t]},useMutableSource:function(){},useSyncExternalStore:function(_t,yt,Ct){var Vt=Nr,tr=gi();if(ia){if(Ct===void 0)throw Error(at(407));Ct=Ct()}else{if(Ct=yt(),Ha===null)throw Error(at(349));(30&Gr)!=0||ji(Vt,yt,Ct)}tr.memoizedState=Ct;var vr={value:Ct,getSnapshot:yt};return tr.queue=vr,dh(_s.bind(null,Vt,vr,_t),[_t]),Vt.flags|=2048,hc(9,ya.bind(null,Vt,vr,Ct,yt),void 0,null),Ct},useId:function(){var _t=gi(),yt=Ha.identifierPrefix;if(ia){var Ct=ks;yt=":"+yt+"R"+(Ct=(Ms&~(1<<32-Xa(Ms)-1)).toString(32)+Ct),0<(Ct=Yr++)&&(yt+="H"+Ct.toString(32)),yt+=":"}else yt=":"+yt+"r"+(Ct=Zn++).toString(32)+":";return _t.memoizedState=yt},unstable_isNewReconciler:!1},gh={readContext:us,useCallback:Gc,useContext:us,useEffect:$c,useImperativeHandle:Fu,useInsertionEffect:Ea,useLayoutEffect:zc,useMemo:Nu,useReducer:wi,useRef:Zh,useState:function(){return wi(oi)},useDebugValue:jc,useDeferredValue:function(_t){return fc(hi(),Fr.memoizedState,_t)},useTransition:function(){return[wi(oi)[0],hi().memoizedState]},useMutableSource:Ki,useSyncExternalStore:Bi,useId:fh,unstable_isNewReconciler:!1},_h={readContext:us,useCallback:Gc,useContext:us,useEffect:$c,useImperativeHandle:Fu,useInsertionEffect:Ea,useLayoutEffect:zc,useMemo:Nu,useReducer:Wi,useRef:Zh,useState:function(){return Wi(oi)},useDebugValue:jc,useDeferredValue:function(_t){var yt=hi();return Fr===null?yt.memoizedState=_t:fc(yt,Fr.memoizedState,_t)},useTransition:function(){return[Wi(oi)[0],hi().memoizedState]},useMutableSource:Ki,useSyncExternalStore:Bi,useId:fh,unstable_isNewReconciler:!1};function zu(_t,yt){try{var Ct="",Vt=yt;do Ct+=Nc(Vt),Vt=Vt.return;while(Vt);var tr=Ct}catch(vr){tr=`
Error generating stack: `+vr.message+`
`+vr.stack}return{value:_t,source:yt,stack:tr,digest:null}}function Hc(_t,yt,Ct){return{value:_t,source:null,stack:Ct??null,digest:yt??null}}function yh(_t,yt){try{console.error(yt.value)}catch(Ct){setTimeout((function(){throw Ct}))}}var Md=typeof WeakMap=="function"?WeakMap:Map;function Vc(_t,yt,Ct){(Ct=lo(-1,Ct)).tag=3,Ct.payload={element:null};var Vt=yt.value;return Ct.callback=function(){Ta||(Ta=!0,Qu=Vt),yh(0,yt)},Ct}function pl(_t,yt,Ct){(Ct=lo(-1,Ct)).tag=3;var Vt=_t.type.getDerivedStateFromError;if(typeof Vt=="function"){var tr=yt.value;Ct.payload=function(){return Vt(tr)},Ct.callback=function(){yh(0,yt)}}var vr=_t.stateNode;return vr!==null&&typeof vr.componentDidCatch=="function"&&(Ct.callback=function(){yh(0,yt),typeof Vt!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var Cr=yt.stack;this.componentDidCatch(yt.value,{componentStack:Cr!==null?Cr:""})}),Ct}function vh(_t,yt,Ct){var Vt=_t.pingCache;if(Vt===null){Vt=_t.pingCache=new Md;var tr=new Set;Vt.set(yt,tr)}else(tr=Vt.get(yt))===void 0&&(tr=new Set,Vt.set(yt,tr));tr.has(Ct)||(tr.add(Ct),_t=eh.bind(null,_t,yt,Ct),yt.then(_t,_t))}function mu(_t){do{var yt;if((yt=_t.tag===13)&&(yt=(yt=_t.memoizedState)===null||yt.dehydrated!==null),yt)return _t;_t=_t.return}while(_t!==null);return null}function Bo(_t,yt,Ct,Vt,tr){return(1&_t.mode)==0?(_t===yt?_t.flags|=65536:(_t.flags|=128,Ct.flags|=131072,Ct.flags&=-52805,Ct.tag===1&&(Ct.alternate===null?Ct.tag=17:((yt=lo(-1,1)).tag=2,uo(Ct,yt,1))),Ct.lanes|=1),_t):(_t.flags|=65536,_t.lanes=tr,_t)}var gc=st.ReactCurrentOwner,La=!1;function ys(_t,yt,Ct,Vt){yt.child=_t===null?fl(yt,null,Ct,Vt):Os(yt,_t.child,Ct,Vt)}function Yh(_t,yt,Ct,Vt,tr){Ct=Ct.render;var vr=yt.ref;return Qo(yt,tr),Vt=di(_t,yt,Ct,Vt,vr,tr),Ct=ni(),_t===null||La?(ia&&Ct&&Zo(yt),yt.flags|=1,ys(_t,yt,Vt,tr),yt.child):(yt.updateQueue=_t.updateQueue,yt.flags&=-2053,_t.lanes&=~tr,_o(_t,yt,tr))}function Xh(_t,yt,Ct,Vt,tr){if(_t===null){var vr=Ct.type;return typeof vr!="function"||Pc(vr)||vr.defaultProps!==void 0||Ct.compare!==null||Ct.defaultProps!==void 0?((_t=Cc(Ct.type,null,Vt,yt,yt.mode,tr)).ref=yt.ref,_t.return=yt,yt.child=_t):(yt.tag=15,yt.type=vr,Yl(_t,yt,vr,Vt,tr))}if(vr=_t.child,(_t.lanes&tr)==0){var Cr=vr.memoizedProps;if((Ct=(Ct=Ct.compare)!==null?Ct:cu)(Cr,Vt)&&_t.ref===yt.ref)return _o(_t,yt,tr)}return yt.flags|=1,(_t=El(vr,Vt)).ref=yt.ref,_t.return=yt,yt.child=_t}function Yl(_t,yt,Ct,Vt,tr){if(_t!==null){var vr=_t.memoizedProps;if(cu(vr,Vt)&&_t.ref===yt.ref){if(La=!1,yt.pendingProps=Vt=vr,(_t.lanes&tr)==0)return yt.lanes=_t.lanes,_o(_t,yt,tr);(131072&_t.flags)!=0&&(La=!0)}}return Gu(_t,yt,Ct,Vt,tr)}function ju(_t,yt,Ct){var Vt=yt.pendingProps,tr=Vt.children,vr=_t!==null?_t.memoizedState:null;if(Vt.mode==="hidden")if((1&yt.mode)==0)yt.memoizedState={baseLanes:0,cachePool:null,transitions:null},pa(vl,Va),Va|=Ct;else{if((1073741824&Ct)==0)return _t=vr!==null?vr.baseLanes|Ct:Ct,yt.lanes=yt.childLanes=1073741824,yt.memoizedState={baseLanes:_t,cachePool:null,transitions:null},yt.updateQueue=null,pa(vl,Va),Va|=_t,null;yt.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt=vr!==null?vr.baseLanes:Ct,pa(vl,Va),Va|=Vt}else vr!==null?(Vt=vr.baseLanes|Ct,yt.memoizedState=null):Vt=Ct,pa(vl,Va),Va|=Vt;return ys(_t,yt,tr,Ct),yt.child}function gu(_t,yt){var Ct=yt.ref;(_t===null&&Ct!==null||_t!==null&&_t.ref!==Ct)&&(yt.flags|=512,yt.flags|=2097152)}function Gu(_t,yt,Ct,Vt,tr){var vr=Ya(Ct)?Js:Za.current;return vr=Ts(yt,vr),Qo(yt,tr),Ct=di(_t,yt,Ct,Vt,vr,tr),Vt=ni(),_t===null||La?(ia&&Vt&&Zo(yt),yt.flags|=1,ys(_t,yt,Ct,tr),yt.child):(yt.updateQueue=_t.updateQueue,yt.flags&=-2053,_t.lanes&=~tr,_o(_t,yt,tr))}function Wc(_t,yt,Ct,Vt,tr){if(Ya(Ct)){var vr=!0;Go(yt)}else vr=!1;if(Qo(yt,tr),yt.stateNode===null)go(_t,yt),ho(yt,Ct,Vt),Wl(yt,Ct,Vt,tr),Vt=!0;else if(_t===null){var Cr=yt.stateNode,Vr=yt.memoizedProps;Cr.props=Vr;var Un=Cr.context,Yn=Ct.contextType;typeof Yn=="object"&&Yn!==null?Yn=us(Yn):Yn=Ts(yt,Yn=Ya(Ct)?Js:Za.current);var ei=Ct.getDerivedStateFromProps,xi=typeof ei=="function"||typeof Cr.getSnapshotBeforeUpdate=="function";xi||typeof Cr.UNSAFE_componentWillReceiveProps!="function"&&typeof Cr.componentWillReceiveProps!="function"||(Vr!==Vt||Un!==Yn)&&Ma(yt,Cr,Vt,Yn),ko=!1;var Jn=yt.memoizedState;Cr.state=Jn,Vl(yt,Vt,Cr,tr),Un=yt.memoizedState,Vr!==Vt||Jn!==Un||ls.current||ko?(typeof ei=="function"&&(Lu(yt,Ct,ei,Vt),Un=yt.memoizedState),(Vr=ko||co(yt,Ct,Vr,Vt,Jn,Un,Yn))?(xi||typeof Cr.UNSAFE_componentWillMount!="function"&&typeof Cr.componentWillMount!="function"||(typeof Cr.componentWillMount=="function"&&Cr.componentWillMount(),typeof Cr.UNSAFE_componentWillMount=="function"&&Cr.UNSAFE_componentWillMount()),typeof Cr.componentDidMount=="function"&&(yt.flags|=4194308)):(typeof Cr.componentDidMount=="function"&&(yt.flags|=4194308),yt.memoizedProps=Vt,yt.memoizedState=Un),Cr.props=Vt,Cr.state=Un,Cr.context=Yn,Vt=Vr):(typeof Cr.componentDidMount=="function"&&(yt.flags|=4194308),Vt=!1)}else{Cr=yt.stateNode,uc(_t,yt),Vr=yt.memoizedProps,Yn=yt.type===yt.elementType?Vr:gs(yt.type,Vr),Cr.props=Yn,xi=yt.pendingProps,Jn=Cr.context,typeof(Un=Ct.contextType)=="object"&&Un!==null?Un=us(Un):Un=Ts(yt,Un=Ya(Ct)?Js:Za.current);var ui=Ct.getDerivedStateFromProps;(ei=typeof ui=="function"||typeof Cr.getSnapshotBeforeUpdate=="function")||typeof Cr.UNSAFE_componentWillReceiveProps!="function"&&typeof Cr.componentWillReceiveProps!="function"||(Vr!==xi||Jn!==Un)&&Ma(yt,Cr,Vt,Un),ko=!1,Jn=yt.memoizedState,Cr.state=Jn,Vl(yt,Vt,Cr,tr);var Ii=yt.memoizedState;Vr!==xi||Jn!==Ii||ls.current||ko?(typeof ui=="function"&&(Lu(yt,Ct,ui,Vt),Ii=yt.memoizedState),(Yn=ko||co(yt,Ct,Yn,Vt,Jn,Ii,Un)||!1)?(ei||typeof Cr.UNSAFE_componentWillUpdate!="function"&&typeof Cr.componentWillUpdate!="function"||(typeof Cr.componentWillUpdate=="function"&&Cr.componentWillUpdate(Vt,Ii,Un),typeof Cr.UNSAFE_componentWillUpdate=="function"&&Cr.UNSAFE_componentWillUpdate(Vt,Ii,Un)),typeof Cr.componentDidUpdate=="function"&&(yt.flags|=4),typeof Cr.getSnapshotBeforeUpdate=="function"&&(yt.flags|=1024)):(typeof Cr.componentDidUpdate!="function"||Vr===_t.memoizedProps&&Jn===_t.memoizedState||(yt.flags|=4),typeof Cr.getSnapshotBeforeUpdate!="function"||Vr===_t.memoizedProps&&Jn===_t.memoizedState||(yt.flags|=1024),yt.memoizedProps=Vt,yt.memoizedState=Ii),Cr.props=Vt,Cr.state=Ii,Cr.context=Un,Vt=Yn):(typeof Cr.componentDidUpdate!="function"||Vr===_t.memoizedProps&&Jn===_t.memoizedState||(yt.flags|=4),typeof Cr.getSnapshotBeforeUpdate!="function"||Vr===_t.memoizedProps&&Jn===_t.memoizedState||(yt.flags|=1024),Vt=!1)}return Xl(_t,yt,Ct,Vt,vr,tr)}function Xl(_t,yt,Ct,Vt,tr,vr){gu(_t,yt);var Cr=(128&yt.flags)!=0;if(!Vt&&!Cr)return tr&&Ho(yt,Ct,!1),_o(_t,yt,vr);Vt=yt.stateNode,gc.current=yt;var Vr=Cr&&typeof Ct.getDerivedStateFromError!="function"?null:Vt.render();return yt.flags|=1,_t!==null&&Cr?(yt.child=Os(yt,_t.child,null,vr),yt.child=Os(yt,null,Vr,vr)):ys(_t,yt,Vr,vr),yt.memoizedState=Vt.state,tr&&Ho(yt,Ct,!0),yt.child}function ml(_t){var yt=_t.stateNode;yt.pendingContext?Cl(0,yt.pendingContext,yt.pendingContext!==yt.context):yt.context&&Cl(0,yt.context,!1),Jt(_t,yt.containerInfo)}function Sa(_t,yt,Ct,Vt,tr){return so(),zl(tr),yt.flags|=256,ys(_t,yt,Ct,Vt),yt.child}var da,mo,es,cs,gl={dehydrated:null,treeContext:null,retryLane:0};function Ql(_t){return{baseLanes:_t,cachePool:null,transitions:null}}function As(_t,yt,Ct){var Vt,tr=yt.pendingProps,vr=Ar.current,Cr=!1,Vr=(128&yt.flags)!=0;if((Vt=Vr)||(Vt=(_t===null||_t.memoizedState!==null)&&(2&vr)!=0),Vt?(Cr=!0,yt.flags&=-129):_t!==null&&_t.memoizedState===null||(vr|=1),pa(Ar,1&vr),_t===null)return Yo(yt),(_t=yt.memoizedState)!==null&&(_t=_t.dehydrated)!==null?((1&yt.mode)==0?yt.lanes=1:Ji(_t)?yt.lanes=8:yt.lanes=1073741824,null):(Vr=tr.children,_t=tr.fallback,Cr?(tr=yt.mode,Cr=yt.child,Vr={mode:"hidden",children:Vr},(1&tr)==0&&Cr!==null?(Cr.childLanes=0,Cr.pendingProps=Vr):Cr=th(Vr,tr,0,null),_t=ru(_t,tr,Ct,null),Cr.return=yt,_t.return=yt,Cr.sibling=_t,yt.child=Cr,yt.child.memoizedState=Ql(Ct),yt.memoizedState=gl,_t):Hu(yt,Vr));if((vr=_t.memoizedState)!==null&&(Vt=vr.dehydrated)!==null)return(function(Yn,ei,xi,Jn,ui,Ii,Vi){if(xi)return 256&ei.flags?(ei.flags&=-257,_c(Yn,ei,Vi,Jn=Hc(Error(at(422))))):ei.memoizedState!==null?(ei.child=Yn.child,ei.flags|=128,null):(Ii=Jn.fallback,ui=ei.mode,Jn=th({mode:"visible",children:Jn.children},ui,0,null),(Ii=ru(Ii,ui,Vi,null)).flags|=2,Jn.return=ei,Ii.return=ei,Jn.sibling=Ii,ei.child=Jn,(1&ei.mode)!=0&&Os(ei,Yn.child,null,Vi),ei.child.memoizedState=Ql(Vi),ei.memoizedState=gl,Ii);if((1&ei.mode)==0)return _c(Yn,ei,Vi,null);if(Ji(ui))return Jn=ea(ui).digest,Ii=Error(at(419)),Jn=Hc(Ii,Jn,void 0),_c(Yn,ei,Vi,Jn);if(xi=(Vi&Yn.childLanes)!=0,La||xi){if((Jn=Ha)!==null){switch(Vi&-Vi){case 4:ui=2;break;case 16:ui=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ui=32;break;case 536870912:ui=268435456;break;default:ui=0}(ui=(ui&(Jn.suspendedLanes|Vi))!=0?0:ui)!==0&&ui!==Ii.retryLane&&(Ii.retryLane=ui,oo(Yn,ui),bs(Jn,Yn,ui,-1))}return Jc(),_c(Yn,ei,Vi,Jn=Hc(Error(at(421))))}return $i(ui)?(ei.flags|=128,ei.child=Yn.child,ei=Ch.bind(null,Yn),Na(ui,ei),null):(Yn=Ii.treeContext,rr&&(Ba=ka(ui),ha=ei,ia=!0,js=null,ao=!1,Yn!==null&&(Ja[as++]=Ms,Ja[as++]=ks,Ja[as++]=ss,Ms=Yn.id,ks=Yn.overflow,ss=ei)),ei=Hu(ei,Jn.children),ei.flags|=4096,ei)})(_t,yt,Vr,tr,Vt,vr,Ct);if(Cr){Cr=tr.fallback,Vr=yt.mode,Vt=(vr=_t.child).sibling;var Un={mode:"hidden",children:tr.children};return(1&Vr)==0&&yt.child!==vr?((tr=yt.child).childLanes=0,tr.pendingProps=Un,yt.deletions=null):(tr=El(vr,Un)).subtreeFlags=14680064&vr.subtreeFlags,Vt!==null?Cr=El(Vt,Cr):(Cr=ru(Cr,Vr,Ct,null)).flags|=2,Cr.return=yt,tr.return=yt,tr.sibling=Cr,yt.child=tr,tr=Cr,Cr=yt.child,Vr=(Vr=_t.child.memoizedState)===null?Ql(Ct):{baseLanes:Vr.baseLanes|Ct,cachePool:null,transitions:Vr.transitions},Cr.memoizedState=Vr,Cr.childLanes=_t.childLanes&~Ct,yt.memoizedState=gl,tr}return _t=(Cr=_t.child).sibling,tr=El(Cr,{mode:"visible",children:tr.children}),(1&yt.mode)==0&&(tr.lanes=Ct),tr.return=yt,tr.sibling=null,_t!==null&&((Ct=yt.deletions)===null?(yt.deletions=[_t],yt.flags|=16):Ct.push(_t)),yt.child=tr,yt.memoizedState=null,tr}function Hu(_t,yt){return(yt=th({mode:"visible",children:yt},_t.mode,0,null)).return=_t,_t.child=yt}function _c(_t,yt,Ct,Vt){return Vt!==null&&zl(Vt),Os(yt,_t.child,null,Ct),(_t=Hu(yt,yt.pendingProps.children)).flags|=2,yt.memoizedState=null,_t}function bh(_t,yt,Ct){_t.lanes|=yt;var Vt=_t.alternate;Vt!==null&&(Vt.lanes|=yt),oc(_t.return,yt,Ct)}function Vu(_t,yt,Ct,Vt,tr){var vr=_t.memoizedState;vr===null?_t.memoizedState={isBackwards:yt,rendering:null,renderingStartTime:0,last:Vt,tail:Ct,tailMode:tr}:(vr.isBackwards=yt,vr.rendering=null,vr.renderingStartTime=0,vr.last=Vt,vr.tail=Ct,vr.tailMode=tr)}function xh(_t,yt,Ct){var Vt=yt.pendingProps,tr=Vt.revealOrder,vr=Vt.tail;if(ys(_t,yt,Vt.children,Ct),(2&(Vt=Ar.current))!=0)Vt=1&Vt|2,yt.flags|=128;else{if(_t!==null&&(128&_t.flags)!=0)e:for(_t=yt.child;_t!==null;){if(_t.tag===13)_t.memoizedState!==null&&bh(_t,Ct,yt);else if(_t.tag===19)bh(_t,Ct,yt);else if(_t.child!==null){_t.child.return=_t,_t=_t.child;continue}if(_t===yt)break e;for(;_t.sibling===null;){if(_t.return===null||_t.return===yt)break e;_t=_t.return}_t.sibling.return=_t.return,_t=_t.sibling}Vt&=1}if(pa(Ar,Vt),(1&yt.mode)==0)yt.memoizedState=null;else switch(tr){case"forwards":for(Ct=yt.child,tr=null;Ct!==null;)(_t=Ct.alternate)!==null&&Mr(_t)===null&&(tr=Ct),Ct=Ct.sibling;(Ct=tr)===null?(tr=yt.child,yt.child=null):(tr=Ct.sibling,Ct.sibling=null),Vu(yt,!1,tr,Ct,vr);break;case"backwards":for(Ct=null,tr=yt.child,yt.child=null;tr!==null;){if((_t=tr.alternate)!==null&&Mr(_t)===null){yt.child=tr;break}_t=tr.sibling,tr.sibling=Ct,Ct=tr,tr=_t}Vu(yt,!0,Ct,null,vr);break;case"together":Vu(yt,!1,null,null,void 0);break;default:yt.memoizedState=null}return yt.child}function go(_t,yt){(1&yt.mode)==0&&_t!==null&&(_t.alternate=null,yt.alternate=null,yt.flags|=2)}function _o(_t,yt,Ct){if(_t!==null&&(yt.dependencies=_t.dependencies),eu|=yt.lanes,(Ct&yt.childLanes)==0)return null;if(_t!==null&&yt.child!==_t.child)throw Error(at(153));if(yt.child!==null){for(Ct=El(_t=yt.child,_t.pendingProps),yt.child=Ct,Ct.return=yt;_t.sibling!==null;)_t=_t.sibling,(Ct=Ct.sibling=El(_t,_t.pendingProps)).return=yt;Ct.sibling=null}return yt.child}function yo(_t){_t.flags|=4}function wh(_t,yt){if(_t!==null&&_t.child===yt.child)return!0;if((16&yt.flags)!=0)return!1;for(_t=yt.child;_t!==null;){if((12854&_t.flags)!=0||(12854&_t.subtreeFlags)!=0)return!1;_t=_t.sibling}return!0}if(Nt)da=function(_t,yt){for(var Ct=yt.child;Ct!==null;){if(Ct.tag===5||Ct.tag===6)er(_t,Ct.stateNode);else if(Ct.tag!==4&&Ct.child!==null){Ct.child.return=Ct,Ct=Ct.child;continue}if(Ct===yt)break;for(;Ct.sibling===null;){if(Ct.return===null||Ct.return===yt)return;Ct=Ct.return}Ct.sibling.return=Ct.return,Ct=Ct.sibling}},mo=function(){},es=function(_t,yt,Ct,Vt,tr){if((_t=_t.memoizedProps)!==Vt){var vr=yt.stateNode,Cr=Dt(Da.current);Ct=fr(vr,Ct,_t,Vt,tr,Cr),(yt.updateQueue=Ct)&&yo(yt)}},cs=function(_t,yt,Ct,Vt){Ct!==Vt&&yo(yt)};else if(pr){da=function(_t,yt,Ct,Vt){for(var tr=yt.child;tr!==null;){if(tr.tag===5){var vr=tr.stateNode;Ct&&Vt&&(vr=ri(vr,tr.type,tr.memoizedProps,tr)),er(_t,vr)}else if(tr.tag===6)vr=tr.stateNode,Ct&&Vt&&(vr=yi(vr,tr.memoizedProps,tr)),er(_t,vr);else if(tr.tag!==4){if(tr.tag===22&&tr.memoizedState!==null)(vr=tr.child)!==null&&(vr.return=tr),da(_t,tr,!0,!0);else if(tr.child!==null){tr.child.return=tr,tr=tr.child;continue}}if(tr===yt)break;for(;tr.sibling===null;){if(tr.return===null||tr.return===yt)return;tr=tr.return}tr.sibling.return=tr.return,tr=tr.sibling}};var Qh=function(_t,yt,Ct,Vt){for(var tr=yt.child;tr!==null;){if(tr.tag===5){var vr=tr.stateNode;Ct&&Vt&&(vr=ri(vr,tr.type,tr.memoizedProps,tr)),Hr(_t,vr)}else if(tr.tag===6)vr=tr.stateNode,Ct&&Vt&&(vr=yi(vr,tr.memoizedProps,tr)),Hr(_t,vr);else if(tr.tag!==4){if(tr.tag===22&&tr.memoizedState!==null)(vr=tr.child)!==null&&(vr.return=tr),Qh(_t,tr,!0,!0);else if(tr.child!==null){tr.child.return=tr,tr=tr.child;continue}}if(tr===yt)break;for(;tr.sibling===null;){if(tr.return===null||tr.return===yt)return;tr=tr.return}tr.sibling.return=tr.return,tr=tr.sibling}};mo=function(_t,yt){var Ct=yt.stateNode;if(!wh(_t,yt)){_t=Ct.containerInfo;var Vt=Pr(_t);Qh(Vt,yt,!1,!1),Ct.pendingChildren=Vt,yo(yt),qr(_t,Vt)}},es=function(_t,yt,Ct,Vt,tr){var vr=_t.stateNode,Cr=_t.memoizedProps;if((_t=wh(_t,yt))&&Cr===Vt)yt.stateNode=vr;else{var Vr=yt.stateNode,Un=Dt(Da.current),Yn=null;Cr!==Vt&&(Yn=fr(Vr,Ct,Cr,Vt,tr,Un)),_t&&Yn===null?yt.stateNode=vr:(vr=Dr(vr,Yn,Ct,Cr,Vt,yt,_t,Vr),dr(vr,Ct,Vt,tr,Un)&&yo(yt),yt.stateNode=vr,_t?yo(yt):da(vr,yt,!1,!1))}},cs=function(_t,yt,Ct,Vt){Ct!==Vt?(_t=Dt(St.current),Ct=Dt(Da.current),yt.stateNode=mr(Vt,_t,Ct,yt),yo(yt)):yt.stateNode=_t.stateNode}}else mo=function(){},es=function(){},cs=function(){};function vo(_t,yt){if(!ia)switch(_t.tailMode){case"hidden":yt=_t.tail;for(var Ct=null;yt!==null;)yt.alternate!==null&&(Ct=yt),yt=yt.sibling;Ct===null?_t.tail=null:Ct.sibling=null;break;case"collapsed":Ct=_t.tail;for(var Vt=null;Ct!==null;)Ct.alternate!==null&&(Vt=Ct),Ct=Ct.sibling;Vt===null?yt||_t.tail===null?_t.tail=null:_t.tail.sibling=null:Vt.sibling=null}}function Ga(_t){var yt=_t.alternate!==null&&_t.alternate.child===_t.child,Ct=0,Vt=0;if(yt)for(var tr=_t.child;tr!==null;)Ct|=tr.lanes|tr.childLanes,Vt|=14680064&tr.subtreeFlags,Vt|=14680064&tr.flags,tr.return=_t,tr=tr.sibling;else for(tr=_t.child;tr!==null;)Ct|=tr.lanes|tr.childLanes,Vt|=tr.subtreeFlags,Vt|=tr.flags,tr.return=_t,tr=tr.sibling;return _t.subtreeFlags|=Vt,_t.childLanes=Ct,yt}function Wu(_t,yt,Ct){var Vt=yt.pendingProps;switch(lu(yt),yt.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(yt),null;case 1:case 17:return Ya(yt.type)&&jo(),Ga(yt),null;case 3:return Ct=yt.stateNode,sr(),qi(ls),qi(Za),Zr(),Ct.pendingContext&&(Ct.context=Ct.pendingContext,Ct.pendingContext=null),_t!==null&&_t.child!==null||($a(yt)?yo(yt):_t===null||_t.memoizedState.isDehydrated&&(256&yt.flags)==0||(yt.flags|=1024,js!==null&&(Rc(js),js=null))),mo(_t,yt),Ga(yt),null;case 5:xr(yt),Ct=Dt(St.current);var tr=yt.type;if(_t!==null&&yt.stateNode!=null)es(_t,yt,tr,Vt,Ct),_t.ref!==yt.ref&&(yt.flags|=512,yt.flags|=2097152);else{if(!Vt){if(yt.stateNode===null)throw Error(at(166));return Ga(yt),null}if(_t=Dt(Da.current),$a(yt)){if(!rr)throw Error(at(175));_t=Xi(yt.stateNode,yt.type,yt.memoizedProps,Ct,_t,yt,!ao),yt.updateQueue=_t,_t!==null&&yo(yt)}else{var vr=zt(tr,Vt,Ct,_t,yt);da(vr,yt,!1,!1),yt.stateNode=vr,dr(vr,tr,Vt,Ct,_t)&&yo(yt)}yt.ref!==null&&(yt.flags|=512,yt.flags|=2097152)}return Ga(yt),null;case 6:if(_t&&yt.stateNode!=null)cs(_t,yt,_t.memoizedProps,Vt);else{if(typeof Vt!="string"&&yt.stateNode===null)throw Error(at(166));if(_t=Dt(St.current),Ct=Dt(Da.current),$a(yt)){if(!rr)throw Error(at(176));if(_t=yt.stateNode,Ct=yt.memoizedProps,(Vt=ca(_t,Ct,yt,!ao))&&(tr=ha)!==null)switch(tr.tag){case 3:Qs(tr.stateNode.containerInfo,_t,Ct,(1&tr.mode)!=0);break;case 5:ta(tr.type,tr.memoizedProps,tr.stateNode,_t,Ct,(1&tr.mode)!=0)}Vt&&yo(yt)}else yt.stateNode=mr(Vt,_t,Ct,yt)}return Ga(yt),null;case 13:if(qi(Ar),Vt=yt.memoizedState,_t===null||_t.memoizedState!==null&&_t.memoizedState.dehydrated!==null){if(ia&&Ba!==null&&(1&yt.mode)!=0&&(128&yt.flags)==0)$l(),so(),yt.flags|=98560,tr=!1;else if(tr=$a(yt),Vt!==null&&Vt.dehydrated!==null){if(_t===null){if(!tr)throw Error(at(318));if(!rr)throw Error(at(344));if(!(tr=(tr=yt.memoizedState)!==null?tr.dehydrated:null))throw Error(at(317));_a(tr,yt)}else so(),(128&yt.flags)==0&&(yt.memoizedState=null),yt.flags|=4;Ga(yt),tr=!1}else js!==null&&(Rc(js),js=null),tr=!0;if(!tr)return 65536&yt.flags?yt:null}return(128&yt.flags)!=0?(yt.lanes=Ct,yt):((Ct=Vt!==null)!=(_t!==null&&_t.memoizedState!==null)&&Ct&&(yt.child.flags|=8192,(1&yt.mode)!=0&&(_t===null||(1&Ar.current)!=0?Wa===0&&(Wa=3):Jc())),yt.updateQueue!==null&&(yt.flags|=4),Ga(yt),null);case 4:return sr(),mo(_t,yt),_t===null&&nr(yt.stateNode.containerInfo),Ga(yt),null;case 10:return Hl(yt.type._context),Ga(yt),null;case 19:if(qi(Ar),(tr=yt.memoizedState)===null)return Ga(yt),null;if(Vt=(128&yt.flags)!=0,(vr=tr.rendering)===null)if(Vt)vo(tr,!1);else{if(Wa!==0||_t!==null&&(128&_t.flags)!=0)for(_t=yt.child;_t!==null;){if((vr=Mr(_t))!==null){for(yt.flags|=128,vo(tr,!1),(_t=vr.updateQueue)!==null&&(yt.updateQueue=_t,yt.flags|=4),yt.subtreeFlags=0,_t=Ct,Ct=yt.child;Ct!==null;)tr=_t,(Vt=Ct).flags&=14680066,(vr=Vt.alternate)===null?(Vt.childLanes=0,Vt.lanes=tr,Vt.child=null,Vt.subtreeFlags=0,Vt.memoizedProps=null,Vt.memoizedState=null,Vt.updateQueue=null,Vt.dependencies=null,Vt.stateNode=null):(Vt.childLanes=vr.childLanes,Vt.lanes=vr.lanes,Vt.child=vr.child,Vt.subtreeFlags=0,Vt.deletions=null,Vt.memoizedProps=vr.memoizedProps,Vt.memoizedState=vr.memoizedState,Vt.updateQueue=vr.updateQueue,Vt.type=vr.type,tr=vr.dependencies,Vt.dependencies=tr===null?null:{lanes:tr.lanes,firstContext:tr.firstContext}),Ct=Ct.sibling;return pa(Ar,1&Ar.current|2),yt.child}_t=_t.sibling}tr.tail!==null&&Qi()>Tc&&(yt.flags|=128,Vt=!0,vo(tr,!1),yt.lanes=4194304)}else{if(!Vt)if((_t=Mr(vr))!==null){if(yt.flags|=128,Vt=!0,(_t=_t.updateQueue)!==null&&(yt.updateQueue=_t,yt.flags|=4),vo(tr,!0),tr.tail===null&&tr.tailMode==="hidden"&&!vr.alternate&&!ia)return Ga(yt),null}else 2*Qi()-tr.renderingStartTime>Tc&&Ct!==1073741824&&(yt.flags|=128,Vt=!0,vo(tr,!1),yt.lanes=4194304);tr.isBackwards?(vr.sibling=yt.child,yt.child=vr):((_t=tr.last)!==null?_t.sibling=vr:yt.child=vr,tr.last=vr)}return tr.tail!==null?(yt=tr.tail,tr.rendering=yt,tr.tail=yt.sibling,tr.renderingStartTime=Qi(),yt.sibling=null,_t=Ar.current,pa(Ar,Vt?1&_t|2:1&_t),yt):(Ga(yt),null);case 22:case 23:return Tu(),Ct=yt.memoizedState!==null,_t!==null&&_t.memoizedState!==null!==Ct&&(yt.flags|=8192),Ct&&(1&yt.mode)!=0?(1073741824&Va)!=0&&(Ga(yt),Nt&&6&yt.subtreeFlags&&(yt.flags|=8192)):Ga(yt),null;case 24:case 25:return null}throw Error(at(156,yt.tag))}function qc(_t,yt){switch(lu(yt),yt.tag){case 1:return Ya(yt.type)&&jo(),65536&(_t=yt.flags)?(yt.flags=-65537&_t|128,yt):null;case 3:return sr(),qi(ls),qi(Za),Zr(),(65536&(_t=yt.flags))!=0&&(128&_t)==0?(yt.flags=-65537&_t|128,yt):null;case 5:return xr(yt),null;case 13:if(qi(Ar),(_t=yt.memoizedState)!==null&&_t.dehydrated!==null){if(yt.alternate===null)throw Error(at(340));so()}return 65536&(_t=yt.flags)?(yt.flags=-65537&_t|128,yt):null;case 19:return qi(Ar),null;case 4:return sr(),null;case 10:return Hl(yt.type._context),null;case 22:case 23:return Tu(),null;default:return null}}var _u=!1,va=!1,bo=typeof WeakSet=="function"?WeakSet:Set,Ei=null;function Bs(_t,yt){var Ct=_t.ref;if(Ct!==null)if(typeof Ct=="function")try{Ct(null)}catch(Vt){ba(_t,yt,Vt)}else Ct.current=null}function tl(_t,yt,Ct){try{Ct()}catch(Vt){ba(_t,yt,Vt)}}var Kl=!1;function qu(_t,yt,Ct){var Vt=yt.updateQueue;if((Vt=Vt!==null?Vt.lastEffect:null)!==null){var tr=Vt=Vt.next;do{if((tr.tag&_t)===_t){var vr=tr.destroy;tr.destroy=void 0,vr!==void 0&&tl(yt,Ct,vr)}tr=tr.next}while(tr!==Vt)}}function Zu(_t,yt){if((yt=(yt=yt.updateQueue)!==null?yt.lastEffect:null)!==null){var Ct=yt=yt.next;do{if((Ct.tag&_t)===_t){var Vt=Ct.create;Ct.destroy=Vt()}Ct=Ct.next}while(Ct!==yt)}}function yc(_t){var yt=_t.ref;if(yt!==null){var Ct=_t.stateNode;_t.tag===5?_t=Bt(Ct):_t=Ct,typeof yt=="function"?yt(_t):yt.current=_t}}function Ds(_t){var yt=_t.alternate;yt!==null&&(_t.alternate=null,Ds(yt)),_t.child=null,_t.deletions=null,_t.sibling=null,_t.tag===5&&(yt=_t.stateNode)!==null&&Er(yt),_t.stateNode=null,_t.return=null,_t.dependencies=null,_t.memoizedProps=null,_t.memoizedState=null,_t.pendingProps=null,_t.stateNode=null,_t.updateQueue=null}function Ls(_t){return _t.tag===5||_t.tag===3||_t.tag===4}function Aa(_t){e:for(;;){for(;_t.sibling===null;){if(_t.return===null||Ls(_t.return))return null;_t=_t.return}for(_t.sibling.return=_t.return,_t=_t.sibling;_t.tag!==5&&_t.tag!==6&&_t.tag!==18;){if(2&_t.flags||_t.child===null||_t.tag===4)continue e;_t.child.return=_t,_t=_t.child}if(!(2&_t.flags))return _t.stateNode}}function Vs(_t,yt,Ct){var Vt=_t.tag;if(Vt===5||Vt===6)_t=_t.stateNode,yt?Tr(Ct,_t,yt):vi(Ct,_t);else if(Vt!==4&&(_t=_t.child)!==null)for(Vs(_t,yt,Ct),_t=_t.sibling;_t!==null;)Vs(_t,yt,Ct),_t=_t.sibling}function Zc(_t,yt,Ct){var Vt=_t.tag;if(Vt===5||Vt===6)_t=_t.stateNode,yt?pi(Ct,_t,yt):Vn(Ct,_t);else if(Vt!==4&&(_t=_t.child)!==null)for(Zc(_t,yt,Ct),_t=_t.sibling;_t!==null;)Zc(_t,yt,Ct),_t=_t.sibling}var vs=null,xo=!1;function wo(_t,yt,Ct){for(Ct=Ct.child;Ct!==null;)Yc(_t,yt,Ct),Ct=Ct.sibling}function Yc(_t,yt,Ct){if(Ca&&typeof Ca.onCommitFiberUnmount=="function")try{Ca.onCommitFiberUnmount(ou,Ct)}catch{}switch(Ct.tag){case 5:va||Bs(Ct,yt);case 6:if(Nt){var Vt=vs,tr=xo;vs=null,wo(_t,yt,Ct),xo=tr,(vs=Vt)!==null&&(xo?_r(vs,Ct.stateNode):qn(vs,Ct.stateNode))}else wo(_t,yt,Ct);break;case 18:Nt&&vs!==null&&(xo?Xs(vs,Ct.stateNode):zo(vs,Ct.stateNode));break;case 4:Nt?(Vt=vs,tr=xo,vs=Ct.stateNode.containerInfo,xo=!0,wo(_t,yt,Ct),vs=Vt,xo=tr):(pr&&(Vt=Ct.stateNode.containerInfo,tr=Pr(Vt),bi(Vt,tr)),wo(_t,yt,Ct));break;case 0:case 11:case 14:case 15:if(!va&&(Vt=Ct.updateQueue)!==null&&(Vt=Vt.lastEffect)!==null){tr=Vt=Vt.next;do{var vr=tr,Cr=vr.destroy;vr=vr.tag,Cr!==void 0&&((2&vr)!=0||(4&vr)!=0)&&tl(Ct,yt,Cr),tr=tr.next}while(tr!==Vt)}wo(_t,yt,Ct);break;case 1:if(!va&&(Bs(Ct,yt),typeof(Vt=Ct.stateNode).componentWillUnmount=="function"))try{Vt.props=Ct.memoizedProps,Vt.state=Ct.memoizedState,Vt.componentWillUnmount()}catch(Vr){ba(Ct,yt,Vr)}wo(_t,yt,Ct);break;case 21:wo(_t,yt,Ct);break;case 22:1&Ct.mode?(va=(Vt=va)||Ct.memoizedState!==null,wo(_t,yt,Ct),va=Vt):wo(_t,yt,Ct);break;default:wo(_t,yt,Ct)}}function vc(_t){var yt=_t.updateQueue;if(yt!==null){_t.updateQueue=null;var Ct=_t.stateNode;Ct===null&&(Ct=_t.stateNode=new bo),yt.forEach((function(Vt){var tr=ed.bind(null,_t,Vt);Ct.has(Vt)||(Ct.add(Vt),Vt.then(tr,tr))}))}}function Eo(_t,yt){var Ct=yt.deletions;if(Ct!==null)for(var Vt=0;Vt<Ct.length;Vt++){var tr=Ct[Vt];try{var vr=_t,Cr=yt;if(Nt){var Vr=Cr;e:for(;Vr!==null;){switch(Vr.tag){case 5:vs=Vr.stateNode,xo=!1;break e;case 3:case 4:vs=Vr.stateNode.containerInfo,xo=!0;break e}Vr=Vr.return}if(vs===null)throw Error(at(160));Yc(vr,Cr,tr),vs=null,xo=!1}else Yc(vr,Cr,tr);var Un=tr.alternate;Un!==null&&(Un.return=null),tr.return=null}catch(Yn){ba(tr,yt,Yn)}}if(12854&yt.subtreeFlags)for(yt=yt.child;yt!==null;)yu(yt,_t),yt=yt.sibling}function yu(_t,yt){var Ct=_t.alternate,Vt=_t.flags;switch(_t.tag){case 0:case 11:case 14:case 15:if(Eo(yt,_t),So(_t),4&Vt){try{qu(3,_t,_t.return),Zu(3,_t)}catch(Jn){ba(_t,_t.return,Jn)}try{qu(5,_t,_t.return)}catch(Jn){ba(_t,_t.return,Jn)}}break;case 1:Eo(yt,_t),So(_t),512&Vt&&Ct!==null&&Bs(Ct,Ct.return);break;case 5:if(Eo(yt,_t),So(_t),512&Vt&&Ct!==null&&Bs(Ct,Ct.return),Nt){if(32&_t.flags){var tr=_t.stateNode;try{Rr(tr)}catch(Jn){ba(_t,_t.return,Jn)}}if(4&Vt&&(tr=_t.stateNode)!=null){var vr=_t.memoizedProps;if(Ct=Ct!==null?Ct.memoizedProps:vr,Vt=_t.type,yt=_t.updateQueue,_t.updateQueue=null,yt!==null)try{Ri(tr,yt,Vt,Ct,vr,_t)}catch(Jn){ba(_t,_t.return,Jn)}}}break;case 6:if(Eo(yt,_t),So(_t),4&Vt&&Nt){if(_t.stateNode===null)throw Error(at(162));tr=_t.stateNode,vr=_t.memoizedProps,Ct=Ct!==null?Ct.memoizedProps:vr;try{mi(tr,Ct,vr)}catch(Jn){ba(_t,_t.return,Jn)}}break;case 3:if(Eo(yt,_t),So(_t),4&Vt){if(Nt&&rr&&Ct!==null&&Ct.memoizedState.isDehydrated)try{Es(yt.containerInfo)}catch(Jn){ba(_t,_t.return,Jn)}if(pr){tr=yt.containerInfo,vr=yt.pendingChildren;try{bi(tr,vr)}catch(Jn){ba(_t,_t.return,Jn)}}}break;case 4:if(Eo(yt,_t),So(_t),4&Vt&&pr){tr=(vr=_t.stateNode).containerInfo,vr=vr.pendingChildren;try{bi(tr,vr)}catch(Jn){ba(_t,_t.return,Jn)}}break;case 13:Eo(yt,_t),So(_t),8192&(tr=_t.child).flags&&(vr=tr.memoizedState!==null,tr.stateNode.isHidden=vr,!vr||tr.alternate!==null&&tr.alternate.memoizedState!==null||(xl=Qi())),4&Vt&&vc(_t);break;case 22:var Cr=Ct!==null&&Ct.memoizedState!==null;if(1&_t.mode?(va=(Ct=va)||Cr,Eo(yt,_t),va=Ct):Eo(yt,_t),So(_t),8192&Vt){if(Ct=_t.memoizedState!==null,(_t.stateNode.isHidden=Ct)&&!Cr&&(1&_t.mode)!=0)for(Ei=_t,Vt=_t.child;Vt!==null;){for(yt=Ei=Vt;Ei!==null;){var Vr=(Cr=Ei).child;switch(Cr.tag){case 0:case 11:case 14:case 15:qu(4,Cr,Cr.return);break;case 1:Bs(Cr,Cr.return);var Un=Cr.stateNode;if(typeof Un.componentWillUnmount=="function"){var Yn=Cr,ei=Cr.return;try{var xi=Yn;Un.props=xi.memoizedProps,Un.state=xi.memoizedState,Un.componentWillUnmount()}catch(Jn){ba(Yn,ei,Jn)}}break;case 5:Bs(Cr,Cr.return);break;case 22:if(Cr.memoizedState!==null){Eh(yt);continue}}Vr!==null?(Vr.return=Cr,Ei=Vr):Eh(yt)}Vt=Vt.sibling}if(Nt){e:if(Vt=null,Nt)for(yt=_t;;){if(yt.tag===5){if(Vt===null){Vt=yt;try{tr=yt.stateNode,Ct?yr(tr):Jr(yt.stateNode,yt.memoizedProps)}catch(Jn){ba(_t,_t.return,Jn)}}}else if(yt.tag===6){if(Vt===null)try{vr=yt.stateNode,Ct?Kr(vr):Zt(vr,yt.memoizedProps)}catch(Jn){ba(_t,_t.return,Jn)}}else if((yt.tag!==22&&yt.tag!==23||yt.memoizedState===null||yt===_t)&&yt.child!==null){yt.child.return=yt,yt=yt.child;continue}if(yt===_t)break e;for(;yt.sibling===null;){if(yt.return===null||yt.return===_t)break e;Vt===yt&&(Vt=null),yt=yt.return}Vt===yt&&(Vt=null),yt.sibling.return=yt.return,yt=yt.sibling}}}break;case 19:Eo(yt,_t),So(_t),4&Vt&&vc(_t);break;case 21:break;default:Eo(yt,_t),So(_t)}}function So(_t){var yt=_t.flags;if(2&yt){try{if(Nt){e:{for(var Ct=_t.return;Ct!==null;){if(Ls(Ct)){var Vt=Ct;break e}Ct=Ct.return}throw Error(at(160))}switch(Vt.tag){case 5:var tr=Vt.stateNode;32&Vt.flags&&(Rr(tr),Vt.flags&=-33),Zc(_t,Aa(_t),tr);break;case 3:case 4:var vr=Vt.stateNode.containerInfo;Vs(_t,Aa(_t),vr);break;default:throw Error(at(161))}}}catch(Cr){ba(_t,_t.return,Cr)}_t.flags&=-3}4096&yt&&(_t.flags&=-4097)}function kd(_t,yt,Ct){Ei=_t,Yu(_t)}function Yu(_t,yt,Ct){for(var Vt=(1&_t.mode)!=0;Ei!==null;){var tr=Ei,vr=tr.child;if(tr.tag===22&&Vt){var Cr=tr.memoizedState!==null||_u;if(!Cr){var Vr=tr.alternate,Un=Vr!==null&&Vr.memoizedState!==null||va;Vr=_u;var Yn=va;if(_u=Cr,(va=Un)&&!Yn)for(Ei=tr;Ei!==null;)Un=(Cr=Ei).child,Cr.tag===22&&Cr.memoizedState!==null?Sh(tr):Un!==null?(Un.return=Cr,Ei=Un):Sh(tr);for(;vr!==null;)Ei=vr,Yu(vr),vr=vr.sibling;Ei=tr,_u=Vr,va=Yn}bc(_t)}else(8772&tr.subtreeFlags)!=0&&vr!==null?(vr.return=tr,Ei=vr):bc(_t)}}function bc(_t){for(;Ei!==null;){var yt=Ei;if((8772&yt.flags)!=0){var Ct=yt.alternate;try{if((8772&yt.flags)!=0)switch(yt.tag){case 0:case 11:case 15:va||Zu(5,yt);break;case 1:var Vt=yt.stateNode;if(4&yt.flags&&!va)if(Ct===null)Vt.componentDidMount();else{var tr=yt.elementType===yt.type?Ct.memoizedProps:gs(yt.type,Ct.memoizedProps);Vt.componentDidUpdate(tr,Ct.memoizedState,Vt.__reactInternalSnapshotBeforeUpdate)}var vr=yt.updateQueue;vr!==null&&Du(yt,vr,Vt);break;case 3:var Cr=yt.updateQueue;if(Cr!==null){if(Ct=null,yt.child!==null)switch(yt.child.tag){case 5:Ct=Bt(yt.child.stateNode);break;case 1:Ct=yt.child.stateNode}Du(yt,Cr,Ct)}break;case 5:var Vr=yt.stateNode;Ct===null&&4&yt.flags&&_i(Vr,yt.type,yt.memoizedProps,yt);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(rr&&yt.memoizedState===null){var Un=yt.alternate;if(Un!==null){var Yn=Un.memoizedState;if(Yn!==null){var ei=Yn.dehydrated;ei!==null&&is(ei)}}}break;default:throw Error(at(163))}va||512&yt.flags&&yc(yt)}catch(xi){ba(yt,yt.return,xi)}}if(yt===_t){Ei=null;break}if((Ct=yt.sibling)!==null){Ct.return=yt.return,Ei=Ct;break}Ei=yt.return}}function Eh(_t){for(;Ei!==null;){var yt=Ei;if(yt===_t){Ei=null;break}var Ct=yt.sibling;if(Ct!==null){Ct.return=yt.return,Ei=Ct;break}Ei=yt.return}}function Sh(_t){for(;Ei!==null;){var yt=Ei;try{switch(yt.tag){case 0:case 11:case 15:var Ct=yt.return;try{Zu(4,yt)}catch(Un){ba(yt,Ct,Un)}break;case 1:var Vt=yt.stateNode;if(typeof Vt.componentDidMount=="function"){var tr=yt.return;try{Vt.componentDidMount()}catch(Un){ba(yt,tr,Un)}}var vr=yt.return;try{yc(yt)}catch(Un){ba(yt,vr,Un)}break;case 5:var Cr=yt.return;try{yc(yt)}catch(Un){ba(yt,Cr,Un)}}}catch(Un){ba(yt,yt.return,Un)}if(yt===_t){Ei=null;break}var Vr=yt.sibling;if(Vr!==null){Vr.return=yt.return,Ei=Vr;break}Ei=yt.return}}var _l=0,xc=1,vu=2,bu=3,yl=4;if(typeof Symbol=="function"&&Symbol.for){var xu=Symbol.for;_l=xu("selector.component"),xc=xu("selector.has_pseudo_class"),vu=xu("selector.role"),bu=xu("selector.test_id"),yl=xu("selector.text")}function wc(_t){var yt=ar(_t);if(yt!=null){if(typeof yt.memoizedProps["data-testname"]!="string")throw Error(at(364));return yt}if((_t=hr(_t))===null)throw Error(at(362));return _t.stateNode.current}function Ec(_t,yt){switch(yt.$$typeof){case _l:if(_t.type===yt.value)return!0;break;case xc:e:{yt=yt.value,_t=[_t,0];for(var Ct=0;Ct<_t.length;){var Vt=_t[Ct++],tr=_t[Ct++],vr=yt[tr];if(Vt.tag!==5||!Gn(Vt)){for(;vr!=null&&Ec(Vt,vr);)vr=yt[++tr];if(tr===yt.length){yt=!0;break e}for(Vt=Vt.child;Vt!==null;)_t.push(Vt,tr),Vt=Vt.sibling}}yt=!1}return yt;case vu:if(_t.tag===5&&Xn(_t.stateNode,yt.value))return!0;break;case yl:if((_t.tag===5||_t.tag===6)&&(_t=Br(_t))!==null&&0<=_t.indexOf(yt.value))return!0;break;case bu:if(_t.tag===5&&typeof(_t=_t.memoizedProps["data-testname"])=="string"&&_t.toLowerCase()===yt.value.toLowerCase())return!0;break;default:throw Error(at(365))}return!1}function Sc(_t){switch(_t.$$typeof){case _l:return"<"+(Ot(_t.value)||"Unknown")+">";case xc:return":has("+(Sc(_t)||"")+")";case vu:return'[role="'+_t.value+'"]';case yl:return'"'+_t.value+'"';case bu:return'[data-testname="'+_t.value+'"]';default:throw Error(at(365))}}function wu(_t,yt){var Ct=[];_t=[_t,0];for(var Vt=0;Vt<_t.length;){var tr=_t[Vt++],vr=_t[Vt++],Cr=yt[vr];if(tr.tag!==5||!Gn(tr)){for(;Cr!=null&&Ec(tr,Cr);)Cr=yt[++vr];if(vr===yt.length)Ct.push(tr);else for(tr=tr.child;tr!==null;)_t.push(tr,vr),tr=tr.sibling}}return Ct}function Fs(_t,yt){if(!or)throw Error(at(363));_t=wu(_t=wc(_t),yt),yt=[],_t=Array.from(_t);for(var Ct=0;Ct<_t.length;){var Vt=_t[Ct++];if(Vt.tag===5)Gn(Vt)||yt.push(Vt.stateNode);else for(Vt=Vt.child;Vt!==null;)_t.push(Vt),Vt=Vt.sibling}return yt}var Eu=Math.ceil,Xu=st.ReactCurrentDispatcher,Xc=st.ReactCurrentOwner,ga=st.ReactCurrentBatchConfig,Hi=0,Ha=null,za=null,Ra=0,Va=0,vl=Ps(0),Wa=0,Jl=null,eu=0,tu=0,To=0,bl=null,hs=null,xl=0,Tc=1/0,Ws=null;function Su(){Tc=Qi()+500}var Qc,Ta=!1,Qu=null,rl=null,Ku=!1,Do=null,Ju=0,Lo=0,Ia=null,Fa=-1,ja=0;function ts(){return(6&Hi)!=0?Qi():Fa!==-1?Fa:Fa=Qi()}function Ao(_t){return(1&_t.mode)==0?1:(2&Hi)!=0&&Ra!==0?Ra&-Ra:Mu.transition!==null?(ja===0&&(ja=Pu()),ja):(_t=Gi)!==0?_t:ur()}function bs(_t,yt,Ct,Vt){if(50<Lo)throw Lo=0,Ia=null,Error(at(185));Bl(_t,Ct,Vt),(2&Hi)!=0&&_t===Ha||(_t===Ha&&((2&Hi)==0&&(tu|=Ct),Wa===4&&nl(_t,Ra)),Ns(_t,Vt),Ct===1&&Hi===0&&(1&yt.mode)==0&&(Su(),no&&ms()))}function Ns(_t,yt){var Ct=_t.callbackNode;(function(tr,vr){for(var Cr=tr.suspendedLanes,Vr=tr.pingedLanes,Un=tr.expirationTimes,Yn=tr.pendingLanes;0<Yn;){var ei=31-Xa(Yn),xi=1<<ei,Jn=Un[ei];Jn===-1?(xi&Cr)!=0&&(xi&Vr)==0||(Un[ei]=Fc(xi,vr)):Jn<=vr&&(tr.expiredLanes|=xi),Yn&=~xi}})(_t,yt);var Vt=Ol(_t,_t===Ha?Ra:0);if(Vt===0)Ct!==null&&eo(Ct),_t.callbackNode=null,_t.callbackPriority=0;else if(yt=Vt&-Vt,_t.callbackPriority!==yt){if(Ct!=null&&eo(Ct),yt===1)_t.tag===0?(function(tr){no=!0,Po(tr)})(Fo.bind(null,_t)):Po(Fo.bind(null,_t)),Ut?Kt((function(){(6&Hi)==0&&ms()})):Ka(ul,ms),Ct=null;else{switch(Cs(Vt)){case 1:Ct=ul;break;case 4:Ct=Ll;break;case 16:default:Ct=Vo;break;case 536870912:Ct=Wo}Ct=Mh(Ct,ds.bind(null,_t))}_t.callbackPriority=yt,_t.callbackNode=Ct}}function ds(_t,yt){if(Fa=-1,ja=0,(6&Hi)!=0)throw Error(at(327));var Ct=_t.callbackNode;if(No()&&_t.callbackNode!==Ct)return null;var Vt=Ol(_t,_t===Ha?Ra:0);if(Vt===0)return null;if((30&Vt)!=0||(Vt&_t.expiredLanes)!=0||yt)yt=Ic(_t,Vt);else{yt=Vt;var tr=Hi;Hi|=2;var vr=Th();for(Ha===_t&&Ra===yt||(Ws=null,Su(),wl(_t,yt));;)try{Jh();break}catch(Vr){Kc(_t,Vr)}Gl(),Xu.current=vr,Hi=tr,za!==null?yt=0:(Ha=null,Ra=0,yt=Wa)}if(yt!==0){if(yt===2&&(tr=Yi(_t))!==0&&(Vt=tr,yt=Ac(_t,tr)),yt===1)throw Ct=Jl,wl(_t,0),nl(_t,Vt),Ns(_t,Qi()),Ct;if(yt===6)nl(_t,Vt);else{if(tr=_t.current.alternate,(30&Vt)==0&&!(function(Vr){for(var Un=Vr;;){if(16384&Un.flags){var Yn=Un.updateQueue;if(Yn!==null&&(Yn=Yn.stores)!==null)for(var ei=0;ei<Yn.length;ei++){var xi=Yn[ei],Jn=xi.getSnapshot;xi=xi.value;try{if(!ps(Jn(),xi))return!1}catch{return!1}}}if(Yn=Un.child,16384&Un.subtreeFlags&&Yn!==null)Yn.return=Un,Un=Yn;else{if(Un===Vr)break;for(;Un.sibling===null;){if(Un.return===null||Un.return===Vr)return!0;Un=Un.return}Un.sibling.return=Un.return,Un=Un.sibling}}return!0})(tr)&&((yt=Ic(_t,Vt))===2&&(vr=Yi(_t))!==0&&(Vt=vr,yt=Ac(_t,vr)),yt===1))throw Ct=Jl,wl(_t,0),nl(_t,Vt),Ns(_t,Qi()),Ct;switch(_t.finishedWork=tr,_t.finishedLanes=Vt,yt){case 0:case 1:throw Error(at(345));case 2:case 5:Au(_t,hs,Ws);break;case 3:if(nl(_t,Vt),(130023424&Vt)===Vt&&10<(yt=xl+500-Qi())){if(Ol(_t,0)!==0)break;if(((tr=_t.suspendedLanes)&Vt)!==Vt){ts(),_t.pingedLanes|=_t.suspendedLanes&tr;break}_t.timeoutHandle=br(Au.bind(null,_t,hs,Ws),yt);break}Au(_t,hs,Ws);break;case 4:if(nl(_t,Vt),(4194240&Vt)===Vt)break;for(yt=_t.eventTimes,tr=-1;0<Vt;){var Cr=31-Xa(Vt);vr=1<<Cr,(Cr=yt[Cr])>tr&&(tr=Cr),Vt&=~vr}if(Vt=tr,10<(Vt=(120>(Vt=Qi()-Vt)?120:480>Vt?480:1080>Vt?1080:1920>Vt?1920:3e3>Vt?3e3:4320>Vt?4320:1960*Eu(Vt/1960))-Vt)){_t.timeoutHandle=br(Au.bind(null,_t,hs,Ws),Vt);break}Au(_t,hs,Ws);break;default:throw Error(at(329))}}}return Ns(_t,Qi()),_t.callbackNode===Ct?ds.bind(null,_t):null}function Ac(_t,yt){var Ct=bl;return _t.current.memoizedState.isDehydrated&&(wl(_t,yt).flags|=256),(_t=Ic(_t,yt))!==2&&(yt=hs,hs=Ct,yt!==null&&Rc(yt)),_t}function Rc(_t){hs===null?hs=_t:hs.push.apply(hs,_t)}function nl(_t,yt){for(yt&=~To,yt&=~tu,_t.suspendedLanes|=yt,_t.pingedLanes&=~yt,_t=_t.expirationTimes;0<yt;){var Ct=31-Xa(yt),Vt=1<<Ct;_t[Ct]=-1,yt&=~Vt}}function Fo(_t){if((6&Hi)!=0)throw Error(at(327));No();var yt=Ol(_t,0);if((1&yt)==0)return Ns(_t,Qi()),null;var Ct=Ic(_t,yt);if(_t.tag!==0&&Ct===2){var Vt=Yi(_t);Vt!==0&&(yt=Vt,Ct=Ac(_t,Vt))}if(Ct===1)throw Ct=Jl,wl(_t,0),nl(_t,yt),Ns(_t,Qi()),Ct;if(Ct===6)throw Error(at(345));return _t.finishedWork=_t.current.alternate,_t.finishedLanes=yt,Au(_t,hs,Ws),Ns(_t,Qi()),null}function qs(_t){Do!==null&&Do.tag===0&&(6&Hi)==0&&No();var yt=Hi;Hi|=1;var Ct=ga.transition,Vt=Gi;try{if(ga.transition=null,Gi=1,_t)return _t()}finally{Gi=Vt,ga.transition=Ct,(6&(Hi=yt))==0&&ms()}}function Tu(){Va=vl.current,qi(vl)}function wl(_t,yt){_t.finishedWork=null,_t.finishedLanes=0;var Ct=_t.timeoutHandle;if(Ct!==Ir&&(_t.timeoutHandle=Ir,Sr(Ct)),za!==null)for(Ct=za.return;Ct!==null;){var Vt=Ct;switch(lu(Vt),Vt.tag){case 1:(Vt=Vt.type.childContextTypes)!=null&&jo();break;case 3:sr(),qi(ls),qi(Za),Zr();break;case 5:xr(Vt);break;case 4:sr();break;case 13:case 19:qi(Ar);break;case 10:Hl(Vt.type._context);break;case 22:case 23:Tu()}Ct=Ct.return}if(Ha=_t,za=_t=El(_t.current,null),Ra=Va=yt,Wa=0,Jl=null,To=tu=eu=0,hs=bl=null,Ko!==null){for(yt=0;yt<Ko.length;yt++)if((Vt=(Ct=Ko[yt]).interleaved)!==null){Ct.interleaved=null;var tr=Vt.next,vr=Ct.pending;if(vr!==null){var Cr=vr.next;vr.next=tr,Vt.next=Cr}Ct.pending=Vt}Ko=null}return _t}function Kc(_t,yt){for(;;){var Ct=za;try{if(Gl(),$r.current=$u,An){for(var Vt=Nr.memoizedState;Vt!==null;){var tr=Vt.queue;tr!==null&&(tr.pending=null),Vt=Vt.next}An=!1}if(Gr=0,Lr=Fr=Nr=null,Fn=!1,Yr=0,Xc.current=null,Ct===null||Ct.return===null){Wa=1,Jl=yt,za=null;break}e:{var vr=_t,Cr=Ct.return,Vr=Ct,Un=yt;if(yt=Ra,Vr.flags|=32768,Un!==null&&typeof Un=="object"&&typeof Un.then=="function"){var Yn=Un,ei=Vr,xi=ei.tag;if((1&ei.mode)==0&&(xi===0||xi===11||xi===15)){var Jn=ei.alternate;Jn?(ei.updateQueue=Jn.updateQueue,ei.memoizedState=Jn.memoizedState,ei.lanes=Jn.lanes):(ei.updateQueue=null,ei.memoizedState=null)}var ui=mu(Cr);if(ui!==null){ui.flags&=-257,Bo(ui,Cr,Vr,0,yt),1&ui.mode&&vh(vr,Yn,yt),Un=Yn;var Ii=(yt=ui).updateQueue;if(Ii===null){var Vi=new Set;Vi.add(Un),yt.updateQueue=Vi}else Ii.add(Un);break e}if((1&yt)==0){vh(vr,Yn,yt),Jc();break e}Un=Error(at(426))}else if(ia&&1&Vr.mode){var ti=mu(Cr);if(ti!==null){(65536&ti.flags)==0&&(ti.flags|=256),Bo(ti,Cr,Vr,0,yt),zl(zu(Un,Vr));break e}}vr=Un=zu(Un,Vr),Wa!==4&&(Wa=2),bl===null?bl=[vr]:bl.push(vr),vr=Cr;do{switch(vr.tag){case 3:vr.flags|=65536,yt&=-yt,vr.lanes|=yt,Bu(vr,Vc(0,Un,yt));break e;case 1:Vr=Un;var Xr=vr.type,Wn=vr.stateNode;if((128&vr.flags)==0&&(typeof Xr.getDerivedStateFromError=="function"||Wn!==null&&typeof Wn.componentDidCatch=="function"&&(rl===null||!rl.has(Wn)))){vr.flags|=65536,yt&=-yt,vr.lanes|=yt,Bu(vr,pl(vr,Vr,yt));break e}}vr=vr.return}while(vr!==null)}Rh(Ct)}catch(si){yt=si,za===Ct&&Ct!==null&&(za=Ct=Ct.return);continue}break}}function Th(){var _t=Xu.current;return Xu.current=$u,_t===null?$u:_t}function Jc(){Wa!==0&&Wa!==3&&Wa!==2||(Wa=4),Ha===null||(268435455&eu)==0&&(268435455&tu)==0||nl(Ha,Ra)}function Ic(_t,yt){var Ct=Hi;Hi|=2;var Vt=Th();for(Ha===_t&&Ra===yt||(Ws=null,wl(_t,yt));;)try{Kh();break}catch(tr){Kc(_t,tr)}if(Gl(),Hi=Ct,Xu.current=Vt,za!==null)throw Error(at(261));return Ha=null,Ra=0,Wa}function Kh(){for(;za!==null;)Ah(za)}function Jh(){for(;za!==null&&!Dl();)Ah(za)}function Ah(_t){var yt=Qc(_t.alternate,_t,Va);_t.memoizedProps=_t.pendingProps,yt===null?Rh(_t):za=yt,Xc.current=null}function Rh(_t){var yt=_t;do{var Ct=yt.alternate;if(_t=yt.return,(32768&yt.flags)==0){if((Ct=Wu(Ct,yt,Va))!==null)return void(za=Ct)}else{if((Ct=qc(Ct,yt))!==null)return Ct.flags&=32767,void(za=Ct);if(_t===null)return Wa=6,void(za=null);_t.flags|=32768,_t.subtreeFlags=0,_t.deletions=null}if((yt=yt.sibling)!==null)return void(za=yt);za=yt=_t}while(yt!==null);Wa===0&&(Wa=5)}function Au(_t,yt,Ct){var Vt=Gi,tr=ga.transition;try{ga.transition=null,Gi=1,(function(vr,Cr,Vr,Un){do No();while(Do!==null);if((6&Hi)!=0)throw Error(at(327));Vr=vr.finishedWork;var Yn=vr.finishedLanes;if(Vr===null)return null;if(vr.finishedWork=null,vr.finishedLanes=0,Vr===vr.current)throw Error(at(177));vr.callbackNode=null,vr.callbackPriority=0;var ei=Vr.lanes|Vr.childLanes;if((function(ui,Ii){var Vi=ui.pendingLanes&~Ii;ui.pendingLanes=Ii,ui.suspendedLanes=0,ui.pingedLanes=0,ui.expiredLanes&=Ii,ui.mutableReadLanes&=Ii,ui.entangledLanes&=Ii,Ii=ui.entanglements;var ti=ui.eventTimes;for(ui=ui.expirationTimes;0<Vi;){var Xr=31-Xa(Vi),Wn=1<<Xr;Ii[Xr]=0,ti[Xr]=-1,ui[Xr]=-1,Vi&=~Wn}})(vr,ei),vr===Ha&&(za=Ha=null,Ra=0),(2064&Vr.subtreeFlags)==0&&(2064&Vr.flags)==0||Ku||(Ku=!0,Mh(Vo,(function(){return No(),null}))),ei=(15990&Vr.flags)!=0,(15990&Vr.subtreeFlags)!=0||ei){ei=ga.transition,ga.transition=null;var xi=Gi;Gi=1;var Jn=Hi;Hi|=4,Xc.current=null,(function(ui,Ii){for(Wt(ui.containerInfo),Ei=Ii;Ei!==null;)if(Ii=(ui=Ei).child,(1028&ui.subtreeFlags)!=0&&Ii!==null)Ii.return=ui,Ei=Ii;else for(;Ei!==null;){ui=Ei;try{var Vi=ui.alternate;if((1024&ui.flags)!=0)switch(ui.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(Vi!==null){var ti=Vi.memoizedProps,Xr=Vi.memoizedState,Wn=ui.stateNode,si=Wn.getSnapshotBeforeUpdate(ui.elementType===ui.type?ti:gs(ui.type,ti),Xr);Wn.__reactInternalSnapshotBeforeUpdate=si}break;case 3:Nt&&Qr(ui.stateNode.containerInfo);break;default:throw Error(at(163))}}catch(Di){ba(ui,ui.return,Di)}if((Ii=ui.sibling)!==null){Ii.return=ui.return,Ei=Ii;break}Ei=ui.return}Vi=Kl,Kl=!1})(vr,Vr),yu(Vr,vr),Yt(vr.containerInfo),vr.current=Vr,kd(Vr),Pa(),Hi=Jn,Gi=xi,ga.transition=ei}else vr.current=Vr;if(Ku&&(Ku=!1,Do=vr,Ju=Yn),ei=vr.pendingLanes,ei===0&&(rl=null),(function(ui){if(Ca&&typeof Ca.onCommitFiberRoot=="function")try{Ca.onCommitFiberRoot(ou,ui,void 0,(128&ui.current.flags)==128)}catch{}})(Vr.stateNode),Ns(vr,Qi()),Cr!==null)for(Un=vr.onRecoverableError,Vr=0;Vr<Cr.length;Vr++)Yn=Cr[Vr],Un(Yn.value,{componentStack:Yn.stack,digest:Yn.digest});if(Ta)throw Ta=!1,vr=Qu,Qu=null,vr;(1&Ju)!=0&&vr.tag!==0&&No(),ei=vr.pendingLanes,(1&ei)!=0?vr===Ia?Lo++:(Lo=0,Ia=vr):Lo=0,ms()})(_t,yt,Ct,Vt)}finally{ga.transition=tr,Gi=Vt}return null}function No(){if(Do!==null){var _t=Cs(Ju),yt=ga.transition,Ct=Gi;try{if(ga.transition=null,Gi=16>_t?16:_t,Do===null)var Vt=!1;else{if(_t=Do,Do=null,Ju=0,(6&Hi)!=0)throw Error(at(331));var tr=Hi;for(Hi|=4,Ei=_t.current;Ei!==null;){var vr=Ei,Cr=vr.child;if((16&Ei.flags)!=0){var Vr=vr.deletions;if(Vr!==null){for(var Un=0;Un<Vr.length;Un++){var Yn=Vr[Un];for(Ei=Yn;Ei!==null;){var ei=Ei;switch(ei.tag){case 0:case 11:case 15:qu(8,ei,vr)}var xi=ei.child;if(xi!==null)xi.return=ei,Ei=xi;else for(;Ei!==null;){var Jn=(ei=Ei).sibling,ui=ei.return;if(Ds(ei),ei===Yn){Ei=null;break}if(Jn!==null){Jn.return=ui,Ei=Jn;break}Ei=ui}}}var Ii=vr.alternate;if(Ii!==null){var Vi=Ii.child;if(Vi!==null){Ii.child=null;do{var ti=Vi.sibling;Vi.sibling=null,Vi=ti}while(Vi!==null)}}Ei=vr}}if((2064&vr.subtreeFlags)!=0&&Cr!==null)Cr.return=vr,Ei=Cr;else e:for(;Ei!==null;){if((2048&(vr=Ei).flags)!=0)switch(vr.tag){case 0:case 11:case 15:qu(9,vr,vr.return)}var Xr=vr.sibling;if(Xr!==null){Xr.return=vr.return,Ei=Xr;break e}Ei=vr.return}}var Wn=_t.current;for(Ei=Wn;Ei!==null;){var si=(Cr=Ei).child;if((2064&Cr.subtreeFlags)!=0&&si!==null)si.return=Cr,Ei=si;else e:for(Cr=Wn;Ei!==null;){if((2048&(Vr=Ei).flags)!=0)try{switch(Vr.tag){case 0:case 11:case 15:Zu(9,Vr)}}catch(aa){ba(Vr,Vr.return,aa)}if(Vr===Cr){Ei=null;break e}var Di=Vr.sibling;if(Di!==null){Di.return=Vr.return,Ei=Di;break e}Ei=Vr.return}}if(Hi=tr,ms(),Ca&&typeof Ca.onPostCommitFiberRoot=="function")try{Ca.onPostCommitFiberRoot(ou,_t)}catch{}Vt=!0}return Vt}finally{Gi=Ct,ga.transition=yt}}return!1}function Ih(_t,yt,Ct){_t=uo(_t,yt=Vc(0,yt=zu(Ct,yt),1),1),yt=ts(),_t!==null&&(Bl(_t,1,yt),Ns(_t,yt))}function ba(_t,yt,Ct){if(_t.tag===3)Ih(_t,_t,Ct);else for(;yt!==null;){if(yt.tag===3){Ih(yt,_t,Ct);break}if(yt.tag===1){var Vt=yt.stateNode;if(typeof yt.type.getDerivedStateFromError=="function"||typeof Vt.componentDidCatch=="function"&&(rl===null||!rl.has(Vt))){yt=uo(yt,_t=pl(yt,_t=zu(Ct,_t),1),1),_t=ts(),yt!==null&&(Bl(yt,1,_t),Ns(yt,_t));break}}yt=yt.return}}function eh(_t,yt,Ct){var Vt=_t.pingCache;Vt!==null&&Vt.delete(yt),yt=ts(),_t.pingedLanes|=_t.suspendedLanes&Ct,Ha===_t&&(Ra&Ct)===Ct&&(Wa===4||Wa===3&&(130023424&Ra)===Ra&&500>Qi()-xl?wl(_t,0):To|=Ct),Ns(_t,yt)}function Ph(_t,yt){yt===0&&((1&_t.mode)==0?yt=1:(yt=kl,(130023424&(kl<<=1))==0&&(kl=4194304)));var Ct=ts();(_t=oo(_t,yt))!==null&&(Bl(_t,yt,Ct),Ns(_t,Ct))}function Ch(_t){var yt=_t.memoizedState,Ct=0;yt!==null&&(Ct=yt.retryLane),Ph(_t,Ct)}function ed(_t,yt){var Ct=0;switch(_t.tag){case 13:var Vt=_t.stateNode,tr=_t.memoizedState;tr!==null&&(Ct=tr.retryLane);break;case 19:Vt=_t.stateNode;break;default:throw Error(at(314))}Vt!==null&&Vt.delete(yt),Ph(_t,Ct)}function Mh(_t,yt){return Ka(_t,yt)}function td(_t,yt,Ct,Vt){this.tag=_t,this.key=Ct,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=yt,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Vt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zs(_t,yt,Ct,Vt){return new td(_t,yt,Ct,Vt)}function Pc(_t){return!(!(_t=_t.prototype)||!_t.isReactComponent)}function El(_t,yt){var Ct=_t.alternate;return Ct===null?((Ct=Zs(_t.tag,yt,_t.key,_t.mode)).elementType=_t.elementType,Ct.type=_t.type,Ct.stateNode=_t.stateNode,Ct.alternate=_t,_t.alternate=Ct):(Ct.pendingProps=yt,Ct.type=_t.type,Ct.flags=0,Ct.subtreeFlags=0,Ct.deletions=null),Ct.flags=14680064&_t.flags,Ct.childLanes=_t.childLanes,Ct.lanes=_t.lanes,Ct.child=_t.child,Ct.memoizedProps=_t.memoizedProps,Ct.memoizedState=_t.memoizedState,Ct.updateQueue=_t.updateQueue,yt=_t.dependencies,Ct.dependencies=yt===null?null:{lanes:yt.lanes,firstContext:yt.firstContext},Ct.sibling=_t.sibling,Ct.index=_t.index,Ct.ref=_t.ref,Ct}function Cc(_t,yt,Ct,Vt,tr,vr){var Cr=2;if(Vt=_t,typeof _t=="function")Pc(_t)&&(Cr=1);else if(typeof _t=="string")Cr=5;else e:switch(_t){case ht:return ru(Ct.children,tr,vr,yt);case dt:Cr=8,tr|=8;break;case ut:return(_t=Zs(12,Ct,yt,2|tr)).elementType=ut,_t.lanes=vr,_t;case vt:return(_t=Zs(13,Ct,yt,tr)).elementType=vt,_t.lanes=vr,_t;case xt:return(_t=Zs(19,Ct,yt,tr)).elementType=xt,_t.lanes=vr,_t;case Tt:return th(Ct,tr,vr,yt);default:if(typeof _t=="object"&&_t!==null)switch(_t.$$typeof){case ft:Cr=10;break e;case mt:Cr=9;break e;case gt:Cr=11;break e;case wt:Cr=14;break e;case At:Cr=16,Vt=null;break e}throw Error(at(130,_t==null?_t:typeof _t,""))}return(yt=Zs(Cr,Ct,yt,tr)).elementType=_t,yt.type=Vt,yt.lanes=vr,yt}function ru(_t,yt,Ct,Vt){return(_t=Zs(7,_t,Vt,yt)).lanes=Ct,_t}function th(_t,yt,Ct,Vt){return(_t=Zs(22,_t,Vt,yt)).elementType=Tt,_t.lanes=Ct,_t.stateNode={isHidden:!1},_t}function rh(_t,yt,Ct){return(_t=Zs(6,_t,null,yt)).lanes=Ct,_t}function kh(_t,yt,Ct){return(yt=Zs(4,_t.children!==null?_t.children:[],_t.key,yt)).lanes=Ct,yt.stateNode={containerInfo:_t.containerInfo,pendingChildren:null,implementation:_t.implementation},yt}function Od(_t,yt,Ct,Vt,tr){this.tag=yt,this.containerInfo=_t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ir,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cu(0),this.expirationTimes=Cu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cu(0),this.identifierPrefix=Vt,this.onRecoverableError=tr,rr&&(this.mutableSourceEagerHydrationData=null)}function Oh(_t,yt,Ct,Vt,tr,vr,Cr,Vr,Un){return _t=new Od(_t,yt,Ct,Vr,Un),yt===1?(yt=1,vr===!0&&(yt|=8)):yt=0,vr=Zs(3,null,null,yt),_t.current=vr,vr.stateNode=_t,vr.memoizedState={element:Vt,isDehydrated:Ct,cache:null,transitions:null,pendingSuspenseBoundaries:null},lc(vr),_t}function Bh(_t){if(!_t)return Fi;e:{if(Lt(_t=_t._reactInternals)!==_t||_t.tag!==1)throw Error(at(170));var yt=_t;do{switch(yt.tag){case 3:yt=yt.stateNode.context;break e;case 1:if(Ya(yt.type)){yt=yt.stateNode.__reactInternalMemoizedMergedChildContext;break e}}yt=yt.return}while(yt!==null);throw Error(at(171))}if(_t.tag===1){var Ct=_t.type;if(Ya(Ct))return ma(_t,Ct,yt)}return yt}function Dh(_t){var yt=_t._reactInternals;if(yt===void 0)throw typeof _t.render=="function"?Error(at(188)):(_t=Object.keys(_t).join(","),Error(at(268,_t)));return(_t=Mt(yt))===null?null:_t.stateNode}function Mc(_t,yt){if((_t=_t.memoizedState)!==null&&_t.dehydrated!==null){var Ct=_t.retryLane;_t.retryLane=Ct!==0&&Ct<yt?Ct:yt}}function nh(_t,yt){Mc(_t,yt),(_t=_t.alternate)&&Mc(_t,yt)}function Bd(_t){return(_t=Mt(_t))===null?null:_t.stateNode}function Dd(){return null}return Qc=function(_t,yt,Ct){if(_t!==null)if(_t.memoizedProps!==yt.pendingProps||ls.current)La=!0;else{if((_t.lanes&Ct)==0&&(128&yt.flags)==0)return La=!1,(function(xi,Jn,ui){switch(Jn.tag){case 3:ml(Jn),so();break;case 5:gr(Jn);break;case 1:Ya(Jn.type)&&Go(Jn);break;case 4:Jt(Jn,Jn.stateNode.containerInfo);break;case 10:ku(0,Jn.type._context,Jn.memoizedProps.value);break;case 13:var Ii=Jn.memoizedState;if(Ii!==null)return Ii.dehydrated!==null?(pa(Ar,1&Ar.current),Jn.flags|=128,null):(ui&Jn.child.childLanes)!=0?As(xi,Jn,ui):(pa(Ar,1&Ar.current),(xi=_o(xi,Jn,ui))!==null?xi.sibling:null);pa(Ar,1&Ar.current);break;case 19:if(Ii=(ui&Jn.childLanes)!=0,(128&xi.flags)!=0){if(Ii)return xh(xi,Jn,ui);Jn.flags|=128}var Vi=Jn.memoizedState;if(Vi!==null&&(Vi.rendering=null,Vi.tail=null,Vi.lastEffect=null),pa(Ar,Ar.current),Ii)break;return null;case 22:case 23:return Jn.lanes=0,ju(xi,Jn,ui)}return _o(xi,Jn,ui)})(_t,yt,Ct);La=(131072&_t.flags)!=0}else La=!1,ia&&(1048576&yt.flags)!=0&&hl(yt,cl,yt.index);switch(yt.lanes=0,yt.tag){case 2:var Vt=yt.type;go(_t,yt),_t=yt.pendingProps;var tr=Ts(yt,Za.current);Qo(yt,Ct),tr=di(null,yt,Vt,_t,tr,Ct);var vr=ni();return yt.flags|=1,typeof tr=="object"&&tr!==null&&typeof tr.render=="function"&&tr.$$typeof===void 0?(yt.tag=1,yt.memoizedState=null,yt.updateQueue=null,Ya(Vt)?(vr=!0,Go(yt)):vr=!1,yt.memoizedState=tr.state!==null&&tr.state!==void 0?tr.state:null,lc(yt),tr.updater=fu,yt.stateNode=tr,tr._reactInternals=yt,Wl(yt,Vt,_t,Ct),yt=Xl(null,yt,Vt,!0,vr,Ct)):(yt.tag=0,ia&&vr&&Zo(yt),ys(null,yt,tr,Ct),yt=yt.child),yt;case 16:Vt=yt.elementType;e:{switch(go(_t,yt),_t=yt.pendingProps,Vt=(tr=Vt._init)(Vt._payload),yt.type=Vt,tr=yt.tag=(function(xi){if(typeof xi=="function")return Pc(xi)?1:0;if(xi!=null){if((xi=xi.$$typeof)===gt)return 11;if(xi===wt)return 14}return 2})(Vt),_t=gs(Vt,_t),tr){case 0:yt=Gu(null,yt,Vt,_t,Ct);break e;case 1:yt=Wc(null,yt,Vt,_t,Ct);break e;case 11:yt=Yh(null,yt,Vt,_t,Ct);break e;case 14:yt=Xh(null,yt,Vt,gs(Vt.type,_t),Ct);break e}throw Error(at(306,Vt,""))}return yt;case 0:return Vt=yt.type,tr=yt.pendingProps,Gu(_t,yt,Vt,tr=yt.elementType===Vt?tr:gs(Vt,tr),Ct);case 1:return Vt=yt.type,tr=yt.pendingProps,Wc(_t,yt,Vt,tr=yt.elementType===Vt?tr:gs(Vt,tr),Ct);case 3:e:{if(ml(yt),_t===null)throw Error(at(387));Vt=yt.pendingProps,tr=(vr=yt.memoizedState).element,uc(_t,yt),Vl(yt,Vt,null,Ct);var Cr=yt.memoizedState;if(Vt=Cr.element,rr&&vr.isDehydrated){if(vr={element:Vt,isDehydrated:!1,cache:Cr.cache,pendingSuspenseBoundaries:Cr.pendingSuspenseBoundaries,transitions:Cr.transitions},yt.updateQueue.baseState=vr,yt.memoizedState=vr,256&yt.flags){yt=Sa(_t,yt,Vt,Ct,tr=zu(Error(at(423)),yt));break e}if(Vt!==tr){yt=Sa(_t,yt,Vt,Ct,tr=zu(Error(at(424)),yt));break e}for(rr&&(Ba=ua(yt.stateNode.containerInfo),ha=yt,ia=!0,js=null,ao=!1),Ct=fl(yt,null,Vt,Ct),yt.child=Ct;Ct;)Ct.flags=-3&Ct.flags|4096,Ct=Ct.sibling}else{if(so(),Vt===tr){yt=_o(_t,yt,Ct);break e}ys(_t,yt,Vt,Ct)}yt=yt.child}return yt;case 5:return gr(yt),_t===null&&Yo(yt),Vt=yt.type,tr=yt.pendingProps,vr=_t!==null?_t.memoizedProps:null,Cr=tr.children,lr(Vt,tr)?Cr=null:vr!==null&&lr(Vt,vr)&&(yt.flags|=32),gu(_t,yt),ys(_t,yt,Cr,Ct),yt.child;case 6:return _t===null&&Yo(yt),null;case 13:return As(_t,yt,Ct);case 4:return Jt(yt,yt.stateNode.containerInfo),Vt=yt.pendingProps,_t===null?yt.child=Os(yt,null,Vt,Ct):ys(_t,yt,Vt,Ct),yt.child;case 11:return Vt=yt.type,tr=yt.pendingProps,Yh(_t,yt,Vt,tr=yt.elementType===Vt?tr:gs(Vt,tr),Ct);case 7:return ys(_t,yt,yt.pendingProps,Ct),yt.child;case 8:case 12:return ys(_t,yt,yt.pendingProps.children,Ct),yt.child;case 10:e:{if(Vt=yt.type._context,tr=yt.pendingProps,vr=yt.memoizedProps,ku(0,Vt,Cr=tr.value),vr!==null)if(ps(vr.value,Cr)){if(vr.children===tr.children&&!ls.current){yt=_o(_t,yt,Ct);break e}}else for((vr=yt.child)!==null&&(vr.return=yt);vr!==null;){var Vr=vr.dependencies;if(Vr!==null){Cr=vr.child;for(var Un=Vr.firstContext;Un!==null;){if(Un.context===Vt){if(vr.tag===1){(Un=lo(-1,Ct&-Ct)).tag=2;var Yn=vr.updateQueue;if(Yn!==null){var ei=(Yn=Yn.shared).pending;ei===null?Un.next=Un:(Un.next=ei.next,ei.next=Un),Yn.pending=Un}}vr.lanes|=Ct,(Un=vr.alternate)!==null&&(Un.lanes|=Ct),oc(vr.return,Ct,yt),Vr.lanes|=Ct;break}Un=Un.next}}else if(vr.tag===10)Cr=vr.type===yt.type?null:vr.child;else if(vr.tag===18){if((Cr=vr.return)===null)throw Error(at(341));Cr.lanes|=Ct,(Vr=Cr.alternate)!==null&&(Vr.lanes|=Ct),oc(Cr,Ct,yt),Cr=vr.sibling}else Cr=vr.child;if(Cr!==null)Cr.return=vr;else for(Cr=vr;Cr!==null;){if(Cr===yt){Cr=null;break}if((vr=Cr.sibling)!==null){vr.return=Cr.return,Cr=vr;break}Cr=Cr.return}vr=Cr}ys(_t,yt,tr.children,Ct),yt=yt.child}return yt;case 9:return tr=yt.type,Vt=yt.pendingProps.children,Qo(yt,Ct),Vt=Vt(tr=us(tr)),yt.flags|=1,ys(_t,yt,Vt,Ct),yt.child;case 14:return tr=gs(Vt=yt.type,yt.pendingProps),Xh(_t,yt,Vt,tr=gs(Vt.type,tr),Ct);case 15:return Yl(_t,yt,yt.type,yt.pendingProps,Ct);case 17:return Vt=yt.type,tr=yt.pendingProps,tr=yt.elementType===Vt?tr:gs(Vt,tr),go(_t,yt),yt.tag=1,Ya(Vt)?(_t=!0,Go(yt)):_t=!1,Qo(yt,Ct),ho(yt,Vt,tr),Wl(yt,Vt,tr,Ct),Xl(null,yt,Vt,!0,_t,Ct);case 19:return xh(_t,yt,Ct);case 22:return ju(_t,yt,Ct)}throw Error(at(156,yt.tag))},et.attemptContinuousHydration=function(_t){if(_t.tag===13){var yt=oo(_t,134217728);yt!==null&&bs(yt,_t,134217728,ts()),nh(_t,134217728)}},et.attemptDiscreteHydration=function(_t){if(_t.tag===13){var yt=oo(_t,1);yt!==null&&bs(yt,_t,1,ts()),nh(_t,1)}},et.attemptHydrationAtCurrentPriority=function(_t){if(_t.tag===13){var yt=Ao(_t),Ct=oo(_t,yt);Ct!==null&&bs(Ct,_t,yt,ts()),nh(_t,yt)}},et.attemptSynchronousHydration=function(_t){switch(_t.tag){case 3:var yt=_t.stateNode;if(yt.current.memoizedState.isDehydrated){var Ct=Zi(yt.pendingLanes);Ct!==0&&(Qa(yt,1|Ct),Ns(yt,Qi()),(6&Hi)==0&&(Su(),ms()))}break;case 13:qs((function(){var Vt=oo(_t,1);if(Vt!==null){var tr=ts();bs(Vt,_t,1,tr)}})),nh(_t,1)}},et.batchedUpdates=function(_t,yt){var Ct=Hi;Hi|=1;try{return _t(yt)}finally{(Hi=Ct)===0&&(Su(),no&&ms())}},et.createComponentSelector=function(_t){return{$$typeof:_l,value:_t}},et.createContainer=function(_t,yt,Ct,Vt,tr,vr,Cr){return Oh(_t,yt,!1,null,0,Vt,0,vr,Cr)},et.createHasPseudoClassSelector=function(_t){return{$$typeof:xc,value:_t}},et.createHydrationContainer=function(_t,yt,Ct,Vt,tr,vr,Cr,Vr,Un){return(_t=Oh(Ct,Vt,!0,_t,0,vr,0,Vr,Un)).context=Bh(null),Ct=_t.current,(vr=lo(Vt=ts(),tr=Ao(Ct))).callback=yt??null,uo(Ct,vr,tr),_t.current.lanes=tr,Bl(_t,tr,Vt),Ns(_t,Vt),_t},et.createPortal=function(_t,yt,Ct){var Vt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:lt,key:Vt==null?null:""+Vt,children:_t,containerInfo:yt,implementation:Ct}},et.createRoleSelector=function(_t){return{$$typeof:vu,value:_t}},et.createTestNameSelector=function(_t){return{$$typeof:bu,value:_t}},et.createTextSelector=function(_t){return{$$typeof:yl,value:_t}},et.deferredUpdates=function(_t){var yt=Gi,Ct=ga.transition;try{return ga.transition=null,Gi=16,_t()}finally{Gi=yt,ga.transition=Ct}},et.discreteUpdates=function(_t,yt,Ct,Vt,tr){var vr=Gi,Cr=ga.transition;try{return ga.transition=null,Gi=1,_t(yt,Ct,Vt,tr)}finally{Gi=vr,ga.transition=Cr,Hi===0&&Su()}},et.findAllNodes=Fs,et.findBoundingRects=function(_t,yt){if(!or)throw Error(at(363));yt=Fs(_t,yt),_t=[];for(var Ct=0;Ct<yt.length;Ct++)_t.push(kr(yt[Ct]));for(yt=_t.length-1;0<yt;yt--)for(var Vt=(Ct=_t[yt]).x,tr=Vt+Ct.width,vr=Ct.y,Cr=vr+Ct.height,Vr=yt-1;0<=Vr;Vr--)if(yt!==Vr){var Un=_t[Vr],Yn=Un.x,ei=Yn+Un.width,xi=Un.y,Jn=xi+Un.height;if(Vt>=Yn&&vr>=xi&&tr<=ei&&Cr<=Jn){_t.splice(yt,1);break}if(!(Vt!==Yn||Ct.width!==Un.width||Jn<vr||xi>Cr)){xi>vr&&(Un.height+=xi-vr,Un.y=vr),Jn<Cr&&(Un.height=Cr-xi),_t.splice(yt,1);break}if(!(vr!==xi||Ct.height!==Un.height||ei<Vt||Yn>tr)){Yn>Vt&&(Un.width+=Yn-Vt,Un.x=Vt),ei<tr&&(Un.width=tr-Yn),_t.splice(yt,1);break}}return _t},et.findHostInstance=Dh,et.findHostInstanceWithNoPortals=function(_t){return(_t=(_t=jt(_t))!==null?Qt(_t):null)===null?null:_t.stateNode},et.findHostInstanceWithWarning=function(_t){return Dh(_t)},et.flushControlled=function(_t){var yt=Hi;Hi|=1;var Ct=ga.transition,Vt=Gi;try{ga.transition=null,Gi=1,_t()}finally{Gi=Vt,ga.transition=Ct,(Hi=yt)===0&&(Su(),ms())}},et.flushPassiveEffects=No,et.flushSync=qs,et.focusWithin=function(_t,yt){if(!or)throw Error(at(363));for(yt=wu(_t=wc(_t),yt),yt=Array.from(yt),_t=0;_t<yt.length;){var Ct=yt[_t++];if(!Gn(Ct)){if(Ct.tag===5&&Mn(Ct.stateNode))return!0;for(Ct=Ct.child;Ct!==null;)yt.push(Ct),Ct=Ct.sibling}}return!1},et.getCurrentUpdatePriority=function(){return Gi},et.getFindAllNodesFailureDescription=function(_t,yt){if(!or)throw Error(at(363));var Ct=0,Vt=[];_t=[wc(_t),0];for(var tr=0;tr<_t.length;){var vr=_t[tr++],Cr=_t[tr++],Vr=yt[Cr];if((vr.tag!==5||!Gn(vr))&&(Ec(vr,Vr)&&(Vt.push(Sc(Vr)),++Cr>Ct&&(Ct=Cr)),Cr<yt.length))for(vr=vr.child;vr!==null;)_t.push(vr,Cr),vr=vr.sibling}if(Ct<yt.length){for(_t=[];Ct<yt.length;Ct++)_t.push(Sc(yt[Ct]));return`findAllNodes was able to match part of the selector:
  `+Vt.join(" > ")+`

No matching component was found for:
  `+_t.join(" > ")}return null},et.getPublicRootInstance=function(_t){return(_t=_t.current).child?_t.child.tag===5?Bt(_t.child.stateNode):_t.child.stateNode:null},et.injectIntoDevTools=function(_t){if(_t={bundleType:_t.bundleType,version:_t.version,rendererPackageName:_t.rendererPackageName,rendererConfig:_t.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:st.ReactCurrentDispatcher,findHostInstanceByFiber:Bd,findFiberByHostInstance:_t.findFiberByHostInstance||Dd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")_t=!1;else{var yt=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(yt.isDisabled||!yt.supportsFiber)_t=!0;else{try{ou=yt.inject(_t),Ca=yt}catch{}_t=!!yt.checkDCE}}return _t},et.isAlreadyRendering=function(){return!1},et.observeVisibleRects=function(_t,yt,Ct,Vt){if(!or)throw Error(at(363));_t=Fs(_t,yt);var tr=Kn(_t,Ct,Vt).disconnect;return{disconnect:function(){tr()}}},et.registerMutableSourceForHydration=function(_t,yt){var Ct=yt._getVersion;Ct=Ct(yt._source),_t.mutableSourceEagerHydrationData==null?_t.mutableSourceEagerHydrationData=[yt,Ct]:_t.mutableSourceEagerHydrationData.push(yt,Ct)},et.runWithPriority=function(_t,yt){var Ct=Gi;try{return Gi=_t,yt()}finally{Gi=Ct}},et.shouldError=function(){return null},et.shouldSuspend=function(){return!1},et.updateContainer=function(_t,yt,Ct,Vt){var tr=yt.current,vr=ts(),Cr=Ao(tr);return Ct=Bh(Ct),yt.context===null?yt.context=Ct:yt.pendingContext=Ct,(yt=lo(vr,Cr)).payload={element:_t},(Vt=Vt===void 0?null:Vt)!==null&&(yt.callback=Vt),(_t=uo(tr,yt,Cr))!==null&&(bs(_t,tr,Cr,vr),Oo(_t,tr,Cr)),Cr},et}),ke}({get exports(){return Ee},set exports(tt){Ee=tt}}).exports=Te();var Ie=I(Ee),Re={name:"root",dependencies:{"react-dom":"^18.0.0"}},Oe={},je={get exports(){return Oe},set exports(tt){Oe=tt}};(function(){var tt,et,rt,nt,it,at;typeof performance<"u"&&performance!==null&&performance.now?je.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(je.exports=function(){return(tt()-it)/1e6},et=process.hrtime,nt=(tt=function(){var st;return 1e9*(st=et())[0]+st[1]})(),at=1e9*process.uptime(),it=nt-at):Date.now?(je.exports=function(){return Date.now()-rt},rt=Date.now()):(je.exports=function(){return new Date().getTime()-rt},rt=new Date().getTime())}).call(T$1);var Le,De={},Me={};({get exports(){return De},set exports(tt){De=tt}}).exports=(Le||(Le=1,Me.ConcurrentRoot=1,Me.ContinuousEventPriority=4,Me.DefaultEventPriority=16,Me.DiscreteEventPriority=1,Me.IdleEventPriority=536870912,Me.LegacyRoot=0),Me);var Ue={};function Fe(tt,et){tt.addChild&&(tt.addChild(et),typeof et.didMount=="function"&&et.didMount(et,tt))}function Ae(tt,et){var rt,nt,it;(rt=tt.willUnmount)===null||rt===void 0||rt.call(tt,tt,et),((nt=tt.config)===null||nt===void 0?void 0:nt.destroyChildren)!==!1&&(it=tt.children)!==null&&it!==void 0&&it.length&&z$1(tt.children).forEach((function(at){Ae(at,tt)}))}function Qe(tt,et){var rt;Ae(et,tt),tt.removeChild(et);var nt=(rt=et.config)!==null&&rt!==void 0?rt:{},it=nt.destroy,at=it===void 0||it,st=nt.destroyChildren,ot=st===void 0||st,lt=nt.destroyTexture,ht=lt!==void 0&&lt,dt=nt.destroyBaseTexture,ut=dt!==void 0&&dt;at&&et.destroy({children:ot,texture:ht,baseTexture:ut})}function He(tt,et,rt){var nt,it;N$1(et!==rt,"Cannot insert node before itself"),tt.children.indexOf(et)!==-1&&tt.removeChild(et);var at=tt.getChildIndex(rt);tt.addChildAt(et,at),(nt=tt.__reactpixi)===null||nt===void 0||(it=nt.root)===null||it===void 0||it.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"insertBefore"})}var Be=null,We=Ie({getRootHostContext:function(){return Ue},getChildHostContext:function(tt){return tt},getChildHostContextForEventComponent:function(tt){return tt},getPublicInstance:function(tt){return tt},getCurrentEventPriority:function(){return(function(){var tt,et;if(typeof window>"u")return De.DefaultEventPriority;switch((tt=window)===null||tt===void 0||(et=tt.event)===null||et===void 0?void 0:et.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return De.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return De.ContinuousEventPriority;default:return De.DefaultEventPriority}})()},prepareForCommit:function(){return null},resetAfterCommit:function(){},createInstance:function(tt){var et,rt,nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},it=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,at=ye[tt];if(typeof at=="function"&&(et=at(it,nt)),!et){var st=be[tt];st&&((et=st.create(nt,{root:it})).didMount=st.didMount?st.didMount.bind(et):void 0,et.willUnmount=st.willUnmount?st.willUnmount.bind(et):void 0,et.applyProps=st.applyProps?st.applyProps.bind(et):void 0,et.config=st.config)}return et&&(et.__reactpixi={root:it},(typeof((rt=et)===null||rt===void 0?void 0:rt.applyProps)=="function"?et.applyProps:V)(et,{},nt)),et},hideInstance:function(tt){tt.visible=!1},unhideInstance:function(tt,et){var rt=et==null||!et.hasOwnProperty("visible")||et.visible;tt.visible=rt},finalizeInitialChildren:function(tt,et,rt){return!1},prepareUpdate:function(tt,et,rt,nt,it,at){return Be=(function(st,ot,lt,ht){var dt=null;for(var ut in lt)!ht.hasOwnProperty(ut)&&lt.hasOwnProperty(ut)&&lt[ut]!==null&&(ut===Q||(dt||(dt=[]),dt.push(ut,null)));for(var ft in ht){var mt=ht[ft],gt=lt!==null?lt[ft]:void 0;!ht.hasOwnProperty(ft)||mt===gt||mt===null&&gt===null||ft===Q||(dt||(dt=[]),dt.push(ft,mt))}return dt})(0,0,rt,nt)},shouldSetTextContent:function(tt,et){return!1},shouldDeprioritizeSubtree:function(tt,et){var rt=et.alpha===void 0||et.alpha>0,nt=et.renderable===void 0||et.renderable===!0,it=et.visible===void 0||et.visible===!0;return!(rt&&nt&&it)},createTextInstance:function(tt,et,rt){N$1(!1,'Error trying to add text node "'.concat(tt,'"'),"text strings as children of a Pixi component is not supported. To add some text, use &lt;Text text={string} /&gt;")},unhideTextInstance:function(tt,et){},mountEventComponent:function(){},updateEventComponent:function(){},handleEventTarget:function(){},scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,noTimeout:-1,warnsIfNotActing:!1,now:Oe,isPrimaryRenderer:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,supportsMicrotasks:!0,scheduleMicrotask:queueMicrotask,appendInitialChild:function(){for(var tt,et,rt=arguments.length,nt=new Array(rt),it=0;it<rt;it++)nt[it]=arguments[it];var at=Fe.apply(null,nt);return(tt=nt[0].__reactpixi)===null||tt===void 0||(et=tt.root)===null||et===void 0||et.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendInitialChild"}),at},appendChild:function(){for(var tt,et,rt=arguments.length,nt=new Array(rt),it=0;it<rt;it++)nt[it]=arguments[it];var at=Fe.apply(null,nt);return(tt=nt[0].__reactpixi)===null||tt===void 0||(et=tt.root)===null||et===void 0||et.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChild"}),at},appendChildToContainer:function(){for(var tt,et,rt=arguments.length,nt=new Array(rt),it=0;it<rt;it++)nt[it]=arguments[it];var at=Fe.apply(null,nt);return(tt=nt[0].__reactpixi)===null||tt===void 0||(et=tt.root)===null||et===void 0||et.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChildToContainer"}),at},removeChild:function(){for(var tt,et,rt=arguments.length,nt=new Array(rt),it=0;it<rt;it++)nt[it]=arguments[it];var at=Qe.apply(null,nt);return(tt=nt[0].__reactpixi)===null||tt===void 0||(et=tt.root)===null||et===void 0||et.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChild"}),at},removeChildFromContainer:function(){for(var tt,et,rt=arguments.length,nt=new Array(rt),it=0;it<rt;it++)nt[it]=arguments[it];var at=Qe.apply(null,nt);return(tt=nt[0].__reactpixi)===null||tt===void 0||(et=tt.root)===null||et===void 0||et.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChildFromContainer"}),at},insertBefore:He,insertInContainerBefore:function(){for(var tt,et,rt=arguments.length,nt=new Array(rt),it=0;it<rt;it++)nt[it]=arguments[it];var at=He.apply(null,nt);return(tt=nt[0].__reactpixi)===null||tt===void 0||(et=tt.root)===null||et===void 0||et.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"insertInContainerBefore"}),at},commitUpdate:function(tt,et,rt,nt,it){var at,st,ot=tt&&tt.applyProps;typeof ot!="function"&&(ot=V),(ot(tt,nt,it)||Be)&&((at=tt.__reactpixi)===null||at===void 0||(st=at.root)===null||st===void 0||st.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"commitUpdate"}))},commitMount:function(tt,et,rt,nt,it){},commitTextUpdate:function(tt,et,rt){},resetTextContent:function(tt){},clearContainer:function(tt){},getFundamentalComponentInstance:function(tt){throw new Error("Not yet implemented.")},mountFundamentalComponent:function(tt){throw new Error("Not yet implemented.")},shouldUpdateFundamentalComponent:function(tt){throw new Error("Not yet implemented.")},unmountFundamentalComponent:function(tt){throw new Error("Not yet implemented.")},getInstanceFromNode:function(tt){throw new Error("Not yet implemented.")},isOpaqueHydratingObject:function(tt){throw new Error("Not yet implemented")},makeOpaqueHydratingObject:function(tt){throw new Error("Not yet implemented.")},makeClientIdInDEV:function(tt){throw new Error("Not yet implemented")},beforeActiveInstanceBlur:function(tt){},afterActiveInstanceBlur:function(){},detachDeletedInstance:function(){},preparePortalMount:function(tt){}}),$e=Re.dependencies["react-dom"].replace(/[^0-9.]/g,""),Ve=Re.name;We.injectIntoDevTools({bundleType:0,version:$e,rendererPackageName:Ve,findHostInstanceByFiber:We.findHostInstance});var qe=new Map;function Xe(tt){if(N$1(Container.prototype.isPrototypeOf(tt),"Invalid argument `container`, expected instance of `Container`."),qe.has(tt)){var et=qe.get(tt).pixiFiberContainer;We.updateContainer(null,et,void 0,(function(){qe.delete(tt)}))}}function Ge(tt){N$1(Container.prototype.isPrototypeOf(tt),"Invalid argument `container`, expected instance of `Container`.");var et=qe.get(tt);if(N$1(!et,"createRoot should only be called once"),!et){var rt=We.createContainer(tt);et={pixiFiberContainer:rt,reactRoot:{render:function(nt){return We.updateContainer(nt,rt,void 0),We.getPublicRootInstance(rt)},unmount:function(){Xe(tt),qe.delete(tt)}}},qe.set(tt,et)}return et.reactRoot}function Ye(tt,et,rt){var nt;return console.warn("Pixi React Deprecation Warning: render is deprecated, use createRoot instead"),rt!==void 0&&console.warn("Pixi React Deprecation Warning: render callback no longer exists in React 18"),qe.has(et)?nt=qe.get(et).reactRoot:nt=Ge(et),nt.render(tt)}function Ke(tt){Xe(tt)}function Je(){return Je=Object.assign?Object.assign.bind():function(tt){for(var et=1;et<arguments.length;et++){var rt=arguments[et];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(tt[nt]=rt[nt])}return tt},Je.apply(this,arguments)}function Ze(tt,et){if(!(tt instanceof et))throw new TypeError("Cannot call a class as a function")}function en(tt,et){for(var rt=0;rt<et.length;rt++){var nt=et[rt];nt.enumerable=nt.enumerable||!1,nt.configurable=!0,"value"in nt&&(nt.writable=!0),Object.defineProperty(tt,E$1(nt.key),nt)}}function nn(tt){if(tt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return tt}function tn(tt,et){return tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(rt,nt){return rt.__proto__=nt,rt},tn(tt,et)}function rn(tt,et){if(et&&(P(et)==="object"||typeof et=="function"))return et;if(et!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nn(tt)}function ln(tt){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(et){return et.__proto__||Object.getPrototypeOf(et)},ln(tt)}var an=React.createContext(null),on=an.Provider,un=an.Consumer,sn=function(tt){var et=React.forwardRef((function(rt,nt){return React.createElement(un,null,(function(it){return React.createElement(tt,Je({},rt,{ref:nt,app:it}))}))}));return et.displayName="withPIXIApp(".concat(tt.displayName||tt.name,")"),et};function cn(tt){var et=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})();return function(){var rt,nt=ln(tt);if(et){var it=ln(this).constructor;rt=Reflect.construct(nt,arguments,it)}else rt=nt.apply(this,arguments);return rn(this,rt)}}function fn(tt,et){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);et&&(nt=nt.filter((function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable}))),rt.push.apply(rt,nt)}return rt}function dn(tt){for(var et=1;et<arguments.length;et++){var rt=arguments[et]!=null?arguments[et]:{};et%2?fn(Object(rt),!0).forEach((function(nt){_$1(tt,nt,rt[nt])})):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):fn(Object(rt)).forEach((function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))}))}return tt}var pn=function(){},mn={width:k$1.number,height:k$1.number,onMount:k$1.func,onUnmount:k$1.func,raf:k$1.bool,renderOnComponentChange:k$1.bool,children:k$1.node,options:k$1.shape({autoStart:k$1.bool,width:k$1.number,height:k$1.number,useContextAlpha:k$1.bool,backgroundAlpha:k$1.number,autoDensity:k$1.bool,antialias:k$1.bool,preserveDrawingBuffer:k$1.bool,resolution:k$1.number,forceCanvas:k$1.bool,backgroundColor:k$1.number,clearBeforeRender:k$1.bool,powerPreference:k$1.string,sharedTicker:k$1.bool,sharedLoader:k$1.bool,resizeTo:function(tt,et){var rt=tt[et];rt&&N$1(rt===window||rt instanceof HTMLElement,"Invalid prop `resizeTo` of type ".concat(P(rt),", expect `window` or an `HTMLElement`."))},view:function(tt,et,rt){var nt=tt[et];nt&&N$1(nt instanceof HTMLCanvasElement,"Invalid prop `view` of type ".concat(P(nt),", supplied to ").concat(rt,", expected `<canvas> Element`"))}})},hn={width:800,height:600,onMount:pn,onUnmount:pn,raf:!0,renderOnComponentChange:!0},gn=(function(tt){(function(at,st){if(typeof st!="function"&&st!==null)throw new TypeError("Super expression must either be null or a function");at.prototype=Object.create(st&&st.prototype,{constructor:{value:at,writable:!0,configurable:!0}}),Object.defineProperty(at,"prototype",{writable:!1}),st&&tn(at,st)})(it,React.Component);var et,rt,nt=cn(it);function it(){var at;Ze(this,it);for(var st=arguments.length,ot=new Array(st),lt=0;lt<st;lt++)ot[lt]=arguments[lt];return _$1(nn(at=nt.call.apply(nt,[this].concat(ot))),"_canvas",null),_$1(nn(at),"_mediaQuery",null),_$1(nn(at),"_ticker",null),_$1(nn(at),"_needsUpdate",!0),_$1(nn(at),"app",null),_$1(nn(at),"updateSize",(function(){var ht=at.props,dt=ht.width,ut=ht.height,ft=ht.options;ft!=null&&ft.resolution||(at.app.renderer.resolution=window.devicePixelRatio,at.resetInteractionManager()),at.app.renderer.resize(dt,ut)})),_$1(nn(at),"needsRenderUpdate",(function(){at._needsUpdate=!0})),_$1(nn(at),"renderStage",(function(){var ht=at.props,dt=ht.renderOnComponentChange;!ht.raf&&dt&&at._needsUpdate&&(at._needsUpdate=!1,at.app.renderer.render(at.app.stage))})),at}return et=it,(rt=[{key:"componentDidMount",value:function(){var at=this.props,st=at.onMount,ot=at.width,lt=at.height,ht=at.options,dt=at.raf,ut=at.renderOnComponentChange;this.app=new Application(dn(dn({width:ot,height:lt,view:this._canvas},ht),{},{autoDensity:ht?.autoDensity!==!1})),this.app.ticker.autoStart=!1,this.app.ticker[dt?"start":"stop"](),this.app.stage.__reactpixi={root:this.app.stage},this.mountNode=We.createContainer(this.app.stage),We.updateContainer(this.getChildren(),this.mountNode,this),st(this.app),ht!=null&&ht.autoDensity&&window.matchMedia&&ht?.resolution===void 0&&(this._mediaQuery=window.matchMedia("(-webkit-min-device-pixel-ratio: 1.3), (min-resolution: 120dpi)"),this._mediaQuery.addListener(this.updateSize)),ut&&!dt&&(this._ticker=new Ticker,this._ticker.autoStart=!0,this._ticker.add(this.renderStage),this.app.stage.on("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate)),this.updateSize(),this.renderStage()}},{key:"componentDidUpdate",value:function(at,st,ot){var lt,ht=this.props,dt=ht.width,ut=ht.height,ft=ht.raf,mt=ht.renderOnComponentChange,gt=ht.options;gt?.resolution!==void 0&&at?.options.resolution!==gt?.resolution&&(this.app.renderer.resolution=gt.resolution,this.resetInteractionManager()),at.height===ut&&at.width===dt&&((lt=at.options)===null||lt===void 0?void 0:lt.resolution)===gt?.resolution||this.updateSize(),at.raf!==ft&&this.app.ticker[ft?"start":"stop"](),We.updateContainer(this.getChildren(),this.mountNode,this),at.width===dt&&at.height===ut&&at.raf===ft&&at.renderOnComponentChange===mt&&at.options===gt||(this._needsUpdate=!0,this.renderStage())}},{key:"resetInteractionManager",value:function(){var at=this.app.renderer.plugins.interaction;at!=null&&at.resolution&&(at.resolution=this.app.renderer.resolution)}},{key:"getChildren",value:function(){var at=this.props.children;return React.createElement(on,{value:this.app},at)}},{key:"componentDidCatch",value:function(at,st){console.error("Error occurred in `Stage`."),console.error(at),console.error(st)}},{key:"componentWillUnmount",value:function(){this.props.onUnmount(this.app),this._ticker&&(this._ticker.remove(this.renderStage),this._ticker.destroy()),this.app.stage.off("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate),We.updateContainer(null,this.mountNode,this),this._mediaQuery&&(this._mediaQuery.removeListener(this.updateSize),this._mediaQuery=null),this.app.destroy()}},{key:"render",value:function(){var at,st,ot=this,lt=this.props.options;return lt&&lt.view?(N$1(lt.view instanceof HTMLCanvasElement,"options.view needs to be a `HTMLCanvasElement`"),null):React.createElement("canvas",Je({},(at=this.props,st=[].concat(z$1(Object.keys(mn)),z$1(Object.keys(B$1))),Object.keys(at).filter((function(ht){return!st.includes(ht)})).reduce((function(ht,dt){return dn(dn({},ht),{},_$1({},dt,at[dt]))}),{})),{ref:function(ht){return ot._canvas=ht}}))}}])&&en(et.prototype,rt),Object.defineProperty(et,"prototype",{writable:!1}),it})();gn.propTypes=mn,gn.defaultProps=hn;var vn=gn;function yn(){var tt=reactExports.useContext(an);return N$1(tt instanceof Application,"No Context found with `%s`. Make sure to wrap component with `%s`","Application","AppProvider"),tt}function bn(tt){var et=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],rt=yn();N$1(typeof tt=="function","`useTick` needs a callback function."),N$1(rt instanceof Application,"No Context found with `%s`. Make sure to wrap component with `%s`","Application","AppProvider");var nt=reactExports.useRef(null);reactExports.useEffect((function(){nt.current=tt}),[tt]),reactExports.useEffect((function(){if(et){var it=function(at){return nt.current.apply(rt.ticker,[at,rt.ticker])};return rt.ticker.add(it),function(){rt.ticker&&rt.ticker.remove(it)}}}),[et])}function Sn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}function xn(tt,et,rt){return xn=Sn()?Reflect.construct.bind():function(nt,it,at){var st=[null];st.push.apply(st,it);var ot=new(Function.bind.apply(nt,st));return at&&tn(ot,at.prototype),ot},xn.apply(null,arguments)}var wn=["children","apply"];function kn(tt,et){var rt=Object.keys(tt);if(Object.getOwnPropertySymbols){var nt=Object.getOwnPropertySymbols(tt);et&&(nt=nt.filter((function(it){return Object.getOwnPropertyDescriptor(tt,it).enumerable}))),rt.push.apply(rt,nt)}return rt}function Pn(tt){for(var et=1;et<arguments.length;et++){var rt=arguments[et]!=null?arguments[et]:{};et%2?kn(Object(rt),!0).forEach((function(nt){_$1(tt,nt,rt[nt])})):Object.getOwnPropertyDescriptors?Object.defineProperties(tt,Object.getOwnPropertyDescriptors(rt)):kn(Object(rt)).forEach((function(nt){Object.defineProperty(tt,nt,Object.getOwnPropertyDescriptor(rt,nt))}))}return tt}var En=function(tt,et){N$1(P(et)==="object","Second argument needs to be an indexed object with { prop: Filter }");var rt=Object.keys(et),nt=function(it){var at=it.children,st=it.apply,ot=G(it,wn),lt=reactExports.useRef(reactExports.useMemo((function(){return rt.map((function(ut){var ft,mt=(ot==null||(ft=ot[ut])===null||ft===void 0?void 0:ft.construct)||[];return xn(et[ut],z$1(mt))}))}),[rt])),ht=reactExports.useMemo((function(){return rt.reduce((function(ut,ft,mt){return Pn(Pn({},ut),{},_$1({},ft,lt.current[mt]))}),{})}),[rt]),dt=reactExports.useMemo((function(){return Object.keys(ot).filter(A$1(F(rt))).reduce((function(ut,ft){return Pn(Pn({},ut),{},_$1({},ft,ot[ft]))}),{})}),[ot,rt]);return rt.forEach((function(ut,ft){return Object.assign(lt.current[ft],ot[ut])})),st&&(function(){for(var ut=arguments.length,ft=new Array(ut),mt=0;mt<ut;mt++)ft[mt]=arguments[mt];return ft.every((function(gt){return typeof gt=="function"}))})(st)&&st.call(tt,ht),React.createElement(tt,Je({},dt,{filters:lt.current}),at)};return nt.displayName="FilterWrapper",nt.propTypes={children:k$1.node,apply:k$1.func},nt},_n=ve.BitmapText,Cn=ve.Container,zn=ve.Graphics,Nn=ve.NineSlicePlane,Tn=ve.ParticleContainer,In=ve.Sprite,Rn=ve.AnimatedSprite,On=ve.Text,jn=ve.TilingSprite,Ln=ve.SimpleMesh,Dn=ve.SimpleRope;const index_es=Object.freeze(Object.defineProperty({__proto__:null,AnimatedSprite:Rn,AppConsumer:un,AppContext:an,AppProvider:on,BitmapText:_n,Container:Cn,Graphics:zn,NineSlicePlane:Nn,ParticleContainer:Tn,PixiComponent:Se,PixiFiber:We,SimpleMesh:Ln,SimpleRope:Dn,Sprite:In,Stage:vn,TYPES:ve,Text:On,TilingSprite:jn,applyDefaultProps:V,createRoot:Ge,eventHandlers:D,render:Ye,unmountComponentAtNode:Ke,useApp:yn,useTick:bn,withFilters:En,withPixiApp:sn},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace$1(index_es);var hasRequiredModule;function requireModule(){return hasRequiredModule||(hasRequiredModule=1,module$2.exports=require$$0$1),module$2.exports}var moduleExports=requireModule();const GameSprite=({sheetName:tt,animationName:et,imageName:rt,x:nt,y:it,scale:at=1,rotation:st=0,anchor:ot=.5,isPlaying:lt=!0,currentFrame:ht=0})=>{const dt=SpriteManager.getInstance(),ut=reactExports.useRef(null),ft=React.useMemo(()=>rt?dt.getTexture(rt):null,[rt,dt]),mt=React.useMemo(()=>{if(rt)return null;const gt=`${tt}_${et}`;return dt.getAnimation(gt)},[tt,et,rt,dt]);return reactExports.useEffect(()=>{if(ut.current&&mt&&mt.length>0){const gt=Math.floor(ht)%mt.length;ut.current.gotoAndStop(gt)}},[ht,mt]),rt&&ft?jsxRuntimeExports.jsx(moduleExports.Sprite,{texture:ft,x:nt,y:it,scale:at,rotation:st,anchor:ot}):mt&&mt.length>0?jsxRuntimeExports.jsx(moduleExports.AnimatedSprite,{ref:ut,textures:mt,isPlaying:!1,x:nt,y:it,scale:at,rotation:st,anchor:ot}):null},PixiForceResizer$1=({w:tt,h:et})=>{const rt=moduleExports.useApp();return reactExports.useEffect(()=>{rt?.renderer&&(rt.renderer.resize(tt,et),rt.view instanceof HTMLCanvasElement&&(rt.view.width=tt,rt.view.height=et))},[rt,tt,et]),null},OscillatingBackground$1=({paused:tt,w:et,h:rt})=>{const nt=reactExports.useRef(null),it=reactExports.useRef(0);return reactExports.useEffect(()=>{nt.current?.clear().beginFill(16777215).drawRect(0,0,et,rt).endFill()},[et,rt]),moduleExports.useTick(at=>{if(!nt.current||tt)return;it.current+=Math.PI/60*at;const st=(Math.sin(it.current)+1)/2,ot=Math.round(26+st*4),lt=Math.round(26+st*54),ht=Math.round(46+st*104);nt.current.tint=(ot<<16)+(lt<<8)+ht}),jsxRuntimeExports.jsx(moduleExports.Graphics,{ref:nt})},RockPool$1=({vm:tt,paused:et})=>{const rt=reactExports.useRef(null),nt=reactExports.useRef([]),it=SpriteManager.getInstance();return reactExports.useEffect(()=>()=>{nt.current.forEach(at=>{at&&!at.destroyed&&at.destroy()}),nt.current=[]},[]),moduleExports.useTick(()=>{if(!rt.current)return;const at=tt.entityCount,st=nt.current;if(at>st.length)for(let ot=st.length;ot<at;ot++){const lt=it.getTexture("static_rock");if(lt){const ht=new Sprite(lt);ht.anchor.set(.5),ht.scale.set(.8),rt.current.addChild(ht),st.push(ht)}}else if(at<st.length)for(let ot=st.length-1;ot>=at;ot--){const lt=st.pop();lt&&(rt.current.removeChild(lt),lt.destroy())}for(let ot=0;ot<at;ot++){const lt=st[ot],ht=tt.getRockViewData(ot);if(!ht||et){lt&&(lt.visible=!1);continue}lt.visible=!0,lt.x=ht.x,lt.y=ht.y,lt.rotation=ht.rotation}}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:rt})},Game1Simulation=({vm:tt,paused:et,width:rt,height:nt,scale:it,heroPos:at,hp:st})=>{const ot=reactExports.useRef(null),[lt,ht]=reactExports.useState(tt.heroVisuals);return moduleExports.useTick(()=>{const dt=tt.heroVisuals;ot.current&&(ot.current.x=dt.x,ot.current.y=dt.y,ot.current.rotation=dt.rotation,ot.current.scale.set(dt.scale),at.current.x=dt.x,at.current.y=dt.y,ht(dt))}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(PixiForceResizer$1,{w:rt,h:nt}),jsxRuntimeExports.jsx(OscillatingBackground$1,{paused:et,w:rt,h:nt}),jsxRuntimeExports.jsxs(moduleExports.Container,{scale:it,children:[jsxRuntimeExports.jsx(RockPool$1,{vm:tt,paused:et}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:ot,children:jsxRuntimeExports.jsx(GameSprite,{sheetName:"hero_sheet",animationName:"idle",x:0,y:0,scale:1,anchor:.5,currentFrame:lt.currentFrame})})]})]})},Game1HUD=({hp:tt,rockCount:et,shieldBarRef:rt,shieldTextRef:nt,damageBtnRef:it,onDamage:at,onJumpToG2:st,onLevel1:ot,onLevel2:lt,onLevel3:ht,onResetG1:dt,onNextLevel:ut,onFailLevel:ft})=>{const mt={padding:"0.6cqw 1cqw",cursor:"pointer",color:"#fff",border:"none",borderRadius:"0.4cqw",fontWeight:"bold",fontFamily:"monospace",fontSize:"0.8cqw",pointerEvents:"auto",textAlign:"center"};return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none",containerType:"size"},children:[jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"5cqh",left:"50%",transform:"translateX(-50%)",width:"35cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"#fff",marginBottom:"0.5cqh",fontWeight:"bold",fontFamily:"monospace",fontSize:"1.2cqw"},children:[jsxRuntimeExports.jsx("span",{children:"SHIELD ENERGY"}),jsxRuntimeExports.jsxs("span",{ref:nt,children:[Math.round(tt),"%"]})]}),jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"2cqh",backgroundColor:"#222",borderRadius:"1cqw",border:"0.2cqw solid #fff",overflow:"hidden"},children:jsxRuntimeExports.jsx("div",{ref:rt,style:{width:`${Math.max(0,tt)}%`,height:"100%",backgroundColor:tt<30?"#c0392b":"#27ae60"}})})]}),jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"3cqh",right:"3cqw",color:"#00ff00",fontFamily:"monospace",textAlign:"right",fontSize:"1.2cqw"},children:["ROCKS_ACTIVE: ",et]}),jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"3cqh",left:"3cqw",display:"flex",flexDirection:"column",gap:"1cqh"},children:[jsxRuntimeExports.jsx("button",{ref:it,onClick:at,style:{...mt,background:"#333",border:"0.1cqw solid #fff"},children:"TAKE DAMAGE (-15)"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:ot,style:{...mt,background:"#408240",flex:1},children:"LVL 1"}),jsxRuntimeExports.jsx("button",{onClick:lt,style:{...mt,background:"#C29F19",flex:1},children:"LVL 2"}),jsxRuntimeExports.jsx("button",{onClick:ht,style:{...mt,background:"#C21919",flex:1},children:"LVL 3"})]}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"0.5cqw"},children:jsxRuntimeExports.jsx("button",{onClick:ut,style:{...mt,background:"#67ad44",flex:2},children:"Next Level (Campaign)"})}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"0.5cqw"},children:jsxRuntimeExports.jsx("button",{onClick:ft,style:{...mt,background:"#ad4444",flex:2},children:"Fail Level (Campaign)"})}),jsxRuntimeExports.jsx("button",{onClick:st,style:{...mt,background:"#2980b9"},children:"Go to Game 2"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"0.5cqw"},children:jsxRuntimeExports.jsx("button",{onClick:dt,style:{...mt,background:"#c0392b",flex:1},children:"Quick Load"})})]})]})},Game1View=({vm:tt,controller:et,width:rt=960,height:nt=540})=>{const[it,at]=reactExports.useState(tt.hp),[st,ot]=reactExports.useState(tt.entityCount),[lt,ht]=reactExports.useState(!1),dt=reactExports.useRef(null),ut=reactExports.useRef(null),ft=reactExports.useRef(null),mt=reactExports.useRef({x:tt.pos.x,y:tt.pos.y});reactExports.useEffect(()=>{const wt=tt.subscribe(()=>{const Pt=StateManager.getInstance().getActiveState()?.name!=="Game1";lt!==Pt&&ht(Pt);const Rt=tt.hp;mt.current.x=tt.pos.x,mt.current.y=tt.pos.y,dt.current&&(dt.current.style.width=`${Math.max(0,Rt)}%`),ut.current&&(ut.current.innerText=`${Math.round(Rt)}%`),Math.abs(it-Rt)>1&&at(Rt),st!==tt.entityCount&&ot(tt.entityCount)});return()=>wt()},[tt,it,st,lt]);const gt=reactExports.useMemo(()=>rt/960,[rt]),vt=reactExports.useMemo(()=>({backgroundColor:0,antialias:!0,resolution:1,autoDensity:!1}),[]),xt=reactExports.useMemo(()=>({display:"block",width:"100%",height:"100%",objectFit:"contain",imageRendering:"pixelated"}),[]);return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,background:"#000",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:[jsxRuntimeExports.jsx("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsx(moduleExports.Stage,{width:rt,height:nt,options:vt,style:xt,children:jsxRuntimeExports.jsx(Game1Simulation,{vm:tt,paused:lt,width:rt,height:nt,scale:gt,heroPos:mt,hp:it})},`stage-${rt}-${nt}`)}),jsxRuntimeExports.jsx(Game1HUD,{hp:it,rockCount:st,shieldBarRef:dt,shieldTextRef:ut,damageBtnRef:ft,onDamage:()=>et.takeDamage(),onJumpToG2:()=>et.jumpToGame2(),onLevel1:()=>et.loadLevel(Game1Level.Level1),onLevel2:()=>et.loadLevel(Game1Level.Level2),onLevel3:()=>et.loadLevel(Game1Level.Level3),onResetG1:()=>et.resetLevel(),onNextLevel:()=>et.nextLevel(),onFailLevel:()=>et.failLevel()})]})},Game1MainSchema={HERO_HP:0,HERO_X:1,HERO_Y:2,TICK_COUNT:3,FRAME_COUNT:4,FPS:5,REVISION:6,LAST_HIT_FRAME:7,ENTITY_COUNT:8,BUFFER_SIZE:128},Game1RocksSchema={START_INDEX:0,STRIDE:3,BUFFER_SIZE:3e3},Game1LogicSchema={main:Game1MainSchema,rocks:Game1RocksSchema};class Game1State extends BaseGameState{constructor(et=!1,rt=Game1Level.Level1){super(et),this.currentLevel=rt}name=StateId.GAME_1;logicSchema=Game1LogicSchema;viewSchema=Game1ViewSchema;viewComponent=Game1View;getConfig(){return getGame1Config(this.currentLevel)}getSessionOverrides(et){const rt=et.get(GLOBAL_SESSION_MAP.hp);return rt!==void 0?{initialHP:rt}:{}}initMVC(){this.vm=new Game1Presenter,this.controller=new Game1Controller(this.vm)}async init(){InputManager.getInstance().refreshBindings(this.name),await super.init()}}const Game2LogicSchema={HERO_HP:0,ENERGY:1,SCRAP_COUNT:2,TICK_COUNT:3,FRAME_COUNT:4,FPS:5,REVISION:6,BUFFER_SIZE:1024},Game2ViewSchema={HERO_HP_DISPLAY:0,ENERGY_DISPLAY:1,SCRAP_DISPLAY:2,UI_BOUNCE:3,GLITCH_INTENSITY:4,VIGNETTE_PULSE:5,BUFFER_SIZE:1024},Game2HUD=({stats:tt,onAction:et,onJumpG1:rt,onLevel1:nt,onLevel2:it,onLevel3:at,onQuickLoad:st,onNextLevel:ot,onFailLevel:lt})=>{const ht={padding:"1.5cqw",border:"0.1cqw solid",borderRadius:"0.5cqw",display:"flex",flexDirection:"column",gap:"1cqh"},dt={padding:"0.5cqw 1cqw",cursor:"pointer",background:"#222",color:"#eee",border:"0.1cqw solid #444",fontSize:"0.8cqw",pointerEvents:"auto"};return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none",containerType:"size",padding:"2cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"#00ff00",fontFamily:"monospace"},children:[jsxRuntimeExports.jsx("h2",{style:{fontSize:"1.5cqw",margin:0},children:"SYSTEM_DIAGNOSTICS"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqh",alignItems:"flex-end"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:nt,style:{...dt,background:"#1b4d1b"},children:"LVL 1"}),jsxRuntimeExports.jsx("button",{onClick:it,style:{...dt,background:"#4d431b"},children:"LVL 2"}),jsxRuntimeExports.jsx("button",{onClick:at,style:{...dt,background:"#4d1b1b"},children:"LVL 3"})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:ot,style:{...dt,borderColor:"#8e44ad",color:"#67ad44"},children:"NEXT_STEP"}),jsxRuntimeExports.jsx("button",{onClick:lt,style:{...dt,borderColor:"#8e44ad",color:"#ad4444"},children:"FAIL_STEP"}),jsxRuntimeExports.jsx("button",{onClick:rt,style:{...dt,borderColor:"#3498db"},children:"GOTO_G1"}),jsxRuntimeExports.jsx("button",{onClick:st,style:{...dt,borderColor:"#c0392b"},children:"RELOAD"})]})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"2cqw",marginTop:"2cqh",pointerEvents:"auto"},children:[jsxRuntimeExports.jsxs("div",{style:{...ht,borderColor:"#00ff00",color:"#00ff00"},children:[jsxRuntimeExports.jsx("span",{children:"GLOBAL_HP"}),jsxRuntimeExports.jsx("b",{style:{fontSize:"2cqw"},children:tt.hp.toFixed(1)}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>et("MOD_HP",10),style:dt,children:"+10"}),jsxRuntimeExports.jsx("button",{onClick:()=>et("MOD_HP",-10),style:dt,children:"-10"})]})]}),jsxRuntimeExports.jsxs("div",{style:{...ht,borderColor:"#3498db",color:"#3498db"},children:[jsxRuntimeExports.jsx("span",{children:"GLOBAL_ENERGY"}),jsxRuntimeExports.jsx("b",{style:{fontSize:"2cqw"},children:tt.energy}),jsxRuntimeExports.jsx("button",{onClick:()=>et("MOD_ENERGY",5),style:dt,children:"RECHARGE"})]}),jsxRuntimeExports.jsxs("div",{style:{...ht,borderColor:"#f1c40f",color:"#f1c40f"},children:[jsxRuntimeExports.jsx("span",{children:"LOCAL_SCRAP"}),jsxRuntimeExports.jsx("b",{style:{fontSize:"2cqw"},children:tt.scrap}),jsxRuntimeExports.jsx("button",{onClick:()=>et("ADD_SCRAP"),style:dt,children:"COLLECT"})]})]})]})},levelData$2={"Level 1":{initialHP:100,initialEnergy:50,initialScrap:0,maxEnergy:100,regenRate:60,manifestPath:"res/manifest.json",bgmKey:"bgm_level1"},"Level 2":{initialHP:80,initialEnergy:30,initialScrap:40,maxEnergy:80,regenRate:90,manifestPath:"res/manifest.json",bgmKey:"bgm_level1"},"Level 3":{initialHP:50,initialEnergy:10,initialScrap:10,maxEnergy:50,regenRate:120,manifestPath:"res/manifest.json",bgmKey:"bgm_level1"}};var Game2Level=(tt=>(tt.Level1="Level 1",tt.Level2="Level 2",tt.Level3="Level 3",tt))(Game2Level||{});const getGame2Config=tt=>levelData$2[tt]||levelData$2["Level 1"],Game2View=({vm:tt,controller:et})=>{const[rt,nt]=reactExports.useState({hp:tt.hp,energy:tt.energy,scrap:tt.scrap}),[it,at]=reactExports.useState({uiOffset:0,glitch:0,pulse:0});reactExports.useEffect(()=>{const lt=tt.subscribe(()=>{nt({hp:tt.hp,energy:tt.energy,scrap:tt.scrap});const ht=tt.visualEffects;at({uiOffset:ht.uiOffset,glitch:ht.glitchIntensity,pulse:ht.vignettePulse})});return()=>lt()},[tt]);const st=(Math.random()-.5)*20*it.glitch,ot=(Math.random()-.5)*20*it.glitch;return jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:jsxRuntimeExports.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",background:"#adadad",overflow:"hidden",transform:`translate(${st}px, ${ot}px)`,textShadow:it.glitch>.1?`${it.glitch*5}px 0 #f00, -${it.glitch*5}px 0 #0ff`:"none"},children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:`radial-gradient(circle, transparent 40%, rgba(0,0,0,${.8*it.pulse}))`,pointerEvents:"none",zIndex:1}}),jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#050505",fontSize:"10cqw",fontWeight:"bold",transform:`translateY(${it.uiOffset}px)`,opacity:.3+it.glitch*.7},children:"LAB_02"}),jsxRuntimeExports.jsx(Game2HUD,{stats:rt,onAction:(lt,ht)=>et.modifyStat(lt,ht),onJumpG1:et.jumpToGame1,onLevel1:()=>et.loadLevel(Game2Level.Level1),onLevel2:()=>et.loadLevel(Game2Level.Level2),onLevel3:()=>et.loadLevel(Game2Level.Level3),onQuickLoad:()=>et.resetLevel(),onNextLevel:()=>et.nextLevel(),onFailLevel:()=>et.failLevel()})]})})};class Game2Presenter extends BasePresenter{get hp(){return this.sharedView[Game2ViewSchema.HERO_HP_DISPLAY]||0}get energy(){return this.sharedView[Game2ViewSchema.ENERGY_DISPLAY]||0}get scrap(){return this.sharedView[Game2ViewSchema.SCRAP_DISPLAY]||0}get visualEffects(){return{uiOffset:this.sharedView[Game2ViewSchema.UI_BOUNCE]||0,glitchIntensity:this.sharedView[Game2ViewSchema.GLITCH_INTENSITY]||0,vignettePulse:this.sharedView[Game2ViewSchema.VIGNETTE_PULSE]||0}}}class Game2Controller extends BaseController{constructor(et){super(et,StateId.GAME_2)}modifyStat(et,rt){this.send(et,{amount:rt})}async jumpToGame1(){const et=StateRegistry.create(StateId.GAME_1,{reset:!1});StateManager.getInstance().replace(et)}async loadLevel(et){const rt=StateRegistry.create(StateId.GAME_2,{reset:!1,level:et});StateManager.getInstance().replace(rt)}async resetLevel(){await SaveManager.getInstance().performLoad(this.QUICK_SAVE_KEY);const et=this.vm.currentLevel||Game2Level.Level1,rt=StateRegistry.create(StateId.GAME_2,{reset:!1,level:et});StateManager.getInstance().replace(rt)}onKeyDown(et){InputManager.getInstance().isKeyAction(et.key,"PAUSE")&&this.handleEscape()}onWorkerEvent(et){}async handleEscape(){StateManager.getInstance().push(StateRegistry.create(StateId.PAUSE_MENU))}nextLevel(){CampaignManager.getInstance().completeCurrentStep()}failLevel(){CampaignManager.getInstance().failCurrentStep()}}class Game2State extends BaseGameState{constructor(et=!1,rt=Game2Level.Level1){super(et),this.currentLevel=rt}name=StateId.GAME_2;logicSchema=Game2LogicSchema;viewSchema=Game2ViewSchema;viewComponent=Game2View;getConfig(){return getGame2Config(this.currentLevel)}getSessionOverrides(et){const rt={},nt=et.get(GLOBAL_SESSION_MAP.hp);nt!==void 0&&(rt.initialHP=nt);const it=et.get(GLOBAL_SESSION_MAP.energy);return it!==void 0&&(rt.initialEnergy=it),rt}initMVC(){this.vm=new Game2Presenter,this.controller=new Game2Controller(this.vm)}}class BaseMenuController{input;stateManager;stateId;constructor(){this.input=InputManager.getInstance(),this.stateManager=StateManager.getInstance(),this.handleKeyDown=this.handleKeyDown.bind(this)}init(et){this.stateId=et,window.addEventListener("keydown",this.handleKeyDown),this.onInitialize()}destroy(){window.removeEventListener("keydown",this.handleKeyDown),this.onDestroy()}handleKeyDown(et){if(this.stateManager.getActiveState()?.name===this.stateId){if(this.input.isKeyAction(et.key,"UI_BACK")){et.preventDefault(),et.stopImmediatePropagation(),this.onBack();return}this.onKeyDown(et)}}onInitialize(){}onDestroy(){}onKeyDown(et){}}class DevMenuController extends BaseMenuController{session=SharedSession.getInstance();audio=AudioManager.getInstance();campaign=CampaignManager.getInstance();onBack(){}handleNav(et,rt){this.session.clearSavableKeys(),this.session.set("campaign_id",null),this.session.set("campaign_step_index",0);const nt=StateRegistry.create(et,{reset:!1,...rt});StateManager.getInstance().replace(nt)}openPopup(et,rt={}){StateManager.getInstance().push(StateRegistry.create(et,rt))}startCampaign(et){this.campaign.startCampaign(et)}setVolume(et,rt){this.audio.setVolume(et,rt),this.session.set(`${et}_volume`,rt)}updateResolution(et,rt){rt?.(et),this.session.set("resolution",et)}getInitialVolumes(){return{master:this.session.get("master_volume")??.5,ost:this.session.get("ost_volume")??.5,sfx:this.session.get("sfx_volume")??.5}}}const DevButton=({label:tt,onClick:et,active:rt,color:nt="#444",subLabel:it})=>jsxRuntimeExports.jsxs("button",{onClick:et,disabled:!et,style:{padding:"1cqw",backgroundColor:rt?"#4f4":et?nt:"#222",color:rt?"#000":et?"#fff":"#666",border:"0.1cqw solid #555",borderRadius:"0.4cqw",cursor:et?"pointer":"default",fontSize:"0.8cqw",fontWeight:"bold",textAlign:"center",transition:"all 0.1s",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[jsxRuntimeExports.jsx("span",{children:tt}),it&&jsxRuntimeExports.jsx("span",{style:{fontSize:"0.6cqw",fontWeight:"normal",opacity:.8},children:it})]}),AudioSlider=({label:tt,value:et,onChange:rt})=>jsxRuntimeExports.jsxs("div",{style:{marginBottom:"1.2cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.7cqw",color:"#00ff00",marginBottom:"0.4cqw"},children:[jsxRuntimeExports.jsx("span",{children:tt}),jsxRuntimeExports.jsxs("span",{children:[Math.round(et*100),"%"]})]}),jsxRuntimeExports.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:et,onChange:nt=>rt(parseFloat(nt.target.value)),style:{width:"100%",cursor:"pointer",accentColor:"#00ff00",height:"0.8cqh"}})]}),DevMenuView=({controller:tt,res:et,setRes:rt})=>{const nt=StateRegistry.get(StateId.GAME_1),it=StateRegistry.get(StateId.GAME_2),at=StateRegistry.get(StateId.GAME_3),st=StateRegistry.get(StateId.BH_GAME),[ot,lt]=reactExports.useState(tt.getInitialVolumes()),ht=(ut,ft)=>{tt.setVolume(ut,ft),lt(mt=>({...mt,[ut]:ft}))},dt=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};return jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:jsxRuntimeExports.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",backgroundColor:"#0a0a0a",color:"#00ff00",padding:"2cqw",boxSizing:"border-box",fontFamily:"monospace",border:"0.2cqw solid #333",display:"flex",gap:"2cqw",containerType:"size"},children:[jsxRuntimeExports.jsxs("div",{style:{flex:2},children:[jsxRuntimeExports.jsx("h2",{style:{fontSize:"2cqw",letterSpacing:"0.2cqw",borderBottom:"0.1cqw solid #333",paddingBottom:"1cqw",margin:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:jsxRuntimeExports.jsx("span",{children:"DEV_SWITCHBOARD_V1"})}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1.5cqw",marginTop:"2cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{gridColumn:"span 2",display:"flex",flexDirection:"column",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("div",{style:{fontSize:"0.8cqw",color:"#e74c3c",marginBottom:"0.5cqw"},children:"CAMPAIGN_MODES"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"1cqw"},children:[jsxRuntimeExports.jsx("div",{style:{flex:1},children:jsxRuntimeExports.jsx(DevButton,{label:"STORY MODE",subLabel:"Full Progression",onClick:()=>tt.startCampaign("story_mode"),color:"#e74c3c"})}),jsxRuntimeExports.jsx("div",{style:{flex:1},children:jsxRuntimeExports.jsx(DevButton,{label:"ARCADE MODE",subLabel:"Quick Action",onClick:()=>tt.startCampaign("arcade_mode"),color:"#f39c12"})})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{fontSize:"0.8cqw",color:"#888",marginBottom:"0.5cqw"},children:["MODULE: ",nt?.displayName.toUpperCase()??"GAME_01"]}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx(DevButton,{label:"LVL 1",onClick:()=>tt.handleNav(StateId.GAME_1,nt?.presets?.[0]?.params),color:"#27ae60"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 2",onClick:()=>tt.handleNav(StateId.GAME_1,nt?.presets?.[1]?.params),color:"#2980b9"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 3",onClick:()=>tt.handleNav(StateId.GAME_1,nt?.presets?.[2]?.params),color:"#8e44ad"})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{fontSize:"0.8cqw",color:"#888",marginBottom:"0.5cqw"},children:["MODULE: ",it?.displayName.toUpperCase()??"GAME_02"]}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx(DevButton,{label:"LVL 1",onClick:()=>tt.handleNav(StateId.GAME_2,it?.presets?.[0]?.params),color:"#c0392b"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 2",onClick:()=>tt.handleNav(StateId.GAME_2,it?.presets?.[1]?.params),color:"#d35400"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 3",onClick:()=>tt.handleNav(StateId.GAME_2,it?.presets?.[2]?.params),color:"#f39c12"})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{fontSize:"0.8cqw",color:"#00d2ff",marginBottom:"0.5cqw"},children:["MODULE: ",at?.displayName.toUpperCase()??"GAME_03"]}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx(DevButton,{label:"LVL 1",onClick:()=>tt.handleNav(StateId.GAME_3,st?.presets?.[0]?.params),color:"#0984e3"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 2",onClick:()=>tt.handleNav(StateId.GAME_3,st?.presets?.[1]?.params),color:"#6c5ce7"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 3",onClick:()=>tt.handleNav(StateId.GAME_3,st?.presets?.[2]?.params),color:"#a29bfe"})]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{fontSize:"0.8cqw",color:"#00d2ff",marginBottom:"0.5cqw"},children:["MODULE: ",st?.displayName.toUpperCase()??"BH_GAME"]}),jsxRuntimeExports.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx(DevButton,{label:"LVL 1",onClick:()=>tt.handleNav(StateId.BH_GAME,st?.presets?.[0]?.params),color:"#0984e3"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 2",onClick:()=>tt.handleNav(StateId.BH_GAME,st?.presets?.[1]?.params),color:"#6c5ce7"}),jsxRuntimeExports.jsx(DevButton,{label:"LVL 3",onClick:()=>tt.handleNav(StateId.BH_GAME,st?.presets?.[2]?.params),color:"#a29bfe"})]})]}),jsxRuntimeExports.jsxs("div",{style:{gridColumn:"span 2",marginTop:"1cqw"},children:[jsxRuntimeExports.jsx("div",{style:{fontSize:"0.8cqw",color:"#888",marginBottom:"0.5cqw"},children:"SYSTEM_NAVIGATION"}),jsxRuntimeExports.jsx(DevButton,{label:"OPEN SAVE / LOAD MENU",onClick:()=>tt.openPopup(StateId.SAVE_MENU),color:"#d35400"})]})]})]}),jsxRuntimeExports.jsxs("div",{style:{flex:1,backgroundColor:"#111",padding:"1.5cqw",borderRadius:"0.4cqw",borderLeft:"0.1cqw solid #333",display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx("h3",{style:{fontSize:"1.2cqw",margin:"0 0 2cqw 0",borderBottom:"0.1cqw solid #333",paddingBottom:"0.5cqw"},children:"GLOBAL_CONFIG"}),jsxRuntimeExports.jsx(AudioSlider,{label:"MASTER_VOLUME",value:ot.master,onChange:ut=>ht("master",ut)}),jsxRuntimeExports.jsx(AudioSlider,{label:"OST_VOLUME",value:ot.ost,onChange:ut=>ht("ost",ut)}),jsxRuntimeExports.jsx(AudioSlider,{label:"SFX_VOLUME",value:ot.sfx,onChange:ut=>ht("sfx",ut)}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"1cqw",marginBottom:"1.5cqw"},children:[jsxRuntimeExports.jsx("div",{style:{fontSize:"0.7cqw",color:"#888",marginBottom:"0.6cqw"},children:"DISPLAY_RESOLUTION"}),jsxRuntimeExports.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.4cqw"},children:["540p","720p","1080p","1440p","4k","fit"].map(ut=>jsxRuntimeExports.jsx(DevButton,{label:ut.toUpperCase(),active:et===ut,onClick:()=>tt.updateResolution(ut,rt)},ut))})]}),jsxRuntimeExports.jsxs("div",{style:{marginBottom:"1.5cqw"},children:[jsxRuntimeExports.jsx("div",{style:{fontSize:"0.7cqw",color:"#888",marginBottom:"0.6cqw"},children:"WINDOW_MODE"}),jsxRuntimeExports.jsx(DevButton,{label:"TOGGLE FULLSCREEN",onClick:dt,color:"#b33939"})]}),jsxRuntimeExports.jsx("div",{style:{marginTop:"0.5cqw"},children:jsxRuntimeExports.jsx(DevButton,{label:"[ SETTINGS_PANEL ]",subLabel:"INPUTS & OVERRIDES",onClick:()=>tt.openPopup(StateId.SETTINGS_MENU,{res:et,setRes:rt}),color:"#000"})}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"auto",fontSize:"0.7cqw",color:"#444",lineHeight:"1.4"},children:["PERSISTENCE: ACTIVE",jsxRuntimeExports.jsx("br",{}),"SETTINGS_SYNC: LOCAL_STORAGE",jsxRuntimeExports.jsx("br",{}),"ACTIVE_RES: ",et?.toUpperCase()]})]})]})})};class DevMenuState extends State$1{name=StateId.DEV_MENU;controller;params;constructor(et){super(),this.params=et||{},this.controller=new DevMenuController}async init(){this.isRendering=!0,this.controller.init(this.name)}update(et,rt){}getView(){return React.createElement(DevMenuView,{key:this.name,controller:this.controller,res:this.params.res,setRes:this.params.setRes})}destroy(){this.controller.destroy()}}class MenuState extends State$1{controller;constructor(et){super(),this.controller=et()}async init(){this.isRendering=!0,this.controller.init(this.name)}destroy(){this.controller.destroy()}}class PauseMenuController extends BaseMenuController{onBack(){this.stateManager.pop()}onSave(){this.stateManager.push(StateRegistry.create(StateId.SAVE_MENU))}onSettings(){this.stateManager.push(StateRegistry.create(StateId.SETTINGS_MENU))}onQuit(){this.stateManager.pop(),this.stateManager.replace(StateRegistry.create(StateId.DEV_MENU))}}const PauseView=({onResume:tt,onSaveMenu:et,onSettings:rt,onQuit:nt})=>{const it={padding:"1.2cqw 3cqw",fontSize:"1.2cqw",cursor:"pointer",marginBottom:"1cqw",color:"white",border:"none",fontWeight:"bold",borderRadius:"0.4cqw",width:"28cqw",fontFamily:"monospace"},at={width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",backgroundColor:"rgba(0,0,0,0.85)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"white",zIndex:1e3,position:"relative",fontFamily:"monospace",userSelect:"none",containerType:"size"};return jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsxs("div",{style:at,children:[jsxRuntimeExports.jsx("h1",{style:{fontSize:"6cqw",marginBottom:"2cqw",letterSpacing:"0.5cqw"},children:"PAUSED"}),jsxRuntimeExports.jsx("button",{onClick:tt,style:{...it,fontSize:"1.5cqw",backgroundColor:"#27ae60"},children:"RESUME"}),jsxRuntimeExports.jsx("button",{onClick:et,style:{...it,backgroundColor:"#8e44ad"},children:"SAVE / LOAD GAME"}),jsxRuntimeExports.jsx("button",{onClick:rt,style:{...it,backgroundColor:"#7f8c8d"},children:"SYSTEM SETTINGS"}),jsxRuntimeExports.jsx("button",{onClick:nt,style:{...it,backgroundColor:"#c0392b"},children:"QUIT TO SWITCHBOARD"})]})})};class PauseMenuState extends MenuState{name=StateId.PAUSE_MENU;constructor(){super(()=>new PauseMenuController)}getView(){return React.createElement(PauseView,{onResume:()=>this.controller.onBack(),onSaveMenu:()=>this.controller.onSave(),onSettings:()=>this.controller.onSettings(),onQuit:()=>this.controller.onQuit()})}}class SaveMenuController extends BaseMenuController{saveManager=SaveManager.getInstance();onBack(){this.stateManager.pop()}getActiveGameName(){return this.stateManager.getUnderlyingStateName()||"Unknown"}async handleSave(et){const rt=this.getActiveGameName();rt&&await this.saveManager.performSave(et,rt)}async handleLoad(et){try{const rt=await this.saveManager.performLoad(et),nt=StateRegistry.create(rt.stateName,{reset:!1});this.stateManager.pop(),this.stateManager.replace(nt)}catch(rt){console.error("Failed to load save:",rt)}}async handleDelete(et){await this.saveManager.deleteSave(et)}async handleExport(et){const rt=await this.saveManager.exportSave(et),nt=new Blob([rt],{type:"application/octet-stream"}),it=URL.createObjectURL(nt),at=document.createElement("a");at.href=it,at.download=`${et}${SAVE_EXTENSION}`,document.body.appendChild(at),at.click(),document.body.removeChild(at),URL.revokeObjectURL(it)}async handleImport(et){const rt=await et.text();await this.saveManager.importSave(rt)}}function useObservable(tt,et,rt){var nt,it;typeof tt=="function"?(nt=et||[],it=rt):(nt=[],it=et);var at=React.useRef({hasResult:!1,result:it,error:null}),st=React.useReducer(function(ht){return ht+1},0);st[0];var ot=st[1],lt=React.useMemo(function(){var ht=typeof tt=="function"?tt():tt;if(!ht||typeof ht.subscribe!="function")throw tt===ht?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!at.current.hasResult&&typeof window<"u"&&(typeof ht.hasValue!="function"||ht.hasValue()))if(typeof ht.getValue=="function")at.current.result=ht.getValue(),at.current.hasResult=!0;else{var dt=ht.subscribe(function(ut){at.current.result=ut,at.current.hasResult=!0});typeof dt=="function"?dt():dt.unsubscribe()}return ht},nt);if(React.useDebugValue(at.current.result),React.useEffect(function(){var ht=lt.subscribe(function(dt){var ut=at.current;(ut.error!==null||ut.result!==dt)&&(ut.error=null,ut.result=dt,ut.hasResult=!0,ot())},function(dt){var ut=at.current;ut.error!==dt&&(ut.error=dt,ot())});return typeof ht=="function"?ht:ht.unsubscribe.bind(ht)},nt),at.current.error)throw at.current.error;return at.current.result}function useLiveQuery(tt,et,rt){return useObservable(function(){return Dexie.liveQuery(tt)},[],rt)}typeof FinalizationRegistry<"u"&&new FinalizationRegistry(function(tt){var et=Dexie.DexieYProvider;et&&et.release(tt)});const SaveSlotView=({activeStateName:tt,onSave:et,onLoad:rt,onDelete:nt,onExport:it,onImport:at,onBack:st})=>{const ot=useLiveQuery(()=>db.saves.orderBy("timestamp").reverse().toArray()),[lt,ht]=reactExports.useState(""),dt=reactExports.useRef(null),ut=()=>{lt.trim()&&(et(lt.trim()),ht(""))},ft=mt=>{mt.target.files&&mt.target.files[0]&&at(mt.target.files[0])};return jsxRuntimeExports.jsx("div",{style:containerStyle,children:jsxRuntimeExports.jsxs("div",{style:overlayStyle,children:[jsxRuntimeExports.jsx("h2",{style:headerStyle,children:"DATA_STORAGE_INTERFACE"}),jsxRuntimeExports.jsxs("div",{style:controlBarStyle,children:[jsxRuntimeExports.jsx("input",{type:"text",value:lt,onChange:mt=>ht(mt.target.value),placeholder:"ENTER_SAVE_NAME...",style:inputStyle$1,onKeyDown:mt=>mt.key==="Enter"&&ut()}),jsxRuntimeExports.jsx("button",{onClick:ut,style:actionBtnStyle("#27ae60"),children:"SAVE_NEW"}),jsxRuntimeExports.jsx("div",{style:{width:"2cqw"}}),jsxRuntimeExports.jsx("button",{onClick:()=>dt.current?.click(),style:actionBtnStyle("#8e44ad"),children:"IMPORT_FILE"}),jsxRuntimeExports.jsx("input",{type:"file",ref:dt,style:{display:"none"},accept:SAVE_EXTENSION,onChange:ft})]}),jsxRuntimeExports.jsx("div",{style:listContainerStyle,children:!ot||ot.length===0?jsxRuntimeExports.jsx("div",{style:{color:"#555",marginTop:"2cqw"},children:"NO_DATA_FOUND"}):ot.map(mt=>jsxRuntimeExports.jsxs("div",{style:rowStyle$1,children:[jsxRuntimeExports.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx("span",{style:{color:"#fff",fontSize:"1.2cqw",fontWeight:"bold"},children:mt.saveName}),jsxRuntimeExports.jsxs("span",{style:{color:"#888",fontSize:"0.8cqw"},children:[mt.stateName," | ",new Date(mt.timestamp).toLocaleString()]})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>et(mt.saveName),style:smBtnStyle("#27ae60"),children:"OVERWRITE"}),jsxRuntimeExports.jsx("button",{onClick:()=>rt(mt.saveName),style:smBtnStyle("#2980b9"),children:"LOAD"}),jsxRuntimeExports.jsx("button",{onClick:()=>it(mt.saveName),style:smBtnStyle("#d35400"),children:"EXPORT"}),jsxRuntimeExports.jsx("button",{onClick:()=>nt(mt.saveName),style:smBtnStyle("#c0392b"),children:"DEL"})]})]},mt.saveName))}),jsxRuntimeExports.jsx("button",{onClick:st,style:backBtnStyle,children:"RETURN_TO_SYSTEM"})]})})},containerStyle={position:"absolute",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},overlayStyle={position:"relative",width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",backgroundColor:"rgba(5, 5, 5, 0.95)",display:"flex",flexDirection:"column",alignItems:"center",padding:"2cqw",fontFamily:"monospace",zIndex:3e3,containerType:"size"},headerStyle={fontSize:"2.5cqw",color:"#0f0",letterSpacing:"0.2cqw",marginBottom:"1.5cqw"},controlBarStyle={display:"flex",width:"80%",gap:"1cqw",marginBottom:"1.5cqw"},listContainerStyle={flex:1,width:"80%",overflowY:"auto",border:"1px solid #333",padding:"1cqw",backgroundColor:"#0a0a0a",display:"flex",flexDirection:"column",gap:"0.5cqw"},rowStyle$1={display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"#111",padding:"1cqw",borderRadius:"0.3cqw",borderLeft:"0.3cqw solid #444"},inputStyle$1={flex:1,backgroundColor:"#222",border:"1px solid #444",color:"white",padding:"0.5cqw",fontFamily:"monospace",fontSize:"1cqw"},actionBtnStyle=tt=>({padding:"0 1.5cqw",backgroundColor:tt,color:"white",border:"none",cursor:"pointer",fontFamily:"monospace",fontWeight:"bold",fontSize:"1cqw"}),smBtnStyle=tt=>({padding:"0.4cqw 0.8cqw",backgroundColor:tt,color:"white",border:"none",cursor:"pointer",fontFamily:"monospace",fontSize:"0.8cqw",borderRadius:"0.2cqw"}),backBtnStyle={marginTop:"1.5cqw",width:"15cqw",padding:"0.8cqw",backgroundColor:"#c0392b",color:"white",border:"none",cursor:"pointer",fontFamily:"monospace",fontWeight:"bold",fontSize:"1cqw"};class SaveMenuState extends MenuState{name=StateId.SAVE_MENU;constructor(){super(()=>new SaveMenuController)}getView(){return React.createElement(SaveSlotView,{activeStateName:this.controller.getActiveGameName(),onBack:()=>this.controller.onBack(),onSave:et=>this.controller.handleSave(et),onLoad:et=>this.controller.handleLoad(et),onDelete:et=>this.controller.handleDelete(et),onExport:et=>this.controller.handleExport(et),onImport:et=>this.controller.handleImport(et)})}}class SettingsMenuController extends BaseMenuController{session=SharedSession.getInstance();audio=AudioManager.getInstance();onRefreshBinds;registerBindRefresh(et){this.onRefreshBinds=et}onBack(){StateManager.getInstance().pop()}getVolume(et){return this.session.get(`${et}_volume`)??.5}setVolume(et,rt){this.session.set(`${et}_volume`,rt),this.audio.setVolume(et,rt)}getResolution(){return this.session.get("resolution")??"1080p"}setResolution(et){this.session.set("resolution",et)}async toggleFullscreen(){return document.fullscreenElement?(document.exitFullscreen&&await document.exitFullscreen(),!1):(await document.documentElement.requestFullscreen().catch(()=>{}),!0)}getRegistryProfiles(){return Object.keys(INPUT_REGISTRY)}getBindingsForGame(et){const rt={...INPUT_REGISTRY[et]},nt=this.session.get(`bind_${et}`)||{};return{...rt,...nt}}setBinding(et,rt,nt,it){this.input.setBinding(et,rt,nt,it),this.onRefreshBinds&&this.onRefreshBinds()}resetBindings(et){this.input.resetBindings(et),this.onRefreshBinds&&this.onRefreshBinds()}}const btnStyle={padding:"0.8cqw 2cqw",cursor:"pointer",border:"1px solid #00ff00",background:"#000",color:"#00ff00",fontWeight:"bold",fontFamily:"monospace"},rowStyle={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1cqw 1.5cqw",borderBottom:"1px solid #1a1a1a"},controlGroupStyle={display:"flex",alignItems:"center",gap:"1.5cqw",minWidth:"20cqw",justifyContent:"flex-end"},sliderStyle={cursor:"pointer",accentColor:"#00ff00",width:"12cqw"},inputStyle={backgroundColor:"#000",color:"#00ff00",border:"1px solid #00ff00",padding:"0.5cqw",fontFamily:"monospace",outline:"none"},SettingsView=({controller:tt,res:et,setRes:rt})=>{const[nt,it]=reactExports.useState("system"),[at,st]=reactExports.useState(!!document.fullscreenElement),[ot,lt]=reactExports.useState(et||tt.getResolution()),[ht,dt]=reactExports.useState({master:tt.getVolume("master"),ost:tt.getVolume("ost"),sfx:tt.getVolume("sfx")}),[ut,ft]=reactExports.useState("Shared"),[mt,gt]=reactExports.useState(null),[vt,xt]=reactExports.useState({}),wt=reactExports.useCallback(()=>{const Ot=tt.getBindingsForGame(ut);xt(Ot)},[ut,tt]);reactExports.useEffect(()=>{tt.registerBindRefresh(wt),wt()},[wt,tt]),reactExports.useEffect(()=>{if(!mt)return;const Ot=Et=>{Et.preventDefault(),Et.stopImmediatePropagation();const Lt=Et.key.toUpperCase();tt.setBinding(mt.action,Lt,ut,mt.slot),gt(null),wt()};return window.addEventListener("keydown",Ot,!0),()=>window.removeEventListener("keydown",Ot,!0)},[mt,tt,wt,ut]);const At=(Ot,Et)=>{dt(Lt=>({...Lt,[Ot]:Et})),tt.setVolume(Ot,Et)},Tt=Ot=>{lt(Ot),tt.setResolution(Ot),rt&&rt(Ot)},Pt=async()=>{const Ot=await tt.toggleFullscreen();st(Ot)},Rt=()=>{tt.resetBindings(ut),wt()};return jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1200},children:jsxRuntimeExports.jsxs("div",{style:{width:"85%",height:"80%",background:"#050505",border:"2px solid #00ff00",padding:"2cqw",display:"flex",flexDirection:"column",color:"#00ff00",fontFamily:"monospace",containerType:"size"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"2cqw",borderBottom:"2px solid #00ff00",marginBottom:"1cqw"},children:[jsxRuntimeExports.jsx("h2",{onClick:()=>it("system"),style:{cursor:"pointer",opacity:nt==="system"?1:.4,paddingBottom:"0.5cqw"},children:"[ SYSTEM_CONFIGURATION ]"}),jsxRuntimeExports.jsx("h2",{onClick:()=>it("controls"),style:{cursor:"pointer",opacity:nt==="controls"?1:.4,paddingBottom:"0.5cqw"},children:"[ INPUT_BINDINGS ]"})]}),jsxRuntimeExports.jsx("div",{style:{flex:1,overflowY:"auto",paddingRight:"1cqw"},children:nt==="system"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{style:rowStyle,children:[jsxRuntimeExports.jsx("span",{children:"MASTER_OUTPUT_LEVEL"}),jsxRuntimeExports.jsxs("div",{style:controlGroupStyle,children:[jsxRuntimeExports.jsxs("span",{children:[Math.round(ht.master*100),"%"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:ht.master,onChange:Ot=>At("master",parseFloat(Ot.target.value)),style:sliderStyle})]})]}),jsxRuntimeExports.jsxs("div",{style:rowStyle,children:[jsxRuntimeExports.jsx("span",{children:"OST_SEQUENCE_LEVEL"}),jsxRuntimeExports.jsxs("div",{style:controlGroupStyle,children:[jsxRuntimeExports.jsxs("span",{children:[Math.round(ht.ost*100),"%"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:ht.ost,onChange:Ot=>At("ost",parseFloat(Ot.target.value)),style:sliderStyle})]})]}),jsxRuntimeExports.jsxs("div",{style:rowStyle,children:[jsxRuntimeExports.jsx("span",{children:"SFX_IMPULSE_LEVEL"}),jsxRuntimeExports.jsxs("div",{style:controlGroupStyle,children:[jsxRuntimeExports.jsxs("span",{children:[Math.round(ht.sfx*100),"%"]}),jsxRuntimeExports.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:ht.sfx,onChange:Ot=>At("sfx",parseFloat(Ot.target.value)),style:sliderStyle})]})]}),jsxRuntimeExports.jsxs("div",{style:rowStyle,children:[jsxRuntimeExports.jsx("span",{children:"DISPLAY_RESOLUTION"}),jsxRuntimeExports.jsx("select",{value:ot,onChange:Ot=>Tt(Ot.target.value),style:inputStyle,children:["540p","720p","1080p","1440p","4k","fit"].map(Ot=>jsxRuntimeExports.jsx("option",{value:Ot,children:Ot.toUpperCase()},Ot))})]}),jsxRuntimeExports.jsxs("div",{style:rowStyle,children:[jsxRuntimeExports.jsx("span",{children:"WINDOW_MODE"}),jsxRuntimeExports.jsx("button",{onClick:Pt,style:btnStyle,children:at?"[ FULLSCREEN ]":"[ WINDOWED ]"})]})]}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{style:{...rowStyle,borderBottom:"2px solid #333",marginBottom:"1.5cqw"},children:[jsxRuntimeExports.jsx("span",{style:{color:"#888"},children:"SELECT_REGISTRY_CONTEXT:"}),jsxRuntimeExports.jsx("select",{value:ut,onChange:Ot=>ft(Ot.target.value),style:{...inputStyle,width:"25cqw"},children:tt.getRegistryProfiles().map(Ot=>jsxRuntimeExports.jsx("option",{value:Ot,children:Ot.toUpperCase()},Ot))})]}),jsxRuntimeExports.jsxs("p",{style:{color:"#888",marginBottom:"1cqw",fontSize:"0.8em"},children:["CONFIGURING: ",ut.toUpperCase()]}),Object.entries(vt).map(([Ot,Et])=>jsxRuntimeExports.jsxs("div",{style:rowStyle,children:[jsxRuntimeExports.jsx("span",{style:{flex:1},children:Ot.toUpperCase().replace("_"," ")}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"1cqw"},children:[0,1].map(Lt=>{const kt=mt?.action===Ot&&mt?.slot===Lt;return jsxRuntimeExports.jsx("button",{onClick:()=>gt({action:Ot,slot:Lt}),style:{...btnStyle,width:"12cqw",borderColor:kt?"#fff":"#00ff00",color:kt?"#fff":"#00ff00"},children:kt?"???":`[ ${Et[Lt]||"---"} ]`},Lt)})})]},Ot))]})}),jsxRuntimeExports.jsxs("div",{style:{marginTop:"auto",textAlign:"right",paddingTop:"1cqw",borderTop:"1px solid #00ff00",display:"flex",justifyContent:"flex-end",gap:"1cqw"},children:[nt==="controls"&&jsxRuntimeExports.jsxs("button",{onClick:Rt,style:{...btnStyle,borderColor:"#ff4444",color:"#ff4444",background:"rgba(255, 0, 0, 0.1)"},children:["RESET_DEFAULTS_[",ut.toUpperCase(),"]"]}),jsxRuntimeExports.jsx("button",{onClick:()=>tt.onBack(),style:{...btnStyle,background:"#111",borderColor:"#444",color:"#888"},children:"EXIT_CONFIG"})]})]})})};class SettingsMenuState extends MenuState{name=StateId.SETTINGS_MENU;params;constructor(et){super(()=>new SettingsMenuController),this.params=et}getView(){return React.createElement(SettingsView,{controller:this.controller,res:this.params?.res,setRes:this.params?.setRes})}}class ContinueState extends State$1{name=StateId.CONTINUE;async init(){this.isInitialized=!0,this.isRendering=!0,this.isUpdating=!0}update(et,rt){}destroy(){}getView(){return jsxRuntimeExports.jsx(ContinueView,{},"continue-view")}}const ContinueView=()=>{const[tt,et]=reactExports.useState(9);reactExports.useEffect(()=>{const it=setInterval(()=>{et(st=>st<=0?(clearInterval(it),nt(),0):st-1)},1e3),at=st=>{st.key==="Enter"&&rt(),st.key==="Escape"&&nt()};return window.addEventListener("keydown",at),()=>{clearInterval(it),window.removeEventListener("keydown",at)}},[]);const rt=()=>CampaignManager.getInstance().retryCurrentStep(),nt=()=>CampaignManager.getInstance().quitCampaign();return jsxRuntimeExports.jsxs("div",{style:{width:"100%",height:"100%",background:"#000",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"Impact, sans-serif",textTransform:"uppercase"},children:[jsxRuntimeExports.jsx("h1",{style:{fontSize:"4rem",marginBottom:"20px",letterSpacing:"2px"},children:"CONTINUE?"}),jsxRuntimeExports.jsx("div",{style:{fontSize:"6rem",color:tt<4?"#e74c3c":"#f1c40f",marginBottom:"40px"},children:tt}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"40px"},children:[jsxRuntimeExports.jsx("button",{onClick:rt,style:{padding:"15px 30px",fontSize:"1.5rem",background:"transparent",border:"3px solid white",color:"white",cursor:"pointer"},children:"YES (ENTER)"}),jsxRuntimeExports.jsx("button",{onClick:nt,style:{padding:"15px 30px",fontSize:"1.5rem",background:"transparent",border:"3px solid #666",color:"#666",cursor:"pointer"},children:"NO (ESC)"})]})]})};class GameOverState extends State$1{name=StateId.GAME_OVER;async init(){this.isInitialized=!0,this.isRendering=!0}update(et,rt){}destroy(){}getView(){return jsxRuntimeExports.jsx(GameOverView,{},"game-over-view")}}const GameOverView=()=>(reactExports.useEffect(()=>{const tt=()=>CampaignManager.getInstance().quitCampaign(),et=setTimeout(()=>{window.addEventListener("keydown",tt),window.addEventListener("click",tt)},500);return()=>{clearTimeout(et),window.removeEventListener("keydown",tt),window.removeEventListener("click",tt)}},[]),jsxRuntimeExports.jsxs("div",{style:{width:"100%",height:"100%",background:"#000",color:"#e74c3c",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"monospace"},children:[jsxRuntimeExports.jsx("h1",{style:{fontSize:"5rem",margin:0},children:"GAME OVER"}),jsxRuntimeExports.jsx("p",{style:{marginTop:"20px",color:"#666",animation:"blink 1s infinite"},children:"PRESS ANY KEY"}),jsxRuntimeExports.jsx("style",{children:"@keyframes blink { 50% { opacity: 0; } }"})]})),levelData$1={"Level 1":{width:960,height:540,initialHP:100,spawnCount:10,heroStartX:480,heroStartY:270,moveSpeed:5,manifestPath:"res/manifest.json",bgmKey:"bgm_level1",levelLabel:"Level 1"},"Level 2":{width:960,height:540,initialHP:80,spawnCount:20,heroStartX:100,heroStartY:100,moveSpeed:6,manifestPath:"res/manifest.json",bgmKey:"bgm_level1",levelLabel:"Level 2"},"Level 3":{width:960,height:540,initialHP:50,spawnCount:35,heroStartX:800,heroStartY:450,moveSpeed:8,manifestPath:"res/manifest.json",bgmKey:"bgm_level1",levelLabel:"Level 3"}};var BHLevel=(tt=>(tt.Level1="Level 1",tt.Level2="Level 2",tt.Level3="Level 3",tt))(BHLevel||{});const getBHConfig=tt=>{const et=levelData$1[tt];return et||(console.warn(`Config for ${tt} not found, falling back to Level 1`),levelData$1["Level 1"])};class BHController extends BaseController{constructor(et){super(et,StateId.BH_GAME)}takeDamage(){this.send("TAKE_DAMAGE",{amount:15})}async jumpToGame2(){const et=StateRegistry.create(StateId.GAME_2,{reset:!1});await StateManager.getInstance().replace(et)}async loadLevel(et){const rt=StateRegistry.create(StateId.BH_GAME,{reset:!1,level:et});await StateManager.getInstance().replace(rt)}async resetLevel(){await SaveManager.getInstance().performLoad(this.QUICK_SAVE_KEY);const et=this.vm.currentLevel||BHLevel.Level1,rt=StateRegistry.create(StateId.GAME_1,{reset:!1,level:et});await StateManager.getInstance().replace(rt)}onKeyDown(et){InputManager.getInstance().isKeyAction(et.key,"PAUSE")&&this.openPauseMenu()}onWorkerEvent(et){et==="EXPLOSION_REQ"&&AudioManager.getInstance().play("sfx_explosion")}async openPauseMenu(){const et=StateManager.getInstance();et.getCurrentStateName()===this.stateName&&await et.push(StateRegistry.create(StateId.PAUSE_MENU))}}const BHViewSchema={HERO_X:0,HERO_Y:1,HERO_ROTATION:2,HERO_SCALE:3,HERO_HP_DISPLAY:4,HERO_FRAME:5,ACTIVE_ROCK_COUNT:8,ROCKS_START_INDEX:10,ROCK_STRIDE:6,PPROJ_START_INDEX:75,PPROJ_STRIDE:2,BUFFER_SIZE:4096};class BHPresenter extends BasePresenter{get pos(){return{x:this.sharedView[BHViewSchema.HERO_X]||0,y:this.sharedView[BHViewSchema.HERO_Y]||0}}get hp(){return this.sharedView[BHViewSchema.HERO_HP_DISPLAY]||0}get entityCount(){return Math.floor(this.sharedView[BHViewSchema.ACTIVE_ROCK_COUNT]||0)}get projCount(){return Math.floor(this.sharedView[BHViewSchema.PPROJ_START_INDEX-1]||0)}get heroVisuals(){return{x:this.sharedView[BHViewSchema.HERO_X]||0,y:this.sharedView[BHViewSchema.HERO_Y]||0,rotation:this.sharedView[BHViewSchema.HERO_ROTATION]||0,scale:this.sharedView[BHViewSchema.HERO_SCALE]||1,currentFrame:this.sharedView[BHViewSchema.HERO_FRAME]||0}}getRockViewData(et){const rt=BHViewSchema.ROCKS_START_INDEX+et*BHViewSchema.ROCK_STRIDE;return{x:this.sharedView[rt]||0,y:this.sharedView[rt+1]||0,rotation:this.sharedView[rt+2]||0}}getRockAttackData(et){const rt=BHViewSchema.ROCKS_START_INDEX+et*BHViewSchema.ROCK_STRIDE;return{primedMode:this.sharedView[rt+3]||0,endX:this.sharedView[rt+4]||0,endY:this.sharedView[rt+5]||0}}getPlayerProjData(et){const rt=BHViewSchema.PPROJ_START_INDEX+et*BHViewSchema.PPROJ_STRIDE;return{x:this.sharedView[rt]||0,y:this.sharedView[rt+1]||0}}}const PixiForceResizer=({w:tt,h:et})=>{const rt=moduleExports.useApp();return reactExports.useEffect(()=>{rt?.renderer&&(rt.renderer.resize(tt,et),rt.view instanceof HTMLCanvasElement&&(rt.view.width=tt,rt.view.height=et))},[rt,tt,et]),null},OscillatingBackground=({paused:tt,w:et,h:rt})=>{const nt=reactExports.useRef(null),it=reactExports.useRef(0);return reactExports.useEffect(()=>{nt.current?.clear().beginFill(16777215).drawRect(0,0,et,rt).endFill()},[et,rt]),moduleExports.useTick(at=>{if(!nt.current||tt)return;it.current+=Math.PI/60*at;const st=(Math.sin(it.current)+1)/2,ot=Math.round(26+st*4),lt=Math.round(26+st*54),ht=Math.round(46+st*104);nt.current.tint=(ot<<16)+(lt<<8)+ht}),jsxRuntimeExports.jsx(moduleExports.Graphics,{ref:nt})},RockPool=({vm:tt,paused:et})=>{const rt=reactExports.useRef(null),nt=reactExports.useRef([]),it=SpriteManager.getInstance();return reactExports.useEffect(()=>()=>{nt.current.forEach(at=>{at&&!at.destroyed&&at.destroy()}),nt.current=[]},[]),moduleExports.useTick(()=>{if(!rt.current)return;const at=tt.entityCount,st=nt.current;if(at>st.length)for(let ot=st.length;ot<at;ot++){const lt=it.getTexture("static_rock");if(lt){const ht=new Sprite(lt);ht.anchor.set(.5),ht.scale.set(.8),rt.current.addChild(ht),st.push(ht)}}else if(at<st.length)for(let ot=st.length-1;ot>=at;ot--){const lt=st.pop();lt&&(rt.current.removeChild(lt),lt.destroy())}for(let ot=0;ot<at;ot++){const lt=st[ot],ht=tt.getRockViewData(ot);if(!ht||et){lt&&(lt.visible=!1);continue}lt.visible=!0,lt.x=ht.x,lt.y=ht.y,lt.rotation=ht.rotation}}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:rt})},RockAttackPool=({vm:tt,paused:et})=>{const rt=reactExports.useRef(null),nt=reactExports.useRef([]);return reactExports.useEffect(()=>()=>{nt.current.forEach(it=>{it&&!it.destroyed&&it.destroy()}),nt.current=[]},[]),moduleExports.useTick(()=>{if(!rt.current)return;const it=tt.entityCount,at=nt.current;if(it>at.length)for(let st=at.length;st<it;st++){const ot=new Graphics;ot.visible=!1,rt.current.addChild(ot),at.push(ot)}else if(it<at.length)for(let st=at.length-1;st>=it;st--){const ot=at.pop();ot&&(rt.current.removeChild(ot),ot.destroy())}for(let st=0;st<it;st++){const ot=at[st],lt=tt.getRockAttackData(st),ht=tt.getRockViewData(st);if(!lt||et){ot&&(ot.visible=!1);continue}lt.primedMode===1?(ot.visible=!0,ot.clear(),ot.lineStyle(30,16711680),ot.moveTo(ht.x,ht.y),ot.lineTo(lt.endX,lt.endY)):ot.visible=!1}}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:rt})},PlayerProjPool=({vm:tt,paused:et})=>{const rt=reactExports.useRef(null),nt=reactExports.useRef([]);return reactExports.useEffect(()=>()=>{nt.current.forEach(it=>{it&&!it.destroyed&&it.destroy()}),nt.current=[]},[]),moduleExports.useTick(()=>{if(!rt.current)return;const it=tt.projCount,at=nt.current;if(it>at.length)for(let st=at.length;st<it;st++){const ot=new Graphics;ot.visible=!1,rt.current.addChild(ot),at.push(ot)}else if(it<at.length)for(let st=at.length-1;st>=it;st--){const ot=at.pop();ot&&(rt.current.removeChild(ot),ot.destroy())}for(let st=0;st<it;st++){const ot=at[st],lt=tt.getPlayerProjData(st);if(!lt||et){ot&&(ot.visible=!1);continue}ot.visible=!0,ot.clear(),ot.lineStyle(10,65280),ot.drawRect(lt.x,lt.y,20,20)}}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:rt})},BHSimulation=({vm:tt,paused:et,width:rt,height:nt,scale:it,heroPos:at,hp:st})=>{const ot=reactExports.useRef(null),[lt,ht]=reactExports.useState(tt.heroVisuals);return moduleExports.useTick(()=>{const dt=tt.heroVisuals;ot.current&&(ot.current.x=dt.x,ot.current.y=dt.y,ot.current.rotation=dt.rotation,ot.current.scale.set(dt.scale),at.current.x=dt.x,at.current.y=dt.y,ht(dt))}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(PixiForceResizer,{w:rt,h:nt}),jsxRuntimeExports.jsx(OscillatingBackground,{paused:et,w:rt,h:nt}),jsxRuntimeExports.jsxs(moduleExports.Container,{scale:it,children:[jsxRuntimeExports.jsx(PlayerProjPool,{vm:tt,paused:et}),jsxRuntimeExports.jsx(RockAttackPool,{vm:tt,paused:et}),jsxRuntimeExports.jsx(RockPool,{vm:tt,paused:et}),jsxRuntimeExports.jsx(moduleExports.Container,{ref:ot,children:jsxRuntimeExports.jsx(GameSprite,{sheetName:"hero_sheet",animationName:"idle",x:0,y:0,scale:1,anchor:.5,currentFrame:lt.currentFrame})})]})]})},BH_HUD=({hp:tt,rockCount:et,shieldBarRef:rt,shieldTextRef:nt,damageBtnRef:it,onDamage:at,onJumpToG2:st,onLevel1:ot,onLevel2:lt,onLevel3:ht,onResetG1:dt})=>{const ut={padding:"0.6cqw 1cqw",cursor:"pointer",color:"#fff",border:"none",borderRadius:"0.4cqw",fontWeight:"bold",fontFamily:"monospace",fontSize:"0.8cqw",pointerEvents:"auto",textAlign:"center"};return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none",containerType:"size"},children:[jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"5cqh",left:"50%",transform:"translateX(-50%)",width:"35cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"#fff",marginBottom:"0.5cqh",fontWeight:"bold",fontFamily:"monospace",fontSize:"1.2cqw"},children:[jsxRuntimeExports.jsx("span",{children:"SHIELD ENERGY"}),jsxRuntimeExports.jsxs("span",{ref:nt,children:[Math.round(tt),"%"]})]}),jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"2cqh",backgroundColor:"#222",borderRadius:"1cqw",border:"0.2cqw solid #fff",overflow:"hidden"},children:jsxRuntimeExports.jsx("div",{ref:rt,style:{width:`${Math.max(0,tt)}%`,height:"100%",backgroundColor:tt<30?"#c0392b":"#27ae60"}})})]}),jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"3cqh",right:"3cqw",color:"#fff",fontFamily:"monospace",textAlign:"right",fontSize:"1.2cqw"},children:["ROCKS_ACTIVE: ",et]}),jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"3cqh",left:"3cqw",display:"flex",flexDirection:"column",gap:"1cqh"},children:[jsxRuntimeExports.jsx("button",{ref:it,onClick:at,style:{...ut,background:"#333",border:"0.1cqw solid #fff"},children:"TAKE DAMAGE (-15)"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:ot,style:{...ut,background:"#408240",flex:1},children:"LVL 1"}),jsxRuntimeExports.jsx("button",{onClick:lt,style:{...ut,background:"#C29F19",flex:1},children:"LVL 2"}),jsxRuntimeExports.jsx("button",{onClick:ht,style:{...ut,background:"#C21919",flex:1},children:"LVL 3"})]}),jsxRuntimeExports.jsx("button",{onClick:st,style:{...ut,background:"#2980b9"},children:"Go to Game 2"}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"0.5cqw"},children:jsxRuntimeExports.jsx("button",{onClick:dt,style:{...ut,background:"#c0392b",flex:1},children:"Quick Load"})})]})]})},BHView=({vm:tt,controller:et,width:rt=960,height:nt=540})=>{const[it,at]=reactExports.useState(tt.hp),[st,ot]=reactExports.useState(tt.entityCount),[lt,ht]=reactExports.useState(!1),dt=reactExports.useRef(null),ut=reactExports.useRef(null),ft=reactExports.useRef(null),mt=reactExports.useRef({x:tt.pos.x,y:tt.pos.y});reactExports.useEffect(()=>{const vt=tt.subscribe(()=>{const At=StateManager.getInstance().getActiveState()?.name!=="BHGame";lt!==At&&ht(At);const Tt=tt.hp;mt.current.x=tt.pos.x,mt.current.y=tt.pos.y,dt.current&&(dt.current.style.width=`${Math.max(0,Tt)}%`),ut.current&&(ut.current.innerText=`${Math.round(Tt)}%`),Math.abs(it-Tt)>1&&at(Tt),st!==tt.entityCount&&ot(tt.entityCount)});return()=>vt()},[tt,it,st,lt]);const gt=reactExports.useMemo(()=>rt/960,[rt]);return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,background:"#000",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:[jsxRuntimeExports.jsx("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsx(moduleExports.Stage,{width:rt,height:nt,options:{backgroundColor:0,antialias:!0,resolution:1,autoDensity:!1},style:{display:"block",width:"100%",height:"100%",objectFit:"contain",imageRendering:"pixelated"},children:jsxRuntimeExports.jsx(BHSimulation,{vm:tt,paused:lt,width:rt,height:nt,scale:gt,heroPos:mt,hp:it})},`stage-${rt}-${nt}`)}),jsxRuntimeExports.jsx(BH_HUD,{hp:it,rockCount:st,shieldBarRef:dt,shieldTextRef:ut,damageBtnRef:ft,onDamage:()=>et.takeDamage(),onJumpToG2:()=>et.jumpToGame2(),onLevel1:()=>et.loadLevel(BHLevel.Level1),onLevel2:()=>et.loadLevel(BHLevel.Level2),onLevel3:()=>et.loadLevel(BHLevel.Level3),onResetG1:()=>et.resetLevel()})]})},BHLogicSchema={HERO_HP:0,HERO_X:1,HERO_Y:2,TICK_COUNT:3,FRAME_COUNT:4,FPS:5,REVISION:6,LAST_HIT_FRAME:7,ENTITY_COUNT:8,ROCKS_START_INDEX:10,PPROJ_START_INDEX:75,PPROJ_STRIDE:2,ROCK_STRIDE:6,MAX_ROCKS:1e3,BUFFER_SIZE:4096};class BHState extends BaseGameState{constructor(et=!1,rt=BHLevel.Level1){super(et),this.currentLevel=rt}name=StateId.BH_GAME;logicSchema=BHLogicSchema;viewSchema=BHViewSchema;viewComponent=BHView;getConfig(){return getBHConfig(this.currentLevel)}getSessionOverrides(et){const rt=et.get(GLOBAL_SESSION_MAP.hp);return rt!==void 0?{initialHP:rt}:{}}initMVC(){this.vm=new BHPresenter,this.controller=new BHController(this.vm)}async init(){InputManager.getInstance().refreshBindings(this.name),await super.init()}}const Game3LogicSchema={REVISION:0,FRAME_COUNT:1,FPS:2,HERO_X:10,HERO_Y:11,HERO_VX:12,HERO_VY:13,HERO_HP:14,HERO_WIDTH:20,HERO_HEIGHT:21,HERO_FLIP:22,HERO_ANIM_STATE:23,HERO_ANIM_FRAME:24,WORLD_SCALE:30,PLAYER_SCALE:31,PLAYER_OFFSET_Y:32,BUFFER_SIZE:1024},Game3ViewSchema={HERO_X:0,HERO_Y:1,HERO_HP:2,HERO_ANIM_FRAME:5,HERO_FLIP:6,HERO_WIDTH:7,HERO_HEIGHT:8,HERO_ANIM_STATE:9,WORLD_SCALE:10,PLAYER_SCALE:11,PLAYER_OFFSET_Y:12,UI_BOUNCE:20,GLITCH_INTENSITY:21,VIGNETTE_PULSE:22,BUFFER_SIZE:1024},Game3HUD=({stats:tt,onAction:et,onLevel1:rt,onLevel2:nt,onLevel3:it,onLevel4:at,onQuickLoad:st})=>{const ot={padding:"1.5cqw",border:"0.1cqw solid",borderRadius:"0.5cqw",display:"flex",flexDirection:"column",gap:"1cqh"},lt={padding:"0.5cqw 1cqw",cursor:"pointer",background:"#222",color:"#eee",border:"0.1cqw solid #444",fontSize:"0.8cqw",pointerEvents:"auto"};return jsxRuntimeExports.jsxs("div",{style:{position:"absolute",inset:0,pointerEvents:"none",containerType:"size",padding:"2cqw"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"#ffcc00",fontFamily:"monospace"},children:[jsxRuntimeExports.jsx("h2",{style:{fontSize:"1.5cqw",margin:0},children:"PLATFORMER_PROTOTYPE"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5cqh",alignItems:"flex-end"},children:[jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:rt,style:{...lt,background:"#1b4d1b"},children:"LVL 1"}),jsxRuntimeExports.jsx("button",{onClick:nt,style:{...lt,background:"#4d431b"},children:"LVL 2"}),jsxRuntimeExports.jsx("button",{onClick:it,style:{...lt,background:"#4d1b1b"},children:"LVL 3"}),jsxRuntimeExports.jsx("button",{onClick:at,style:{...lt,background:"#1b1b4d"},children:"LVL 4"})]}),jsxRuntimeExports.jsx("div",{style:{display:"flex",gap:"0.5cqw"},children:jsxRuntimeExports.jsx("button",{onClick:st,style:{...lt,borderColor:"#c0392b"},children:"RELOAD"})})]})]}),jsxRuntimeExports.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"2cqw",marginTop:"2cqh",pointerEvents:"auto"},children:jsxRuntimeExports.jsxs("div",{style:{...ot,borderColor:"#ff3333",color:"#ff3333"},children:[jsxRuntimeExports.jsx("span",{children:"HERO_HP"}),jsxRuntimeExports.jsx("b",{style:{fontSize:"2cqw"},children:tt.hp.toFixed(1)}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5cqw"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>et("MOD_HP",10),style:lt,children:"+10"}),jsxRuntimeExports.jsx("button",{onClick:()=>et("MOD_HP",-10),style:lt,children:"-10"})]})]})}),jsxRuntimeExports.jsx("div",{style:{position:"absolute",bottom:"2cqh",left:"2cqw",color:"#fff",fontSize:"0.8cqw",opacity:.7},children:"Controls: A/D/Arrows - Move, Space/W/Up - Jump"})]})},Game3Simulation=({vm:tt,width:et,height:rt})=>{const nt=reactExports.useRef(null),[it,at]=reactExports.useState(tt.heroVisuals),st=tt.worldScale;return moduleExports.useTick(ot=>{const lt=tt.heroVisuals;if(!nt.current||!lt)return;const ht=st,dt=lt.x+lt.width/2,ut=lt.y+lt.height/2,ft=et/2-dt*ht,mt=rt/2-ut*ht;nt.current.x+=(ft-nt.current.x)*.1*ot,nt.current.y+=(mt-nt.current.y)*.1*ot,at({...lt})}),jsxRuntimeExports.jsxs(moduleExports.Container,{ref:nt,scale:st,children:[jsxRuntimeExports.jsx(moduleExports.Graphics,{draw:ot=>{if(ot.clear(),!!tt.mapData)for(const lt of tt.mapData.platforms){ot.lineStyle(1/st,16777215,.3);let ht=lt.isFloor?2899536:3426654;lt.isWall&&(ht=9323693),lt.isSpike&&(ht=1752220),lt.isPortal&&(ht=1835263),lt.isVoid&&(ht=0);let dt=.8;lt.isExit&&(ht=16711680,dt=0,ot.lineStyle(2/st,16711680,1)),ot.beginFill(ht,dt),ot.drawRect(lt.x,lt.y,lt.width,lt.height),ot.endFill()}}}),jsxRuntimeExports.jsx(moduleExports.Graphics,{draw:ot=>{ot.clear();let lt=2600544;it.animState===1&&(lt=2719929),it.animState===2&&(lt=12597547),it.animState===3&&(lt=9323693),ot.lineStyle(2/st,16777215,.8),ot.beginFill(lt,.6),ot.drawRect(it.x,it.y,it.width,it.height),ot.endFill();const ht=it.width*.2,dt=it.flipX?it.x:it.x+it.width-ht;ot.beginFill(16777215,.5),ot.drawRect(dt,it.y+it.height*.1,ht,it.height*.2),ot.endFill(),ot.beginFill(16776960,1),ot.drawCircle(it.x+it.width/2,it.y+it.height,.05),ot.endFill()}})]})},levelData={"Level 1":{initialHP:100,manifestPath:"res/three_manifest.json",bgmKey:"bgm_level1",mapPath:"res/sprite/maps/MapTest.png",mapScale:1,heroWidth:1,heroHeight:1,playerScale:1,playerOffsetY:0,worldScale:16}};var Game3Level=(tt=>(tt.Level1="Level 1",tt.Level2="Level 2",tt.Level3="Level 3",tt.Level4="Level 4",tt))(Game3Level||{});const getGame3Config=tt=>levelData["Level 1"],Game3View=({vm:tt,controller:et})=>{const[rt,nt]=React.useState(0);React.useEffect(()=>{const lt=tt.subscribe(()=>nt(ht=>ht+1));return()=>lt()},[tt]);const it=tt.stats,at=tt.visualEffects,st=1920,ot=1080;return jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:jsxRuntimeExports.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",background:"#050508",overflow:"hidden",boxShadow:"0 0 50px rgba(0,0,0,0.5)"},children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"radial-gradient(circle at center, #1a1a2e 0%, #050508 100%)",opacity:.6}}),jsxRuntimeExports.jsx(moduleExports.Stage,{width:st,height:ot,options:{backgroundColor:0,backgroundAlpha:0,antialias:!0},style:{position:"absolute",inset:0,width:"100%",height:"100%",imageRendering:"pixelated"},children:jsxRuntimeExports.jsx(Game3Simulation,{vm:tt,width:st,height:ot})}),jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,pointerEvents:"none",boxShadow:`inset 0 0 ${120+at.vignettePulse*40}px rgba(0,0,0,0.9)`,mixBlendMode:"multiply"}}),jsxRuntimeExports.jsx(Game3HUD,{stats:it,onAction:(lt,ht)=>{lt==="MOD_HP"&&et.modifyHP(ht||0)},onLevel1:()=>et.loadLevel(Game3Level.Level1),onLevel2:()=>et.loadLevel(Game3Level.Level2),onLevel3:()=>et.loadLevel(Game3Level.Level3),onLevel4:()=>et.loadLevel(Game3Level.Level4),onQuickLoad:()=>et.resetLevel()})]})})};class Game3Presenter extends BasePresenter{_mapData=null;set mapData(et){this._mapData=et,this.notify()}get mapData(){return this._mapData}get heroVisuals(){const et=Game3ViewSchema,rt=this.sharedView[et.HERO_ANIM_STATE];let nt="hero_idle",it="idle";return rt===1&&(nt="hero_walk",it="walk"),rt===2&&(nt="hero_walk",it="walk"),{x:this.sharedView[et.HERO_X]||0,y:this.sharedView[et.HERO_Y]||0,frame:Math.floor(this.sharedView[et.HERO_ANIM_FRAME]||0),flipX:this.sharedView[et.HERO_FLIP]>.5,width:this.sharedView[et.HERO_WIDTH]||1,height:this.sharedView[et.HERO_HEIGHT]||1,playerScale:this.sharedView[et.PLAYER_SCALE]||1,playerOffsetY:this.sharedView[et.PLAYER_OFFSET_Y]||0,assetKey:nt,animationName:it,animState:rt}}get worldScale(){return this.sharedView[Game3ViewSchema.WORLD_SCALE]||32}get stats(){const et=Game3ViewSchema;return{hp:this.sharedView[et.HERO_HP]||0}}get visualEffects(){const et=Game3ViewSchema;return{uiOffset:this.sharedView[et.UI_BOUNCE]||0,glitchIntensity:this.sharedView[et.GLITCH_INTENSITY]||0,vignettePulse:this.sharedView[et.VIGNETTE_PULSE]||0}}}const scriptRel="modulepreload",assetsURL=function(tt){return"/LuckyRepo/"+tt},seen={},__vitePreload=function(et,rt,nt){let it=Promise.resolve();if(rt&&rt.length>0){let ht=function(dt){return Promise.all(dt.map(ut=>Promise.resolve(ut).then(ft=>({status:"fulfilled",value:ft}),ft=>({status:"rejected",reason:ft}))))};var st=ht;document.getElementsByTagName("link");const ot=document.querySelector("meta[property=csp-nonce]"),lt=ot?.nonce||ot?.getAttribute("nonce");it=ht(rt.map(dt=>{if(dt=assetsURL(dt),dt in seen)return;seen[dt]=!0;const ut=dt.endsWith(".css"),ft=ut?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${dt}"]${ft}`))return;const mt=document.createElement("link");if(mt.rel=ut?"stylesheet":scriptRel,ut||(mt.as="script"),mt.crossOrigin="",mt.href=dt,lt&&mt.setAttribute("nonce",lt),document.head.appendChild(mt),ut)return new Promise((gt,vt)=>{mt.addEventListener("load",gt),mt.addEventListener("error",()=>vt(new Error(`Unable to preload CSS for ${dt}`)))})}))}function at(ot){const lt=new Event("vite:preloadError",{cancelable:!0});if(lt.payload=ot,window.dispatchEvent(lt),!lt.defaultPrevented)throw ot}return it.then(ot=>{for(const lt of ot||[])lt.status==="rejected"&&at(lt.reason);return et().catch(at)})};var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}function getAugmentedNamespace(tt){if(tt.__esModule)return tt;var et=tt.default;if(typeof et=="function"){var rt=function nt(){return this instanceof nt?Reflect.construct(et,arguments,this.constructor):et.apply(this,arguments)};rt.prototype=et.prototype}else rt={};return Object.defineProperty(rt,"__esModule",{value:!0}),Object.keys(tt).forEach((function(nt){var it=Object.getOwnPropertyDescriptor(tt,nt);Object.defineProperty(rt,nt,it.get?it:{enumerable:!0,get:function(){return tt[nt]}})})),rt}typeof self>"u"&&typeof commonjsGlobal=="object"&&(commonjsGlobal.self=commonjsGlobal);var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et=0;et<64;++et)lookup[et]=tt[et],revLookup[tt.charCodeAt(et)]=et;revLookup[45]=62,revLookup[95]=63}function toByteArray(tt){var et,rt,nt,it,at,st;inited||init();var ot=tt.length;if(ot%4>0)throw new Error("Invalid string. Length must be a multiple of 4");at=tt[ot-2]==="="?2:tt[ot-1]==="="?1:0,st=new Arr(3*ot/4-at),nt=at>0?ot-4:ot;var lt=0;for(et=0,rt=0;et<nt;et+=4,rt+=3)it=revLookup[tt.charCodeAt(et)]<<18|revLookup[tt.charCodeAt(et+1)]<<12|revLookup[tt.charCodeAt(et+2)]<<6|revLookup[tt.charCodeAt(et+3)],st[lt++]=it>>16&255,st[lt++]=it>>8&255,st[lt++]=255&it;return at===2?(it=revLookup[tt.charCodeAt(et)]<<2|revLookup[tt.charCodeAt(et+1)]>>4,st[lt++]=255&it):at===1&&(it=revLookup[tt.charCodeAt(et)]<<10|revLookup[tt.charCodeAt(et+1)]<<4|revLookup[tt.charCodeAt(et+2)]>>2,st[lt++]=it>>8&255,st[lt++]=255&it),st}function tripletToBase64(tt){return lookup[tt>>18&63]+lookup[tt>>12&63]+lookup[tt>>6&63]+lookup[63&tt]}function encodeChunk(tt,et,rt){for(var nt,it=[],at=et;at<rt;at+=3)nt=(tt[at]<<16)+(tt[at+1]<<8)+tt[at+2],it.push(tripletToBase64(nt));return it.join("")}function fromByteArray(tt){var et;inited||init();for(var rt=tt.length,nt=rt%3,it="",at=[],st=16383,ot=0,lt=rt-nt;ot<lt;ot+=st)at.push(encodeChunk(tt,ot,ot+st>lt?lt:ot+st));return nt===1?(et=tt[rt-1],it+=lookup[et>>2],it+=lookup[et<<4&63],it+="=="):nt===2&&(et=(tt[rt-2]<<8)+tt[rt-1],it+=lookup[et>>10],it+=lookup[et>>4&63],it+=lookup[et<<2&63],it+="="),at.push(it),at.join("")}function read(tt,et,rt,nt,it){var at,st,ot=8*it-nt-1,lt=(1<<ot)-1,ht=lt>>1,dt=-7,ut=rt?it-1:0,ft=rt?-1:1,mt=tt[et+ut];for(ut+=ft,at=mt&(1<<-dt)-1,mt>>=-dt,dt+=ot;dt>0;at=256*at+tt[et+ut],ut+=ft,dt-=8);for(st=at&(1<<-dt)-1,at>>=-dt,dt+=nt;dt>0;st=256*st+tt[et+ut],ut+=ft,dt-=8);if(at===0)at=1-ht;else{if(at===lt)return st?NaN:1/0*(mt?-1:1);st+=Math.pow(2,nt),at-=ht}return(mt?-1:1)*st*Math.pow(2,at-nt)}function write(tt,et,rt,nt,it,at){var st,ot,lt,ht=8*at-it-1,dt=(1<<ht)-1,ut=dt>>1,ft=it===23?Math.pow(2,-24)-Math.pow(2,-77):0,mt=nt?0:at-1,gt=nt?1:-1,vt=et<0||et===0&&1/et<0?1:0;for(et=Math.abs(et),isNaN(et)||et===1/0?(ot=isNaN(et)?1:0,st=dt):(st=Math.floor(Math.log(et)/Math.LN2),et*(lt=Math.pow(2,-st))<1&&(st--,lt*=2),(et+=st+ut>=1?ft/lt:ft*Math.pow(2,1-ut))*lt>=2&&(st++,lt/=2),st+ut>=dt?(ot=0,st=dt):st+ut>=1?(ot=(et*lt-1)*Math.pow(2,it),st+=ut):(ot=et*Math.pow(2,ut-1)*Math.pow(2,it),st=0));it>=8;tt[rt+mt]=255&ot,mt+=gt,ot/=256,it-=8);for(st=st<<it|ot,ht+=it;ht>0;tt[rt+mt]=255&st,mt+=gt,st/=256,ht-=8);tt[rt+mt-gt]|=128*vt}var toString={}.toString,isArray=Array.isArray||function(tt){return toString.call(tt)=="[object Array]"},INSPECT_MAX_BYTES=50;function kMaxLength(){return Buffer$1.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(tt,et){if(kMaxLength()<et)throw new RangeError("Invalid typed array length");return Buffer$1.TYPED_ARRAY_SUPPORT?(tt=new Uint8Array(et)).__proto__=Buffer$1.prototype:(tt===null&&(tt=new Buffer$1(et)),tt.length=et),tt}function Buffer$1(tt,et,rt){if(!(Buffer$1.TYPED_ARRAY_SUPPORT||this instanceof Buffer$1))return new Buffer$1(tt,et,rt);if(typeof tt=="number"){if(typeof et=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,tt)}return from(this,tt,et,rt)}function from(tt,et,rt,nt){if(typeof et=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&et instanceof ArrayBuffer?fromArrayBuffer(tt,et,rt,nt):typeof et=="string"?fromString(tt,et,rt):fromObject(tt,et)}function assertSize(tt){if(typeof tt!="number")throw new TypeError('"size" argument must be a number');if(tt<0)throw new RangeError('"size" argument must not be negative')}function alloc(tt,et,rt,nt){return assertSize(et),et<=0?createBuffer(tt,et):rt!==void 0?typeof nt=="string"?createBuffer(tt,et).fill(rt,nt):createBuffer(tt,et).fill(rt):createBuffer(tt,et)}function allocUnsafe(tt,et){if(assertSize(et),tt=createBuffer(tt,et<0?0:0|checked(et)),!Buffer$1.TYPED_ARRAY_SUPPORT)for(var rt=0;rt<et;++rt)tt[rt]=0;return tt}function fromString(tt,et,rt){if(typeof rt=="string"&&rt!==""||(rt="utf8"),!Buffer$1.isEncoding(rt))throw new TypeError('"encoding" must be a valid string encoding');var nt=0|byteLength(et,rt),it=(tt=createBuffer(tt,nt)).write(et,rt);return it!==nt&&(tt=tt.slice(0,it)),tt}function fromArrayLike(tt,et){var rt=et.length<0?0:0|checked(et.length);tt=createBuffer(tt,rt);for(var nt=0;nt<rt;nt+=1)tt[nt]=255&et[nt];return tt}function fromArrayBuffer(tt,et,rt,nt){if(et.byteLength,rt<0||et.byteLength<rt)throw new RangeError("'offset' is out of bounds");if(et.byteLength<rt+(nt||0))throw new RangeError("'length' is out of bounds");return et=rt===void 0&&nt===void 0?new Uint8Array(et):nt===void 0?new Uint8Array(et,rt):new Uint8Array(et,rt,nt),Buffer$1.TYPED_ARRAY_SUPPORT?(tt=et).__proto__=Buffer$1.prototype:tt=fromArrayLike(tt,et),tt}function fromObject(tt,et){if(internalIsBuffer(et)){var rt=0|checked(et.length);return(tt=createBuffer(tt,rt)).length===0||et.copy(tt,0,0,rt),tt}if(et){if(typeof ArrayBuffer<"u"&&et.buffer instanceof ArrayBuffer||"length"in et)return typeof et.length!="number"||isnan(et.length)?createBuffer(tt,0):fromArrayLike(tt,et);if(et.type==="Buffer"&&isArray(et.data))return fromArrayLike(tt,et.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(tt){if(tt>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|tt}function internalIsBuffer(tt){return!(tt==null||!tt._isBuffer)}function byteLength(tt,et){if(internalIsBuffer(tt))return tt.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(tt)||tt instanceof ArrayBuffer))return tt.byteLength;typeof tt!="string"&&(tt=""+tt);var rt=tt.length;if(rt===0)return 0;for(var nt=!1;;)switch(et){case"ascii":case"latin1":case"binary":return rt;case"utf8":case"utf-8":case void 0:return utf8ToBytes(tt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*rt;case"hex":return rt>>>1;case"base64":return base64ToBytes(tt).length;default:if(nt)return utf8ToBytes(tt).length;et=(""+et).toLowerCase(),nt=!0}}function slowToString(tt,et,rt){var nt=!1;if((et===void 0||et<0)&&(et=0),et>this.length||((rt===void 0||rt>this.length)&&(rt=this.length),rt<=0)||(rt>>>=0)<=(et>>>=0))return"";for(tt||(tt="utf8");;)switch(tt){case"hex":return hexSlice(this,et,rt);case"utf8":case"utf-8":return utf8Slice(this,et,rt);case"ascii":return asciiSlice(this,et,rt);case"latin1":case"binary":return latin1Slice(this,et,rt);case"base64":return base64Slice(this,et,rt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,et,rt);default:if(nt)throw new TypeError("Unknown encoding: "+tt);tt=(tt+"").toLowerCase(),nt=!0}}function swap(tt,et,rt){var nt=tt[et];tt[et]=tt[rt],tt[rt]=nt}function bidirectionalIndexOf(tt,et,rt,nt,it){if(tt.length===0)return-1;if(typeof rt=="string"?(nt=rt,rt=0):rt>2147483647?rt=2147483647:rt<-2147483648&&(rt=-2147483648),rt=+rt,isNaN(rt)&&(rt=it?0:tt.length-1),rt<0&&(rt=tt.length+rt),rt>=tt.length){if(it)return-1;rt=tt.length-1}else if(rt<0){if(!it)return-1;rt=0}if(typeof et=="string"&&(et=Buffer$1.from(et,nt)),internalIsBuffer(et))return et.length===0?-1:arrayIndexOf(tt,et,rt,nt,it);if(typeof et=="number")return et&=255,Buffer$1.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?it?Uint8Array.prototype.indexOf.call(tt,et,rt):Uint8Array.prototype.lastIndexOf.call(tt,et,rt):arrayIndexOf(tt,[et],rt,nt,it);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(tt,et,rt,nt,it){var at,st=1,ot=tt.length,lt=et.length;if(nt!==void 0&&((nt=String(nt).toLowerCase())==="ucs2"||nt==="ucs-2"||nt==="utf16le"||nt==="utf-16le")){if(tt.length<2||et.length<2)return-1;st=2,ot/=2,lt/=2,rt/=2}function ht(mt,gt){return st===1?mt[gt]:mt.readUInt16BE(gt*st)}if(it){var dt=-1;for(at=rt;at<ot;at++)if(ht(tt,at)===ht(et,dt===-1?0:at-dt)){if(dt===-1&&(dt=at),at-dt+1===lt)return dt*st}else dt!==-1&&(at-=at-dt),dt=-1}else for(rt+lt>ot&&(rt=ot-lt),at=rt;at>=0;at--){for(var ut=!0,ft=0;ft<lt;ft++)if(ht(tt,at+ft)!==ht(et,ft)){ut=!1;break}if(ut)return at}return-1}function hexWrite(tt,et,rt,nt){rt=Number(rt)||0;var it=tt.length-rt;nt?(nt=Number(nt))>it&&(nt=it):nt=it;var at=et.length;if(at%2!=0)throw new TypeError("Invalid hex string");nt>at/2&&(nt=at/2);for(var st=0;st<nt;++st){var ot=parseInt(et.substr(2*st,2),16);if(isNaN(ot))return st;tt[rt+st]=ot}return st}function utf8Write(tt,et,rt,nt){return blitBuffer(utf8ToBytes(et,tt.length-rt),tt,rt,nt)}function asciiWrite(tt,et,rt,nt){return blitBuffer(asciiToBytes(et),tt,rt,nt)}function latin1Write(tt,et,rt,nt){return asciiWrite(tt,et,rt,nt)}function base64Write(tt,et,rt,nt){return blitBuffer(base64ToBytes(et),tt,rt,nt)}function ucs2Write(tt,et,rt,nt){return blitBuffer(utf16leToBytes(et,tt.length-rt),tt,rt,nt)}function base64Slice(tt,et,rt){return et===0&&rt===tt.length?fromByteArray(tt):fromByteArray(tt.slice(et,rt))}function utf8Slice(tt,et,rt){rt=Math.min(tt.length,rt);for(var nt=[],it=et;it<rt;){var at,st,ot,lt,ht=tt[it],dt=null,ut=ht>239?4:ht>223?3:ht>191?2:1;if(it+ut<=rt)switch(ut){case 1:ht<128&&(dt=ht);break;case 2:(192&(at=tt[it+1]))==128&&(lt=(31&ht)<<6|63&at)>127&&(dt=lt);break;case 3:at=tt[it+1],st=tt[it+2],(192&at)==128&&(192&st)==128&&(lt=(15&ht)<<12|(63&at)<<6|63&st)>2047&&(lt<55296||lt>57343)&&(dt=lt);break;case 4:at=tt[it+1],st=tt[it+2],ot=tt[it+3],(192&at)==128&&(192&st)==128&&(192&ot)==128&&(lt=(15&ht)<<18|(63&at)<<12|(63&st)<<6|63&ot)>65535&&lt<1114112&&(dt=lt)}dt===null?(dt=65533,ut=1):dt>65535&&(dt-=65536,nt.push(dt>>>10&1023|55296),dt=56320|1023&dt),nt.push(dt),it+=ut}return decodeCodePointsArray(nt)}Buffer$1.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT===void 0||global$1.TYPED_ARRAY_SUPPORT,kMaxLength(),Buffer$1.poolSize=8192,Buffer$1._augment=function(tt){return tt.__proto__=Buffer$1.prototype,tt},Buffer$1.from=function(tt,et,rt){return from(null,tt,et,rt)},Buffer$1.TYPED_ARRAY_SUPPORT&&(Buffer$1.prototype.__proto__=Uint8Array.prototype,Buffer$1.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&Buffer$1[Symbol.species]),Buffer$1.alloc=function(tt,et,rt){return alloc(null,tt,et,rt)},Buffer$1.allocUnsafe=function(tt){return allocUnsafe(null,tt)},Buffer$1.allocUnsafeSlow=function(tt){return allocUnsafe(null,tt)},Buffer$1.isBuffer=isBuffer,Buffer$1.compare=function(tt,et){if(!internalIsBuffer(tt)||!internalIsBuffer(et))throw new TypeError("Arguments must be Buffers");if(tt===et)return 0;for(var rt=tt.length,nt=et.length,it=0,at=Math.min(rt,nt);it<at;++it)if(tt[it]!==et[it]){rt=tt[it],nt=et[it];break}return rt<nt?-1:nt<rt?1:0},Buffer$1.isEncoding=function(tt){switch(String(tt).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$1.concat=function(tt,et){if(!isArray(tt))throw new TypeError('"list" argument must be an Array of Buffers');if(tt.length===0)return Buffer$1.alloc(0);var rt;if(et===void 0)for(et=0,rt=0;rt<tt.length;++rt)et+=tt[rt].length;var nt=Buffer$1.allocUnsafe(et),it=0;for(rt=0;rt<tt.length;++rt){var at=tt[rt];if(!internalIsBuffer(at))throw new TypeError('"list" argument must be an Array of Buffers');at.copy(nt,it),it+=at.length}return nt},Buffer$1.byteLength=byteLength,Buffer$1.prototype._isBuffer=!0,Buffer$1.prototype.swap16=function(){var tt=this.length;if(tt%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var et=0;et<tt;et+=2)swap(this,et,et+1);return this},Buffer$1.prototype.swap32=function(){var tt=this.length;if(tt%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var et=0;et<tt;et+=4)swap(this,et,et+3),swap(this,et+1,et+2);return this},Buffer$1.prototype.swap64=function(){var tt=this.length;if(tt%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var et=0;et<tt;et+=8)swap(this,et,et+7),swap(this,et+1,et+6),swap(this,et+2,et+5),swap(this,et+3,et+4);return this},Buffer$1.prototype.toString=function(){var tt=0|this.length;return tt===0?"":arguments.length===0?utf8Slice(this,0,tt):slowToString.apply(this,arguments)},Buffer$1.prototype.equals=function(tt){if(!internalIsBuffer(tt))throw new TypeError("Argument must be a Buffer");return this===tt||Buffer$1.compare(this,tt)===0},Buffer$1.prototype.inspect=function(){var tt="",et=INSPECT_MAX_BYTES;return this.length>0&&(tt=this.toString("hex",0,et).match(/.{2}/g).join(" "),this.length>et&&(tt+=" ... ")),"<Buffer "+tt+">"},Buffer$1.prototype.compare=function(tt,et,rt,nt,it){if(!internalIsBuffer(tt))throw new TypeError("Argument must be a Buffer");if(et===void 0&&(et=0),rt===void 0&&(rt=tt?tt.length:0),nt===void 0&&(nt=0),it===void 0&&(it=this.length),et<0||rt>tt.length||nt<0||it>this.length)throw new RangeError("out of range index");if(nt>=it&&et>=rt)return 0;if(nt>=it)return-1;if(et>=rt)return 1;if(this===tt)return 0;for(var at=(it>>>=0)-(nt>>>=0),st=(rt>>>=0)-(et>>>=0),ot=Math.min(at,st),lt=this.slice(nt,it),ht=tt.slice(et,rt),dt=0;dt<ot;++dt)if(lt[dt]!==ht[dt]){at=lt[dt],st=ht[dt];break}return at<st?-1:st<at?1:0},Buffer$1.prototype.includes=function(tt,et,rt){return this.indexOf(tt,et,rt)!==-1},Buffer$1.prototype.indexOf=function(tt,et,rt){return bidirectionalIndexOf(this,tt,et,rt,!0)},Buffer$1.prototype.lastIndexOf=function(tt,et,rt){return bidirectionalIndexOf(this,tt,et,rt,!1)},Buffer$1.prototype.write=function(tt,et,rt,nt){if(et===void 0)nt="utf8",rt=this.length,et=0;else if(rt===void 0&&typeof et=="string")nt=et,rt=this.length,et=0;else{if(!isFinite(et))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");et|=0,isFinite(rt)?(rt|=0,nt===void 0&&(nt="utf8")):(nt=rt,rt=void 0)}var it=this.length-et;if((rt===void 0||rt>it)&&(rt=it),tt.length>0&&(rt<0||et<0)||et>this.length)throw new RangeError("Attempt to write outside buffer bounds");nt||(nt="utf8");for(var at=!1;;)switch(nt){case"hex":return hexWrite(this,tt,et,rt);case"utf8":case"utf-8":return utf8Write(this,tt,et,rt);case"ascii":return asciiWrite(this,tt,et,rt);case"latin1":case"binary":return latin1Write(this,tt,et,rt);case"base64":return base64Write(this,tt,et,rt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,tt,et,rt);default:if(at)throw new TypeError("Unknown encoding: "+nt);nt=(""+nt).toLowerCase(),at=!0}},Buffer$1.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(tt){var et=tt.length;if(et<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,tt);for(var rt="",nt=0;nt<et;)rt+=String.fromCharCode.apply(String,tt.slice(nt,nt+=MAX_ARGUMENTS_LENGTH));return rt}function asciiSlice(tt,et,rt){var nt="";rt=Math.min(tt.length,rt);for(var it=et;it<rt;++it)nt+=String.fromCharCode(127&tt[it]);return nt}function latin1Slice(tt,et,rt){var nt="";rt=Math.min(tt.length,rt);for(var it=et;it<rt;++it)nt+=String.fromCharCode(tt[it]);return nt}function hexSlice(tt,et,rt){var nt=tt.length;(!et||et<0)&&(et=0),(!rt||rt<0||rt>nt)&&(rt=nt);for(var it="",at=et;at<rt;++at)it+=toHex(tt[at]);return it}function utf16leSlice(tt,et,rt){for(var nt=tt.slice(et,rt),it="",at=0;at<nt.length;at+=2)it+=String.fromCharCode(nt[at]+256*nt[at+1]);return it}function checkOffset(tt,et,rt){if(tt%1!=0||tt<0)throw new RangeError("offset is not uint");if(tt+et>rt)throw new RangeError("Trying to access beyond buffer length")}function checkInt(tt,et,rt,nt,it,at){if(!internalIsBuffer(tt))throw new TypeError('"buffer" argument must be a Buffer instance');if(et>it||et<at)throw new RangeError('"value" argument is out of bounds');if(rt+nt>tt.length)throw new RangeError("Index out of range")}function objectWriteUInt16(tt,et,rt,nt){et<0&&(et=65535+et+1);for(var it=0,at=Math.min(tt.length-rt,2);it<at;++it)tt[rt+it]=(et&255<<8*(nt?it:1-it))>>>8*(nt?it:1-it)}function objectWriteUInt32(tt,et,rt,nt){et<0&&(et=4294967295+et+1);for(var it=0,at=Math.min(tt.length-rt,4);it<at;++it)tt[rt+it]=et>>>8*(nt?it:3-it)&255}function checkIEEE754(tt,et,rt,nt,it,at){if(rt+nt>tt.length)throw new RangeError("Index out of range");if(rt<0)throw new RangeError("Index out of range")}function writeFloat(tt,et,rt,nt,it){return it||checkIEEE754(tt,et,rt,4),write(tt,et,rt,nt,23,4),rt+4}function writeDouble(tt,et,rt,nt,it){return it||checkIEEE754(tt,et,rt,8),write(tt,et,rt,nt,52,8),rt+8}Buffer$1.prototype.slice=function(tt,et){var rt,nt=this.length;if((tt=~~tt)<0?(tt+=nt)<0&&(tt=0):tt>nt&&(tt=nt),(et=et===void 0?nt:~~et)<0?(et+=nt)<0&&(et=0):et>nt&&(et=nt),et<tt&&(et=tt),Buffer$1.TYPED_ARRAY_SUPPORT)(rt=this.subarray(tt,et)).__proto__=Buffer$1.prototype;else{var it=et-tt;rt=new Buffer$1(it,void 0);for(var at=0;at<it;++at)rt[at]=this[at+tt]}return rt},Buffer$1.prototype.readUIntLE=function(tt,et,rt){tt|=0,et|=0,rt||checkOffset(tt,et,this.length);for(var nt=this[tt],it=1,at=0;++at<et&&(it*=256);)nt+=this[tt+at]*it;return nt},Buffer$1.prototype.readUIntBE=function(tt,et,rt){tt|=0,et|=0,rt||checkOffset(tt,et,this.length);for(var nt=this[tt+--et],it=1;et>0&&(it*=256);)nt+=this[tt+--et]*it;return nt},Buffer$1.prototype.readUInt8=function(tt,et){return et||checkOffset(tt,1,this.length),this[tt]},Buffer$1.prototype.readUInt16LE=function(tt,et){return et||checkOffset(tt,2,this.length),this[tt]|this[tt+1]<<8},Buffer$1.prototype.readUInt16BE=function(tt,et){return et||checkOffset(tt,2,this.length),this[tt]<<8|this[tt+1]},Buffer$1.prototype.readUInt32LE=function(tt,et){return et||checkOffset(tt,4,this.length),(this[tt]|this[tt+1]<<8|this[tt+2]<<16)+16777216*this[tt+3]},Buffer$1.prototype.readUInt32BE=function(tt,et){return et||checkOffset(tt,4,this.length),16777216*this[tt]+(this[tt+1]<<16|this[tt+2]<<8|this[tt+3])},Buffer$1.prototype.readIntLE=function(tt,et,rt){tt|=0,et|=0,rt||checkOffset(tt,et,this.length);for(var nt=this[tt],it=1,at=0;++at<et&&(it*=256);)nt+=this[tt+at]*it;return nt>=(it*=128)&&(nt-=Math.pow(2,8*et)),nt},Buffer$1.prototype.readIntBE=function(tt,et,rt){tt|=0,et|=0,rt||checkOffset(tt,et,this.length);for(var nt=et,it=1,at=this[tt+--nt];nt>0&&(it*=256);)at+=this[tt+--nt]*it;return at>=(it*=128)&&(at-=Math.pow(2,8*et)),at},Buffer$1.prototype.readInt8=function(tt,et){return et||checkOffset(tt,1,this.length),128&this[tt]?-1*(255-this[tt]+1):this[tt]},Buffer$1.prototype.readInt16LE=function(tt,et){et||checkOffset(tt,2,this.length);var rt=this[tt]|this[tt+1]<<8;return 32768&rt?4294901760|rt:rt},Buffer$1.prototype.readInt16BE=function(tt,et){et||checkOffset(tt,2,this.length);var rt=this[tt+1]|this[tt]<<8;return 32768&rt?4294901760|rt:rt},Buffer$1.prototype.readInt32LE=function(tt,et){return et||checkOffset(tt,4,this.length),this[tt]|this[tt+1]<<8|this[tt+2]<<16|this[tt+3]<<24},Buffer$1.prototype.readInt32BE=function(tt,et){return et||checkOffset(tt,4,this.length),this[tt]<<24|this[tt+1]<<16|this[tt+2]<<8|this[tt+3]},Buffer$1.prototype.readFloatLE=function(tt,et){return et||checkOffset(tt,4,this.length),read(this,tt,!0,23,4)},Buffer$1.prototype.readFloatBE=function(tt,et){return et||checkOffset(tt,4,this.length),read(this,tt,!1,23,4)},Buffer$1.prototype.readDoubleLE=function(tt,et){return et||checkOffset(tt,8,this.length),read(this,tt,!0,52,8)},Buffer$1.prototype.readDoubleBE=function(tt,et){return et||checkOffset(tt,8,this.length),read(this,tt,!1,52,8)},Buffer$1.prototype.writeUIntLE=function(tt,et,rt,nt){tt=+tt,et|=0,rt|=0,nt||checkInt(this,tt,et,rt,Math.pow(2,8*rt)-1,0);var it=1,at=0;for(this[et]=255&tt;++at<rt&&(it*=256);)this[et+at]=tt/it&255;return et+rt},Buffer$1.prototype.writeUIntBE=function(tt,et,rt,nt){tt=+tt,et|=0,rt|=0,nt||checkInt(this,tt,et,rt,Math.pow(2,8*rt)-1,0);var it=rt-1,at=1;for(this[et+it]=255&tt;--it>=0&&(at*=256);)this[et+it]=tt/at&255;return et+rt},Buffer$1.prototype.writeUInt8=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,1,255,0),Buffer$1.TYPED_ARRAY_SUPPORT||(tt=Math.floor(tt)),this[et]=255&tt,et+1},Buffer$1.prototype.writeUInt16LE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,2,65535,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=255&tt,this[et+1]=tt>>>8):objectWriteUInt16(this,tt,et,!0),et+2},Buffer$1.prototype.writeUInt16BE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,2,65535,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=tt>>>8,this[et+1]=255&tt):objectWriteUInt16(this,tt,et,!1),et+2},Buffer$1.prototype.writeUInt32LE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,4,4294967295,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et+3]=tt>>>24,this[et+2]=tt>>>16,this[et+1]=tt>>>8,this[et]=255&tt):objectWriteUInt32(this,tt,et,!0),et+4},Buffer$1.prototype.writeUInt32BE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,4,4294967295,0),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=tt>>>24,this[et+1]=tt>>>16,this[et+2]=tt>>>8,this[et+3]=255&tt):objectWriteUInt32(this,tt,et,!1),et+4},Buffer$1.prototype.writeIntLE=function(tt,et,rt,nt){if(tt=+tt,et|=0,!nt){var it=Math.pow(2,8*rt-1);checkInt(this,tt,et,rt,it-1,-it)}var at=0,st=1,ot=0;for(this[et]=255&tt;++at<rt&&(st*=256);)tt<0&&ot===0&&this[et+at-1]!==0&&(ot=1),this[et+at]=(tt/st|0)-ot&255;return et+rt},Buffer$1.prototype.writeIntBE=function(tt,et,rt,nt){if(tt=+tt,et|=0,!nt){var it=Math.pow(2,8*rt-1);checkInt(this,tt,et,rt,it-1,-it)}var at=rt-1,st=1,ot=0;for(this[et+at]=255&tt;--at>=0&&(st*=256);)tt<0&&ot===0&&this[et+at+1]!==0&&(ot=1),this[et+at]=(tt/st|0)-ot&255;return et+rt},Buffer$1.prototype.writeInt8=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,1,127,-128),Buffer$1.TYPED_ARRAY_SUPPORT||(tt=Math.floor(tt)),tt<0&&(tt=255+tt+1),this[et]=255&tt,et+1},Buffer$1.prototype.writeInt16LE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,2,32767,-32768),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=255&tt,this[et+1]=tt>>>8):objectWriteUInt16(this,tt,et,!0),et+2},Buffer$1.prototype.writeInt16BE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,2,32767,-32768),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=tt>>>8,this[et+1]=255&tt):objectWriteUInt16(this,tt,et,!1),et+2},Buffer$1.prototype.writeInt32LE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,4,2147483647,-2147483648),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=255&tt,this[et+1]=tt>>>8,this[et+2]=tt>>>16,this[et+3]=tt>>>24):objectWriteUInt32(this,tt,et,!0),et+4},Buffer$1.prototype.writeInt32BE=function(tt,et,rt){return tt=+tt,et|=0,rt||checkInt(this,tt,et,4,2147483647,-2147483648),tt<0&&(tt=4294967295+tt+1),Buffer$1.TYPED_ARRAY_SUPPORT?(this[et]=tt>>>24,this[et+1]=tt>>>16,this[et+2]=tt>>>8,this[et+3]=255&tt):objectWriteUInt32(this,tt,et,!1),et+4},Buffer$1.prototype.writeFloatLE=function(tt,et,rt){return writeFloat(this,tt,et,!0,rt)},Buffer$1.prototype.writeFloatBE=function(tt,et,rt){return writeFloat(this,tt,et,!1,rt)},Buffer$1.prototype.writeDoubleLE=function(tt,et,rt){return writeDouble(this,tt,et,!0,rt)},Buffer$1.prototype.writeDoubleBE=function(tt,et,rt){return writeDouble(this,tt,et,!1,rt)},Buffer$1.prototype.copy=function(tt,et,rt,nt){if(rt||(rt=0),nt||nt===0||(nt=this.length),et>=tt.length&&(et=tt.length),et||(et=0),nt>0&&nt<rt&&(nt=rt),nt===rt||tt.length===0||this.length===0)return 0;if(et<0)throw new RangeError("targetStart out of bounds");if(rt<0||rt>=this.length)throw new RangeError("sourceStart out of bounds");if(nt<0)throw new RangeError("sourceEnd out of bounds");nt>this.length&&(nt=this.length),tt.length-et<nt-rt&&(nt=tt.length-et+rt);var it,at=nt-rt;if(this===tt&&rt<et&&et<nt)for(it=at-1;it>=0;--it)tt[it+et]=this[it+rt];else if(at<1e3||!Buffer$1.TYPED_ARRAY_SUPPORT)for(it=0;it<at;++it)tt[it+et]=this[it+rt];else Uint8Array.prototype.set.call(tt,this.subarray(rt,rt+at),et);return at},Buffer$1.prototype.fill=function(tt,et,rt,nt){if(typeof tt=="string"){if(typeof et=="string"?(nt=et,et=0,rt=this.length):typeof rt=="string"&&(nt=rt,rt=this.length),tt.length===1){var it=tt.charCodeAt(0);it<256&&(tt=it)}if(nt!==void 0&&typeof nt!="string")throw new TypeError("encoding must be a string");if(typeof nt=="string"&&!Buffer$1.isEncoding(nt))throw new TypeError("Unknown encoding: "+nt)}else typeof tt=="number"&&(tt&=255);if(et<0||this.length<et||this.length<rt)throw new RangeError("Out of range index");if(rt<=et)return this;var at;if(et>>>=0,rt=rt===void 0?this.length:rt>>>0,tt||(tt=0),typeof tt=="number")for(at=et;at<rt;++at)this[at]=tt;else{var st=internalIsBuffer(tt)?tt:utf8ToBytes(new Buffer$1(tt,nt).toString()),ot=st.length;for(at=0;at<rt-et;++at)this[at+et]=st[at%ot]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g,HeaderTypes;function base64clean(tt){if((tt=stringtrim(tt).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;tt.length%4!=0;)tt+="=";return tt}function stringtrim(tt){return tt.trim?tt.trim():tt.replace(/^\s+|\s+$/g,"")}function toHex(tt){return tt<16?"0"+tt.toString(16):tt.toString(16)}function utf8ToBytes(tt,et){var rt;et=et||1/0;for(var nt=tt.length,it=null,at=[],st=0;st<nt;++st){if((rt=tt.charCodeAt(st))>55295&&rt<57344){if(!it){if(rt>56319){(et-=3)>-1&&at.push(239,191,189);continue}if(st+1===nt){(et-=3)>-1&&at.push(239,191,189);continue}it=rt;continue}if(rt<56320){(et-=3)>-1&&at.push(239,191,189),it=rt;continue}rt=65536+(it-55296<<10|rt-56320)}else it&&(et-=3)>-1&&at.push(239,191,189);if(it=null,rt<128){if((et-=1)<0)break;at.push(rt)}else if(rt<2048){if((et-=2)<0)break;at.push(rt>>6|192,63&rt|128)}else if(rt<65536){if((et-=3)<0)break;at.push(rt>>12|224,rt>>6&63|128,63&rt|128)}else{if(!(rt<1114112))throw new Error("Invalid code point");if((et-=4)<0)break;at.push(rt>>18|240,rt>>12&63|128,rt>>6&63|128,63&rt|128)}}return at}function asciiToBytes(tt){for(var et=[],rt=0;rt<tt.length;++rt)et.push(255&tt.charCodeAt(rt));return et}function utf16leToBytes(tt,et){for(var rt,nt,it,at=[],st=0;st<tt.length&&!((et-=2)<0);++st)nt=(rt=tt.charCodeAt(st))>>8,it=rt%256,at.push(it),at.push(nt);return at}function base64ToBytes(tt){return toByteArray(base64clean(tt))}function blitBuffer(tt,et,rt,nt){for(var it=0;it<nt&&!(it+rt>=et.length||it>=tt.length);++it)et[it+rt]=tt[it];return it}function isnan(tt){return tt!=tt}function isBuffer(tt){return tt!=null&&(!!tt._isBuffer||isFastBuffer(tt)||isSlowBuffer(tt))}function isFastBuffer(tt){return!!tt.constructor&&typeof tt.constructor.isBuffer=="function"&&tt.constructor.isBuffer(tt)}function isSlowBuffer(tt){return typeof tt.readFloatLE=="function"&&typeof tt.slice=="function"&&isFastBuffer(tt.slice(0,0))}(function(tt){tt[tt.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",tt[tt.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",tt[tt.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",tt[tt.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",tt[tt.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"})(HeaderTypes||(HeaderTypes={}));var HeaderTypes$1=HeaderTypes,BmpCompression;function maskColor(tt,et,rt,nt){const it=1+~tt&tt,at=1+~et&et,st=1+~rt&rt,ot=1+~nt&nt,lt=tt/it+1,ht=et/at+1,dt=rt/st+1,ut=nt/ot+1;return{shiftRed:ft=>(ft&tt)/it*256/lt,shiftGreen:ft=>(ft&et)/at*256/ht,shiftBlue:ft=>(ft&rt)/st*256/dt,shiftAlpha:nt!==0?ft=>(ft&nt)/ot*256/ut:()=>255}}(function(tt){tt[tt.NONE=0]="NONE",tt[tt.BI_RLE8=1]="BI_RLE8",tt[tt.BI_RLE4=2]="BI_RLE4",tt[tt.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",tt[tt.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"})(BmpCompression||(BmpCompression={}));class BmpDecoder{flag;fileSize;reserved1;reserved2;offset;headerSize;width;height;planes;bitPP;compression;rawSize;hr;vr;colors;importantColors;palette;data;maskRed;maskGreen;maskBlue;maskAlpha;toRGBA;pos;bottomUp;buffer;locRed;locGreen;locBlue;locAlpha;shiftRed;shiftGreen;shiftBlue;shiftAlpha;constructor(et,{toRGBA:rt}={toRGBA:!1}){if(this.buffer=et,this.toRGBA=!!rt,this.pos=0,this.bottomUp=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!=="BM")throw new Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.reserved2=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in HeaderTypes$1))throw new Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.height=this.height>2147483647?this.height-4294967296:this.height,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),this.bitPP===32?(this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255):this.bitPP===16&&(this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31),(this.headerSize>HeaderTypes$1.BITMAP_INFO_HEADER||this.compression===BmpCompression.BI_BIT_FIELDS||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE()),(this.headerSize>HeaderTypes$1.BITMAP_V2_INFO_HEADER||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskAlpha=this.readUInt32LE()),this.headerSize>HeaderTypes$1.BITMAP_V3_INFO_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V4_HEADER-HeaderTypes$1.BITMAP_V3_INFO_HEADER),this.headerSize>HeaderTypes$1.BITMAP_V4_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V5_HEADER-HeaderTypes$1.BITMAP_V4_HEADER),this.bitPP<=8||this.colors>0){const rt=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(rt);for(let nt=0;nt<rt;nt++){const it=this.buffer.readUInt8(this.pos++),at=this.buffer.readUInt8(this.pos++),st=this.buffer.readUInt8(this.pos++),ot=this.buffer.readUInt8(this.pos++);this.palette[nt]={red:st,green:at,blue:it,quad:ot}}}this.height<0&&(this.height*=-1,this.bottomUp=!1);const et=maskColor(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=et.shiftRed,this.shiftGreen=et.shiftGreen,this.shiftBlue=et.shiftBlue,this.shiftAlpha=et.shiftAlpha}parseRGBA(){switch(this.data=Buffer$1.alloc(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){const et=Math.ceil(this.width/8),rt=et%4,nt=rt!==0?4-rt:0;this.scanImage(nt,et,((it,at)=>{const st=this.buffer.readUInt8(this.pos++),ot=at*this.width*4+8*it*4;for(let lt=0;lt<8&&8*it+lt<this.width;lt++){const ht=this.palette[st>>7-lt&1];this.data[ot+lt*this.locAlpha]=0,this.data[ot+4*lt+this.locBlue]=ht.blue,this.data[ot+4*lt+this.locGreen]=ht.green,this.data[ot+4*lt+this.locRed]=ht.red}}))}bit4(){if(this.compression===BmpCompression.BI_RLE4){this.data.fill(0);let et=!1,rt=this.bottomUp?this.height-1:0,nt=0;for(;nt<this.data.length;){const it=this.buffer.readUInt8(this.pos++),at=this.buffer.readUInt8(this.pos++);if(it===0){if(at===0){rt+=this.bottomUp?-1:1,nt=rt*this.width*4,et=!1;continue}if(at===1)break;if(at===2){const st=this.buffer.readUInt8(this.pos++),ot=this.buffer.readUInt8(this.pos++);rt+=this.bottomUp?-ot:ot,nt+=ot*this.width*4+4*st}else{let st=this.buffer.readUInt8(this.pos++);for(let ot=0;ot<at;ot++)nt=this.setPixelData(nt,et?15&st:(240&st)>>4),1&ot&&ot+1<at&&(st=this.buffer.readUInt8(this.pos++)),et=!et;(at+1>>1&1)==1&&this.pos++}}else for(let st=0;st<it;st++)nt=this.setPixelData(nt,et?15&at:(240&at)>>4),et=!et}}else{const et=Math.ceil(this.width/2),rt=et%4,nt=rt!==0?4-rt:0;this.scanImage(nt,et,((it,at)=>{const st=this.buffer.readUInt8(this.pos++),ot=at*this.width*4+2*it*4,lt=st>>4;let ht=this.palette[lt];if(this.data[ot]=0,this.data[ot+1]=ht.blue,this.data[ot+2]=ht.green,this.data[ot+3]=ht.red,2*it+1>=this.width)return!1;const dt=15&st;ht=this.palette[dt],this.data[ot+4]=0,this.data[ot+4+1]=ht.blue,this.data[ot+4+2]=ht.green,this.data[ot+4+3]=ht.red}))}}bit8(){if(this.compression===BmpCompression.BI_RLE8){this.data.fill(0);let et=this.bottomUp?this.height-1:0,rt=0;for(;rt<this.data.length;){const nt=this.buffer.readUInt8(this.pos++),it=this.buffer.readUInt8(this.pos++);if(nt===0){if(it===0){et+=this.bottomUp?-1:1,rt=et*this.width*4;continue}if(it===1)break;if(it===2){const at=this.buffer.readUInt8(this.pos++),st=this.buffer.readUInt8(this.pos++);et+=this.bottomUp?-st:st,rt+=st*this.width*4+4*at}else{for(let at=0;at<it;at++){const st=this.buffer.readUInt8(this.pos++);rt=this.setPixelData(rt,st)}!0&it&&this.pos++}}else for(let at=0;at<nt;at++)rt=this.setPixelData(rt,it)}}else{const et=this.width%4,rt=et!==0?4-et:0;this.scanImage(rt,this.width,((nt,it)=>{const at=this.buffer.readUInt8(this.pos++),st=it*this.width*4+4*nt;if(at<this.palette.length){const ot=this.palette[at];this.data[st]=0,this.data[st+1]=ot.blue,this.data[st+2]=ot.green,this.data[st+3]=ot.red}else this.data[st]=0,this.data[st+1]=255,this.data[st+2]=255,this.data[st+3]=255}))}}bit16(){const et=this.width%2*2;this.scanImage(et,this.width,((rt,nt)=>{const it=nt*this.width*4+4*rt,at=this.buffer.readUInt16LE(this.pos);this.pos+=2,this.data[it+this.locRed]=this.shiftRed(at),this.data[it+this.locGreen]=this.shiftGreen(at),this.data[it+this.locBlue]=this.shiftBlue(at),this.data[it+this.locAlpha]=this.shiftAlpha(at)}))}bit24(){const et=this.width%4;this.scanImage(et,this.width,((rt,nt)=>{const it=nt*this.width*4+4*rt,at=this.buffer.readUInt8(this.pos++),st=this.buffer.readUInt8(this.pos++),ot=this.buffer.readUInt8(this.pos++);this.data[it+this.locRed]=ot,this.data[it+this.locGreen]=st,this.data[it+this.locBlue]=at,this.data[it+this.locAlpha]=0}))}bit32(){this.scanImage(0,this.width,((et,rt)=>{const nt=rt*this.width*4+4*et,it=this.readUInt32LE();this.data[nt+this.locRed]=this.shiftRed(it),this.data[nt+this.locGreen]=this.shiftGreen(it),this.data[nt+this.locBlue]=this.shiftBlue(it),this.data[nt+this.locAlpha]=this.shiftAlpha(it)}))}scanImage(et=0,rt=this.width,nt){for(let it=this.height-1;it>=0;it--){const at=this.bottomUp?it:this.height-1-it;for(let st=0;st<rt;st++)if(nt.call(this,st,at)===!1)return;this.pos+=et}}readUInt32LE(){const et=this.buffer.readUInt32LE(this.pos);return this.pos+=4,et}setPixelData(et,rt){const{blue:nt,green:it,red:at}=this.palette[rt];return this.data[et+this.locAlpha]=0,this.data[et+1+this.locBlue]=nt,this.data[et+2+this.locGreen]=it,this.data[et+3+this.locRed]=at,et+4}}function createInteger(tt){return tt.reduce(((et,rt)=>et<<1|rt),0)}function createColor(tt){return tt.quad<<24|tt.red<<16|tt.green<<8|tt.blue}class BmpEncoder{fileSize;reserved1;reserved2;offset;width;flag;height;planes;bitPP;compress;hr;vr;colors;importantColors;rawSize;headerSize;data;palette;extraBytes;buffer;bytesInColor;pos;constructor(et){switch(this.buffer=et.data,this.width=et.width,this.height=et.height,this.headerSize=HeaderTypes$1.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=et.bitPP||24,this.offset=54,this.reserved1=et.reserved1||0,this.reserved2=et.reserved2||0,this.planes=1,this.compress=0,this.hr=et.hr||0,this.vr=et.vr||0,this.importantColors=et.importantColors||0,this.colors=Math.min(2**(this.bitPP-1||1),et.colors||1/0),this.palette=et.palette||[],this.colors&&this.bitPP<16?this.offset+=4*this.colors:this.colors=0,this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=.5;break;case 1:this.bytesInColor=1/8;break;default:this.bytesInColor=3,this.bitPP=24}const rt=this.width*this.bitPP/32,nt=Math.ceil(rt);this.extraBytes=4*(nt-rt),this.rawSize=this.height*nt*4+2,this.fileSize=this.rawSize+this.offset,this.data=Buffer$1.alloc(this.fileSize,1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data.write(this.flag,this.pos,2),this.pos+=2,this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.data.writeUInt16LE(this.planes,this.pos),this.pos+=2,this.data.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){this.palette.length&&this.colors===2?this.initColors(1):(this.writeUInt32LE(16777215),this.writeUInt32LE(0)),this.pos+=1;let et=[];this.writeImage(((rt,nt,it)=>{let at=nt;at++;const st=this.buffer[at++],ot=this.buffer[at++],lt=.2126*this.buffer[at++]+.7152*ot+.0722*st;return et.push(lt>127?0:1),(it+1)%8==0?(this.data[rt-1]=createInteger(et),et=[]):it===this.width-1&&et.length>0&&(this.data[rt-1]=createInteger(et)<<4,et=[]),at}))}bit4(){const et=this.initColors(4);let rt=[];this.writeImage(((nt,it,at)=>{let st=it;const ot=createColor({quad:this.buffer[st++],blue:this.buffer[st++],green:this.buffer[st++],red:this.buffer[st++]}),lt=et.findIndex((ht=>ht===ot));return lt!==-1?rt.push(lt):rt.push(0),(at+1)%2==0&&(this.data[nt]=rt[0]<<4|rt[1],rt=[]),st}))}bit8(){const et=this.initColors(8);this.writeImage(((rt,nt)=>{let it=nt;const at=createColor({quad:this.buffer[it++],blue:this.buffer[it++],green:this.buffer[it++],red:this.buffer[it++]}),st=et.findIndex((ot=>ot===at));return this.data[rt]=st!==-1?st:0,it}))}bit16(){this.writeImage(((et,rt)=>{let nt=rt+1;const it=this.buffer[nt++]/8,at=this.buffer[nt++]/8,st=this.buffer[nt++]/8<<10|at<<5|it;return this.data[et]=255&st,this.data[et+1]=(65280&st)>>8,nt}))}bit24(){this.writeImage(((et,rt)=>{let nt=rt+1;return this.data[et]=this.buffer[nt++],this.data[et+1]=this.buffer[nt++],this.data[et+2]=this.buffer[nt++],nt}))}bit32(){this.writeImage(((et,rt)=>{let nt=rt;return this.data[et+3]=this.buffer[nt++],this.data[et]=this.buffer[nt++],this.data[et+1]=this.buffer[nt++],this.data[et+2]=this.buffer[nt++],nt}))}writeImage(et){const rt=this.extraBytes+this.width*this.bytesInColor;let nt=0;for(let it=0;it<this.height;it++)for(let at=0;at<this.width;at++){const st=Math.floor(this.pos+(this.height-1-it)*rt+at*this.bytesInColor);nt=et.call(this,st,nt,at,it)}}initColors(et){const rt=[];if(!this.palette.length)throw new Error(`To encode ${et}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);for(let nt=0;nt<this.colors;nt++){const it=createColor(this.palette[nt]);this.writeUInt32LE(it),rt.push(it)}return rt}writeUInt32LE(et){this.data.writeUInt32LE(et,this.pos),this.pos+=4}}function decode$2(tt,et){return new BmpDecoder(tt,et)}function encode$2(tt){return new BmpEncoder(tt)}function _typeof(tt){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(et){return typeof et}:function(et){return et&&typeof Symbol=="function"&&et.constructor===Symbol&&et!==Symbol.prototype?"symbol":typeof et},_typeof(tt)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(tt,et){if(et=et||{},(tt=tt||"")instanceof tinycolor)return tt;if(!(this instanceof tinycolor))return new tinycolor(tt,et);var rt=inputToRGB(tt);this._originalInput=tt,this._r=rt.r,this._g=rt.g,this._b=rt.b,this._a=rt.a,this._roundA=Math.round(100*this._a)/100,this._format=et.format||rt.format,this._gradientType=et.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=rt.ok}function inputToRGB(tt){var et={r:0,g:0,b:0},rt=1,nt=null,it=null,at=null,st=!1,ot=!1;return typeof tt=="string"&&(tt=stringInputToObject(tt)),_typeof(tt)=="object"&&(isValidCSSUnit(tt.r)&&isValidCSSUnit(tt.g)&&isValidCSSUnit(tt.b)?(et=rgbToRgb(tt.r,tt.g,tt.b),st=!0,ot=String(tt.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(tt.h)&&isValidCSSUnit(tt.s)&&isValidCSSUnit(tt.v)?(nt=convertToPercentage(tt.s),it=convertToPercentage(tt.v),et=hsvToRgb(tt.h,nt,it),st=!0,ot="hsv"):isValidCSSUnit(tt.h)&&isValidCSSUnit(tt.s)&&isValidCSSUnit(tt.l)&&(nt=convertToPercentage(tt.s),at=convertToPercentage(tt.l),et=hslToRgb(tt.h,nt,at),st=!0,ot="hsl"),tt.hasOwnProperty("a")&&(rt=tt.a)),rt=boundAlpha(rt),{ok:st,format:tt.format||ot,r:Math.min(255,Math.max(et.r,0)),g:Math.min(255,Math.max(et.g,0)),b:Math.min(255,Math.max(et.b,0)),a:rt}}function rgbToRgb(tt,et,rt){return{r:255*bound01(tt,255),g:255*bound01(et,255),b:255*bound01(rt,255)}}function rgbToHsl(tt,et,rt){tt=bound01(tt,255),et=bound01(et,255),rt=bound01(rt,255);var nt,it,at=Math.max(tt,et,rt),st=Math.min(tt,et,rt),ot=(at+st)/2;if(at==st)nt=it=0;else{var lt=at-st;switch(it=ot>.5?lt/(2-at-st):lt/(at+st),at){case tt:nt=(et-rt)/lt+(et<rt?6:0);break;case et:nt=(rt-tt)/lt+2;break;case rt:nt=(tt-et)/lt+4}nt/=6}return{h:nt,s:it,l:ot}}function hslToRgb(tt,et,rt){var nt,it,at;function st(ht,dt,ut){return ut<0&&(ut+=1),ut>1&&(ut-=1),ut<1/6?ht+6*(dt-ht)*ut:ut<.5?dt:ut<2/3?ht+(dt-ht)*(2/3-ut)*6:ht}if(tt=bound01(tt,360),et=bound01(et,100),rt=bound01(rt,100),et===0)nt=it=at=rt;else{var ot=rt<.5?rt*(1+et):rt+et-rt*et,lt=2*rt-ot;nt=st(lt,ot,tt+1/3),it=st(lt,ot,tt),at=st(lt,ot,tt-1/3)}return{r:255*nt,g:255*it,b:255*at}}function rgbToHsv(tt,et,rt){tt=bound01(tt,255),et=bound01(et,255),rt=bound01(rt,255);var nt,it,at=Math.max(tt,et,rt),st=Math.min(tt,et,rt),ot=at,lt=at-st;if(it=at===0?0:lt/at,at==st)nt=0;else{switch(at){case tt:nt=(et-rt)/lt+(et<rt?6:0);break;case et:nt=(rt-tt)/lt+2;break;case rt:nt=(tt-et)/lt+4}nt/=6}return{h:nt,s:it,v:ot}}function hsvToRgb(tt,et,rt){tt=6*bound01(tt,360),et=bound01(et,100),rt=bound01(rt,100);var nt=Math.floor(tt),it=tt-nt,at=rt*(1-et),st=rt*(1-it*et),ot=rt*(1-(1-it)*et),lt=nt%6;return{r:255*[rt,st,at,at,ot,rt][lt],g:255*[ot,rt,rt,st,at,at][lt],b:255*[at,at,ot,rt,rt,st][lt]}}function rgbToHex(tt,et,rt,nt){var it=[pad2(Math.round(tt).toString(16)),pad2(Math.round(et).toString(16)),pad2(Math.round(rt).toString(16))];return nt&&it[0].charAt(0)==it[0].charAt(1)&&it[1].charAt(0)==it[1].charAt(1)&&it[2].charAt(0)==it[2].charAt(1)?it[0].charAt(0)+it[1].charAt(0)+it[2].charAt(0):it.join("")}function rgbaToHex(tt,et,rt,nt,it){var at=[pad2(Math.round(tt).toString(16)),pad2(Math.round(et).toString(16)),pad2(Math.round(rt).toString(16)),pad2(convertDecimalToHex(nt))];return it&&at[0].charAt(0)==at[0].charAt(1)&&at[1].charAt(0)==at[1].charAt(1)&&at[2].charAt(0)==at[2].charAt(1)&&at[3].charAt(0)==at[3].charAt(1)?at[0].charAt(0)+at[1].charAt(0)+at[2].charAt(0)+at[3].charAt(0):at.join("")}function rgbaToArgbHex(tt,et,rt,nt){return[pad2(convertDecimalToHex(nt)),pad2(Math.round(tt).toString(16)),pad2(Math.round(et).toString(16)),pad2(Math.round(rt).toString(16))].join("")}function _desaturate(tt,et){et=et===0?0:et||10;var rt=tinycolor(tt).toHsl();return rt.s-=et/100,rt.s=clamp01(rt.s),tinycolor(rt)}function _saturate(tt,et){et=et===0?0:et||10;var rt=tinycolor(tt).toHsl();return rt.s+=et/100,rt.s=clamp01(rt.s),tinycolor(rt)}function _greyscale(tt){return tinycolor(tt).desaturate(100)}function _lighten(tt,et){et=et===0?0:et||10;var rt=tinycolor(tt).toHsl();return rt.l+=et/100,rt.l=clamp01(rt.l),tinycolor(rt)}function _brighten(tt,et){et=et===0?0:et||10;var rt=tinycolor(tt).toRgb();return rt.r=Math.max(0,Math.min(255,rt.r-Math.round(-et/100*255))),rt.g=Math.max(0,Math.min(255,rt.g-Math.round(-et/100*255))),rt.b=Math.max(0,Math.min(255,rt.b-Math.round(-et/100*255))),tinycolor(rt)}function _darken(tt,et){et=et===0?0:et||10;var rt=tinycolor(tt).toHsl();return rt.l-=et/100,rt.l=clamp01(rt.l),tinycolor(rt)}function _spin(tt,et){var rt=tinycolor(tt).toHsl(),nt=(rt.h+et)%360;return rt.h=nt<0?360+nt:nt,tinycolor(rt)}function _complement(tt){var et=tinycolor(tt).toHsl();return et.h=(et.h+180)%360,tinycolor(et)}function polyad(tt,et){if(isNaN(et)||et<=0)throw new Error("Argument to polyad must be a positive number");for(var rt=tinycolor(tt).toHsl(),nt=[tinycolor(tt)],it=360/et,at=1;at<et;at++)nt.push(tinycolor({h:(rt.h+at*it)%360,s:rt.s,l:rt.l}));return nt}function _splitcomplement(tt){var et=tinycolor(tt).toHsl(),rt=et.h;return[tinycolor(tt),tinycolor({h:(rt+72)%360,s:et.s,l:et.l}),tinycolor({h:(rt+216)%360,s:et.s,l:et.l})]}function _analogous(tt,et,rt){et=et||6,rt=rt||30;var nt=tinycolor(tt).toHsl(),it=360/rt,at=[tinycolor(tt)];for(nt.h=(nt.h-(it*et>>1)+720)%360;--et;)nt.h=(nt.h+it)%360,at.push(tinycolor(nt));return at}function _monochromatic(tt,et){et=et||6;for(var rt=tinycolor(tt).toHsv(),nt=rt.h,it=rt.s,at=rt.v,st=[],ot=1/et;et--;)st.push(tinycolor({h:nt,s:it,v:at})),at=(at+ot)%1;return st}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var tt=this.toRgb();return(299*tt.r+587*tt.g+114*tt.b)/1e3},getLuminance:function(){var tt,et,rt,nt=this.toRgb();return tt=nt.r/255,et=nt.g/255,rt=nt.b/255,.2126*(tt<=.03928?tt/12.92:Math.pow((tt+.055)/1.055,2.4))+.7152*(et<=.03928?et/12.92:Math.pow((et+.055)/1.055,2.4))+.0722*(rt<=.03928?rt/12.92:Math.pow((rt+.055)/1.055,2.4))},setAlpha:function(tt){return this._a=boundAlpha(tt),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var tt=rgbToHsv(this._r,this._g,this._b);return{h:360*tt.h,s:tt.s,v:tt.v,a:this._a}},toHsvString:function(){var tt=rgbToHsv(this._r,this._g,this._b),et=Math.round(360*tt.h),rt=Math.round(100*tt.s),nt=Math.round(100*tt.v);return this._a==1?"hsv("+et+", "+rt+"%, "+nt+"%)":"hsva("+et+", "+rt+"%, "+nt+"%, "+this._roundA+")"},toHsl:function(){var tt=rgbToHsl(this._r,this._g,this._b);return{h:360*tt.h,s:tt.s,l:tt.l,a:this._a}},toHslString:function(){var tt=rgbToHsl(this._r,this._g,this._b),et=Math.round(360*tt.h),rt=Math.round(100*tt.s),nt=Math.round(100*tt.l);return this._a==1?"hsl("+et+", "+rt+"%, "+nt+"%)":"hsla("+et+", "+rt+"%, "+nt+"%, "+this._roundA+")"},toHex:function(tt){return rgbToHex(this._r,this._g,this._b,tt)},toHexString:function(tt){return"#"+this.toHex(tt)},toHex8:function(tt){return rgbaToHex(this._r,this._g,this._b,this._a,tt)},toHex8String:function(tt){return"#"+this.toHex8(tt)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*bound01(this._r,255))+"%",g:Math.round(100*bound01(this._g,255))+"%",b:Math.round(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%)":"rgba("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(tt){var et="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),rt=et,nt=this._gradientType?"GradientType = 1, ":"";if(tt){var it=tinycolor(tt);rt="#"+rgbaToArgbHex(it._r,it._g,it._b,it._a)}return"progid:DXImageTransform.Microsoft.gradient("+nt+"startColorstr="+et+",endColorstr="+rt+")"},toString:function(tt){var et=!!tt;tt=tt||this._format;var rt=!1,nt=this._a<1&&this._a>=0;return et||!nt||tt!=="hex"&&tt!=="hex6"&&tt!=="hex3"&&tt!=="hex4"&&tt!=="hex8"&&tt!=="name"?(tt==="rgb"&&(rt=this.toRgbString()),tt==="prgb"&&(rt=this.toPercentageRgbString()),tt!=="hex"&&tt!=="hex6"||(rt=this.toHexString()),tt==="hex3"&&(rt=this.toHexString(!0)),tt==="hex4"&&(rt=this.toHex8String(!0)),tt==="hex8"&&(rt=this.toHex8String()),tt==="name"&&(rt=this.toName()),tt==="hsl"&&(rt=this.toHslString()),tt==="hsv"&&(rt=this.toHsvString()),rt||this.toHexString()):tt==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(tt,et){var rt=tt.apply(null,[this].concat([].slice.call(et)));return this._r=rt._r,this._g=rt._g,this._b=rt._b,this.setAlpha(rt._a),this},lighten:function(){return this._applyModification(_lighten,arguments)},brighten:function(){return this._applyModification(_brighten,arguments)},darken:function(){return this._applyModification(_darken,arguments)},desaturate:function(){return this._applyModification(_desaturate,arguments)},saturate:function(){return this._applyModification(_saturate,arguments)},greyscale:function(){return this._applyModification(_greyscale,arguments)},spin:function(){return this._applyModification(_spin,arguments)},_applyCombination:function(tt,et){return tt.apply(null,[this].concat([].slice.call(et)))},analogous:function(){return this._applyCombination(_analogous,arguments)},complement:function(){return this._applyCombination(_complement,arguments)},monochromatic:function(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(_splitcomplement,arguments)},triad:function(){return this._applyCombination(polyad,[3])},tetrad:function(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(tt,et){if(_typeof(tt)=="object"){var rt={};for(var nt in tt)tt.hasOwnProperty(nt)&&(rt[nt]=nt==="a"?tt[nt]:convertToPercentage(tt[nt]));tt=rt}return tinycolor(tt,et)},tinycolor.equals=function(tt,et){return!(!tt||!et)&&tinycolor(tt).toRgbString()==tinycolor(et).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},tinycolor.mix=function(tt,et,rt){rt=rt===0?0:rt||50;var nt=tinycolor(tt).toRgb(),it=tinycolor(et).toRgb(),at=rt/100;return tinycolor({r:(it.r-nt.r)*at+nt.r,g:(it.g-nt.g)*at+nt.g,b:(it.b-nt.b)*at+nt.b,a:(it.a-nt.a)*at+nt.a})},tinycolor.readability=function(tt,et){var rt=tinycolor(tt),nt=tinycolor(et);return(Math.max(rt.getLuminance(),nt.getLuminance())+.05)/(Math.min(rt.getLuminance(),nt.getLuminance())+.05)},tinycolor.isReadable=function(tt,et,rt){var nt,it,at=tinycolor.readability(tt,et);switch(it=!1,(nt=validateWCAG2Parms(rt)).level+nt.size){case"AAsmall":case"AAAlarge":it=at>=4.5;break;case"AAlarge":it=at>=3;break;case"AAAsmall":it=at>=7}return it},tinycolor.mostReadable=function(tt,et,rt){var nt,it,at,st,ot=null,lt=0;it=(rt=rt||{}).includeFallbackColors,at=rt.level,st=rt.size;for(var ht=0;ht<et.length;ht++)(nt=tinycolor.readability(tt,et[ht]))>lt&&(lt=nt,ot=tinycolor(et[ht]));return tinycolor.isReadable(tt,ot,{level:at,size:st})||!it?ot:(rt.includeFallbackColors=!1,tinycolor.mostReadable(tt,["#fff","#000"],rt))};var names$1=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names$1);function flip(tt){var et={};for(var rt in tt)tt.hasOwnProperty(rt)&&(et[tt[rt]]=rt);return et}function boundAlpha(tt){return tt=parseFloat(tt),(isNaN(tt)||tt<0||tt>1)&&(tt=1),tt}function bound01(tt,et){isOnePointZero(tt)&&(tt="100%");var rt=isPercentage(tt);return tt=Math.min(et,Math.max(0,parseFloat(tt))),rt&&(tt=parseInt(tt*et,10)/100),Math.abs(tt-et)<1e-6?1:tt%et/parseFloat(et)}function clamp01(tt){return Math.min(1,Math.max(0,tt))}function parseIntFromHex(tt){return parseInt(tt,16)}function isOnePointZero(tt){return typeof tt=="string"&&tt.indexOf(".")!=-1&&parseFloat(tt)===1}function isPercentage(tt){return typeof tt=="string"&&tt.indexOf("%")!=-1}function pad2(tt){return tt.length==1?"0"+tt:""+tt}function convertToPercentage(tt){return tt<=1&&(tt=100*tt+"%"),tt}function convertDecimalToHex(tt){return Math.round(255*parseFloat(tt)).toString(16)}function convertHexToDecimal(tt){return parseIntFromHex(tt)/255}var matchers=(CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}),CSS_UNIT,PERMISSIVE_MATCH3,PERMISSIVE_MATCH4;function isValidCSSUnit(tt){return!!matchers.CSS_UNIT.exec(tt)}function stringInputToObject(tt){tt=tt.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var et,rt=!1;if(names$1[tt])tt=names$1[tt],rt=!0;else if(tt=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(et=matchers.rgb.exec(tt))?{r:et[1],g:et[2],b:et[3]}:(et=matchers.rgba.exec(tt))?{r:et[1],g:et[2],b:et[3],a:et[4]}:(et=matchers.hsl.exec(tt))?{h:et[1],s:et[2],l:et[3]}:(et=matchers.hsla.exec(tt))?{h:et[1],s:et[2],l:et[3],a:et[4]}:(et=matchers.hsv.exec(tt))?{h:et[1],s:et[2],v:et[3]}:(et=matchers.hsva.exec(tt))?{h:et[1],s:et[2],v:et[3],a:et[4]}:(et=matchers.hex8.exec(tt))?{r:parseIntFromHex(et[1]),g:parseIntFromHex(et[2]),b:parseIntFromHex(et[3]),a:convertHexToDecimal(et[4]),format:rt?"name":"hex8"}:(et=matchers.hex6.exec(tt))?{r:parseIntFromHex(et[1]),g:parseIntFromHex(et[2]),b:parseIntFromHex(et[3]),format:rt?"name":"hex"}:(et=matchers.hex4.exec(tt))?{r:parseIntFromHex(et[1]+""+et[1]),g:parseIntFromHex(et[2]+""+et[2]),b:parseIntFromHex(et[3]+""+et[3]),a:convertHexToDecimal(et[4]+""+et[4]),format:rt?"name":"hex8"}:!!(et=matchers.hex3.exec(tt))&&{r:parseIntFromHex(et[1]+""+et[1]),g:parseIntFromHex(et[2]+""+et[2]),b:parseIntFromHex(et[3]+""+et[3]),format:rt?"name":"hex"}}function validateWCAG2Parms(tt){var et,rt;return(et=((tt=tt||{level:"AA",size:"small"}).level||"AA").toUpperCase())!=="AA"&&et!=="AAA"&&(et="AA"),(rt=(tt.size||"small").toLowerCase())!=="small"&&rt!=="large"&&(rt="small"),{level:et,size:rt}}function clone(tt){const et={width:tt.bitmap.width,height:tt.bitmap.height,data:Buffer$1.from(tt.bitmap.data)};return new tt.constructor(et)}function scan(tt,et,rt,nt,it,at){let st,ot,lt,ht,dt;if(typeof et=="function")dt=et,st=0,ot=0,lt=tt.bitmap.width,ht=tt.bitmap.height;else{if(st=et,typeof rt!="number")throw new Error("y must be a number");if(ot=rt,typeof nt!="number")throw new Error("w must be a number");if(lt=nt,typeof it!="number")throw new Error("h must be a number");if(ht=it,typeof at!="function")throw new Error("cb must be a function");dt=at}st=Math.round(st),ot=Math.round(ot),lt=Math.round(lt),ht=Math.round(ht);const ut=dt.bind(tt);for(let ft=ot;ft<ot+ht;ft++)for(let mt=st;mt<st+lt;mt++)ut(mt,ft,tt.bitmap.width*ft+mt<<2);return tt}function*scanIterator(tt,et,rt,nt,it){et=Math.round(et),rt=Math.round(rt),nt=Math.round(nt),it=Math.round(it);for(let at=rt;at<rt+it;at++)for(let st=et;st<et+nt;st++){const ot=tt.bitmap.width*at+st<<2;yield{x:st,y:at,idx:ot,image:tt}}}function intToRGBA$1(tt){if(typeof tt!="number")throw new Error("i must be a number");const et={r:0,g:0,b:0,a:0};return et.r=Math.floor(tt/Math.pow(256,3)),et.g=Math.floor((tt-et.r*Math.pow(256,3))/Math.pow(256,2)),et.b=Math.floor((tt-et.r*Math.pow(256,3)-et.g*Math.pow(256,2))/Math.pow(256,1)),et.a=Math.floor((tt-et.r*Math.pow(256,3)-et.g*Math.pow(256,2)-et.b*Math.pow(256,1))/Math.pow(256,0)),et}function rgbaToInt(tt,et,rt,nt){if(typeof tt!="number"||typeof et!="number"||typeof rt!="number"||typeof nt!="number")throw new Error("r, g, b and a must be numbers");if(tt<0||tt>255)throw new Error("r must be between 0 and 255");if(et<0||et>255)throw new Error("g must be between 0 and 255");if(rt<0||rt>255)throw new Error("b must be between 0 and 255");let it=255&tt;return it<<=8,it|=255&et,it<<=8,it|=255&rt,it<<=8,it|=255&nt,it>>>=0,it}function colorDiff(tt,et){const rt=st=>Math.pow(st,2),{max:nt}=Math,it="a"in tt?tt.a:255,at="a"in et?et.a:255;return(nt(rt(tt.r-et.r),rt(tt.r-et.r-it+at))+nt(rt(tt.g-et.g),rt(tt.g-et.g-it+at))+nt(rt(tt.b-et.b),rt(tt.b-et.b-it+at)))/195075}function limit255(tt){return tt=Math.max(tt,0),tt=Math.min(tt,255)}function cssColorToHex(tt){return typeof tt=="number"?tt:parseInt(tinycolor(tt).toHex8(),16)}function encode$1(tt,et={}){return scan({bitmap:tt},0,0,tt.width,tt.height,(function(rt,nt,it){const at=tt.data[it+0],st=tt.data[it+1],ot=tt.data[it+2],lt=tt.data[it+3];tt.data[it+0]=lt,tt.data[it+1]=ot,tt.data[it+2]=st,tt.data[it+3]=at})),encode$2({...tt,...et}).data}function decode$1(tt,et){const rt=decode$2(tt,et);return scan({bitmap:rt},0,0,rt.width,rt.height,(function(nt,it,at){const st=rt.data[at+1],ot=rt.data[at+2],lt=rt.data[at+3];rt.data[at+0]=lt,rt.data[at+1]=ot,rt.data[at+2]=st,rt.data[at+3]=255})),rt}function msBmp(){return{mime:"image/x-ms-bmp",encode:encode$1,decode:decode$1}}function bmp(){return{mime:"image/bmp",encode:encode$1,decode:decode$1}}var omggif={},GifReader_1,GifWriter_1;function GifWriter(tt,et,rt,nt){var it=0,at=(nt=nt===void 0?{}:nt).loop===void 0?null:nt.loop,st=nt.palette===void 0?null:nt.palette;if(et<=0||rt<=0||et>65535||rt>65535)throw new Error("Width/Height invalid.");function ot(vt){var xt=vt.length;if(xt<2||xt>256||xt&xt-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return xt}tt[it++]=71,tt[it++]=73,tt[it++]=70,tt[it++]=56,tt[it++]=57,tt[it++]=97;var lt=0,ht=0;if(st!==null){for(var dt=ot(st);dt>>=1;)++lt;if(dt=1<<lt,--lt,nt.background!==void 0){if((ht=nt.background)>=dt)throw new Error("Background index out of range.");if(ht===0)throw new Error("Background index explicitly passed as 0.")}}if(tt[it++]=255&et,tt[it++]=et>>8&255,tt[it++]=255&rt,tt[it++]=rt>>8&255,tt[it++]=(st!==null?128:0)|lt,tt[it++]=ht,tt[it++]=0,st!==null)for(var ut=0,ft=st.length;ut<ft;++ut){var mt=st[ut];tt[it++]=mt>>16&255,tt[it++]=mt>>8&255,tt[it++]=255&mt}if(at!==null){if(at<0||at>65535)throw new Error("Loop count invalid.");tt[it++]=33,tt[it++]=255,tt[it++]=11,tt[it++]=78,tt[it++]=69,tt[it++]=84,tt[it++]=83,tt[it++]=67,tt[it++]=65,tt[it++]=80,tt[it++]=69,tt[it++]=50,tt[it++]=46,tt[it++]=48,tt[it++]=3,tt[it++]=1,tt[it++]=255&at,tt[it++]=at>>8&255,tt[it++]=0}var gt=!1;this.addFrame=function(vt,xt,wt,At,Tt,Pt){if(gt===!0&&(--it,gt=!1),Pt=Pt===void 0?{}:Pt,vt<0||xt<0||vt>65535||xt>65535)throw new Error("x/y invalid.");if(wt<=0||At<=0||wt>65535||At>65535)throw new Error("Width/Height invalid.");if(Tt.length<wt*At)throw new Error("Not enough pixels for the frame size.");var Rt=!0,Ot=Pt.palette;if(Ot==null&&(Rt=!1,Ot=st),Ot==null)throw new Error("Must supply either a local or global palette.");for(var Et=ot(Ot),Lt=0;Et>>=1;)++Lt;Et=1<<Lt;var kt=Pt.delay===void 0?0:Pt.delay,jt=Pt.disposal===void 0?0:Pt.disposal;if(jt<0||jt>3)throw new Error("Disposal out of range.");var Mt=!1,$t=0;if(Pt.transparent!==void 0&&Pt.transparent!==null&&(Mt=!0,($t=Pt.transparent)<0||$t>=Et))throw new Error("Transparent color index.");if((jt!==0||Mt||kt!==0)&&(tt[it++]=33,tt[it++]=249,tt[it++]=4,tt[it++]=jt<<2|(Mt===!0?1:0),tt[it++]=255&kt,tt[it++]=kt>>8&255,tt[it++]=$t,tt[it++]=0),tt[it++]=44,tt[it++]=255&vt,tt[it++]=vt>>8&255,tt[it++]=255&xt,tt[it++]=xt>>8&255,tt[it++]=255&wt,tt[it++]=wt>>8&255,tt[it++]=255&At,tt[it++]=At>>8&255,tt[it++]=Rt===!0?128|Lt-1:0,Rt===!0)for(var Qt=0,Ht=Ot.length;Qt<Ht;++Qt){var qt=Ot[Qt];tt[it++]=qt>>16&255,tt[it++]=qt>>8&255,tt[it++]=255&qt}return it=GifWriterOutputLZWCodeStream(tt,it,Lt<2?2:Lt,Tt)},this.end=function(){return gt===!1&&(tt[it++]=59,gt=!0),it},this.getOutputBuffer=function(){return tt},this.setOutputBuffer=function(vt){tt=vt},this.getOutputBufferPosition=function(){return it},this.setOutputBufferPosition=function(vt){it=vt}}function GifWriterOutputLZWCodeStream(tt,et,rt,nt){tt[et++]=rt;var it=et++,at=1<<rt,st=at-1,ot=at+1,lt=ot+1,ht=rt+1,dt=0,ut=0;function ft(Rt){for(;dt>=Rt;)tt[et++]=255&ut,ut>>=8,dt-=8,et===it+256&&(tt[it]=255,it=et++)}function mt(Rt){ut|=Rt<<dt,dt+=ht,ft(8)}var gt=nt[0]&st,vt={};mt(at);for(var xt=1,wt=nt.length;xt<wt;++xt){var At=nt[xt]&st,Tt=gt<<8|At,Pt=vt[Tt];if(Pt===void 0){for(ut|=gt<<dt,dt+=ht;dt>=8;)tt[et++]=255&ut,ut>>=8,dt-=8,et===it+256&&(tt[it]=255,it=et++);lt===4096?(mt(at),lt=ot+1,ht=rt+1,vt={}):(lt>=1<<ht&&++ht,vt[Tt]=lt++),gt=At}else gt=Pt}return mt(gt),mt(ot),ft(1),it+1===et?tt[it]=0:(tt[it]=et-it-1,tt[et++]=0),et}function GifReader(tt){var et=0;if(tt[et++]!==71||tt[et++]!==73||tt[et++]!==70||tt[et++]!==56||(tt[et++]+1&253)!=56||tt[et++]!==97)throw new Error("Invalid GIF 87a/89a header.");var rt=tt[et++]|tt[et++]<<8,nt=tt[et++]|tt[et++]<<8,it=tt[et++],at=it>>7,st=1<<(7&it)+1;tt[et++],tt[et++];var ot=null,lt=null;at&&(ot=et,lt=st,et+=3*st);var ht=!0,dt=[],ut=0,ft=null,mt=0,gt=null;for(this.width=rt,this.height=nt;ht&&et<tt.length;)switch(tt[et++]){case 33:switch(tt[et++]){case 255:if(tt[et]!==11||tt[et+1]==78&&tt[et+2]==69&&tt[et+3]==84&&tt[et+4]==83&&tt[et+5]==67&&tt[et+6]==65&&tt[et+7]==80&&tt[et+8]==69&&tt[et+9]==50&&tt[et+10]==46&&tt[et+11]==48&&tt[et+12]==3&&tt[et+13]==1&&tt[et+16]==0)et+=14,gt=tt[et++]|tt[et++]<<8,et++;else for(et+=12;;){if(!((Mt=tt[et++])>=0))throw Error("Invalid block size");if(Mt===0)break;et+=Mt}break;case 249:if(tt[et++]!==4||tt[et+4]!==0)throw new Error("Invalid graphics extension block.");var vt=tt[et++];ut=tt[et++]|tt[et++]<<8,ft=tt[et++],1&vt||(ft=null),mt=vt>>2&7,et++;break;case 254:for(;;){if(!((Mt=tt[et++])>=0))throw Error("Invalid block size");if(Mt===0)break;et+=Mt}break;default:throw new Error("Unknown graphic control label: 0x"+tt[et-1].toString(16))}break;case 44:var xt=tt[et++]|tt[et++]<<8,wt=tt[et++]|tt[et++]<<8,At=tt[et++]|tt[et++]<<8,Tt=tt[et++]|tt[et++]<<8,Pt=tt[et++],Rt=Pt>>6&1,Ot=1<<(7&Pt)+1,Et=ot,Lt=lt,kt=!1;Pt>>7&&(kt=!0,Et=et,Lt=Ot,et+=3*Ot);var jt=et;for(et++;;){var Mt;if(!((Mt=tt[et++])>=0))throw Error("Invalid block size");if(Mt===0)break;et+=Mt}dt.push({x:xt,y:wt,width:At,height:Tt,has_local_palette:kt,palette_offset:Et,palette_size:Lt,data_offset:jt,data_length:et-jt,transparent_index:ft,interlaced:!!Rt,delay:ut,disposal:mt});break;case 59:ht=!1;break;default:throw new Error("Unknown gif block: 0x"+tt[et-1].toString(16))}this.numFrames=function(){return dt.length},this.loopCount=function(){return gt},this.frameInfo=function($t){if($t<0||$t>=dt.length)throw new Error("Frame index out of range.");return dt[$t]},this.decodeAndBlitFrameBGRA=function($t,Qt){var Ht=this.frameInfo($t),qt=Ht.width*Ht.height,Bt=new Uint8Array(qt);GifReaderLZWOutputIndexStream(tt,Ht.data_offset,Bt,qt);var Xt=Ht.palette_offset,Ft=Ht.transparent_index;Ft===null&&(Ft=256);var Wt=Ht.width,Yt=rt-Wt,zt=Wt,er=4*(Ht.y*rt+Ht.x),dr=4*((Ht.y+Ht.height)*rt+Ht.x),fr=er,lr=4*Yt;Ht.interlaced===!0&&(lr+=4*rt*7);for(var mr=8,br=0,Sr=Bt.length;br<Sr;++br){var Ir=Bt[br];if(zt===0&&(zt=Wt,(fr+=lr)>=dr&&(lr=4*Yt+4*rt*(mr-1),fr=er+(Wt+Yt)*(mr<<1),mr>>=1)),Ir===Ft)fr+=4;else{var cr=tt[Xt+3*Ir],Nt=tt[Xt+3*Ir+1],pr=tt[Xt+3*Ir+2];Qt[fr++]=pr,Qt[fr++]=Nt,Qt[fr++]=cr,Qt[fr++]=255}--zt}},this.decodeAndBlitFrameRGBA=function($t,Qt){var Ht=this.frameInfo($t),qt=Ht.width*Ht.height,Bt=new Uint8Array(qt);GifReaderLZWOutputIndexStream(tt,Ht.data_offset,Bt,qt);var Xt=Ht.palette_offset,Ft=Ht.transparent_index;Ft===null&&(Ft=256);var Wt=Ht.width,Yt=rt-Wt,zt=Wt,er=4*(Ht.y*rt+Ht.x),dr=4*((Ht.y+Ht.height)*rt+Ht.x),fr=er,lr=4*Yt;Ht.interlaced===!0&&(lr+=4*rt*7);for(var mr=8,br=0,Sr=Bt.length;br<Sr;++br){var Ir=Bt[br];if(zt===0&&(zt=Wt,(fr+=lr)>=dr&&(lr=4*Yt+4*rt*(mr-1),fr=er+(Wt+Yt)*(mr<<1),mr>>=1)),Ir===Ft)fr+=4;else{var cr=tt[Xt+3*Ir],Nt=tt[Xt+3*Ir+1],pr=tt[Xt+3*Ir+2];Qt[fr++]=cr,Qt[fr++]=Nt,Qt[fr++]=pr,Qt[fr++]=255}--zt}}}function GifReaderLZWOutputIndexStream(tt,et,rt,nt){for(var it=tt[et++],at=1<<it,st=at+1,ot=st+1,lt=it+1,ht=(1<<lt)-1,dt=0,ut=0,ft=0,mt=tt[et++],gt=new Int32Array(4096),vt=null;;){for(;dt<16&&mt!==0;)ut|=tt[et++]<<dt,dt+=8,mt===1?mt=tt[et++]:--mt;if(dt<lt)break;var xt=ut&ht;if(ut>>=lt,dt-=lt,xt!==at){if(xt===st)break;for(var wt=xt<ot?xt:vt,At=0,Tt=wt;Tt>at;)Tt=gt[Tt]>>8,++At;var Pt=Tt;if(ft+At+(wt!==xt?1:0)>nt)return void console.log("Warning, gif stream longer than expected.");rt[ft++]=Pt;var Rt=ft+=At;for(wt!==xt&&(rt[ft++]=Pt),Tt=wt;At--;)Tt=gt[Tt],rt[--Rt]=255&Tt,Tt>>=8;vt!==null&&ot<4096&&(gt[ot++]=vt<<8|Pt,ot>=ht+1&&lt<12&&(++lt,ht=ht<<1|1)),vt=xt}else ot=st+1,ht=(1<<(lt=it+1))-1,vt=null}return ft!==nt&&console.log("Warning, gif stream shorter than expected."),rt}try{GifWriter_1=omggif.GifWriter=GifWriter,GifReader_1=omggif.GifReader=GifReader}catch{}let BitmapImage$2=class Id{constructor(...et){if(et.length===0)throw new Error("constructor requires parameters");const rt=et[0];if(rt!==null&&typeof rt=="object")if(rt instanceof Id){const nt=rt.bitmap;this.bitmap={width:nt.width,height:nt.height,data:new Buffer$1(nt.width*nt.height*4)},nt.data.copy(this.bitmap.data)}else{if(!(rt.width&&rt.height&&rt.data))throw new Error("unrecognized constructor parameters");this.bitmap=rt}else{if(typeof rt!="number"||typeof et[1]!="number")throw new Error("unrecognized constructor parameters");{const nt=rt,it=et[1],at=et[2];this.bitmap={width:nt,height:it},Buffer$1.isBuffer(at)?this.bitmap.data=at:(this.bitmap.data=new Buffer$1(nt*it*4),typeof at=="number"&&this.fillRGBA(at))}}}blit(et,rt,nt,it,at,st,ot){if(it+st>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(rt+st>et.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(at+ot>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(nt+ot>et.bitmap.height)throw new Erro("copy exceeds height of target bitmap");const lt=this.bitmap.data,ht=et.bitmap.data,dt=4*this.bitmap.width,ut=4*et.bitmap.width,ft=4*st;let mt=at*dt+4*it,gt=nt*ut+4*rt;for(;--ot>=0;)lt.copy(ht,gt,mt,mt+ft),mt+=dt,gt+=ut;return this}fillRGBA(et){const rt=this.bitmap.data,nt=4*this.bitmap.height;let it=0;for(;it<nt;)rt.writeUInt32BE(et,it),it+=4;for(;it<rt.length;)rt.copy(rt,it,0,nt),it+=nt;return this}getRGBA(et,rt){const nt=4*(rt*this.bitmap.width+et);return this.bitmap.data.readUInt32BE(nt)}getRGBASet(){const et=new Set,rt=this.bitmap.data;for(let nt=0;nt<rt.length;nt+=4)et.add(rt.readUInt32BE(nt,!0));return et}greyscale(){const et=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,((rt,nt,it)=>{const at=Math.round(.299*et[it]+.587*et[it+1]+.114*et[it+2]);et[it]=at,et[it+1]=at,et[it+2]=at})),this}reframe(et,rt,nt,it,at){const st=et<0?0:et,ot=rt<0?0:rt,lt=nt+st>this.bitmap.width?this.bitmap.width-st:nt,ht=it+ot>this.bitmap.height?this.bitmap.height-ot:it,dt=et<0?-et:0,ut=rt<0?-rt:0;let ft;if(at===void 0){if(st!==et||ot!=rt||lt!==nt||ht!==it)throw new GifError("fillRGBA required for this reframing");ft=new Id(nt,it)}else ft=new Id(nt,it,at);return this.blit(ft,dt,ut,st,ot,lt,ht),this.bitmap=ft.bitmap,this}scale(et){if(et===1)return;if(!Number.isInteger(et)||et<1)throw new Error("the scale must be an integer >= 1");const rt=this.bitmap.width,nt=this.bitmap.height,it=rt*et*4,at=this.bitmap.data,st=new Buffer$1(nt*it*et);let ot,lt=0,ht=0;for(let dt=0;dt<nt;++dt){ot=ht;for(let ut=0;ut<rt;++ut){const ft=at.readUInt32BE(lt,!0);for(let mt=0;mt<et;++mt)st.writeUInt32BE(ft,ht),ht+=4;lt+=4}for(let ut=1;ut<et;++ut)st.copy(st,ht,ot,ht),ht+=it,ot+=it}return this.bitmap={width:rt*et,height:nt*et,data:st},this}scanAllCoords(et){const rt=this.bitmap.width,nt=this.bitmap.data.length;let it=0,at=0;for(let st=0;st<nt;st+=4)et(it,at,st),++it===rt&&(it=0,++at)}scanAllIndexes(et){const rt=this.bitmap.data.length;for(let nt=0;nt<rt;nt+=4)et(nt)}};var bitmapimage=BitmapImage$2,gif$1={};let Gif$1=class{constructor(tt,et,rt){this.width=rt.width,this.height=rt.height,this.loops=rt.loops,this.usesTransparency=rt.usesTransparency,this.colorScope=rt.colorScope,this.frames=et,this.buffer=tt}};Gif$1.GlobalColorsPreferred=0,Gif$1.GlobalColorsOnly=1,Gif$1.LocalColorsOnly=2;let GifError$2=class extends Error{constructor(tt){super(tt),tt instanceof Error&&(this.stack="Gif"+tt.stack)}};gif$1.Gif=Gif$1,gif$1.GifError=GifError$2;var gifcodec={},gifutil={},_polyfillNode_fs={},_polyfillNode_fs$1=Object.freeze({__proto__:null,default:_polyfillNode_fs}),require$$0=getAugmentedNamespace(_polyfillNode_fs$1),__defProp$3=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__defNormalProp$3=(tt,et,rt)=>et in tt?__defProp$3(tt,et,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[et]=rt,__markAsModule=tt=>__defProp$3(tt,"__esModule",{value:!0}),__export$1=(tt,et)=>{for(var rt in et)__defProp$3(tt,rt,{get:et[rt],enumerable:!0})},__reExport=(tt,et,rt,nt)=>{if(et&&typeof et=="object"||typeof et=="function")for(let it of __getOwnPropNames(et))!__hasOwnProp.call(tt,it)&&rt&&__defProp$3(tt,it,{get:()=>et[it],enumerable:!(nt=__getOwnPropDesc(et,it))||nt.enumerable});return tt},__toCommonJS=(tt=>(et,rt)=>tt&&tt.get(et)||(rt=__reExport(__markAsModule({}),et,1),tt&&tt.set(et,rt),rt))(typeof WeakMap<"u"?new WeakMap:0),__publicField$3=(tt,et,rt)=>(__defNormalProp$3(tt,typeof et!="symbol"?et+"":et,rt),rt),src_exports={};__export$1(src_exports,{applyPalette:()=>applyPalette,applyPaletteSync:()=>applyPaletteSync$1,buildPalette:()=>buildPalette,buildPaletteSync:()=>buildPaletteSync$1,constants:()=>constants_exports$1,conversion:()=>conversion_exports$1,distance:()=>distance_exports$1,image:()=>image_exports$1,palette:()=>palette_exports$1,quality:()=>quality_exports$1,utils:()=>utils_exports$1});var constants_exports$1={};__export$1(constants_exports$1,{bt709:()=>bt709_exports$1});var bt709_exports$1={};__export$1(bt709_exports$1,{Y:()=>Y$1,x:()=>x$2,y:()=>y$2});var Y$1=(tt=>(tt[tt.RED=.2126]="RED",tt[tt.GREEN=.7152]="GREEN",tt[tt.BLUE=.0722]="BLUE",tt[tt.WHITE=1]="WHITE",tt))(Y$1||{}),x$2=(tt=>(tt[tt.RED=.64]="RED",tt[tt.GREEN=.3]="GREEN",tt[tt.BLUE=.15]="BLUE",tt[tt.WHITE=.3127]="WHITE",tt))(x$2||{}),y$2=(tt=>(tt[tt.RED=.33]="RED",tt[tt.GREEN=.6]="GREEN",tt[tt.BLUE=.06]="BLUE",tt[tt.WHITE=.329]="WHITE",tt))(y$2||{}),conversion_exports$1={};function correctGamma$1(tt){return tt>.04045?((tt+.055)/1.055)**2.4:tt/12.92}function rgb2xyz$1(tt,et,rt){return{x:.4124*(tt=correctGamma$1(tt/255))+.3576*(et=correctGamma$1(et/255))+.1805*(rt=correctGamma$1(rt/255)),y:.2126*tt+.7152*et+.0722*rt,z:.0193*tt+.1192*et+.9505*rt}}__export$1(conversion_exports$1,{lab2rgb:()=>lab2rgb$1,lab2xyz:()=>lab2xyz$1,rgb2hsl:()=>rgb2hsl$1,rgb2lab:()=>rgb2lab$1,rgb2xyz:()=>rgb2xyz$1,xyz2lab:()=>xyz2lab$1,xyz2rgb:()=>xyz2rgb$1});var arithmetic_exports$1={};function degrees2radians$1(tt){return tt*(Math.PI/180)}function max3$1(tt,et,rt){let nt=tt;return nt<et&&(nt=et),nt<rt&&(nt=rt),nt}function min3$1(tt,et,rt){let nt=tt;return nt>et&&(nt=et),nt>rt&&(nt=rt),nt}function intInRange$1(tt,et,rt){return tt>rt&&(tt=rt),tt<et&&(tt=et),0|tt}function inRange0to255Rounded$1(tt){return(tt=Math.round(tt))>255?tt=255:tt<0&&(tt=0),tt}function inRange0to255$1(tt){return tt>255?tt=255:tt<0&&(tt=0),tt}function stableSort$1(tt,et){const rt=typeof tt[0];let nt;if(rt==="number"||rt==="string"){const it=Object.create(null);for(let at=0,st=tt.length;at<st;at++){const ot=tt[at];it[ot]||it[ot]===0||(it[ot]=at)}nt=tt.sort(((at,st)=>et(at,st)||it[at]-it[st]))}else{const it=tt.slice(0);nt=tt.sort(((at,st)=>et(at,st)||it.indexOf(at)-it.indexOf(st)))}return nt}function rgb2hsl$1(tt,et,rt){const nt=min3$1(tt,et,rt),it=max3$1(tt,et,rt),at=it-nt,st=(nt+it)/510;let ot=0;st>0&&st<1&&(ot=at/(st<.5?it+nt:510-it-nt));let lt=0;return at>0&&(lt=it===tt?(et-rt)/at:it===et?2+(rt-tt)/at:4+(tt-et)/at,lt*=60,lt<0&&(lt+=360)),{h:lt,s:ot,l:st}}__export$1(arithmetic_exports$1,{degrees2radians:()=>degrees2radians$1,inRange0to255:()=>inRange0to255$1,inRange0to255Rounded:()=>inRange0to255Rounded$1,intInRange:()=>intInRange$1,max3:()=>max3$1,min3:()=>min3$1,stableSort:()=>stableSort$1});var refX$1=.95047,refY$1=1,refZ$1=1.08883;function pivot$1(tt){return tt>.008856?tt**(1/3):7.787*tt+16/116}function xyz2lab$1(tt,et,rt){if(tt=pivot$1(tt/refX$1),et=pivot$1(et/refY$1),rt=pivot$1(rt/refZ$1),116*et-16<0)throw new Error("xxx");return{L:Math.max(0,116*et-16),a:500*(tt-et),b:200*(et-rt)}}function rgb2lab$1(tt,et,rt){const nt=rgb2xyz$1(tt,et,rt);return xyz2lab$1(nt.x,nt.y,nt.z)}var refX2$1=.95047,refY2$1=1,refZ2$1=1.08883;function pivot2$1(tt){return tt>.206893034?tt**3:(tt-16/116)/7.787}function lab2xyz$1(tt,et,rt){const nt=(tt+16)/116,it=nt-rt/200;return{x:refX2$1*pivot2$1(et/500+nt),y:refY2$1*pivot2$1(nt),z:refZ2$1*pivot2$1(it)}}function correctGamma2$1(tt){return tt>.0031308?1.055*tt**(1/2.4)-.055:12.92*tt}function xyz2rgb$1(tt,et,rt){const nt=correctGamma2$1(3.2406*tt+-1.5372*et+-.4986*rt),it=correctGamma2$1(-.9689*tt+1.8758*et+.0415*rt),at=correctGamma2$1(.0557*tt+-.204*et+1.057*rt);return{r:inRange0to255Rounded$1(255*nt),g:inRange0to255Rounded$1(255*it),b:inRange0to255Rounded$1(255*at)}}function lab2rgb$1(tt,et,rt){const nt=lab2xyz$1(tt,et,rt);return xyz2rgb$1(nt.x,nt.y,nt.z)}var distance_exports$1={};__export$1(distance_exports$1,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator$1,AbstractEuclidean:()=>AbstractEuclidean$1,AbstractManhattan:()=>AbstractManhattan$1,CIE94GraphicArts:()=>CIE94GraphicArts$1,CIE94Textiles:()=>CIE94Textiles$1,CIEDE2000:()=>CIEDE2000$1,CMetric:()=>CMetric$1,Euclidean:()=>Euclidean$1,EuclideanBT709:()=>EuclideanBT709$1,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha$1,Manhattan:()=>Manhattan$1,ManhattanBT709:()=>ManhattanBT709$1,ManhattanNommyde:()=>ManhattanNommyde$1,PNGQuant:()=>PNGQuant$1});var AbstractDistanceCalculator$1=class{constructor(){__publicField$3(this,"_maxDistance"),__publicField$3(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(tt,et,rt,nt){this._whitePoint={r:tt>0?255/tt:0,g:et>0?255/et:0,b:rt>0?255/rt:0,a:nt>0?255/nt:0},this._maxDistance=this.calculateRaw(tt,et,rt,nt,0,0,0,0)}calculateNormalized(tt,et){return this.calculateRaw(tt.r,tt.g,tt.b,tt.a,et.r,et.g,et.b,et.a)/this._maxDistance}},AbstractCIE94$1=class extends AbstractDistanceCalculator$1{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=rgb2lab$1(inRange0to255$1(tt*this._whitePoint.r),inRange0to255$1(et*this._whitePoint.g),inRange0to255$1(rt*this._whitePoint.b)),ht=rgb2lab$1(inRange0to255$1(it*this._whitePoint.r),inRange0to255$1(at*this._whitePoint.g),inRange0to255$1(st*this._whitePoint.b)),dt=lt.L-ht.L,ut=lt.a-ht.a,ft=lt.b-ht.b,mt=Math.sqrt(lt.a*lt.a+lt.b*lt.b),gt=mt-Math.sqrt(ht.a*ht.a+ht.b*ht.b);let vt=ut*ut+ft*ft-gt*gt;vt=vt<0?0:Math.sqrt(vt);const xt=(ot-nt)*this._whitePoint.a*this._kA;return Math.sqrt((dt/this._Kl)**2+(gt/(1+this._K1*mt))**2+(vt/(1+this._K2*mt))**2+xt**2)}},CIE94Textiles$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000$1=class extends AbstractDistanceCalculator$1{_setDefaults(){}static _calculatehp(tt,et){const rt=Math.atan2(tt,et);return rt>=0?rt:rt+_CIEDE2000$1._deg360InRad}static _calculateRT(tt,et){const rt=et**7,nt=2*Math.sqrt(rt/(rt+_CIEDE2000$1._pow25to7)),it=_CIEDE2000$1._deg30InRad*Math.exp(-(((tt-_CIEDE2000$1._deg275InRad)/_CIEDE2000$1._deg25InRad)**2));return-Math.sin(2*it)*nt}static _calculateT(tt){return 1-.17*Math.cos(tt-_CIEDE2000$1._deg30InRad)+.24*Math.cos(2*tt)+.32*Math.cos(3*tt+_CIEDE2000$1._deg6InRad)-.2*Math.cos(4*tt-_CIEDE2000$1._deg63InRad)}static _calculate_ahp(tt,et,rt,nt){const it=rt+nt;return tt===0?it:et<=_CIEDE2000$1._deg180InRad?it/2:it<_CIEDE2000$1._deg360InRad?(it+_CIEDE2000$1._deg360InRad)/2:(it-_CIEDE2000$1._deg360InRad)/2}static _calculate_dHp(tt,et,rt,nt){let it;return it=tt===0?0:et<=_CIEDE2000$1._deg180InRad?rt-nt:rt<=nt?rt-nt+_CIEDE2000$1._deg360InRad:rt-nt-_CIEDE2000$1._deg360InRad,2*Math.sqrt(tt)*Math.sin(it/2)}calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=rgb2lab$1(inRange0to255$1(tt*this._whitePoint.r),inRange0to255$1(et*this._whitePoint.g),inRange0to255$1(rt*this._whitePoint.b)),ht=rgb2lab$1(inRange0to255$1(it*this._whitePoint.r),inRange0to255$1(at*this._whitePoint.g),inRange0to255$1(st*this._whitePoint.b)),dt=(ot-nt)*this._whitePoint.a*_CIEDE2000$1._kA,ut=this.calculateRawInLab(lt,ht);return Math.sqrt(ut+dt*dt)}calculateRawInLab(tt,et){const rt=tt.L,nt=tt.a,it=tt.b,at=et.L,st=et.a,ot=et.b,lt=((Math.sqrt(nt*nt+it*it)+Math.sqrt(st*st+ot*ot))/2)**7,ht=.5*(1-Math.sqrt(lt/(lt+_CIEDE2000$1._pow25to7))),dt=(1+ht)*nt,ut=(1+ht)*st,ft=Math.sqrt(dt*dt+it*it),mt=Math.sqrt(ut*ut+ot*ot),gt=ft*mt,vt=_CIEDE2000$1._calculatehp(it,dt),xt=_CIEDE2000$1._calculatehp(ot,ut),wt=Math.abs(vt-xt),At=at-rt,Tt=mt-ft,Pt=_CIEDE2000$1._calculate_dHp(gt,wt,xt,vt),Rt=_CIEDE2000$1._calculate_ahp(gt,wt,vt,xt),Ot=(ft+mt)/2,Et=((rt+at)/2-50)**2,Lt=Tt/(1+.045*Ot),kt=Pt/(1+.015*_CIEDE2000$1._calculateT(Rt)*Ot);return(At/(1+.015*Et/Math.sqrt(20+Et)))**2+Lt**2+kt**2+_CIEDE2000$1._calculateRT(Rt,Ot)*Lt*kt}},CIEDE2000$1=_CIEDE2000$1;__publicField$3(CIEDE2000$1,"_kA",25/255),__publicField$3(CIEDE2000$1,"_pow25to7",25**7),__publicField$3(CIEDE2000$1,"_deg360InRad",degrees2radians$1(360)),__publicField$3(CIEDE2000$1,"_deg180InRad",degrees2radians$1(180)),__publicField$3(CIEDE2000$1,"_deg30InRad",degrees2radians$1(30)),__publicField$3(CIEDE2000$1,"_deg6InRad",degrees2radians$1(6)),__publicField$3(CIEDE2000$1,"_deg63InRad",degrees2radians$1(63)),__publicField$3(CIEDE2000$1,"_deg275InRad",degrees2radians$1(275)),__publicField$3(CIEDE2000$1,"_deg25InRad",degrees2radians$1(25));var CMetric$1=class extends AbstractDistanceCalculator$1{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=(tt+it)/2*this._whitePoint.r,ht=(tt-it)*this._whitePoint.r,dt=(et-at)*this._whitePoint.g,ut=(rt-st)*this._whitePoint.b,ft=((512+lt)*ht*ht>>8)+4*dt*dt+((767-lt)*ut*ut>>8),mt=(ot-nt)*this._whitePoint.a;return Math.sqrt(ft+mt*mt)}_setDefaults(){}},AbstractEuclidean$1=class extends AbstractDistanceCalculator$1{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=it-tt,ht=at-et,dt=st-rt,ut=ot-nt;return Math.sqrt(this._kR*lt*lt+this._kG*ht*ht+this._kB*dt*dt+this._kA*ut*ut)}},Euclidean$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan$1=class extends AbstractDistanceCalculator$1{calculateRaw(tt,et,rt,nt,it,at,st,ot){let lt=it-tt,ht=at-et,dt=st-rt,ut=ot-nt;return lt<0&&(lt=0-lt),ht<0&&(ht=0-ht),dt<0&&(dt=0-dt),ut<0&&(ut=0-ut),this._kR*lt+this._kG*ht+this._kB*dt+this._kA*ut}},Manhattan$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant$1=class extends AbstractDistanceCalculator$1{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=(ot-nt)*this._whitePoint.a;return this._colordifferenceCh(tt*this._whitePoint.r,it*this._whitePoint.r,lt)+this._colordifferenceCh(et*this._whitePoint.g,at*this._whitePoint.g,lt)+this._colordifferenceCh(rt*this._whitePoint.b,st*this._whitePoint.b,lt)}_colordifferenceCh(tt,et,rt){const nt=tt-et,it=nt+rt;return nt*nt+it*it}_setDefaults(){}},palette_exports$1={};__export$1(palette_exports$1,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer$1,ColorHistogram:()=>ColorHistogram$1,NeuQuant:()=>NeuQuant$1,NeuQuantFloat:()=>NeuQuantFloat$1,RGBQuant:()=>RGBQuant$1,WuColorCube:()=>WuColorCube$1,WuQuant:()=>WuQuant$1});var AbstractPaletteQuantizer$1=class{quantizeSync(){for(const tt of this.quantize())if(tt.palette)return tt.palette;throw new Error("unreachable")}},Point$1=class{constructor(){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),__publicField$3(this,"uint32"),__publicField$3(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(tt){const et=new Point$1;return et.r=0|tt[0],et.g=0|tt[1],et.b=0|tt[2],et.a=0|tt[3],et._loadUINT32(),et._loadQuadruplet(),et}static createByRGBA(tt,et,rt,nt){const it=new Point$1;return it.r=0|tt,it.g=0|et,it.b=0|rt,it.a=0|nt,it._loadUINT32(),it._loadQuadruplet(),it}static createByUint32(tt){const et=new Point$1;return et.uint32=tt>>>0,et._loadRGBA(),et._loadQuadruplet(),et}from(tt){this.r=tt.r,this.g=tt.g,this.b=tt.b,this.a=tt.a,this.uint32=tt.uint32,this.rgba[0]=tt.r,this.rgba[1]=tt.g,this.rgba[2]=tt.b,this.rgba[3]=tt.a}getLuminosity(tt){let et=this.r,rt=this.g,nt=this.b;return tt&&(et=Math.min(255,255-this.a+this.a*et/255),rt=Math.min(255,255-this.a+this.a*rt/255),nt=Math.min(255,255-this.a+this.a*nt/255)),.2126*et+.7152*rt+.0722*nt}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer$1=class{constructor(){__publicField$3(this,"_pointArray"),__publicField$3(this,"_width"),__publicField$3(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(tt){this._width=tt}setHeight(tt){this._height=tt}getPointArray(){return this._pointArray}clone(){const tt=new PointContainer$1;tt._width=this._width,tt._height=this._height;for(let et=0,rt=this._pointArray.length;et<rt;et++)tt._pointArray[et]=Point$1.createByUint32(0|this._pointArray[et].uint32);return tt}toUint32Array(){const tt=this._pointArray.length,et=new Uint32Array(tt);for(let rt=0;rt<tt;rt++)et[rt]=this._pointArray[rt].uint32;return et}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(tt){const et=tt.naturalWidth,rt=tt.naturalHeight,nt=document.createElement("canvas");return nt.width=et,nt.height=rt,nt.getContext("2d").drawImage(tt,0,0,et,rt,0,0,et,rt),PointContainer$1.fromHTMLCanvasElement(nt)}static fromHTMLCanvasElement(tt){const et=tt.width,rt=tt.height,nt=tt.getContext("2d").getImageData(0,0,et,rt);return PointContainer$1.fromImageData(nt)}static fromImageData(tt){const et=tt.width,rt=tt.height;return PointContainer$1.fromUint8Array(tt.data,et,rt)}static fromUint8Array(tt,et,rt){switch(Object.prototype.toString.call(tt)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:tt=new Uint8Array(tt)}const nt=new Uint32Array(tt.buffer);return PointContainer$1.fromUint32Array(nt,et,rt)}static fromUint32Array(tt,et,rt){const nt=new PointContainer$1;nt._width=et,nt._height=rt;for(let it=0,at=tt.length;it<at;it++)nt._pointArray[it]=Point$1.createByUint32(0|tt[it]);return nt}static fromBuffer(tt,et,rt){const nt=new Uint32Array(tt.buffer,tt.byteOffset,tt.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer$1.fromUint32Array(nt,et,rt)}},hueGroups$1=10;function hueGroup$1(tt,et){const rt=360/et;for(let nt=1,it=rt-rt/2;nt<et;nt++,it+=rt)if(tt>=it&&tt<it+rt)return nt;return 0}var Palette$1=class{constructor(){__publicField$3(this,"_pointContainer"),__publicField$3(this,"_pointArray",[]),__publicField$3(this,"_i32idx",{}),this._pointContainer=new PointContainer$1,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(tt){this._pointArray.push(tt),this._pointContainer.setWidth(this._pointArray.length)}has(tt){for(let et=this._pointArray.length-1;et>=0;et--)if(tt.uint32===this._pointArray[et].uint32)return!0;return!1}getNearestColor(tt,et){return this._pointArray[0|this._getNearestIndex(tt,et)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(tt){return typeof this._i32idx[tt]=="number"?this._i32idx[tt]:-1}_getNearestIndex(tt,et){let rt=this._nearestPointFromCache(""+et.uint32);if(rt>=0)return rt;let nt=Number.MAX_VALUE;rt=0;for(let it=0,at=this._pointArray.length;it<at;it++){const st=this._pointArray[it],ot=tt.calculateRaw(et.r,et.g,et.b,et.a,st.r,st.g,st.b,st.a);ot<nt&&(nt=ot,rt=it)}return this._i32idx[et.uint32]=rt,rt}sort(){this._i32idx={},this._pointArray.sort(((tt,et)=>{const rt=rgb2hsl$1(tt.r,tt.g,tt.b),nt=rgb2hsl$1(et.r,et.g,et.b),it=tt.r===tt.g&&tt.g===tt.b?0:1+hueGroup$1(rt.h,hueGroups$1),at=(et.r===et.g&&et.g===et.b?0:1+hueGroup$1(nt.h,hueGroups$1))-it;if(at)return-at;const st=tt.getLuminosity(!0),ot=et.getLuminosity(!0);if(ot-st!=0)return ot-st;const lt=(100*nt.s|0)-(100*rt.s|0);return lt?-lt:0}))}},utils_exports$1={};__export$1(utils_exports$1,{HueStatistics:()=>HueStatistics$1,Palette:()=>Palette$1,Point:()=>Point$1,PointContainer:()=>PointContainer$1,ProgressTracker:()=>ProgressTracker$1,arithmetic:()=>arithmetic_exports$1});var HueGroup$1=class{constructor(){__publicField$3(this,"num",0),__publicField$3(this,"cols",[])}},HueStatistics$1=class{constructor(tt,et){__publicField$3(this,"_numGroups"),__publicField$3(this,"_minCols"),__publicField$3(this,"_stats"),__publicField$3(this,"_groupsFull"),this._numGroups=tt,this._minCols=et,this._stats=[];for(let rt=0;rt<=tt;rt++)this._stats[rt]=new HueGroup$1;this._groupsFull=0}check(tt){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const et=255&tt,rt=tt>>>8&255,nt=tt>>>16&255,it=et===rt&&rt===nt?0:1+hueGroup$1(rgb2hsl$1(et,rt,nt).h,this._numGroups),at=this._stats[it],st=this._minCols;at.num++,at.num>st||(at.num===st&&this._groupsFull++,at.num<=st&&this._stats[it].cols.push(tt))}injectIntoDictionary(tt){for(let et=0;et<=this._numGroups;et++)this._stats[et].num<=this._minCols&&this._stats[et].cols.forEach((rt=>{tt[rt]?tt[rt]++:tt[rt]=1}))}injectIntoArray(tt){for(let et=0;et<=this._numGroups;et++)this._stats[et].num<=this._minCols&&this._stats[et].cols.forEach((rt=>{tt.indexOf(rt)===-1&&tt.push(rt)}))}},_ProgressTracker$1=class{constructor(tt,et){__publicField$3(this,"progress"),__publicField$3(this,"_step"),__publicField$3(this,"_range"),__publicField$3(this,"_last"),__publicField$3(this,"_progressRange"),this._range=tt,this._progressRange=et,this._step=Math.max(1,this._range/(_ProgressTracker$1.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(tt){return tt-this._last>=this._step&&(this._last=tt,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker$1=_ProgressTracker$1;__publicField$3(ProgressTracker$1,"steps",100);var networkBiasShift$1=3,Neuron$1=class{constructor(tt){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=tt}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift$1,this.g>>networkBiasShift$1,this.b>>networkBiasShift$1,this.a>>networkBiasShift$1)}subtract(tt,et,rt,nt){this.r-=0|tt,this.g-=0|et,this.b-=0|rt,this.a-=0|nt}},_NeuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(tt,et=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=tt,this._pointArray=[],this._sampleFactor=1,this._networkSize=et,this._distance.setWhitePoint(255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1)}sample(tt){this._pointArray=this._pointArray.concat(tt.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let tt=0;tt<this._networkSize;tt++)this._network[tt]=new Neuron$1((tt<<networkBiasShift$1+8)/this._networkSize|0),this._freq[tt]=_NeuQuant$1._initialBias/this._networkSize|0,this._bias[tt]=0}*_learn(){let tt=this._sampleFactor;const et=this._pointArray.length;et<_NeuQuant$1._minpicturebytes&&(tt=1);const rt=30+(tt-1)/3|0,nt=et/tt|0;let it,at=nt/_NeuQuant$1._nCycles|0,st=_NeuQuant$1._initAlpha,ot=(this._networkSize>>3)*_NeuQuant$1._radiusBias,lt=ot>>_NeuQuant$1._radiusBiasShift;lt<=1&&(lt=0);for(let dt=0;dt<lt;dt++)this._radPower[dt]=st*((lt*lt-dt*dt)*_NeuQuant$1._radBias/(lt*lt))>>>0;it=et<_NeuQuant$1._minpicturebytes?1:et%_NeuQuant$1._prime1!=0?_NeuQuant$1._prime1:et%_NeuQuant$1._prime2!=0?_NeuQuant$1._prime2:et%_NeuQuant$1._prime3!=0?_NeuQuant$1._prime3:_NeuQuant$1._prime4;const ht=new ProgressTracker$1(nt,99);for(let dt=0,ut=0;dt<nt;){ht.shouldNotify(dt)&&(yield{progress:ht.progress});const ft=this._pointArray[ut],mt=ft.b<<networkBiasShift$1,gt=ft.g<<networkBiasShift$1,vt=ft.r<<networkBiasShift$1,xt=ft.a<<networkBiasShift$1,wt=this._contest(mt,gt,vt,xt);if(this._alterSingle(st,wt,mt,gt,vt,xt),lt!==0&&this._alterNeighbour(lt,wt,mt,gt,vt,xt),ut+=it,ut>=et&&(ut-=et),dt++,at===0&&(at=1),dt%at==0){st-=st/rt|0,ot-=ot/_NeuQuant$1._radiusDecrease|0,lt=ot>>_NeuQuant$1._radiusBiasShift,lt<=1&&(lt=0);for(let At=0;At<lt;At++)this._radPower[At]=st*((lt*lt-At*At)*_NeuQuant$1._radBias/(lt*lt))>>>0}}}_buildPalette(){const tt=new Palette$1;return this._network.forEach((et=>{tt.add(et.toPoint())})),tt.sort(),tt}_alterNeighbour(tt,et,rt,nt,it,at){let st=et-tt;st<-1&&(st=-1);let ot=et+tt;ot>this._networkSize&&(ot=this._networkSize);let lt=et+1,ht=et-1,dt=1;for(;lt<ot||ht>st;){const ut=this._radPower[dt++]/_NeuQuant$1._alphaRadBias;if(lt<ot){const ft=this._network[lt++];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}if(ht>st){const ft=this._network[ht--];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}}}_alterSingle(tt,et,rt,nt,it,at){tt/=_NeuQuant$1._initAlpha;const st=this._network[et];st.subtract(tt*(st.r-it),tt*(st.g-nt),tt*(st.b-rt),tt*(st.a-at))}_contest(tt,et,rt,nt){const it=1020<<networkBiasShift$1;let at=2147483647,st=at,ot=-1,lt=ot;for(let ht=0;ht<this._networkSize;ht++){const dt=this._network[ht],ut=this._distance.calculateNormalized(dt,{r:rt,g:et,b:tt,a:nt})*it|0;ut<at&&(at=ut,ot=ht);const ft=ut-(this._bias[ht]>>_NeuQuant$1._initialBiasShift-networkBiasShift$1);ft<st&&(st=ft,lt=ht);const mt=this._freq[ht]>>_NeuQuant$1._betaShift;this._freq[ht]-=mt,this._bias[ht]+=mt<<_NeuQuant$1._gammaShift}return this._freq[ot]+=_NeuQuant$1._beta,this._bias[ot]-=_NeuQuant$1._betaGamma,lt}},NeuQuant$1=_NeuQuant$1;__publicField$3(NeuQuant$1,"_prime1",499),__publicField$3(NeuQuant$1,"_prime2",491),__publicField$3(NeuQuant$1,"_prime3",487),__publicField$3(NeuQuant$1,"_prime4",503),__publicField$3(NeuQuant$1,"_minpicturebytes",_NeuQuant$1._prime4),__publicField$3(NeuQuant$1,"_nCycles",100),__publicField$3(NeuQuant$1,"_initialBiasShift",16),__publicField$3(NeuQuant$1,"_initialBias",1<<_NeuQuant$1._initialBiasShift),__publicField$3(NeuQuant$1,"_gammaShift",10),__publicField$3(NeuQuant$1,"_betaShift",10),__publicField$3(NeuQuant$1,"_beta",_NeuQuant$1._initialBias>>_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_betaGamma",_NeuQuant$1._initialBias<<_NeuQuant$1._gammaShift-_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_radiusBiasShift",6),__publicField$3(NeuQuant$1,"_radiusBias",1<<_NeuQuant$1._radiusBiasShift),__publicField$3(NeuQuant$1,"_radiusDecrease",30),__publicField$3(NeuQuant$1,"_alphaBiasShift",10),__publicField$3(NeuQuant$1,"_initAlpha",1<<_NeuQuant$1._alphaBiasShift),__publicField$3(NeuQuant$1,"_radBiasShift",8),__publicField$3(NeuQuant$1,"_radBias",1<<_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBiasShift",_NeuQuant$1._alphaBiasShift+_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBias",1<<_NeuQuant$1._alphaRadBiasShift);var networkBiasShift2$1=3,NeuronFloat$1=class{constructor(tt){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=tt}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift2$1,this.g>>networkBiasShift2$1,this.b>>networkBiasShift2$1,this.a>>networkBiasShift2$1)}subtract(tt,et,rt,nt){this.r-=tt,this.g-=et,this.b-=rt,this.a-=nt}},_NeuQuantFloat$1=class extends AbstractPaletteQuantizer$1{constructor(tt,et=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=tt,this._pointArray=[],this._sampleFactor=1,this._networkSize=et,this._distance.setWhitePoint(255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1)}sample(tt){this._pointArray=this._pointArray.concat(tt.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let tt=0;tt<this._networkSize;tt++)this._network[tt]=new NeuronFloat$1((tt<<networkBiasShift2$1+8)/this._networkSize),this._freq[tt]=_NeuQuantFloat$1._initialBias/this._networkSize,this._bias[tt]=0}*_learn(){let tt=this._sampleFactor;const et=this._pointArray.length;et<_NeuQuantFloat$1._minpicturebytes&&(tt=1);const rt=30+(tt-1)/3,nt=et/tt;let it,at=nt/_NeuQuantFloat$1._nCycles|0,st=_NeuQuantFloat$1._initAlpha,ot=(this._networkSize>>3)*_NeuQuantFloat$1._radiusBias,lt=ot>>_NeuQuantFloat$1._radiusBiasShift;lt<=1&&(lt=0);for(let dt=0;dt<lt;dt++)this._radPower[dt]=st*((lt*lt-dt*dt)*_NeuQuantFloat$1._radBias/(lt*lt));it=et<_NeuQuantFloat$1._minpicturebytes?1:et%_NeuQuantFloat$1._prime1!=0?_NeuQuantFloat$1._prime1:et%_NeuQuantFloat$1._prime2!=0?_NeuQuantFloat$1._prime2:et%_NeuQuantFloat$1._prime3!=0?_NeuQuantFloat$1._prime3:_NeuQuantFloat$1._prime4;const ht=new ProgressTracker$1(nt,99);for(let dt=0,ut=0;dt<nt;){ht.shouldNotify(dt)&&(yield{progress:ht.progress});const ft=this._pointArray[ut],mt=ft.b<<networkBiasShift2$1,gt=ft.g<<networkBiasShift2$1,vt=ft.r<<networkBiasShift2$1,xt=ft.a<<networkBiasShift2$1,wt=this._contest(mt,gt,vt,xt);if(this._alterSingle(st,wt,mt,gt,vt,xt),lt!==0&&this._alterNeighbour(lt,wt,mt,gt,vt,xt),ut+=it,ut>=et&&(ut-=et),dt++,at===0&&(at=1),dt%at==0){st-=st/rt,ot-=ot/_NeuQuantFloat$1._radiusDecrease,lt=ot>>_NeuQuantFloat$1._radiusBiasShift,lt<=1&&(lt=0);for(let At=0;At<lt;At++)this._radPower[At]=st*((lt*lt-At*At)*_NeuQuantFloat$1._radBias/(lt*lt))}}}_buildPalette(){const tt=new Palette$1;return this._network.forEach((et=>{tt.add(et.toPoint())})),tt.sort(),tt}_alterNeighbour(tt,et,rt,nt,it,at){let st=et-tt;st<-1&&(st=-1);let ot=et+tt;ot>this._networkSize&&(ot=this._networkSize);let lt=et+1,ht=et-1,dt=1;for(;lt<ot||ht>st;){const ut=this._radPower[dt++]/_NeuQuantFloat$1._alphaRadBias;if(lt<ot){const ft=this._network[lt++];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}if(ht>st){const ft=this._network[ht--];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}}}_alterSingle(tt,et,rt,nt,it,at){tt/=_NeuQuantFloat$1._initAlpha;const st=this._network[et];st.subtract(tt*(st.r-it),tt*(st.g-nt),tt*(st.b-rt),tt*(st.a-at))}_contest(tt,et,rt,nt){const it=1020<<networkBiasShift2$1;let at=2147483647,st=at,ot=-1,lt=ot;for(let ht=0;ht<this._networkSize;ht++){const dt=this._network[ht],ut=this._distance.calculateNormalized(dt,{r:rt,g:et,b:tt,a:nt})*it;ut<at&&(at=ut,ot=ht);const ft=ut-(this._bias[ht]>>_NeuQuantFloat$1._initialBiasShift-networkBiasShift2$1);ft<st&&(st=ft,lt=ht);const mt=this._freq[ht]>>_NeuQuantFloat$1._betaShift;this._freq[ht]-=mt,this._bias[ht]+=mt<<_NeuQuantFloat$1._gammaShift}return this._freq[ot]+=_NeuQuantFloat$1._beta,this._bias[ot]-=_NeuQuantFloat$1._betaGamma,lt}},NeuQuantFloat$1=_NeuQuantFloat$1;__publicField$3(NeuQuantFloat$1,"_prime1",499),__publicField$3(NeuQuantFloat$1,"_prime2",491),__publicField$3(NeuQuantFloat$1,"_prime3",487),__publicField$3(NeuQuantFloat$1,"_prime4",503),__publicField$3(NeuQuantFloat$1,"_minpicturebytes",_NeuQuantFloat$1._prime4),__publicField$3(NeuQuantFloat$1,"_nCycles",100),__publicField$3(NeuQuantFloat$1,"_initialBiasShift",16),__publicField$3(NeuQuantFloat$1,"_initialBias",1<<_NeuQuantFloat$1._initialBiasShift),__publicField$3(NeuQuantFloat$1,"_gammaShift",10),__publicField$3(NeuQuantFloat$1,"_betaShift",10),__publicField$3(NeuQuantFloat$1,"_beta",_NeuQuantFloat$1._initialBias>>_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_betaGamma",_NeuQuantFloat$1._initialBias<<_NeuQuantFloat$1._gammaShift-_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_radiusBiasShift",6),__publicField$3(NeuQuantFloat$1,"_radiusBias",1<<_NeuQuantFloat$1._radiusBiasShift),__publicField$3(NeuQuantFloat$1,"_radiusDecrease",30),__publicField$3(NeuQuantFloat$1,"_alphaBiasShift",10),__publicField$3(NeuQuantFloat$1,"_initAlpha",1<<_NeuQuantFloat$1._alphaBiasShift),__publicField$3(NeuQuantFloat$1,"_radBiasShift",8),__publicField$3(NeuQuantFloat$1,"_radBias",1<<_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBiasShift",_NeuQuantFloat$1._alphaBiasShift+_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBias",1<<_NeuQuantFloat$1._alphaRadBiasShift);var _ColorHistogram$1=class{constructor(tt,et){__publicField$3(this,"_method"),__publicField$3(this,"_hueStats"),__publicField$3(this,"_histogram"),__publicField$3(this,"_initColors"),__publicField$3(this,"_minHueCols"),this._method=tt,this._minHueCols=et<<2,this._initColors=et<<2,this._hueStats=new HueStatistics$1(_ColorHistogram$1._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(tt){switch(this._method){case 1:this._colorStats1D(tt);break;case 2:this._colorStats2D(tt)}}getImportanceSortedColorsIDXI32(){const tt=stableSort$1(Object.keys(this._histogram),((rt,nt)=>this._histogram[nt]-this._histogram[rt]));if(tt.length===0)return[];let et;switch(this._method){case 1:const rt=Math.min(tt.length,this._initColors),nt=tt[rt-1],it=this._histogram[nt];et=tt.slice(0,rt);let at=rt;const st=tt.length;for(;at<st&&this._histogram[tt[at]]===it;)et.push(tt[at++]);this._hueStats.injectIntoArray(et);break;case 2:et=tt;break;default:throw new Error("Incorrect method")}return et.map((rt=>+rt))}_colorStats1D(tt){const et=this._histogram,rt=tt.getPointArray(),nt=rt.length;for(let it=0;it<nt;it++){const at=rt[it].uint32;this._hueStats.check(at),at in et?et[at]++:et[at]=1}}_colorStats2D(tt){const et=tt.getWidth(),rt=tt.getHeight(),nt=tt.getPointArray(),it=_ColorHistogram$1._boxSize[0],at=_ColorHistogram$1._boxSize[1],st=it*at,ot=this._makeBoxes(et,rt,it,at),lt=this._histogram;ot.forEach((ht=>{let dt=Math.round(ht.w*ht.h/st)*_ColorHistogram$1._boxPixels;dt<2&&(dt=2);const ut={};this._iterateBox(ht,et,(ft=>{const mt=nt[ft].uint32;this._hueStats.check(mt),mt in lt?lt[mt]++:mt in ut?++ut[mt]>=dt&&(lt[mt]=ut[mt]):ut[mt]=1}))})),this._hueStats.injectIntoDictionary(lt)}_iterateBox(tt,et,rt){const nt=tt,it=nt.y*et+nt.x,at=(nt.y+nt.h-1)*et+(nt.x+nt.w-1),st=et-nt.w+1;let ot=0,lt=it;do rt.call(this,lt),lt+=++ot%nt.w==0?st:1;while(lt<=at)}_makeBoxes(tt,et,rt,nt){const it=tt%rt,at=et%nt,st=tt-it,ot=et-at,lt=[];for(let ht=0;ht<et;ht+=nt)for(let dt=0;dt<tt;dt+=rt)lt.push({x:dt,y:ht,w:dt===st?it:rt,h:ht===ot?at:nt});return lt}},ColorHistogram$1=_ColorHistogram$1;__publicField$3(ColorHistogram$1,"_boxSize",[64,64]),__publicField$3(ColorHistogram$1,"_boxPixels",2),__publicField$3(ColorHistogram$1,"_hueGroups",10);var RemovedColor$1=class{constructor(tt,et,rt){__publicField$3(this,"index"),__publicField$3(this,"color"),__publicField$3(this,"distance"),this.index=tt,this.color=et,this.distance=rt}},RGBQuant$1=class extends AbstractPaletteQuantizer$1{constructor(tt,et=256,rt=2){super(),__publicField$3(this,"_colors"),__publicField$3(this,"_initialDistance"),__publicField$3(this,"_distanceIncrement"),__publicField$3(this,"_histogram"),__publicField$3(this,"_distance"),this._distance=tt,this._colors=et,this._histogram=new ColorHistogram$1(rt,et),this._initialDistance=.01,this._distanceIncrement=.005}sample(tt){this._histogram.sample(tt)}*quantize(){const tt=this._histogram.getImportanceSortedColorsIDXI32();if(tt.length===0)throw new Error("No colors in image");yield*this._buildPalette(tt)}*_buildPalette(tt){const et=new Palette$1,rt=et.getPointContainer().getPointArray(),nt=new Array(tt.length);for(let dt=0;dt<tt.length;dt++)rt.push(Point$1.createByUint32(tt[dt])),nt[dt]=1;const it=rt.length,at=[];let st=it,ot=this._initialDistance;const lt=new ProgressTracker$1(st-this._colors,99);for(;st>this._colors;){at.length=0;for(let dt=0;dt<it;dt++){if(lt.shouldNotify(it-st)&&(yield{progress:lt.progress}),nt[dt]===0)continue;const ut=rt[dt];for(let ft=dt+1;ft<it;ft++){if(nt[ft]===0)continue;const mt=rt[ft],gt=this._distance.calculateNormalized(ut,mt);gt<ot&&(at.push(new RemovedColor$1(ft,mt,gt)),nt[ft]=0,st--)}}ot+=st>3*this._colors?this._initialDistance:this._distanceIncrement}if(st<this._colors){stableSort$1(at,((ut,ft)=>ft.distance-ut.distance));let dt=0;for(;st<this._colors&&dt<at.length;)nt[at[dt].index]=1,st++,dt++}let ht=rt.length;for(let dt=ht-1;dt>=0;dt--)nt[dt]===0&&(dt!==ht-1&&(rt[dt]=rt[ht-1]),--ht);rt.length=ht,et.sort(),yield{palette:et,progress:100}}};function createArray1D$1(tt){const et=[];for(let rt=0;rt<tt;rt++)et[rt]=0;return et}function createArray4D$1(tt,et,rt,nt){const it=new Array(tt);for(let at=0;at<tt;at++){it[at]=new Array(et);for(let st=0;st<et;st++){it[at][st]=new Array(rt);for(let ot=0;ot<rt;ot++){it[at][st][ot]=new Array(nt);for(let lt=0;lt<nt;lt++)it[at][st][ot][lt]=0}}}return it}function createArray3D$1(tt,et,rt){const nt=new Array(tt);for(let it=0;it<tt;it++){nt[it]=new Array(et);for(let at=0;at<et;at++){nt[it][at]=new Array(rt);for(let st=0;st<rt;st++)nt[it][at][st]=0}}return nt}function fillArray3D$1(tt,et,rt,nt,it){for(let at=0;at<et;at++){tt[at]=[];for(let st=0;st<rt;st++){tt[at][st]=[];for(let ot=0;ot<nt;ot++)tt[at][st][ot]=it}}}function fillArray1D$1(tt,et,rt){for(let nt=0;nt<et;nt++)tt[nt]=rt}var WuColorCube$1=class{constructor(){__publicField$3(this,"redMinimum"),__publicField$3(this,"redMaximum"),__publicField$3(this,"greenMinimum"),__publicField$3(this,"greenMaximum"),__publicField$3(this,"blueMinimum"),__publicField$3(this,"blueMaximum"),__publicField$3(this,"volume"),__publicField$3(this,"alphaMinimum"),__publicField$3(this,"alphaMaximum")}},_WuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(tt,et=256,rt=5){super(),__publicField$3(this,"_reds"),__publicField$3(this,"_greens"),__publicField$3(this,"_blues"),__publicField$3(this,"_alphas"),__publicField$3(this,"_sums"),__publicField$3(this,"_weights"),__publicField$3(this,"_momentsRed"),__publicField$3(this,"_momentsGreen"),__publicField$3(this,"_momentsBlue"),__publicField$3(this,"_momentsAlpha"),__publicField$3(this,"_moments"),__publicField$3(this,"_table"),__publicField$3(this,"_pixels"),__publicField$3(this,"_cubes"),__publicField$3(this,"_colors"),__publicField$3(this,"_significantBitsPerChannel"),__publicField$3(this,"_maxSideIndex"),__publicField$3(this,"_alphaMaxSideIndex"),__publicField$3(this,"_sideSize"),__publicField$3(this,"_alphaSideSize"),__publicField$3(this,"_distance"),this._distance=tt,this._setQuality(rt),this._initialize(et)}sample(tt){const et=tt.getPointArray();for(let rt=0,nt=et.length;rt<nt;rt++)this._addColor(et[rt]);this._pixels=this._pixels.concat(et)}*quantize(){yield*this._preparePalette();const tt=new Palette$1;for(let et=0;et<this._colors;et++)if(this._sums[et]>0){const rt=this._sums[et],nt=this._reds[et]/rt,it=this._greens[et]/rt,at=this._blues[et]/rt,st=this._alphas[et]/rt,ot=Point$1.createByRGBA(0|nt,0|it,0|at,0|st);tt.add(ot)}tt.sort(),yield{palette:tt,progress:100}}*_preparePalette(){yield*this._calculateMoments();let tt=0;const et=createArray1D$1(this._colors);for(let st=1;st<this._colors;++st){this._cut(this._cubes[tt],this._cubes[st])?(et[tt]=this._cubes[tt].volume>1?this._calculateVariance(this._cubes[tt]):0,et[st]=this._cubes[st].volume>1?this._calculateVariance(this._cubes[st]):0):(et[tt]=0,st--),tt=0;let ot=et[0];for(let lt=1;lt<=st;++lt)et[lt]>ot&&(ot=et[lt],tt=lt);if(ot<=0){this._colors=st+1;break}}const rt=[],nt=[],it=[],at=[];for(let st=0;st<this._colors;++st){const ot=_WuQuant$1._volume(this._cubes[st],this._weights);ot>0?(rt[st]=_WuQuant$1._volume(this._cubes[st],this._momentsRed)/ot|0,nt[st]=_WuQuant$1._volume(this._cubes[st],this._momentsGreen)/ot|0,it[st]=_WuQuant$1._volume(this._cubes[st],this._momentsBlue)/ot|0,at[st]=_WuQuant$1._volume(this._cubes[st],this._momentsAlpha)/ot|0):(rt[st]=0,nt[st]=0,it[st]=0,at[st]=0)}this._reds=createArray1D$1(this._colors+1),this._greens=createArray1D$1(this._colors+1),this._blues=createArray1D$1(this._colors+1),this._alphas=createArray1D$1(this._colors+1),this._sums=createArray1D$1(this._colors+1);for(let st=0,ot=this._pixels.length;st<ot;st++){const lt=this._pixels[st];let ht=-1,dt=Number.MAX_VALUE;for(let ut=0;ut<this._colors;ut++){const ft=rt[ut],mt=nt[ut],gt=it[ut],vt=at[ut],xt=this._distance.calculateRaw(ft,mt,gt,vt,lt.r,lt.g,lt.b,lt.a);xt<dt&&(dt=xt,ht=ut)}this._reds[ht]+=lt.r,this._greens[ht]+=lt.g,this._blues[ht]+=lt.b,this._alphas[ht]+=lt.a,this._sums[ht]++}}_addColor(tt){const et=8-this._significantBitsPerChannel,rt=1+(tt.r>>et),nt=1+(tt.g>>et),it=1+(tt.b>>et),at=1+(tt.a>>et);this._weights[at][rt][nt][it]++,this._momentsRed[at][rt][nt][it]+=tt.r,this._momentsGreen[at][rt][nt][it]+=tt.g,this._momentsBlue[at][rt][nt][it]+=tt.b,this._momentsAlpha[at][rt][nt][it]+=tt.a,this._moments[at][rt][nt][it]+=this._table[tt.r]+this._table[tt.g]+this._table[tt.b]+this._table[tt.a]}*_calculateMoments(){const tt=[],et=[],rt=[],nt=[],it=[],at=[],st=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),ot=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),lt=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),ht=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),dt=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),ut=createArray3D$1(this._sideSize,this._sideSize,this._sideSize);let ft=0;const mt=new ProgressTracker$1(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let gt=1;gt<=this._alphaMaxSideIndex;++gt){fillArray3D$1(st,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(ot,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(lt,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(ht,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(dt,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(ut,this._sideSize,this._sideSize,this._sideSize,0);for(let vt=1;vt<=this._maxSideIndex;++vt,++ft){mt.shouldNotify(ft)&&(yield{progress:mt.progress}),fillArray1D$1(tt,this._sideSize,0),fillArray1D$1(et,this._sideSize,0),fillArray1D$1(rt,this._sideSize,0),fillArray1D$1(nt,this._sideSize,0),fillArray1D$1(it,this._sideSize,0),fillArray1D$1(at,this._sideSize,0);for(let xt=1;xt<=this._maxSideIndex;++xt){let wt=0,At=0,Tt=0,Pt=0,Rt=0,Ot=0;for(let Et=1;Et<=this._maxSideIndex;++Et)wt+=this._weights[gt][vt][xt][Et],At+=this._momentsRed[gt][vt][xt][Et],Tt+=this._momentsGreen[gt][vt][xt][Et],Pt+=this._momentsBlue[gt][vt][xt][Et],Rt+=this._momentsAlpha[gt][vt][xt][Et],Ot+=this._moments[gt][vt][xt][Et],tt[Et]+=wt,et[Et]+=At,rt[Et]+=Tt,nt[Et]+=Pt,it[Et]+=Rt,at[Et]+=Ot,st[vt][xt][Et]=st[vt-1][xt][Et]+tt[Et],ot[vt][xt][Et]=ot[vt-1][xt][Et]+et[Et],lt[vt][xt][Et]=lt[vt-1][xt][Et]+rt[Et],ht[vt][xt][Et]=ht[vt-1][xt][Et]+nt[Et],dt[vt][xt][Et]=dt[vt-1][xt][Et]+it[Et],ut[vt][xt][Et]=ut[vt-1][xt][Et]+at[Et],this._weights[gt][vt][xt][Et]=this._weights[gt-1][vt][xt][Et]+st[vt][xt][Et],this._momentsRed[gt][vt][xt][Et]=this._momentsRed[gt-1][vt][xt][Et]+ot[vt][xt][Et],this._momentsGreen[gt][vt][xt][Et]=this._momentsGreen[gt-1][vt][xt][Et]+lt[vt][xt][Et],this._momentsBlue[gt][vt][xt][Et]=this._momentsBlue[gt-1][vt][xt][Et]+ht[vt][xt][Et],this._momentsAlpha[gt][vt][xt][Et]=this._momentsAlpha[gt-1][vt][xt][Et]+dt[vt][xt][Et],this._moments[gt][vt][xt][Et]=this._moments[gt-1][vt][xt][Et]+ut[vt][xt][Et]}}}}static _volumeFloat(tt,et){return et[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]-et[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]-et[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]+et[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-et[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]+et[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]+et[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]-et[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(et[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]-et[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]-et[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+et[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]-et[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+et[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+et[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]-et[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum])}static _volume(tt,et){return 0|_WuQuant$1._volumeFloat(tt,et)}static _top(tt,et,rt,nt){let it;switch(et){case _WuQuant$1._alpha:it=nt[rt][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]-nt[rt][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]-nt[rt][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]+nt[rt][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(nt[rt][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]-nt[rt][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]-nt[rt][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+nt[rt][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);break;case _WuQuant$1._red:it=nt[tt.alphaMaximum][rt][tt.greenMaximum][tt.blueMaximum]-nt[tt.alphaMaximum][rt][tt.greenMinimum][tt.blueMaximum]-nt[tt.alphaMinimum][rt][tt.greenMaximum][tt.blueMaximum]+nt[tt.alphaMinimum][rt][tt.greenMinimum][tt.blueMaximum]-(nt[tt.alphaMaximum][rt][tt.greenMaximum][tt.blueMinimum]-nt[tt.alphaMaximum][rt][tt.greenMinimum][tt.blueMinimum]-nt[tt.alphaMinimum][rt][tt.greenMaximum][tt.blueMinimum]+nt[tt.alphaMinimum][rt][tt.greenMinimum][tt.blueMinimum]);break;case _WuQuant$1._green:it=nt[tt.alphaMaximum][tt.redMaximum][rt][tt.blueMaximum]-nt[tt.alphaMaximum][tt.redMinimum][rt][tt.blueMaximum]-nt[tt.alphaMinimum][tt.redMaximum][rt][tt.blueMaximum]+nt[tt.alphaMinimum][tt.redMinimum][rt][tt.blueMaximum]-(nt[tt.alphaMaximum][tt.redMaximum][rt][tt.blueMinimum]-nt[tt.alphaMaximum][tt.redMinimum][rt][tt.blueMinimum]-nt[tt.alphaMinimum][tt.redMaximum][rt][tt.blueMinimum]+nt[tt.alphaMinimum][tt.redMinimum][rt][tt.blueMinimum]);break;case _WuQuant$1._blue:it=nt[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][rt]-nt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][rt]-nt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][rt]+nt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][rt]-(nt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][rt]-nt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][rt]-nt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][rt]+nt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][rt]);break;default:throw new Error("impossible")}return 0|it}static _bottom(tt,et,rt){switch(et){case _WuQuant$1._alpha:return-rt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(-rt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);case _WuQuant$1._red:return-rt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(-rt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);case _WuQuant$1._green:return-rt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(-rt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);case _WuQuant$1._blue:return-rt[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]-(-rt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);default:return 0}}_calculateVariance(tt){const et=_WuQuant$1._volume(tt,this._momentsRed),rt=_WuQuant$1._volume(tt,this._momentsGreen),nt=_WuQuant$1._volume(tt,this._momentsBlue),it=_WuQuant$1._volume(tt,this._momentsAlpha);return _WuQuant$1._volumeFloat(tt,this._moments)-(et*et+rt*rt+nt*nt+it*it)/_WuQuant$1._volume(tt,this._weights)}_maximize(tt,et,rt,nt,it,at,st,ot,lt){const ht=0|_WuQuant$1._bottom(tt,et,this._momentsRed),dt=0|_WuQuant$1._bottom(tt,et,this._momentsGreen),ut=0|_WuQuant$1._bottom(tt,et,this._momentsBlue),ft=0|_WuQuant$1._bottom(tt,et,this._momentsAlpha),mt=0|_WuQuant$1._bottom(tt,et,this._weights);let gt=0,vt=-1;for(let xt=rt;xt<nt;++xt){let wt=ht+_WuQuant$1._top(tt,et,xt,this._momentsRed),At=dt+_WuQuant$1._top(tt,et,xt,this._momentsGreen),Tt=ut+_WuQuant$1._top(tt,et,xt,this._momentsBlue),Pt=ft+_WuQuant$1._top(tt,et,xt,this._momentsAlpha),Rt=mt+_WuQuant$1._top(tt,et,xt,this._weights);if(Rt!==0){let Ot=wt*wt+At*At+Tt*Tt+Pt*Pt,Et=Ot/Rt;wt=it-wt,At=at-At,Tt=st-Tt,Pt=ot-Pt,Rt=lt-Rt,Rt!==0&&(Ot=wt*wt+At*At+Tt*Tt+Pt*Pt,Et+=Ot/Rt,Et>gt&&(gt=Et,vt=xt))}}return{max:gt,position:vt}}_cut(tt,et){let rt;const nt=_WuQuant$1._volume(tt,this._momentsRed),it=_WuQuant$1._volume(tt,this._momentsGreen),at=_WuQuant$1._volume(tt,this._momentsBlue),st=_WuQuant$1._volume(tt,this._momentsAlpha),ot=_WuQuant$1._volume(tt,this._weights),lt=this._maximize(tt,_WuQuant$1._red,tt.redMinimum+1,tt.redMaximum,nt,it,at,st,ot),ht=this._maximize(tt,_WuQuant$1._green,tt.greenMinimum+1,tt.greenMaximum,nt,it,at,st,ot),dt=this._maximize(tt,_WuQuant$1._blue,tt.blueMinimum+1,tt.blueMaximum,nt,it,at,st,ot),ut=this._maximize(tt,_WuQuant$1._alpha,tt.alphaMinimum+1,tt.alphaMaximum,nt,it,at,st,ot);if(ut.max>=lt.max&&ut.max>=ht.max&&ut.max>=dt.max){if(rt=_WuQuant$1._alpha,ut.position<0)return!1}else rt=lt.max>=ut.max&&lt.max>=ht.max&&lt.max>=dt.max?_WuQuant$1._red:ht.max>=ut.max&&ht.max>=lt.max&&ht.max>=dt.max?_WuQuant$1._green:_WuQuant$1._blue;switch(et.redMaximum=tt.redMaximum,et.greenMaximum=tt.greenMaximum,et.blueMaximum=tt.blueMaximum,et.alphaMaximum=tt.alphaMaximum,rt){case _WuQuant$1._red:et.redMinimum=tt.redMaximum=lt.position,et.greenMinimum=tt.greenMinimum,et.blueMinimum=tt.blueMinimum,et.alphaMinimum=tt.alphaMinimum;break;case _WuQuant$1._green:et.greenMinimum=tt.greenMaximum=ht.position,et.redMinimum=tt.redMinimum,et.blueMinimum=tt.blueMinimum,et.alphaMinimum=tt.alphaMinimum;break;case _WuQuant$1._blue:et.blueMinimum=tt.blueMaximum=dt.position,et.redMinimum=tt.redMinimum,et.greenMinimum=tt.greenMinimum,et.alphaMinimum=tt.alphaMinimum;break;case _WuQuant$1._alpha:et.alphaMinimum=tt.alphaMaximum=ut.position,et.blueMinimum=tt.blueMinimum,et.redMinimum=tt.redMinimum,et.greenMinimum=tt.greenMinimum}return tt.volume=(tt.redMaximum-tt.redMinimum)*(tt.greenMaximum-tt.greenMinimum)*(tt.blueMaximum-tt.blueMinimum)*(tt.alphaMaximum-tt.alphaMinimum),et.volume=(et.redMaximum-et.redMinimum)*(et.greenMaximum-et.greenMinimum)*(et.blueMaximum-et.blueMinimum)*(et.alphaMaximum-et.alphaMinimum),!0}_initialize(tt){this._colors=tt,this._cubes=[];for(let et=0;et<tt;et++)this._cubes[et]=new WuColorCube$1;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let et=0;et<256;++et)this._table[et]=et*et;this._pixels=[]}_setQuality(tt=5){this._significantBitsPerChannel=tt,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant$1=_WuQuant$1;__publicField$3(WuQuant$1,"_alpha",3),__publicField$3(WuQuant$1,"_red",2),__publicField$3(WuQuant$1,"_green",1),__publicField$3(WuQuant$1,"_blue",0);var image_exports$1={};__export$1(image_exports$1,{AbstractImageQuantizer:()=>AbstractImageQuantizer$1,ErrorDiffusionArray:()=>ErrorDiffusionArray$1,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel$1,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma$1,NearestColor:()=>NearestColor$1});var AbstractImageQuantizer$1=class{quantizeSync(tt,et){for(const rt of this.quantize(tt,et))if(rt.pointContainer)return rt.pointContainer;throw new Error("unreachable")}},NearestColor$1=class extends AbstractImageQuantizer$1{constructor(tt){super(),__publicField$3(this,"_distance"),this._distance=tt}*quantize(tt,et){const rt=tt.getPointArray(),nt=tt.getWidth(),it=tt.getHeight(),at=new ProgressTracker$1(it,99);for(let st=0;st<it;st++){at.shouldNotify(st)&&(yield{progress:at.progress});for(let ot=0,lt=st*nt;ot<nt;ot++,lt++){const ht=rt[lt];ht.from(et.getNearestColor(this._distance,ht))}}yield{pointContainer:tt,progress:100}}},ErrorDiffusionArrayKernel$1=(tt=>(tt[tt.FloydSteinberg=0]="FloydSteinberg",tt[tt.FalseFloydSteinberg=1]="FalseFloydSteinberg",tt[tt.Stucki=2]="Stucki",tt[tt.Atkinson=3]="Atkinson",tt[tt.Jarvis=4]="Jarvis",tt[tt.Burkes=5]="Burkes",tt[tt.Sierra=6]="Sierra",tt[tt.TwoSierra=7]="TwoSierra",tt[tt.SierraLite=8]="SierraLite",tt))(ErrorDiffusionArrayKernel$1||{}),ErrorDiffusionArray$1=class extends AbstractImageQuantizer$1{constructor(tt,et,rt=!0,nt=0,it=!1){super(),__publicField$3(this,"_minColorDistance"),__publicField$3(this,"_serpentine"),__publicField$3(this,"_kernel"),__publicField$3(this,"_calculateErrorLikeGIMP"),__publicField$3(this,"_distance"),this._setKernel(et),this._distance=tt,this._minColorDistance=nt,this._serpentine=rt,this._calculateErrorLikeGIMP=it}*quantize(tt,et){const rt=tt.getPointArray(),nt=new Point$1,it=tt.getWidth(),at=tt.getHeight(),st=[];let ot=1,lt=1;for(const dt of this._kernel){const ut=dt[2]+1;lt<ut&&(lt=ut)}for(let dt=0;dt<lt;dt++)this._fillErrorLine(st[dt]=[],it);const ht=new ProgressTracker$1(at,99);for(let dt=0;dt<at;dt++){ht.shouldNotify(dt)&&(yield{progress:ht.progress}),this._serpentine&&(ot*=-1);const ut=dt*it,ft=ot===1?0:it-1,mt=ot===1?it:-1;this._fillErrorLine(st[0],it),st.push(st.shift());const gt=st[0];for(let vt=ft,xt=ut+ft;vt!==mt;vt+=ot,xt+=ot){const wt=rt[xt],At=gt[vt];nt.from(wt);const Tt=Point$1.createByRGBA(inRange0to255Rounded$1(wt.r+At[0]),inRange0to255Rounded$1(wt.g+At[1]),inRange0to255Rounded$1(wt.b+At[2]),inRange0to255Rounded$1(wt.a+At[3])),Pt=et.getNearestColor(this._distance,Tt);if(wt.from(Pt),this._minColorDistance&&this._distance.calculateNormalized(nt,Pt)<this._minColorDistance)continue;let Rt,Ot,Et,Lt;this._calculateErrorLikeGIMP?(Rt=Tt.r-Pt.r,Ot=Tt.g-Pt.g,Et=Tt.b-Pt.b,Lt=Tt.a-Pt.a):(Rt=nt.r-Pt.r,Ot=nt.g-Pt.g,Et=nt.b-Pt.b,Lt=nt.a-Pt.a);const kt=ot===1?0:this._kernel.length-1,jt=ot===1?this._kernel.length:-1;for(let Mt=kt;Mt!==jt;Mt+=ot){const $t=this._kernel[Mt][1]*ot,Qt=this._kernel[Mt][2];if($t+vt>=0&&$t+vt<it&&Qt+dt>=0&&Qt+dt<at){const Ht=this._kernel[Mt][0],qt=st[Qt][$t+vt];qt[0]+=Rt*Ht,qt[1]+=Ot*Ht,qt[2]+=Et*Ht,qt[3]+=Lt*Ht}}}}yield{pointContainer:tt,progress:100}}_fillErrorLine(tt,et){tt.length>et&&(tt.length=et);const rt=tt.length;for(let nt=0;nt<rt;nt++){const it=tt[nt];it[0]=it[1]=it[2]=it[3]=0}for(let nt=rt;nt<et;nt++)tt[nt]=[0,0,0,0]}_setKernel(tt){switch(tt){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${tt}`)}}};function*hilbertCurve$1(tt,et,rt){const nt=Math.max(tt,et),it={width:tt,height:et,level:Math.floor(Math.log(nt)/Math.log(2)+1),callback:rt,tracker:new ProgressTracker$1(tt*et,99),index:0,x:0,y:0};yield*walkHilbert$1(it,1),visit$1(it,0)}function*walkHilbert$1(tt,et){if(!(tt.level<1)){switch(tt.tracker.shouldNotify(tt.index)&&(yield{progress:tt.tracker.progress}),tt.level--,et){case 2:yield*walkHilbert$1(tt,1),visit$1(tt,3),yield*walkHilbert$1(tt,2),visit$1(tt,4),yield*walkHilbert$1(tt,2),visit$1(tt,2),yield*walkHilbert$1(tt,4);break;case 3:yield*walkHilbert$1(tt,4),visit$1(tt,2),yield*walkHilbert$1(tt,3),visit$1(tt,1),yield*walkHilbert$1(tt,3),visit$1(tt,3),yield*walkHilbert$1(tt,1);break;case 1:yield*walkHilbert$1(tt,2),visit$1(tt,4),yield*walkHilbert$1(tt,1),visit$1(tt,3),yield*walkHilbert$1(tt,1),visit$1(tt,1),yield*walkHilbert$1(tt,3);break;case 4:yield*walkHilbert$1(tt,3),visit$1(tt,1),yield*walkHilbert$1(tt,4),visit$1(tt,2),yield*walkHilbert$1(tt,4),visit$1(tt,4),yield*walkHilbert$1(tt,2)}tt.level++}}function visit$1(tt,et){switch(tt.x>=0&&tt.x<tt.width&&tt.y>=0&&tt.y<tt.height&&(tt.callback(tt.x,tt.y),tt.index++),et){case 2:tt.x--;break;case 3:tt.x++;break;case 1:tt.y--;break;case 4:tt.y++}}var ErrorDiffusionRiemersma$1=class extends AbstractImageQuantizer$1{constructor(tt,et=16,rt=1){super(),__publicField$3(this,"_distance"),__publicField$3(this,"_weights"),__publicField$3(this,"_errorQueueSize"),this._distance=tt,this._errorQueueSize=et,this._weights=ErrorDiffusionRiemersma$1._createWeights(rt,et)}*quantize(tt,et){const rt=tt.getPointArray(),nt=tt.getWidth(),it=tt.getHeight(),at=[];let st=0;for(let ot=0;ot<this._errorQueueSize;ot++)at[ot]={r:0,g:0,b:0,a:0};yield*hilbertCurve$1(nt,it,((ot,lt)=>{const ht=rt[ot+lt*nt];let{r:dt,g:ut,b:ft,a:mt}=ht;for(let wt=0;wt<this._errorQueueSize;wt++){const At=this._weights[wt],Tt=at[(wt+st)%this._errorQueueSize];dt+=Tt.r*At,ut+=Tt.g*At,ft+=Tt.b*At,mt+=Tt.a*At}const gt=Point$1.createByRGBA(inRange0to255Rounded$1(dt),inRange0to255Rounded$1(ut),inRange0to255Rounded$1(ft),inRange0to255Rounded$1(mt)),vt=et.getNearestColor(this._distance,gt);st=(st+1)%this._errorQueueSize;const xt=(st+this._errorQueueSize-1)%this._errorQueueSize;at[xt].r=ht.r-vt.r,at[xt].g=ht.g-vt.g,at[xt].b=ht.b-vt.b,at[xt].a=ht.a-vt.a,ht.from(vt)})),yield{pointContainer:tt,progress:100}}static _createWeights(tt,et){const rt=[],nt=Math.exp(Math.log(et)/(et-1));for(let it=0,at=1;it<et;it++)rt[it]=(at+.5|0)/et*tt,at*=nt;return rt}},quality_exports$1={};__export$1(quality_exports$1,{ssim:()=>ssim$1});var K1$1=.01,K2$1=.03;function ssim$1(tt,et){if(tt.getHeight()!==et.getHeight()||tt.getWidth()!==et.getWidth())throw new Error("Images have different sizes!");const rt=(255*K1$1)**2,nt=(255*K2$1)**2;let it=0,at=0;return iterate$1(tt,et,((st,ot,lt,ht)=>{let dt=0,ut=0,ft=0;for(let gt=0;gt<st.length;gt++)ut+=(st[gt]-lt)**2,ft+=(ot[gt]-ht)**2,dt+=(st[gt]-lt)*(ot[gt]-ht);const mt=st.length-1;ut/=mt,ft/=mt,dt/=mt,at+=(2*lt*ht+rt)*(2*dt+nt)/((lt**2+ht**2+rt)*(ut+ft+nt)),it++})),at/it}function iterate$1(tt,et,rt){const nt=tt.getWidth(),it=tt.getHeight();for(let at=0;at<it;at+=8)for(let st=0;st<nt;st+=8){const ot=Math.min(8,nt-st),lt=Math.min(8,it-at),ht=calculateLumaValuesForWindow$1(tt,st,at,ot,lt),dt=calculateLumaValuesForWindow$1(et,st,at,ot,lt);rt(ht,dt,calculateAverageLuma$1(ht),calculateAverageLuma$1(dt))}}function calculateLumaValuesForWindow$1(tt,et,rt,nt,it){const at=tt.getPointArray(),st=[];let ot=0;for(let lt=rt;lt<rt+it;lt++){const ht=lt*tt.getWidth();for(let dt=et;dt<et+nt;dt++){const ut=at[ht+dt];st[ot]=.2126*ut.r+.7152*ut.g+.0722*ut.b,ot++}}return st}function calculateAverageLuma$1(tt){let et=0;for(const rt of tt)et+=rt;return et/tt.length}var setImmediateImpl=typeof setImmediate=="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)=="function"?tt=>process.nextTick(tt):tt=>setTimeout(tt,0);function buildPaletteSync$1(tt,{colorDistanceFormula:et,paletteQuantization:rt,colors:nt}={}){const it=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(et),rt,nt);return tt.forEach((at=>it.sample(at))),it.quantizeSync()}async function buildPalette(tt,{colorDistanceFormula:et,paletteQuantization:rt,colors:nt,onProgress:it}={}){return new Promise(((at,st)=>{const ot=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(et),rt,nt);let lt;tt.forEach((ut=>ot.sample(ut)));const ht=ot.quantize(),dt=()=>{try{const ut=ht.next();ut.done?at(lt):(ut.value.palette&&(lt=ut.value.palette),it&&it(ut.value.progress),setImmediateImpl(dt))}catch(ut){st(ut)}};setImmediateImpl(dt)}))}function applyPaletteSync$1(tt,et,{colorDistanceFormula:rt,imageQuantization:nt}={}){return imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(rt),nt).quantizeSync(tt,et)}async function applyPalette(tt,et,{colorDistanceFormula:rt,imageQuantization:nt,onProgress:it}={}){return new Promise(((at,st)=>{let ot;const lt=imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(rt),nt).quantize(tt,et),ht=()=>{try{const dt=lt.next();dt.done?at(ot):(dt.value.pointContainer&&(ot=dt.value.pointContainer),it&&it(dt.value.progress),setImmediateImpl(ht))}catch(dt){st(dt)}};setImmediateImpl(ht)}))}function colorDistanceFormulaToColorDistance$1(tt="euclidean-bt709"){switch(tt){case"cie94-graphic-arts":return new CIE94GraphicArts$1;case"cie94-textiles":return new CIE94Textiles$1;case"ciede2000":return new CIEDE2000$1;case"color-metric":return new CMetric$1;case"euclidean":return new Euclidean$1;case"euclidean-bt709":return new EuclideanBT709$1;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha$1;case"manhattan":return new Manhattan$1;case"manhattan-bt709":return new ManhattanBT709$1;case"manhattan-nommyde":return new ManhattanNommyde$1;case"pngquant":return new PNGQuant$1;default:throw new Error(`Unknown colorDistanceFormula ${tt}`)}}function imageQuantizationToImageQuantizer$1(tt,et="floyd-steinberg"){switch(et){case"nearest":return new NearestColor$1(tt);case"riemersma":return new ErrorDiffusionRiemersma$1(tt);case"floyd-steinberg":return new ErrorDiffusionArray$1(tt,0);case"false-floyd-steinberg":return new ErrorDiffusionArray$1(tt,1);case"stucki":return new ErrorDiffusionArray$1(tt,2);case"atkinson":return new ErrorDiffusionArray$1(tt,3);case"jarvis":return new ErrorDiffusionArray$1(tt,4);case"burkes":return new ErrorDiffusionArray$1(tt,5);case"sierra":return new ErrorDiffusionArray$1(tt,6);case"two-sierra":return new ErrorDiffusionArray$1(tt,7);case"sierra-lite":return new ErrorDiffusionArray$1(tt,8);default:throw new Error(`Unknown imageQuantization ${et}`)}}function paletteQuantizationToPaletteQuantizer$1(tt,et="wuquant",rt=256){switch(et){case"neuquant":return new NeuQuant$1(tt,rt);case"rgbquant":return new RGBQuant$1(tt,rt);case"wuquant":return new WuQuant$1(tt,rt);case"neuquant-float":return new NeuQuantFloat$1(tt,rt);default:throw new Error(`Unknown paletteQuantization ${et}`)}}var imageQ=__toCommonJS(src_exports),gifframe={};const BitmapImage$1=bitmapimage;let GifFrame$1=class gf extends BitmapImage$1{constructor(...et){if(super(...et),et[0]instanceof gf){const rt=et[0];this.xOffset=rt.xOffset,this.yOffset=rt.yOffset,this.disposalMethod=rt.disposalMethod,this.delayCentisecs=rt.delayCentisecs,this.interlaced=rt.interlaced}else{const rt=et[et.length-1];let nt={};typeof rt!="object"||rt instanceof BitmapImage$1||(nt=rt),this.xOffset=nt.xOffset||0,this.yOffset=nt.yOffset||0,this.disposalMethod=nt.disposalMethod!==void 0?nt.disposalMethod:gf.DisposeToBackgroundColor,this.delayCentisecs=nt.delayCentisecs||8,this.interlaced=nt.interlaced||!1}}getPalette(){const et=new Set,rt=this.bitmap.data;let nt=0,it=!1;for(;nt<rt.length;){if(rt[nt+3]===0)it=!0;else{const lt=rt.readUInt32BE(nt,!0)>>8&16777215;et.add(lt)}nt+=4}const at=new Array(et.size),st=et.values();for(nt=0;nt<at.length;++nt)at[nt]=st.next().value;at.sort(((lt,ht)=>lt-ht));let ot=at.length;return it&&++ot,{colors:at,usesTransparency:it,indexCount:ot}}};var hasRequiredGifutil,hasRequiredGifcodec;function requireGifutil(){return hasRequiredGifutil||(hasRequiredGifutil=1,(function(tt){const et=require$$0,rt=imageQ,nt=bitmapimage,{GifFrame:it}=gifframe,{GifError:at}=gif$1,{GifCodec:st}=requireGifcodec(),ot=[".jpg",".jpeg",".png",".bmp"],lt=new st;function ht(dt,ut,ft,mt,gt){const vt=Array.isArray(dt)?dt:[dt];if(gt){if(["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"].indexOf(gt.ditherAlgorithm)<0)throw new Error(`Invalid ditherAlgorithm '${gt.ditherAlgorithm}'`);gt.serpentine===void 0&&(gt.serpentine=!0),gt.minimumColorDistanceToDither===void 0&&(gt.minimumColorDistanceToDither=0),gt.calculateErrorLikeGIMP===void 0&&(gt.calculateErrorLikeGIMP=!1)}const xt=new rt.distance.Euclidean,wt=new rt.palette[ut](xt,ft,mt);let At;At=gt?new rt.image.ErrorDiffusionArray(xt,rt.image.ErrorDiffusionArrayKernel[gt.ditherAlgorithm],gt.serpentine,gt.minimumColorDistanceToDither,gt.calculateErrorLikeGIMP):new rt.image.NearestColor(xt);const Tt=[];vt.forEach((Rt=>{const Ot=Rt.bitmap.data,Et=new ArrayBuffer(Ot.length),Lt=new Uint32Array(Et);for(let jt=0,Mt=0;jt<Ot.length;jt+=4,++Mt)Lt[Mt]=Ot.readUInt32LE(jt,!0);const kt=rt.utils.PointContainer.fromUint32Array(Lt,Rt.bitmap.width,Rt.bitmap.height);wt.sample(kt),Tt.push(kt)}));const Pt=wt.quantizeSync();for(let Rt=0;Rt<vt.length;++Rt){const Ot=vt[Rt].bitmap.data,Et=At.quantizeSync(Tt[Rt],Pt).toUint32Array();for(let Lt=0,kt=0;Lt<Ot.length;Lt+=4,++kt)Ot.writeUInt32LE(Et[kt],Lt)}}tt.cloneFrames=function(dt){let ut=[];return dt.forEach((ft=>{ut.push(new it(ft))})),ut},tt.getColorInfo=function(dt,ut){let ft=!1;const mt=[];for(let At=0;At<dt.length;++At){let Tt=dt[At].getPalette();if(Tt.usesTransparency&&(ft=!0),Tt.indexCount>256)throw new at(`Frame ${At} uses more than 256 color indexes`);mt.push(Tt)}if(ut===0)return{usesTransparency:ft,palettes:mt};const gt=new Set;mt.forEach((At=>{At.colors.forEach((Tt=>{gt.add(Tt)}))}));let vt=gt.size;if(ft&&++vt,ut&&vt>ut)return{usesTransparency:ft,palettes:mt};const xt=new Array(gt.size),wt=gt.values();for(let At=0;At<xt.length;++At)xt[At]=wt.next().value;return xt.sort(((At,Tt)=>At-Tt)),{colors:xt,indexCount:vt,usesTransparency:ft,palettes:mt}},tt.copyAsJimp=function(dt,ut){return tt.shareAsJimp(dt,new nt(ut))},tt.getMaxDimensions=function(dt){let ut=0,ft=0;return dt.forEach((mt=>{const gt=mt.xOffset+mt.bitmap.width;gt>ut&&(ut=gt);const vt=mt.yOffset+mt.bitmap.height;vt>ft&&(ft=vt)})),{maxWidth:ut,maxHeight:ft}},tt.quantizeDekker=function(dt,ut,ft){ht(dt,"NeuQuantFloat",ut=ut||256,0,ft)},tt.quantizeSorokin=function(dt,ut,ft,mt){let gt;switch(ut=ut||256,ft=ft||"min-pop"){case"min-pop":gt=2;break;case"top-pop":gt=1;break;default:throw new Error(`Invalid quantizeSorokin histogram '${ft}'`)}ht(dt,"RGBQuant",ut,gt,mt)},tt.quantizeWu=function(dt,ut,ft,mt){if(ut=ut||256,(ft=ft||5)<1||ft>8)throw new Error("Invalid quantization quality");ht(dt,"WuQuant",ut,ft,mt)},tt.read=function(dt,ut){return ut=ut||lt,Buffer$1.isBuffer(dt)?ut.decodeGif(dt):(function(ft){return new Promise(((mt,gt)=>{et.readFile(ft,((vt,xt)=>vt?gt(vt):mt(xt)))}))})(dt).then((ft=>ut.decodeGif(ft)))},tt.shareAsJimp=function(dt,ut){const ft=new dt(ut.bitmap.width,ut.bitmap.height,0);return ft.bitmap.data=ut.bitmap.data,ft},tt.write=function(dt,ut,ft,mt){mt=mt||lt;const gt=dt.match(/\.[a-zA-Z]+$/);if(gt!==null&&ot.includes(gt[0].toLowerCase()))throw new Error(`GIF '${dt}' has an unexpected suffix`);return mt.encodeGif(ut,ft).then((vt=>(function(xt,wt){return new Promise(((At,Tt)=>{et.writeFile(xt,wt,(Pt=>Pt?Tt(Pt):At()))}))})(dt,vt.buffer).then((()=>vt))))}})(gifutil)),gifutil}function requireGifcodec(){if(hasRequiredGifcodec)return gifcodec;hasRequiredGifcodec=1;const tt=omggif,{Gif:et,GifError:rt}=gif$1;function nt(){const ut=requireGifutil();return nt=function(){return ut},ut}const{GifFrame:it}=gifframe;function at(ut,ft){const mt=ut.indexOf(ft);return mt===-1?null:mt}function st(ut,ft){for(var mt,gt=0,vt=ut.length-1;gt<=vt;)if(ut[mt=Math.floor((gt+vt)/2)]>ft)vt=mt-1;else{if(!(ut[mt]<ft))return mt;gt=mt+1}return null}function ot(ut){const ft=ut.colors;ut.usesTransparency&&ft.push(0);const mt=ft.length;let gt=2;for(;mt>gt;)gt<<=1;ft.length=gt,ft.fill(0,mt)}function lt(ut,ft){let mt=ut.bitmap.width*ut.bitmap.height;return mt=Math.ceil(mt*ft/8),mt+=Math.ceil(mt/255),100+mt+768}function ht(ut){let ft=ut.indexCount,mt=0;for(--ft;ft;)++mt,ft>>=1;return mt>0?mt:1}function dt(ut,ft,mt,gt,vt){if(mt.interlaced)throw new rt("writing interlaced GIFs is not supported");const xt=(function(At,Tt,Pt){const Rt=Pt.colors,Ot=Rt.length<=8?at:st,Et=Tt.bitmap.data,Lt=new Buffer$1(Et.length/4);let kt=Rt.length,jt=0,Mt=0;for(;jt<Et.length;){if(Et[jt+3]!==0){const $t=Et.readUInt32BE(jt,!0)>>8&16777215;Lt[Mt]=Ot(Rt,$t)}else Lt[Mt]=kt;jt+=4,++Mt}if(Pt.usesTransparency){if(kt===256)throw new rt(`Frame ${At} already has 256 colorsand so can't use transparency`)}else kt=null;return{buffer:Lt,transparentIndex:kt}})(ft,mt,gt),wt={delay:mt.delayCentisecs,disposal:mt.disposalMethod,transparent:xt.transparentIndex};vt&&(ot(gt),wt.palette=gt.colors);try{let At,Tt=ut.getOutputBuffer(),Pt=ut.getOutputBufferPosition(),Rt=!0;for(;Rt;)if(At=ut.addFrame(mt.xOffset,mt.yOffset,mt.bitmap.width,mt.bitmap.height,xt.buffer,wt),Rt=!1,At>=Tt.length-1){const Ot=new Buffer$1(1.5*Tt.length);Tt.copy(Ot),ut.setOutputBuffer(Ot),ut.setOutputBufferPosition(Pt),Tt=Ot,Rt=!0}return Tt}catch(At){throw new rt(At)}}return gifcodec.GifCodec=class{constructor(ut={}){this._transparentRGB=null,typeof ut.transparentRGB=="number"&&ut.transparentRGB!==0&&(this._transparentRGBA=256*ut.transparentRGB),this._testInitialBufferSize=0}decodeGif(ut){try{let ft;try{ft=new tt.GifReader(ut)}catch(xt){throw new rt(xt)}const mt=ft.numFrames(),gt=[],vt={width:ft.width,height:ft.height,loops:ft.loopCount(),usesTransparency:!1};for(let xt=0;xt<mt;++xt){const wt=this._decodeFrame(ft,xt,vt.usesTransparency);gt.push(wt.frame),wt.usesTransparency&&(vt.usesTransparency=!0)}return Promise.resolve(new et(ut,gt,vt))}catch(ft){return Promise.reject(ft)}}encodeGif(ut,ft={}){try{if(ut===null||ut.length===0)throw new rt("there are no frames");const mt=nt().getMaxDimensions(ut);return(ft=Object.assign({},ft)).width=mt.maxWidth,ft.height=mt.maxHeight,ft.loops===void 0&&(ft.loops=0),ft.colorScope=ft.colorScope||et.GlobalColorsPreferred,Promise.resolve(this._encodeGif(ut,ft))}catch(mt){return Promise.reject(mt)}}_decodeFrame(ut,ft,mt){let gt,vt;try{if(gt=ut.frameInfo(ft),vt=new Buffer$1(ut.width*ut.height*4),ut.decodeAndBlitFrameRGBA(ft,vt),gt.width!==ut.width||gt.height!==ut.height){if(gt.y&&(vt=vt.slice(gt.y*ut.width*4)),ut.width>gt.width)for(let wt=0;wt<gt.height;++wt)vt.copy(vt,wt*gt.width*4,4*(gt.x+wt*ut.width),4*(gt.x+wt*ut.width)+4*gt.width);vt=vt.slice(0,gt.width*gt.height*4)}}catch(wt){throw new rt(wt)}let xt=!1;if(this._transparentRGBA===null){if(!mt)for(let wt=3;wt<vt.length;wt+=4)vt[wt]===0&&(xt=!0,wt=vt.length)}else for(let wt=3;wt<vt.length;wt+=4)vt[wt]===0&&(vt.writeUInt32BE(this._transparentRGBA,wt-3),xt=!0);return{frame:new it(gt.width,gt.height,vt,{xOffset:gt.x,yOffset:gt.y,disposalMethod:gt.disposal,interlaced:gt.interlaced,delayCentisecs:gt.delay}),usesTransparency:xt}}_encodeGif(ut,ft){let mt;if(ft.colorScope===et.LocalColorsOnly)mt=nt().getColorInfo(ut,0);else if(mt=nt().getColorInfo(ut,256),!mt.colors){if(ft.colorScope===et.GlobalColorsOnly)throw new rt("Too many color indexes for global color table");ft.colorScope=et.LocalColorsOnly}ft.usesTransparency=mt.usesTransparency;const gt=mt.palettes;return ft.colorScope===et.LocalColorsOnly?(function(vt,xt,wt,At){const Tt={loop:xt.loops};let Pt,Rt=new Buffer$1(wt);try{Pt=new tt.GifWriter(Rt,xt.width,xt.height,Tt)}catch(Ot){throw new rt(Ot)}for(let Ot=0;Ot<vt.length;++Ot)Rt=dt(Pt,Ot,vt[Ot],At[Ot],!0);return new et(Rt.slice(0,Pt.end()),vt,xt)})(ut,ft,2e3,gt):(function(vt,xt,wt,At){const Tt={colors:At.colors.slice(),usesTransparency:At.usesTransparency};ot(Tt);const Pt={palette:Tt.colors,loop:xt.loops};let Rt,Ot=new Buffer$1(wt);try{Rt=new tt.GifWriter(Ot,xt.width,xt.height,Pt)}catch(Et){throw new rt(Et)}for(let Et=0;Et<vt.length;++Et)Ot=dt(Rt,Et,vt[Et],At,!1);return new et(Ot.slice(0,Rt.end()),vt,xt)})(ut,ft,2e3,mt)}_getSizeEstimateGlobal(ut,ft){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let mt=968;const gt=ht(ut);return ft.forEach((vt=>{mt+=lt(vt,gt)})),mt}_getSizeEstimateLocal(ut,ft){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let mt=200;for(let gt=0;gt<ft.length;++gt){const vt=ht(ut[gt]);mt+=lt(ft[gt],vt)}return mt}},gifcodec}GifFrame$1.DisposeToAnything=0,GifFrame$1.DisposeNothing=1,GifFrame$1.DisposeToBackgroundColor=2,GifFrame$1.DisposeToPrevious=3,gifframe.GifFrame=GifFrame$1;const BitmapImage=bitmapimage,{GifCodec}=requireGifcodec(),{GifFrame}=gifframe,GifUtil=requireGifutil();var src={BitmapImage,GifCodec,GifFrame,GifUtil};function gif(){return{mime:"image/gif",encode:async tt=>{const et=new src.BitmapImage(tt);src.GifUtil.quantizeDekker(et,256);const rt=new src.GifFrame(tt);return(await new src.GifCodec().encodeGif([rt],{})).buffer},decode:tt=>{const et=new omggif.GifReader(tt),rt=Buffer$1.alloc(et.width*et.height*4);return et.decodeAndBlitFrameRGBA(0,rt),{data:rt,width:et.width,height:et.height}}}}var encoder={exports:{}};(function(tt){function et(rt){var nt,it,at,st,ot,lt=Math.floor,ht=new Array(64),dt=new Array(64),ut=new Array(64),ft=new Array(64),mt=new Array(65535),gt=new Array(65535),vt=new Array(64),xt=new Array(64),wt=[],At=0,Tt=7,Pt=new Array(64),Rt=new Array(64),Ot=new Array(64),Et=new Array(256),Lt=new Array(2048),kt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],jt=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Mt=[0,1,2,3,4,5,6,7,8,9,10,11],$t=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Qt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Ht=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],qt=[0,1,2,3,4,5,6,7,8,9,10,11],Bt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Xt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Ft(fr,lr){for(var mr=0,br=0,Sr=new Array,Ir=1;Ir<=16;Ir++){for(var cr=1;cr<=fr[Ir];cr++)Sr[lr[br]]=[],Sr[lr[br]][0]=mr,Sr[lr[br]][1]=Ir,br++,mr++;mr*=2}return Sr}function Wt(fr){for(var lr=fr[0],mr=fr[1]-1;mr>=0;)lr&1<<mr&&(At|=1<<Tt),mr--,--Tt<0&&(At==255?(Yt(255),Yt(0)):Yt(At),Tt=7,At=0)}function Yt(fr){wt.push(fr)}function zt(fr){Yt(fr>>8&255),Yt(255&fr)}function er(fr,lr,mr,br,Sr){for(var Ir,cr=Sr[0],Nt=Sr[240],pr=(function(hr,kr){var Br,Gn,Xn,Mn,Kn,Vn,vi,mi,_i,Ri,pi=0;for(_i=0;_i<8;++_i){Br=hr[pi],Gn=hr[pi+1],Xn=hr[pi+2],Mn=hr[pi+3],Kn=hr[pi+4],Vn=hr[pi+5],vi=hr[pi+6];var Tr=Br+(mi=hr[pi+7]),qn=Br-mi,_r=Gn+vi,Rr=Gn-vi,yr=Xn+Vn,Kr=Xn-Vn,Jr=Mn+Kn,Zt=Mn-Kn,Qr=Tr+Jr,Dr=Tr-Jr,Pr=_r+yr,Hr=_r-yr;hr[pi]=Qr+Pr,hr[pi+4]=Qr-Pr;var qr=.707106781*(Hr+Dr);hr[pi+2]=Dr+qr,hr[pi+6]=Dr-qr;var bi=.382683433*((Qr=Zt+Kr)-(Hr=Rr+qn)),ri=.5411961*Qr+bi,yi=1.306562965*Hr+bi,Li=.707106781*(Pr=Kr+Rr),xa=qn+Li,Ti=qn-Li;hr[pi+5]=Ti+ri,hr[pi+3]=Ti-ri,hr[pi+1]=xa+yi,hr[pi+7]=xa-yi,pi+=8}for(pi=0,_i=0;_i<8;++_i){Br=hr[pi],Gn=hr[pi+8],Xn=hr[pi+16],Mn=hr[pi+24],Kn=hr[pi+32],Vn=hr[pi+40],vi=hr[pi+48];var $i=Br+(mi=hr[pi+56]),Ji=Br-mi,ea=Gn+vi,Na=Gn-vi,Oa=Xn+Vn,la=Xn-Vn,ua=Mn+Kn,ka=Mn-Kn,Xi=$i+ua,ca=$i-ua,_a=ea+Oa,Ua=ea-Oa;hr[pi]=Xi+_a,hr[pi+32]=Xi-_a;var Es=.707106781*(Ua+ca);hr[pi+16]=ca+Es,hr[pi+48]=ca-Es;var is=.382683433*((Xi=ka+la)-(Ua=Na+Ji)),zo=.5411961*Xi+is,Xs=1.306562965*Ua+is,wa=.707106781*(_a=la+Na),Qs=Ji+wa,ta=Ji-wa;hr[pi+40]=ta+zo,hr[pi+24]=ta-zo,hr[pi+8]=Qs+Xs,hr[pi+56]=Qs-Xs,pi++}for(_i=0;_i<64;++_i)Ri=hr[_i]*kr[_i],vt[_i]=Ri>0?Ri+.5|0:Ri-.5|0;return vt})(fr,lr),rr=0;rr<64;++rr)xt[kt[rr]]=pr[rr];var ar=xt[0]-mr;mr=xt[0],ar==0?Wt(br[0]):(Wt(br[gt[Ir=32767+ar]]),Wt(mt[Ir]));for(var nr=63;nr>0&&xt[nr]==0;nr--);if(nr==0)return Wt(cr),mr;for(var ur,Er=1;Er<=nr;){for(var Ut=Er;xt[Er]==0&&Er<=nr;++Er);var Kt=Er-Ut;if(Kt>=16){ur=Kt>>4;for(var or=1;or<=ur;++or)Wt(Nt);Kt&=15}Ir=32767+xt[Er],Wt(Sr[(Kt<<4)+gt[Ir]]),Wt(mt[Ir]),Er++}return nr!=63&&Wt(cr),mr}function dr(fr){fr<=0&&(fr=1),fr>100&&(fr=100),ot!=fr&&((function(lr){for(var mr=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],br=0;br<64;br++){var Sr=lt((mr[br]*lr+50)/100);Sr<1?Sr=1:Sr>255&&(Sr=255),ht[kt[br]]=Sr}for(var Ir=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],cr=0;cr<64;cr++){var Nt=lt((Ir[cr]*lr+50)/100);Nt<1?Nt=1:Nt>255&&(Nt=255),dt[kt[cr]]=Nt}for(var pr=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],rr=0,ar=0;ar<8;ar++)for(var nr=0;nr<8;nr++)ut[rr]=1/(ht[kt[rr]]*pr[ar]*pr[nr]*8),ft[rr]=1/(dt[kt[rr]]*pr[ar]*pr[nr]*8),rr++})(fr<50?Math.floor(5e3/fr):Math.floor(200-2*fr)),ot=fr)}this.encode=function(fr,lr){var mr;new Date().getTime(),lr&&dr(lr),wt=new Array,At=0,Tt=7,zt(65496),zt(65504),zt(16),Yt(74),Yt(70),Yt(73),Yt(70),Yt(0),Yt(1),Yt(1),Yt(0),zt(1),zt(1),Yt(0),Yt(0),(mr=fr.comments)!==void 0&&mr.constructor===Array&&mr.forEach((Xn=>{if(typeof Xn=="string"){zt(65534);var Mn,Kn=Xn.length;for(zt(Kn+2),Mn=0;Mn<Kn;Mn++)Yt(Xn.charCodeAt(Mn))}})),(function(Xn){if(Xn){zt(65505),Xn[0]===69&&Xn[1]===120&&Xn[2]===105&&Xn[3]===102?zt(Xn.length+2):(zt(Xn.length+5+2),Yt(69),Yt(120),Yt(105),Yt(102),Yt(0));for(var Mn=0;Mn<Xn.length;Mn++)Yt(Xn[Mn])}})(fr.exifBuffer),(function(){zt(65499),zt(132),Yt(0);for(var Xn=0;Xn<64;Xn++)Yt(ht[Xn]);Yt(1);for(var Mn=0;Mn<64;Mn++)Yt(dt[Mn])})(),(function(Xn,Mn){zt(65472),zt(17),Yt(8),zt(Mn),zt(Xn),Yt(3),Yt(1),Yt(17),Yt(0),Yt(2),Yt(17),Yt(1),Yt(3),Yt(17),Yt(1)})(fr.width,fr.height),(function(){zt(65476),zt(418),Yt(0);for(var Xn=0;Xn<16;Xn++)Yt(jt[Xn+1]);for(var Mn=0;Mn<=11;Mn++)Yt(Mt[Mn]);Yt(16);for(var Kn=0;Kn<16;Kn++)Yt($t[Kn+1]);for(var Vn=0;Vn<=161;Vn++)Yt(Qt[Vn]);Yt(1);for(var vi=0;vi<16;vi++)Yt(Ht[vi+1]);for(var mi=0;mi<=11;mi++)Yt(qt[mi]);Yt(17);for(var _i=0;_i<16;_i++)Yt(Bt[_i+1]);for(var Ri=0;Ri<=161;Ri++)Yt(Xt[Ri])})(),zt(65498),zt(12),Yt(3),Yt(1),Yt(0),Yt(2),Yt(17),Yt(3),Yt(17),Yt(0),Yt(63),Yt(0);var br=0,Sr=0,Ir=0;At=0,Tt=7,this.encode.displayName="_encode_";for(var cr,Nt,pr,rr,ar,nr,ur,Er,Ut,Kt=fr.data,or=fr.width,hr=fr.height,kr=4*or,Br=0;Br<hr;){for(cr=0;cr<kr;){for(nr=ar=kr*Br+cr,ur=-1,Er=0,Ut=0;Ut<64;Ut++)nr=ar+(Er=Ut>>3)*kr+(ur=4*(7&Ut)),Br+Er>=hr&&(nr-=kr*(Br+1+Er-hr)),cr+ur>=kr&&(nr-=cr+ur-kr+4),Nt=Kt[nr++],pr=Kt[nr++],rr=Kt[nr++],Pt[Ut]=(Lt[Nt]+Lt[pr+256|0]+Lt[rr+512|0]>>16)-128,Rt[Ut]=(Lt[Nt+768|0]+Lt[pr+1024|0]+Lt[rr+1280|0]>>16)-128,Ot[Ut]=(Lt[Nt+1280|0]+Lt[pr+1536|0]+Lt[rr+1792|0]>>16)-128;br=er(Pt,ut,br,nt,at),Sr=er(Rt,ft,Sr,it,st),Ir=er(Ot,ft,Ir,it,st),cr+=32}Br+=8}if(Tt>=0){var Gn=[];Gn[1]=Tt+1,Gn[0]=(1<<Tt+1)-1,Wt(Gn)}return zt(65497),Buffer$1.from(wt)},new Date().getTime(),rt||(rt=50),(function(){for(var fr=String.fromCharCode,lr=0;lr<256;lr++)Et[lr]=fr(lr)})(),nt=Ft(jt,Mt),it=Ft(Ht,qt),at=Ft($t,Qt),st=Ft(Bt,Xt),(function(){for(var fr=1,lr=2,mr=1;mr<=15;mr++){for(var br=fr;br<lr;br++)gt[32767+br]=mr,mt[32767+br]=[],mt[32767+br][1]=mr,mt[32767+br][0]=br;for(var Sr=-(lr-1);Sr<=-fr;Sr++)gt[32767+Sr]=mr,mt[32767+Sr]=[],mt[32767+Sr][1]=mr,mt[32767+Sr][0]=lr-1+Sr;fr<<=1,lr<<=1}})(),(function(){for(var fr=0;fr<256;fr++)Lt[fr]=19595*fr,Lt[fr+256|0]=38470*fr,Lt[fr+512|0]=7471*fr+32768,Lt[fr+768|0]=-11059*fr,Lt[fr+1024|0]=-21709*fr,Lt[fr+1280|0]=32768*fr+8421375,Lt[fr+1536|0]=-27439*fr,Lt[fr+1792|0]=-5329*fr})(),dr(rt),new Date().getTime()}encoder.exports=function(rt,nt){nt===void 0&&(nt=50);var it=new et(nt),at=it.encode(rt,nt);return{data:at,width:rt.width,height:rt.height}}})();var encoderExports=encoder.exports,decoder={exports:{}},module$1,JpegImage;module$1=decoder,JpegImage=(function(){var tt=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),et=4017,rt=799,nt=3406,it=2276,at=1567,st=3784,ot=5793,lt=2896;function ht(){}function dt(wt,At){for(var Tt,Pt,Rt=0,Ot=[],Et=16;Et>0&&!wt[Et-1];)Et--;Ot.push({children:[],index:0});var Lt,kt=Ot[0];for(Tt=0;Tt<Et;Tt++){for(Pt=0;Pt<wt[Tt];Pt++){for((kt=Ot.pop()).children[kt.index]=At[Rt];kt.index>0;){if(Ot.length===0)throw new Error("Could not recreate Huffman Table");kt=Ot.pop()}for(kt.index++,Ot.push(kt);Ot.length<=Tt;)Ot.push(Lt={children:[],index:0}),kt.children[kt.index]=Lt.children,kt=Lt;Rt++}Tt+1<Et&&(Ot.push(Lt={children:[],index:0}),kt.children[kt.index]=Lt.children,kt=Lt)}return Ot[0].children}function ut(wt,At,Tt,Pt,Rt,Ot,Et,Lt,kt,jt){Tt.precision,Tt.samplesPerLine,Tt.scanLines;var Mt=Tt.mcusPerLine,$t=Tt.progressive;Tt.maxH,Tt.maxV;var Qt=At,Ht=0,qt=0;function Bt(){if(qt>0)return qt--,Ht>>qt&1;if((Ht=wt[At++])==255){var Er=wt[At++];if(Er)throw new Error("unexpected marker: "+(Ht<<8|Er).toString(16))}return qt=7,Ht>>>7}function Xt(Er){for(var Ut,Kt=Er;(Ut=Bt())!==null;){if(typeof(Kt=Kt[Ut])=="number")return Kt;if(typeof Kt!="object")throw new Error("invalid huffman sequence")}return null}function Ft(Er){for(var Ut=0;Er>0;){var Kt=Bt();if(Kt===null)return;Ut=Ut<<1|Kt,Er--}return Ut}function Wt(Er){var Ut=Ft(Er);return Ut>=1<<Er-1?Ut:Ut+(-1<<Er)+1}var Yt,zt=0,er=0;function dr(Er,Ut,Kt,or,hr){var kr=Kt%Mt,Br=(Kt/Mt|0)*Er.v+or,Gn=kr*Er.h+hr;Er.blocks[Br]===void 0&&jt.tolerantDecoding||Ut(Er,Er.blocks[Br][Gn])}function fr(Er,Ut,Kt){var or=Kt/Er.blocksPerLine|0,hr=Kt%Er.blocksPerLine;Er.blocks[or]===void 0&&jt.tolerantDecoding||Ut(Er,Er.blocks[or][hr])}var lr,mr,br,Sr,Ir,cr,Nt=Pt.length;cr=$t?Ot===0?Lt===0?function(Er,Ut){var Kt=Xt(Er.huffmanTableDC),or=Kt===0?0:Wt(Kt)<<kt;Ut[0]=Er.pred+=or}:function(Er,Ut){Ut[0]|=Bt()<<kt}:Lt===0?function(Er,Ut){if(zt>0)zt--;else for(var Kt=Ot,or=Et;Kt<=or;){var hr=Xt(Er.huffmanTableAC),kr=15&hr,Br=hr>>4;if(kr!==0)Ut[tt[Kt+=Br]]=Wt(kr)*(1<<kt),Kt++;else{if(Br<15){zt=Ft(Br)+(1<<Br)-1;break}Kt+=16}}}:function(Er,Ut){for(var Kt=Ot,or=Et,hr=0;Kt<=or;){var kr=tt[Kt],Br=Ut[kr]<0?-1:1;switch(er){case 0:var Gn=Xt(Er.huffmanTableAC),Xn=15&Gn;if(hr=Gn>>4,Xn===0)hr<15?(zt=Ft(hr)+(1<<hr),er=4):(hr=16,er=1);else{if(Xn!==1)throw new Error("invalid ACn encoding");Yt=Wt(Xn),er=hr?2:3}continue;case 1:case 2:Ut[kr]?Ut[kr]+=(Bt()<<kt)*Br:--hr==0&&(er=er==2?3:0);break;case 3:Ut[kr]?Ut[kr]+=(Bt()<<kt)*Br:(Ut[kr]=Yt<<kt,er=0);break;case 4:Ut[kr]&&(Ut[kr]+=(Bt()<<kt)*Br)}Kt++}er===4&&--zt==0&&(er=0)}:function(Er,Ut){var Kt=Xt(Er.huffmanTableDC),or=Kt===0?0:Wt(Kt);Ut[0]=Er.pred+=or;for(var hr=1;hr<64;){var kr=Xt(Er.huffmanTableAC),Br=15&kr,Gn=kr>>4;if(Br!==0)Ut[tt[hr+=Gn]]=Wt(Br),hr++;else{if(Gn<15)break;hr+=16}}};var pr,rr,ar,nr,ur=0;for(rr=Nt==1?Pt[0].blocksPerLine*Pt[0].blocksPerColumn:Mt*Tt.mcusPerColumn,Rt||(Rt=rr);ur<rr;){for(mr=0;mr<Nt;mr++)Pt[mr].pred=0;if(zt=0,Nt==1)for(lr=Pt[0],Ir=0;Ir<Rt;Ir++)fr(lr,cr,ur),ur++;else for(Ir=0;Ir<Rt;Ir++){for(mr=0;mr<Nt;mr++)for(ar=(lr=Pt[mr]).h,nr=lr.v,br=0;br<nr;br++)for(Sr=0;Sr<ar;Sr++)dr(lr,cr,ur,br,Sr);if(++ur===rr)break}if(ur===rr)do{if(wt[At]===255&&wt[At+1]!==0)break;At+=1}while(At<wt.length-2);if(qt=0,(pr=wt[At]<<8|wt[At+1])<65280)throw new Error("marker was not found");if(!(pr>=65488&&pr<=65495))break;At+=2}return At-Qt}function ft(wt,At){var Tt,Pt,Rt=[],Ot=At.blocksPerLine,Et=At.blocksPerColumn,Lt=Ot<<3,kt=new Int32Array(64),jt=new Uint8Array(64);function Mt(Ft,Wt,Yt){var zt,er,dr,fr,lr,mr,br,Sr,Ir,cr,Nt=At.quantizationTable,pr=Yt;for(cr=0;cr<64;cr++)pr[cr]=Ft[cr]*Nt[cr];for(cr=0;cr<8;++cr){var rr=8*cr;pr[1+rr]!=0||pr[2+rr]!=0||pr[3+rr]!=0||pr[4+rr]!=0||pr[5+rr]!=0||pr[6+rr]!=0||pr[7+rr]!=0?(zt=ot*pr[0+rr]+128>>8,er=ot*pr[4+rr]+128>>8,dr=pr[2+rr],fr=pr[6+rr],lr=lt*(pr[1+rr]-pr[7+rr])+128>>8,Sr=lt*(pr[1+rr]+pr[7+rr])+128>>8,mr=pr[3+rr]<<4,br=pr[5+rr]<<4,Ir=zt-er+1>>1,zt=zt+er+1>>1,er=Ir,Ir=dr*st+fr*at+128>>8,dr=dr*at-fr*st+128>>8,fr=Ir,Ir=lr-br+1>>1,lr=lr+br+1>>1,br=Ir,Ir=Sr+mr+1>>1,mr=Sr-mr+1>>1,Sr=Ir,Ir=zt-fr+1>>1,zt=zt+fr+1>>1,fr=Ir,Ir=er-dr+1>>1,er=er+dr+1>>1,dr=Ir,Ir=lr*it+Sr*nt+2048>>12,lr=lr*nt-Sr*it+2048>>12,Sr=Ir,Ir=mr*rt+br*et+2048>>12,mr=mr*et-br*rt+2048>>12,br=Ir,pr[0+rr]=zt+Sr,pr[7+rr]=zt-Sr,pr[1+rr]=er+br,pr[6+rr]=er-br,pr[2+rr]=dr+mr,pr[5+rr]=dr-mr,pr[3+rr]=fr+lr,pr[4+rr]=fr-lr):(Ir=ot*pr[0+rr]+512>>10,pr[0+rr]=Ir,pr[1+rr]=Ir,pr[2+rr]=Ir,pr[3+rr]=Ir,pr[4+rr]=Ir,pr[5+rr]=Ir,pr[6+rr]=Ir,pr[7+rr]=Ir)}for(cr=0;cr<8;++cr){var ar=cr;pr[8+ar]!=0||pr[16+ar]!=0||pr[24+ar]!=0||pr[32+ar]!=0||pr[40+ar]!=0||pr[48+ar]!=0||pr[56+ar]!=0?(zt=ot*pr[0+ar]+2048>>12,er=ot*pr[32+ar]+2048>>12,dr=pr[16+ar],fr=pr[48+ar],lr=lt*(pr[8+ar]-pr[56+ar])+2048>>12,Sr=lt*(pr[8+ar]+pr[56+ar])+2048>>12,mr=pr[24+ar],br=pr[40+ar],Ir=zt-er+1>>1,zt=zt+er+1>>1,er=Ir,Ir=dr*st+fr*at+2048>>12,dr=dr*at-fr*st+2048>>12,fr=Ir,Ir=lr-br+1>>1,lr=lr+br+1>>1,br=Ir,Ir=Sr+mr+1>>1,mr=Sr-mr+1>>1,Sr=Ir,Ir=zt-fr+1>>1,zt=zt+fr+1>>1,fr=Ir,Ir=er-dr+1>>1,er=er+dr+1>>1,dr=Ir,Ir=lr*it+Sr*nt+2048>>12,lr=lr*nt-Sr*it+2048>>12,Sr=Ir,Ir=mr*rt+br*et+2048>>12,mr=mr*et-br*rt+2048>>12,br=Ir,pr[0+ar]=zt+Sr,pr[56+ar]=zt-Sr,pr[8+ar]=er+br,pr[48+ar]=er-br,pr[16+ar]=dr+mr,pr[40+ar]=dr-mr,pr[24+ar]=fr+lr,pr[32+ar]=fr-lr):(Ir=ot*Yt[cr+0]+8192>>14,pr[0+ar]=Ir,pr[8+ar]=Ir,pr[16+ar]=Ir,pr[24+ar]=Ir,pr[32+ar]=Ir,pr[40+ar]=Ir,pr[48+ar]=Ir,pr[56+ar]=Ir)}for(cr=0;cr<64;++cr){var nr=128+(pr[cr]+8>>4);Wt[cr]=nr<0?0:nr>255?255:nr}}xt(Lt*Et*8);for(var $t=0;$t<Et;$t++){var Qt=$t<<3;for(Tt=0;Tt<8;Tt++)Rt.push(new Uint8Array(Lt));for(var Ht=0;Ht<Ot;Ht++){Mt(At.blocks[$t][Ht],jt,kt);var qt=0,Bt=Ht<<3;for(Pt=0;Pt<8;Pt++){var Xt=Rt[Qt+Pt];for(Tt=0;Tt<8;Tt++)Xt[Bt+Tt]=jt[qt++]}}}return Rt}function mt(wt){return wt<0?0:wt>255?255:wt}ht.prototype={load:function(wt){var At=new XMLHttpRequest;At.open("GET",wt,!0),At.responseType="arraybuffer",At.onload=(function(){var Tt=new Uint8Array(At.response||At.mozResponseArrayBuffer);this.parse(Tt),this.onload&&this.onload()}).bind(this),At.send(null)},parse:function(wt){var At=1e3*this.opts.maxResolutionInMP*1e3,Tt=0;function Pt(){var Mn=wt[Tt]<<8|wt[Tt+1];return Tt+=2,Mn}function Rt(Mn){var Kn,Vn,vi=1,mi=1;for(Vn in Mn.components)Mn.components.hasOwnProperty(Vn)&&(vi<(Kn=Mn.components[Vn]).h&&(vi=Kn.h),mi<Kn.v&&(mi=Kn.v));var _i=Math.ceil(Mn.samplesPerLine/8/vi),Ri=Math.ceil(Mn.scanLines/8/mi);for(Vn in Mn.components)if(Mn.components.hasOwnProperty(Vn)){Kn=Mn.components[Vn];var pi=Math.ceil(Math.ceil(Mn.samplesPerLine/8)*Kn.h/vi),Tr=Math.ceil(Math.ceil(Mn.scanLines/8)*Kn.v/mi),qn=_i*Kn.h,_r=Ri*Kn.v,Rr=[];xt(_r*qn*256);for(var yr=0;yr<_r;yr++){for(var Kr=[],Jr=0;Jr<qn;Jr++)Kr.push(new Int32Array(64));Rr.push(Kr)}Kn.blocksPerLine=pi,Kn.blocksPerColumn=Tr,Kn.blocks=Rr}Mn.maxH=vi,Mn.maxV=mi,Mn.mcusPerLine=_i,Mn.mcusPerColumn=Ri}wt.length;var Ot,Et,Lt,kt,jt=null,Mt=null,$t=[],Qt=[],Ht=[],qt=[],Bt=Pt(),Xt=-1;if(this.comments=[],Bt!=65496)throw new Error("SOI not found");for(Bt=Pt();Bt!=65497;){switch(Bt){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var Ft=(Lt=void 0,kt=void 0,Lt=Pt(),kt=wt.subarray(Tt,Tt+Lt-2),Tt+=kt.length,kt);if(Bt===65534){var Wt=String.fromCharCode.apply(null,Ft);this.comments.push(Wt)}Bt===65504&&Ft[0]===74&&Ft[1]===70&&Ft[2]===73&&Ft[3]===70&&Ft[4]===0&&(jt={version:{major:Ft[5],minor:Ft[6]},densityUnits:Ft[7],xDensity:Ft[8]<<8|Ft[9],yDensity:Ft[10]<<8|Ft[11],thumbWidth:Ft[12],thumbHeight:Ft[13],thumbData:Ft.subarray(14,14+3*Ft[12]*Ft[13])}),Bt===65505&&Ft[0]===69&&Ft[1]===120&&Ft[2]===105&&Ft[3]===102&&Ft[4]===0&&(this.exifBuffer=Ft.subarray(5,Ft.length)),Bt===65518&&Ft[0]===65&&Ft[1]===100&&Ft[2]===111&&Ft[3]===98&&Ft[4]===101&&Ft[5]===0&&(Mt={version:Ft[6],flags0:Ft[7]<<8|Ft[8],flags1:Ft[9]<<8|Ft[10],transformCode:Ft[11]});break;case 65499:for(var Yt=Pt()+Tt-2;Tt<Yt;){var zt=wt[Tt++];xt(256);var er=new Int32Array(64);if(zt>>4){if(zt>>4!=1)throw new Error("DQT: invalid table spec");for(Gn=0;Gn<64;Gn++)er[tt[Gn]]=Pt()}else for(Gn=0;Gn<64;Gn++)er[tt[Gn]]=wt[Tt++];$t[15&zt]=er}break;case 65472:case 65473:case 65474:Pt(),(Ot={}).extended=Bt===65473,Ot.progressive=Bt===65474,Ot.precision=wt[Tt++],Ot.scanLines=Pt(),Ot.samplesPerLine=Pt(),Ot.components={},Ot.componentsOrder=[];var dr=Ot.scanLines*Ot.samplesPerLine;if(dr>At){var fr=Math.ceil((dr-At)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${fr}MP`)}var lr,mr=wt[Tt++];for(kr=0;kr<mr;kr++){lr=wt[Tt];var br=wt[Tt+1]>>4,Sr=15&wt[Tt+1],Ir=wt[Tt+2];if(br<=0||Sr<=0)throw new Error("Invalid sampling factor, expected values above 0");Ot.componentsOrder.push(lr),Ot.components[lr]={h:br,v:Sr,quantizationIdx:Ir},Tt+=3}Rt(Ot),Qt.push(Ot);break;case 65476:var cr=Pt();for(kr=2;kr<cr;){var Nt=wt[Tt++],pr=new Uint8Array(16),rr=0;for(Gn=0;Gn<16;Gn++,Tt++)rr+=pr[Gn]=wt[Tt];xt(16+rr);var ar=new Uint8Array(rr);for(Gn=0;Gn<rr;Gn++,Tt++)ar[Gn]=wt[Tt];kr+=17+rr,(Nt>>4?Ht:qt)[15&Nt]=dt(pr,ar)}break;case 65501:Pt(),Et=Pt();break;case 65500:Pt(),Pt();break;case 65498:Pt();var nr=wt[Tt++],ur=[];for(kr=0;kr<nr;kr++){Xn=Ot.components[wt[Tt++]];var Er=wt[Tt++];Xn.huffmanTableDC=qt[Er>>4],Xn.huffmanTableAC=Ht[15&Er],ur.push(Xn)}var Ut=wt[Tt++],Kt=wt[Tt++],or=wt[Tt++],hr=ut(wt,Tt,Ot,ur,Et,Ut,Kt,or>>4,15&or,this.opts);Tt+=hr;break;case 65535:wt[Tt]!==255&&Tt--;break;default:if(wt[Tt-3]==255&&wt[Tt-2]>=192&&wt[Tt-2]<=254){Tt-=3;break}if(Bt===224||Bt==225){if(Xt!==-1)throw new Error(`first unknown JPEG marker at offset ${Xt.toString(16)}, second unknown JPEG marker ${Bt.toString(16)} at offset ${(Tt-1).toString(16)}`);Xt=Tt-1;const Mn=Pt();if(wt[Tt+Mn-2]===255){Tt+=Mn-2;break}}throw new Error("unknown JPEG marker "+Bt.toString(16))}Bt=Pt()}if(Qt.length!=1)throw new Error("only single frame JPEGs supported");for(var kr=0;kr<Qt.length;kr++){var Br=Qt[kr].components;for(var Gn in Br)Br[Gn].quantizationTable=$t[Br[Gn].quantizationIdx],delete Br[Gn].quantizationIdx}for(this.width=Ot.samplesPerLine,this.height=Ot.scanLines,this.jfif=jt,this.adobe=Mt,this.components=[],kr=0;kr<Ot.componentsOrder.length;kr++){var Xn=Ot.components[Ot.componentsOrder[kr]];this.components.push({lines:ft(0,Xn),scaleX:Xn.h/Ot.maxH,scaleY:Xn.v/Ot.maxV})}},getData:function(wt,At){var Tt,Pt,Rt,Ot,Et,Lt,kt,jt,Mt,$t,Qt,Ht,qt,Bt,Xt,Ft,Wt,Yt,zt,er,dr,fr=this.width/wt,lr=this.height/At,mr=0,br=wt*At*this.components.length;xt(br);var Sr=new Uint8Array(br);switch(this.components.length){case 1:for(Tt=this.components[0],$t=0;$t<At;$t++)for(Et=Tt.lines[0|$t*Tt.scaleY*lr],Mt=0;Mt<wt;Mt++)Qt=Et[0|Mt*Tt.scaleX*fr],Sr[mr++]=Qt;break;case 2:for(Tt=this.components[0],Pt=this.components[1],$t=0;$t<At;$t++)for(Et=Tt.lines[0|$t*Tt.scaleY*lr],Lt=Pt.lines[0|$t*Pt.scaleY*lr],Mt=0;Mt<wt;Mt++)Qt=Et[0|Mt*Tt.scaleX*fr],Sr[mr++]=Qt,Qt=Lt[0|Mt*Pt.scaleX*fr],Sr[mr++]=Qt;break;case 3:for(dr=!0,this.adobe&&this.adobe.transformCode?dr=!0:this.opts.colorTransform!==void 0&&(dr=!!this.opts.colorTransform),Tt=this.components[0],Pt=this.components[1],Rt=this.components[2],$t=0;$t<At;$t++)for(Et=Tt.lines[0|$t*Tt.scaleY*lr],Lt=Pt.lines[0|$t*Pt.scaleY*lr],kt=Rt.lines[0|$t*Rt.scaleY*lr],Mt=0;Mt<wt;Mt++)dr?(Qt=Et[0|Mt*Tt.scaleX*fr],Ht=Lt[0|Mt*Pt.scaleX*fr],Yt=mt(Qt+1.402*((qt=kt[0|Mt*Rt.scaleX*fr])-128)),zt=mt(Qt-.3441363*(Ht-128)-.71413636*(qt-128)),er=mt(Qt+1.772*(Ht-128))):(Yt=Et[0|Mt*Tt.scaleX*fr],zt=Lt[0|Mt*Pt.scaleX*fr],er=kt[0|Mt*Rt.scaleX*fr]),Sr[mr++]=Yt,Sr[mr++]=zt,Sr[mr++]=er;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(dr=!1,this.adobe&&this.adobe.transformCode?dr=!0:this.opts.colorTransform!==void 0&&(dr=!!this.opts.colorTransform),Tt=this.components[0],Pt=this.components[1],Rt=this.components[2],Ot=this.components[3],$t=0;$t<At;$t++)for(Et=Tt.lines[0|$t*Tt.scaleY*lr],Lt=Pt.lines[0|$t*Pt.scaleY*lr],kt=Rt.lines[0|$t*Rt.scaleY*lr],jt=Ot.lines[0|$t*Ot.scaleY*lr],Mt=0;Mt<wt;Mt++)dr?(Qt=Et[0|Mt*Tt.scaleX*fr],Ht=Lt[0|Mt*Pt.scaleX*fr],qt=kt[0|Mt*Rt.scaleX*fr],Bt=jt[0|Mt*Ot.scaleX*fr],Xt=255-mt(Qt+1.402*(qt-128)),Ft=255-mt(Qt-.3441363*(Ht-128)-.71413636*(qt-128)),Wt=255-mt(Qt+1.772*(Ht-128))):(Xt=Et[0|Mt*Tt.scaleX*fr],Ft=Lt[0|Mt*Pt.scaleX*fr],Wt=kt[0|Mt*Rt.scaleX*fr],Bt=jt[0|Mt*Ot.scaleX*fr]),Sr[mr++]=255-Xt,Sr[mr++]=255-Ft,Sr[mr++]=255-Wt,Sr[mr++]=255-Bt;break;default:throw new Error("Unsupported color mode")}return Sr},copyToImageData:function(wt,At){var Tt,Pt,Rt,Ot,Et,Lt,kt,jt,Mt,$t=wt.width,Qt=wt.height,Ht=wt.data,qt=this.getData($t,Qt),Bt=0,Xt=0;switch(this.components.length){case 1:for(Pt=0;Pt<Qt;Pt++)for(Tt=0;Tt<$t;Tt++)Rt=qt[Bt++],Ht[Xt++]=Rt,Ht[Xt++]=Rt,Ht[Xt++]=Rt,At&&(Ht[Xt++]=255);break;case 3:for(Pt=0;Pt<Qt;Pt++)for(Tt=0;Tt<$t;Tt++)kt=qt[Bt++],jt=qt[Bt++],Mt=qt[Bt++],Ht[Xt++]=kt,Ht[Xt++]=jt,Ht[Xt++]=Mt,At&&(Ht[Xt++]=255);break;case 4:for(Pt=0;Pt<Qt;Pt++)for(Tt=0;Tt<$t;Tt++)Et=qt[Bt++],Lt=qt[Bt++],Rt=qt[Bt++],kt=255-mt(Et*(1-(Ot=qt[Bt++])/255)+Ot),jt=255-mt(Lt*(1-Ot/255)+Ot),Mt=255-mt(Rt*(1-Ot/255)+Ot),Ht[Xt++]=kt,Ht[Xt++]=jt,Ht[Xt++]=Mt,At&&(Ht[Xt++]=255);break;default:throw new Error("Unsupported color mode")}}};var gt=0,vt=0;function xt(wt=0){var At=gt+wt;if(At>vt){var Tt=Math.ceil((At-vt)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${Tt}MB`)}gt=At}return ht.resetMaxMemoryUsage=function(wt){gt=0,vt=wt},ht.getBytesAllocated=function(){return gt},ht.requestMemoryAllocation=xt,ht})(),module$1.exports=function(tt,et={}){var rt={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...et},nt=new Uint8Array(tt),it=new JpegImage;it.opts=rt,JpegImage.resetMaxMemoryUsage(1024*rt.maxMemoryUsageInMB*1024),it.parse(nt);var at=rt.formatAsRGBA?4:3,st=it.width*it.height*at;try{JpegImage.requestMemoryAllocation(st);var ot={width:it.width,height:it.height,exifBuffer:it.exifBuffer,data:rt.useTArray?new Uint8Array(st):Buffer$1.alloc(st)};it.comments.length>0&&(ot.comments=it.comments)}catch(lt){throw lt instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+st):lt instanceof ReferenceError&&lt.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):lt}return it.copyToImageData(ot,rt.formatAsRGBA),ot};var decoderExports=decoder.exports,encode=encoderExports,decode=decoderExports,jpegJs={encode,decode},JPEG=getDefaultExportFromCjs(jpegJs);function jpeg$2(){return{mime:"image/jpeg",encode:(tt,{quality:et=100}={})=>JPEG.encode(tt,et).data,decode:(tt,et)=>JPEG.decode(tt,et)}}function commonjsRequire(tt){throw new Error('Could not dynamically require "'+tt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browser$1={exports:{}};browser$1.exports=(function(){function tt(et,rt,nt){function it(ot,lt){if(!rt[ot]){if(!et[ot]){var ht=typeof commonjsRequire=="function"&&commonjsRequire;if(!lt&&ht)return ht(ot,!0);if(at)return at(ot,!0);var dt=new Error("Cannot find module '"+ot+"'");throw dt.code="MODULE_NOT_FOUND",dt}var ut=rt[ot]={exports:{}};et[ot][0].call(ut.exports,(function(ft){return it(et[ot][1][ft]||ft)}),ut,ut.exports,tt,et,rt,nt)}return rt[ot].exports}for(var at=typeof commonjsRequire=="function"&&commonjsRequire,st=0;st<nt.length;st++)it(nt[st]);return it}return tt})()({1:[function(tt,et,rt){(function(nt){(function(){let it=tt("./interlace"),at=[function(){},function(dt,ut,ft,mt){if(mt===ut.length)throw new Error("Ran out of data");let gt=ut[mt];dt[ft]=gt,dt[ft+1]=gt,dt[ft+2]=gt,dt[ft+3]=255},function(dt,ut,ft,mt){if(mt+1>=ut.length)throw new Error("Ran out of data");let gt=ut[mt];dt[ft]=gt,dt[ft+1]=gt,dt[ft+2]=gt,dt[ft+3]=ut[mt+1]},function(dt,ut,ft,mt){if(mt+2>=ut.length)throw new Error("Ran out of data");dt[ft]=ut[mt],dt[ft+1]=ut[mt+1],dt[ft+2]=ut[mt+2],dt[ft+3]=255},function(dt,ut,ft,mt){if(mt+3>=ut.length)throw new Error("Ran out of data");dt[ft]=ut[mt],dt[ft+1]=ut[mt+1],dt[ft+2]=ut[mt+2],dt[ft+3]=ut[mt+3]}],st=[function(){},function(dt,ut,ft,mt){let gt=ut[0];dt[ft]=gt,dt[ft+1]=gt,dt[ft+2]=gt,dt[ft+3]=mt},function(dt,ut,ft){let mt=ut[0];dt[ft]=mt,dt[ft+1]=mt,dt[ft+2]=mt,dt[ft+3]=ut[1]},function(dt,ut,ft,mt){dt[ft]=ut[0],dt[ft+1]=ut[1],dt[ft+2]=ut[2],dt[ft+3]=mt},function(dt,ut,ft){dt[ft]=ut[0],dt[ft+1]=ut[1],dt[ft+2]=ut[2],dt[ft+3]=ut[3]}];function ot(dt,ut){let ft=[],mt=0;function gt(){if(mt===dt.length)throw new Error("Ran out of data");let vt,xt,wt,At,Tt,Pt,Rt,Ot,Et=dt[mt];switch(mt++,ut){default:throw new Error("unrecognised depth");case 16:Rt=dt[mt],mt++,ft.push((Et<<8)+Rt);break;case 4:Rt=15&Et,Ot=Et>>4,ft.push(Ot,Rt);break;case 2:Tt=3&Et,Pt=Et>>2&3,Rt=Et>>4&3,Ot=Et>>6&3,ft.push(Ot,Rt,Pt,Tt);break;case 1:vt=1&Et,xt=Et>>1&1,wt=Et>>2&1,At=Et>>3&1,Tt=Et>>4&1,Pt=Et>>5&1,Rt=Et>>6&1,Ot=Et>>7&1,ft.push(Ot,Rt,Pt,Tt,At,wt,xt,vt)}}return{get:function(vt){for(;ft.length<vt;)gt();let xt=ft.slice(0,vt);return ft=ft.slice(vt),xt},resetAfterLine:function(){ft.length=0},end:function(){if(mt!==dt.length)throw new Error("extra data found")}}}function lt(dt,ut,ft,mt,gt,vt){let xt=dt.width,wt=dt.height,At=dt.index;for(let Tt=0;Tt<wt;Tt++)for(let Pt=0;Pt<xt;Pt++){let Rt=ft(Pt,Tt,At);at[mt](ut,gt,Rt,vt),vt+=mt}return vt}function ht(dt,ut,ft,mt,gt,vt){let xt=dt.width,wt=dt.height,At=dt.index;for(let Tt=0;Tt<wt;Tt++){for(let Pt=0;Pt<xt;Pt++){let Rt=gt.get(mt),Ot=ft(Pt,Tt,At);st[mt](ut,Rt,Ot,vt)}gt.resetAfterLine()}}rt.dataToBitMap=function(dt,ut){let ft,mt,gt=ut.width,vt=ut.height,xt=ut.depth,wt=ut.bpp,At=ut.interlace;xt!==8&&(ft=ot(dt,xt)),mt=xt<=8?nt.alloc(gt*vt*4):new Uint16Array(gt*vt*4);let Tt,Pt,Rt=Math.pow(2,xt)-1,Ot=0;if(At)Tt=it.getImagePasses(gt,vt),Pt=it.getInterlaceIterator(gt,vt);else{let Et=0;Pt=function(){let Lt=Et;return Et+=4,Lt},Tt=[{width:gt,height:vt}]}for(let Et=0;Et<Tt.length;Et++)xt===8?Ot=lt(Tt[Et],mt,Pt,wt,dt,Ot):ht(Tt[Et],mt,Pt,wt,ft,Rt);if(xt===8){if(Ot!==dt.length)throw new Error("extra data found")}else ft.end();return mt}}).call(this)}).call(this,tt("buffer").Buffer)},{"./interlace":11,buffer:32}],2:[function(tt,et,rt){(function(nt){(function(){let it=tt("./constants");et.exports=function(at,st,ot,lt){let ht=[it.COLORTYPE_COLOR_ALPHA,it.COLORTYPE_ALPHA].indexOf(lt.colorType)!==-1;if(lt.colorType===lt.inputColorType){let Tt=(function(){let Pt=new ArrayBuffer(2);return new DataView(Pt).setInt16(0,256,!0),new Int16Array(Pt)[0]!==256})();if(lt.bitDepth===8||lt.bitDepth===16&&Tt)return at}let dt=lt.bitDepth!==16?at:new Uint16Array(at.buffer),ut=255,ft=it.COLORTYPE_TO_BPP_MAP[lt.inputColorType];ft!==4||lt.inputHasAlpha||(ft=3);let mt=it.COLORTYPE_TO_BPP_MAP[lt.colorType];lt.bitDepth===16&&(ut=65535,mt*=2);let gt=nt.alloc(st*ot*mt),vt=0,xt=0,wt=lt.bgColor||{};function At(){let Tt,Pt,Rt,Ot=ut;switch(lt.inputColorType){case it.COLORTYPE_COLOR_ALPHA:Ot=dt[vt+3],Tt=dt[vt],Pt=dt[vt+1],Rt=dt[vt+2];break;case it.COLORTYPE_COLOR:Tt=dt[vt],Pt=dt[vt+1],Rt=dt[vt+2];break;case it.COLORTYPE_ALPHA:Ot=dt[vt+1],Tt=dt[vt],Pt=Tt,Rt=Tt;break;case it.COLORTYPE_GRAYSCALE:Tt=dt[vt],Pt=Tt,Rt=Tt;break;default:throw new Error("input color type:"+lt.inputColorType+" is not supported at present")}return lt.inputHasAlpha&&(ht||(Ot/=ut,Tt=Math.min(Math.max(Math.round((1-Ot)*wt.red+Ot*Tt),0),ut),Pt=Math.min(Math.max(Math.round((1-Ot)*wt.green+Ot*Pt),0),ut),Rt=Math.min(Math.max(Math.round((1-Ot)*wt.blue+Ot*Rt),0),ut))),{red:Tt,green:Pt,blue:Rt,alpha:Ot}}wt.red===void 0&&(wt.red=ut),wt.green===void 0&&(wt.green=ut),wt.blue===void 0&&(wt.blue=ut);for(let Tt=0;Tt<ot;Tt++)for(let Pt=0;Pt<st;Pt++){let Rt=At();switch(lt.colorType){case it.COLORTYPE_COLOR_ALPHA:case it.COLORTYPE_COLOR:lt.bitDepth===8?(gt[xt]=Rt.red,gt[xt+1]=Rt.green,gt[xt+2]=Rt.blue,ht&&(gt[xt+3]=Rt.alpha)):(gt.writeUInt16BE(Rt.red,xt),gt.writeUInt16BE(Rt.green,xt+2),gt.writeUInt16BE(Rt.blue,xt+4),ht&&gt.writeUInt16BE(Rt.alpha,xt+6));break;case it.COLORTYPE_ALPHA:case it.COLORTYPE_GRAYSCALE:{let Ot=(Rt.red+Rt.green+Rt.blue)/3;lt.bitDepth===8?(gt[xt]=Ot,ht&&(gt[xt+1]=Rt.alpha)):(gt.writeUInt16BE(Ot,xt),ht&&gt.writeUInt16BE(Rt.alpha,xt+2));break}default:throw new Error("unrecognised color Type "+lt.colorType)}vt+=ft,xt+=mt}return gt}}).call(this)}).call(this,tt("buffer").Buffer)},{"./constants":4,buffer:32}],3:[function(tt,et,rt){(function(nt,it){(function(){let at=tt("util"),st=tt("stream"),ot=et.exports=function(){st.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};at.inherits(ot,st),ot.prototype.read=function(lt,ht){this._reads.push({length:Math.abs(lt),allowLess:lt<0,func:ht}),nt.nextTick((function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}).bind(this))},ot.prototype.write=function(lt,ht){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let dt;return dt=it.isBuffer(lt)?lt:it.from(lt,ht||this._encoding),this._buffers.push(dt),this._buffered+=dt.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},ot.prototype.end=function(lt,ht){lt&&this.write(lt,ht),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},ot.prototype.destroySoon=ot.prototype.end,ot.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},ot.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},ot.prototype._processReadAllowingLess=function(lt){this._reads.shift();let ht=this._buffers[0];ht.length>lt.length?(this._buffered-=lt.length,this._buffers[0]=ht.slice(lt.length),lt.func.call(this,ht.slice(0,lt.length))):(this._buffered-=ht.length,this._buffers.shift(),lt.func.call(this,ht))},ot.prototype._processRead=function(lt){this._reads.shift();let ht=0,dt=0,ut=it.alloc(lt.length);for(;ht<lt.length;){let ft=this._buffers[dt++],mt=Math.min(ft.length,lt.length-ht);ft.copy(ut,ht,0,mt),ht+=mt,mt!==ft.length&&(this._buffers[--dt]=ft.slice(mt))}dt>0&&this._buffers.splice(0,dt),this._buffered-=lt.length,lt.func.call(this,ut)},ot.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let lt=this._reads[0];if(lt.allowLess)this._processReadAllowingLess(lt);else{if(!(this._buffered>=lt.length))break;this._processRead(lt)}}this._buffers&&!this.writable&&this._end()}catch(lt){this.emit("error",lt)}}}).call(this)}).call(this,tt("_process"),tt("buffer").Buffer)},{_process:63,buffer:32,stream:65,util:84}],4:[function(tt,et,rt){et.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],5:[function(tt,et,rt){let nt=[];(function(){for(let at=0;at<256;at++){let st=at;for(let ot=0;ot<8;ot++)1&st?st=3988292384^st>>>1:st>>>=1;nt[at]=st}})();let it=et.exports=function(){this._crc=-1};it.prototype.write=function(at){for(let st=0;st<at.length;st++)this._crc=nt[255&(this._crc^at[st])]^this._crc>>>8;return!0},it.prototype.crc32=function(){return~this._crc},it.crc32=function(at){let st=-1;for(let ot=0;ot<at.length;ot++)st=nt[255&(st^at[ot])]^st>>>8;return~st}},{}],6:[function(tt,et,rt){(function(nt){(function(){let it=tt("./paeth-predictor");function at(wt,At,Tt,Pt,Rt){for(let Ot=0;Ot<Tt;Ot++)Pt[Rt+Ot]=wt[At+Ot]}function st(wt,At,Tt){let Pt=0,Rt=At+Tt;for(let Ot=At;Ot<Rt;Ot++)Pt+=Math.abs(wt[Ot]);return Pt}function ot(wt,At,Tt,Pt,Rt,Ot){for(let Et=0;Et<Tt;Et++){let Lt=Et>=Ot?wt[At+Et-Ot]:0,kt=wt[At+Et]-Lt;Pt[Rt+Et]=kt}}function lt(wt,At,Tt,Pt){let Rt=0;for(let Ot=0;Ot<Tt;Ot++){let Et=Ot>=Pt?wt[At+Ot-Pt]:0,Lt=wt[At+Ot]-Et;Rt+=Math.abs(Lt)}return Rt}function ht(wt,At,Tt,Pt,Rt){for(let Ot=0;Ot<Tt;Ot++){let Et=At>0?wt[At+Ot-Tt]:0,Lt=wt[At+Ot]-Et;Pt[Rt+Ot]=Lt}}function dt(wt,At,Tt){let Pt=0,Rt=At+Tt;for(let Ot=At;Ot<Rt;Ot++){let Et=At>0?wt[Ot-Tt]:0,Lt=wt[Ot]-Et;Pt+=Math.abs(Lt)}return Pt}function ut(wt,At,Tt,Pt,Rt,Ot){for(let Et=0;Et<Tt;Et++){let Lt=Et>=Ot?wt[At+Et-Ot]:0,kt=At>0?wt[At+Et-Tt]:0,jt=wt[At+Et]-(Lt+kt>>1);Pt[Rt+Et]=jt}}function ft(wt,At,Tt,Pt){let Rt=0;for(let Ot=0;Ot<Tt;Ot++){let Et=Ot>=Pt?wt[At+Ot-Pt]:0,Lt=At>0?wt[At+Ot-Tt]:0,kt=wt[At+Ot]-(Et+Lt>>1);Rt+=Math.abs(kt)}return Rt}function mt(wt,At,Tt,Pt,Rt,Ot){for(let Et=0;Et<Tt;Et++){let Lt=Et>=Ot?wt[At+Et-Ot]:0,kt=At>0?wt[At+Et-Tt]:0,jt=At>0&&Et>=Ot?wt[At+Et-(Tt+Ot)]:0,Mt=wt[At+Et]-it(Lt,kt,jt);Pt[Rt+Et]=Mt}}function gt(wt,At,Tt,Pt){let Rt=0;for(let Ot=0;Ot<Tt;Ot++){let Et=Ot>=Pt?wt[At+Ot-Pt]:0,Lt=At>0?wt[At+Ot-Tt]:0,kt=At>0&&Ot>=Pt?wt[At+Ot-(Tt+Pt)]:0,jt=wt[At+Ot]-it(Et,Lt,kt);Rt+=Math.abs(jt)}return Rt}let vt={0:at,1:ot,2:ht,3:ut,4:mt},xt={0:st,1:lt,2:dt,3:ft,4:gt};et.exports=function(wt,At,Tt,Pt,Rt){let Ot;if("filterType"in Pt&&Pt.filterType!==-1){if(typeof Pt.filterType!="number")throw new Error("unrecognised filter types");Ot=[Pt.filterType]}else Ot=[0,1,2,3,4];Pt.bitDepth===16&&(Rt*=2);let Et=At*Rt,Lt=0,kt=0,jt=nt.alloc((Et+1)*Tt),Mt=Ot[0];for(let $t=0;$t<Tt;$t++){if(Ot.length>1){let Qt=1/0;for(let Ht=0;Ht<Ot.length;Ht++){let qt=xt[Ot[Ht]](wt,kt,Et,Rt);qt<Qt&&(Mt=Ot[Ht],Qt=qt)}}jt[Lt]=Mt,Lt++,vt[Mt](wt,kt,Et,jt,Lt,Rt),Lt+=Et,kt+=Et}return jt}}).call(this)}).call(this,tt("buffer").Buffer)},{"./paeth-predictor":15,buffer:32}],7:[function(tt,et,rt){(function(nt){(function(){let it=tt("util"),at=tt("./chunkstream"),st=tt("./filter-parse"),ot=et.exports=function(lt){at.call(this);let ht=[],dt=this;this._filter=new st(lt,{read:this.read.bind(this),write:function(ut){ht.push(ut)},complete:function(){dt.emit("complete",nt.concat(ht))}}),this._filter.start()};it.inherits(ot,at)}).call(this)}).call(this,tt("buffer").Buffer)},{"./chunkstream":3,"./filter-parse":9,buffer:32,util:84}],8:[function(tt,et,rt){(function(nt){(function(){let it=tt("./sync-reader"),at=tt("./filter-parse");rt.process=function(st,ot){let lt=[],ht=new it(st);return new at(ot,{read:ht.read.bind(ht),write:function(dt){lt.push(dt)},complete:function(){}}).start(),ht.process(),nt.concat(lt)}}).call(this)}).call(this,tt("buffer").Buffer)},{"./filter-parse":9,"./sync-reader":22,buffer:32}],9:[function(tt,et,rt){(function(nt){(function(){let it=tt("./interlace"),at=tt("./paeth-predictor");function st(lt,ht,dt){let ut=lt*ht;return dt!==8&&(ut=Math.ceil(ut/(8/dt))),ut}let ot=et.exports=function(lt,ht){let dt=lt.width,ut=lt.height,ft=lt.interlace,mt=lt.bpp,gt=lt.depth;if(this.read=ht.read,this.write=ht.write,this.complete=ht.complete,this._imageIndex=0,this._images=[],ft){let vt=it.getImagePasses(dt,ut);for(let xt=0;xt<vt.length;xt++)this._images.push({byteWidth:st(vt[xt].width,mt,gt),height:vt[xt].height,lineIndex:0})}else this._images.push({byteWidth:st(dt,mt,gt),height:ut,lineIndex:0});this._xComparison=gt===8?mt:gt===16?2*mt:1};ot.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},ot.prototype._unFilterType1=function(lt,ht,dt){let ut=this._xComparison,ft=ut-1;for(let mt=0;mt<dt;mt++){let gt=lt[1+mt],vt=mt>ft?ht[mt-ut]:0;ht[mt]=gt+vt}},ot.prototype._unFilterType2=function(lt,ht,dt){let ut=this._lastLine;for(let ft=0;ft<dt;ft++){let mt=lt[1+ft],gt=ut?ut[ft]:0;ht[ft]=mt+gt}},ot.prototype._unFilterType3=function(lt,ht,dt){let ut=this._xComparison,ft=ut-1,mt=this._lastLine;for(let gt=0;gt<dt;gt++){let vt=lt[1+gt],xt=mt?mt[gt]:0,wt=gt>ft?ht[gt-ut]:0,At=Math.floor((wt+xt)/2);ht[gt]=vt+At}},ot.prototype._unFilterType4=function(lt,ht,dt){let ut=this._xComparison,ft=ut-1,mt=this._lastLine;for(let gt=0;gt<dt;gt++){let vt=lt[1+gt],xt=mt?mt[gt]:0,wt=gt>ft?ht[gt-ut]:0,At=gt>ft&&mt?mt[gt-ut]:0,Tt=at(wt,xt,At);ht[gt]=vt+Tt}},ot.prototype._reverseFilterLine=function(lt){let ht,dt=lt[0],ut=this._images[this._imageIndex],ft=ut.byteWidth;if(dt===0)ht=lt.slice(1,ft+1);else switch(ht=nt.alloc(ft),dt){case 1:this._unFilterType1(lt,ht,ft);break;case 2:this._unFilterType2(lt,ht,ft);break;case 3:this._unFilterType3(lt,ht,ft);break;case 4:this._unFilterType4(lt,ht,ft);break;default:throw new Error("Unrecognised filter type - "+dt)}this.write(ht),ut.lineIndex++,ut.lineIndex>=ut.height?(this._lastLine=null,this._imageIndex++,ut=this._images[this._imageIndex]):this._lastLine=ht,ut?this.read(ut.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this)}).call(this,tt("buffer").Buffer)},{"./interlace":11,"./paeth-predictor":15,buffer:32}],10:[function(tt,et,rt){(function(nt){(function(){function it(ot,lt,ht,dt,ut){let ft=0;for(let mt=0;mt<dt;mt++)for(let gt=0;gt<ht;gt++){let vt=ut[ot[ft]];if(!vt)throw new Error("index "+ot[ft]+" not in palette");for(let xt=0;xt<4;xt++)lt[ft+xt]=vt[xt];ft+=4}}function at(ot,lt,ht,dt,ut){let ft=0;for(let mt=0;mt<dt;mt++)for(let gt=0;gt<ht;gt++){let vt=!1;if(ut.length===1?ut[0]===ot[ft]&&(vt=!0):ut[0]===ot[ft]&&ut[1]===ot[ft+1]&&ut[2]===ot[ft+2]&&(vt=!0),vt)for(let xt=0;xt<4;xt++)lt[ft+xt]=0;ft+=4}}function st(ot,lt,ht,dt,ut){let ft=255,mt=Math.pow(2,ut)-1,gt=0;for(let vt=0;vt<dt;vt++)for(let xt=0;xt<ht;xt++){for(let wt=0;wt<4;wt++)lt[gt+wt]=Math.floor(ot[gt+wt]*ft/mt+.5);gt+=4}}et.exports=function(ot,lt,ht=!1){let dt=lt.depth,ut=lt.width,ft=lt.height,mt=lt.colorType,gt=lt.transColor,vt=lt.palette,xt=ot;return mt===3?it(ot,xt,ut,ft,vt):(gt&&at(ot,xt,ut,ft,gt),dt===8||ht||(dt===16&&(xt=nt.alloc(ut*ft*4)),st(ot,xt,ut,ft,dt))),xt}}).call(this)}).call(this,tt("buffer").Buffer)},{buffer:32}],11:[function(tt,et,rt){let nt=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];rt.getImagePasses=function(it,at){let st=[],ot=it%8,lt=at%8,ht=(it-ot)/8,dt=(at-lt)/8;for(let ut=0;ut<nt.length;ut++){let ft=nt[ut],mt=ht*ft.x.length,gt=dt*ft.y.length;for(let vt=0;vt<ft.x.length&&ft.x[vt]<ot;vt++)mt++;for(let vt=0;vt<ft.y.length&&ft.y[vt]<lt;vt++)gt++;mt>0&&gt>0&&st.push({width:mt,height:gt,index:ut})}return st},rt.getInterlaceIterator=function(it){return function(at,st,ot){let lt=at%nt[ot].x.length,ht=(at-lt)/nt[ot].x.length*8+nt[ot].x[lt],dt=st%nt[ot].y.length;return 4*ht+((st-dt)/nt[ot].y.length*8+nt[ot].y[dt])*it*4}}},{}],12:[function(tt,et,rt){(function(nt){(function(){let it=tt("util"),at=tt("stream"),st=tt("./constants"),ot=tt("./packer"),lt=et.exports=function(ht){at.call(this);let dt=ht||{};this._packer=new ot(dt),this._deflate=this._packer.createDeflate(),this.readable=!0};it.inherits(lt,at),lt.prototype.pack=function(ht,dt,ut,ft){this.emit("data",nt.from(st.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(dt,ut)),ft&&this.emit("data",this._packer.packGAMA(ft));let mt=this._packer.filterData(ht,dt,ut);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",(function(gt){this.emit("data",this._packer.packIDAT(gt))}).bind(this)),this._deflate.on("end",(function(){this.emit("data",this._packer.packIEND()),this.emit("end")}).bind(this)),this._deflate.end(mt)}}).call(this)}).call(this,tt("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,stream:65,util:84}],13:[function(tt,et,rt){(function(nt){(function(){let it=!0,at=tt("zlib");at.deflateSync||(it=!1);let st=tt("./constants"),ot=tt("./packer");et.exports=function(lt,ht){if(!it)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let dt=new ot(ht||{}),ut=[];ut.push(nt.from(st.PNG_SIGNATURE)),ut.push(dt.packIHDR(lt.width,lt.height)),lt.gamma&&ut.push(dt.packGAMA(lt.gamma));let ft=dt.filterData(lt.data,lt.width,lt.height),mt=at.deflateSync(ft,dt.getDeflateOptions());if(ft=null,!mt||!mt.length)throw new Error("bad png - invalid compressed data response");return ut.push(dt.packIDAT(mt)),ut.push(dt.packIEND()),nt.concat(ut)}}).call(this)}).call(this,tt("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,zlib:31}],14:[function(tt,et,rt){(function(nt){(function(){let it=tt("./constants"),at=tt("./crc"),st=tt("./bitpacker"),ot=tt("./filter-pack"),lt=tt("zlib"),ht=et.exports=function(dt){if(this._options=dt,dt.deflateChunkSize=dt.deflateChunkSize||32768,dt.deflateLevel=dt.deflateLevel!=null?dt.deflateLevel:9,dt.deflateStrategy=dt.deflateStrategy!=null?dt.deflateStrategy:3,dt.inputHasAlpha=dt.inputHasAlpha==null||dt.inputHasAlpha,dt.deflateFactory=dt.deflateFactory||lt.createDeflate,dt.bitDepth=dt.bitDepth||8,dt.colorType=typeof dt.colorType=="number"?dt.colorType:it.COLORTYPE_COLOR_ALPHA,dt.inputColorType=typeof dt.inputColorType=="number"?dt.inputColorType:it.COLORTYPE_COLOR_ALPHA,[it.COLORTYPE_GRAYSCALE,it.COLORTYPE_COLOR,it.COLORTYPE_COLOR_ALPHA,it.COLORTYPE_ALPHA].indexOf(dt.colorType)===-1)throw new Error("option color type:"+dt.colorType+" is not supported at present");if([it.COLORTYPE_GRAYSCALE,it.COLORTYPE_COLOR,it.COLORTYPE_COLOR_ALPHA,it.COLORTYPE_ALPHA].indexOf(dt.inputColorType)===-1)throw new Error("option input color type:"+dt.inputColorType+" is not supported at present");if(dt.bitDepth!==8&&dt.bitDepth!==16)throw new Error("option bit depth:"+dt.bitDepth+" is not supported at present")};ht.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},ht.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},ht.prototype.filterData=function(dt,ut,ft){let mt=st(dt,ut,ft,this._options),gt=it.COLORTYPE_TO_BPP_MAP[this._options.colorType];return ot(mt,ut,ft,this._options,gt)},ht.prototype._packChunk=function(dt,ut){let ft=ut?ut.length:0,mt=nt.alloc(ft+12);return mt.writeUInt32BE(ft,0),mt.writeUInt32BE(dt,4),ut&&ut.copy(mt,8),mt.writeInt32BE(at.crc32(mt.slice(4,mt.length-4)),mt.length-4),mt},ht.prototype.packGAMA=function(dt){let ut=nt.alloc(4);return ut.writeUInt32BE(Math.floor(dt*it.GAMMA_DIVISION),0),this._packChunk(it.TYPE_gAMA,ut)},ht.prototype.packIHDR=function(dt,ut){let ft=nt.alloc(13);return ft.writeUInt32BE(dt,0),ft.writeUInt32BE(ut,4),ft[8]=this._options.bitDepth,ft[9]=this._options.colorType,ft[10]=0,ft[11]=0,ft[12]=0,this._packChunk(it.TYPE_IHDR,ft)},ht.prototype.packIDAT=function(dt){return this._packChunk(it.TYPE_IDAT,dt)},ht.prototype.packIEND=function(){return this._packChunk(it.TYPE_IEND,null)}}).call(this)}).call(this,tt("buffer").Buffer)},{"./bitpacker":2,"./constants":4,"./crc":5,"./filter-pack":6,buffer:32,zlib:31}],15:[function(tt,et,rt){et.exports=function(nt,it,at){let st=nt+it-at,ot=Math.abs(st-nt),lt=Math.abs(st-it),ht=Math.abs(st-at);return ot<=lt&&ot<=ht?nt:lt<=ht?it:at}},{}],16:[function(tt,et,rt){let nt=tt("util"),it=tt("zlib"),at=tt("./chunkstream"),st=tt("./filter-parse-async"),ot=tt("./parser"),lt=tt("./bitmapper"),ht=tt("./format-normaliser"),dt=et.exports=function(ut){at.call(this),this._parser=new ot(ut,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=ut,this.writable=!0,this._parser.start()};nt.inherits(dt,at),dt.prototype._handleError=function(ut){this.emit("error",ut),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},dt.prototype._inflateData=function(ut){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=it.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let ft=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,mt=Math.max(ft,it.Z_MIN_CHUNK);this._inflate=it.createInflate({chunkSize:mt});let gt=ft,vt=this.emit.bind(this,"error");this._inflate.on("error",(function(wt){gt&&vt(wt)})),this._filter.on("complete",this._complete.bind(this));let xt=this._filter.write.bind(this._filter);this._inflate.on("data",(function(wt){gt&&(wt.length>gt&&(wt=wt.slice(0,gt)),gt-=wt.length,xt(wt))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(ut)},dt.prototype._handleMetaData=function(ut){this._metaData=ut,this._bitmapInfo=Object.create(ut),this._filter=new st(this._bitmapInfo)},dt.prototype._handleTransColor=function(ut){this._bitmapInfo.transColor=ut},dt.prototype._handlePalette=function(ut){this._bitmapInfo.palette=ut},dt.prototype._simpleTransparency=function(){this._metaData.alpha=!0},dt.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},dt.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},dt.prototype._complete=function(ut){if(this.errord)return;let ft;try{let mt=lt.dataToBitMap(ut,this._bitmapInfo);ft=ht(mt,this._bitmapInfo,this._options.skipRescale),mt=null}catch(mt){return void this._handleError(mt)}this.emit("parsed",ft)}},{"./bitmapper":1,"./chunkstream":3,"./filter-parse-async":7,"./format-normaliser":10,"./parser":18,util:84,zlib:31}],17:[function(tt,et,rt){(function(nt){(function(){let it=!0,at=tt("zlib"),st=tt("./sync-inflate");at.deflateSync||(it=!1);let ot=tt("./sync-reader"),lt=tt("./filter-parse-sync"),ht=tt("./parser"),dt=tt("./bitmapper"),ut=tt("./format-normaliser");et.exports=function(ft,mt){if(!it)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let gt,vt,xt;function wt(qt){gt=qt}function At(qt){vt=qt}function Tt(qt){vt.transColor=qt}function Pt(qt){vt.palette=qt}function Rt(){vt.alpha=!0}function Ot(qt){xt=qt}let Et=[];function Lt(qt){Et.push(qt)}let kt=new ot(ft);if(new ht(mt,{read:kt.read.bind(kt),error:wt,metadata:At,gamma:Ot,palette:Pt,transColor:Tt,inflateData:Lt,simpleTransparency:Rt}).start(),kt.process(),gt)throw gt;let jt,Mt=nt.concat(Et);if(Et.length=0,vt.interlace)jt=at.inflateSync(Mt);else{let qt=(1+(vt.width*vt.bpp*vt.depth+7>>3))*vt.height;jt=st(Mt,{chunkSize:qt,maxLength:qt})}if(Mt=null,!jt||!jt.length)throw new Error("bad png - invalid inflate data response");let $t=lt.process(jt,vt);Mt=null;let Qt=dt.dataToBitMap($t,vt);$t=null;let Ht=ut(Qt,vt,mt.skipRescale);return vt.data=Ht,vt.gamma=xt||0,vt}}).call(this)}).call(this,tt("buffer").Buffer)},{"./bitmapper":1,"./filter-parse-sync":8,"./format-normaliser":10,"./parser":18,"./sync-inflate":21,"./sync-reader":22,buffer:32,zlib:31}],18:[function(tt,et,rt){(function(nt){(function(){let it=tt("./constants"),at=tt("./crc"),st=et.exports=function(ot,lt){this._options=ot,ot.checkCRC=ot.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[it.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[it.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[it.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[it.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[it.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[it.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=lt.read,this.error=lt.error,this.metadata=lt.metadata,this.gamma=lt.gamma,this.transColor=lt.transColor,this.palette=lt.palette,this.parsed=lt.parsed,this.inflateData=lt.inflateData,this.finished=lt.finished,this.simpleTransparency=lt.simpleTransparency,this.headersFinished=lt.headersFinished||function(){}};st.prototype.start=function(){this.read(it.PNG_SIGNATURE.length,this._parseSignature.bind(this))},st.prototype._parseSignature=function(ot){let lt=it.PNG_SIGNATURE;for(let ht=0;ht<lt.length;ht++)if(ot[ht]!==lt[ht])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},st.prototype._parseChunkBegin=function(ot){let lt=ot.readUInt32BE(0),ht=ot.readUInt32BE(4),dt="";for(let ft=4;ft<8;ft++)dt+=String.fromCharCode(ot[ft]);let ut=!!(32&ot[4]);if(this._hasIHDR||ht===it.TYPE_IHDR){if(this._crc=new at,this._crc.write(nt.from(dt)),this._chunks[ht])return this._chunks[ht](lt);ut?this.read(lt+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+dt))}else this.error(new Error("Expected IHDR on beggining"))},st.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},st.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},st.prototype._parseChunkEnd=function(ot){let lt=ot.readInt32BE(0),ht=this._crc.crc32();this._options.checkCRC&&ht!==lt?this.error(new Error("Crc error - "+lt+" - "+ht)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},st.prototype._handleIHDR=function(ot){this.read(ot,this._parseIHDR.bind(this))},st.prototype._parseIHDR=function(ot){this._crc.write(ot);let lt=ot.readUInt32BE(0),ht=ot.readUInt32BE(4),dt=ot[8],ut=ot[9],ft=ot[10],mt=ot[11],gt=ot[12];if(dt!==8&&dt!==4&&dt!==2&&dt!==1&&dt!==16)return void this.error(new Error("Unsupported bit depth "+dt));if(!(ut in it.COLORTYPE_TO_BPP_MAP))return void this.error(new Error("Unsupported color type"));if(ft!==0)return void this.error(new Error("Unsupported compression method"));if(mt!==0)return void this.error(new Error("Unsupported filter method"));if(gt!==0&&gt!==1)return void this.error(new Error("Unsupported interlace method"));this._colorType=ut;let vt=it.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:lt,height:ht,depth:dt,interlace:!!gt,palette:!!(ut&it.COLORTYPE_PALETTE),color:!!(ut&it.COLORTYPE_COLOR),alpha:!!(ut&it.COLORTYPE_ALPHA),bpp:vt,colorType:ut}),this._handleChunkEnd()},st.prototype._handlePLTE=function(ot){this.read(ot,this._parsePLTE.bind(this))},st.prototype._parsePLTE=function(ot){this._crc.write(ot);let lt=Math.floor(ot.length/3);for(let ht=0;ht<lt;ht++)this._palette.push([ot[3*ht],ot[3*ht+1],ot[3*ht+2],255]);this.palette(this._palette),this._handleChunkEnd()},st.prototype._handleTRNS=function(ot){this.simpleTransparency(),this.read(ot,this._parseTRNS.bind(this))},st.prototype._parseTRNS=function(ot){if(this._crc.write(ot),this._colorType===it.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0)return void this.error(new Error("Transparency chunk must be after palette"));if(ot.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(let lt=0;lt<ot.length;lt++)this._palette[lt][3]=ot[lt];this.palette(this._palette)}this._colorType===it.COLORTYPE_GRAYSCALE&&this.transColor([ot.readUInt16BE(0)]),this._colorType===it.COLORTYPE_COLOR&&this.transColor([ot.readUInt16BE(0),ot.readUInt16BE(2),ot.readUInt16BE(4)]),this._handleChunkEnd()},st.prototype._handleGAMA=function(ot){this.read(ot,this._parseGAMA.bind(this))},st.prototype._parseGAMA=function(ot){this._crc.write(ot),this.gamma(ot.readUInt32BE(0)/it.GAMMA_DIVISION),this._handleChunkEnd()},st.prototype._handleIDAT=function(ot){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-ot,this._parseIDAT.bind(this,ot))},st.prototype._parseIDAT=function(ot,lt){if(this._crc.write(lt),this._colorType===it.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(lt);let ht=ot-lt.length;ht>0?this._handleIDAT(ht):this._handleChunkEnd()},st.prototype._handleIEND=function(ot){this.read(ot,this._parseIEND.bind(this))},st.prototype._parseIEND=function(ot){this._crc.write(ot),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this)}).call(this,tt("buffer").Buffer)},{"./constants":4,"./crc":5,buffer:32}],19:[function(tt,et,rt){let nt=tt("./parser-sync"),it=tt("./packer-sync");rt.read=function(at,st){return nt(at,st||{})},rt.write=function(at,st){return it(at,st)}},{"./packer-sync":13,"./parser-sync":17}],20:[function(tt,et,rt){(function(nt,it){(function(){let at=tt("util"),st=tt("stream"),ot=tt("./parser-async"),lt=tt("./packer-async"),ht=tt("./png-sync"),dt=rt.PNG=function(ut){st.call(this),ut=ut||{},this.width=0|ut.width,this.height=0|ut.height,this.data=this.width>0&&this.height>0?it.alloc(4*this.width*this.height):null,ut.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new ot(ut),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",(function(ft){this.data=ft,this.emit("parsed",ft)}).bind(this)),this._packer=new lt(ut),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};at.inherits(dt,st),dt.sync=ht,dt.prototype.pack=function(){return this.data&&this.data.length?(nt.nextTick((function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}).bind(this)),this):(this.emit("error","No data provided"),this)},dt.prototype.parse=function(ut,ft){if(ft){let mt,gt;mt=(function(vt){this.removeListener("error",gt),this.data=vt,ft(null,this)}).bind(this),gt=(function(vt){this.removeListener("parsed",mt),ft(vt,null)}).bind(this),this.once("parsed",mt),this.once("error",gt)}return this.end(ut),this},dt.prototype.write=function(ut){return this._parser.write(ut),!0},dt.prototype.end=function(ut){this._parser.end(ut)},dt.prototype._metadata=function(ut){this.width=ut.width,this.height=ut.height,this.emit("metadata",ut)},dt.prototype._gamma=function(ut){this.gamma=ut},dt.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},dt.bitblt=function(ut,ft,mt,gt,vt,xt,wt,At){if(gt|=0,vt|=0,xt|=0,wt|=0,At|=0,(mt|=0)>ut.width||gt>ut.height||mt+vt>ut.width||gt+xt>ut.height)throw new Error("bitblt reading outside image");if(wt>ft.width||At>ft.height||wt+vt>ft.width||At+xt>ft.height)throw new Error("bitblt writing outside image");for(let Tt=0;Tt<xt;Tt++)ut.data.copy(ft.data,(At+Tt)*ft.width+wt<<2,(gt+Tt)*ut.width+mt<<2,(gt+Tt)*ut.width+mt+vt<<2)},dt.prototype.bitblt=function(ut,ft,mt,gt,vt,xt,wt){return dt.bitblt(this,ut,ft,mt,gt,vt,xt,wt),this},dt.adjustGamma=function(ut){if(ut.gamma){for(let ft=0;ft<ut.height;ft++)for(let mt=0;mt<ut.width;mt++){let gt=ut.width*ft+mt<<2;for(let vt=0;vt<3;vt++){let xt=ut.data[gt+vt]/255;xt=Math.pow(xt,1/2.2/ut.gamma),ut.data[gt+vt]=Math.round(255*xt)}}ut.gamma=0}},dt.prototype.adjustGamma=function(){dt.adjustGamma(this)}}).call(this)}).call(this,tt("_process"),tt("buffer").Buffer)},{"./packer-async":12,"./parser-async":16,"./png-sync":19,_process:63,buffer:32,stream:65,util:84}],21:[function(tt,et,rt){(function(nt,it){(function(){let at=tt("assert").ok,st=tt("zlib"),ot=tt("util"),lt=tt("buffer").kMaxLength;function ht(gt){if(!(this instanceof ht))return new ht(gt);gt&&gt.chunkSize<st.Z_MIN_CHUNK&&(gt.chunkSize=st.Z_MIN_CHUNK),st.Inflate.call(this,gt),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,gt&&gt.maxLength!=null&&(this._maxLength=gt.maxLength)}function dt(gt){return new ht(gt)}function ut(gt,vt){gt._handle&&(gt._handle.close(),gt._handle=null)}function ft(gt,vt){if(typeof vt=="string"&&(vt=it.from(vt)),!(vt instanceof it))throw new TypeError("Not a string or buffer");let xt=gt._finishFlushFlag;return xt==null&&(xt=st.Z_FINISH),gt._processChunk(vt,xt)}function mt(gt,vt){return ft(new ht(vt),gt)}ht.prototype._processChunk=function(gt,vt,xt){if(typeof xt=="function")return st.Inflate._processChunk.call(this,gt,vt,xt);let wt,At,Tt=this,Pt=gt&&gt.length,Rt=this._chunkSize-this._offset,Ot=this._maxLength,Et=0,Lt=[],kt=0;function jt($t,Qt){if(Tt._hadError)return;let Ht=Rt-Qt;if(at(Ht>=0,"have should not go down"),Ht>0){let qt=Tt._buffer.slice(Tt._offset,Tt._offset+Ht);if(Tt._offset+=Ht,qt.length>Ot&&(qt=qt.slice(0,Ot)),Lt.push(qt),kt+=qt.length,Ot-=qt.length,Ot===0)return!1}return(Qt===0||Tt._offset>=Tt._chunkSize)&&(Rt=Tt._chunkSize,Tt._offset=0,Tt._buffer=it.allocUnsafe(Tt._chunkSize)),Qt===0&&(Et+=Pt-$t,Pt=$t,!0)}this.on("error",(function($t){wt=$t})),at(this._handle,"zlib binding closed");do At=this._handle.writeSync(vt,gt,Et,Pt,this._buffer,this._offset,Rt),At=At||this._writeState;while(!this._hadError&&jt(At[0],At[1]));if(this._hadError)throw wt;if(kt>=lt)throw ut(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+lt.toString(16)+" bytes");let Mt=it.concat(Lt,kt);return ut(this),Mt},ot.inherits(ht,st.Inflate),et.exports=rt=mt,rt.Inflate=ht,rt.createInflate=dt,rt.inflateSync=mt}).call(this)}).call(this,tt("_process"),tt("buffer").Buffer)},{_process:63,assert:23,buffer:32,util:84,zlib:31}],22:[function(tt,et,rt){let nt=et.exports=function(it){this._buffer=it,this._reads=[]};nt.prototype.read=function(it,at){this._reads.push({length:Math.abs(it),allowLess:it<0,func:at})},nt.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let it=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=it.length||it.allowLess))break;{this._reads.shift();let at=this._buffer;this._buffer=at.slice(it.length),it.func.call(this,at.slice(0,it.length))}}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}},{}],23:[function(tt,et,rt){(function(nt){(function(){var it=tt("object-assign");function at(Ht,qt){if(Ht===qt)return 0;for(var Bt=Ht.length,Xt=qt.length,Ft=0,Wt=Math.min(Bt,Xt);Ft<Wt;++Ft)if(Ht[Ft]!==qt[Ft]){Bt=Ht[Ft],Xt=qt[Ft];break}return Bt<Xt?-1:Xt<Bt?1:0}function st(Ht){return nt.Buffer&&typeof nt.Buffer.isBuffer=="function"?nt.Buffer.isBuffer(Ht):!(Ht==null||!Ht._isBuffer)}var ot=tt("util/"),lt=Object.prototype.hasOwnProperty,ht=Array.prototype.slice,dt=(function(){}).name==="foo";function ut(Ht){return Object.prototype.toString.call(Ht)}function ft(Ht){return!st(Ht)&&typeof nt.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Ht):!!Ht&&(Ht instanceof DataView||!!(Ht.buffer&&Ht.buffer instanceof ArrayBuffer)))}var mt=et.exports=Pt,gt=/\s*function\s+([^\(\s]*)\s*/;function vt(Ht){if(ot.isFunction(Ht)){if(dt)return Ht.name;var qt=Ht.toString().match(gt);return qt&&qt[1]}}function xt(Ht,qt){return typeof Ht=="string"?Ht.length<qt?Ht:Ht.slice(0,qt):Ht}function wt(Ht){if(dt||!ot.isFunction(Ht))return ot.inspect(Ht);var qt=vt(Ht);return"[Function"+(qt?": "+qt:"")+"]"}function At(Ht){return xt(wt(Ht.actual),128)+" "+Ht.operator+" "+xt(wt(Ht.expected),128)}function Tt(Ht,qt,Bt,Xt,Ft){throw new mt.AssertionError({message:Bt,actual:Ht,expected:qt,operator:Xt,stackStartFunction:Ft})}function Pt(Ht,qt){Ht||Tt(Ht,!0,qt,"==",mt.ok)}function Rt(Ht,qt,Bt,Xt){if(Ht===qt)return!0;if(st(Ht)&&st(qt))return at(Ht,qt)===0;if(ot.isDate(Ht)&&ot.isDate(qt))return Ht.getTime()===qt.getTime();if(ot.isRegExp(Ht)&&ot.isRegExp(qt))return Ht.source===qt.source&&Ht.global===qt.global&&Ht.multiline===qt.multiline&&Ht.lastIndex===qt.lastIndex&&Ht.ignoreCase===qt.ignoreCase;if(Ht!==null&&typeof Ht=="object"||qt!==null&&typeof qt=="object"){if(ft(Ht)&&ft(qt)&&ut(Ht)===ut(qt)&&!(Ht instanceof Float32Array||Ht instanceof Float64Array))return at(new Uint8Array(Ht.buffer),new Uint8Array(qt.buffer))===0;if(st(Ht)!==st(qt))return!1;var Ft=(Xt=Xt||{actual:[],expected:[]}).actual.indexOf(Ht);return Ft!==-1&&Ft===Xt.expected.indexOf(qt)||(Xt.actual.push(Ht),Xt.expected.push(qt),Et(Ht,qt,Bt,Xt))}return Bt?Ht===qt:Ht==qt}function Ot(Ht){return Object.prototype.toString.call(Ht)=="[object Arguments]"}function Et(Ht,qt,Bt,Xt){if(Ht==null||qt==null)return!1;if(ot.isPrimitive(Ht)||ot.isPrimitive(qt))return Ht===qt;if(Bt&&Object.getPrototypeOf(Ht)!==Object.getPrototypeOf(qt))return!1;var Ft=Ot(Ht),Wt=Ot(qt);if(Ft&&!Wt||!Ft&&Wt)return!1;if(Ft)return Rt(Ht=ht.call(Ht),qt=ht.call(qt),Bt);var Yt,zt,er=Qt(Ht),dr=Qt(qt);if(er.length!==dr.length)return!1;for(er.sort(),dr.sort(),zt=er.length-1;zt>=0;zt--)if(er[zt]!==dr[zt])return!1;for(zt=er.length-1;zt>=0;zt--)if(!Rt(Ht[Yt=er[zt]],qt[Yt],Bt,Xt))return!1;return!0}function Lt(Ht,qt,Bt){Rt(Ht,qt,!0)&&Tt(Ht,qt,Bt,"notDeepStrictEqual",Lt)}function kt(Ht,qt){if(!Ht||!qt)return!1;if(Object.prototype.toString.call(qt)=="[object RegExp]")return qt.test(Ht);try{if(Ht instanceof qt)return!0}catch{}return!Error.isPrototypeOf(qt)&&qt.call({},Ht)===!0}function jt(Ht){var qt;try{Ht()}catch(Bt){qt=Bt}return qt}function Mt(Ht,qt,Bt,Xt){var Ft;if(typeof qt!="function")throw new TypeError('"block" argument must be a function');typeof Bt=="string"&&(Xt=Bt,Bt=null),Ft=jt(qt),Xt=(Bt&&Bt.name?" ("+Bt.name+").":".")+(Xt?" "+Xt:"."),Ht&&!Ft&&Tt(Ft,Bt,"Missing expected exception"+Xt);var Wt=typeof Xt=="string",Yt=!Ht&&Ft&&!Bt;if((!Ht&&ot.isError(Ft)&&Wt&&kt(Ft,Bt)||Yt)&&Tt(Ft,Bt,"Got unwanted exception"+Xt),Ht&&Ft&&Bt&&!kt(Ft,Bt)||!Ht&&Ft)throw Ft}function $t(Ht,qt){Ht||Tt(Ht,!0,qt,"==",$t)}mt.AssertionError=function(Ht){this.name="AssertionError",this.actual=Ht.actual,this.expected=Ht.expected,this.operator=Ht.operator,Ht.message?(this.message=Ht.message,this.generatedMessage=!1):(this.message=At(this),this.generatedMessage=!0);var qt=Ht.stackStartFunction||Tt;if(Error.captureStackTrace)Error.captureStackTrace(this,qt);else{var Bt=new Error;if(Bt.stack){var Xt=Bt.stack,Ft=vt(qt),Wt=Xt.indexOf(`
`+Ft);if(Wt>=0){var Yt=Xt.indexOf(`
`,Wt+1);Xt=Xt.substring(Yt+1)}this.stack=Xt}}},ot.inherits(mt.AssertionError,Error),mt.fail=Tt,mt.ok=Pt,mt.equal=function(Ht,qt,Bt){Ht!=qt&&Tt(Ht,qt,Bt,"==",mt.equal)},mt.notEqual=function(Ht,qt,Bt){Ht==qt&&Tt(Ht,qt,Bt,"!=",mt.notEqual)},mt.deepEqual=function(Ht,qt,Bt){Rt(Ht,qt,!1)||Tt(Ht,qt,Bt,"deepEqual",mt.deepEqual)},mt.deepStrictEqual=function(Ht,qt,Bt){Rt(Ht,qt,!0)||Tt(Ht,qt,Bt,"deepStrictEqual",mt.deepStrictEqual)},mt.notDeepEqual=function(Ht,qt,Bt){Rt(Ht,qt,!1)&&Tt(Ht,qt,Bt,"notDeepEqual",mt.notDeepEqual)},mt.notDeepStrictEqual=Lt,mt.strictEqual=function(Ht,qt,Bt){Ht!==qt&&Tt(Ht,qt,Bt,"===",mt.strictEqual)},mt.notStrictEqual=function(Ht,qt,Bt){Ht===qt&&Tt(Ht,qt,Bt,"!==",mt.notStrictEqual)},mt.throws=function(Ht,qt,Bt){Mt(!0,Ht,qt,Bt)},mt.doesNotThrow=function(Ht,qt,Bt){Mt(!1,Ht,qt,Bt)},mt.ifError=function(Ht){if(Ht)throw Ht},mt.strict=it($t,mt,{equal:mt.strictEqual,deepEqual:mt.deepStrictEqual,notEqual:mt.notStrictEqual,notDeepEqual:mt.notDeepStrictEqual}),mt.strict.strict=mt.strict;var Qt=Object.keys||function(Ht){var qt=[];for(var Bt in Ht)lt.call(Ht,Bt)&&qt.push(Bt);return qt}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":51,"util/":26}],24:[function(tt,et,rt){typeof Object.create=="function"?et.exports=function(nt,it){nt.super_=it,nt.prototype=Object.create(it.prototype,{constructor:{value:nt,enumerable:!1,writable:!0,configurable:!0}})}:et.exports=function(nt,it){nt.super_=it;var at=function(){};at.prototype=it.prototype,nt.prototype=new at,nt.prototype.constructor=nt}},{}],25:[function(tt,et,rt){et.exports=function(nt){return nt&&typeof nt=="object"&&typeof nt.copy=="function"&&typeof nt.fill=="function"&&typeof nt.readUInt8=="function"}},{}],26:[function(tt,et,rt){(function(nt,it){(function(){var at=/%[sdj%]/g;rt.format=function(zt){if(!Et(zt)){for(var er=[],dr=0;dr<arguments.length;dr++)er.push(lt(arguments[dr]));return er.join(" ")}dr=1;for(var fr=arguments,lr=fr.length,mr=String(zt).replace(at,(function(Sr){if(Sr==="%%")return"%";if(dr>=lr)return Sr;switch(Sr){case"%s":return String(fr[dr++]);case"%d":return Number(fr[dr++]);case"%j":try{return JSON.stringify(fr[dr++])}catch{return"[Circular]"}default:return Sr}})),br=fr[dr];dr<lr;br=fr[++dr])Pt(br)||!Mt(br)?mr+=" "+br:mr+=" "+lt(br);return mr},rt.deprecate=function(zt,er){if(kt(it.process))return function(){return rt.deprecate(zt,er).apply(this,arguments)};if(nt.noDeprecation===!0)return zt;var dr=!1;function fr(){if(!dr){if(nt.throwDeprecation)throw new Error(er);nt.traceDeprecation?console.trace(er):console.error(er),dr=!0}return zt.apply(this,arguments)}return fr};var st,ot={};function lt(zt,er){var dr={seen:[],stylize:dt};return arguments.length>=3&&(dr.depth=arguments[2]),arguments.length>=4&&(dr.colors=arguments[3]),Tt(er)?dr.showHidden=er:er&&rt._extend(dr,er),kt(dr.showHidden)&&(dr.showHidden=!1),kt(dr.depth)&&(dr.depth=2),kt(dr.colors)&&(dr.colors=!1),kt(dr.customInspect)&&(dr.customInspect=!0),dr.colors&&(dr.stylize=ht),ft(dr,zt,dr.depth)}function ht(zt,er){var dr=lt.styles[er];return dr?"\x1B["+lt.colors[dr][0]+"m"+zt+"\x1B["+lt.colors[dr][1]+"m":zt}function dt(zt,er){return zt}function ut(zt){var er={};return zt.forEach((function(dr,fr){er[dr]=!0})),er}function ft(zt,er,dr){if(zt.customInspect&&er&&Ht(er.inspect)&&er.inspect!==rt.inspect&&(!er.constructor||er.constructor.prototype!==er)){var fr=er.inspect(dr,zt);return Et(fr)||(fr=ft(zt,fr,dr)),fr}var lr=mt(zt,er);if(lr)return lr;var mr=Object.keys(er),br=ut(mr);if(zt.showHidden&&(mr=Object.getOwnPropertyNames(er)),Qt(er)&&(mr.indexOf("message")>=0||mr.indexOf("description")>=0))return gt(er);if(mr.length===0){if(Ht(er)){var Sr=er.name?": "+er.name:"";return zt.stylize("[Function"+Sr+"]","special")}if(jt(er))return zt.stylize(RegExp.prototype.toString.call(er),"regexp");if($t(er))return zt.stylize(Date.prototype.toString.call(er),"date");if(Qt(er))return gt(er)}var Ir,cr="",Nt=!1,pr=["{","}"];return At(er)&&(Nt=!0,pr=["[","]"]),Ht(er)&&(cr=" [Function"+(er.name?": "+er.name:"")+"]"),jt(er)&&(cr=" "+RegExp.prototype.toString.call(er)),$t(er)&&(cr=" "+Date.prototype.toUTCString.call(er)),Qt(er)&&(cr=" "+gt(er)),mr.length!==0||Nt&&er.length!=0?dr<0?jt(er)?zt.stylize(RegExp.prototype.toString.call(er),"regexp"):zt.stylize("[Object]","special"):(zt.seen.push(er),Ir=Nt?vt(zt,er,dr,br,mr):mr.map((function(rr){return xt(zt,er,dr,br,rr,Nt)})),zt.seen.pop(),wt(Ir,cr,pr)):pr[0]+cr+pr[1]}function mt(zt,er){if(kt(er))return zt.stylize("undefined","undefined");if(Et(er)){var dr="'"+JSON.stringify(er).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return zt.stylize(dr,"string")}return Ot(er)?zt.stylize(""+er,"number"):Tt(er)?zt.stylize(""+er,"boolean"):Pt(er)?zt.stylize("null","null"):void 0}function gt(zt){return"["+Error.prototype.toString.call(zt)+"]"}function vt(zt,er,dr,fr,lr){for(var mr=[],br=0,Sr=er.length;br<Sr;++br)Yt(er,String(br))?mr.push(xt(zt,er,dr,fr,String(br),!0)):mr.push("");return lr.forEach((function(Ir){Ir.match(/^\d+$/)||mr.push(xt(zt,er,dr,fr,Ir,!0))})),mr}function xt(zt,er,dr,fr,lr,mr){var br,Sr,Ir;if((Ir=Object.getOwnPropertyDescriptor(er,lr)||{value:er[lr]}).get?Sr=Ir.set?zt.stylize("[Getter/Setter]","special"):zt.stylize("[Getter]","special"):Ir.set&&(Sr=zt.stylize("[Setter]","special")),Yt(fr,lr)||(br="["+lr+"]"),Sr||(zt.seen.indexOf(Ir.value)<0?(Sr=Pt(dr)?ft(zt,Ir.value,null):ft(zt,Ir.value,dr-1)).indexOf(`
`)>-1&&(Sr=mr?Sr.split(`
`).map((function(cr){return"  "+cr})).join(`
`).substr(2):`
`+Sr.split(`
`).map((function(cr){return"   "+cr})).join(`
`)):Sr=zt.stylize("[Circular]","special")),kt(br)){if(mr&&lr.match(/^\d+$/))return Sr;(br=JSON.stringify(""+lr)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(br=br.substr(1,br.length-2),br=zt.stylize(br,"name")):(br=br.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),br=zt.stylize(br,"string"))}return br+": "+Sr}function wt(zt,er,dr){return zt.reduce((function(fr,lr){return lr.indexOf(`
`),fr+lr.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?dr[0]+(er===""?"":er+`
 `)+" "+zt.join(`,
  `)+" "+dr[1]:dr[0]+er+" "+zt.join(", ")+" "+dr[1]}function At(zt){return Array.isArray(zt)}function Tt(zt){return typeof zt=="boolean"}function Pt(zt){return zt===null}function Rt(zt){return zt==null}function Ot(zt){return typeof zt=="number"}function Et(zt){return typeof zt=="string"}function Lt(zt){return typeof zt=="symbol"}function kt(zt){return zt===void 0}function jt(zt){return Mt(zt)&&Bt(zt)==="[object RegExp]"}function Mt(zt){return typeof zt=="object"&&zt!==null}function $t(zt){return Mt(zt)&&Bt(zt)==="[object Date]"}function Qt(zt){return Mt(zt)&&(Bt(zt)==="[object Error]"||zt instanceof Error)}function Ht(zt){return typeof zt=="function"}function qt(zt){return zt===null||typeof zt=="boolean"||typeof zt=="number"||typeof zt=="string"||typeof zt=="symbol"||zt===void 0}function Bt(zt){return Object.prototype.toString.call(zt)}function Xt(zt){return zt<10?"0"+zt.toString(10):zt.toString(10)}rt.debuglog=function(zt){if(kt(st)&&(st=nt.env.NODE_DEBUG||""),zt=zt.toUpperCase(),!ot[zt])if(new RegExp("\\b"+zt+"\\b","i").test(st)){var er=nt.pid;ot[zt]=function(){var dr=rt.format.apply(rt,arguments);console.error("%s %d: %s",zt,er,dr)}}else ot[zt]=function(){};return ot[zt]},rt.inspect=lt,lt.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},lt.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},rt.isArray=At,rt.isBoolean=Tt,rt.isNull=Pt,rt.isNullOrUndefined=Rt,rt.isNumber=Ot,rt.isString=Et,rt.isSymbol=Lt,rt.isUndefined=kt,rt.isRegExp=jt,rt.isObject=Mt,rt.isDate=$t,rt.isError=Qt,rt.isFunction=Ht,rt.isPrimitive=qt,rt.isBuffer=tt("./support/isBuffer");var Ft=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Wt(){var zt=new Date,er=[Xt(zt.getHours()),Xt(zt.getMinutes()),Xt(zt.getSeconds())].join(":");return[zt.getDate(),Ft[zt.getMonth()],er].join(" ")}function Yt(zt,er){return Object.prototype.hasOwnProperty.call(zt,er)}rt.log=function(){console.log("%s - %s",Wt(),rt.format.apply(rt,arguments))},rt.inherits=tt("inherits"),rt._extend=function(zt,er){if(!er||!Mt(er))return zt;for(var dr=Object.keys(er),fr=dr.length;fr--;)zt[dr[fr]]=er[dr[fr]];return zt}}).call(this)}).call(this,tt("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":25,_process:63,inherits:24}],27:[function(tt,et,rt){(function(nt){(function(){var it=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],at=typeof globalThis>"u"?nt:globalThis;et.exports=function(){for(var st=[],ot=0;ot<it.length;ot++)typeof at[it[ot]]=="function"&&(st[st.length]=it[ot]);return st}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(tt,et,rt){rt.byteLength=dt,rt.toByteArray=ft,rt.fromByteArray=vt;for(var nt=[],it=[],at=typeof Uint8Array<"u"?Uint8Array:Array,st="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ot=0,lt=st.length;ot<lt;++ot)nt[ot]=st[ot],it[st.charCodeAt(ot)]=ot;function ht(xt){var wt=xt.length;if(wt%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var At=xt.indexOf("=");return At===-1&&(At=wt),[At,At===wt?0:4-At%4]}function dt(xt){var wt=ht(xt),At=wt[0],Tt=wt[1];return 3*(At+Tt)/4-Tt}function ut(xt,wt,At){return 3*(wt+At)/4-At}function ft(xt){var wt,At,Tt=ht(xt),Pt=Tt[0],Rt=Tt[1],Ot=new at(ut(xt,Pt,Rt)),Et=0,Lt=Rt>0?Pt-4:Pt;for(At=0;At<Lt;At+=4)wt=it[xt.charCodeAt(At)]<<18|it[xt.charCodeAt(At+1)]<<12|it[xt.charCodeAt(At+2)]<<6|it[xt.charCodeAt(At+3)],Ot[Et++]=wt>>16&255,Ot[Et++]=wt>>8&255,Ot[Et++]=255&wt;return Rt===2&&(wt=it[xt.charCodeAt(At)]<<2|it[xt.charCodeAt(At+1)]>>4,Ot[Et++]=255&wt),Rt===1&&(wt=it[xt.charCodeAt(At)]<<10|it[xt.charCodeAt(At+1)]<<4|it[xt.charCodeAt(At+2)]>>2,Ot[Et++]=wt>>8&255,Ot[Et++]=255&wt),Ot}function mt(xt){return nt[xt>>18&63]+nt[xt>>12&63]+nt[xt>>6&63]+nt[63&xt]}function gt(xt,wt,At){for(var Tt,Pt=[],Rt=wt;Rt<At;Rt+=3)Tt=(xt[Rt]<<16&16711680)+(xt[Rt+1]<<8&65280)+(255&xt[Rt+2]),Pt.push(mt(Tt));return Pt.join("")}function vt(xt){for(var wt,At=xt.length,Tt=At%3,Pt=[],Rt=16383,Ot=0,Et=At-Tt;Ot<Et;Ot+=Rt)Pt.push(gt(xt,Ot,Ot+Rt>Et?Et:Ot+Rt));return Tt===1?(wt=xt[At-1],Pt.push(nt[wt>>2]+nt[wt<<4&63]+"==")):Tt===2&&(wt=(xt[At-2]<<8)+xt[At-1],Pt.push(nt[wt>>10]+nt[wt>>4&63]+nt[wt<<2&63]+"=")),Pt.join("")}it[45]=62,it[95]=63},{}],29:[function(tt,et,rt){},{}],30:[function(tt,et,rt){(function(nt,it){(function(){var at=tt("assert"),st=tt("pako/lib/zlib/zstream"),ot=tt("pako/lib/zlib/deflate.js"),lt=tt("pako/lib/zlib/inflate.js"),ht=tt("pako/lib/zlib/constants");for(var dt in ht)rt[dt]=ht[dt];rt.NONE=0,rt.DEFLATE=1,rt.INFLATE=2,rt.GZIP=3,rt.GUNZIP=4,rt.DEFLATERAW=5,rt.INFLATERAW=6,rt.UNZIP=7;var ut=31,ft=139;function mt(gt){if(typeof gt!="number"||gt<rt.DEFLATE||gt>rt.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=gt,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}mt.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,at(this.init_done,"close before init"),at(this.mode<=rt.UNZIP),this.mode===rt.DEFLATE||this.mode===rt.GZIP||this.mode===rt.DEFLATERAW?ot.deflateEnd(this.strm):this.mode!==rt.INFLATE&&this.mode!==rt.GUNZIP&&this.mode!==rt.INFLATERAW&&this.mode!==rt.UNZIP||lt.inflateEnd(this.strm),this.mode=rt.NONE,this.dictionary=null)},mt.prototype.write=function(gt,vt,xt,wt,At,Tt,Pt){return this._write(!0,gt,vt,xt,wt,At,Tt,Pt)},mt.prototype.writeSync=function(gt,vt,xt,wt,At,Tt,Pt){return this._write(!1,gt,vt,xt,wt,At,Tt,Pt)},mt.prototype._write=function(gt,vt,xt,wt,At,Tt,Pt,Rt){if(at.equal(arguments.length,8),at(this.init_done,"write before init"),at(this.mode!==rt.NONE,"already finalized"),at.equal(!1,this.write_in_progress,"write already in progress"),at.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,at.equal(!1,vt===void 0,"must provide flush value"),this.write_in_progress=!0,vt!==rt.Z_NO_FLUSH&&vt!==rt.Z_PARTIAL_FLUSH&&vt!==rt.Z_SYNC_FLUSH&&vt!==rt.Z_FULL_FLUSH&&vt!==rt.Z_FINISH&&vt!==rt.Z_BLOCK)throw new Error("Invalid flush value");if(xt==null&&(xt=it.alloc(0),At=0,wt=0),this.strm.avail_in=At,this.strm.input=xt,this.strm.next_in=wt,this.strm.avail_out=Rt,this.strm.output=Tt,this.strm.next_out=Pt,this.flush=vt,!gt)return this._process(),this._checkError()?this._afterSync():void 0;var Ot=this;return nt.nextTick((function(){Ot._process(),Ot._after()})),this},mt.prototype._afterSync=function(){var gt=this.strm.avail_out,vt=this.strm.avail_in;return this.write_in_progress=!1,[vt,gt]},mt.prototype._process=function(){var gt=null;switch(this.mode){case rt.DEFLATE:case rt.GZIP:case rt.DEFLATERAW:this.err=ot.deflate(this.strm,this.flush);break;case rt.UNZIP:switch(this.strm.avail_in>0&&(gt=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(gt===null)break;if(this.strm.input[gt]!==ut){this.mode=rt.INFLATE;break}if(this.gzip_id_bytes_read=1,gt++,this.strm.avail_in===1)break;case 1:if(gt===null)break;this.strm.input[gt]===ft?(this.gzip_id_bytes_read=2,this.mode=rt.GUNZIP):this.mode=rt.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case rt.INFLATE:case rt.GUNZIP:case rt.INFLATERAW:for(this.err=lt.inflate(this.strm,this.flush),this.err===rt.Z_NEED_DICT&&this.dictionary&&(this.err=lt.inflateSetDictionary(this.strm,this.dictionary),this.err===rt.Z_OK?this.err=lt.inflate(this.strm,this.flush):this.err===rt.Z_DATA_ERROR&&(this.err=rt.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===rt.GUNZIP&&this.err===rt.Z_STREAM_END&&this.strm.next_in[0]!==0;)this.reset(),this.err=lt.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},mt.prototype._checkError=function(){switch(this.err){case rt.Z_OK:case rt.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===rt.Z_FINISH)return this._error("unexpected end of file"),!1;break;case rt.Z_STREAM_END:break;case rt.Z_NEED_DICT:return this.dictionary==null?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},mt.prototype._after=function(){if(this._checkError()){var gt=this.strm.avail_out,vt=this.strm.avail_in;this.write_in_progress=!1,this.callback(vt,gt),this.pending_close&&this.close()}},mt.prototype._error=function(gt){this.strm.msg&&(gt=this.strm.msg),this.onerror(gt,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},mt.prototype.init=function(gt,vt,xt,wt,At){at(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])"),at(gt>=8&&gt<=15,"invalid windowBits"),at(vt>=-1&&vt<=9,"invalid compression level"),at(xt>=1&&xt<=9,"invalid memlevel"),at(wt===rt.Z_FILTERED||wt===rt.Z_HUFFMAN_ONLY||wt===rt.Z_RLE||wt===rt.Z_FIXED||wt===rt.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(vt,gt,xt,wt,At),this._setDictionary()},mt.prototype.params=function(){throw new Error("deflateParams Not supported")},mt.prototype.reset=function(){this._reset(),this._setDictionary()},mt.prototype._init=function(gt,vt,xt,wt,At){switch(this.level=gt,this.windowBits=vt,this.memLevel=xt,this.strategy=wt,this.flush=rt.Z_NO_FLUSH,this.err=rt.Z_OK,this.mode!==rt.GZIP&&this.mode!==rt.GUNZIP||(this.windowBits+=16),this.mode===rt.UNZIP&&(this.windowBits+=32),this.mode!==rt.DEFLATERAW&&this.mode!==rt.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new st,this.mode){case rt.DEFLATE:case rt.GZIP:case rt.DEFLATERAW:this.err=ot.deflateInit2(this.strm,this.level,rt.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case rt.INFLATE:case rt.GUNZIP:case rt.INFLATERAW:case rt.UNZIP:this.err=lt.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==rt.Z_OK&&this._error("Init error"),this.dictionary=At,this.write_in_progress=!1,this.init_done=!0},mt.prototype._setDictionary=function(){if(this.dictionary!=null){switch(this.err=rt.Z_OK,this.mode){case rt.DEFLATE:case rt.DEFLATERAW:this.err=ot.deflateSetDictionary(this.strm,this.dictionary)}this.err!==rt.Z_OK&&this._error("Failed to set dictionary")}},mt.prototype._reset=function(){switch(this.err=rt.Z_OK,this.mode){case rt.DEFLATE:case rt.DEFLATERAW:case rt.GZIP:this.err=ot.deflateReset(this.strm);break;case rt.INFLATE:case rt.INFLATERAW:case rt.GUNZIP:this.err=lt.inflateReset(this.strm)}this.err!==rt.Z_OK&&this._error("Failed to reset stream")},rt.Zlib=mt}).call(this)}).call(this,tt("_process"),tt("buffer").Buffer)},{_process:63,assert:23,buffer:32,"pako/lib/zlib/constants":54,"pako/lib/zlib/deflate.js":56,"pako/lib/zlib/inflate.js":58,"pako/lib/zlib/zstream":62}],31:[function(tt,et,rt){(function(nt){(function(){var it=tt("buffer").Buffer,at=tt("stream").Transform,st=tt("./binding"),ot=tt("util"),lt=tt("assert").ok,ht=tt("buffer").kMaxLength,dt="Cannot create final Buffer. It would be larger than 0x"+ht.toString(16)+" bytes";st.Z_MIN_WINDOWBITS=8,st.Z_MAX_WINDOWBITS=15,st.Z_DEFAULT_WINDOWBITS=15,st.Z_MIN_CHUNK=64,st.Z_MAX_CHUNK=1/0,st.Z_DEFAULT_CHUNK=16384,st.Z_MIN_MEMLEVEL=1,st.Z_MAX_MEMLEVEL=9,st.Z_DEFAULT_MEMLEVEL=8,st.Z_MIN_LEVEL=-1,st.Z_MAX_LEVEL=9,st.Z_DEFAULT_LEVEL=st.Z_DEFAULT_COMPRESSION;for(var ut=Object.keys(st),ft=0;ft<ut.length;ft++){var mt=ut[ft];mt.match(/^Z/)&&Object.defineProperty(rt,mt,{enumerable:!0,value:st[mt],writable:!1})}for(var gt={Z_OK:st.Z_OK,Z_STREAM_END:st.Z_STREAM_END,Z_NEED_DICT:st.Z_NEED_DICT,Z_ERRNO:st.Z_ERRNO,Z_STREAM_ERROR:st.Z_STREAM_ERROR,Z_DATA_ERROR:st.Z_DATA_ERROR,Z_MEM_ERROR:st.Z_MEM_ERROR,Z_BUF_ERROR:st.Z_BUF_ERROR,Z_VERSION_ERROR:st.Z_VERSION_ERROR},vt=Object.keys(gt),xt=0;xt<vt.length;xt++){var wt=vt[xt];gt[gt[wt]]=wt}function At(qt,Bt,Xt){var Ft=[],Wt=0;function Yt(){for(var dr;(dr=qt.read())!==null;)Ft.push(dr),Wt+=dr.length;qt.once("readable",Yt)}function zt(dr){qt.removeListener("end",er),qt.removeListener("readable",Yt),Xt(dr)}function er(){var dr,fr=null;Wt>=ht?fr=new RangeError(dt):dr=it.concat(Ft,Wt),Ft=[],qt.close(),Xt(fr,dr)}qt.on("error",zt),qt.on("end",er),qt.end(Bt),Yt()}function Tt(qt,Bt){if(typeof Bt=="string"&&(Bt=it.from(Bt)),!it.isBuffer(Bt))throw new TypeError("Not a string or buffer");var Xt=qt._finishFlushFlag;return qt._processChunk(Bt,Xt)}function Pt(qt){if(!(this instanceof Pt))return new Pt(qt);$t.call(this,qt,st.DEFLATE)}function Rt(qt){if(!(this instanceof Rt))return new Rt(qt);$t.call(this,qt,st.INFLATE)}function Ot(qt){if(!(this instanceof Ot))return new Ot(qt);$t.call(this,qt,st.GZIP)}function Et(qt){if(!(this instanceof Et))return new Et(qt);$t.call(this,qt,st.GUNZIP)}function Lt(qt){if(!(this instanceof Lt))return new Lt(qt);$t.call(this,qt,st.DEFLATERAW)}function kt(qt){if(!(this instanceof kt))return new kt(qt);$t.call(this,qt,st.INFLATERAW)}function jt(qt){if(!(this instanceof jt))return new jt(qt);$t.call(this,qt,st.UNZIP)}function Mt(qt){return qt===st.Z_NO_FLUSH||qt===st.Z_PARTIAL_FLUSH||qt===st.Z_SYNC_FLUSH||qt===st.Z_FULL_FLUSH||qt===st.Z_FINISH||qt===st.Z_BLOCK}function $t(qt,Bt){var Xt=this;if(this._opts=qt=qt||{},this._chunkSize=qt.chunkSize||rt.Z_DEFAULT_CHUNK,at.call(this,qt),qt.flush&&!Mt(qt.flush))throw new Error("Invalid flush flag: "+qt.flush);if(qt.finishFlush&&!Mt(qt.finishFlush))throw new Error("Invalid flush flag: "+qt.finishFlush);if(this._flushFlag=qt.flush||st.Z_NO_FLUSH,this._finishFlushFlag=qt.finishFlush!==void 0?qt.finishFlush:st.Z_FINISH,qt.chunkSize&&(qt.chunkSize<rt.Z_MIN_CHUNK||qt.chunkSize>rt.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+qt.chunkSize);if(qt.windowBits&&(qt.windowBits<rt.Z_MIN_WINDOWBITS||qt.windowBits>rt.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+qt.windowBits);if(qt.level&&(qt.level<rt.Z_MIN_LEVEL||qt.level>rt.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+qt.level);if(qt.memLevel&&(qt.memLevel<rt.Z_MIN_MEMLEVEL||qt.memLevel>rt.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+qt.memLevel);if(qt.strategy&&qt.strategy!=rt.Z_FILTERED&&qt.strategy!=rt.Z_HUFFMAN_ONLY&&qt.strategy!=rt.Z_RLE&&qt.strategy!=rt.Z_FIXED&&qt.strategy!=rt.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+qt.strategy);if(qt.dictionary&&!it.isBuffer(qt.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new st.Zlib(Bt);var Ft=this;this._hadError=!1,this._handle.onerror=function(zt,er){Qt(Ft),Ft._hadError=!0;var dr=new Error(zt);dr.errno=er,dr.code=rt.codes[er],Ft.emit("error",dr)};var Wt=rt.Z_DEFAULT_COMPRESSION;typeof qt.level=="number"&&(Wt=qt.level);var Yt=rt.Z_DEFAULT_STRATEGY;typeof qt.strategy=="number"&&(Yt=qt.strategy),this._handle.init(qt.windowBits||rt.Z_DEFAULT_WINDOWBITS,Wt,qt.memLevel||rt.Z_DEFAULT_MEMLEVEL,Yt,qt.dictionary),this._buffer=it.allocUnsafe(this._chunkSize),this._offset=0,this._level=Wt,this._strategy=Yt,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!Xt._handle},configurable:!0,enumerable:!0})}function Qt(qt,Bt){Bt&&nt.nextTick(Bt),qt._handle&&(qt._handle.close(),qt._handle=null)}function Ht(qt){qt.emit("close")}Object.defineProperty(rt,"codes",{enumerable:!0,value:Object.freeze(gt),writable:!1}),rt.Deflate=Pt,rt.Inflate=Rt,rt.Gzip=Ot,rt.Gunzip=Et,rt.DeflateRaw=Lt,rt.InflateRaw=kt,rt.Unzip=jt,rt.createDeflate=function(qt){return new Pt(qt)},rt.createInflate=function(qt){return new Rt(qt)},rt.createDeflateRaw=function(qt){return new Lt(qt)},rt.createInflateRaw=function(qt){return new kt(qt)},rt.createGzip=function(qt){return new Ot(qt)},rt.createGunzip=function(qt){return new Et(qt)},rt.createUnzip=function(qt){return new jt(qt)},rt.deflate=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new Pt(Bt),qt,Xt)},rt.deflateSync=function(qt,Bt){return Tt(new Pt(Bt),qt)},rt.gzip=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new Ot(Bt),qt,Xt)},rt.gzipSync=function(qt,Bt){return Tt(new Ot(Bt),qt)},rt.deflateRaw=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new Lt(Bt),qt,Xt)},rt.deflateRawSync=function(qt,Bt){return Tt(new Lt(Bt),qt)},rt.unzip=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new jt(Bt),qt,Xt)},rt.unzipSync=function(qt,Bt){return Tt(new jt(Bt),qt)},rt.inflate=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new Rt(Bt),qt,Xt)},rt.inflateSync=function(qt,Bt){return Tt(new Rt(Bt),qt)},rt.gunzip=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new Et(Bt),qt,Xt)},rt.gunzipSync=function(qt,Bt){return Tt(new Et(Bt),qt)},rt.inflateRaw=function(qt,Bt,Xt){return typeof Bt=="function"&&(Xt=Bt,Bt={}),At(new kt(Bt),qt,Xt)},rt.inflateRawSync=function(qt,Bt){return Tt(new kt(Bt),qt)},ot.inherits($t,at),$t.prototype.params=function(qt,Bt,Xt){if(qt<rt.Z_MIN_LEVEL||qt>rt.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+qt);if(Bt!=rt.Z_FILTERED&&Bt!=rt.Z_HUFFMAN_ONLY&&Bt!=rt.Z_RLE&&Bt!=rt.Z_FIXED&&Bt!=rt.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+Bt);if(this._level!==qt||this._strategy!==Bt){var Ft=this;this.flush(st.Z_SYNC_FLUSH,(function(){lt(Ft._handle,"zlib binding closed"),Ft._handle.params(qt,Bt),Ft._hadError||(Ft._level=qt,Ft._strategy=Bt,Xt&&Xt())}))}else nt.nextTick(Xt)},$t.prototype.reset=function(){return lt(this._handle,"zlib binding closed"),this._handle.reset()},$t.prototype._flush=function(qt){this._transform(it.alloc(0),"",qt)},$t.prototype.flush=function(qt,Bt){var Xt=this,Ft=this._writableState;(typeof qt=="function"||qt===void 0&&!Bt)&&(Bt=qt,qt=st.Z_FULL_FLUSH),Ft.ended?Bt&&nt.nextTick(Bt):Ft.ending?Bt&&this.once("end",Bt):Ft.needDrain?Bt&&this.once("drain",(function(){return Xt.flush(qt,Bt)})):(this._flushFlag=qt,this.write(it.alloc(0),"",Bt))},$t.prototype.close=function(qt){Qt(this,qt),nt.nextTick(Ht,this)},$t.prototype._transform=function(qt,Bt,Xt){var Ft,Wt=this._writableState,Yt=(Wt.ending||Wt.ended)&&(!qt||Wt.length===qt.length);return qt===null||it.isBuffer(qt)?this._handle?(Yt?Ft=this._finishFlushFlag:(Ft=this._flushFlag,qt.length>=Wt.length&&(this._flushFlag=this._opts.flush||st.Z_NO_FLUSH)),void this._processChunk(qt,Ft,Xt)):Xt(new Error("zlib binding closed")):Xt(new Error("invalid input"))},$t.prototype._processChunk=function(qt,Bt,Xt){var Ft=qt&&qt.length,Wt=this._chunkSize-this._offset,Yt=0,zt=this,er=typeof Xt=="function";if(!er){var dr,fr=[],lr=0;this.on("error",(function(cr){dr=cr})),lt(this._handle,"zlib binding closed");do var mr=this._handle.writeSync(Bt,qt,Yt,Ft,this._buffer,this._offset,Wt);while(!this._hadError&&Ir(mr[0],mr[1]));if(this._hadError)throw dr;if(lr>=ht)throw Qt(this),new RangeError(dt);var br=it.concat(fr,lr);return Qt(this),br}lt(this._handle,"zlib binding closed");var Sr=this._handle.write(Bt,qt,Yt,Ft,this._buffer,this._offset,Wt);function Ir(cr,Nt){if(this&&(this.buffer=null,this.callback=null),!zt._hadError){var pr=Wt-Nt;if(lt(pr>=0,"have should not go down"),pr>0){var rr=zt._buffer.slice(zt._offset,zt._offset+pr);zt._offset+=pr,er?zt.push(rr):(fr.push(rr),lr+=rr.length)}if((Nt===0||zt._offset>=zt._chunkSize)&&(Wt=zt._chunkSize,zt._offset=0,zt._buffer=it.allocUnsafe(zt._chunkSize)),Nt===0){if(Yt+=Ft-cr,Ft=cr,!er)return!0;var ar=zt._handle.write(Bt,qt,Yt,Ft,zt._buffer,zt._offset,zt._chunkSize);return ar.callback=Ir,void(ar.buffer=qt)}if(!er)return!1;Xt()}}Sr.buffer=qt,Sr.callback=Ir},ot.inherits(Pt,$t),ot.inherits(Rt,$t),ot.inherits(Ot,$t),ot.inherits(Et,$t),ot.inherits(Lt,$t),ot.inherits(kt,$t),ot.inherits(jt,$t)}).call(this)}).call(this,tt("_process"))},{"./binding":30,_process:63,assert:23,buffer:32,stream:65,util:84}],32:[function(tt,et,rt){(function(nt){(function(){var it=tt("base64-js"),at=tt("ieee754");rt.Buffer=ht,rt.SlowBuffer=Tt,rt.INSPECT_MAX_BYTES=50;var st=2147483647;function ot(){try{var Ut=new Uint8Array(1);return Ut.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Ut.foo()===42}catch{return!1}}function lt(Ut){if(Ut>st)throw new RangeError('The value "'+Ut+'" is invalid for option "size"');var Kt=new Uint8Array(Ut);return Kt.__proto__=ht.prototype,Kt}function ht(Ut,Kt,or){if(typeof Ut=="number"){if(typeof Kt=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return mt(Ut)}return dt(Ut,Kt,or)}function dt(Ut,Kt,or){if(typeof Ut=="string")return gt(Ut,Kt);if(ArrayBuffer.isView(Ut))return vt(Ut);if(Ut==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ut);if(ur(Ut,ArrayBuffer)||Ut&&ur(Ut.buffer,ArrayBuffer))return xt(Ut,Kt,or);if(typeof Ut=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var hr=Ut.valueOf&&Ut.valueOf();if(hr!=null&&hr!==Ut)return ht.from(hr,Kt,or);var kr=wt(Ut);if(kr)return kr;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ut[Symbol.toPrimitive]=="function")return ht.from(Ut[Symbol.toPrimitive]("string"),Kt,or);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ut)}function ut(Ut){if(typeof Ut!="number")throw new TypeError('"size" argument must be of type number');if(Ut<0)throw new RangeError('The value "'+Ut+'" is invalid for option "size"')}function ft(Ut,Kt,or){return ut(Ut),Ut<=0?lt(Ut):Kt!==void 0?typeof or=="string"?lt(Ut).fill(Kt,or):lt(Ut).fill(Kt):lt(Ut)}function mt(Ut){return ut(Ut),lt(Ut<0?0:0|At(Ut))}function gt(Ut,Kt){if(typeof Kt=="string"&&Kt!==""||(Kt="utf8"),!ht.isEncoding(Kt))throw new TypeError("Unknown encoding: "+Kt);var or=0|Pt(Ut,Kt),hr=lt(or),kr=hr.write(Ut,Kt);return kr!==or&&(hr=hr.slice(0,kr)),hr}function vt(Ut){for(var Kt=Ut.length<0?0:0|At(Ut.length),or=lt(Kt),hr=0;hr<Kt;hr+=1)or[hr]=255&Ut[hr];return or}function xt(Ut,Kt,or){if(Kt<0||Ut.byteLength<Kt)throw new RangeError('"offset" is outside of buffer bounds');if(Ut.byteLength<Kt+(or||0))throw new RangeError('"length" is outside of buffer bounds');var hr;return(hr=Kt===void 0&&or===void 0?new Uint8Array(Ut):or===void 0?new Uint8Array(Ut,Kt):new Uint8Array(Ut,Kt,or)).__proto__=ht.prototype,hr}function wt(Ut){if(ht.isBuffer(Ut)){var Kt=0|At(Ut.length),or=lt(Kt);return or.length===0||Ut.copy(or,0,0,Kt),or}return Ut.length!==void 0?typeof Ut.length!="number"||Er(Ut.length)?lt(0):vt(Ut):Ut.type==="Buffer"&&Array.isArray(Ut.data)?vt(Ut.data):void 0}function At(Ut){if(Ut>=st)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+st.toString(16)+" bytes");return 0|Ut}function Tt(Ut){return+Ut!=Ut&&(Ut=0),ht.alloc(+Ut)}function Pt(Ut,Kt){if(ht.isBuffer(Ut))return Ut.length;if(ArrayBuffer.isView(Ut)||ur(Ut,ArrayBuffer))return Ut.byteLength;if(typeof Ut!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ut);var or=Ut.length,hr=arguments.length>2&&arguments[2]===!0;if(!hr&&or===0)return 0;for(var kr=!1;;)switch(Kt){case"ascii":case"latin1":case"binary":return or;case"utf8":case"utf-8":return Nt(Ut).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*or;case"hex":return or>>>1;case"base64":return ar(Ut).length;default:if(kr)return hr?-1:Nt(Ut).length;Kt=(""+Kt).toLowerCase(),kr=!0}}function Rt(Ut,Kt,or){var hr=!1;if((Kt===void 0||Kt<0)&&(Kt=0),Kt>this.length||((or===void 0||or>this.length)&&(or=this.length),or<=0)||(or>>>=0)<=(Kt>>>=0))return"";for(Ut||(Ut="utf8");;)switch(Ut){case"hex":return zt(this,Kt,or);case"utf8":case"utf-8":return Bt(this,Kt,or);case"ascii":return Wt(this,Kt,or);case"latin1":case"binary":return Yt(this,Kt,or);case"base64":return qt(this,Kt,or);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return er(this,Kt,or);default:if(hr)throw new TypeError("Unknown encoding: "+Ut);Ut=(Ut+"").toLowerCase(),hr=!0}}function Ot(Ut,Kt,or){var hr=Ut[Kt];Ut[Kt]=Ut[or],Ut[or]=hr}function Et(Ut,Kt,or,hr,kr){if(Ut.length===0)return-1;if(typeof or=="string"?(hr=or,or=0):or>2147483647?or=2147483647:or<-2147483648&&(or=-2147483648),Er(or=+or)&&(or=kr?0:Ut.length-1),or<0&&(or=Ut.length+or),or>=Ut.length){if(kr)return-1;or=Ut.length-1}else if(or<0){if(!kr)return-1;or=0}if(typeof Kt=="string"&&(Kt=ht.from(Kt,hr)),ht.isBuffer(Kt))return Kt.length===0?-1:Lt(Ut,Kt,or,hr,kr);if(typeof Kt=="number")return Kt&=255,typeof Uint8Array.prototype.indexOf=="function"?kr?Uint8Array.prototype.indexOf.call(Ut,Kt,or):Uint8Array.prototype.lastIndexOf.call(Ut,Kt,or):Lt(Ut,[Kt],or,hr,kr);throw new TypeError("val must be string, number or Buffer")}function Lt(Ut,Kt,or,hr,kr){var Br,Gn=1,Xn=Ut.length,Mn=Kt.length;if(hr!==void 0&&((hr=String(hr).toLowerCase())==="ucs2"||hr==="ucs-2"||hr==="utf16le"||hr==="utf-16le")){if(Ut.length<2||Kt.length<2)return-1;Gn=2,Xn/=2,Mn/=2,or/=2}function Kn(_i,Ri){return Gn===1?_i[Ri]:_i.readUInt16BE(Ri*Gn)}if(kr){var Vn=-1;for(Br=or;Br<Xn;Br++)if(Kn(Ut,Br)===Kn(Kt,Vn===-1?0:Br-Vn)){if(Vn===-1&&(Vn=Br),Br-Vn+1===Mn)return Vn*Gn}else Vn!==-1&&(Br-=Br-Vn),Vn=-1}else for(or+Mn>Xn&&(or=Xn-Mn),Br=or;Br>=0;Br--){for(var vi=!0,mi=0;mi<Mn;mi++)if(Kn(Ut,Br+mi)!==Kn(Kt,mi)){vi=!1;break}if(vi)return Br}return-1}function kt(Ut,Kt,or,hr){or=Number(or)||0;var kr=Ut.length-or;hr?(hr=Number(hr))>kr&&(hr=kr):hr=kr;var Br=Kt.length;hr>Br/2&&(hr=Br/2);for(var Gn=0;Gn<hr;++Gn){var Xn=parseInt(Kt.substr(2*Gn,2),16);if(Er(Xn))return Gn;Ut[or+Gn]=Xn}return Gn}function jt(Ut,Kt,or,hr){return nr(Nt(Kt,Ut.length-or),Ut,or,hr)}function Mt(Ut,Kt,or,hr){return nr(pr(Kt),Ut,or,hr)}function $t(Ut,Kt,or,hr){return Mt(Ut,Kt,or,hr)}function Qt(Ut,Kt,or,hr){return nr(ar(Kt),Ut,or,hr)}function Ht(Ut,Kt,or,hr){return nr(rr(Kt,Ut.length-or),Ut,or,hr)}function qt(Ut,Kt,or){return Kt===0&&or===Ut.length?it.fromByteArray(Ut):it.fromByteArray(Ut.slice(Kt,or))}function Bt(Ut,Kt,or){or=Math.min(Ut.length,or);for(var hr=[],kr=Kt;kr<or;){var Br,Gn,Xn,Mn,Kn=Ut[kr],Vn=null,vi=Kn>239?4:Kn>223?3:Kn>191?2:1;if(kr+vi<=or)switch(vi){case 1:Kn<128&&(Vn=Kn);break;case 2:(192&(Br=Ut[kr+1]))==128&&(Mn=(31&Kn)<<6|63&Br)>127&&(Vn=Mn);break;case 3:Br=Ut[kr+1],Gn=Ut[kr+2],(192&Br)==128&&(192&Gn)==128&&(Mn=(15&Kn)<<12|(63&Br)<<6|63&Gn)>2047&&(Mn<55296||Mn>57343)&&(Vn=Mn);break;case 4:Br=Ut[kr+1],Gn=Ut[kr+2],Xn=Ut[kr+3],(192&Br)==128&&(192&Gn)==128&&(192&Xn)==128&&(Mn=(15&Kn)<<18|(63&Br)<<12|(63&Gn)<<6|63&Xn)>65535&&Mn<1114112&&(Vn=Mn)}Vn===null?(Vn=65533,vi=1):Vn>65535&&(Vn-=65536,hr.push(Vn>>>10&1023|55296),Vn=56320|1023&Vn),hr.push(Vn),kr+=vi}return Ft(hr)}rt.kMaxLength=st,ht.TYPED_ARRAY_SUPPORT=ot(),ht.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(ht.prototype,"parent",{enumerable:!0,get:function(){if(ht.isBuffer(this))return this.buffer}}),Object.defineProperty(ht.prototype,"offset",{enumerable:!0,get:function(){if(ht.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&ht[Symbol.species]===ht&&Object.defineProperty(ht,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),ht.poolSize=8192,ht.from=function(Ut,Kt,or){return dt(Ut,Kt,or)},ht.prototype.__proto__=Uint8Array.prototype,ht.__proto__=Uint8Array,ht.alloc=function(Ut,Kt,or){return ft(Ut,Kt,or)},ht.allocUnsafe=function(Ut){return mt(Ut)},ht.allocUnsafeSlow=function(Ut){return mt(Ut)},ht.isBuffer=function(Ut){return Ut!=null&&Ut._isBuffer===!0&&Ut!==ht.prototype},ht.compare=function(Ut,Kt){if(ur(Ut,Uint8Array)&&(Ut=ht.from(Ut,Ut.offset,Ut.byteLength)),ur(Kt,Uint8Array)&&(Kt=ht.from(Kt,Kt.offset,Kt.byteLength)),!ht.isBuffer(Ut)||!ht.isBuffer(Kt))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Ut===Kt)return 0;for(var or=Ut.length,hr=Kt.length,kr=0,Br=Math.min(or,hr);kr<Br;++kr)if(Ut[kr]!==Kt[kr]){or=Ut[kr],hr=Kt[kr];break}return or<hr?-1:hr<or?1:0},ht.isEncoding=function(Ut){switch(String(Ut).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ht.concat=function(Ut,Kt){if(!Array.isArray(Ut))throw new TypeError('"list" argument must be an Array of Buffers');if(Ut.length===0)return ht.alloc(0);var or;if(Kt===void 0)for(Kt=0,or=0;or<Ut.length;++or)Kt+=Ut[or].length;var hr=ht.allocUnsafe(Kt),kr=0;for(or=0;or<Ut.length;++or){var Br=Ut[or];if(ur(Br,Uint8Array)&&(Br=ht.from(Br)),!ht.isBuffer(Br))throw new TypeError('"list" argument must be an Array of Buffers');Br.copy(hr,kr),kr+=Br.length}return hr},ht.byteLength=Pt,ht.prototype._isBuffer=!0,ht.prototype.swap16=function(){var Ut=this.length;if(Ut%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Kt=0;Kt<Ut;Kt+=2)Ot(this,Kt,Kt+1);return this},ht.prototype.swap32=function(){var Ut=this.length;if(Ut%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Kt=0;Kt<Ut;Kt+=4)Ot(this,Kt,Kt+3),Ot(this,Kt+1,Kt+2);return this},ht.prototype.swap64=function(){var Ut=this.length;if(Ut%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Kt=0;Kt<Ut;Kt+=8)Ot(this,Kt,Kt+7),Ot(this,Kt+1,Kt+6),Ot(this,Kt+2,Kt+5),Ot(this,Kt+3,Kt+4);return this},ht.prototype.toString=function(){var Ut=this.length;return Ut===0?"":arguments.length===0?Bt(this,0,Ut):Rt.apply(this,arguments)},ht.prototype.toLocaleString=ht.prototype.toString,ht.prototype.equals=function(Ut){if(!ht.isBuffer(Ut))throw new TypeError("Argument must be a Buffer");return this===Ut||ht.compare(this,Ut)===0},ht.prototype.inspect=function(){var Ut="",Kt=rt.INSPECT_MAX_BYTES;return Ut=this.toString("hex",0,Kt).replace(/(.{2})/g,"$1 ").trim(),this.length>Kt&&(Ut+=" ... "),"<Buffer "+Ut+">"},ht.prototype.compare=function(Ut,Kt,or,hr,kr){if(ur(Ut,Uint8Array)&&(Ut=ht.from(Ut,Ut.offset,Ut.byteLength)),!ht.isBuffer(Ut))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Ut);if(Kt===void 0&&(Kt=0),or===void 0&&(or=Ut?Ut.length:0),hr===void 0&&(hr=0),kr===void 0&&(kr=this.length),Kt<0||or>Ut.length||hr<0||kr>this.length)throw new RangeError("out of range index");if(hr>=kr&&Kt>=or)return 0;if(hr>=kr)return-1;if(Kt>=or)return 1;if(this===Ut)return 0;for(var Br=(kr>>>=0)-(hr>>>=0),Gn=(or>>>=0)-(Kt>>>=0),Xn=Math.min(Br,Gn),Mn=this.slice(hr,kr),Kn=Ut.slice(Kt,or),Vn=0;Vn<Xn;++Vn)if(Mn[Vn]!==Kn[Vn]){Br=Mn[Vn],Gn=Kn[Vn];break}return Br<Gn?-1:Gn<Br?1:0},ht.prototype.includes=function(Ut,Kt,or){return this.indexOf(Ut,Kt,or)!==-1},ht.prototype.indexOf=function(Ut,Kt,or){return Et(this,Ut,Kt,or,!0)},ht.prototype.lastIndexOf=function(Ut,Kt,or){return Et(this,Ut,Kt,or,!1)},ht.prototype.write=function(Ut,Kt,or,hr){if(Kt===void 0)hr="utf8",or=this.length,Kt=0;else if(or===void 0&&typeof Kt=="string")hr=Kt,or=this.length,Kt=0;else{if(!isFinite(Kt))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");Kt>>>=0,isFinite(or)?(or>>>=0,hr===void 0&&(hr="utf8")):(hr=or,or=void 0)}var kr=this.length-Kt;if((or===void 0||or>kr)&&(or=kr),Ut.length>0&&(or<0||Kt<0)||Kt>this.length)throw new RangeError("Attempt to write outside buffer bounds");hr||(hr="utf8");for(var Br=!1;;)switch(hr){case"hex":return kt(this,Ut,Kt,or);case"utf8":case"utf-8":return jt(this,Ut,Kt,or);case"ascii":return Mt(this,Ut,Kt,or);case"latin1":case"binary":return $t(this,Ut,Kt,or);case"base64":return Qt(this,Ut,Kt,or);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ht(this,Ut,Kt,or);default:if(Br)throw new TypeError("Unknown encoding: "+hr);hr=(""+hr).toLowerCase(),Br=!0}},ht.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Xt=4096;function Ft(Ut){var Kt=Ut.length;if(Kt<=Xt)return String.fromCharCode.apply(String,Ut);for(var or="",hr=0;hr<Kt;)or+=String.fromCharCode.apply(String,Ut.slice(hr,hr+=Xt));return or}function Wt(Ut,Kt,or){var hr="";or=Math.min(Ut.length,or);for(var kr=Kt;kr<or;++kr)hr+=String.fromCharCode(127&Ut[kr]);return hr}function Yt(Ut,Kt,or){var hr="";or=Math.min(Ut.length,or);for(var kr=Kt;kr<or;++kr)hr+=String.fromCharCode(Ut[kr]);return hr}function zt(Ut,Kt,or){var hr=Ut.length;(!Kt||Kt<0)&&(Kt=0),(!or||or<0||or>hr)&&(or=hr);for(var kr="",Br=Kt;Br<or;++Br)kr+=cr(Ut[Br]);return kr}function er(Ut,Kt,or){for(var hr=Ut.slice(Kt,or),kr="",Br=0;Br<hr.length;Br+=2)kr+=String.fromCharCode(hr[Br]+256*hr[Br+1]);return kr}function dr(Ut,Kt,or){if(Ut%1!=0||Ut<0)throw new RangeError("offset is not uint");if(Ut+Kt>or)throw new RangeError("Trying to access beyond buffer length")}function fr(Ut,Kt,or,hr,kr,Br){if(!ht.isBuffer(Ut))throw new TypeError('"buffer" argument must be a Buffer instance');if(Kt>kr||Kt<Br)throw new RangeError('"value" argument is out of bounds');if(or+hr>Ut.length)throw new RangeError("Index out of range")}function lr(Ut,Kt,or,hr,kr,Br){if(or+hr>Ut.length)throw new RangeError("Index out of range");if(or<0)throw new RangeError("Index out of range")}function mr(Ut,Kt,or,hr,kr){return Kt=+Kt,or>>>=0,kr||lr(Ut,Kt,or,4),at.write(Ut,Kt,or,hr,23,4),or+4}function br(Ut,Kt,or,hr,kr){return Kt=+Kt,or>>>=0,kr||lr(Ut,Kt,or,8),at.write(Ut,Kt,or,hr,52,8),or+8}ht.prototype.slice=function(Ut,Kt){var or=this.length;(Ut=~~Ut)<0?(Ut+=or)<0&&(Ut=0):Ut>or&&(Ut=or),(Kt=Kt===void 0?or:~~Kt)<0?(Kt+=or)<0&&(Kt=0):Kt>or&&(Kt=or),Kt<Ut&&(Kt=Ut);var hr=this.subarray(Ut,Kt);return hr.__proto__=ht.prototype,hr},ht.prototype.readUIntLE=function(Ut,Kt,or){Ut>>>=0,Kt>>>=0,or||dr(Ut,Kt,this.length);for(var hr=this[Ut],kr=1,Br=0;++Br<Kt&&(kr*=256);)hr+=this[Ut+Br]*kr;return hr},ht.prototype.readUIntBE=function(Ut,Kt,or){Ut>>>=0,Kt>>>=0,or||dr(Ut,Kt,this.length);for(var hr=this[Ut+--Kt],kr=1;Kt>0&&(kr*=256);)hr+=this[Ut+--Kt]*kr;return hr},ht.prototype.readUInt8=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,1,this.length),this[Ut]},ht.prototype.readUInt16LE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,2,this.length),this[Ut]|this[Ut+1]<<8},ht.prototype.readUInt16BE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,2,this.length),this[Ut]<<8|this[Ut+1]},ht.prototype.readUInt32LE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,4,this.length),(this[Ut]|this[Ut+1]<<8|this[Ut+2]<<16)+16777216*this[Ut+3]},ht.prototype.readUInt32BE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,4,this.length),16777216*this[Ut]+(this[Ut+1]<<16|this[Ut+2]<<8|this[Ut+3])},ht.prototype.readIntLE=function(Ut,Kt,or){Ut>>>=0,Kt>>>=0,or||dr(Ut,Kt,this.length);for(var hr=this[Ut],kr=1,Br=0;++Br<Kt&&(kr*=256);)hr+=this[Ut+Br]*kr;return hr>=(kr*=128)&&(hr-=Math.pow(2,8*Kt)),hr},ht.prototype.readIntBE=function(Ut,Kt,or){Ut>>>=0,Kt>>>=0,or||dr(Ut,Kt,this.length);for(var hr=Kt,kr=1,Br=this[Ut+--hr];hr>0&&(kr*=256);)Br+=this[Ut+--hr]*kr;return Br>=(kr*=128)&&(Br-=Math.pow(2,8*Kt)),Br},ht.prototype.readInt8=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,1,this.length),128&this[Ut]?-1*(255-this[Ut]+1):this[Ut]},ht.prototype.readInt16LE=function(Ut,Kt){Ut>>>=0,Kt||dr(Ut,2,this.length);var or=this[Ut]|this[Ut+1]<<8;return 32768&or?4294901760|or:or},ht.prototype.readInt16BE=function(Ut,Kt){Ut>>>=0,Kt||dr(Ut,2,this.length);var or=this[Ut+1]|this[Ut]<<8;return 32768&or?4294901760|or:or},ht.prototype.readInt32LE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,4,this.length),this[Ut]|this[Ut+1]<<8|this[Ut+2]<<16|this[Ut+3]<<24},ht.prototype.readInt32BE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,4,this.length),this[Ut]<<24|this[Ut+1]<<16|this[Ut+2]<<8|this[Ut+3]},ht.prototype.readFloatLE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,4,this.length),at.read(this,Ut,!0,23,4)},ht.prototype.readFloatBE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,4,this.length),at.read(this,Ut,!1,23,4)},ht.prototype.readDoubleLE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,8,this.length),at.read(this,Ut,!0,52,8)},ht.prototype.readDoubleBE=function(Ut,Kt){return Ut>>>=0,Kt||dr(Ut,8,this.length),at.read(this,Ut,!1,52,8)},ht.prototype.writeUIntLE=function(Ut,Kt,or,hr){Ut=+Ut,Kt>>>=0,or>>>=0,hr||fr(this,Ut,Kt,or,Math.pow(2,8*or)-1,0);var kr=1,Br=0;for(this[Kt]=255&Ut;++Br<or&&(kr*=256);)this[Kt+Br]=Ut/kr&255;return Kt+or},ht.prototype.writeUIntBE=function(Ut,Kt,or,hr){Ut=+Ut,Kt>>>=0,or>>>=0,hr||fr(this,Ut,Kt,or,Math.pow(2,8*or)-1,0);var kr=or-1,Br=1;for(this[Kt+kr]=255&Ut;--kr>=0&&(Br*=256);)this[Kt+kr]=Ut/Br&255;return Kt+or},ht.prototype.writeUInt8=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,1,255,0),this[Kt]=255&Ut,Kt+1},ht.prototype.writeUInt16LE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,2,65535,0),this[Kt]=255&Ut,this[Kt+1]=Ut>>>8,Kt+2},ht.prototype.writeUInt16BE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,2,65535,0),this[Kt]=Ut>>>8,this[Kt+1]=255&Ut,Kt+2},ht.prototype.writeUInt32LE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,4,4294967295,0),this[Kt+3]=Ut>>>24,this[Kt+2]=Ut>>>16,this[Kt+1]=Ut>>>8,this[Kt]=255&Ut,Kt+4},ht.prototype.writeUInt32BE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,4,4294967295,0),this[Kt]=Ut>>>24,this[Kt+1]=Ut>>>16,this[Kt+2]=Ut>>>8,this[Kt+3]=255&Ut,Kt+4},ht.prototype.writeIntLE=function(Ut,Kt,or,hr){if(Ut=+Ut,Kt>>>=0,!hr){var kr=Math.pow(2,8*or-1);fr(this,Ut,Kt,or,kr-1,-kr)}var Br=0,Gn=1,Xn=0;for(this[Kt]=255&Ut;++Br<or&&(Gn*=256);)Ut<0&&Xn===0&&this[Kt+Br-1]!==0&&(Xn=1),this[Kt+Br]=(Ut/Gn|0)-Xn&255;return Kt+or},ht.prototype.writeIntBE=function(Ut,Kt,or,hr){if(Ut=+Ut,Kt>>>=0,!hr){var kr=Math.pow(2,8*or-1);fr(this,Ut,Kt,or,kr-1,-kr)}var Br=or-1,Gn=1,Xn=0;for(this[Kt+Br]=255&Ut;--Br>=0&&(Gn*=256);)Ut<0&&Xn===0&&this[Kt+Br+1]!==0&&(Xn=1),this[Kt+Br]=(Ut/Gn|0)-Xn&255;return Kt+or},ht.prototype.writeInt8=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,1,127,-128),Ut<0&&(Ut=255+Ut+1),this[Kt]=255&Ut,Kt+1},ht.prototype.writeInt16LE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,2,32767,-32768),this[Kt]=255&Ut,this[Kt+1]=Ut>>>8,Kt+2},ht.prototype.writeInt16BE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,2,32767,-32768),this[Kt]=Ut>>>8,this[Kt+1]=255&Ut,Kt+2},ht.prototype.writeInt32LE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,4,2147483647,-2147483648),this[Kt]=255&Ut,this[Kt+1]=Ut>>>8,this[Kt+2]=Ut>>>16,this[Kt+3]=Ut>>>24,Kt+4},ht.prototype.writeInt32BE=function(Ut,Kt,or){return Ut=+Ut,Kt>>>=0,or||fr(this,Ut,Kt,4,2147483647,-2147483648),Ut<0&&(Ut=4294967295+Ut+1),this[Kt]=Ut>>>24,this[Kt+1]=Ut>>>16,this[Kt+2]=Ut>>>8,this[Kt+3]=255&Ut,Kt+4},ht.prototype.writeFloatLE=function(Ut,Kt,or){return mr(this,Ut,Kt,!0,or)},ht.prototype.writeFloatBE=function(Ut,Kt,or){return mr(this,Ut,Kt,!1,or)},ht.prototype.writeDoubleLE=function(Ut,Kt,or){return br(this,Ut,Kt,!0,or)},ht.prototype.writeDoubleBE=function(Ut,Kt,or){return br(this,Ut,Kt,!1,or)},ht.prototype.copy=function(Ut,Kt,or,hr){if(!ht.isBuffer(Ut))throw new TypeError("argument should be a Buffer");if(or||(or=0),hr||hr===0||(hr=this.length),Kt>=Ut.length&&(Kt=Ut.length),Kt||(Kt=0),hr>0&&hr<or&&(hr=or),hr===or||Ut.length===0||this.length===0)return 0;if(Kt<0)throw new RangeError("targetStart out of bounds");if(or<0||or>=this.length)throw new RangeError("Index out of range");if(hr<0)throw new RangeError("sourceEnd out of bounds");hr>this.length&&(hr=this.length),Ut.length-Kt<hr-or&&(hr=Ut.length-Kt+or);var kr=hr-or;if(this===Ut&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(Kt,or,hr);else if(this===Ut&&or<Kt&&Kt<hr)for(var Br=kr-1;Br>=0;--Br)Ut[Br+Kt]=this[Br+or];else Uint8Array.prototype.set.call(Ut,this.subarray(or,hr),Kt);return kr},ht.prototype.fill=function(Ut,Kt,or,hr){if(typeof Ut=="string"){if(typeof Kt=="string"?(hr=Kt,Kt=0,or=this.length):typeof or=="string"&&(hr=or,or=this.length),hr!==void 0&&typeof hr!="string")throw new TypeError("encoding must be a string");if(typeof hr=="string"&&!ht.isEncoding(hr))throw new TypeError("Unknown encoding: "+hr);if(Ut.length===1){var kr=Ut.charCodeAt(0);(hr==="utf8"&&kr<128||hr==="latin1")&&(Ut=kr)}}else typeof Ut=="number"&&(Ut&=255);if(Kt<0||this.length<Kt||this.length<or)throw new RangeError("Out of range index");if(or<=Kt)return this;var Br;if(Kt>>>=0,or=or===void 0?this.length:or>>>0,Ut||(Ut=0),typeof Ut=="number")for(Br=Kt;Br<or;++Br)this[Br]=Ut;else{var Gn=ht.isBuffer(Ut)?Ut:ht.from(Ut,hr),Xn=Gn.length;if(Xn===0)throw new TypeError('The value "'+Ut+'" is invalid for argument "value"');for(Br=0;Br<or-Kt;++Br)this[Br+Kt]=Gn[Br%Xn]}return this};var Sr=/[^+/0-9A-Za-z-_]/g;function Ir(Ut){if((Ut=(Ut=Ut.split("=")[0]).trim().replace(Sr,"")).length<2)return"";for(;Ut.length%4!=0;)Ut+="=";return Ut}function cr(Ut){return Ut<16?"0"+Ut.toString(16):Ut.toString(16)}function Nt(Ut,Kt){var or;Kt=Kt||1/0;for(var hr=Ut.length,kr=null,Br=[],Gn=0;Gn<hr;++Gn){if((or=Ut.charCodeAt(Gn))>55295&&or<57344){if(!kr){if(or>56319){(Kt-=3)>-1&&Br.push(239,191,189);continue}if(Gn+1===hr){(Kt-=3)>-1&&Br.push(239,191,189);continue}kr=or;continue}if(or<56320){(Kt-=3)>-1&&Br.push(239,191,189),kr=or;continue}or=65536+(kr-55296<<10|or-56320)}else kr&&(Kt-=3)>-1&&Br.push(239,191,189);if(kr=null,or<128){if((Kt-=1)<0)break;Br.push(or)}else if(or<2048){if((Kt-=2)<0)break;Br.push(or>>6|192,63&or|128)}else if(or<65536){if((Kt-=3)<0)break;Br.push(or>>12|224,or>>6&63|128,63&or|128)}else{if(!(or<1114112))throw new Error("Invalid code point");if((Kt-=4)<0)break;Br.push(or>>18|240,or>>12&63|128,or>>6&63|128,63&or|128)}}return Br}function pr(Ut){for(var Kt=[],or=0;or<Ut.length;++or)Kt.push(255&Ut.charCodeAt(or));return Kt}function rr(Ut,Kt){for(var or,hr,kr,Br=[],Gn=0;Gn<Ut.length&&!((Kt-=2)<0);++Gn)hr=(or=Ut.charCodeAt(Gn))>>8,kr=or%256,Br.push(kr),Br.push(hr);return Br}function ar(Ut){return it.toByteArray(Ir(Ut))}function nr(Ut,Kt,or,hr){for(var kr=0;kr<hr&&!(kr+or>=Kt.length||kr>=Ut.length);++kr)Kt[kr+or]=Ut[kr];return kr}function ur(Ut,Kt){return Ut instanceof Kt||Ut!=null&&Ut.constructor!=null&&Ut.constructor.name!=null&&Ut.constructor.name===Kt.name}function Er(Ut){return Ut!=Ut}}).call(this)}).call(this,tt("buffer").Buffer)},{"base64-js":28,buffer:32,ieee754:45}],33:[function(tt,et,rt){var nt=tt("get-intrinsic"),it=tt("./"),at=it(nt("String.prototype.indexOf"));et.exports=function(st,ot){var lt=nt(st,!!ot);return typeof lt=="function"&&at(st,".prototype.")>-1?it(lt):lt}},{"./":34,"get-intrinsic":39}],34:[function(tt,et,rt){var nt=tt("function-bind"),it=tt("get-intrinsic"),at=it("%Function.prototype.apply%"),st=it("%Function.prototype.call%"),ot=it("%Reflect.apply%",!0)||nt.call(st,at),lt=it("%Object.getOwnPropertyDescriptor%",!0),ht=it("%Object.defineProperty%",!0),dt=it("%Math.max%");if(ht)try{ht({},"a",{value:1})}catch{ht=null}et.exports=function(ft){var mt=ot(nt,st,arguments);return lt&&ht&&lt(mt,"length").configurable&&ht(mt,"length",{value:1+dt(0,ft.length-(arguments.length-1))}),mt};var ut=function(){return ot(nt,at,arguments)};ht?ht(et.exports,"apply",{value:ut}):et.exports.apply=ut},{"function-bind":38,"get-intrinsic":39}],35:[function(tt,et,rt){var nt,it=typeof Reflect=="object"?Reflect:null,at=it&&typeof it.apply=="function"?it.apply:function(Et,Lt,kt){return Function.prototype.apply.call(Et,Lt,kt)};function st(Et){console&&console.warn&&console.warn(Et)}nt=it&&typeof it.ownKeys=="function"?it.ownKeys:Object.getOwnPropertySymbols?function(Et){return Object.getOwnPropertyNames(Et).concat(Object.getOwnPropertySymbols(Et))}:function(Et){return Object.getOwnPropertyNames(Et)};var ot=Number.isNaN||function(Et){return Et!=Et};function lt(){lt.init.call(this)}et.exports=lt,et.exports.once=Pt,lt.EventEmitter=lt,lt.prototype._events=void 0,lt.prototype._eventsCount=0,lt.prototype._maxListeners=void 0;var ht=10;function dt(Et){if(typeof Et!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Et)}function ut(Et){return Et._maxListeners===void 0?lt.defaultMaxListeners:Et._maxListeners}function ft(Et,Lt,kt,jt){var Mt,$t,Qt;if(dt(kt),($t=Et._events)===void 0?($t=Et._events=Object.create(null),Et._eventsCount=0):($t.newListener!==void 0&&(Et.emit("newListener",Lt,kt.listener?kt.listener:kt),$t=Et._events),Qt=$t[Lt]),Qt===void 0)Qt=$t[Lt]=kt,++Et._eventsCount;else if(typeof Qt=="function"?Qt=$t[Lt]=jt?[kt,Qt]:[Qt,kt]:jt?Qt.unshift(kt):Qt.push(kt),(Mt=ut(Et))>0&&Qt.length>Mt&&!Qt.warned){Qt.warned=!0;var Ht=new Error("Possible EventEmitter memory leak detected. "+Qt.length+" "+String(Lt)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ht.name="MaxListenersExceededWarning",Ht.emitter=Et,Ht.type=Lt,Ht.count=Qt.length,st(Ht)}return Et}function mt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gt(Et,Lt,kt){var jt={fired:!1,wrapFn:void 0,target:Et,type:Lt,listener:kt},Mt=mt.bind(jt);return Mt.listener=kt,jt.wrapFn=Mt,Mt}function vt(Et,Lt,kt){var jt=Et._events;if(jt===void 0)return[];var Mt=jt[Lt];return Mt===void 0?[]:typeof Mt=="function"?kt?[Mt.listener||Mt]:[Mt]:kt?Tt(Mt):wt(Mt,Mt.length)}function xt(Et){var Lt=this._events;if(Lt!==void 0){var kt=Lt[Et];if(typeof kt=="function")return 1;if(kt!==void 0)return kt.length}return 0}function wt(Et,Lt){for(var kt=new Array(Lt),jt=0;jt<Lt;++jt)kt[jt]=Et[jt];return kt}function At(Et,Lt){for(;Lt+1<Et.length;Lt++)Et[Lt]=Et[Lt+1];Et.pop()}function Tt(Et){for(var Lt=new Array(Et.length),kt=0;kt<Lt.length;++kt)Lt[kt]=Et[kt].listener||Et[kt];return Lt}function Pt(Et,Lt){return new Promise((function(kt,jt){function Mt(Qt){Et.removeListener(Lt,$t),jt(Qt)}function $t(){typeof Et.removeListener=="function"&&Et.removeListener("error",Mt),kt([].slice.call(arguments))}Ot(Et,Lt,$t,{once:!0}),Lt!=="error"&&Rt(Et,Mt,{once:!0})}))}function Rt(Et,Lt,kt){typeof Et.on=="function"&&Ot(Et,"error",Lt,kt)}function Ot(Et,Lt,kt,jt){if(typeof Et.on=="function")jt.once?Et.once(Lt,kt):Et.on(Lt,kt);else{if(typeof Et.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Et);Et.addEventListener(Lt,(function Mt($t){jt.once&&Et.removeEventListener(Lt,Mt),kt($t)}))}}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return ht},set:function(Et){if(typeof Et!="number"||Et<0||ot(Et))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Et+".");ht=Et}}),lt.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},lt.prototype.setMaxListeners=function(Et){if(typeof Et!="number"||Et<0||ot(Et))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Et+".");return this._maxListeners=Et,this},lt.prototype.getMaxListeners=function(){return ut(this)},lt.prototype.emit=function(Et){for(var Lt=[],kt=1;kt<arguments.length;kt++)Lt.push(arguments[kt]);var jt=Et==="error",Mt=this._events;if(Mt!==void 0)jt=jt&&Mt.error===void 0;else if(!jt)return!1;if(jt){var $t;if(Lt.length>0&&($t=Lt[0]),$t instanceof Error)throw $t;var Qt=new Error("Unhandled error."+($t?" ("+$t.message+")":""));throw Qt.context=$t,Qt}var Ht=Mt[Et];if(Ht===void 0)return!1;if(typeof Ht=="function")at(Ht,this,Lt);else{var qt=Ht.length,Bt=wt(Ht,qt);for(kt=0;kt<qt;++kt)at(Bt[kt],this,Lt)}return!0},lt.prototype.addListener=function(Et,Lt){return ft(this,Et,Lt,!1)},lt.prototype.on=lt.prototype.addListener,lt.prototype.prependListener=function(Et,Lt){return ft(this,Et,Lt,!0)},lt.prototype.once=function(Et,Lt){return dt(Lt),this.on(Et,gt(this,Et,Lt)),this},lt.prototype.prependOnceListener=function(Et,Lt){return dt(Lt),this.prependListener(Et,gt(this,Et,Lt)),this},lt.prototype.removeListener=function(Et,Lt){var kt,jt,Mt,$t,Qt;if(dt(Lt),(jt=this._events)===void 0)return this;if((kt=jt[Et])===void 0)return this;if(kt===Lt||kt.listener===Lt)--this._eventsCount==0?this._events=Object.create(null):(delete jt[Et],jt.removeListener&&this.emit("removeListener",Et,kt.listener||Lt));else if(typeof kt!="function"){for(Mt=-1,$t=kt.length-1;$t>=0;$t--)if(kt[$t]===Lt||kt[$t].listener===Lt){Qt=kt[$t].listener,Mt=$t;break}if(Mt<0)return this;Mt===0?kt.shift():At(kt,Mt),kt.length===1&&(jt[Et]=kt[0]),jt.removeListener!==void 0&&this.emit("removeListener",Et,Qt||Lt)}return this},lt.prototype.off=lt.prototype.removeListener,lt.prototype.removeAllListeners=function(Et){var Lt,kt,jt;if((kt=this._events)===void 0)return this;if(kt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):kt[Et]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete kt[Et]),this;if(arguments.length===0){var Mt,$t=Object.keys(kt);for(jt=0;jt<$t.length;++jt)(Mt=$t[jt])!=="removeListener"&&this.removeAllListeners(Mt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(Lt=kt[Et])=="function")this.removeListener(Et,Lt);else if(Lt!==void 0)for(jt=Lt.length-1;jt>=0;jt--)this.removeListener(Et,Lt[jt]);return this},lt.prototype.listeners=function(Et){return vt(this,Et,!0)},lt.prototype.rawListeners=function(Et){return vt(this,Et,!1)},lt.listenerCount=function(Et,Lt){return typeof Et.listenerCount=="function"?Et.listenerCount(Lt):xt.call(Et,Lt)},lt.prototype.listenerCount=xt,lt.prototype.eventNames=function(){return this._eventsCount>0?nt(this._events):[]}},{}],36:[function(tt,et,rt){var nt=tt("is-callable"),it=Object.prototype.toString,at=Object.prototype.hasOwnProperty,st=function(dt,ut,ft){for(var mt=0,gt=dt.length;mt<gt;mt++)at.call(dt,mt)&&(ft==null?ut(dt[mt],mt,dt):ut.call(ft,dt[mt],mt,dt))},ot=function(dt,ut,ft){for(var mt=0,gt=dt.length;mt<gt;mt++)ft==null?ut(dt.charAt(mt),mt,dt):ut.call(ft,dt.charAt(mt),mt,dt)},lt=function(dt,ut,ft){for(var mt in dt)at.call(dt,mt)&&(ft==null?ut(dt[mt],mt,dt):ut.call(ft,dt[mt],mt,dt))},ht=function(dt,ut,ft){if(!nt(ut))throw new TypeError("iterator must be a function");var mt;arguments.length>=3&&(mt=ft),it.call(dt)==="[object Array]"?st(dt,ut,mt):typeof dt=="string"?ot(dt,ut,mt):lt(dt,ut,mt)};et.exports=ht},{"is-callable":48}],37:[function(tt,et,rt){var nt="Function.prototype.bind called on incompatible ",it=Array.prototype.slice,at=Object.prototype.toString,st="[object Function]";et.exports=function(ot){var lt=this;if(typeof lt!="function"||at.call(lt)!==st)throw new TypeError(nt+lt);for(var ht,dt=it.call(arguments,1),ut=function(){if(this instanceof ht){var xt=lt.apply(this,dt.concat(it.call(arguments)));return Object(xt)===xt?xt:this}return lt.apply(ot,dt.concat(it.call(arguments)))},ft=Math.max(0,lt.length-dt.length),mt=[],gt=0;gt<ft;gt++)mt.push("$"+gt);if(ht=Function("binder","return function ("+mt.join(",")+"){ return binder.apply(this,arguments); }")(ut),lt.prototype){var vt=function(){};vt.prototype=lt.prototype,ht.prototype=new vt,vt.prototype=null}return ht}},{}],38:[function(tt,et,rt){var nt=tt("./implementation");et.exports=Function.prototype.bind||nt},{"./implementation":37}],39:[function(tt,et,rt){var nt,it=SyntaxError,at=Function,st=TypeError,ot=function(Ht){try{return at('"use strict"; return ('+Ht+").constructor;")()}catch{}},lt=Object.getOwnPropertyDescriptor;if(lt)try{lt({},"")}catch{lt=null}var ht=function(){throw new st},dt=lt?(function(){try{return ht}catch{try{return lt(arguments,"callee").get}catch{return ht}}})():ht,ut=tt("has-symbols")(),ft=Object.getPrototypeOf||function(Ht){return Ht.__proto__},mt={},gt=typeof Uint8Array>"u"?nt:ft(Uint8Array),vt={"%AggregateError%":typeof AggregateError>"u"?nt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?nt:ArrayBuffer,"%ArrayIteratorPrototype%":ut?ft([][Symbol.iterator]()):nt,"%AsyncFromSyncIteratorPrototype%":nt,"%AsyncFunction%":mt,"%AsyncGenerator%":mt,"%AsyncGeneratorFunction%":mt,"%AsyncIteratorPrototype%":mt,"%Atomics%":typeof Atomics>"u"?nt:Atomics,"%BigInt%":typeof BigInt>"u"?nt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?nt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?nt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?nt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?nt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?nt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?nt:FinalizationRegistry,"%Function%":at,"%GeneratorFunction%":mt,"%Int8Array%":typeof Int8Array>"u"?nt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?nt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?nt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ut?ft(ft([][Symbol.iterator]())):nt,"%JSON%":typeof JSON=="object"?JSON:nt,"%Map%":typeof Map>"u"?nt:Map,"%MapIteratorPrototype%":typeof Map<"u"&&ut?ft(new Map()[Symbol.iterator]()):nt,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?nt:Promise,"%Proxy%":typeof Proxy>"u"?nt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?nt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?nt:Set,"%SetIteratorPrototype%":typeof Set<"u"&&ut?ft(new Set()[Symbol.iterator]()):nt,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?nt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ut?ft(""[Symbol.iterator]()):nt,"%Symbol%":ut?Symbol:nt,"%SyntaxError%":it,"%ThrowTypeError%":dt,"%TypedArray%":gt,"%TypeError%":st,"%Uint8Array%":typeof Uint8Array>"u"?nt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?nt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?nt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?nt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?nt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?nt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?nt:WeakSet};try{null.error}catch(Ht){var xt=ft(ft(Ht));vt["%Error.prototype%"]=xt}var wt=function Ht(qt){var Bt;if(qt==="%AsyncFunction%")Bt=ot("async function () {}");else if(qt==="%GeneratorFunction%")Bt=ot("function* () {}");else if(qt==="%AsyncGeneratorFunction%")Bt=ot("async function* () {}");else if(qt==="%AsyncGenerator%"){var Xt=Ht("%AsyncGeneratorFunction%");Xt&&(Bt=Xt.prototype)}else if(qt==="%AsyncIteratorPrototype%"){var Ft=Ht("%AsyncGenerator%");Ft&&(Bt=ft(Ft.prototype))}return vt[qt]=Bt,Bt},At={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Tt=tt("function-bind"),Pt=tt("has"),Rt=Tt.call(Function.call,Array.prototype.concat),Ot=Tt.call(Function.apply,Array.prototype.splice),Et=Tt.call(Function.call,String.prototype.replace),Lt=Tt.call(Function.call,String.prototype.slice),kt=Tt.call(Function.call,RegExp.prototype.exec),jt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Mt=/\\(\\)?/g,$t=function(Ht){var qt=Lt(Ht,0,1),Bt=Lt(Ht,-1);if(qt==="%"&&Bt!=="%")throw new it("invalid intrinsic syntax, expected closing `%`");if(Bt==="%"&&qt!=="%")throw new it("invalid intrinsic syntax, expected opening `%`");var Xt=[];return Et(Ht,jt,(function(Ft,Wt,Yt,zt){Xt[Xt.length]=Yt?Et(zt,Mt,"$1"):Wt||Ft})),Xt},Qt=function(Ht,qt){var Bt,Xt=Ht;if(Pt(At,Xt)&&(Xt="%"+(Bt=At[Xt])[0]+"%"),Pt(vt,Xt)){var Ft=vt[Xt];if(Ft===mt&&(Ft=wt(Xt)),Ft===void 0&&!qt)throw new st("intrinsic "+Ht+" exists, but is not available. Please file an issue!");return{alias:Bt,name:Xt,value:Ft}}throw new it("intrinsic "+Ht+" does not exist!")};et.exports=function(Ht,qt){if(typeof Ht!="string"||Ht.length===0)throw new st("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof qt!="boolean")throw new st('"allowMissing" argument must be a boolean');if(kt(/^%?[^%]*%?$/,Ht)===null)throw new it("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Bt=$t(Ht),Xt=Bt.length>0?Bt[0]:"",Ft=Qt("%"+Xt+"%",qt),Wt=Ft.name,Yt=Ft.value,zt=!1,er=Ft.alias;er&&(Xt=er[0],Ot(Bt,Rt([0,1],er)));for(var dr=1,fr=!0;dr<Bt.length;dr+=1){var lr=Bt[dr],mr=Lt(lr,0,1),br=Lt(lr,-1);if((mr==='"'||mr==="'"||mr==="`"||br==='"'||br==="'"||br==="`")&&mr!==br)throw new it("property names with quotes must have matching quotes");if(lr!=="constructor"&&fr||(zt=!0),Pt(vt,Wt="%"+(Xt+="."+lr)+"%"))Yt=vt[Wt];else if(Yt!=null){if(!(lr in Yt)){if(!qt)throw new st("base intrinsic for "+Ht+" exists, but the property is not available.");return}if(lt&&dr+1>=Bt.length){var Sr=lt(Yt,lr);Yt=(fr=!!Sr)&&"get"in Sr&&!("originalValue"in Sr.get)?Sr.get:Yt[lr]}else fr=Pt(Yt,lr),Yt=Yt[lr];fr&&!zt&&(vt[Wt]=Yt)}}return Yt}},{"function-bind":38,has:44,"has-symbols":41}],40:[function(tt,et,rt){var nt=tt("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(nt)try{nt([],"length")}catch{nt=null}et.exports=nt},{"get-intrinsic":39}],41:[function(tt,et,rt){var nt=typeof Symbol<"u"&&Symbol,it=tt("./shams");et.exports=function(){return typeof nt=="function"&&typeof Symbol=="function"&&typeof nt("foo")=="symbol"&&typeof Symbol("bar")=="symbol"&&it()}},{"./shams":42}],42:[function(tt,et,rt){et.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var nt={},it=Symbol("test"),at=Object(it);if(typeof it=="string"||Object.prototype.toString.call(it)!=="[object Symbol]"||Object.prototype.toString.call(at)!=="[object Symbol]")return!1;var st=42;for(it in nt[it]=st,nt)return!1;if(typeof Object.keys=="function"&&Object.keys(nt).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(nt).length!==0)return!1;var ot=Object.getOwnPropertySymbols(nt);if(ot.length!==1||ot[0]!==it||!Object.prototype.propertyIsEnumerable.call(nt,it))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var lt=Object.getOwnPropertyDescriptor(nt,it);if(lt.value!==st||lt.enumerable!==!0)return!1}return!0}},{}],43:[function(tt,et,rt){var nt=tt("has-symbols/shams");et.exports=function(){return nt()&&!!Symbol.toStringTag}},{"has-symbols/shams":42}],44:[function(tt,et,rt){var nt=tt("function-bind");et.exports=nt.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":38}],45:[function(tt,et,rt){rt.read=function(nt,it,at,st,ot){var lt,ht,dt=8*ot-st-1,ut=(1<<dt)-1,ft=ut>>1,mt=-7,gt=at?ot-1:0,vt=at?-1:1,xt=nt[it+gt];for(gt+=vt,lt=xt&(1<<-mt)-1,xt>>=-mt,mt+=dt;mt>0;lt=256*lt+nt[it+gt],gt+=vt,mt-=8);for(ht=lt&(1<<-mt)-1,lt>>=-mt,mt+=st;mt>0;ht=256*ht+nt[it+gt],gt+=vt,mt-=8);if(lt===0)lt=1-ft;else{if(lt===ut)return ht?NaN:1/0*(xt?-1:1);ht+=Math.pow(2,st),lt-=ft}return(xt?-1:1)*ht*Math.pow(2,lt-st)},rt.write=function(nt,it,at,st,ot,lt){var ht,dt,ut,ft=8*lt-ot-1,mt=(1<<ft)-1,gt=mt>>1,vt=ot===23?Math.pow(2,-24)-Math.pow(2,-77):0,xt=st?0:lt-1,wt=st?1:-1,At=it<0||it===0&&1/it<0?1:0;for(it=Math.abs(it),isNaN(it)||it===1/0?(dt=isNaN(it)?1:0,ht=mt):(ht=Math.floor(Math.log(it)/Math.LN2),it*(ut=Math.pow(2,-ht))<1&&(ht--,ut*=2),(it+=ht+gt>=1?vt/ut:vt*Math.pow(2,1-gt))*ut>=2&&(ht++,ut/=2),ht+gt>=mt?(dt=0,ht=mt):ht+gt>=1?(dt=(it*ut-1)*Math.pow(2,ot),ht+=gt):(dt=it*Math.pow(2,gt-1)*Math.pow(2,ot),ht=0));ot>=8;nt[at+xt]=255&dt,xt+=wt,dt/=256,ot-=8);for(ht=ht<<ot|dt,ft+=ot;ft>0;nt[at+xt]=255&ht,xt+=wt,ht/=256,ft-=8);nt[at+xt-wt]|=128*At}},{}],46:[function(tt,et,rt){typeof Object.create=="function"?et.exports=function(nt,it){it&&(nt.super_=it,nt.prototype=Object.create(it.prototype,{constructor:{value:nt,enumerable:!1,writable:!0,configurable:!0}}))}:et.exports=function(nt,it){if(it){nt.super_=it;var at=function(){};at.prototype=it.prototype,nt.prototype=new at,nt.prototype.constructor=nt}}},{}],47:[function(tt,et,rt){var nt=tt("has-tostringtag/shams")(),it=tt("call-bind/callBound")("Object.prototype.toString"),at=function(lt){return!(nt&&lt&&typeof lt=="object"&&Symbol.toStringTag in lt)&&it(lt)==="[object Arguments]"},st=function(lt){return!!at(lt)||lt!==null&&typeof lt=="object"&&typeof lt.length=="number"&&lt.length>=0&&it(lt)!=="[object Array]"&&it(lt.callee)==="[object Function]"},ot=(function(){return at(arguments)})();at.isLegacyArguments=st,et.exports=ot?at:st},{"call-bind/callBound":33,"has-tostringtag/shams":43}],48:[function(tt,et,rt){var nt,it,at=Function.prototype.toString,st=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply;if(typeof st=="function"&&typeof Object.defineProperty=="function")try{nt=Object.defineProperty({},"length",{get:function(){throw it}}),it={},st((function(){throw 42}),null,nt)}catch(Rt){Rt!==it&&(st=null)}else st=null;var ot=/^\s*class\b/,lt=function(Rt){try{var Ot=at.call(Rt);return ot.test(Ot)}catch{return!1}},ht=function(Rt){try{return!lt(Rt)&&(at.call(Rt),!0)}catch{return!1}},dt=Object.prototype.toString,ut="[object Object]",ft="[object Function]",mt="[object GeneratorFunction]",gt="[object HTMLAllCollection]",vt="[object HTML document.all class]",xt="[object HTMLCollection]",wt=typeof Symbol=="function"&&!!Symbol.toStringTag,At=!(0 in[,]),Tt=function(){return!1};if(typeof document=="object"){var Pt=document.all;dt.call(Pt)===dt.call(document.all)&&(Tt=function(Rt){if((At||!Rt)&&(Rt===void 0||typeof Rt=="object"))try{var Ot=dt.call(Rt);return(Ot===gt||Ot===vt||Ot===xt||Ot===ut)&&Rt("")==null}catch{}return!1})}et.exports=st?function(Rt){if(Tt(Rt))return!0;if(!Rt||typeof Rt!="function"&&typeof Rt!="object")return!1;try{st(Rt,null,nt)}catch(Ot){if(Ot!==it)return!1}return!lt(Rt)&&ht(Rt)}:function(Rt){if(Tt(Rt))return!0;if(!Rt||typeof Rt!="function"&&typeof Rt!="object")return!1;if(wt)return ht(Rt);if(lt(Rt))return!1;var Ot=dt.call(Rt);return!(Ot!==ft&&Ot!==mt&&!/^\[object HTML/.test(Ot))&&ht(Rt)}},{}],49:[function(tt,et,rt){var nt,it=Object.prototype.toString,at=Function.prototype.toString,st=/^\s*(?:function)?\*/,ot=tt("has-tostringtag/shams")(),lt=Object.getPrototypeOf,ht=function(){if(!ot)return!1;try{return Function("return function*() {}")()}catch{}};et.exports=function(dt){if(typeof dt!="function")return!1;if(st.test(at.call(dt)))return!0;if(!ot)return it.call(dt)==="[object GeneratorFunction]";if(!lt)return!1;if(nt===void 0){var ut=ht();nt=!!ut&&lt(ut)}return lt(dt)===nt}},{"has-tostringtag/shams":43}],50:[function(tt,et,rt){(function(nt){(function(){var it=tt("for-each"),at=tt("available-typed-arrays"),st=tt("call-bind/callBound"),ot=st("Object.prototype.toString"),lt=tt("has-tostringtag/shams")(),ht=tt("gopd"),dt=typeof globalThis>"u"?nt:globalThis,ut=at(),ft=st("Array.prototype.indexOf",!0)||function(wt,At){for(var Tt=0;Tt<wt.length;Tt+=1)if(wt[Tt]===At)return Tt;return-1},mt=st("String.prototype.slice"),gt={},vt=Object.getPrototypeOf;lt&&ht&&vt&&it(ut,(function(wt){var At=new dt[wt];if(Symbol.toStringTag in At){var Tt=vt(At),Pt=ht(Tt,Symbol.toStringTag);if(!Pt){var Rt=vt(Tt);Pt=ht(Rt,Symbol.toStringTag)}gt[wt]=Pt.get}}));var xt=function(wt){var At=!1;return it(gt,(function(Tt,Pt){if(!At)try{At=Tt.call(wt)===Pt}catch{}})),At};et.exports=function(wt){if(!wt||typeof wt!="object")return!1;if(!lt||!(Symbol.toStringTag in wt)){var At=mt(ot(wt),8,-1);return ft(ut,At)>-1}return!!ht&&xt(wt)}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43}],51:[function(tt,et,rt){var nt=Object.getOwnPropertySymbols,it=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable;function st(lt){if(lt==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(lt)}function ot(){try{if(!Object.assign)return!1;var lt=new String("abc");if(lt[5]="de",Object.getOwnPropertyNames(lt)[0]==="5")return!1;for(var ht={},dt=0;dt<10;dt++)ht["_"+String.fromCharCode(dt)]=dt;var ut=Object.getOwnPropertyNames(ht).map((function(mt){return ht[mt]}));if(ut.join("")!=="0123456789")return!1;var ft={};return"abcdefghijklmnopqrst".split("").forEach((function(mt){ft[mt]=mt})),Object.keys(Object.assign({},ft)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}et.exports=ot()?Object.assign:function(lt,ht){for(var dt,ut,ft=st(lt),mt=1;mt<arguments.length;mt++){for(var gt in dt=Object(arguments[mt]))it.call(dt,gt)&&(ft[gt]=dt[gt]);if(nt){ut=nt(dt);for(var vt=0;vt<ut.length;vt++)at.call(dt,ut[vt])&&(ft[ut[vt]]=dt[ut[vt]])}}return ft}},{}],52:[function(tt,et,rt){var nt=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function it(ot,lt){return Object.prototype.hasOwnProperty.call(ot,lt)}rt.assign=function(ot){for(var lt=Array.prototype.slice.call(arguments,1);lt.length;){var ht=lt.shift();if(ht){if(typeof ht!="object")throw new TypeError(ht+"must be non-object");for(var dt in ht)it(ht,dt)&&(ot[dt]=ht[dt])}}return ot},rt.shrinkBuf=function(ot,lt){return ot.length===lt?ot:ot.subarray?ot.subarray(0,lt):(ot.length=lt,ot)};var at={arraySet:function(ot,lt,ht,dt,ut){if(lt.subarray&&ot.subarray)ot.set(lt.subarray(ht,ht+dt),ut);else for(var ft=0;ft<dt;ft++)ot[ut+ft]=lt[ht+ft]},flattenChunks:function(ot){var lt,ht,dt,ut,ft,mt;for(dt=0,lt=0,ht=ot.length;lt<ht;lt++)dt+=ot[lt].length;for(mt=new Uint8Array(dt),ut=0,lt=0,ht=ot.length;lt<ht;lt++)ft=ot[lt],mt.set(ft,ut),ut+=ft.length;return mt}},st={arraySet:function(ot,lt,ht,dt,ut){for(var ft=0;ft<dt;ft++)ot[ut+ft]=lt[ht+ft]},flattenChunks:function(ot){return[].concat.apply([],ot)}};rt.setTyped=function(ot){ot?(rt.Buf8=Uint8Array,rt.Buf16=Uint16Array,rt.Buf32=Int32Array,rt.assign(rt,at)):(rt.Buf8=Array,rt.Buf16=Array,rt.Buf32=Array,rt.assign(rt,st))},rt.setTyped(nt)},{}],53:[function(tt,et,rt){function nt(it,at,st,ot){for(var lt=65535&it,ht=it>>>16&65535,dt=0;st!==0;){st-=dt=st>2e3?2e3:st;do ht=ht+(lt=lt+at[ot++]|0)|0;while(--dt);lt%=65521,ht%=65521}return lt|ht<<16}et.exports=nt},{}],54:[function(tt,et,rt){et.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],55:[function(tt,et,rt){function nt(){for(var st,ot=[],lt=0;lt<256;lt++){st=lt;for(var ht=0;ht<8;ht++)st=1&st?3988292384^st>>>1:st>>>1;ot[lt]=st}return ot}var it=nt();function at(st,ot,lt,ht){var dt=it,ut=ht+lt;st^=-1;for(var ft=ht;ft<ut;ft++)st=st>>>8^dt[255&(st^ot[ft])];return~st}et.exports=at},{}],56:[function(tt,et,rt){var nt,it=tt("../utils/common"),at=tt("./trees"),st=tt("./adler32"),ot=tt("./crc32"),lt=tt("./messages"),ht=0,dt=1,ut=3,ft=4,mt=5,gt=0,vt=1,xt=-2,wt=-3,At=-5,Tt=-1,Pt=1,Rt=2,Ot=3,Et=4,Lt=0,kt=2,jt=8,Mt=9,$t=15,Qt=8,Ht=286,qt=30,Bt=19,Xt=2*Ht+1,Ft=15,Wt=3,Yt=258,zt=Yt+Wt+1,er=32,dr=42,fr=69,lr=73,mr=91,br=103,Sr=113,Ir=666,cr=1,Nt=2,pr=3,rr=4,ar=3;function nr(Zt,Qr){return Zt.msg=lt[Qr],Qr}function ur(Zt){return(Zt<<1)-(Zt>4?9:0)}function Er(Zt){for(var Qr=Zt.length;--Qr>=0;)Zt[Qr]=0}function Ut(Zt){var Qr=Zt.state,Dr=Qr.pending;Dr>Zt.avail_out&&(Dr=Zt.avail_out),Dr!==0&&(it.arraySet(Zt.output,Qr.pending_buf,Qr.pending_out,Dr,Zt.next_out),Zt.next_out+=Dr,Qr.pending_out+=Dr,Zt.total_out+=Dr,Zt.avail_out-=Dr,Qr.pending-=Dr,Qr.pending===0&&(Qr.pending_out=0))}function Kt(Zt,Qr){at._tr_flush_block(Zt,Zt.block_start>=0?Zt.block_start:-1,Zt.strstart-Zt.block_start,Qr),Zt.block_start=Zt.strstart,Ut(Zt.strm)}function or(Zt,Qr){Zt.pending_buf[Zt.pending++]=Qr}function hr(Zt,Qr){Zt.pending_buf[Zt.pending++]=Qr>>>8&255,Zt.pending_buf[Zt.pending++]=255&Qr}function kr(Zt,Qr,Dr,Pr){var Hr=Zt.avail_in;return Hr>Pr&&(Hr=Pr),Hr===0?0:(Zt.avail_in-=Hr,it.arraySet(Qr,Zt.input,Zt.next_in,Hr,Dr),Zt.state.wrap===1?Zt.adler=st(Zt.adler,Qr,Hr,Dr):Zt.state.wrap===2&&(Zt.adler=ot(Zt.adler,Qr,Hr,Dr)),Zt.next_in+=Hr,Zt.total_in+=Hr,Hr)}function Br(Zt,Qr){var Dr,Pr,Hr=Zt.max_chain_length,qr=Zt.strstart,bi=Zt.prev_length,ri=Zt.nice_match,yi=Zt.strstart>Zt.w_size-zt?Zt.strstart-(Zt.w_size-zt):0,Li=Zt.window,xa=Zt.w_mask,Ti=Zt.prev,$i=Zt.strstart+Yt,Ji=Li[qr+bi-1],ea=Li[qr+bi];Zt.prev_length>=Zt.good_match&&(Hr>>=2),ri>Zt.lookahead&&(ri=Zt.lookahead);do if(Li[(Dr=Qr)+bi]===ea&&Li[Dr+bi-1]===Ji&&Li[Dr]===Li[qr]&&Li[++Dr]===Li[qr+1]){qr+=2,Dr++;do;while(Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&Li[++qr]===Li[++Dr]&&qr<$i);if(Pr=Yt-($i-qr),qr=$i-Yt,Pr>bi){if(Zt.match_start=Qr,bi=Pr,Pr>=ri)break;Ji=Li[qr+bi-1],ea=Li[qr+bi]}}while((Qr=Ti[Qr&xa])>yi&&--Hr!=0);return bi<=Zt.lookahead?bi:Zt.lookahead}function Gn(Zt){var Qr,Dr,Pr,Hr,qr,bi=Zt.w_size;do{if(Hr=Zt.window_size-Zt.lookahead-Zt.strstart,Zt.strstart>=bi+(bi-zt)){it.arraySet(Zt.window,Zt.window,bi,bi,0),Zt.match_start-=bi,Zt.strstart-=bi,Zt.block_start-=bi,Qr=Dr=Zt.hash_size;do Pr=Zt.head[--Qr],Zt.head[Qr]=Pr>=bi?Pr-bi:0;while(--Dr);Qr=Dr=bi;do Pr=Zt.prev[--Qr],Zt.prev[Qr]=Pr>=bi?Pr-bi:0;while(--Dr);Hr+=bi}if(Zt.strm.avail_in===0)break;if(Dr=kr(Zt.strm,Zt.window,Zt.strstart+Zt.lookahead,Hr),Zt.lookahead+=Dr,Zt.lookahead+Zt.insert>=Wt)for(qr=Zt.strstart-Zt.insert,Zt.ins_h=Zt.window[qr],Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[qr+1])&Zt.hash_mask;Zt.insert&&(Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[qr+Wt-1])&Zt.hash_mask,Zt.prev[qr&Zt.w_mask]=Zt.head[Zt.ins_h],Zt.head[Zt.ins_h]=qr,qr++,Zt.insert--,!(Zt.lookahead+Zt.insert<Wt)););}while(Zt.lookahead<zt&&Zt.strm.avail_in!==0)}function Xn(Zt,Qr){var Dr=65535;for(Dr>Zt.pending_buf_size-5&&(Dr=Zt.pending_buf_size-5);;){if(Zt.lookahead<=1){if(Gn(Zt),Zt.lookahead===0&&Qr===ht)return cr;if(Zt.lookahead===0)break}Zt.strstart+=Zt.lookahead,Zt.lookahead=0;var Pr=Zt.block_start+Dr;if((Zt.strstart===0||Zt.strstart>=Pr)&&(Zt.lookahead=Zt.strstart-Pr,Zt.strstart=Pr,Kt(Zt,!1),Zt.strm.avail_out===0)||Zt.strstart-Zt.block_start>=Zt.w_size-zt&&(Kt(Zt,!1),Zt.strm.avail_out===0))return cr}return Zt.insert=0,Qr===ft?(Kt(Zt,!0),Zt.strm.avail_out===0?pr:rr):(Zt.strstart>Zt.block_start&&(Kt(Zt,!1),Zt.strm.avail_out),cr)}function Mn(Zt,Qr){for(var Dr,Pr;;){if(Zt.lookahead<zt){if(Gn(Zt),Zt.lookahead<zt&&Qr===ht)return cr;if(Zt.lookahead===0)break}if(Dr=0,Zt.lookahead>=Wt&&(Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[Zt.strstart+Wt-1])&Zt.hash_mask,Dr=Zt.prev[Zt.strstart&Zt.w_mask]=Zt.head[Zt.ins_h],Zt.head[Zt.ins_h]=Zt.strstart),Dr!==0&&Zt.strstart-Dr<=Zt.w_size-zt&&(Zt.match_length=Br(Zt,Dr)),Zt.match_length>=Wt)if(Pr=at._tr_tally(Zt,Zt.strstart-Zt.match_start,Zt.match_length-Wt),Zt.lookahead-=Zt.match_length,Zt.match_length<=Zt.max_lazy_match&&Zt.lookahead>=Wt){Zt.match_length--;do Zt.strstart++,Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[Zt.strstart+Wt-1])&Zt.hash_mask,Dr=Zt.prev[Zt.strstart&Zt.w_mask]=Zt.head[Zt.ins_h],Zt.head[Zt.ins_h]=Zt.strstart;while(--Zt.match_length!=0);Zt.strstart++}else Zt.strstart+=Zt.match_length,Zt.match_length=0,Zt.ins_h=Zt.window[Zt.strstart],Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[Zt.strstart+1])&Zt.hash_mask;else Pr=at._tr_tally(Zt,0,Zt.window[Zt.strstart]),Zt.lookahead--,Zt.strstart++;if(Pr&&(Kt(Zt,!1),Zt.strm.avail_out===0))return cr}return Zt.insert=Zt.strstart<Wt-1?Zt.strstart:Wt-1,Qr===ft?(Kt(Zt,!0),Zt.strm.avail_out===0?pr:rr):Zt.last_lit&&(Kt(Zt,!1),Zt.strm.avail_out===0)?cr:Nt}function Kn(Zt,Qr){for(var Dr,Pr,Hr;;){if(Zt.lookahead<zt){if(Gn(Zt),Zt.lookahead<zt&&Qr===ht)return cr;if(Zt.lookahead===0)break}if(Dr=0,Zt.lookahead>=Wt&&(Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[Zt.strstart+Wt-1])&Zt.hash_mask,Dr=Zt.prev[Zt.strstart&Zt.w_mask]=Zt.head[Zt.ins_h],Zt.head[Zt.ins_h]=Zt.strstart),Zt.prev_length=Zt.match_length,Zt.prev_match=Zt.match_start,Zt.match_length=Wt-1,Dr!==0&&Zt.prev_length<Zt.max_lazy_match&&Zt.strstart-Dr<=Zt.w_size-zt&&(Zt.match_length=Br(Zt,Dr),Zt.match_length<=5&&(Zt.strategy===Pt||Zt.match_length===Wt&&Zt.strstart-Zt.match_start>4096)&&(Zt.match_length=Wt-1)),Zt.prev_length>=Wt&&Zt.match_length<=Zt.prev_length){Hr=Zt.strstart+Zt.lookahead-Wt,Pr=at._tr_tally(Zt,Zt.strstart-1-Zt.prev_match,Zt.prev_length-Wt),Zt.lookahead-=Zt.prev_length-1,Zt.prev_length-=2;do++Zt.strstart<=Hr&&(Zt.ins_h=(Zt.ins_h<<Zt.hash_shift^Zt.window[Zt.strstart+Wt-1])&Zt.hash_mask,Dr=Zt.prev[Zt.strstart&Zt.w_mask]=Zt.head[Zt.ins_h],Zt.head[Zt.ins_h]=Zt.strstart);while(--Zt.prev_length!=0);if(Zt.match_available=0,Zt.match_length=Wt-1,Zt.strstart++,Pr&&(Kt(Zt,!1),Zt.strm.avail_out===0))return cr}else if(Zt.match_available){if((Pr=at._tr_tally(Zt,0,Zt.window[Zt.strstart-1]))&&Kt(Zt,!1),Zt.strstart++,Zt.lookahead--,Zt.strm.avail_out===0)return cr}else Zt.match_available=1,Zt.strstart++,Zt.lookahead--}return Zt.match_available&&(Pr=at._tr_tally(Zt,0,Zt.window[Zt.strstart-1]),Zt.match_available=0),Zt.insert=Zt.strstart<Wt-1?Zt.strstart:Wt-1,Qr===ft?(Kt(Zt,!0),Zt.strm.avail_out===0?pr:rr):Zt.last_lit&&(Kt(Zt,!1),Zt.strm.avail_out===0)?cr:Nt}function Vn(Zt,Qr){for(var Dr,Pr,Hr,qr,bi=Zt.window;;){if(Zt.lookahead<=Yt){if(Gn(Zt),Zt.lookahead<=Yt&&Qr===ht)return cr;if(Zt.lookahead===0)break}if(Zt.match_length=0,Zt.lookahead>=Wt&&Zt.strstart>0&&(Pr=bi[Hr=Zt.strstart-1])===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]){qr=Zt.strstart+Yt;do;while(Pr===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]&&Pr===bi[++Hr]&&Hr<qr);Zt.match_length=Yt-(qr-Hr),Zt.match_length>Zt.lookahead&&(Zt.match_length=Zt.lookahead)}if(Zt.match_length>=Wt?(Dr=at._tr_tally(Zt,1,Zt.match_length-Wt),Zt.lookahead-=Zt.match_length,Zt.strstart+=Zt.match_length,Zt.match_length=0):(Dr=at._tr_tally(Zt,0,Zt.window[Zt.strstart]),Zt.lookahead--,Zt.strstart++),Dr&&(Kt(Zt,!1),Zt.strm.avail_out===0))return cr}return Zt.insert=0,Qr===ft?(Kt(Zt,!0),Zt.strm.avail_out===0?pr:rr):Zt.last_lit&&(Kt(Zt,!1),Zt.strm.avail_out===0)?cr:Nt}function vi(Zt,Qr){for(var Dr;;){if(Zt.lookahead===0&&(Gn(Zt),Zt.lookahead===0)){if(Qr===ht)return cr;break}if(Zt.match_length=0,Dr=at._tr_tally(Zt,0,Zt.window[Zt.strstart]),Zt.lookahead--,Zt.strstart++,Dr&&(Kt(Zt,!1),Zt.strm.avail_out===0))return cr}return Zt.insert=0,Qr===ft?(Kt(Zt,!0),Zt.strm.avail_out===0?pr:rr):Zt.last_lit&&(Kt(Zt,!1),Zt.strm.avail_out===0)?cr:Nt}function mi(Zt,Qr,Dr,Pr,Hr){this.good_length=Zt,this.max_lazy=Qr,this.nice_length=Dr,this.max_chain=Pr,this.func=Hr}function _i(Zt){Zt.window_size=2*Zt.w_size,Er(Zt.head),Zt.max_lazy_match=nt[Zt.level].max_lazy,Zt.good_match=nt[Zt.level].good_length,Zt.nice_match=nt[Zt.level].nice_length,Zt.max_chain_length=nt[Zt.level].max_chain,Zt.strstart=0,Zt.block_start=0,Zt.lookahead=0,Zt.insert=0,Zt.match_length=Zt.prev_length=Wt-1,Zt.match_available=0,Zt.ins_h=0}function Ri(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=jt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new it.Buf16(2*Xt),this.dyn_dtree=new it.Buf16(2*(2*qt+1)),this.bl_tree=new it.Buf16(2*(2*Bt+1)),Er(this.dyn_ltree),Er(this.dyn_dtree),Er(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new it.Buf16(Ft+1),this.heap=new it.Buf16(2*Ht+1),Er(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new it.Buf16(2*Ht+1),Er(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pi(Zt){var Qr;return Zt&&Zt.state?(Zt.total_in=Zt.total_out=0,Zt.data_type=kt,(Qr=Zt.state).pending=0,Qr.pending_out=0,Qr.wrap<0&&(Qr.wrap=-Qr.wrap),Qr.status=Qr.wrap?dr:Sr,Zt.adler=Qr.wrap===2?0:1,Qr.last_flush=ht,at._tr_init(Qr),gt):nr(Zt,xt)}function Tr(Zt){var Qr=pi(Zt);return Qr===gt&&_i(Zt.state),Qr}function qn(Zt,Qr){return Zt&&Zt.state?Zt.state.wrap!==2?xt:(Zt.state.gzhead=Qr,gt):xt}function _r(Zt,Qr,Dr,Pr,Hr,qr){if(!Zt)return xt;var bi=1;if(Qr===Tt&&(Qr=6),Pr<0?(bi=0,Pr=-Pr):Pr>15&&(bi=2,Pr-=16),Hr<1||Hr>Mt||Dr!==jt||Pr<8||Pr>15||Qr<0||Qr>9||qr<0||qr>Et)return nr(Zt,xt);Pr===8&&(Pr=9);var ri=new Ri;return Zt.state=ri,ri.strm=Zt,ri.wrap=bi,ri.gzhead=null,ri.w_bits=Pr,ri.w_size=1<<ri.w_bits,ri.w_mask=ri.w_size-1,ri.hash_bits=Hr+7,ri.hash_size=1<<ri.hash_bits,ri.hash_mask=ri.hash_size-1,ri.hash_shift=~~((ri.hash_bits+Wt-1)/Wt),ri.window=new it.Buf8(2*ri.w_size),ri.head=new it.Buf16(ri.hash_size),ri.prev=new it.Buf16(ri.w_size),ri.lit_bufsize=1<<Hr+6,ri.pending_buf_size=4*ri.lit_bufsize,ri.pending_buf=new it.Buf8(ri.pending_buf_size),ri.d_buf=1*ri.lit_bufsize,ri.l_buf=3*ri.lit_bufsize,ri.level=Qr,ri.strategy=qr,ri.method=Dr,Tr(Zt)}function Rr(Zt,Qr){return _r(Zt,Qr,jt,$t,Qt,Lt)}function yr(Zt,Qr){var Dr,Pr,Hr,qr;if(!Zt||!Zt.state||Qr>mt||Qr<0)return Zt?nr(Zt,xt):xt;if(Pr=Zt.state,!Zt.output||!Zt.input&&Zt.avail_in!==0||Pr.status===Ir&&Qr!==ft)return nr(Zt,Zt.avail_out===0?At:xt);if(Pr.strm=Zt,Dr=Pr.last_flush,Pr.last_flush=Qr,Pr.status===dr)if(Pr.wrap===2)Zt.adler=0,or(Pr,31),or(Pr,139),or(Pr,8),Pr.gzhead?(or(Pr,(Pr.gzhead.text?1:0)+(Pr.gzhead.hcrc?2:0)+(Pr.gzhead.extra?4:0)+(Pr.gzhead.name?8:0)+(Pr.gzhead.comment?16:0)),or(Pr,255&Pr.gzhead.time),or(Pr,Pr.gzhead.time>>8&255),or(Pr,Pr.gzhead.time>>16&255),or(Pr,Pr.gzhead.time>>24&255),or(Pr,Pr.level===9?2:Pr.strategy>=Rt||Pr.level<2?4:0),or(Pr,255&Pr.gzhead.os),Pr.gzhead.extra&&Pr.gzhead.extra.length&&(or(Pr,255&Pr.gzhead.extra.length),or(Pr,Pr.gzhead.extra.length>>8&255)),Pr.gzhead.hcrc&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending,0)),Pr.gzindex=0,Pr.status=fr):(or(Pr,0),or(Pr,0),or(Pr,0),or(Pr,0),or(Pr,0),or(Pr,Pr.level===9?2:Pr.strategy>=Rt||Pr.level<2?4:0),or(Pr,ar),Pr.status=Sr);else{var bi=jt+(Pr.w_bits-8<<4)<<8;bi|=(Pr.strategy>=Rt||Pr.level<2?0:Pr.level<6?1:Pr.level===6?2:3)<<6,Pr.strstart!==0&&(bi|=er),bi+=31-bi%31,Pr.status=Sr,hr(Pr,bi),Pr.strstart!==0&&(hr(Pr,Zt.adler>>>16),hr(Pr,65535&Zt.adler)),Zt.adler=1}if(Pr.status===fr)if(Pr.gzhead.extra){for(Hr=Pr.pending;Pr.gzindex<(65535&Pr.gzhead.extra.length)&&(Pr.pending!==Pr.pending_buf_size||(Pr.gzhead.hcrc&&Pr.pending>Hr&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending-Hr,Hr)),Ut(Zt),Hr=Pr.pending,Pr.pending!==Pr.pending_buf_size));)or(Pr,255&Pr.gzhead.extra[Pr.gzindex]),Pr.gzindex++;Pr.gzhead.hcrc&&Pr.pending>Hr&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending-Hr,Hr)),Pr.gzindex===Pr.gzhead.extra.length&&(Pr.gzindex=0,Pr.status=lr)}else Pr.status=lr;if(Pr.status===lr)if(Pr.gzhead.name){Hr=Pr.pending;do{if(Pr.pending===Pr.pending_buf_size&&(Pr.gzhead.hcrc&&Pr.pending>Hr&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending-Hr,Hr)),Ut(Zt),Hr=Pr.pending,Pr.pending===Pr.pending_buf_size)){qr=1;break}qr=Pr.gzindex<Pr.gzhead.name.length?255&Pr.gzhead.name.charCodeAt(Pr.gzindex++):0,or(Pr,qr)}while(qr!==0);Pr.gzhead.hcrc&&Pr.pending>Hr&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending-Hr,Hr)),qr===0&&(Pr.gzindex=0,Pr.status=mr)}else Pr.status=mr;if(Pr.status===mr)if(Pr.gzhead.comment){Hr=Pr.pending;do{if(Pr.pending===Pr.pending_buf_size&&(Pr.gzhead.hcrc&&Pr.pending>Hr&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending-Hr,Hr)),Ut(Zt),Hr=Pr.pending,Pr.pending===Pr.pending_buf_size)){qr=1;break}qr=Pr.gzindex<Pr.gzhead.comment.length?255&Pr.gzhead.comment.charCodeAt(Pr.gzindex++):0,or(Pr,qr)}while(qr!==0);Pr.gzhead.hcrc&&Pr.pending>Hr&&(Zt.adler=ot(Zt.adler,Pr.pending_buf,Pr.pending-Hr,Hr)),qr===0&&(Pr.status=br)}else Pr.status=br;if(Pr.status===br&&(Pr.gzhead.hcrc?(Pr.pending+2>Pr.pending_buf_size&&Ut(Zt),Pr.pending+2<=Pr.pending_buf_size&&(or(Pr,255&Zt.adler),or(Pr,Zt.adler>>8&255),Zt.adler=0,Pr.status=Sr)):Pr.status=Sr),Pr.pending!==0){if(Ut(Zt),Zt.avail_out===0)return Pr.last_flush=-1,gt}else if(Zt.avail_in===0&&ur(Qr)<=ur(Dr)&&Qr!==ft)return nr(Zt,At);if(Pr.status===Ir&&Zt.avail_in!==0)return nr(Zt,At);if(Zt.avail_in!==0||Pr.lookahead!==0||Qr!==ht&&Pr.status!==Ir){var ri=Pr.strategy===Rt?vi(Pr,Qr):Pr.strategy===Ot?Vn(Pr,Qr):nt[Pr.level].func(Pr,Qr);if(ri!==pr&&ri!==rr||(Pr.status=Ir),ri===cr||ri===pr)return Zt.avail_out===0&&(Pr.last_flush=-1),gt;if(ri===Nt&&(Qr===dt?at._tr_align(Pr):Qr!==mt&&(at._tr_stored_block(Pr,0,0,!1),Qr===ut&&(Er(Pr.head),Pr.lookahead===0&&(Pr.strstart=0,Pr.block_start=0,Pr.insert=0))),Ut(Zt),Zt.avail_out===0))return Pr.last_flush=-1,gt}return Qr!==ft?gt:Pr.wrap<=0?vt:(Pr.wrap===2?(or(Pr,255&Zt.adler),or(Pr,Zt.adler>>8&255),or(Pr,Zt.adler>>16&255),or(Pr,Zt.adler>>24&255),or(Pr,255&Zt.total_in),or(Pr,Zt.total_in>>8&255),or(Pr,Zt.total_in>>16&255),or(Pr,Zt.total_in>>24&255)):(hr(Pr,Zt.adler>>>16),hr(Pr,65535&Zt.adler)),Ut(Zt),Pr.wrap>0&&(Pr.wrap=-Pr.wrap),Pr.pending!==0?gt:vt)}function Kr(Zt){var Qr;return Zt&&Zt.state?(Qr=Zt.state.status)!==dr&&Qr!==fr&&Qr!==lr&&Qr!==mr&&Qr!==br&&Qr!==Sr&&Qr!==Ir?nr(Zt,xt):(Zt.state=null,Qr===Sr?nr(Zt,wt):gt):xt}function Jr(Zt,Qr){var Dr,Pr,Hr,qr,bi,ri,yi,Li,xa=Qr.length;if(!Zt||!Zt.state||(qr=(Dr=Zt.state).wrap)===2||qr===1&&Dr.status!==dr||Dr.lookahead)return xt;for(qr===1&&(Zt.adler=st(Zt.adler,Qr,xa,0)),Dr.wrap=0,xa>=Dr.w_size&&(qr===0&&(Er(Dr.head),Dr.strstart=0,Dr.block_start=0,Dr.insert=0),Li=new it.Buf8(Dr.w_size),it.arraySet(Li,Qr,xa-Dr.w_size,Dr.w_size,0),Qr=Li,xa=Dr.w_size),bi=Zt.avail_in,ri=Zt.next_in,yi=Zt.input,Zt.avail_in=xa,Zt.next_in=0,Zt.input=Qr,Gn(Dr);Dr.lookahead>=Wt;){Pr=Dr.strstart,Hr=Dr.lookahead-(Wt-1);do Dr.ins_h=(Dr.ins_h<<Dr.hash_shift^Dr.window[Pr+Wt-1])&Dr.hash_mask,Dr.prev[Pr&Dr.w_mask]=Dr.head[Dr.ins_h],Dr.head[Dr.ins_h]=Pr,Pr++;while(--Hr);Dr.strstart=Pr,Dr.lookahead=Wt-1,Gn(Dr)}return Dr.strstart+=Dr.lookahead,Dr.block_start=Dr.strstart,Dr.insert=Dr.lookahead,Dr.lookahead=0,Dr.match_length=Dr.prev_length=Wt-1,Dr.match_available=0,Zt.next_in=ri,Zt.input=yi,Zt.avail_in=bi,Dr.wrap=qr,gt}nt=[new mi(0,0,0,0,Xn),new mi(4,4,8,4,Mn),new mi(4,5,16,8,Mn),new mi(4,6,32,32,Mn),new mi(4,4,16,16,Kn),new mi(8,16,32,32,Kn),new mi(8,16,128,128,Kn),new mi(8,32,128,256,Kn),new mi(32,128,258,1024,Kn),new mi(32,258,258,4096,Kn)],rt.deflateInit=Rr,rt.deflateInit2=_r,rt.deflateReset=Tr,rt.deflateResetKeep=pi,rt.deflateSetHeader=qn,rt.deflate=yr,rt.deflateEnd=Kr,rt.deflateSetDictionary=Jr,rt.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./messages":60,"./trees":61}],57:[function(tt,et,rt){var nt=30,it=12;et.exports=function(at,st){var ot,lt,ht,dt,ut,ft,mt,gt,vt,xt,wt,At,Tt,Pt,Rt,Ot,Et,Lt,kt,jt,Mt,$t,Qt,Ht,qt;ot=at.state,lt=at.next_in,Ht=at.input,ht=lt+(at.avail_in-5),dt=at.next_out,qt=at.output,ut=dt-(st-at.avail_out),ft=dt+(at.avail_out-257),mt=ot.dmax,gt=ot.wsize,vt=ot.whave,xt=ot.wnext,wt=ot.window,At=ot.hold,Tt=ot.bits,Pt=ot.lencode,Rt=ot.distcode,Ot=(1<<ot.lenbits)-1,Et=(1<<ot.distbits)-1;e:do{Tt<15&&(At+=Ht[lt++]<<Tt,Tt+=8,At+=Ht[lt++]<<Tt,Tt+=8),Lt=Pt[At&Ot];t:for(;;){if(At>>>=kt=Lt>>>24,Tt-=kt,(kt=Lt>>>16&255)==0)qt[dt++]=65535&Lt;else{if(!(16&kt)){if(64&kt){if(32&kt){ot.mode=it;break e}at.msg="invalid literal/length code",ot.mode=nt;break e}Lt=Pt[(65535&Lt)+(At&(1<<kt)-1)];continue t}for(jt=65535&Lt,(kt&=15)&&(Tt<kt&&(At+=Ht[lt++]<<Tt,Tt+=8),jt+=At&(1<<kt)-1,At>>>=kt,Tt-=kt),Tt<15&&(At+=Ht[lt++]<<Tt,Tt+=8,At+=Ht[lt++]<<Tt,Tt+=8),Lt=Rt[At&Et];;){if(At>>>=kt=Lt>>>24,Tt-=kt,16&(kt=Lt>>>16&255)){if(Mt=65535&Lt,Tt<(kt&=15)&&(At+=Ht[lt++]<<Tt,(Tt+=8)<kt&&(At+=Ht[lt++]<<Tt,Tt+=8)),(Mt+=At&(1<<kt)-1)>mt){at.msg="invalid distance too far back",ot.mode=nt;break e}if(At>>>=kt,Tt-=kt,Mt>(kt=dt-ut)){if((kt=Mt-kt)>vt&&ot.sane){at.msg="invalid distance too far back",ot.mode=nt;break e}if($t=0,Qt=wt,xt===0){if($t+=gt-kt,kt<jt){jt-=kt;do qt[dt++]=wt[$t++];while(--kt);$t=dt-Mt,Qt=qt}}else if(xt<kt){if($t+=gt+xt-kt,(kt-=xt)<jt){jt-=kt;do qt[dt++]=wt[$t++];while(--kt);if($t=0,xt<jt){jt-=kt=xt;do qt[dt++]=wt[$t++];while(--kt);$t=dt-Mt,Qt=qt}}}else if($t+=xt-kt,kt<jt){jt-=kt;do qt[dt++]=wt[$t++];while(--kt);$t=dt-Mt,Qt=qt}for(;jt>2;)qt[dt++]=Qt[$t++],qt[dt++]=Qt[$t++],qt[dt++]=Qt[$t++],jt-=3;jt&&(qt[dt++]=Qt[$t++],jt>1&&(qt[dt++]=Qt[$t++]))}else{$t=dt-Mt;do qt[dt++]=qt[$t++],qt[dt++]=qt[$t++],qt[dt++]=qt[$t++],jt-=3;while(jt>2);jt&&(qt[dt++]=qt[$t++],jt>1&&(qt[dt++]=qt[$t++]))}break}if(64&kt){at.msg="invalid distance code",ot.mode=nt;break e}Lt=Rt[(65535&Lt)+(At&(1<<kt)-1)]}}break}}while(lt<ht&&dt<ft);lt-=jt=Tt>>3,At&=(1<<(Tt-=jt<<3))-1,at.next_in=lt,at.next_out=dt,at.avail_in=lt<ht?ht-lt+5:5-(lt-ht),at.avail_out=dt<ft?ft-dt+257:257-(dt-ft),ot.hold=At,ot.bits=Tt}},{}],58:[function(tt,et,rt){var nt=tt("../utils/common"),it=tt("./adler32"),at=tt("./crc32"),st=tt("./inffast"),ot=tt("./inftrees"),lt=0,ht=1,dt=2,ut=4,ft=5,mt=6,gt=0,vt=1,xt=2,wt=-2,At=-3,Tt=-4,Pt=-5,Rt=8,Ot=1,Et=2,Lt=3,kt=4,jt=5,Mt=6,$t=7,Qt=8,Ht=9,qt=10,Bt=11,Xt=12,Ft=13,Wt=14,Yt=15,zt=16,er=17,dr=18,fr=19,lr=20,mr=21,br=22,Sr=23,Ir=24,cr=25,Nt=26,pr=27,rr=28,ar=29,nr=30,ur=31,Er=852,Ut=592,Kt=15;function or(_r){return(_r>>>24&255)+(_r>>>8&65280)+((65280&_r)<<8)+((255&_r)<<24)}function hr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new nt.Buf16(320),this.work=new nt.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function kr(_r){var Rr;return _r&&_r.state?(Rr=_r.state,_r.total_in=_r.total_out=Rr.total=0,_r.msg="",Rr.wrap&&(_r.adler=1&Rr.wrap),Rr.mode=Ot,Rr.last=0,Rr.havedict=0,Rr.dmax=32768,Rr.head=null,Rr.hold=0,Rr.bits=0,Rr.lencode=Rr.lendyn=new nt.Buf32(Er),Rr.distcode=Rr.distdyn=new nt.Buf32(Ut),Rr.sane=1,Rr.back=-1,gt):wt}function Br(_r){var Rr;return _r&&_r.state?((Rr=_r.state).wsize=0,Rr.whave=0,Rr.wnext=0,kr(_r)):wt}function Gn(_r,Rr){var yr,Kr;return _r&&_r.state?(Kr=_r.state,Rr<0?(yr=0,Rr=-Rr):(yr=1+(Rr>>4),Rr<48&&(Rr&=15)),Rr&&(Rr<8||Rr>15)?wt:(Kr.window!==null&&Kr.wbits!==Rr&&(Kr.window=null),Kr.wrap=yr,Kr.wbits=Rr,Br(_r))):wt}function Xn(_r,Rr){var yr,Kr;return _r?(Kr=new hr,_r.state=Kr,Kr.window=null,(yr=Gn(_r,Rr))!==gt&&(_r.state=null),yr):wt}function Mn(_r){return Xn(_r,Kt)}var Kn,Vn,vi=!0;function mi(_r){if(vi){var Rr;for(Kn=new nt.Buf32(512),Vn=new nt.Buf32(32),Rr=0;Rr<144;)_r.lens[Rr++]=8;for(;Rr<256;)_r.lens[Rr++]=9;for(;Rr<280;)_r.lens[Rr++]=7;for(;Rr<288;)_r.lens[Rr++]=8;for(ot(ht,_r.lens,0,288,Kn,0,_r.work,{bits:9}),Rr=0;Rr<32;)_r.lens[Rr++]=5;ot(dt,_r.lens,0,32,Vn,0,_r.work,{bits:5}),vi=!1}_r.lencode=Kn,_r.lenbits=9,_r.distcode=Vn,_r.distbits=5}function _i(_r,Rr,yr,Kr){var Jr,Zt=_r.state;return Zt.window===null&&(Zt.wsize=1<<Zt.wbits,Zt.wnext=0,Zt.whave=0,Zt.window=new nt.Buf8(Zt.wsize)),Kr>=Zt.wsize?(nt.arraySet(Zt.window,Rr,yr-Zt.wsize,Zt.wsize,0),Zt.wnext=0,Zt.whave=Zt.wsize):((Jr=Zt.wsize-Zt.wnext)>Kr&&(Jr=Kr),nt.arraySet(Zt.window,Rr,yr-Kr,Jr,Zt.wnext),(Kr-=Jr)?(nt.arraySet(Zt.window,Rr,yr-Kr,Kr,0),Zt.wnext=Kr,Zt.whave=Zt.wsize):(Zt.wnext+=Jr,Zt.wnext===Zt.wsize&&(Zt.wnext=0),Zt.whave<Zt.wsize&&(Zt.whave+=Jr))),0}function Ri(_r,Rr){var yr,Kr,Jr,Zt,Qr,Dr,Pr,Hr,qr,bi,ri,yi,Li,xa,Ti,$i,Ji,ea,Na,Oa,la,ua,ka,Xi,ca=0,_a=new nt.Buf8(4),Ua=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_r||!_r.state||!_r.output||!_r.input&&_r.avail_in!==0)return wt;(yr=_r.state).mode===Xt&&(yr.mode=Ft),Qr=_r.next_out,Jr=_r.output,Pr=_r.avail_out,Zt=_r.next_in,Kr=_r.input,Dr=_r.avail_in,Hr=yr.hold,qr=yr.bits,bi=Dr,ri=Pr,ua=gt;e:for(;;)switch(yr.mode){case Ot:if(yr.wrap===0){yr.mode=Ft;break}for(;qr<16;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(2&yr.wrap&&Hr===35615){yr.check=0,_a[0]=255&Hr,_a[1]=Hr>>>8&255,yr.check=at(yr.check,_a,2,0),Hr=0,qr=0,yr.mode=Et;break}if(yr.flags=0,yr.head&&(yr.head.done=!1),!(1&yr.wrap)||(((255&Hr)<<8)+(Hr>>8))%31){_r.msg="incorrect header check",yr.mode=nr;break}if((15&Hr)!==Rt){_r.msg="unknown compression method",yr.mode=nr;break}if(qr-=4,la=8+(15&(Hr>>>=4)),yr.wbits===0)yr.wbits=la;else if(la>yr.wbits){_r.msg="invalid window size",yr.mode=nr;break}yr.dmax=1<<la,_r.adler=yr.check=1,yr.mode=512&Hr?qt:Xt,Hr=0,qr=0;break;case Et:for(;qr<16;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(yr.flags=Hr,(255&yr.flags)!==Rt){_r.msg="unknown compression method",yr.mode=nr;break}if(57344&yr.flags){_r.msg="unknown header flags set",yr.mode=nr;break}yr.head&&(yr.head.text=Hr>>8&1),512&yr.flags&&(_a[0]=255&Hr,_a[1]=Hr>>>8&255,yr.check=at(yr.check,_a,2,0)),Hr=0,qr=0,yr.mode=Lt;case Lt:for(;qr<32;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}yr.head&&(yr.head.time=Hr),512&yr.flags&&(_a[0]=255&Hr,_a[1]=Hr>>>8&255,_a[2]=Hr>>>16&255,_a[3]=Hr>>>24&255,yr.check=at(yr.check,_a,4,0)),Hr=0,qr=0,yr.mode=kt;case kt:for(;qr<16;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}yr.head&&(yr.head.xflags=255&Hr,yr.head.os=Hr>>8),512&yr.flags&&(_a[0]=255&Hr,_a[1]=Hr>>>8&255,yr.check=at(yr.check,_a,2,0)),Hr=0,qr=0,yr.mode=jt;case jt:if(1024&yr.flags){for(;qr<16;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}yr.length=Hr,yr.head&&(yr.head.extra_len=Hr),512&yr.flags&&(_a[0]=255&Hr,_a[1]=Hr>>>8&255,yr.check=at(yr.check,_a,2,0)),Hr=0,qr=0}else yr.head&&(yr.head.extra=null);yr.mode=Mt;case Mt:if(1024&yr.flags&&((yi=yr.length)>Dr&&(yi=Dr),yi&&(yr.head&&(la=yr.head.extra_len-yr.length,yr.head.extra||(yr.head.extra=new Array(yr.head.extra_len)),nt.arraySet(yr.head.extra,Kr,Zt,yi,la)),512&yr.flags&&(yr.check=at(yr.check,Kr,yi,Zt)),Dr-=yi,Zt+=yi,yr.length-=yi),yr.length))break e;yr.length=0,yr.mode=$t;case $t:if(2048&yr.flags){if(Dr===0)break e;yi=0;do la=Kr[Zt+yi++],yr.head&&la&&yr.length<65536&&(yr.head.name+=String.fromCharCode(la));while(la&&yi<Dr);if(512&yr.flags&&(yr.check=at(yr.check,Kr,yi,Zt)),Dr-=yi,Zt+=yi,la)break e}else yr.head&&(yr.head.name=null);yr.length=0,yr.mode=Qt;case Qt:if(4096&yr.flags){if(Dr===0)break e;yi=0;do la=Kr[Zt+yi++],yr.head&&la&&yr.length<65536&&(yr.head.comment+=String.fromCharCode(la));while(la&&yi<Dr);if(512&yr.flags&&(yr.check=at(yr.check,Kr,yi,Zt)),Dr-=yi,Zt+=yi,la)break e}else yr.head&&(yr.head.comment=null);yr.mode=Ht;case Ht:if(512&yr.flags){for(;qr<16;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(Hr!==(65535&yr.check)){_r.msg="header crc mismatch",yr.mode=nr;break}Hr=0,qr=0}yr.head&&(yr.head.hcrc=yr.flags>>9&1,yr.head.done=!0),_r.adler=yr.check=0,yr.mode=Xt;break;case qt:for(;qr<32;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}_r.adler=yr.check=or(Hr),Hr=0,qr=0,yr.mode=Bt;case Bt:if(yr.havedict===0)return _r.next_out=Qr,_r.avail_out=Pr,_r.next_in=Zt,_r.avail_in=Dr,yr.hold=Hr,yr.bits=qr,xt;_r.adler=yr.check=1,yr.mode=Xt;case Xt:if(Rr===ft||Rr===mt)break e;case Ft:if(yr.last){Hr>>>=7&qr,qr-=7&qr,yr.mode=pr;break}for(;qr<3;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}switch(yr.last=1&Hr,qr-=1,3&(Hr>>>=1)){case 0:yr.mode=Wt;break;case 1:if(mi(yr),yr.mode=lr,Rr===mt){Hr>>>=2,qr-=2;break e}break;case 2:yr.mode=er;break;case 3:_r.msg="invalid block type",yr.mode=nr}Hr>>>=2,qr-=2;break;case Wt:for(Hr>>>=7&qr,qr-=7&qr;qr<32;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if((65535&Hr)!=(Hr>>>16^65535)){_r.msg="invalid stored block lengths",yr.mode=nr;break}if(yr.length=65535&Hr,Hr=0,qr=0,yr.mode=Yt,Rr===mt)break e;case Yt:yr.mode=zt;case zt:if(yi=yr.length){if(yi>Dr&&(yi=Dr),yi>Pr&&(yi=Pr),yi===0)break e;nt.arraySet(Jr,Kr,Zt,yi,Qr),Dr-=yi,Zt+=yi,Pr-=yi,Qr+=yi,yr.length-=yi;break}yr.mode=Xt;break;case er:for(;qr<14;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(yr.nlen=257+(31&Hr),Hr>>>=5,qr-=5,yr.ndist=1+(31&Hr),Hr>>>=5,qr-=5,yr.ncode=4+(15&Hr),Hr>>>=4,qr-=4,yr.nlen>286||yr.ndist>30){_r.msg="too many length or distance symbols",yr.mode=nr;break}yr.have=0,yr.mode=dr;case dr:for(;yr.have<yr.ncode;){for(;qr<3;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}yr.lens[Ua[yr.have++]]=7&Hr,Hr>>>=3,qr-=3}for(;yr.have<19;)yr.lens[Ua[yr.have++]]=0;if(yr.lencode=yr.lendyn,yr.lenbits=7,ka={bits:yr.lenbits},ua=ot(lt,yr.lens,0,19,yr.lencode,0,yr.work,ka),yr.lenbits=ka.bits,ua){_r.msg="invalid code lengths set",yr.mode=nr;break}yr.have=0,yr.mode=fr;case fr:for(;yr.have<yr.nlen+yr.ndist;){for(;$i=(ca=yr.lencode[Hr&(1<<yr.lenbits)-1])>>>16&255,Ji=65535&ca,!((Ti=ca>>>24)<=qr);){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(Ji<16)Hr>>>=Ti,qr-=Ti,yr.lens[yr.have++]=Ji;else{if(Ji===16){for(Xi=Ti+2;qr<Xi;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(Hr>>>=Ti,qr-=Ti,yr.have===0){_r.msg="invalid bit length repeat",yr.mode=nr;break}la=yr.lens[yr.have-1],yi=3+(3&Hr),Hr>>>=2,qr-=2}else if(Ji===17){for(Xi=Ti+3;qr<Xi;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}qr-=Ti,la=0,yi=3+(7&(Hr>>>=Ti)),Hr>>>=3,qr-=3}else{for(Xi=Ti+7;qr<Xi;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}qr-=Ti,la=0,yi=11+(127&(Hr>>>=Ti)),Hr>>>=7,qr-=7}if(yr.have+yi>yr.nlen+yr.ndist){_r.msg="invalid bit length repeat",yr.mode=nr;break}for(;yi--;)yr.lens[yr.have++]=la}}if(yr.mode===nr)break;if(yr.lens[256]===0){_r.msg="invalid code -- missing end-of-block",yr.mode=nr;break}if(yr.lenbits=9,ka={bits:yr.lenbits},ua=ot(ht,yr.lens,0,yr.nlen,yr.lencode,0,yr.work,ka),yr.lenbits=ka.bits,ua){_r.msg="invalid literal/lengths set",yr.mode=nr;break}if(yr.distbits=6,yr.distcode=yr.distdyn,ka={bits:yr.distbits},ua=ot(dt,yr.lens,yr.nlen,yr.ndist,yr.distcode,0,yr.work,ka),yr.distbits=ka.bits,ua){_r.msg="invalid distances set",yr.mode=nr;break}if(yr.mode=lr,Rr===mt)break e;case lr:yr.mode=mr;case mr:if(Dr>=6&&Pr>=258){_r.next_out=Qr,_r.avail_out=Pr,_r.next_in=Zt,_r.avail_in=Dr,yr.hold=Hr,yr.bits=qr,st(_r,ri),Qr=_r.next_out,Jr=_r.output,Pr=_r.avail_out,Zt=_r.next_in,Kr=_r.input,Dr=_r.avail_in,Hr=yr.hold,qr=yr.bits,yr.mode===Xt&&(yr.back=-1);break}for(yr.back=0;$i=(ca=yr.lencode[Hr&(1<<yr.lenbits)-1])>>>16&255,Ji=65535&ca,!((Ti=ca>>>24)<=qr);){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if($i&&!(240&$i)){for(ea=Ti,Na=$i,Oa=Ji;$i=(ca=yr.lencode[Oa+((Hr&(1<<ea+Na)-1)>>ea)])>>>16&255,Ji=65535&ca,!(ea+(Ti=ca>>>24)<=qr);){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}Hr>>>=ea,qr-=ea,yr.back+=ea}if(Hr>>>=Ti,qr-=Ti,yr.back+=Ti,yr.length=Ji,$i===0){yr.mode=Nt;break}if(32&$i){yr.back=-1,yr.mode=Xt;break}if(64&$i){_r.msg="invalid literal/length code",yr.mode=nr;break}yr.extra=15&$i,yr.mode=br;case br:if(yr.extra){for(Xi=yr.extra;qr<Xi;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}yr.length+=Hr&(1<<yr.extra)-1,Hr>>>=yr.extra,qr-=yr.extra,yr.back+=yr.extra}yr.was=yr.length,yr.mode=Sr;case Sr:for(;$i=(ca=yr.distcode[Hr&(1<<yr.distbits)-1])>>>16&255,Ji=65535&ca,!((Ti=ca>>>24)<=qr);){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(!(240&$i)){for(ea=Ti,Na=$i,Oa=Ji;$i=(ca=yr.distcode[Oa+((Hr&(1<<ea+Na)-1)>>ea)])>>>16&255,Ji=65535&ca,!(ea+(Ti=ca>>>24)<=qr);){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}Hr>>>=ea,qr-=ea,yr.back+=ea}if(Hr>>>=Ti,qr-=Ti,yr.back+=Ti,64&$i){_r.msg="invalid distance code",yr.mode=nr;break}yr.offset=Ji,yr.extra=15&$i,yr.mode=Ir;case Ir:if(yr.extra){for(Xi=yr.extra;qr<Xi;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}yr.offset+=Hr&(1<<yr.extra)-1,Hr>>>=yr.extra,qr-=yr.extra,yr.back+=yr.extra}if(yr.offset>yr.dmax){_r.msg="invalid distance too far back",yr.mode=nr;break}yr.mode=cr;case cr:if(Pr===0)break e;if(yi=ri-Pr,yr.offset>yi){if((yi=yr.offset-yi)>yr.whave&&yr.sane){_r.msg="invalid distance too far back",yr.mode=nr;break}yi>yr.wnext?(yi-=yr.wnext,Li=yr.wsize-yi):Li=yr.wnext-yi,yi>yr.length&&(yi=yr.length),xa=yr.window}else xa=Jr,Li=Qr-yr.offset,yi=yr.length;yi>Pr&&(yi=Pr),Pr-=yi,yr.length-=yi;do Jr[Qr++]=xa[Li++];while(--yi);yr.length===0&&(yr.mode=mr);break;case Nt:if(Pr===0)break e;Jr[Qr++]=yr.length,Pr--,yr.mode=mr;break;case pr:if(yr.wrap){for(;qr<32;){if(Dr===0)break e;Dr--,Hr|=Kr[Zt++]<<qr,qr+=8}if(ri-=Pr,_r.total_out+=ri,yr.total+=ri,ri&&(_r.adler=yr.check=yr.flags?at(yr.check,Jr,ri,Qr-ri):it(yr.check,Jr,ri,Qr-ri)),ri=Pr,(yr.flags?Hr:or(Hr))!==yr.check){_r.msg="incorrect data check",yr.mode=nr;break}Hr=0,qr=0}yr.mode=rr;case rr:if(yr.wrap&&yr.flags){for(;qr<32;){if(Dr===0)break e;Dr--,Hr+=Kr[Zt++]<<qr,qr+=8}if(Hr!==(4294967295&yr.total)){_r.msg="incorrect length check",yr.mode=nr;break}Hr=0,qr=0}yr.mode=ar;case ar:ua=vt;break e;case nr:ua=At;break e;case ur:return Tt;default:return wt}return _r.next_out=Qr,_r.avail_out=Pr,_r.next_in=Zt,_r.avail_in=Dr,yr.hold=Hr,yr.bits=qr,(yr.wsize||ri!==_r.avail_out&&yr.mode<nr&&(yr.mode<pr||Rr!==ut))&&_i(_r,_r.output,_r.next_out,ri-_r.avail_out),bi-=_r.avail_in,ri-=_r.avail_out,_r.total_in+=bi,_r.total_out+=ri,yr.total+=ri,yr.wrap&&ri&&(_r.adler=yr.check=yr.flags?at(yr.check,Jr,ri,_r.next_out-ri):it(yr.check,Jr,ri,_r.next_out-ri)),_r.data_type=yr.bits+(yr.last?64:0)+(yr.mode===Xt?128:0)+(yr.mode===lr||yr.mode===Yt?256:0),(bi===0&&ri===0||Rr===ut)&&ua===gt&&(ua=Pt),ua}function pi(_r){if(!_r||!_r.state)return wt;var Rr=_r.state;return Rr.window&&(Rr.window=null),_r.state=null,gt}function Tr(_r,Rr){var yr;return _r&&_r.state&&2&(yr=_r.state).wrap?(yr.head=Rr,Rr.done=!1,gt):wt}function qn(_r,Rr){var yr,Kr=Rr.length;return _r&&_r.state?(yr=_r.state).wrap!==0&&yr.mode!==Bt?wt:yr.mode===Bt&&it(1,Rr,Kr,0)!==yr.check?At:_i(_r,Rr,Kr,Kr)?(yr.mode=ur,Tt):(yr.havedict=1,gt):wt}rt.inflateReset=Br,rt.inflateReset2=Gn,rt.inflateResetKeep=kr,rt.inflateInit=Mn,rt.inflateInit2=Xn,rt.inflate=Ri,rt.inflateEnd=pi,rt.inflateGetHeader=Tr,rt.inflateSetDictionary=qn,rt.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./inffast":57,"./inftrees":59}],59:[function(tt,et,rt){var nt=tt("../utils/common"),it=15,at=852,st=592,ot=0,lt=1,ht=2,dt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ut=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ft=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],mt=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];et.exports=function(gt,vt,xt,wt,At,Tt,Pt,Rt){var Ot,Et,Lt,kt,jt,Mt,$t,Qt,Ht,qt=Rt.bits,Bt=0,Xt=0,Ft=0,Wt=0,Yt=0,zt=0,er=0,dr=0,fr=0,lr=0,mr=null,br=0,Sr=new nt.Buf16(it+1),Ir=new nt.Buf16(it+1),cr=null,Nt=0;for(Bt=0;Bt<=it;Bt++)Sr[Bt]=0;for(Xt=0;Xt<wt;Xt++)Sr[vt[xt+Xt]]++;for(Yt=qt,Wt=it;Wt>=1&&Sr[Wt]===0;Wt--);if(Yt>Wt&&(Yt=Wt),Wt===0)return At[Tt++]=20971520,At[Tt++]=20971520,Rt.bits=1,0;for(Ft=1;Ft<Wt&&Sr[Ft]===0;Ft++);for(Yt<Ft&&(Yt=Ft),dr=1,Bt=1;Bt<=it;Bt++)if(dr<<=1,(dr-=Sr[Bt])<0)return-1;if(dr>0&&(gt===ot||Wt!==1))return-1;for(Ir[1]=0,Bt=1;Bt<it;Bt++)Ir[Bt+1]=Ir[Bt]+Sr[Bt];for(Xt=0;Xt<wt;Xt++)vt[xt+Xt]!==0&&(Pt[Ir[vt[xt+Xt]]++]=Xt);if(gt===ot?(mr=cr=Pt,Mt=19):gt===lt?(mr=dt,br-=257,cr=ut,Nt-=257,Mt=256):(mr=ft,cr=mt,Mt=-1),lr=0,Xt=0,Bt=Ft,jt=Tt,zt=Yt,er=0,Lt=-1,kt=(fr=1<<Yt)-1,gt===lt&&fr>at||gt===ht&&fr>st)return 1;for(;;){$t=Bt-er,Pt[Xt]<Mt?(Qt=0,Ht=Pt[Xt]):Pt[Xt]>Mt?(Qt=cr[Nt+Pt[Xt]],Ht=mr[br+Pt[Xt]]):(Qt=96,Ht=0),Ot=1<<Bt-er,Ft=Et=1<<zt;do At[jt+(lr>>er)+(Et-=Ot)]=$t<<24|Qt<<16|Ht;while(Et!==0);for(Ot=1<<Bt-1;lr&Ot;)Ot>>=1;if(Ot!==0?(lr&=Ot-1,lr+=Ot):lr=0,Xt++,--Sr[Bt]==0){if(Bt===Wt)break;Bt=vt[xt+Pt[Xt]]}if(Bt>Yt&&(lr&kt)!==Lt){for(er===0&&(er=Yt),jt+=Ft,dr=1<<(zt=Bt-er);zt+er<Wt&&!((dr-=Sr[zt+er])<=0);)zt++,dr<<=1;if(fr+=1<<zt,gt===lt&&fr>at||gt===ht&&fr>st)return 1;At[Lt=lr&kt]=Yt<<24|zt<<16|jt-Tt}}return lr!==0&&(At[jt+lr]=Bt-er<<24|64<<16),Rt.bits=Yt,0}},{"../utils/common":52}],60:[function(tt,et,rt){et.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(tt,et,rt){var nt=tt("../utils/common"),it=4,at=0,st=1,ot=2;function lt(Tr){for(var qn=Tr.length;--qn>=0;)Tr[qn]=0}var ht=0,dt=1,ut=2,ft=3,mt=258,gt=29,vt=256,xt=vt+1+gt,wt=30,At=19,Tt=2*xt+1,Pt=15,Rt=16,Ot=7,Et=256,Lt=16,kt=17,jt=18,Mt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$t=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Qt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ht=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qt=512,Bt=new Array(2*(xt+2));lt(Bt);var Xt=new Array(2*wt);lt(Xt);var Ft=new Array(qt);lt(Ft);var Wt=new Array(mt-ft+1);lt(Wt);var Yt=new Array(gt);lt(Yt);var zt,er,dr,fr=new Array(wt);function lr(Tr,qn,_r,Rr,yr){this.static_tree=Tr,this.extra_bits=qn,this.extra_base=_r,this.elems=Rr,this.max_length=yr,this.has_stree=Tr&&Tr.length}function mr(Tr,qn){this.dyn_tree=Tr,this.max_code=0,this.stat_desc=qn}function br(Tr){return Tr<256?Ft[Tr]:Ft[256+(Tr>>>7)]}function Sr(Tr,qn){Tr.pending_buf[Tr.pending++]=255&qn,Tr.pending_buf[Tr.pending++]=qn>>>8&255}function Ir(Tr,qn,_r){Tr.bi_valid>Rt-_r?(Tr.bi_buf|=qn<<Tr.bi_valid&65535,Sr(Tr,Tr.bi_buf),Tr.bi_buf=qn>>Rt-Tr.bi_valid,Tr.bi_valid+=_r-Rt):(Tr.bi_buf|=qn<<Tr.bi_valid&65535,Tr.bi_valid+=_r)}function cr(Tr,qn,_r){Ir(Tr,_r[2*qn],_r[2*qn+1])}function Nt(Tr,qn){var _r=0;do _r|=1&Tr,Tr>>>=1,_r<<=1;while(--qn>0);return _r>>>1}function pr(Tr){Tr.bi_valid===16?(Sr(Tr,Tr.bi_buf),Tr.bi_buf=0,Tr.bi_valid=0):Tr.bi_valid>=8&&(Tr.pending_buf[Tr.pending++]=255&Tr.bi_buf,Tr.bi_buf>>=8,Tr.bi_valid-=8)}function rr(Tr,qn){var _r,Rr,yr,Kr,Jr,Zt,Qr=qn.dyn_tree,Dr=qn.max_code,Pr=qn.stat_desc.static_tree,Hr=qn.stat_desc.has_stree,qr=qn.stat_desc.extra_bits,bi=qn.stat_desc.extra_base,ri=qn.stat_desc.max_length,yi=0;for(Kr=0;Kr<=Pt;Kr++)Tr.bl_count[Kr]=0;for(Qr[2*Tr.heap[Tr.heap_max]+1]=0,_r=Tr.heap_max+1;_r<Tt;_r++)(Kr=Qr[2*Qr[2*(Rr=Tr.heap[_r])+1]+1]+1)>ri&&(Kr=ri,yi++),Qr[2*Rr+1]=Kr,Rr>Dr||(Tr.bl_count[Kr]++,Jr=0,Rr>=bi&&(Jr=qr[Rr-bi]),Zt=Qr[2*Rr],Tr.opt_len+=Zt*(Kr+Jr),Hr&&(Tr.static_len+=Zt*(Pr[2*Rr+1]+Jr)));if(yi!==0){do{for(Kr=ri-1;Tr.bl_count[Kr]===0;)Kr--;Tr.bl_count[Kr]--,Tr.bl_count[Kr+1]+=2,Tr.bl_count[ri]--,yi-=2}while(yi>0);for(Kr=ri;Kr!==0;Kr--)for(Rr=Tr.bl_count[Kr];Rr!==0;)(yr=Tr.heap[--_r])>Dr||(Qr[2*yr+1]!==Kr&&(Tr.opt_len+=(Kr-Qr[2*yr+1])*Qr[2*yr],Qr[2*yr+1]=Kr),Rr--)}}function ar(Tr,qn,_r){var Rr,yr,Kr=new Array(Pt+1),Jr=0;for(Rr=1;Rr<=Pt;Rr++)Kr[Rr]=Jr=Jr+_r[Rr-1]<<1;for(yr=0;yr<=qn;yr++){var Zt=Tr[2*yr+1];Zt!==0&&(Tr[2*yr]=Nt(Kr[Zt]++,Zt))}}function nr(){var Tr,qn,_r,Rr,yr,Kr=new Array(Pt+1);for(_r=0,Rr=0;Rr<gt-1;Rr++)for(Yt[Rr]=_r,Tr=0;Tr<1<<Mt[Rr];Tr++)Wt[_r++]=Rr;for(Wt[_r-1]=Rr,yr=0,Rr=0;Rr<16;Rr++)for(fr[Rr]=yr,Tr=0;Tr<1<<$t[Rr];Tr++)Ft[yr++]=Rr;for(yr>>=7;Rr<wt;Rr++)for(fr[Rr]=yr<<7,Tr=0;Tr<1<<$t[Rr]-7;Tr++)Ft[256+yr++]=Rr;for(qn=0;qn<=Pt;qn++)Kr[qn]=0;for(Tr=0;Tr<=143;)Bt[2*Tr+1]=8,Tr++,Kr[8]++;for(;Tr<=255;)Bt[2*Tr+1]=9,Tr++,Kr[9]++;for(;Tr<=279;)Bt[2*Tr+1]=7,Tr++,Kr[7]++;for(;Tr<=287;)Bt[2*Tr+1]=8,Tr++,Kr[8]++;for(ar(Bt,xt+1,Kr),Tr=0;Tr<wt;Tr++)Xt[2*Tr+1]=5,Xt[2*Tr]=Nt(Tr,5);zt=new lr(Bt,Mt,vt+1,xt,Pt),er=new lr(Xt,$t,0,wt,Pt),dr=new lr(new Array(0),Qt,0,At,Ot)}function ur(Tr){var qn;for(qn=0;qn<xt;qn++)Tr.dyn_ltree[2*qn]=0;for(qn=0;qn<wt;qn++)Tr.dyn_dtree[2*qn]=0;for(qn=0;qn<At;qn++)Tr.bl_tree[2*qn]=0;Tr.dyn_ltree[2*Et]=1,Tr.opt_len=Tr.static_len=0,Tr.last_lit=Tr.matches=0}function Er(Tr){Tr.bi_valid>8?Sr(Tr,Tr.bi_buf):Tr.bi_valid>0&&(Tr.pending_buf[Tr.pending++]=Tr.bi_buf),Tr.bi_buf=0,Tr.bi_valid=0}function Ut(Tr,qn,_r,Rr){Er(Tr),Sr(Tr,_r),Sr(Tr,~_r),nt.arraySet(Tr.pending_buf,Tr.window,qn,_r,Tr.pending),Tr.pending+=_r}function Kt(Tr,qn,_r,Rr){var yr=2*qn,Kr=2*_r;return Tr[yr]<Tr[Kr]||Tr[yr]===Tr[Kr]&&Rr[qn]<=Rr[_r]}function or(Tr,qn,_r){for(var Rr=Tr.heap[_r],yr=_r<<1;yr<=Tr.heap_len&&(yr<Tr.heap_len&&Kt(qn,Tr.heap[yr+1],Tr.heap[yr],Tr.depth)&&yr++,!Kt(qn,Rr,Tr.heap[yr],Tr.depth));)Tr.heap[_r]=Tr.heap[yr],_r=yr,yr<<=1;Tr.heap[_r]=Rr}function hr(Tr,qn,_r){var Rr,yr,Kr,Jr,Zt=0;if(Tr.last_lit!==0)do Rr=Tr.pending_buf[Tr.d_buf+2*Zt]<<8|Tr.pending_buf[Tr.d_buf+2*Zt+1],yr=Tr.pending_buf[Tr.l_buf+Zt],Zt++,Rr===0?cr(Tr,yr,qn):(cr(Tr,(Kr=Wt[yr])+vt+1,qn),(Jr=Mt[Kr])!==0&&Ir(Tr,yr-=Yt[Kr],Jr),cr(Tr,Kr=br(--Rr),_r),(Jr=$t[Kr])!==0&&Ir(Tr,Rr-=fr[Kr],Jr));while(Zt<Tr.last_lit);cr(Tr,Et,qn)}function kr(Tr,qn){var _r,Rr,yr,Kr=qn.dyn_tree,Jr=qn.stat_desc.static_tree,Zt=qn.stat_desc.has_stree,Qr=qn.stat_desc.elems,Dr=-1;for(Tr.heap_len=0,Tr.heap_max=Tt,_r=0;_r<Qr;_r++)Kr[2*_r]!==0?(Tr.heap[++Tr.heap_len]=Dr=_r,Tr.depth[_r]=0):Kr[2*_r+1]=0;for(;Tr.heap_len<2;)Kr[2*(yr=Tr.heap[++Tr.heap_len]=Dr<2?++Dr:0)]=1,Tr.depth[yr]=0,Tr.opt_len--,Zt&&(Tr.static_len-=Jr[2*yr+1]);for(qn.max_code=Dr,_r=Tr.heap_len>>1;_r>=1;_r--)or(Tr,Kr,_r);yr=Qr;do _r=Tr.heap[1],Tr.heap[1]=Tr.heap[Tr.heap_len--],or(Tr,Kr,1),Rr=Tr.heap[1],Tr.heap[--Tr.heap_max]=_r,Tr.heap[--Tr.heap_max]=Rr,Kr[2*yr]=Kr[2*_r]+Kr[2*Rr],Tr.depth[yr]=(Tr.depth[_r]>=Tr.depth[Rr]?Tr.depth[_r]:Tr.depth[Rr])+1,Kr[2*_r+1]=Kr[2*Rr+1]=yr,Tr.heap[1]=yr++,or(Tr,Kr,1);while(Tr.heap_len>=2);Tr.heap[--Tr.heap_max]=Tr.heap[1],rr(Tr,qn),ar(Kr,Dr,Tr.bl_count)}function Br(Tr,qn,_r){var Rr,yr,Kr=-1,Jr=qn[1],Zt=0,Qr=7,Dr=4;for(Jr===0&&(Qr=138,Dr=3),qn[2*(_r+1)+1]=65535,Rr=0;Rr<=_r;Rr++)yr=Jr,Jr=qn[2*(Rr+1)+1],++Zt<Qr&&yr===Jr||(Zt<Dr?Tr.bl_tree[2*yr]+=Zt:yr!==0?(yr!==Kr&&Tr.bl_tree[2*yr]++,Tr.bl_tree[2*Lt]++):Zt<=10?Tr.bl_tree[2*kt]++:Tr.bl_tree[2*jt]++,Zt=0,Kr=yr,Jr===0?(Qr=138,Dr=3):yr===Jr?(Qr=6,Dr=3):(Qr=7,Dr=4))}function Gn(Tr,qn,_r){var Rr,yr,Kr=-1,Jr=qn[1],Zt=0,Qr=7,Dr=4;for(Jr===0&&(Qr=138,Dr=3),Rr=0;Rr<=_r;Rr++)if(yr=Jr,Jr=qn[2*(Rr+1)+1],!(++Zt<Qr&&yr===Jr)){if(Zt<Dr)do cr(Tr,yr,Tr.bl_tree);while(--Zt!=0);else yr!==0?(yr!==Kr&&(cr(Tr,yr,Tr.bl_tree),Zt--),cr(Tr,Lt,Tr.bl_tree),Ir(Tr,Zt-3,2)):Zt<=10?(cr(Tr,kt,Tr.bl_tree),Ir(Tr,Zt-3,3)):(cr(Tr,jt,Tr.bl_tree),Ir(Tr,Zt-11,7));Zt=0,Kr=yr,Jr===0?(Qr=138,Dr=3):yr===Jr?(Qr=6,Dr=3):(Qr=7,Dr=4)}}function Xn(Tr){var qn;for(Br(Tr,Tr.dyn_ltree,Tr.l_desc.max_code),Br(Tr,Tr.dyn_dtree,Tr.d_desc.max_code),kr(Tr,Tr.bl_desc),qn=At-1;qn>=3&&Tr.bl_tree[2*Ht[qn]+1]===0;qn--);return Tr.opt_len+=3*(qn+1)+5+5+4,qn}function Mn(Tr,qn,_r,Rr){var yr;for(Ir(Tr,qn-257,5),Ir(Tr,_r-1,5),Ir(Tr,Rr-4,4),yr=0;yr<Rr;yr++)Ir(Tr,Tr.bl_tree[2*Ht[yr]+1],3);Gn(Tr,Tr.dyn_ltree,qn-1),Gn(Tr,Tr.dyn_dtree,_r-1)}function Kn(Tr){var qn,_r=4093624447;for(qn=0;qn<=31;qn++,_r>>>=1)if(1&_r&&Tr.dyn_ltree[2*qn]!==0)return at;if(Tr.dyn_ltree[18]!==0||Tr.dyn_ltree[20]!==0||Tr.dyn_ltree[26]!==0)return st;for(qn=32;qn<vt;qn++)if(Tr.dyn_ltree[2*qn]!==0)return st;return at}lt(fr);var Vn=!1;function vi(Tr){Vn||(nr(),Vn=!0),Tr.l_desc=new mr(Tr.dyn_ltree,zt),Tr.d_desc=new mr(Tr.dyn_dtree,er),Tr.bl_desc=new mr(Tr.bl_tree,dr),Tr.bi_buf=0,Tr.bi_valid=0,ur(Tr)}function mi(Tr,qn,_r,Rr){Ir(Tr,(ht<<1)+(Rr?1:0),3),Ut(Tr,qn,_r)}function _i(Tr){Ir(Tr,dt<<1,3),cr(Tr,Et,Bt),pr(Tr)}function Ri(Tr,qn,_r,Rr){var yr,Kr,Jr=0;Tr.level>0?(Tr.strm.data_type===ot&&(Tr.strm.data_type=Kn(Tr)),kr(Tr,Tr.l_desc),kr(Tr,Tr.d_desc),Jr=Xn(Tr),yr=Tr.opt_len+3+7>>>3,(Kr=Tr.static_len+3+7>>>3)<=yr&&(yr=Kr)):yr=Kr=_r+5,_r+4<=yr&&qn!==-1?mi(Tr,qn,_r,Rr):Tr.strategy===it||Kr===yr?(Ir(Tr,(dt<<1)+(Rr?1:0),3),hr(Tr,Bt,Xt)):(Ir(Tr,(ut<<1)+(Rr?1:0),3),Mn(Tr,Tr.l_desc.max_code+1,Tr.d_desc.max_code+1,Jr+1),hr(Tr,Tr.dyn_ltree,Tr.dyn_dtree)),ur(Tr),Rr&&Er(Tr)}function pi(Tr,qn,_r){return Tr.pending_buf[Tr.d_buf+2*Tr.last_lit]=qn>>>8&255,Tr.pending_buf[Tr.d_buf+2*Tr.last_lit+1]=255&qn,Tr.pending_buf[Tr.l_buf+Tr.last_lit]=255&_r,Tr.last_lit++,qn===0?Tr.dyn_ltree[2*_r]++:(Tr.matches++,qn--,Tr.dyn_ltree[2*(Wt[_r]+vt+1)]++,Tr.dyn_dtree[2*br(qn)]++),Tr.last_lit===Tr.lit_bufsize-1}rt._tr_init=vi,rt._tr_stored_block=mi,rt._tr_flush_block=Ri,rt._tr_tally=pi,rt._tr_align=_i},{"../utils/common":52}],62:[function(tt,et,rt){function nt(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}et.exports=nt},{}],63:[function(tt,et,rt){var nt,it,at=et.exports={};function st(){throw new Error("setTimeout has not been defined")}function ot(){throw new Error("clearTimeout has not been defined")}function lt(At){if(nt===setTimeout)return setTimeout(At,0);if((nt===st||!nt)&&setTimeout)return nt=setTimeout,setTimeout(At,0);try{return nt(At,0)}catch{try{return nt.call(null,At,0)}catch{return nt.call(this,At,0)}}}function ht(At){if(it===clearTimeout)return clearTimeout(At);if((it===ot||!it)&&clearTimeout)return it=clearTimeout,clearTimeout(At);try{return it(At)}catch{try{return it.call(null,At)}catch{return it.call(this,At)}}}(function(){try{nt=typeof setTimeout=="function"?setTimeout:st}catch{nt=st}try{it=typeof clearTimeout=="function"?clearTimeout:ot}catch{it=ot}})();var dt,ut=[],ft=!1,mt=-1;function gt(){ft&&dt&&(ft=!1,dt.length?ut=dt.concat(ut):mt=-1,ut.length&&vt())}function vt(){if(!ft){var At=lt(gt);ft=!0;for(var Tt=ut.length;Tt;){for(dt=ut,ut=[];++mt<Tt;)dt&&dt[mt].run();mt=-1,Tt=ut.length}dt=null,ft=!1,ht(At)}}function xt(At,Tt){this.fun=At,this.array=Tt}function wt(){}at.nextTick=function(At){var Tt=new Array(arguments.length-1);if(arguments.length>1)for(var Pt=1;Pt<arguments.length;Pt++)Tt[Pt-1]=arguments[Pt];ut.push(new xt(At,Tt)),ut.length!==1||ft||lt(vt)},xt.prototype.run=function(){this.fun.apply(null,this.array)},at.title="browser",at.browser=!0,at.env={},at.argv=[],at.version="",at.versions={},at.on=wt,at.addListener=wt,at.once=wt,at.off=wt,at.removeListener=wt,at.removeAllListeners=wt,at.emit=wt,at.prependListener=wt,at.prependOnceListener=wt,at.listeners=function(At){return[]},at.binding=function(At){throw new Error("process.binding is not supported")},at.cwd=function(){return"/"},at.chdir=function(At){throw new Error("process.chdir is not supported")},at.umask=function(){return 0}},{}],64:[function(tt,et,rt){var nt=tt("buffer"),it=nt.Buffer;function at(ot,lt){for(var ht in ot)lt[ht]=ot[ht]}function st(ot,lt,ht){return it(ot,lt,ht)}it.from&&it.alloc&&it.allocUnsafe&&it.allocUnsafeSlow?et.exports=nt:(at(nt,rt),rt.Buffer=st),st.prototype=Object.create(it.prototype),at(it,st),st.from=function(ot,lt,ht){if(typeof ot=="number")throw new TypeError("Argument must not be a number");return it(ot,lt,ht)},st.alloc=function(ot,lt,ht){if(typeof ot!="number")throw new TypeError("Argument must be a number");var dt=it(ot);return lt!==void 0?typeof ht=="string"?dt.fill(lt,ht):dt.fill(lt):dt.fill(0),dt},st.allocUnsafe=function(ot){if(typeof ot!="number")throw new TypeError("Argument must be a number");return it(ot)},st.allocUnsafeSlow=function(ot){if(typeof ot!="number")throw new TypeError("Argument must be a number");return nt.SlowBuffer(ot)}},{buffer:32}],65:[function(tt,et,rt){et.exports=it;var nt=tt("events").EventEmitter;function it(){nt.call(this)}tt("inherits")(it,nt),it.Readable=tt("readable-stream/lib/_stream_readable.js"),it.Writable=tt("readable-stream/lib/_stream_writable.js"),it.Duplex=tt("readable-stream/lib/_stream_duplex.js"),it.Transform=tt("readable-stream/lib/_stream_transform.js"),it.PassThrough=tt("readable-stream/lib/_stream_passthrough.js"),it.finished=tt("readable-stream/lib/internal/streams/end-of-stream.js"),it.pipeline=tt("readable-stream/lib/internal/streams/pipeline.js"),it.Stream=it,it.prototype.pipe=function(at,st){var ot=this;function lt(vt){at.writable&&at.write(vt)===!1&&ot.pause&&ot.pause()}function ht(){ot.readable&&ot.resume&&ot.resume()}ot.on("data",lt),at.on("drain",ht),at._isStdio||st&&st.end===!1||(ot.on("end",ut),ot.on("close",ft));var dt=!1;function ut(){dt||(dt=!0,at.end())}function ft(){dt||(dt=!0,typeof at.destroy=="function"&&at.destroy())}function mt(vt){if(gt(),nt.listenerCount(this,"error")===0)throw vt}function gt(){ot.removeListener("data",lt),at.removeListener("drain",ht),ot.removeListener("end",ut),ot.removeListener("close",ft),ot.removeListener("error",mt),at.removeListener("error",mt),ot.removeListener("end",gt),ot.removeListener("close",gt),at.removeListener("close",gt)}return ot.on("error",mt),at.on("error",mt),ot.on("end",gt),ot.on("close",gt),at.on("close",gt),at.emit("pipe",ot),at}},{events:35,inherits:46,"readable-stream/lib/_stream_duplex.js":67,"readable-stream/lib/_stream_passthrough.js":68,"readable-stream/lib/_stream_readable.js":69,"readable-stream/lib/_stream_transform.js":70,"readable-stream/lib/_stream_writable.js":71,"readable-stream/lib/internal/streams/end-of-stream.js":75,"readable-stream/lib/internal/streams/pipeline.js":77}],66:[function(tt,et,rt){function nt(dt,ut){dt.prototype=Object.create(ut.prototype),dt.prototype.constructor=dt,dt.__proto__=ut}var it={};function at(dt,ut,ft){function mt(vt,xt,wt){return typeof ut=="string"?ut:ut(vt,xt,wt)}ft||(ft=Error);var gt=(function(vt){function xt(wt,At,Tt){return vt.call(this,mt(wt,At,Tt))||this}return nt(xt,vt),xt})(ft);gt.prototype.name=ft.name,gt.prototype.code=dt,it[dt]=gt}function st(dt,ut){if(Array.isArray(dt)){var ft=dt.length;return dt=dt.map((function(mt){return String(mt)})),ft>2?"one of ".concat(ut," ").concat(dt.slice(0,ft-1).join(", "),", or ")+dt[ft-1]:ft===2?"one of ".concat(ut," ").concat(dt[0]," or ").concat(dt[1]):"of ".concat(ut," ").concat(dt[0])}return"of ".concat(ut," ").concat(String(dt))}function ot(dt,ut,ft){return dt.substr(0,ut.length)===ut}function lt(dt,ut,ft){return(ft===void 0||ft>dt.length)&&(ft=dt.length),dt.substring(ft-ut.length,ft)===ut}function ht(dt,ut,ft){return typeof ft!="number"&&(ft=0),!(ft+ut.length>dt.length)&&dt.indexOf(ut,ft)!==-1}at("ERR_INVALID_OPT_VALUE",(function(dt,ut){return'The value "'+ut+'" is invalid for option "'+dt+'"'}),TypeError),at("ERR_INVALID_ARG_TYPE",(function(dt,ut,ft){var mt,gt;if(typeof ut=="string"&&ot(ut,"not ")?(mt="must not be",ut=ut.replace(/^not /,"")):mt="must be",lt(dt," argument"))gt="The ".concat(dt," ").concat(mt," ").concat(st(ut,"type"));else{var vt=ht(dt,".")?"property":"argument";gt='The "'.concat(dt,'" ').concat(vt," ").concat(mt," ").concat(st(ut,"type"))}return gt+=". Received type ".concat(typeof ft)}),TypeError),at("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),at("ERR_METHOD_NOT_IMPLEMENTED",(function(dt){return"The "+dt+" method is not implemented"})),at("ERR_STREAM_PREMATURE_CLOSE","Premature close"),at("ERR_STREAM_DESTROYED",(function(dt){return"Cannot call "+dt+" after a stream was destroyed"})),at("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),at("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),at("ERR_STREAM_WRITE_AFTER_END","write after end"),at("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),at("ERR_UNKNOWN_ENCODING",(function(dt){return"Unknown encoding: "+dt}),TypeError),at("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),et.exports.codes=it},{}],67:[function(tt,et,rt){(function(nt){(function(){var it=Object.keys||function(mt){var gt=[];for(var vt in mt)gt.push(vt);return gt};et.exports=dt;var at=tt("./_stream_readable"),st=tt("./_stream_writable");tt("inherits")(dt,at);for(var ot=it(st.prototype),lt=0;lt<ot.length;lt++){var ht=ot[lt];dt.prototype[ht]||(dt.prototype[ht]=st.prototype[ht])}function dt(mt){if(!(this instanceof dt))return new dt(mt);at.call(this,mt),st.call(this,mt),this.allowHalfOpen=!0,mt&&(mt.readable===!1&&(this.readable=!1),mt.writable===!1&&(this.writable=!1),mt.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",ut)))}function ut(){this._writableState.ended||nt.nextTick(ft,this)}function ft(mt){mt.end()}Object.defineProperty(dt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(dt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(dt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(dt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(mt){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=mt,this._writableState.destroyed=mt)}})}).call(this)}).call(this,tt("_process"))},{"./_stream_readable":69,"./_stream_writable":71,_process:63,inherits:46}],68:[function(tt,et,rt){et.exports=it;var nt=tt("./_stream_transform");function it(at){if(!(this instanceof it))return new it(at);nt.call(this,at)}tt("inherits")(it,nt),it.prototype._transform=function(at,st,ot){ot(null,at)}},{"./_stream_transform":70,inherits:46}],69:[function(tt,et,rt){(function(nt,it){(function(){var at;et.exports=Qt,Qt.ReadableState=$t,tt("events").EventEmitter;var st=function(nr,ur){return nr.listeners(ur).length},ot=tt("./internal/streams/stream"),lt=tt("buffer").Buffer,ht=it.Uint8Array||function(){};function dt(nr){return lt.from(nr)}function ut(nr){return lt.isBuffer(nr)||nr instanceof ht}var ft,mt=tt("util");ft=mt&&mt.debuglog?mt.debuglog("stream"):function(){};var gt,vt,xt,wt=tt("./internal/streams/buffer_list"),At=tt("./internal/streams/destroy"),Tt=tt("./internal/streams/state").getHighWaterMark,Pt=tt("../errors").codes,Rt=Pt.ERR_INVALID_ARG_TYPE,Ot=Pt.ERR_STREAM_PUSH_AFTER_EOF,Et=Pt.ERR_METHOD_NOT_IMPLEMENTED,Lt=Pt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;tt("inherits")(Qt,ot);var kt=At.errorOrDestroy,jt=["error","close","destroy","pause","resume"];function Mt(nr,ur,Er){if(typeof nr.prependListener=="function")return nr.prependListener(ur,Er);nr._events&&nr._events[ur]?Array.isArray(nr._events[ur])?nr._events[ur].unshift(Er):nr._events[ur]=[Er,nr._events[ur]]:nr.on(ur,Er)}function $t(nr,ur,Er){at=at||tt("./_stream_duplex"),nr=nr||{},typeof Er!="boolean"&&(Er=ur instanceof at),this.objectMode=!!nr.objectMode,Er&&(this.objectMode=this.objectMode||!!nr.readableObjectMode),this.highWaterMark=Tt(this,nr,"readableHighWaterMark",Er),this.buffer=new wt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=nr.emitClose!==!1,this.autoDestroy=!!nr.autoDestroy,this.destroyed=!1,this.defaultEncoding=nr.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,nr.encoding&&(gt||(gt=tt("string_decoder/").StringDecoder),this.decoder=new gt(nr.encoding),this.encoding=nr.encoding)}function Qt(nr){if(at=at||tt("./_stream_duplex"),!(this instanceof Qt))return new Qt(nr);var ur=this instanceof at;this._readableState=new $t(nr,this,ur),this.readable=!0,nr&&(typeof nr.read=="function"&&(this._read=nr.read),typeof nr.destroy=="function"&&(this._destroy=nr.destroy)),ot.call(this)}function Ht(nr,ur,Er,Ut,Kt){ft("readableAddChunk",ur);var or,hr=nr._readableState;if(ur===null)hr.reading=!1,Yt(nr,hr);else if(Kt||(or=Bt(hr,ur)),or)kt(nr,or);else if(hr.objectMode||ur&&ur.length>0)if(typeof ur=="string"||hr.objectMode||Object.getPrototypeOf(ur)===lt.prototype||(ur=dt(ur)),Ut)hr.endEmitted?kt(nr,new Lt):qt(nr,hr,ur,!0);else if(hr.ended)kt(nr,new Ot);else{if(hr.destroyed)return!1;hr.reading=!1,hr.decoder&&!Er?(ur=hr.decoder.write(ur),hr.objectMode||ur.length!==0?qt(nr,hr,ur,!1):dr(nr,hr)):qt(nr,hr,ur,!1)}else Ut||(hr.reading=!1,dr(nr,hr));return!hr.ended&&(hr.length<hr.highWaterMark||hr.length===0)}function qt(nr,ur,Er,Ut){ur.flowing&&ur.length===0&&!ur.sync?(ur.awaitDrain=0,nr.emit("data",Er)):(ur.length+=ur.objectMode?1:Er.length,Ut?ur.buffer.unshift(Er):ur.buffer.push(Er),ur.needReadable&&zt(nr)),dr(nr,ur)}function Bt(nr,ur){var Er;return ut(ur)||typeof ur=="string"||ur===void 0||nr.objectMode||(Er=new Rt("chunk",["string","Buffer","Uint8Array"],ur)),Er}Object.defineProperty(Qt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(nr){this._readableState&&(this._readableState.destroyed=nr)}}),Qt.prototype.destroy=At.destroy,Qt.prototype._undestroy=At.undestroy,Qt.prototype._destroy=function(nr,ur){ur(nr)},Qt.prototype.push=function(nr,ur){var Er,Ut=this._readableState;return Ut.objectMode?Er=!0:typeof nr=="string"&&((ur=ur||Ut.defaultEncoding)!==Ut.encoding&&(nr=lt.from(nr,ur),ur=""),Er=!0),Ht(this,nr,ur,!1,Er)},Qt.prototype.unshift=function(nr){return Ht(this,nr,null,!0,!1)},Qt.prototype.isPaused=function(){return this._readableState.flowing===!1},Qt.prototype.setEncoding=function(nr){gt||(gt=tt("string_decoder/").StringDecoder);var ur=new gt(nr);this._readableState.decoder=ur,this._readableState.encoding=this._readableState.decoder.encoding;for(var Er=this._readableState.buffer.head,Ut="";Er!==null;)Ut+=ur.write(Er.data),Er=Er.next;return this._readableState.buffer.clear(),Ut!==""&&this._readableState.buffer.push(Ut),this._readableState.length=Ut.length,this};var Xt=1073741824;function Ft(nr){return nr>=Xt?nr=Xt:(nr--,nr|=nr>>>1,nr|=nr>>>2,nr|=nr>>>4,nr|=nr>>>8,nr|=nr>>>16,nr++),nr}function Wt(nr,ur){return nr<=0||ur.length===0&&ur.ended?0:ur.objectMode?1:nr!=nr?ur.flowing&&ur.length?ur.buffer.head.data.length:ur.length:(nr>ur.highWaterMark&&(ur.highWaterMark=Ft(nr)),nr<=ur.length?nr:ur.ended?ur.length:(ur.needReadable=!0,0))}function Yt(nr,ur){if(ft("onEofChunk"),!ur.ended){if(ur.decoder){var Er=ur.decoder.end();Er&&Er.length&&(ur.buffer.push(Er),ur.length+=ur.objectMode?1:Er.length)}ur.ended=!0,ur.sync?zt(nr):(ur.needReadable=!1,ur.emittedReadable||(ur.emittedReadable=!0,er(nr)))}}function zt(nr){var ur=nr._readableState;ft("emitReadable",ur.needReadable,ur.emittedReadable),ur.needReadable=!1,ur.emittedReadable||(ft("emitReadable",ur.flowing),ur.emittedReadable=!0,nt.nextTick(er,nr))}function er(nr){var ur=nr._readableState;ft("emitReadable_",ur.destroyed,ur.length,ur.ended),ur.destroyed||!ur.length&&!ur.ended||(nr.emit("readable"),ur.emittedReadable=!1),ur.needReadable=!ur.flowing&&!ur.ended&&ur.length<=ur.highWaterMark,cr(nr)}function dr(nr,ur){ur.readingMore||(ur.readingMore=!0,nt.nextTick(fr,nr,ur))}function fr(nr,ur){for(;!ur.reading&&!ur.ended&&(ur.length<ur.highWaterMark||ur.flowing&&ur.length===0);){var Er=ur.length;if(ft("maybeReadMore read 0"),nr.read(0),Er===ur.length)break}ur.readingMore=!1}function lr(nr){return function(){var ur=nr._readableState;ft("pipeOnDrain",ur.awaitDrain),ur.awaitDrain&&ur.awaitDrain--,ur.awaitDrain===0&&st(nr,"data")&&(ur.flowing=!0,cr(nr))}}function mr(nr){var ur=nr._readableState;ur.readableListening=nr.listenerCount("readable")>0,ur.resumeScheduled&&!ur.paused?ur.flowing=!0:nr.listenerCount("data")>0&&nr.resume()}function br(nr){ft("readable nexttick read 0"),nr.read(0)}function Sr(nr,ur){ur.resumeScheduled||(ur.resumeScheduled=!0,nt.nextTick(Ir,nr,ur))}function Ir(nr,ur){ft("resume",ur.reading),ur.reading||nr.read(0),ur.resumeScheduled=!1,nr.emit("resume"),cr(nr),ur.flowing&&!ur.reading&&nr.read(0)}function cr(nr){var ur=nr._readableState;for(ft("flow",ur.flowing);ur.flowing&&nr.read()!==null;);}function Nt(nr,ur){return ur.length===0?null:(ur.objectMode?Er=ur.buffer.shift():!nr||nr>=ur.length?(Er=ur.decoder?ur.buffer.join(""):ur.buffer.length===1?ur.buffer.first():ur.buffer.concat(ur.length),ur.buffer.clear()):Er=ur.buffer.consume(nr,ur.decoder),Er);var Er}function pr(nr){var ur=nr._readableState;ft("endReadable",ur.endEmitted),ur.endEmitted||(ur.ended=!0,nt.nextTick(rr,ur,nr))}function rr(nr,ur){if(ft("endReadableNT",nr.endEmitted,nr.length),!nr.endEmitted&&nr.length===0&&(nr.endEmitted=!0,ur.readable=!1,ur.emit("end"),nr.autoDestroy)){var Er=ur._writableState;(!Er||Er.autoDestroy&&Er.finished)&&ur.destroy()}}function ar(nr,ur){for(var Er=0,Ut=nr.length;Er<Ut;Er++)if(nr[Er]===ur)return Er;return-1}Qt.prototype.read=function(nr){ft("read",nr),nr=parseInt(nr,10);var ur=this._readableState,Er=nr;if(nr!==0&&(ur.emittedReadable=!1),nr===0&&ur.needReadable&&((ur.highWaterMark!==0?ur.length>=ur.highWaterMark:ur.length>0)||ur.ended))return ft("read: emitReadable",ur.length,ur.ended),ur.length===0&&ur.ended?pr(this):zt(this),null;if((nr=Wt(nr,ur))===0&&ur.ended)return ur.length===0&&pr(this),null;var Ut,Kt=ur.needReadable;return ft("need readable",Kt),(ur.length===0||ur.length-nr<ur.highWaterMark)&&ft("length less than watermark",Kt=!0),ur.ended||ur.reading?ft("reading or ended",Kt=!1):Kt&&(ft("do read"),ur.reading=!0,ur.sync=!0,ur.length===0&&(ur.needReadable=!0),this._read(ur.highWaterMark),ur.sync=!1,ur.reading||(nr=Wt(Er,ur))),(Ut=nr>0?Nt(nr,ur):null)===null?(ur.needReadable=ur.length<=ur.highWaterMark,nr=0):(ur.length-=nr,ur.awaitDrain=0),ur.length===0&&(ur.ended||(ur.needReadable=!0),Er!==nr&&ur.ended&&pr(this)),Ut!==null&&this.emit("data",Ut),Ut},Qt.prototype._read=function(nr){kt(this,new Et("_read()"))},Qt.prototype.pipe=function(nr,ur){var Er=this,Ut=this._readableState;switch(Ut.pipesCount){case 0:Ut.pipes=nr;break;case 1:Ut.pipes=[Ut.pipes,nr];break;default:Ut.pipes.push(nr)}Ut.pipesCount+=1,ft("pipe count=%d opts=%j",Ut.pipesCount,ur);var Kt=ur&&ur.end===!1||nr===nt.stdout||nr===nt.stderr?vi:hr;function or(mi,_i){ft("onunpipe"),mi===Er&&_i&&_i.hasUnpiped===!1&&(_i.hasUnpiped=!0,Gn())}function hr(){ft("onend"),nr.end()}Ut.endEmitted?nt.nextTick(Kt):Er.once("end",Kt),nr.on("unpipe",or);var kr=lr(Er);nr.on("drain",kr);var Br=!1;function Gn(){ft("cleanup"),nr.removeListener("close",Kn),nr.removeListener("finish",Vn),nr.removeListener("drain",kr),nr.removeListener("error",Mn),nr.removeListener("unpipe",or),Er.removeListener("end",hr),Er.removeListener("end",vi),Er.removeListener("data",Xn),Br=!0,!Ut.awaitDrain||nr._writableState&&!nr._writableState.needDrain||kr()}function Xn(mi){ft("ondata");var _i=nr.write(mi);ft("dest.write",_i),_i===!1&&((Ut.pipesCount===1&&Ut.pipes===nr||Ut.pipesCount>1&&ar(Ut.pipes,nr)!==-1)&&!Br&&(ft("false write response, pause",Ut.awaitDrain),Ut.awaitDrain++),Er.pause())}function Mn(mi){ft("onerror",mi),vi(),nr.removeListener("error",Mn),st(nr,"error")===0&&kt(nr,mi)}function Kn(){nr.removeListener("finish",Vn),vi()}function Vn(){ft("onfinish"),nr.removeListener("close",Kn),vi()}function vi(){ft("unpipe"),Er.unpipe(nr)}return Er.on("data",Xn),Mt(nr,"error",Mn),nr.once("close",Kn),nr.once("finish",Vn),nr.emit("pipe",Er),Ut.flowing||(ft("pipe resume"),Er.resume()),nr},Qt.prototype.unpipe=function(nr){var ur=this._readableState,Er={hasUnpiped:!1};if(ur.pipesCount===0)return this;if(ur.pipesCount===1)return nr&&nr!==ur.pipes||(nr||(nr=ur.pipes),ur.pipes=null,ur.pipesCount=0,ur.flowing=!1,nr&&nr.emit("unpipe",this,Er)),this;if(!nr){var Ut=ur.pipes,Kt=ur.pipesCount;ur.pipes=null,ur.pipesCount=0,ur.flowing=!1;for(var or=0;or<Kt;or++)Ut[or].emit("unpipe",this,{hasUnpiped:!1});return this}var hr=ar(ur.pipes,nr);return hr===-1||(ur.pipes.splice(hr,1),ur.pipesCount-=1,ur.pipesCount===1&&(ur.pipes=ur.pipes[0]),nr.emit("unpipe",this,Er)),this},Qt.prototype.on=function(nr,ur){var Er=ot.prototype.on.call(this,nr,ur),Ut=this._readableState;return nr==="data"?(Ut.readableListening=this.listenerCount("readable")>0,Ut.flowing!==!1&&this.resume()):nr==="readable"&&(Ut.endEmitted||Ut.readableListening||(Ut.readableListening=Ut.needReadable=!0,Ut.flowing=!1,Ut.emittedReadable=!1,ft("on readable",Ut.length,Ut.reading),Ut.length?zt(this):Ut.reading||nt.nextTick(br,this))),Er},Qt.prototype.addListener=Qt.prototype.on,Qt.prototype.removeListener=function(nr,ur){var Er=ot.prototype.removeListener.call(this,nr,ur);return nr==="readable"&&nt.nextTick(mr,this),Er},Qt.prototype.removeAllListeners=function(nr){var ur=ot.prototype.removeAllListeners.apply(this,arguments);return nr!=="readable"&&nr!==void 0||nt.nextTick(mr,this),ur},Qt.prototype.resume=function(){var nr=this._readableState;return nr.flowing||(ft("resume"),nr.flowing=!nr.readableListening,Sr(this,nr)),nr.paused=!1,this},Qt.prototype.pause=function(){return ft("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(ft("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Qt.prototype.wrap=function(nr){var ur=this,Er=this._readableState,Ut=!1;for(var Kt in nr.on("end",(function(){if(ft("wrapped end"),Er.decoder&&!Er.ended){var hr=Er.decoder.end();hr&&hr.length&&ur.push(hr)}ur.push(null)})),nr.on("data",(function(hr){ft("wrapped data"),Er.decoder&&(hr=Er.decoder.write(hr)),Er.objectMode&&hr==null||(Er.objectMode||hr&&hr.length)&&(ur.push(hr)||(Ut=!0,nr.pause()))})),nr)this[Kt]===void 0&&typeof nr[Kt]=="function"&&(this[Kt]=(function(hr){return function(){return nr[hr].apply(nr,arguments)}})(Kt));for(var or=0;or<jt.length;or++)nr.on(jt[or],this.emit.bind(this,jt[or]));return this._read=function(hr){ft("wrapped _read",hr),Ut&&(Ut=!1,nr.resume())},this},typeof Symbol=="function"&&(Qt.prototype[Symbol.asyncIterator]=function(){return vt===void 0&&(vt=tt("./internal/streams/async_iterator")),vt(this)}),Object.defineProperty(Qt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Qt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Qt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(nr){this._readableState&&(this._readableState.flowing=nr)}}),Qt._fromList=Nt,Object.defineProperty(Qt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(Qt.from=function(nr,ur){return xt===void 0&&(xt=tt("./internal/streams/from")),xt(Qt,nr,ur)})}).call(this)}).call(this,tt("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/async_iterator":72,"./internal/streams/buffer_list":73,"./internal/streams/destroy":74,"./internal/streams/from":76,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,events:35,inherits:46,"string_decoder/":80,util:29}],70:[function(tt,et,rt){et.exports=dt;var nt=tt("../errors").codes,it=nt.ERR_METHOD_NOT_IMPLEMENTED,at=nt.ERR_MULTIPLE_CALLBACK,st=nt.ERR_TRANSFORM_ALREADY_TRANSFORMING,ot=nt.ERR_TRANSFORM_WITH_LENGTH_0,lt=tt("./_stream_duplex");function ht(mt,gt){var vt=this._transformState;vt.transforming=!1;var xt=vt.writecb;if(xt===null)return this.emit("error",new at);vt.writechunk=null,vt.writecb=null,gt!=null&&this.push(gt),xt(mt);var wt=this._readableState;wt.reading=!1,(wt.needReadable||wt.length<wt.highWaterMark)&&this._read(wt.highWaterMark)}function dt(mt){if(!(this instanceof dt))return new dt(mt);lt.call(this,mt),this._transformState={afterTransform:ht.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,mt&&(typeof mt.transform=="function"&&(this._transform=mt.transform),typeof mt.flush=="function"&&(this._flush=mt.flush)),this.on("prefinish",ut)}function ut(){var mt=this;typeof this._flush!="function"||this._readableState.destroyed?ft(this,null,null):this._flush((function(gt,vt){ft(mt,gt,vt)}))}function ft(mt,gt,vt){if(gt)return mt.emit("error",gt);if(vt!=null&&mt.push(vt),mt._writableState.length)throw new ot;if(mt._transformState.transforming)throw new st;return mt.push(null)}tt("inherits")(dt,lt),dt.prototype.push=function(mt,gt){return this._transformState.needTransform=!1,lt.prototype.push.call(this,mt,gt)},dt.prototype._transform=function(mt,gt,vt){vt(new it("_transform()"))},dt.prototype._write=function(mt,gt,vt){var xt=this._transformState;if(xt.writecb=vt,xt.writechunk=mt,xt.writeencoding=gt,!xt.transforming){var wt=this._readableState;(xt.needTransform||wt.needReadable||wt.length<wt.highWaterMark)&&this._read(wt.highWaterMark)}},dt.prototype._read=function(mt){var gt=this._transformState;gt.writechunk===null||gt.transforming?gt.needTransform=!0:(gt.transforming=!0,this._transform(gt.writechunk,gt.writeencoding,gt.afterTransform))},dt.prototype._destroy=function(mt,gt){lt.prototype._destroy.call(this,mt,(function(vt){gt(vt)}))}},{"../errors":66,"./_stream_duplex":67,inherits:46}],71:[function(tt,et,rt){(function(nt,it){(function(){function at(cr){var Nt=this;this.next=null,this.entry=null,this.finish=function(){Ir(Nt,cr)}}var st;et.exports=$t,$t.WritableState=Mt;var ot={deprecate:tt("util-deprecate")},lt=tt("./internal/streams/stream"),ht=tt("buffer").Buffer,dt=it.Uint8Array||function(){};function ut(cr){return ht.from(cr)}function ft(cr){return ht.isBuffer(cr)||cr instanceof dt}var mt,gt=tt("./internal/streams/destroy"),vt=tt("./internal/streams/state").getHighWaterMark,xt=tt("../errors").codes,wt=xt.ERR_INVALID_ARG_TYPE,At=xt.ERR_METHOD_NOT_IMPLEMENTED,Tt=xt.ERR_MULTIPLE_CALLBACK,Pt=xt.ERR_STREAM_CANNOT_PIPE,Rt=xt.ERR_STREAM_DESTROYED,Ot=xt.ERR_STREAM_NULL_VALUES,Et=xt.ERR_STREAM_WRITE_AFTER_END,Lt=xt.ERR_UNKNOWN_ENCODING,kt=gt.errorOrDestroy;function jt(){}function Mt(cr,Nt,pr){st=st||tt("./_stream_duplex"),cr=cr||{},typeof pr!="boolean"&&(pr=Nt instanceof st),this.objectMode=!!cr.objectMode,pr&&(this.objectMode=this.objectMode||!!cr.writableObjectMode),this.highWaterMark=vt(this,cr,"writableHighWaterMark",pr),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var rr=cr.decodeStrings===!1;this.decodeStrings=!rr,this.defaultEncoding=cr.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ar){Yt(Nt,ar)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=cr.emitClose!==!1,this.autoDestroy=!!cr.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new at(this)}function $t(cr){var Nt=this instanceof(st=st||tt("./_stream_duplex"));if(!Nt&&!mt.call($t,this))return new $t(cr);this._writableState=new Mt(cr,this,Nt),this.writable=!0,cr&&(typeof cr.write=="function"&&(this._write=cr.write),typeof cr.writev=="function"&&(this._writev=cr.writev),typeof cr.destroy=="function"&&(this._destroy=cr.destroy),typeof cr.final=="function"&&(this._final=cr.final)),lt.call(this)}function Qt(cr,Nt){var pr=new Et;kt(cr,pr),nt.nextTick(Nt,pr)}function Ht(cr,Nt,pr,rr){var ar;return pr===null?ar=new Ot:typeof pr=="string"||Nt.objectMode||(ar=new wt("chunk",["string","Buffer"],pr)),!ar||(kt(cr,ar),nt.nextTick(rr,ar),!1)}function qt(cr,Nt,pr){return cr.objectMode||cr.decodeStrings===!1||typeof Nt!="string"||(Nt=ht.from(Nt,pr)),Nt}function Bt(cr,Nt,pr,rr,ar,nr){if(!pr){var ur=qt(Nt,rr,ar);rr!==ur&&(pr=!0,ar="buffer",rr=ur)}var Er=Nt.objectMode?1:rr.length;Nt.length+=Er;var Ut=Nt.length<Nt.highWaterMark;if(Ut||(Nt.needDrain=!0),Nt.writing||Nt.corked){var Kt=Nt.lastBufferedRequest;Nt.lastBufferedRequest={chunk:rr,encoding:ar,isBuf:pr,callback:nr,next:null},Kt?Kt.next=Nt.lastBufferedRequest:Nt.bufferedRequest=Nt.lastBufferedRequest,Nt.bufferedRequestCount+=1}else Xt(cr,Nt,!1,Er,rr,ar,nr);return Ut}function Xt(cr,Nt,pr,rr,ar,nr,ur){Nt.writelen=rr,Nt.writecb=ur,Nt.writing=!0,Nt.sync=!0,Nt.destroyed?Nt.onwrite(new Rt("write")):pr?cr._writev(ar,Nt.onwrite):cr._write(ar,nr,Nt.onwrite),Nt.sync=!1}function Ft(cr,Nt,pr,rr,ar){--Nt.pendingcb,pr?(nt.nextTick(ar,rr),nt.nextTick(br,cr,Nt),cr._writableState.errorEmitted=!0,kt(cr,rr)):(ar(rr),cr._writableState.errorEmitted=!0,kt(cr,rr),br(cr,Nt))}function Wt(cr){cr.writing=!1,cr.writecb=null,cr.length-=cr.writelen,cr.writelen=0}function Yt(cr,Nt){var pr=cr._writableState,rr=pr.sync,ar=pr.writecb;if(typeof ar!="function")throw new Tt;if(Wt(pr),Nt)Ft(cr,pr,rr,Nt,ar);else{var nr=fr(pr)||cr.destroyed;nr||pr.corked||pr.bufferProcessing||!pr.bufferedRequest||dr(cr,pr),rr?nt.nextTick(zt,cr,pr,nr,ar):zt(cr,pr,nr,ar)}}function zt(cr,Nt,pr,rr){pr||er(cr,Nt),Nt.pendingcb--,rr(),br(cr,Nt)}function er(cr,Nt){Nt.length===0&&Nt.needDrain&&(Nt.needDrain=!1,cr.emit("drain"))}function dr(cr,Nt){Nt.bufferProcessing=!0;var pr=Nt.bufferedRequest;if(cr._writev&&pr&&pr.next){var rr=Nt.bufferedRequestCount,ar=new Array(rr),nr=Nt.corkedRequestsFree;nr.entry=pr;for(var ur=0,Er=!0;pr;)ar[ur]=pr,pr.isBuf||(Er=!1),pr=pr.next,ur+=1;ar.allBuffers=Er,Xt(cr,Nt,!0,Nt.length,ar,"",nr.finish),Nt.pendingcb++,Nt.lastBufferedRequest=null,nr.next?(Nt.corkedRequestsFree=nr.next,nr.next=null):Nt.corkedRequestsFree=new at(Nt),Nt.bufferedRequestCount=0}else{for(;pr;){var Ut=pr.chunk,Kt=pr.encoding,or=pr.callback;if(Xt(cr,Nt,!1,Nt.objectMode?1:Ut.length,Ut,Kt,or),pr=pr.next,Nt.bufferedRequestCount--,Nt.writing)break}pr===null&&(Nt.lastBufferedRequest=null)}Nt.bufferedRequest=pr,Nt.bufferProcessing=!1}function fr(cr){return cr.ending&&cr.length===0&&cr.bufferedRequest===null&&!cr.finished&&!cr.writing}function lr(cr,Nt){cr._final((function(pr){Nt.pendingcb--,pr&&kt(cr,pr),Nt.prefinished=!0,cr.emit("prefinish"),br(cr,Nt)}))}function mr(cr,Nt){Nt.prefinished||Nt.finalCalled||(typeof cr._final!="function"||Nt.destroyed?(Nt.prefinished=!0,cr.emit("prefinish")):(Nt.pendingcb++,Nt.finalCalled=!0,nt.nextTick(lr,cr,Nt)))}function br(cr,Nt){var pr=fr(Nt);if(pr&&(mr(cr,Nt),Nt.pendingcb===0&&(Nt.finished=!0,cr.emit("finish"),Nt.autoDestroy))){var rr=cr._readableState;(!rr||rr.autoDestroy&&rr.endEmitted)&&cr.destroy()}return pr}function Sr(cr,Nt,pr){Nt.ending=!0,br(cr,Nt),pr&&(Nt.finished?nt.nextTick(pr):cr.once("finish",pr)),Nt.ended=!0,cr.writable=!1}function Ir(cr,Nt,pr){var rr=cr.entry;for(cr.entry=null;rr;){var ar=rr.callback;Nt.pendingcb--,ar(pr),rr=rr.next}Nt.corkedRequestsFree.next=cr}tt("inherits")($t,lt),Mt.prototype.getBuffer=function(){for(var cr=this.bufferedRequest,Nt=[];cr;)Nt.push(cr),cr=cr.next;return Nt},(function(){try{Object.defineProperty(Mt.prototype,"buffer",{get:ot.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(mt=Function.prototype[Symbol.hasInstance],Object.defineProperty($t,Symbol.hasInstance,{value:function(cr){return!!mt.call(this,cr)||this===$t&&cr&&cr._writableState instanceof Mt}})):mt=function(cr){return cr instanceof this},$t.prototype.pipe=function(){kt(this,new Pt)},$t.prototype.write=function(cr,Nt,pr){var rr=this._writableState,ar=!1,nr=!rr.objectMode&&ft(cr);return nr&&!ht.isBuffer(cr)&&(cr=ut(cr)),typeof Nt=="function"&&(pr=Nt,Nt=null),nr?Nt="buffer":Nt||(Nt=rr.defaultEncoding),typeof pr!="function"&&(pr=jt),rr.ending?Qt(this,pr):(nr||Ht(this,rr,cr,pr))&&(rr.pendingcb++,ar=Bt(this,rr,nr,cr,Nt,pr)),ar},$t.prototype.cork=function(){this._writableState.corked++},$t.prototype.uncork=function(){var cr=this._writableState;cr.corked&&(cr.corked--,cr.writing||cr.corked||cr.bufferProcessing||!cr.bufferedRequest||dr(this,cr))},$t.prototype.setDefaultEncoding=function(cr){if(typeof cr=="string"&&(cr=cr.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((cr+"").toLowerCase())>-1))throw new Lt(cr);return this._writableState.defaultEncoding=cr,this},Object.defineProperty($t.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty($t.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),$t.prototype._write=function(cr,Nt,pr){pr(new At("_write()"))},$t.prototype._writev=null,$t.prototype.end=function(cr,Nt,pr){var rr=this._writableState;return typeof cr=="function"?(pr=cr,cr=null,Nt=null):typeof Nt=="function"&&(pr=Nt,Nt=null),cr!=null&&this.write(cr,Nt),rr.corked&&(rr.corked=1,this.uncork()),rr.ending||Sr(this,rr,pr),this},Object.defineProperty($t.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty($t.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(cr){this._writableState&&(this._writableState.destroyed=cr)}}),$t.prototype.destroy=gt.destroy,$t.prototype._undestroy=gt.undestroy,$t.prototype._destroy=function(cr,Nt){Nt(cr)}}).call(this)}).call(this,tt("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/destroy":74,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,inherits:46,"util-deprecate":81}],72:[function(tt,et,rt){(function(nt){(function(){var it;function at(Rt,Ot,Et){return Ot in Rt?Object.defineProperty(Rt,Ot,{value:Et,enumerable:!0,configurable:!0,writable:!0}):Rt[Ot]=Et,Rt}var st=tt("./end-of-stream"),ot=Symbol("lastResolve"),lt=Symbol("lastReject"),ht=Symbol("error"),dt=Symbol("ended"),ut=Symbol("lastPromise"),ft=Symbol("handlePromise"),mt=Symbol("stream");function gt(Rt,Ot){return{value:Rt,done:Ot}}function vt(Rt){var Ot=Rt[ot];if(Ot!==null){var Et=Rt[mt].read();Et!==null&&(Rt[ut]=null,Rt[ot]=null,Rt[lt]=null,Ot(gt(Et,!1)))}}function xt(Rt){nt.nextTick(vt,Rt)}function wt(Rt,Ot){return function(Et,Lt){Rt.then((function(){Ot[dt]?Et(gt(void 0,!0)):Ot[ft](Et,Lt)}),Lt)}}var At=Object.getPrototypeOf((function(){})),Tt=Object.setPrototypeOf((it={get stream(){return this[mt]},next:function(){var Rt=this,Ot=this[ht];if(Ot!==null)return Promise.reject(Ot);if(this[dt])return Promise.resolve(gt(void 0,!0));if(this[mt].destroyed)return new Promise((function(jt,Mt){nt.nextTick((function(){Rt[ht]?Mt(Rt[ht]):jt(gt(void 0,!0))}))}));var Et,Lt=this[ut];if(Lt)Et=new Promise(wt(Lt,this));else{var kt=this[mt].read();if(kt!==null)return Promise.resolve(gt(kt,!1));Et=new Promise(this[ft])}return this[ut]=Et,Et}},at(it,Symbol.asyncIterator,(function(){return this})),at(it,"return",(function(){var Rt=this;return new Promise((function(Ot,Et){Rt[mt].destroy(null,(function(Lt){Lt?Et(Lt):Ot(gt(void 0,!0))}))}))})),it),At),Pt=function(Rt){var Ot,Et=Object.create(Tt,(at(Ot={},mt,{value:Rt,writable:!0}),at(Ot,ot,{value:null,writable:!0}),at(Ot,lt,{value:null,writable:!0}),at(Ot,ht,{value:null,writable:!0}),at(Ot,dt,{value:Rt._readableState.endEmitted,writable:!0}),at(Ot,ft,{value:function(Lt,kt){var jt=Et[mt].read();jt?(Et[ut]=null,Et[ot]=null,Et[lt]=null,Lt(gt(jt,!1))):(Et[ot]=Lt,Et[lt]=kt)},writable:!0}),Ot));return Et[ut]=null,st(Rt,(function(Lt){if(Lt&&Lt.code!=="ERR_STREAM_PREMATURE_CLOSE"){var kt=Et[lt];return kt!==null&&(Et[ut]=null,Et[ot]=null,Et[lt]=null,kt(Lt)),void(Et[ht]=Lt)}var jt=Et[ot];jt!==null&&(Et[ut]=null,Et[ot]=null,Et[lt]=null,jt(gt(void 0,!0))),Et[dt]=!0})),Rt.on("readable",xt.bind(null,Et)),Et};et.exports=Pt}).call(this)}).call(this,tt("_process"))},{"./end-of-stream":75,_process:63}],73:[function(tt,et,rt){function nt(mt,gt){var vt=Object.keys(mt);if(Object.getOwnPropertySymbols){var xt=Object.getOwnPropertySymbols(mt);gt&&(xt=xt.filter((function(wt){return Object.getOwnPropertyDescriptor(mt,wt).enumerable}))),vt.push.apply(vt,xt)}return vt}function it(mt){for(var gt=1;gt<arguments.length;gt++){var vt=arguments[gt]!=null?arguments[gt]:{};gt%2?nt(Object(vt),!0).forEach((function(xt){at(mt,xt,vt[xt])})):Object.getOwnPropertyDescriptors?Object.defineProperties(mt,Object.getOwnPropertyDescriptors(vt)):nt(Object(vt)).forEach((function(xt){Object.defineProperty(mt,xt,Object.getOwnPropertyDescriptor(vt,xt))}))}return mt}function at(mt,gt,vt){return gt in mt?Object.defineProperty(mt,gt,{value:vt,enumerable:!0,configurable:!0,writable:!0}):mt[gt]=vt,mt}function st(mt,gt){if(!(mt instanceof gt))throw new TypeError("Cannot call a class as a function")}function ot(mt,gt){for(var vt=0;vt<gt.length;vt++){var xt=gt[vt];xt.enumerable=xt.enumerable||!1,xt.configurable=!0,"value"in xt&&(xt.writable=!0),Object.defineProperty(mt,xt.key,xt)}}function lt(mt,gt,vt){return gt&&ot(mt.prototype,gt),mt}var ht=tt("buffer").Buffer,dt=tt("util").inspect,ut=dt&&dt.custom||"inspect";function ft(mt,gt,vt){ht.prototype.copy.call(mt,gt,vt)}et.exports=(function(){function mt(){st(this,mt),this.head=null,this.tail=null,this.length=0}return lt(mt,[{key:"push",value:function(gt){var vt={data:gt,next:null};this.length>0?this.tail.next=vt:this.head=vt,this.tail=vt,++this.length}},{key:"unshift",value:function(gt){var vt={data:gt,next:this.head};this.length===0&&(this.tail=vt),this.head=vt,++this.length}},{key:"shift",value:function(){if(this.length!==0){var gt=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,gt}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(gt){if(this.length===0)return"";for(var vt=this.head,xt=""+vt.data;vt=vt.next;)xt+=gt+vt.data;return xt}},{key:"concat",value:function(gt){if(this.length===0)return ht.alloc(0);for(var vt=ht.allocUnsafe(gt>>>0),xt=this.head,wt=0;xt;)ft(xt.data,vt,wt),wt+=xt.data.length,xt=xt.next;return vt}},{key:"consume",value:function(gt,vt){var xt;return gt<this.head.data.length?(xt=this.head.data.slice(0,gt),this.head.data=this.head.data.slice(gt)):xt=gt===this.head.data.length?this.shift():vt?this._getString(gt):this._getBuffer(gt),xt}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(gt){var vt=this.head,xt=1,wt=vt.data;for(gt-=wt.length;vt=vt.next;){var At=vt.data,Tt=gt>At.length?At.length:gt;if(Tt===At.length?wt+=At:wt+=At.slice(0,gt),(gt-=Tt)==0){Tt===At.length?(++xt,vt.next?this.head=vt.next:this.head=this.tail=null):(this.head=vt,vt.data=At.slice(Tt));break}++xt}return this.length-=xt,wt}},{key:"_getBuffer",value:function(gt){var vt=ht.allocUnsafe(gt),xt=this.head,wt=1;for(xt.data.copy(vt),gt-=xt.data.length;xt=xt.next;){var At=xt.data,Tt=gt>At.length?At.length:gt;if(At.copy(vt,vt.length-gt,0,Tt),(gt-=Tt)==0){Tt===At.length?(++wt,xt.next?this.head=xt.next:this.head=this.tail=null):(this.head=xt,xt.data=At.slice(Tt));break}++wt}return this.length-=wt,vt}},{key:ut,value:function(gt,vt){return dt(this,it({},vt,{depth:0,customInspect:!1}))}}]),mt})()},{buffer:32,util:29}],74:[function(tt,et,rt){(function(nt){(function(){function it(dt,ut){var ft=this,mt=this._readableState&&this._readableState.destroyed,gt=this._writableState&&this._writableState.destroyed;return mt||gt?(ut?ut(dt):dt&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,nt.nextTick(lt,this,dt)):nt.nextTick(lt,this,dt)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(dt||null,(function(vt){!ut&&vt?ft._writableState?ft._writableState.errorEmitted?nt.nextTick(st,ft):(ft._writableState.errorEmitted=!0,nt.nextTick(at,ft,vt)):nt.nextTick(at,ft,vt):ut?(nt.nextTick(st,ft),ut(vt)):nt.nextTick(st,ft)})),this)}function at(dt,ut){lt(dt,ut),st(dt)}function st(dt){dt._writableState&&!dt._writableState.emitClose||dt._readableState&&!dt._readableState.emitClose||dt.emit("close")}function ot(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function lt(dt,ut){dt.emit("error",ut)}function ht(dt,ut){var ft=dt._readableState,mt=dt._writableState;ft&&ft.autoDestroy||mt&&mt.autoDestroy?dt.destroy(ut):dt.emit("error",ut)}et.exports={destroy:it,undestroy:ot,errorOrDestroy:ht}}).call(this)}).call(this,tt("_process"))},{_process:63}],75:[function(tt,et,rt){var nt=tt("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function it(lt){var ht=!1;return function(){if(!ht){ht=!0;for(var dt=arguments.length,ut=new Array(dt),ft=0;ft<dt;ft++)ut[ft]=arguments[ft];lt.apply(this,ut)}}}function at(){}function st(lt){return lt.setHeader&&typeof lt.abort=="function"}function ot(lt,ht,dt){if(typeof ht=="function")return ot(lt,null,ht);ht||(ht={}),dt=it(dt||at);var ut=ht.readable||ht.readable!==!1&&lt.readable,ft=ht.writable||ht.writable!==!1&&lt.writable,mt=function(){lt.writable||vt()},gt=lt._writableState&&lt._writableState.finished,vt=function(){ft=!1,gt=!0,ut||dt.call(lt)},xt=lt._readableState&&lt._readableState.endEmitted,wt=function(){ut=!1,xt=!0,ft||dt.call(lt)},At=function(Rt){dt.call(lt,Rt)},Tt=function(){var Rt;return ut&&!xt?(lt._readableState&&lt._readableState.ended||(Rt=new nt),dt.call(lt,Rt)):ft&&!gt?(lt._writableState&&lt._writableState.ended||(Rt=new nt),dt.call(lt,Rt)):void 0},Pt=function(){lt.req.on("finish",vt)};return st(lt)?(lt.on("complete",vt),lt.on("abort",Tt),lt.req?Pt():lt.on("request",Pt)):ft&&!lt._writableState&&(lt.on("end",mt),lt.on("close",mt)),lt.on("end",wt),lt.on("finish",vt),ht.error!==!1&&lt.on("error",At),lt.on("close",Tt),function(){lt.removeListener("complete",vt),lt.removeListener("abort",Tt),lt.removeListener("request",Pt),lt.req&&lt.req.removeListener("finish",vt),lt.removeListener("end",mt),lt.removeListener("close",mt),lt.removeListener("finish",vt),lt.removeListener("end",wt),lt.removeListener("error",At),lt.removeListener("close",Tt)}}et.exports=ot},{"../../../errors":66}],76:[function(tt,et,rt){et.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],77:[function(tt,et,rt){var nt;function it(vt){var xt=!1;return function(){xt||(xt=!0,vt.apply(void 0,arguments))}}var at=tt("../../../errors").codes,st=at.ERR_MISSING_ARGS,ot=at.ERR_STREAM_DESTROYED;function lt(vt){if(vt)throw vt}function ht(vt){return vt.setHeader&&typeof vt.abort=="function"}function dt(vt,xt,wt,At){At=it(At);var Tt=!1;vt.on("close",(function(){Tt=!0})),nt===void 0&&(nt=tt("./end-of-stream")),nt(vt,{readable:xt,writable:wt},(function(Rt){if(Rt)return At(Rt);Tt=!0,At()}));var Pt=!1;return function(Rt){if(!Tt&&!Pt)return Pt=!0,ht(vt)?vt.abort():typeof vt.destroy=="function"?vt.destroy():void At(Rt||new ot("pipe"))}}function ut(vt){vt()}function ft(vt,xt){return vt.pipe(xt)}function mt(vt){return vt.length?typeof vt[vt.length-1]!="function"?lt:vt.pop():lt}function gt(){for(var vt=arguments.length,xt=new Array(vt),wt=0;wt<vt;wt++)xt[wt]=arguments[wt];var At,Tt=mt(xt);if(Array.isArray(xt[0])&&(xt=xt[0]),xt.length<2)throw new st("streams");var Pt=xt.map((function(Rt,Ot){var Et=Ot<xt.length-1;return dt(Rt,Et,Ot>0,(function(Lt){At||(At=Lt),Lt&&Pt.forEach(ut),Et||(Pt.forEach(ut),Tt(At))}))}));return xt.reduce(ft)}et.exports=gt},{"../../../errors":66,"./end-of-stream":75}],78:[function(tt,et,rt){var nt=tt("../../../errors").codes.ERR_INVALID_OPT_VALUE;function it(st,ot,lt){return st.highWaterMark!=null?st.highWaterMark:ot?st[lt]:null}function at(st,ot,lt,ht){var dt=it(ot,ht,lt);if(dt!=null){if(!isFinite(dt)||Math.floor(dt)!==dt||dt<0)throw new nt(ht?lt:"highWaterMark",dt);return Math.floor(dt)}return st.objectMode?16:16384}et.exports={getHighWaterMark:at}},{"../../../errors":66}],79:[function(tt,et,rt){et.exports=tt("events").EventEmitter},{events:35}],80:[function(tt,et,rt){var nt=tt("safe-buffer").Buffer,it=nt.isEncoding||function(Pt){switch((Pt=""+Pt)&&Pt.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function at(Pt){if(!Pt)return"utf8";for(var Rt;;)switch(Pt){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return Pt;default:if(Rt)return;Pt=(""+Pt).toLowerCase(),Rt=!0}}function st(Pt){var Rt=at(Pt);if(typeof Rt!="string"&&(nt.isEncoding===it||!it(Pt)))throw new Error("Unknown encoding: "+Pt);return Rt||Pt}function ot(Pt){var Rt;switch(this.encoding=st(Pt),this.encoding){case"utf16le":this.text=gt,this.end=vt,Rt=4;break;case"utf8":this.fillLast=ut,Rt=4;break;case"base64":this.text=xt,this.end=wt,Rt=3;break;default:return this.write=At,void(this.end=Tt)}this.lastNeed=0,this.lastTotal=0,this.lastChar=nt.allocUnsafe(Rt)}function lt(Pt){return Pt<=127?0:Pt>>5==6?2:Pt>>4==14?3:Pt>>3==30?4:Pt>>6==2?-1:-2}function ht(Pt,Rt,Ot){var Et=Rt.length-1;if(Et<Ot)return 0;var Lt=lt(Rt[Et]);return Lt>=0?(Lt>0&&(Pt.lastNeed=Lt-1),Lt):--Et<Ot||Lt===-2?0:(Lt=lt(Rt[Et]))>=0?(Lt>0&&(Pt.lastNeed=Lt-2),Lt):--Et<Ot||Lt===-2?0:(Lt=lt(Rt[Et]))>=0?(Lt>0&&(Lt===2?Lt=0:Pt.lastNeed=Lt-3),Lt):0}function dt(Pt,Rt,Ot){if((192&Rt[0])!=128)return Pt.lastNeed=0,"";if(Pt.lastNeed>1&&Rt.length>1){if((192&Rt[1])!=128)return Pt.lastNeed=1,"";if(Pt.lastNeed>2&&Rt.length>2&&(192&Rt[2])!=128)return Pt.lastNeed=2,""}}function ut(Pt){var Rt=this.lastTotal-this.lastNeed,Ot=dt(this,Pt);return Ot!==void 0?Ot:this.lastNeed<=Pt.length?(Pt.copy(this.lastChar,Rt,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(Pt.copy(this.lastChar,Rt,0,Pt.length),void(this.lastNeed-=Pt.length))}function ft(Pt,Rt){var Ot=ht(this,Pt,Rt);if(!this.lastNeed)return Pt.toString("utf8",Rt);this.lastTotal=Ot;var Et=Pt.length-(Ot-this.lastNeed);return Pt.copy(this.lastChar,0,Et),Pt.toString("utf8",Rt,Et)}function mt(Pt){var Rt=Pt&&Pt.length?this.write(Pt):"";return this.lastNeed?Rt+"":Rt}function gt(Pt,Rt){if((Pt.length-Rt)%2==0){var Ot=Pt.toString("utf16le",Rt);if(Ot){var Et=Ot.charCodeAt(Ot.length-1);if(Et>=55296&&Et<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=Pt[Pt.length-2],this.lastChar[1]=Pt[Pt.length-1],Ot.slice(0,-1)}return Ot}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=Pt[Pt.length-1],Pt.toString("utf16le",Rt,Pt.length-1)}function vt(Pt){var Rt=Pt&&Pt.length?this.write(Pt):"";if(this.lastNeed){var Ot=this.lastTotal-this.lastNeed;return Rt+this.lastChar.toString("utf16le",0,Ot)}return Rt}function xt(Pt,Rt){var Ot=(Pt.length-Rt)%3;return Ot===0?Pt.toString("base64",Rt):(this.lastNeed=3-Ot,this.lastTotal=3,Ot===1?this.lastChar[0]=Pt[Pt.length-1]:(this.lastChar[0]=Pt[Pt.length-2],this.lastChar[1]=Pt[Pt.length-1]),Pt.toString("base64",Rt,Pt.length-Ot))}function wt(Pt){var Rt=Pt&&Pt.length?this.write(Pt):"";return this.lastNeed?Rt+this.lastChar.toString("base64",0,3-this.lastNeed):Rt}function At(Pt){return Pt.toString(this.encoding)}function Tt(Pt){return Pt&&Pt.length?this.write(Pt):""}rt.StringDecoder=ot,ot.prototype.write=function(Pt){if(Pt.length===0)return"";var Rt,Ot;if(this.lastNeed){if((Rt=this.fillLast(Pt))===void 0)return"";Ot=this.lastNeed,this.lastNeed=0}else Ot=0;return Ot<Pt.length?Rt?Rt+this.text(Pt,Ot):this.text(Pt,Ot):Rt||""},ot.prototype.end=mt,ot.prototype.text=ft,ot.prototype.fillLast=function(Pt){if(this.lastNeed<=Pt.length)return Pt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);Pt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,Pt.length),this.lastNeed-=Pt.length}},{"safe-buffer":64}],81:[function(tt,et,rt){(function(nt){(function(){function it(st,ot){if(at("noDeprecation"))return st;var lt=!1;function ht(){if(!lt){if(at("throwDeprecation"))throw new Error(ot);at("traceDeprecation")?console.trace(ot):console.warn(ot),lt=!0}return st.apply(this,arguments)}return ht}function at(st){try{if(!nt.localStorage)return!1}catch{return!1}var ot=nt.localStorage[st];return ot!=null&&String(ot).toLowerCase()==="true"}et.exports=it}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],82:[function(tt,et,rt){arguments[4][25][0].apply(rt,arguments)},{dup:25}],83:[function(tt,et,rt){var nt=tt("is-arguments"),it=tt("is-generator-function"),at=tt("which-typed-array"),st=tt("is-typed-array");function ot(hr){return hr.call.bind(hr)}var lt=typeof BigInt<"u",ht=typeof Symbol<"u",dt=ot(Object.prototype.toString),ut=ot(Number.prototype.valueOf),ft=ot(String.prototype.valueOf),mt=ot(Boolean.prototype.valueOf);if(lt)var gt=ot(BigInt.prototype.valueOf);if(ht)var vt=ot(Symbol.prototype.valueOf);function xt(hr,kr){if(typeof hr!="object")return!1;try{return kr(hr),!0}catch{return!1}}function wt(hr){return typeof Promise<"u"&&hr instanceof Promise||hr!==null&&typeof hr=="object"&&typeof hr.then=="function"&&typeof hr.catch=="function"}function At(hr){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(hr):st(hr)||lr(hr)}function Tt(hr){return at(hr)==="Uint8Array"}function Pt(hr){return at(hr)==="Uint8ClampedArray"}function Rt(hr){return at(hr)==="Uint16Array"}function Ot(hr){return at(hr)==="Uint32Array"}function Et(hr){return at(hr)==="Int8Array"}function Lt(hr){return at(hr)==="Int16Array"}function kt(hr){return at(hr)==="Int32Array"}function jt(hr){return at(hr)==="Float32Array"}function Mt(hr){return at(hr)==="Float64Array"}function $t(hr){return at(hr)==="BigInt64Array"}function Qt(hr){return at(hr)==="BigUint64Array"}function Ht(hr){return dt(hr)==="[object Map]"}function qt(hr){return typeof Map<"u"&&(Ht.working?Ht(hr):hr instanceof Map)}function Bt(hr){return dt(hr)==="[object Set]"}function Xt(hr){return typeof Set<"u"&&(Bt.working?Bt(hr):hr instanceof Set)}function Ft(hr){return dt(hr)==="[object WeakMap]"}function Wt(hr){return typeof WeakMap<"u"&&(Ft.working?Ft(hr):hr instanceof WeakMap)}function Yt(hr){return dt(hr)==="[object WeakSet]"}function zt(hr){return Yt(hr)}function er(hr){return dt(hr)==="[object ArrayBuffer]"}function dr(hr){return typeof ArrayBuffer<"u"&&(er.working?er(hr):hr instanceof ArrayBuffer)}function fr(hr){return dt(hr)==="[object DataView]"}function lr(hr){return typeof DataView<"u"&&(fr.working?fr(hr):hr instanceof DataView)}rt.isArgumentsObject=nt,rt.isGeneratorFunction=it,rt.isTypedArray=st,rt.isPromise=wt,rt.isArrayBufferView=At,rt.isUint8Array=Tt,rt.isUint8ClampedArray=Pt,rt.isUint16Array=Rt,rt.isUint32Array=Ot,rt.isInt8Array=Et,rt.isInt16Array=Lt,rt.isInt32Array=kt,rt.isFloat32Array=jt,rt.isFloat64Array=Mt,rt.isBigInt64Array=$t,rt.isBigUint64Array=Qt,Ht.working=typeof Map<"u"&&Ht(new Map),rt.isMap=qt,Bt.working=typeof Set<"u"&&Bt(new Set),rt.isSet=Xt,Ft.working=typeof WeakMap<"u"&&Ft(new WeakMap),rt.isWeakMap=Wt,Yt.working=typeof WeakSet<"u"&&Yt(new WeakSet),rt.isWeakSet=zt,er.working=typeof ArrayBuffer<"u"&&er(new ArrayBuffer),rt.isArrayBuffer=dr,fr.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&fr(new DataView(new ArrayBuffer(1),0,1)),rt.isDataView=lr;var mr=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function br(hr){return dt(hr)==="[object SharedArrayBuffer]"}function Sr(hr){return mr!==void 0&&(br.working===void 0&&(br.working=br(new mr)),br.working?br(hr):hr instanceof mr)}function Ir(hr){return dt(hr)==="[object AsyncFunction]"}function cr(hr){return dt(hr)==="[object Map Iterator]"}function Nt(hr){return dt(hr)==="[object Set Iterator]"}function pr(hr){return dt(hr)==="[object Generator]"}function rr(hr){return dt(hr)==="[object WebAssembly.Module]"}function ar(hr){return xt(hr,ut)}function nr(hr){return xt(hr,ft)}function ur(hr){return xt(hr,mt)}function Er(hr){return lt&&xt(hr,gt)}function Ut(hr){return ht&&xt(hr,vt)}function Kt(hr){return ar(hr)||nr(hr)||ur(hr)||Er(hr)||Ut(hr)}function or(hr){return typeof Uint8Array<"u"&&(dr(hr)||Sr(hr))}rt.isSharedArrayBuffer=Sr,rt.isAsyncFunction=Ir,rt.isMapIterator=cr,rt.isSetIterator=Nt,rt.isGeneratorObject=pr,rt.isWebAssemblyCompiledModule=rr,rt.isNumberObject=ar,rt.isStringObject=nr,rt.isBooleanObject=ur,rt.isBigIntObject=Er,rt.isSymbolObject=Ut,rt.isBoxedPrimitive=Kt,rt.isAnyArrayBuffer=or,["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(hr){Object.defineProperty(rt,hr,{enumerable:!1,value:function(){throw new Error(hr+" is not supported in userland")}})}))},{"is-arguments":47,"is-generator-function":49,"is-typed-array":50,"which-typed-array":85}],84:[function(tt,et,rt){(function(nt){(function(){var it=Object.getOwnPropertyDescriptors||function(lr){for(var mr=Object.keys(lr),br={},Sr=0;Sr<mr.length;Sr++)br[mr[Sr]]=Object.getOwnPropertyDescriptor(lr,mr[Sr]);return br},at=/%[sdj%]/g;rt.format=function(lr){if(!Lt(lr)){for(var mr=[],br=0;br<arguments.length;br++)mr.push(ht(arguments[br]));return mr.join(" ")}br=1;for(var Sr=arguments,Ir=Sr.length,cr=String(lr).replace(at,(function(pr){if(pr==="%%")return"%";if(br>=Ir)return pr;switch(pr){case"%s":return String(Sr[br++]);case"%d":return Number(Sr[br++]);case"%j":try{return JSON.stringify(Sr[br++])}catch{return"[Circular]"}default:return pr}})),Nt=Sr[br];br<Ir;Nt=Sr[++br])Rt(Nt)||!$t(Nt)?cr+=" "+Nt:cr+=" "+ht(Nt);return cr},rt.deprecate=function(lr,mr){if(nt!==void 0&&nt.noDeprecation===!0)return lr;if(nt===void 0)return function(){return rt.deprecate(lr,mr).apply(this,arguments)};var br=!1;function Sr(){if(!br){if(nt.throwDeprecation)throw new Error(mr);nt.traceDeprecation?console.trace(mr):console.error(mr),br=!0}return lr.apply(this,arguments)}return Sr};var st={},ot=/^$/;if(nt.env.NODE_DEBUG){var lt=nt.env.NODE_DEBUG;lt=lt.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),ot=new RegExp("^"+lt+"$","i")}function ht(lr,mr){var br={seen:[],stylize:ut};return arguments.length>=3&&(br.depth=arguments[2]),arguments.length>=4&&(br.colors=arguments[3]),Pt(mr)?br.showHidden=mr:mr&&rt._extend(br,mr),jt(br.showHidden)&&(br.showHidden=!1),jt(br.depth)&&(br.depth=2),jt(br.colors)&&(br.colors=!1),jt(br.customInspect)&&(br.customInspect=!0),br.colors&&(br.stylize=dt),mt(br,lr,br.depth)}function dt(lr,mr){var br=ht.styles[mr];return br?"\x1B["+ht.colors[br][0]+"m"+lr+"\x1B["+ht.colors[br][1]+"m":lr}function ut(lr,mr){return lr}function ft(lr){var mr={};return lr.forEach((function(br,Sr){mr[br]=!0})),mr}function mt(lr,mr,br){if(lr.customInspect&&mr&&qt(mr.inspect)&&mr.inspect!==rt.inspect&&(!mr.constructor||mr.constructor.prototype!==mr)){var Sr=mr.inspect(br,lr);return Lt(Sr)||(Sr=mt(lr,Sr,br)),Sr}var Ir=gt(lr,mr);if(Ir)return Ir;var cr=Object.keys(mr),Nt=ft(cr);if(lr.showHidden&&(cr=Object.getOwnPropertyNames(mr)),Ht(mr)&&(cr.indexOf("message")>=0||cr.indexOf("description")>=0))return vt(mr);if(cr.length===0){if(qt(mr)){var pr=mr.name?": "+mr.name:"";return lr.stylize("[Function"+pr+"]","special")}if(Mt(mr))return lr.stylize(RegExp.prototype.toString.call(mr),"regexp");if(Qt(mr))return lr.stylize(Date.prototype.toString.call(mr),"date");if(Ht(mr))return vt(mr)}var rr,ar="",nr=!1,ur=["{","}"];return Tt(mr)&&(nr=!0,ur=["[","]"]),qt(mr)&&(ar=" [Function"+(mr.name?": "+mr.name:"")+"]"),Mt(mr)&&(ar=" "+RegExp.prototype.toString.call(mr)),Qt(mr)&&(ar=" "+Date.prototype.toUTCString.call(mr)),Ht(mr)&&(ar=" "+vt(mr)),cr.length!==0||nr&&mr.length!=0?br<0?Mt(mr)?lr.stylize(RegExp.prototype.toString.call(mr),"regexp"):lr.stylize("[Object]","special"):(lr.seen.push(mr),rr=nr?xt(lr,mr,br,Nt,cr):cr.map((function(Er){return wt(lr,mr,br,Nt,Er,nr)})),lr.seen.pop(),At(rr,ar,ur)):ur[0]+ar+ur[1]}function gt(lr,mr){if(jt(mr))return lr.stylize("undefined","undefined");if(Lt(mr)){var br="'"+JSON.stringify(mr).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return lr.stylize(br,"string")}return Et(mr)?lr.stylize(""+mr,"number"):Pt(mr)?lr.stylize(""+mr,"boolean"):Rt(mr)?lr.stylize("null","null"):void 0}function vt(lr){return"["+Error.prototype.toString.call(lr)+"]"}function xt(lr,mr,br,Sr,Ir){for(var cr=[],Nt=0,pr=mr.length;Nt<pr;++Nt)zt(mr,String(Nt))?cr.push(wt(lr,mr,br,Sr,String(Nt),!0)):cr.push("");return Ir.forEach((function(rr){rr.match(/^\d+$/)||cr.push(wt(lr,mr,br,Sr,rr,!0))})),cr}function wt(lr,mr,br,Sr,Ir,cr){var Nt,pr,rr;if((rr=Object.getOwnPropertyDescriptor(mr,Ir)||{value:mr[Ir]}).get?pr=rr.set?lr.stylize("[Getter/Setter]","special"):lr.stylize("[Getter]","special"):rr.set&&(pr=lr.stylize("[Setter]","special")),zt(Sr,Ir)||(Nt="["+Ir+"]"),pr||(lr.seen.indexOf(rr.value)<0?(pr=Rt(br)?mt(lr,rr.value,null):mt(lr,rr.value,br-1)).indexOf(`
`)>-1&&(pr=cr?pr.split(`
`).map((function(ar){return"  "+ar})).join(`
`).slice(2):`
`+pr.split(`
`).map((function(ar){return"   "+ar})).join(`
`)):pr=lr.stylize("[Circular]","special")),jt(Nt)){if(cr&&Ir.match(/^\d+$/))return pr;(Nt=JSON.stringify(""+Ir)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Nt=Nt.slice(1,-1),Nt=lr.stylize(Nt,"name")):(Nt=Nt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Nt=lr.stylize(Nt,"string"))}return Nt+": "+pr}function At(lr,mr,br){return lr.reduce((function(Sr,Ir){return Ir.indexOf(`
`),Sr+Ir.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?br[0]+(mr===""?"":mr+`
 `)+" "+lr.join(`,
  `)+" "+br[1]:br[0]+mr+" "+lr.join(", ")+" "+br[1]}function Tt(lr){return Array.isArray(lr)}function Pt(lr){return typeof lr=="boolean"}function Rt(lr){return lr===null}function Ot(lr){return lr==null}function Et(lr){return typeof lr=="number"}function Lt(lr){return typeof lr=="string"}function kt(lr){return typeof lr=="symbol"}function jt(lr){return lr===void 0}function Mt(lr){return $t(lr)&&Xt(lr)==="[object RegExp]"}function $t(lr){return typeof lr=="object"&&lr!==null}function Qt(lr){return $t(lr)&&Xt(lr)==="[object Date]"}function Ht(lr){return $t(lr)&&(Xt(lr)==="[object Error]"||lr instanceof Error)}function qt(lr){return typeof lr=="function"}function Bt(lr){return lr===null||typeof lr=="boolean"||typeof lr=="number"||typeof lr=="string"||typeof lr=="symbol"||lr===void 0}function Xt(lr){return Object.prototype.toString.call(lr)}function Ft(lr){return lr<10?"0"+lr.toString(10):lr.toString(10)}rt.debuglog=function(lr){if(lr=lr.toUpperCase(),!st[lr])if(ot.test(lr)){var mr=nt.pid;st[lr]=function(){var br=rt.format.apply(rt,arguments);console.error("%s %d: %s",lr,mr,br)}}else st[lr]=function(){};return st[lr]},rt.inspect=ht,ht.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},ht.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},rt.types=tt("./support/types"),rt.isArray=Tt,rt.isBoolean=Pt,rt.isNull=Rt,rt.isNullOrUndefined=Ot,rt.isNumber=Et,rt.isString=Lt,rt.isSymbol=kt,rt.isUndefined=jt,rt.isRegExp=Mt,rt.types.isRegExp=Mt,rt.isObject=$t,rt.isDate=Qt,rt.types.isDate=Qt,rt.isError=Ht,rt.types.isNativeError=Ht,rt.isFunction=qt,rt.isPrimitive=Bt,rt.isBuffer=tt("./support/isBuffer");var Wt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Yt(){var lr=new Date,mr=[Ft(lr.getHours()),Ft(lr.getMinutes()),Ft(lr.getSeconds())].join(":");return[lr.getDate(),Wt[lr.getMonth()],mr].join(" ")}function zt(lr,mr){return Object.prototype.hasOwnProperty.call(lr,mr)}rt.log=function(){console.log("%s - %s",Yt(),rt.format.apply(rt,arguments))},rt.inherits=tt("inherits"),rt._extend=function(lr,mr){if(!mr||!$t(mr))return lr;for(var br=Object.keys(mr),Sr=br.length;Sr--;)lr[br[Sr]]=mr[br[Sr]];return lr};var er=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function dr(lr,mr){if(!lr){var br=new Error("Promise was rejected with a falsy value");br.reason=lr,lr=br}return mr(lr)}function fr(lr){if(typeof lr!="function")throw new TypeError('The "original" argument must be of type Function');function mr(){for(var br=[],Sr=0;Sr<arguments.length;Sr++)br.push(arguments[Sr]);var Ir=br.pop();if(typeof Ir!="function")throw new TypeError("The last argument must be of type Function");var cr=this,Nt=function(){return Ir.apply(cr,arguments)};lr.apply(this,br).then((function(pr){nt.nextTick(Nt.bind(null,null,pr))}),(function(pr){nt.nextTick(dr.bind(null,pr,Nt))}))}return Object.setPrototypeOf(mr,Object.getPrototypeOf(lr)),Object.defineProperties(mr,it(lr)),mr}rt.promisify=function(lr){if(typeof lr!="function")throw new TypeError('The "original" argument must be of type Function');if(er&&lr[er]){var mr;if(typeof(mr=lr[er])!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(mr,er,{value:mr,enumerable:!1,writable:!1,configurable:!0}),mr}function mr(){for(var br,Sr,Ir=new Promise((function(pr,rr){br=pr,Sr=rr})),cr=[],Nt=0;Nt<arguments.length;Nt++)cr.push(arguments[Nt]);cr.push((function(pr,rr){pr?Sr(pr):br(rr)}));try{lr.apply(this,cr)}catch(pr){Sr(pr)}return Ir}return Object.setPrototypeOf(mr,Object.getPrototypeOf(lr)),er&&Object.defineProperty(mr,er,{value:mr,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(mr,it(lr))},rt.promisify.custom=er,rt.callbackify=fr}).call(this)}).call(this,tt("_process"))},{"./support/isBuffer":82,"./support/types":83,_process:63,inherits:46}],85:[function(tt,et,rt){(function(nt){(function(){var it=tt("for-each"),at=tt("available-typed-arrays"),st=tt("call-bind/callBound"),ot=tt("gopd"),lt=st("Object.prototype.toString"),ht=tt("has-tostringtag/shams")(),dt=typeof globalThis>"u"?nt:globalThis,ut=at(),ft=st("String.prototype.slice"),mt={},gt=Object.getPrototypeOf;ht&&ot&&gt&&it(ut,(function(wt){if(typeof dt[wt]=="function"){var At=new dt[wt];if(Symbol.toStringTag in At){var Tt=gt(At),Pt=ot(Tt,Symbol.toStringTag);if(!Pt){var Rt=gt(Tt);Pt=ot(Rt,Symbol.toStringTag)}mt[wt]=Pt.get}}}));var vt=function(wt){var At=!1;return it(mt,(function(Tt,Pt){if(!At)try{var Rt=Tt.call(wt);Rt===Pt&&(At=Rt)}catch{}})),At},xt=tt("is-typed-array");et.exports=function(wt){return!!xt(wt)&&(ht&&Symbol.toStringTag in wt?vt(wt):ft(lt(wt),8,-1))}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43,"is-typed-array":50}]},{},[20])(20);var browserExports=browser$1.exports,PNGFilterType,PNGFilterType2,PNGColorType,PNGColorType2;function png(){return{mime:"image/png",hasAlpha:!0,encode:(tt,{deflateLevel:et=9,deflateStrategy:rt=3,filterType:nt=PNGFilterType.AUTO,colorType:it,inputHasAlpha:at=!0,...st}={})=>{const ot=new browserExports.PNG({width:tt.width,height:tt.height});return ot.data=tt.data,browserExports.PNG.sync.write(ot,{...st,deflateLevel:et,deflateStrategy:rt,filterType:nt,colorType:it!==void 0?it:at?PNGColorType.COLOR_ALPHA:PNGColorType.COLOR,inputHasAlpha:at})},decode:(tt,et)=>{const rt=browserExports.PNG.sync.read(tt,et);return{data:rt.data,width:rt.width,height:rt.height}}}}PNGFilterType2=PNGFilterType||(PNGFilterType={}),PNGFilterType2[PNGFilterType2.AUTO=-1]="AUTO",PNGFilterType2[PNGFilterType2.NONE=0]="NONE",PNGFilterType2[PNGFilterType2.SUB=1]="SUB",PNGFilterType2[PNGFilterType2.UP=2]="UP",PNGFilterType2[PNGFilterType2.AVERAGE=3]="AVERAGE",PNGFilterType2[PNGFilterType2.PATH=4]="PATH",PNGColorType2=PNGColorType||(PNGColorType={}),PNGColorType2[PNGColorType2.GRAYSCALE=0]="GRAYSCALE",PNGColorType2[PNGColorType2.COLOR=2]="COLOR",PNGColorType2[PNGColorType2.GRAYSCALE_ALPHA=4]="GRAYSCALE_ALPHA",PNGColorType2[PNGColorType2.COLOR_ALPHA=6]="COLOR_ALPHA";var UTIF={exports:{}},common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,(function(tt){var et=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function rt(at,st){return Object.prototype.hasOwnProperty.call(at,st)}tt.assign=function(at){for(var st=Array.prototype.slice.call(arguments,1);st.length;){var ot=st.shift();if(ot){if(typeof ot!="object")throw new TypeError(ot+"must be non-object");for(var lt in ot)rt(ot,lt)&&(at[lt]=ot[lt])}}return at},tt.shrinkBuf=function(at,st){return at.length===st?at:at.subarray?at.subarray(0,st):(at.length=st,at)};var nt={arraySet:function(at,st,ot,lt,ht){if(st.subarray&&at.subarray)at.set(st.subarray(ot,ot+lt),ht);else for(var dt=0;dt<lt;dt++)at[ht+dt]=st[ot+dt]},flattenChunks:function(at){var st,ot,lt,ht,dt,ut;for(lt=0,st=0,ot=at.length;st<ot;st++)lt+=at[st].length;for(ut=new Uint8Array(lt),ht=0,st=0,ot=at.length;st<ot;st++)dt=at[st],ut.set(dt,ht),ht+=dt.length;return ut}},it={arraySet:function(at,st,ot,lt,ht){for(var dt=0;dt<lt;dt++)at[ht+dt]=st[ot+dt]},flattenChunks:function(at){return[].concat.apply([],at)}};tt.setTyped=function(at){at?(tt.Buf8=Uint8Array,tt.Buf16=Uint16Array,tt.Buf32=Int32Array,tt.assign(tt,nt)):(tt.Buf8=Array,tt.Buf16=Array,tt.Buf32=Array,tt.assign(tt,it))},tt.setTyped(et)})(common)),common}var deflate$1={},deflate={},trees={},hasRequiredTrees,adler32_1,hasRequiredAdler32,crc32_1,hasRequiredCrc32,messages,hasRequiredMessages,hasRequiredDeflate$1;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var tt=requireCommon(),et=0,rt=1;function nt(rr){for(var ar=rr.length;--ar>=0;)rr[ar]=0}var it=0,at=29,st=256,ot=st+1+at,lt=30,ht=19,dt=2*ot+1,ut=15,ft=16,mt=7,gt=256,vt=16,xt=17,wt=18,At=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Pt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ot=new Array(2*(ot+2));nt(Ot);var Et=new Array(2*lt);nt(Et);var Lt=new Array(512);nt(Lt);var kt=new Array(256);nt(kt);var jt=new Array(at);nt(jt);var Mt,$t,Qt,Ht=new Array(lt);function qt(rr,ar,nr,ur,Er){this.static_tree=rr,this.extra_bits=ar,this.extra_base=nr,this.elems=ur,this.max_length=Er,this.has_stree=rr&&rr.length}function Bt(rr,ar){this.dyn_tree=rr,this.max_code=0,this.stat_desc=ar}function Xt(rr){return rr<256?Lt[rr]:Lt[256+(rr>>>7)]}function Ft(rr,ar){rr.pending_buf[rr.pending++]=255&ar,rr.pending_buf[rr.pending++]=ar>>>8&255}function Wt(rr,ar,nr){rr.bi_valid>ft-nr?(rr.bi_buf|=ar<<rr.bi_valid&65535,Ft(rr,rr.bi_buf),rr.bi_buf=ar>>ft-rr.bi_valid,rr.bi_valid+=nr-ft):(rr.bi_buf|=ar<<rr.bi_valid&65535,rr.bi_valid+=nr)}function Yt(rr,ar,nr){Wt(rr,nr[2*ar],nr[2*ar+1])}function zt(rr,ar){var nr=0;do nr|=1&rr,rr>>>=1,nr<<=1;while(--ar>0);return nr>>>1}function er(rr,ar,nr){var ur,Er,Ut=new Array(ut+1),Kt=0;for(ur=1;ur<=ut;ur++)Ut[ur]=Kt=Kt+nr[ur-1]<<1;for(Er=0;Er<=ar;Er++){var or=rr[2*Er+1];or!==0&&(rr[2*Er]=zt(Ut[or]++,or))}}function dr(rr){var ar;for(ar=0;ar<ot;ar++)rr.dyn_ltree[2*ar]=0;for(ar=0;ar<lt;ar++)rr.dyn_dtree[2*ar]=0;for(ar=0;ar<ht;ar++)rr.bl_tree[2*ar]=0;rr.dyn_ltree[2*gt]=1,rr.opt_len=rr.static_len=0,rr.last_lit=rr.matches=0}function fr(rr){rr.bi_valid>8?Ft(rr,rr.bi_buf):rr.bi_valid>0&&(rr.pending_buf[rr.pending++]=rr.bi_buf),rr.bi_buf=0,rr.bi_valid=0}function lr(rr,ar,nr,ur){var Er=2*ar,Ut=2*nr;return rr[Er]<rr[Ut]||rr[Er]===rr[Ut]&&ur[ar]<=ur[nr]}function mr(rr,ar,nr){for(var ur=rr.heap[nr],Er=nr<<1;Er<=rr.heap_len&&(Er<rr.heap_len&&lr(ar,rr.heap[Er+1],rr.heap[Er],rr.depth)&&Er++,!lr(ar,ur,rr.heap[Er],rr.depth));)rr.heap[nr]=rr.heap[Er],nr=Er,Er<<=1;rr.heap[nr]=ur}function br(rr,ar,nr){var ur,Er,Ut,Kt,or=0;if(rr.last_lit!==0)do ur=rr.pending_buf[rr.d_buf+2*or]<<8|rr.pending_buf[rr.d_buf+2*or+1],Er=rr.pending_buf[rr.l_buf+or],or++,ur===0?Yt(rr,Er,ar):(Yt(rr,(Ut=kt[Er])+st+1,ar),(Kt=At[Ut])!==0&&Wt(rr,Er-=jt[Ut],Kt),Yt(rr,Ut=Xt(--ur),nr),(Kt=Tt[Ut])!==0&&Wt(rr,ur-=Ht[Ut],Kt));while(or<rr.last_lit);Yt(rr,gt,ar)}function Sr(rr,ar){var nr,ur,Er,Ut=ar.dyn_tree,Kt=ar.stat_desc.static_tree,or=ar.stat_desc.has_stree,hr=ar.stat_desc.elems,kr=-1;for(rr.heap_len=0,rr.heap_max=dt,nr=0;nr<hr;nr++)Ut[2*nr]!==0?(rr.heap[++rr.heap_len]=kr=nr,rr.depth[nr]=0):Ut[2*nr+1]=0;for(;rr.heap_len<2;)Ut[2*(Er=rr.heap[++rr.heap_len]=kr<2?++kr:0)]=1,rr.depth[Er]=0,rr.opt_len--,or&&(rr.static_len-=Kt[2*Er+1]);for(ar.max_code=kr,nr=rr.heap_len>>1;nr>=1;nr--)mr(rr,Ut,nr);Er=hr;do nr=rr.heap[1],rr.heap[1]=rr.heap[rr.heap_len--],mr(rr,Ut,1),ur=rr.heap[1],rr.heap[--rr.heap_max]=nr,rr.heap[--rr.heap_max]=ur,Ut[2*Er]=Ut[2*nr]+Ut[2*ur],rr.depth[Er]=(rr.depth[nr]>=rr.depth[ur]?rr.depth[nr]:rr.depth[ur])+1,Ut[2*nr+1]=Ut[2*ur+1]=Er,rr.heap[1]=Er++,mr(rr,Ut,1);while(rr.heap_len>=2);rr.heap[--rr.heap_max]=rr.heap[1],(function(Br,Gn){var Xn,Mn,Kn,Vn,vi,mi,_i=Gn.dyn_tree,Ri=Gn.max_code,pi=Gn.stat_desc.static_tree,Tr=Gn.stat_desc.has_stree,qn=Gn.stat_desc.extra_bits,_r=Gn.stat_desc.extra_base,Rr=Gn.stat_desc.max_length,yr=0;for(Vn=0;Vn<=ut;Vn++)Br.bl_count[Vn]=0;for(_i[2*Br.heap[Br.heap_max]+1]=0,Xn=Br.heap_max+1;Xn<dt;Xn++)(Vn=_i[2*_i[2*(Mn=Br.heap[Xn])+1]+1]+1)>Rr&&(Vn=Rr,yr++),_i[2*Mn+1]=Vn,Mn>Ri||(Br.bl_count[Vn]++,vi=0,Mn>=_r&&(vi=qn[Mn-_r]),mi=_i[2*Mn],Br.opt_len+=mi*(Vn+vi),Tr&&(Br.static_len+=mi*(pi[2*Mn+1]+vi)));if(yr!==0){do{for(Vn=Rr-1;Br.bl_count[Vn]===0;)Vn--;Br.bl_count[Vn]--,Br.bl_count[Vn+1]+=2,Br.bl_count[Rr]--,yr-=2}while(yr>0);for(Vn=Rr;Vn!==0;Vn--)for(Mn=Br.bl_count[Vn];Mn!==0;)(Kn=Br.heap[--Xn])>Ri||(_i[2*Kn+1]!==Vn&&(Br.opt_len+=(Vn-_i[2*Kn+1])*_i[2*Kn],_i[2*Kn+1]=Vn),Mn--)}})(rr,ar),er(Ut,kr,rr.bl_count)}function Ir(rr,ar,nr){var ur,Er,Ut=-1,Kt=ar[1],or=0,hr=7,kr=4;for(Kt===0&&(hr=138,kr=3),ar[2*(nr+1)+1]=65535,ur=0;ur<=nr;ur++)Er=Kt,Kt=ar[2*(ur+1)+1],++or<hr&&Er===Kt||(or<kr?rr.bl_tree[2*Er]+=or:Er!==0?(Er!==Ut&&rr.bl_tree[2*Er]++,rr.bl_tree[2*vt]++):or<=10?rr.bl_tree[2*xt]++:rr.bl_tree[2*wt]++,or=0,Ut=Er,Kt===0?(hr=138,kr=3):Er===Kt?(hr=6,kr=3):(hr=7,kr=4))}function cr(rr,ar,nr){var ur,Er,Ut=-1,Kt=ar[1],or=0,hr=7,kr=4;for(Kt===0&&(hr=138,kr=3),ur=0;ur<=nr;ur++)if(Er=Kt,Kt=ar[2*(ur+1)+1],!(++or<hr&&Er===Kt)){if(or<kr)do Yt(rr,Er,rr.bl_tree);while(--or!=0);else Er!==0?(Er!==Ut&&(Yt(rr,Er,rr.bl_tree),or--),Yt(rr,vt,rr.bl_tree),Wt(rr,or-3,2)):or<=10?(Yt(rr,xt,rr.bl_tree),Wt(rr,or-3,3)):(Yt(rr,wt,rr.bl_tree),Wt(rr,or-11,7));or=0,Ut=Er,Kt===0?(hr=138,kr=3):Er===Kt?(hr=6,kr=3):(hr=7,kr=4)}}nt(Ht);var Nt=!1;function pr(rr,ar,nr,ur){Wt(rr,(it<<1)+(ur?1:0),3),(function(Er,Ut,Kt,or){fr(Er),Ft(Er,Kt),Ft(Er,~Kt),tt.arraySet(Er.pending_buf,Er.window,Ut,Kt,Er.pending),Er.pending+=Kt})(rr,ar,nr)}return trees._tr_init=function(rr){Nt||((function(){var ar,nr,ur,Er,Ut,Kt=new Array(ut+1);for(ur=0,Er=0;Er<at-1;Er++)for(jt[Er]=ur,ar=0;ar<1<<At[Er];ar++)kt[ur++]=Er;for(kt[ur-1]=Er,Ut=0,Er=0;Er<16;Er++)for(Ht[Er]=Ut,ar=0;ar<1<<Tt[Er];ar++)Lt[Ut++]=Er;for(Ut>>=7;Er<lt;Er++)for(Ht[Er]=Ut<<7,ar=0;ar<1<<Tt[Er]-7;ar++)Lt[256+Ut++]=Er;for(nr=0;nr<=ut;nr++)Kt[nr]=0;for(ar=0;ar<=143;)Ot[2*ar+1]=8,ar++,Kt[8]++;for(;ar<=255;)Ot[2*ar+1]=9,ar++,Kt[9]++;for(;ar<=279;)Ot[2*ar+1]=7,ar++,Kt[7]++;for(;ar<=287;)Ot[2*ar+1]=8,ar++,Kt[8]++;for(er(Ot,ot+1,Kt),ar=0;ar<lt;ar++)Et[2*ar+1]=5,Et[2*ar]=zt(ar,5);Mt=new qt(Ot,At,st+1,ot,ut),$t=new qt(Et,Tt,0,lt,ut),Qt=new qt(new Array(0),Pt,0,ht,mt)})(),Nt=!0),rr.l_desc=new Bt(rr.dyn_ltree,Mt),rr.d_desc=new Bt(rr.dyn_dtree,$t),rr.bl_desc=new Bt(rr.bl_tree,Qt),rr.bi_buf=0,rr.bi_valid=0,dr(rr)},trees._tr_stored_block=pr,trees._tr_flush_block=function(rr,ar,nr,ur){var Er,Ut,Kt=0;rr.level>0?(rr.strm.data_type===2&&(rr.strm.data_type=(function(or){var hr,kr=4093624447;for(hr=0;hr<=31;hr++,kr>>>=1)if(1&kr&&or.dyn_ltree[2*hr]!==0)return et;if(or.dyn_ltree[18]!==0||or.dyn_ltree[20]!==0||or.dyn_ltree[26]!==0)return rt;for(hr=32;hr<st;hr++)if(or.dyn_ltree[2*hr]!==0)return rt;return et})(rr)),Sr(rr,rr.l_desc),Sr(rr,rr.d_desc),Kt=(function(or){var hr;for(Ir(or,or.dyn_ltree,or.l_desc.max_code),Ir(or,or.dyn_dtree,or.d_desc.max_code),Sr(or,or.bl_desc),hr=ht-1;hr>=3&&or.bl_tree[2*Rt[hr]+1]===0;hr--);return or.opt_len+=3*(hr+1)+5+5+4,hr})(rr),Er=rr.opt_len+3+7>>>3,(Ut=rr.static_len+3+7>>>3)<=Er&&(Er=Ut)):Er=Ut=nr+5,nr+4<=Er&&ar!==-1?pr(rr,ar,nr,ur):rr.strategy===4||Ut===Er?(Wt(rr,2+(ur?1:0),3),br(rr,Ot,Et)):(Wt(rr,4+(ur?1:0),3),(function(or,hr,kr,Br){var Gn;for(Wt(or,hr-257,5),Wt(or,kr-1,5),Wt(or,Br-4,4),Gn=0;Gn<Br;Gn++)Wt(or,or.bl_tree[2*Rt[Gn]+1],3);cr(or,or.dyn_ltree,hr-1),cr(or,or.dyn_dtree,kr-1)})(rr,rr.l_desc.max_code+1,rr.d_desc.max_code+1,Kt+1),br(rr,rr.dyn_ltree,rr.dyn_dtree)),dr(rr),ur&&fr(rr)},trees._tr_tally=function(rr,ar,nr){return rr.pending_buf[rr.d_buf+2*rr.last_lit]=ar>>>8&255,rr.pending_buf[rr.d_buf+2*rr.last_lit+1]=255&ar,rr.pending_buf[rr.l_buf+rr.last_lit]=255&nr,rr.last_lit++,ar===0?rr.dyn_ltree[2*nr]++:(rr.matches++,ar--,rr.dyn_ltree[2*(kt[nr]+st+1)]++,rr.dyn_dtree[2*Xt(ar)]++),rr.last_lit===rr.lit_bufsize-1},trees._tr_align=function(rr){Wt(rr,2,3),Yt(rr,gt,Ot),(function(ar){ar.bi_valid===16?(Ft(ar,ar.bi_buf),ar.bi_buf=0,ar.bi_valid=0):ar.bi_valid>=8&&(ar.pending_buf[ar.pending++]=255&ar.bi_buf,ar.bi_buf>>=8,ar.bi_valid-=8)})(rr)},trees}function requireAdler32(){return hasRequiredAdler32||(hasRequiredAdler32=1,adler32_1=function(tt,et,rt,nt){for(var it=65535&tt,at=tt>>>16&65535,st=0;rt!==0;){rt-=st=rt>2e3?2e3:rt;do at=at+(it=it+et[nt++]|0)|0;while(--st);it%=65521,at%=65521}return it|at<<16}),adler32_1}function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;var tt=(function(){for(var et,rt=[],nt=0;nt<256;nt++){et=nt;for(var it=0;it<8;it++)et=1&et?3988292384^et>>>1:et>>>1;rt[nt]=et}return rt})();return crc32_1=function(et,rt,nt,it){var at=tt,st=it+nt;et^=-1;for(var ot=it;ot<st;ot++)et=et>>>8^at[255&(et^rt[ot])];return~et},crc32_1}function requireMessages(){return hasRequiredMessages?messages:(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;var tt,et=requireCommon(),rt=requireTrees(),nt=requireAdler32(),it=requireCrc32(),at=requireMessages(),st=0,ot=4,lt=0,ht=-2,dt=-1,ut=4,ft=2,mt=8,gt=9,vt=286,xt=30,wt=19,At=2*vt+1,Tt=15,Pt=3,Rt=258,Ot=Rt+Pt+1,Et=42,Lt=103,kt=113,jt=666,Mt=1,$t=2,Qt=3,Ht=4;function qt(Nt,pr){return Nt.msg=at[pr],pr}function Bt(Nt){return(Nt<<1)-(Nt>4?9:0)}function Xt(Nt){for(var pr=Nt.length;--pr>=0;)Nt[pr]=0}function Ft(Nt){var pr=Nt.state,rr=pr.pending;rr>Nt.avail_out&&(rr=Nt.avail_out),rr!==0&&(et.arraySet(Nt.output,pr.pending_buf,pr.pending_out,rr,Nt.next_out),Nt.next_out+=rr,pr.pending_out+=rr,Nt.total_out+=rr,Nt.avail_out-=rr,pr.pending-=rr,pr.pending===0&&(pr.pending_out=0))}function Wt(Nt,pr){rt._tr_flush_block(Nt,Nt.block_start>=0?Nt.block_start:-1,Nt.strstart-Nt.block_start,pr),Nt.block_start=Nt.strstart,Ft(Nt.strm)}function Yt(Nt,pr){Nt.pending_buf[Nt.pending++]=pr}function zt(Nt,pr){Nt.pending_buf[Nt.pending++]=pr>>>8&255,Nt.pending_buf[Nt.pending++]=255&pr}function er(Nt,pr){var rr,ar,nr=Nt.max_chain_length,ur=Nt.strstart,Er=Nt.prev_length,Ut=Nt.nice_match,Kt=Nt.strstart>Nt.w_size-Ot?Nt.strstart-(Nt.w_size-Ot):0,or=Nt.window,hr=Nt.w_mask,kr=Nt.prev,Br=Nt.strstart+Rt,Gn=or[ur+Er-1],Xn=or[ur+Er];Nt.prev_length>=Nt.good_match&&(nr>>=2),Ut>Nt.lookahead&&(Ut=Nt.lookahead);do if(or[(rr=pr)+Er]===Xn&&or[rr+Er-1]===Gn&&or[rr]===or[ur]&&or[++rr]===or[ur+1]){ur+=2,rr++;do;while(or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&or[++ur]===or[++rr]&&ur<Br);if(ar=Rt-(Br-ur),ur=Br-Rt,ar>Er){if(Nt.match_start=pr,Er=ar,ar>=Ut)break;Gn=or[ur+Er-1],Xn=or[ur+Er]}}while((pr=kr[pr&hr])>Kt&&--nr!=0);return Er<=Nt.lookahead?Er:Nt.lookahead}function dr(Nt){var pr,rr,ar,nr,ur,Er,Ut,Kt,or,hr,kr=Nt.w_size;do{if(nr=Nt.window_size-Nt.lookahead-Nt.strstart,Nt.strstart>=kr+(kr-Ot)){et.arraySet(Nt.window,Nt.window,kr,kr,0),Nt.match_start-=kr,Nt.strstart-=kr,Nt.block_start-=kr,pr=rr=Nt.hash_size;do ar=Nt.head[--pr],Nt.head[pr]=ar>=kr?ar-kr:0;while(--rr);pr=rr=kr;do ar=Nt.prev[--pr],Nt.prev[pr]=ar>=kr?ar-kr:0;while(--rr);nr+=kr}if(Nt.strm.avail_in===0)break;if(Er=Nt.strm,Ut=Nt.window,Kt=Nt.strstart+Nt.lookahead,or=nr,hr=void 0,(hr=Er.avail_in)>or&&(hr=or),rr=hr===0?0:(Er.avail_in-=hr,et.arraySet(Ut,Er.input,Er.next_in,hr,Kt),Er.state.wrap===1?Er.adler=nt(Er.adler,Ut,hr,Kt):Er.state.wrap===2&&(Er.adler=it(Er.adler,Ut,hr,Kt)),Er.next_in+=hr,Er.total_in+=hr,hr),Nt.lookahead+=rr,Nt.lookahead+Nt.insert>=Pt)for(ur=Nt.strstart-Nt.insert,Nt.ins_h=Nt.window[ur],Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[ur+1])&Nt.hash_mask;Nt.insert&&(Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[ur+Pt-1])&Nt.hash_mask,Nt.prev[ur&Nt.w_mask]=Nt.head[Nt.ins_h],Nt.head[Nt.ins_h]=ur,ur++,Nt.insert--,!(Nt.lookahead+Nt.insert<Pt)););}while(Nt.lookahead<Ot&&Nt.strm.avail_in!==0)}function fr(Nt,pr){for(var rr,ar;;){if(Nt.lookahead<Ot){if(dr(Nt),Nt.lookahead<Ot&&pr===st)return Mt;if(Nt.lookahead===0)break}if(rr=0,Nt.lookahead>=Pt&&(Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[Nt.strstart+Pt-1])&Nt.hash_mask,rr=Nt.prev[Nt.strstart&Nt.w_mask]=Nt.head[Nt.ins_h],Nt.head[Nt.ins_h]=Nt.strstart),rr!==0&&Nt.strstart-rr<=Nt.w_size-Ot&&(Nt.match_length=er(Nt,rr)),Nt.match_length>=Pt)if(ar=rt._tr_tally(Nt,Nt.strstart-Nt.match_start,Nt.match_length-Pt),Nt.lookahead-=Nt.match_length,Nt.match_length<=Nt.max_lazy_match&&Nt.lookahead>=Pt){Nt.match_length--;do Nt.strstart++,Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[Nt.strstart+Pt-1])&Nt.hash_mask,rr=Nt.prev[Nt.strstart&Nt.w_mask]=Nt.head[Nt.ins_h],Nt.head[Nt.ins_h]=Nt.strstart;while(--Nt.match_length!=0);Nt.strstart++}else Nt.strstart+=Nt.match_length,Nt.match_length=0,Nt.ins_h=Nt.window[Nt.strstart],Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[Nt.strstart+1])&Nt.hash_mask;else ar=rt._tr_tally(Nt,0,Nt.window[Nt.strstart]),Nt.lookahead--,Nt.strstart++;if(ar&&(Wt(Nt,!1),Nt.strm.avail_out===0))return Mt}return Nt.insert=Nt.strstart<Pt-1?Nt.strstart:Pt-1,pr===ot?(Wt(Nt,!0),Nt.strm.avail_out===0?Qt:Ht):Nt.last_lit&&(Wt(Nt,!1),Nt.strm.avail_out===0)?Mt:$t}function lr(Nt,pr){for(var rr,ar,nr;;){if(Nt.lookahead<Ot){if(dr(Nt),Nt.lookahead<Ot&&pr===st)return Mt;if(Nt.lookahead===0)break}if(rr=0,Nt.lookahead>=Pt&&(Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[Nt.strstart+Pt-1])&Nt.hash_mask,rr=Nt.prev[Nt.strstart&Nt.w_mask]=Nt.head[Nt.ins_h],Nt.head[Nt.ins_h]=Nt.strstart),Nt.prev_length=Nt.match_length,Nt.prev_match=Nt.match_start,Nt.match_length=Pt-1,rr!==0&&Nt.prev_length<Nt.max_lazy_match&&Nt.strstart-rr<=Nt.w_size-Ot&&(Nt.match_length=er(Nt,rr),Nt.match_length<=5&&(Nt.strategy===1||Nt.match_length===Pt&&Nt.strstart-Nt.match_start>4096)&&(Nt.match_length=Pt-1)),Nt.prev_length>=Pt&&Nt.match_length<=Nt.prev_length){nr=Nt.strstart+Nt.lookahead-Pt,ar=rt._tr_tally(Nt,Nt.strstart-1-Nt.prev_match,Nt.prev_length-Pt),Nt.lookahead-=Nt.prev_length-1,Nt.prev_length-=2;do++Nt.strstart<=nr&&(Nt.ins_h=(Nt.ins_h<<Nt.hash_shift^Nt.window[Nt.strstart+Pt-1])&Nt.hash_mask,rr=Nt.prev[Nt.strstart&Nt.w_mask]=Nt.head[Nt.ins_h],Nt.head[Nt.ins_h]=Nt.strstart);while(--Nt.prev_length!=0);if(Nt.match_available=0,Nt.match_length=Pt-1,Nt.strstart++,ar&&(Wt(Nt,!1),Nt.strm.avail_out===0))return Mt}else if(Nt.match_available){if((ar=rt._tr_tally(Nt,0,Nt.window[Nt.strstart-1]))&&Wt(Nt,!1),Nt.strstart++,Nt.lookahead--,Nt.strm.avail_out===0)return Mt}else Nt.match_available=1,Nt.strstart++,Nt.lookahead--}return Nt.match_available&&(ar=rt._tr_tally(Nt,0,Nt.window[Nt.strstart-1]),Nt.match_available=0),Nt.insert=Nt.strstart<Pt-1?Nt.strstart:Pt-1,pr===ot?(Wt(Nt,!0),Nt.strm.avail_out===0?Qt:Ht):Nt.last_lit&&(Wt(Nt,!1),Nt.strm.avail_out===0)?Mt:$t}function mr(Nt,pr,rr,ar,nr){this.good_length=Nt,this.max_lazy=pr,this.nice_length=rr,this.max_chain=ar,this.func=nr}function br(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=mt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new et.Buf16(2*At),this.dyn_dtree=new et.Buf16(2*(2*xt+1)),this.bl_tree=new et.Buf16(2*(2*wt+1)),Xt(this.dyn_ltree),Xt(this.dyn_dtree),Xt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new et.Buf16(Tt+1),this.heap=new et.Buf16(2*vt+1),Xt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new et.Buf16(2*vt+1),Xt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Sr(Nt){var pr;return Nt&&Nt.state?(Nt.total_in=Nt.total_out=0,Nt.data_type=ft,(pr=Nt.state).pending=0,pr.pending_out=0,pr.wrap<0&&(pr.wrap=-pr.wrap),pr.status=pr.wrap?Et:kt,Nt.adler=pr.wrap===2?0:1,pr.last_flush=st,rt._tr_init(pr),lt):qt(Nt,ht)}function Ir(Nt){var pr=Sr(Nt);return pr===lt&&(function(rr){rr.window_size=2*rr.w_size,Xt(rr.head),rr.max_lazy_match=tt[rr.level].max_lazy,rr.good_match=tt[rr.level].good_length,rr.nice_match=tt[rr.level].nice_length,rr.max_chain_length=tt[rr.level].max_chain,rr.strstart=0,rr.block_start=0,rr.lookahead=0,rr.insert=0,rr.match_length=rr.prev_length=Pt-1,rr.match_available=0,rr.ins_h=0})(Nt.state),pr}function cr(Nt,pr,rr,ar,nr,ur){if(!Nt)return ht;var Er=1;if(pr===dt&&(pr=6),ar<0?(Er=0,ar=-ar):ar>15&&(Er=2,ar-=16),nr<1||nr>gt||rr!==mt||ar<8||ar>15||pr<0||pr>9||ur<0||ur>ut)return qt(Nt,ht);ar===8&&(ar=9);var Ut=new br;return Nt.state=Ut,Ut.strm=Nt,Ut.wrap=Er,Ut.gzhead=null,Ut.w_bits=ar,Ut.w_size=1<<Ut.w_bits,Ut.w_mask=Ut.w_size-1,Ut.hash_bits=nr+7,Ut.hash_size=1<<Ut.hash_bits,Ut.hash_mask=Ut.hash_size-1,Ut.hash_shift=~~((Ut.hash_bits+Pt-1)/Pt),Ut.window=new et.Buf8(2*Ut.w_size),Ut.head=new et.Buf16(Ut.hash_size),Ut.prev=new et.Buf16(Ut.w_size),Ut.lit_bufsize=1<<nr+6,Ut.pending_buf_size=4*Ut.lit_bufsize,Ut.pending_buf=new et.Buf8(Ut.pending_buf_size),Ut.d_buf=1*Ut.lit_bufsize,Ut.l_buf=3*Ut.lit_bufsize,Ut.level=pr,Ut.strategy=ur,Ut.method=rr,Ir(Nt)}return tt=[new mr(0,0,0,0,(function(Nt,pr){var rr=65535;for(rr>Nt.pending_buf_size-5&&(rr=Nt.pending_buf_size-5);;){if(Nt.lookahead<=1){if(dr(Nt),Nt.lookahead===0&&pr===st)return Mt;if(Nt.lookahead===0)break}Nt.strstart+=Nt.lookahead,Nt.lookahead=0;var ar=Nt.block_start+rr;if((Nt.strstart===0||Nt.strstart>=ar)&&(Nt.lookahead=Nt.strstart-ar,Nt.strstart=ar,Wt(Nt,!1),Nt.strm.avail_out===0)||Nt.strstart-Nt.block_start>=Nt.w_size-Ot&&(Wt(Nt,!1),Nt.strm.avail_out===0))return Mt}return Nt.insert=0,pr===ot?(Wt(Nt,!0),Nt.strm.avail_out===0?Qt:Ht):(Nt.strstart>Nt.block_start&&(Wt(Nt,!1),Nt.strm.avail_out),Mt)})),new mr(4,4,8,4,fr),new mr(4,5,16,8,fr),new mr(4,6,32,32,fr),new mr(4,4,16,16,lr),new mr(8,16,32,32,lr),new mr(8,16,128,128,lr),new mr(8,32,128,256,lr),new mr(32,128,258,1024,lr),new mr(32,258,258,4096,lr)],deflate.deflateInit=function(Nt,pr){return cr(Nt,pr,mt,15,8,0)},deflate.deflateInit2=cr,deflate.deflateReset=Ir,deflate.deflateResetKeep=Sr,deflate.deflateSetHeader=function(Nt,pr){return Nt&&Nt.state?Nt.state.wrap!==2?ht:(Nt.state.gzhead=pr,lt):ht},deflate.deflate=function(Nt,pr){var rr,ar,nr,ur;if(!Nt||!Nt.state||pr>5||pr<0)return Nt?qt(Nt,ht):ht;if(ar=Nt.state,!Nt.output||!Nt.input&&Nt.avail_in!==0||ar.status===jt&&pr!==ot)return qt(Nt,Nt.avail_out===0?-5:ht);if(ar.strm=Nt,rr=ar.last_flush,ar.last_flush=pr,ar.status===Et)if(ar.wrap===2)Nt.adler=0,Yt(ar,31),Yt(ar,139),Yt(ar,8),ar.gzhead?(Yt(ar,(ar.gzhead.text?1:0)+(ar.gzhead.hcrc?2:0)+(ar.gzhead.extra?4:0)+(ar.gzhead.name?8:0)+(ar.gzhead.comment?16:0)),Yt(ar,255&ar.gzhead.time),Yt(ar,ar.gzhead.time>>8&255),Yt(ar,ar.gzhead.time>>16&255),Yt(ar,ar.gzhead.time>>24&255),Yt(ar,ar.level===9?2:ar.strategy>=2||ar.level<2?4:0),Yt(ar,255&ar.gzhead.os),ar.gzhead.extra&&ar.gzhead.extra.length&&(Yt(ar,255&ar.gzhead.extra.length),Yt(ar,ar.gzhead.extra.length>>8&255)),ar.gzhead.hcrc&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending,0)),ar.gzindex=0,ar.status=69):(Yt(ar,0),Yt(ar,0),Yt(ar,0),Yt(ar,0),Yt(ar,0),Yt(ar,ar.level===9?2:ar.strategy>=2||ar.level<2?4:0),Yt(ar,3),ar.status=kt);else{var Er=mt+(ar.w_bits-8<<4)<<8;Er|=(ar.strategy>=2||ar.level<2?0:ar.level<6?1:ar.level===6?2:3)<<6,ar.strstart!==0&&(Er|=32),Er+=31-Er%31,ar.status=kt,zt(ar,Er),ar.strstart!==0&&(zt(ar,Nt.adler>>>16),zt(ar,65535&Nt.adler)),Nt.adler=1}if(ar.status===69)if(ar.gzhead.extra){for(nr=ar.pending;ar.gzindex<(65535&ar.gzhead.extra.length)&&(ar.pending!==ar.pending_buf_size||(ar.gzhead.hcrc&&ar.pending>nr&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending-nr,nr)),Ft(Nt),nr=ar.pending,ar.pending!==ar.pending_buf_size));)Yt(ar,255&ar.gzhead.extra[ar.gzindex]),ar.gzindex++;ar.gzhead.hcrc&&ar.pending>nr&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending-nr,nr)),ar.gzindex===ar.gzhead.extra.length&&(ar.gzindex=0,ar.status=73)}else ar.status=73;if(ar.status===73)if(ar.gzhead.name){nr=ar.pending;do{if(ar.pending===ar.pending_buf_size&&(ar.gzhead.hcrc&&ar.pending>nr&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending-nr,nr)),Ft(Nt),nr=ar.pending,ar.pending===ar.pending_buf_size)){ur=1;break}ur=ar.gzindex<ar.gzhead.name.length?255&ar.gzhead.name.charCodeAt(ar.gzindex++):0,Yt(ar,ur)}while(ur!==0);ar.gzhead.hcrc&&ar.pending>nr&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending-nr,nr)),ur===0&&(ar.gzindex=0,ar.status=91)}else ar.status=91;if(ar.status===91)if(ar.gzhead.comment){nr=ar.pending;do{if(ar.pending===ar.pending_buf_size&&(ar.gzhead.hcrc&&ar.pending>nr&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending-nr,nr)),Ft(Nt),nr=ar.pending,ar.pending===ar.pending_buf_size)){ur=1;break}ur=ar.gzindex<ar.gzhead.comment.length?255&ar.gzhead.comment.charCodeAt(ar.gzindex++):0,Yt(ar,ur)}while(ur!==0);ar.gzhead.hcrc&&ar.pending>nr&&(Nt.adler=it(Nt.adler,ar.pending_buf,ar.pending-nr,nr)),ur===0&&(ar.status=Lt)}else ar.status=Lt;if(ar.status===Lt&&(ar.gzhead.hcrc?(ar.pending+2>ar.pending_buf_size&&Ft(Nt),ar.pending+2<=ar.pending_buf_size&&(Yt(ar,255&Nt.adler),Yt(ar,Nt.adler>>8&255),Nt.adler=0,ar.status=kt)):ar.status=kt),ar.pending!==0){if(Ft(Nt),Nt.avail_out===0)return ar.last_flush=-1,lt}else if(Nt.avail_in===0&&Bt(pr)<=Bt(rr)&&pr!==ot)return qt(Nt,-5);if(ar.status===jt&&Nt.avail_in!==0)return qt(Nt,-5);if(Nt.avail_in!==0||ar.lookahead!==0||pr!==st&&ar.status!==jt){var Ut=ar.strategy===2?(function(Kt,or){for(var hr;;){if(Kt.lookahead===0&&(dr(Kt),Kt.lookahead===0)){if(or===st)return Mt;break}if(Kt.match_length=0,hr=rt._tr_tally(Kt,0,Kt.window[Kt.strstart]),Kt.lookahead--,Kt.strstart++,hr&&(Wt(Kt,!1),Kt.strm.avail_out===0))return Mt}return Kt.insert=0,or===ot?(Wt(Kt,!0),Kt.strm.avail_out===0?Qt:Ht):Kt.last_lit&&(Wt(Kt,!1),Kt.strm.avail_out===0)?Mt:$t})(ar,pr):ar.strategy===3?(function(Kt,or){for(var hr,kr,Br,Gn,Xn=Kt.window;;){if(Kt.lookahead<=Rt){if(dr(Kt),Kt.lookahead<=Rt&&or===st)return Mt;if(Kt.lookahead===0)break}if(Kt.match_length=0,Kt.lookahead>=Pt&&Kt.strstart>0&&(kr=Xn[Br=Kt.strstart-1])===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]){Gn=Kt.strstart+Rt;do;while(kr===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]&&kr===Xn[++Br]&&Br<Gn);Kt.match_length=Rt-(Gn-Br),Kt.match_length>Kt.lookahead&&(Kt.match_length=Kt.lookahead)}if(Kt.match_length>=Pt?(hr=rt._tr_tally(Kt,1,Kt.match_length-Pt),Kt.lookahead-=Kt.match_length,Kt.strstart+=Kt.match_length,Kt.match_length=0):(hr=rt._tr_tally(Kt,0,Kt.window[Kt.strstart]),Kt.lookahead--,Kt.strstart++),hr&&(Wt(Kt,!1),Kt.strm.avail_out===0))return Mt}return Kt.insert=0,or===ot?(Wt(Kt,!0),Kt.strm.avail_out===0?Qt:Ht):Kt.last_lit&&(Wt(Kt,!1),Kt.strm.avail_out===0)?Mt:$t})(ar,pr):tt[ar.level].func(ar,pr);if(Ut!==Qt&&Ut!==Ht||(ar.status=jt),Ut===Mt||Ut===Qt)return Nt.avail_out===0&&(ar.last_flush=-1),lt;if(Ut===$t&&(pr===1?rt._tr_align(ar):pr!==5&&(rt._tr_stored_block(ar,0,0,!1),pr===3&&(Xt(ar.head),ar.lookahead===0&&(ar.strstart=0,ar.block_start=0,ar.insert=0))),Ft(Nt),Nt.avail_out===0))return ar.last_flush=-1,lt}return pr!==ot?lt:ar.wrap<=0?1:(ar.wrap===2?(Yt(ar,255&Nt.adler),Yt(ar,Nt.adler>>8&255),Yt(ar,Nt.adler>>16&255),Yt(ar,Nt.adler>>24&255),Yt(ar,255&Nt.total_in),Yt(ar,Nt.total_in>>8&255),Yt(ar,Nt.total_in>>16&255),Yt(ar,Nt.total_in>>24&255)):(zt(ar,Nt.adler>>>16),zt(ar,65535&Nt.adler)),Ft(Nt),ar.wrap>0&&(ar.wrap=-ar.wrap),ar.pending!==0?lt:1)},deflate.deflateEnd=function(Nt){var pr;return Nt&&Nt.state?(pr=Nt.state.status)!==Et&&pr!==69&&pr!==73&&pr!==91&&pr!==Lt&&pr!==kt&&pr!==jt?qt(Nt,ht):(Nt.state=null,pr===kt?qt(Nt,-3):lt):ht},deflate.deflateSetDictionary=function(Nt,pr){var rr,ar,nr,ur,Er,Ut,Kt,or,hr=pr.length;if(!Nt||!Nt.state||(ur=(rr=Nt.state).wrap)===2||ur===1&&rr.status!==Et||rr.lookahead)return ht;for(ur===1&&(Nt.adler=nt(Nt.adler,pr,hr,0)),rr.wrap=0,hr>=rr.w_size&&(ur===0&&(Xt(rr.head),rr.strstart=0,rr.block_start=0,rr.insert=0),or=new et.Buf8(rr.w_size),et.arraySet(or,pr,hr-rr.w_size,rr.w_size,0),pr=or,hr=rr.w_size),Er=Nt.avail_in,Ut=Nt.next_in,Kt=Nt.input,Nt.avail_in=hr,Nt.next_in=0,Nt.input=pr,dr(rr);rr.lookahead>=Pt;){ar=rr.strstart,nr=rr.lookahead-(Pt-1);do rr.ins_h=(rr.ins_h<<rr.hash_shift^rr.window[ar+Pt-1])&rr.hash_mask,rr.prev[ar&rr.w_mask]=rr.head[rr.ins_h],rr.head[rr.ins_h]=ar,ar++;while(--nr);rr.strstart=ar,rr.lookahead=Pt-1,dr(rr)}return rr.strstart+=rr.lookahead,rr.block_start=rr.strstart,rr.insert=rr.lookahead,rr.lookahead=0,rr.match_length=rr.prev_length=Pt-1,rr.match_available=0,Nt.next_in=Ut,Nt.input=Kt,Nt.avail_in=Er,rr.wrap=ur,lt},deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var strings={},hasRequiredStrings,zstream,hasRequiredZstream,hasRequiredDeflate;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;var tt=requireCommon(),et=!0,rt=!0;try{String.fromCharCode.apply(null,[0])}catch{et=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rt=!1}for(var nt=new tt.Buf8(256),it=0;it<256;it++)nt[it]=it>=252?6:it>=248?5:it>=240?4:it>=224?3:it>=192?2:1;function at(st,ot){if(ot<65534&&(st.subarray&&rt||!st.subarray&&et))return String.fromCharCode.apply(null,tt.shrinkBuf(st,ot));for(var lt="",ht=0;ht<ot;ht++)lt+=String.fromCharCode(st[ht]);return lt}return nt[254]=nt[254]=1,strings.string2buf=function(st){var ot,lt,ht,dt,ut,ft=st.length,mt=0;for(dt=0;dt<ft;dt++)(64512&(lt=st.charCodeAt(dt)))==55296&&dt+1<ft&&(64512&(ht=st.charCodeAt(dt+1)))==56320&&(lt=65536+(lt-55296<<10)+(ht-56320),dt++),mt+=lt<128?1:lt<2048?2:lt<65536?3:4;for(ot=new tt.Buf8(mt),ut=0,dt=0;ut<mt;dt++)(64512&(lt=st.charCodeAt(dt)))==55296&&dt+1<ft&&(64512&(ht=st.charCodeAt(dt+1)))==56320&&(lt=65536+(lt-55296<<10)+(ht-56320),dt++),lt<128?ot[ut++]=lt:lt<2048?(ot[ut++]=192|lt>>>6,ot[ut++]=128|63&lt):lt<65536?(ot[ut++]=224|lt>>>12,ot[ut++]=128|lt>>>6&63,ot[ut++]=128|63&lt):(ot[ut++]=240|lt>>>18,ot[ut++]=128|lt>>>12&63,ot[ut++]=128|lt>>>6&63,ot[ut++]=128|63&lt);return ot},strings.buf2binstring=function(st){return at(st,st.length)},strings.binstring2buf=function(st){for(var ot=new tt.Buf8(st.length),lt=0,ht=ot.length;lt<ht;lt++)ot[lt]=st.charCodeAt(lt);return ot},strings.buf2string=function(st,ot){var lt,ht,dt,ut,ft=ot||st.length,mt=new Array(2*ft);for(ht=0,lt=0;lt<ft;)if((dt=st[lt++])<128)mt[ht++]=dt;else if((ut=nt[dt])>4)mt[ht++]=65533,lt+=ut-1;else{for(dt&=ut===2?31:ut===3?15:7;ut>1&&lt<ft;)dt=dt<<6|63&st[lt++],ut--;ut>1?mt[ht++]=65533:dt<65536?mt[ht++]=dt:(dt-=65536,mt[ht++]=55296|dt>>10&1023,mt[ht++]=56320|1023&dt)}return at(mt,ht)},strings.utf8border=function(st,ot){var lt;for((ot=ot||st.length)>st.length&&(ot=st.length),lt=ot-1;lt>=0&&(192&st[lt])==128;)lt--;return lt<0||lt===0?ot:lt+nt[st[lt]]>ot?lt:ot},strings}function requireZstream(){return hasRequiredZstream?zstream:(hasRequiredZstream=1,zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0})}function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;var tt=requireDeflate$1(),et=requireCommon(),rt=requireStrings(),nt=requireMessages(),it=requireZstream(),at=Object.prototype.toString,st=0,ot=-1,lt=0,ht=8;function dt(ft){if(!(this instanceof dt))return new dt(ft);this.options=et.assign({level:ot,method:ht,chunkSize:16384,windowBits:15,memLevel:8,strategy:lt,to:""},ft||{});var mt=this.options;mt.raw&&mt.windowBits>0?mt.windowBits=-mt.windowBits:mt.gzip&&mt.windowBits>0&&mt.windowBits<16&&(mt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new it,this.strm.avail_out=0;var gt=tt.deflateInit2(this.strm,mt.level,mt.method,mt.windowBits,mt.memLevel,mt.strategy);if(gt!==st)throw new Error(nt[gt]);if(mt.header&&tt.deflateSetHeader(this.strm,mt.header),mt.dictionary){var vt;if(vt=typeof mt.dictionary=="string"?rt.string2buf(mt.dictionary):at.call(mt.dictionary)==="[object ArrayBuffer]"?new Uint8Array(mt.dictionary):mt.dictionary,(gt=tt.deflateSetDictionary(this.strm,vt))!==st)throw new Error(nt[gt]);this._dict_set=!0}}function ut(ft,mt){var gt=new dt(mt);if(gt.push(ft,!0),gt.err)throw gt.msg||nt[gt.err];return gt.result}return dt.prototype.push=function(ft,mt){var gt,vt,xt=this.strm,wt=this.options.chunkSize;if(this.ended)return!1;vt=mt===~~mt?mt:mt===!0?4:0,typeof ft=="string"?xt.input=rt.string2buf(ft):at.call(ft)==="[object ArrayBuffer]"?xt.input=new Uint8Array(ft):xt.input=ft,xt.next_in=0,xt.avail_in=xt.input.length;do{if(xt.avail_out===0&&(xt.output=new et.Buf8(wt),xt.next_out=0,xt.avail_out=wt),(gt=tt.deflate(xt,vt))!==1&&gt!==st)return this.onEnd(gt),this.ended=!0,!1;xt.avail_out!==0&&(xt.avail_in!==0||vt!==4&&vt!==2)||(this.options.to==="string"?this.onData(rt.buf2binstring(et.shrinkBuf(xt.output,xt.next_out))):this.onData(et.shrinkBuf(xt.output,xt.next_out)))}while((xt.avail_in>0||xt.avail_out===0)&&gt!==1);return vt===4?(gt=tt.deflateEnd(this.strm),this.onEnd(gt),this.ended=!0,gt===st):vt!==2||(this.onEnd(st),xt.avail_out=0,!0)},dt.prototype.onData=function(ft){this.chunks.push(ft)},dt.prototype.onEnd=function(ft){ft===st&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=ft,this.msg=this.strm.msg},deflate$1.Deflate=dt,deflate$1.deflate=ut,deflate$1.deflateRaw=function(ft,mt){return(mt=mt||{}).raw=!0,ut(ft,mt)},deflate$1.gzip=function(ft,mt){return(mt=mt||{}).gzip=!0,ut(ft,mt)},deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast,inftrees,hasRequiredInftrees,hasRequiredInflate$1,constants,hasRequiredConstants,gzheader,hasRequiredGzheader,hasRequiredInflate,pako_1,hasRequiredPako;function requireInffast(){return hasRequiredInffast?inffast:(hasRequiredInffast=1,inffast=function(tt,et){var rt,nt,it,at,st,ot,lt,ht,dt,ut,ft,mt,gt,vt,xt,wt,At,Tt,Pt,Rt,Ot,Et,Lt,kt,jt;rt=tt.state,nt=tt.next_in,kt=tt.input,it=nt+(tt.avail_in-5),at=tt.next_out,jt=tt.output,st=at-(et-tt.avail_out),ot=at+(tt.avail_out-257),lt=rt.dmax,ht=rt.wsize,dt=rt.whave,ut=rt.wnext,ft=rt.window,mt=rt.hold,gt=rt.bits,vt=rt.lencode,xt=rt.distcode,wt=(1<<rt.lenbits)-1,At=(1<<rt.distbits)-1;e:do{gt<15&&(mt+=kt[nt++]<<gt,gt+=8,mt+=kt[nt++]<<gt,gt+=8),Tt=vt[mt&wt];t:for(;;){if(mt>>>=Pt=Tt>>>24,gt-=Pt,(Pt=Tt>>>16&255)===0)jt[at++]=65535&Tt;else{if(!(16&Pt)){if(64&Pt){if(32&Pt){rt.mode=12;break e}tt.msg="invalid literal/length code",rt.mode=30;break e}Tt=vt[(65535&Tt)+(mt&(1<<Pt)-1)];continue t}for(Rt=65535&Tt,(Pt&=15)&&(gt<Pt&&(mt+=kt[nt++]<<gt,gt+=8),Rt+=mt&(1<<Pt)-1,mt>>>=Pt,gt-=Pt),gt<15&&(mt+=kt[nt++]<<gt,gt+=8,mt+=kt[nt++]<<gt,gt+=8),Tt=xt[mt&At];;){if(mt>>>=Pt=Tt>>>24,gt-=Pt,16&(Pt=Tt>>>16&255)){if(Ot=65535&Tt,gt<(Pt&=15)&&(mt+=kt[nt++]<<gt,(gt+=8)<Pt&&(mt+=kt[nt++]<<gt,gt+=8)),(Ot+=mt&(1<<Pt)-1)>lt){tt.msg="invalid distance too far back",rt.mode=30;break e}if(mt>>>=Pt,gt-=Pt,Ot>(Pt=at-st)){if((Pt=Ot-Pt)>dt&&rt.sane){tt.msg="invalid distance too far back",rt.mode=30;break e}if(Et=0,Lt=ft,ut===0){if(Et+=ht-Pt,Pt<Rt){Rt-=Pt;do jt[at++]=ft[Et++];while(--Pt);Et=at-Ot,Lt=jt}}else if(ut<Pt){if(Et+=ht+ut-Pt,(Pt-=ut)<Rt){Rt-=Pt;do jt[at++]=ft[Et++];while(--Pt);if(Et=0,ut<Rt){Rt-=Pt=ut;do jt[at++]=ft[Et++];while(--Pt);Et=at-Ot,Lt=jt}}}else if(Et+=ut-Pt,Pt<Rt){Rt-=Pt;do jt[at++]=ft[Et++];while(--Pt);Et=at-Ot,Lt=jt}for(;Rt>2;)jt[at++]=Lt[Et++],jt[at++]=Lt[Et++],jt[at++]=Lt[Et++],Rt-=3;Rt&&(jt[at++]=Lt[Et++],Rt>1&&(jt[at++]=Lt[Et++]))}else{Et=at-Ot;do jt[at++]=jt[Et++],jt[at++]=jt[Et++],jt[at++]=jt[Et++],Rt-=3;while(Rt>2);Rt&&(jt[at++]=jt[Et++],Rt>1&&(jt[at++]=jt[Et++]))}break}if(64&Pt){tt.msg="invalid distance code",rt.mode=30;break e}Tt=xt[(65535&Tt)+(mt&(1<<Pt)-1)]}}break}}while(nt<it&&at<ot);nt-=Rt=gt>>3,mt&=(1<<(gt-=Rt<<3))-1,tt.next_in=nt,tt.next_out=at,tt.avail_in=nt<it?it-nt+5:5-(nt-it),tt.avail_out=at<ot?ot-at+257:257-(at-ot),rt.hold=mt,rt.bits=gt},inffast)}function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var tt=requireCommon(),et=15,rt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],nt=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],it=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],at=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(st,ot,lt,ht,dt,ut,ft,mt){var gt,vt,xt,wt,At,Tt,Pt,Rt,Ot,Et=mt.bits,Lt=0,kt=0,jt=0,Mt=0,$t=0,Qt=0,Ht=0,qt=0,Bt=0,Xt=0,Ft=null,Wt=0,Yt=new tt.Buf16(16),zt=new tt.Buf16(16),er=null,dr=0;for(Lt=0;Lt<=et;Lt++)Yt[Lt]=0;for(kt=0;kt<ht;kt++)Yt[ot[lt+kt]]++;for($t=Et,Mt=et;Mt>=1&&Yt[Mt]===0;Mt--);if($t>Mt&&($t=Mt),Mt===0)return dt[ut++]=20971520,dt[ut++]=20971520,mt.bits=1,0;for(jt=1;jt<Mt&&Yt[jt]===0;jt++);for($t<jt&&($t=jt),qt=1,Lt=1;Lt<=et;Lt++)if(qt<<=1,(qt-=Yt[Lt])<0)return-1;if(qt>0&&(st===0||Mt!==1))return-1;for(zt[1]=0,Lt=1;Lt<et;Lt++)zt[Lt+1]=zt[Lt]+Yt[Lt];for(kt=0;kt<ht;kt++)ot[lt+kt]!==0&&(ft[zt[ot[lt+kt]]++]=kt);if(st===0?(Ft=er=ft,Tt=19):st===1?(Ft=rt,Wt-=257,er=nt,dr-=257,Tt=256):(Ft=it,er=at,Tt=-1),Xt=0,kt=0,Lt=jt,At=ut,Qt=$t,Ht=0,xt=-1,wt=(Bt=1<<$t)-1,st===1&&Bt>852||st===2&&Bt>592)return 1;for(;;){Pt=Lt-Ht,ft[kt]<Tt?(Rt=0,Ot=ft[kt]):ft[kt]>Tt?(Rt=er[dr+ft[kt]],Ot=Ft[Wt+ft[kt]]):(Rt=96,Ot=0),gt=1<<Lt-Ht,jt=vt=1<<Qt;do dt[At+(Xt>>Ht)+(vt-=gt)]=Pt<<24|Rt<<16|Ot;while(vt!==0);for(gt=1<<Lt-1;Xt&gt;)gt>>=1;if(gt!==0?(Xt&=gt-1,Xt+=gt):Xt=0,kt++,--Yt[Lt]==0){if(Lt===Mt)break;Lt=ot[lt+ft[kt]]}if(Lt>$t&&(Xt&wt)!==xt){for(Ht===0&&(Ht=$t),At+=jt,qt=1<<(Qt=Lt-Ht);Qt+Ht<Mt&&!((qt-=Yt[Qt+Ht])<=0);)Qt++,qt<<=1;if(Bt+=1<<Qt,st===1&&Bt>852||st===2&&Bt>592)return 1;dt[xt=Xt&wt]=$t<<24|Qt<<16|At-ut}}return Xt!==0&&(dt[At+Xt]=Lt-Ht<<24|64<<16),mt.bits=$t,0}}function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;var tt=requireCommon(),et=requireAdler32(),rt=requireCrc32(),nt=requireInffast(),it=requireInftrees(),at=1,st=2,ot=0,lt=-2,ht=1,dt=12,ut=30,ft=852,mt=592;function gt(kt){return(kt>>>24&255)+(kt>>>8&65280)+((65280&kt)<<8)+((255&kt)<<24)}function vt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new tt.Buf16(320),this.work=new tt.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function xt(kt){var jt;return kt&&kt.state?(jt=kt.state,kt.total_in=kt.total_out=jt.total=0,kt.msg="",jt.wrap&&(kt.adler=1&jt.wrap),jt.mode=ht,jt.last=0,jt.havedict=0,jt.dmax=32768,jt.head=null,jt.hold=0,jt.bits=0,jt.lencode=jt.lendyn=new tt.Buf32(ft),jt.distcode=jt.distdyn=new tt.Buf32(mt),jt.sane=1,jt.back=-1,ot):lt}function wt(kt){var jt;return kt&&kt.state?((jt=kt.state).wsize=0,jt.whave=0,jt.wnext=0,xt(kt)):lt}function At(kt,jt){var Mt,$t;return kt&&kt.state?($t=kt.state,jt<0?(Mt=0,jt=-jt):(Mt=1+(jt>>4),jt<48&&(jt&=15)),jt&&(jt<8||jt>15)?lt:($t.window!==null&&$t.wbits!==jt&&($t.window=null),$t.wrap=Mt,$t.wbits=jt,wt(kt))):lt}function Tt(kt,jt){var Mt,$t;return kt?($t=new vt,kt.state=$t,$t.window=null,(Mt=At(kt,jt))!==ot&&(kt.state=null),Mt):lt}var Pt,Rt,Ot=!0;function Et(kt){if(Ot){var jt;for(Pt=new tt.Buf32(512),Rt=new tt.Buf32(32),jt=0;jt<144;)kt.lens[jt++]=8;for(;jt<256;)kt.lens[jt++]=9;for(;jt<280;)kt.lens[jt++]=7;for(;jt<288;)kt.lens[jt++]=8;for(it(at,kt.lens,0,288,Pt,0,kt.work,{bits:9}),jt=0;jt<32;)kt.lens[jt++]=5;it(st,kt.lens,0,32,Rt,0,kt.work,{bits:5}),Ot=!1}kt.lencode=Pt,kt.lenbits=9,kt.distcode=Rt,kt.distbits=5}function Lt(kt,jt,Mt,$t){var Qt,Ht=kt.state;return Ht.window===null&&(Ht.wsize=1<<Ht.wbits,Ht.wnext=0,Ht.whave=0,Ht.window=new tt.Buf8(Ht.wsize)),$t>=Ht.wsize?(tt.arraySet(Ht.window,jt,Mt-Ht.wsize,Ht.wsize,0),Ht.wnext=0,Ht.whave=Ht.wsize):((Qt=Ht.wsize-Ht.wnext)>$t&&(Qt=$t),tt.arraySet(Ht.window,jt,Mt-$t,Qt,Ht.wnext),($t-=Qt)?(tt.arraySet(Ht.window,jt,Mt-$t,$t,0),Ht.wnext=$t,Ht.whave=Ht.wsize):(Ht.wnext+=Qt,Ht.wnext===Ht.wsize&&(Ht.wnext=0),Ht.whave<Ht.wsize&&(Ht.whave+=Qt))),0}return inflate.inflateReset=wt,inflate.inflateReset2=At,inflate.inflateResetKeep=xt,inflate.inflateInit=function(kt){return Tt(kt,15)},inflate.inflateInit2=Tt,inflate.inflate=function(kt,jt){var Mt,$t,Qt,Ht,qt,Bt,Xt,Ft,Wt,Yt,zt,er,dr,fr,lr,mr,br,Sr,Ir,cr,Nt,pr,rr,ar,nr=0,ur=new tt.Buf8(4),Er=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!kt||!kt.state||!kt.output||!kt.input&&kt.avail_in!==0)return lt;(Mt=kt.state).mode===dt&&(Mt.mode=13),qt=kt.next_out,Qt=kt.output,Xt=kt.avail_out,Ht=kt.next_in,$t=kt.input,Bt=kt.avail_in,Ft=Mt.hold,Wt=Mt.bits,Yt=Bt,zt=Xt,pr=ot;e:for(;;)switch(Mt.mode){case ht:if(Mt.wrap===0){Mt.mode=13;break}for(;Wt<16;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(2&Mt.wrap&&Ft===35615){Mt.check=0,ur[0]=255&Ft,ur[1]=Ft>>>8&255,Mt.check=rt(Mt.check,ur,2,0),Ft=0,Wt=0,Mt.mode=2;break}if(Mt.flags=0,Mt.head&&(Mt.head.done=!1),!(1&Mt.wrap)||(((255&Ft)<<8)+(Ft>>8))%31){kt.msg="incorrect header check",Mt.mode=ut;break}if((15&Ft)!=8){kt.msg="unknown compression method",Mt.mode=ut;break}if(Wt-=4,Nt=8+(15&(Ft>>>=4)),Mt.wbits===0)Mt.wbits=Nt;else if(Nt>Mt.wbits){kt.msg="invalid window size",Mt.mode=ut;break}Mt.dmax=1<<Nt,kt.adler=Mt.check=1,Mt.mode=512&Ft?10:dt,Ft=0,Wt=0;break;case 2:for(;Wt<16;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(Mt.flags=Ft,(255&Mt.flags)!=8){kt.msg="unknown compression method",Mt.mode=ut;break}if(57344&Mt.flags){kt.msg="unknown header flags set",Mt.mode=ut;break}Mt.head&&(Mt.head.text=Ft>>8&1),512&Mt.flags&&(ur[0]=255&Ft,ur[1]=Ft>>>8&255,Mt.check=rt(Mt.check,ur,2,0)),Ft=0,Wt=0,Mt.mode=3;case 3:for(;Wt<32;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Mt.head&&(Mt.head.time=Ft),512&Mt.flags&&(ur[0]=255&Ft,ur[1]=Ft>>>8&255,ur[2]=Ft>>>16&255,ur[3]=Ft>>>24&255,Mt.check=rt(Mt.check,ur,4,0)),Ft=0,Wt=0,Mt.mode=4;case 4:for(;Wt<16;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Mt.head&&(Mt.head.xflags=255&Ft,Mt.head.os=Ft>>8),512&Mt.flags&&(ur[0]=255&Ft,ur[1]=Ft>>>8&255,Mt.check=rt(Mt.check,ur,2,0)),Ft=0,Wt=0,Mt.mode=5;case 5:if(1024&Mt.flags){for(;Wt<16;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Mt.length=Ft,Mt.head&&(Mt.head.extra_len=Ft),512&Mt.flags&&(ur[0]=255&Ft,ur[1]=Ft>>>8&255,Mt.check=rt(Mt.check,ur,2,0)),Ft=0,Wt=0}else Mt.head&&(Mt.head.extra=null);Mt.mode=6;case 6:if(1024&Mt.flags&&((er=Mt.length)>Bt&&(er=Bt),er&&(Mt.head&&(Nt=Mt.head.extra_len-Mt.length,Mt.head.extra||(Mt.head.extra=new Array(Mt.head.extra_len)),tt.arraySet(Mt.head.extra,$t,Ht,er,Nt)),512&Mt.flags&&(Mt.check=rt(Mt.check,$t,er,Ht)),Bt-=er,Ht+=er,Mt.length-=er),Mt.length))break e;Mt.length=0,Mt.mode=7;case 7:if(2048&Mt.flags){if(Bt===0)break e;er=0;do Nt=$t[Ht+er++],Mt.head&&Nt&&Mt.length<65536&&(Mt.head.name+=String.fromCharCode(Nt));while(Nt&&er<Bt);if(512&Mt.flags&&(Mt.check=rt(Mt.check,$t,er,Ht)),Bt-=er,Ht+=er,Nt)break e}else Mt.head&&(Mt.head.name=null);Mt.length=0,Mt.mode=8;case 8:if(4096&Mt.flags){if(Bt===0)break e;er=0;do Nt=$t[Ht+er++],Mt.head&&Nt&&Mt.length<65536&&(Mt.head.comment+=String.fromCharCode(Nt));while(Nt&&er<Bt);if(512&Mt.flags&&(Mt.check=rt(Mt.check,$t,er,Ht)),Bt-=er,Ht+=er,Nt)break e}else Mt.head&&(Mt.head.comment=null);Mt.mode=9;case 9:if(512&Mt.flags){for(;Wt<16;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(Ft!==(65535&Mt.check)){kt.msg="header crc mismatch",Mt.mode=ut;break}Ft=0,Wt=0}Mt.head&&(Mt.head.hcrc=Mt.flags>>9&1,Mt.head.done=!0),kt.adler=Mt.check=0,Mt.mode=dt;break;case 10:for(;Wt<32;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}kt.adler=Mt.check=gt(Ft),Ft=0,Wt=0,Mt.mode=11;case 11:if(Mt.havedict===0)return kt.next_out=qt,kt.avail_out=Xt,kt.next_in=Ht,kt.avail_in=Bt,Mt.hold=Ft,Mt.bits=Wt,2;kt.adler=Mt.check=1,Mt.mode=dt;case dt:if(jt===5||jt===6)break e;case 13:if(Mt.last){Ft>>>=7&Wt,Wt-=7&Wt,Mt.mode=27;break}for(;Wt<3;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}switch(Mt.last=1&Ft,Wt-=1,3&(Ft>>>=1)){case 0:Mt.mode=14;break;case 1:if(Et(Mt),Mt.mode=20,jt===6){Ft>>>=2,Wt-=2;break e}break;case 2:Mt.mode=17;break;case 3:kt.msg="invalid block type",Mt.mode=ut}Ft>>>=2,Wt-=2;break;case 14:for(Ft>>>=7&Wt,Wt-=7&Wt;Wt<32;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if((65535&Ft)!=(Ft>>>16^65535)){kt.msg="invalid stored block lengths",Mt.mode=ut;break}if(Mt.length=65535&Ft,Ft=0,Wt=0,Mt.mode=15,jt===6)break e;case 15:Mt.mode=16;case 16:if(er=Mt.length){if(er>Bt&&(er=Bt),er>Xt&&(er=Xt),er===0)break e;tt.arraySet(Qt,$t,Ht,er,qt),Bt-=er,Ht+=er,Xt-=er,qt+=er,Mt.length-=er;break}Mt.mode=dt;break;case 17:for(;Wt<14;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(Mt.nlen=257+(31&Ft),Ft>>>=5,Wt-=5,Mt.ndist=1+(31&Ft),Ft>>>=5,Wt-=5,Mt.ncode=4+(15&Ft),Ft>>>=4,Wt-=4,Mt.nlen>286||Mt.ndist>30){kt.msg="too many length or distance symbols",Mt.mode=ut;break}Mt.have=0,Mt.mode=18;case 18:for(;Mt.have<Mt.ncode;){for(;Wt<3;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Mt.lens[Er[Mt.have++]]=7&Ft,Ft>>>=3,Wt-=3}for(;Mt.have<19;)Mt.lens[Er[Mt.have++]]=0;if(Mt.lencode=Mt.lendyn,Mt.lenbits=7,rr={bits:Mt.lenbits},pr=it(0,Mt.lens,0,19,Mt.lencode,0,Mt.work,rr),Mt.lenbits=rr.bits,pr){kt.msg="invalid code lengths set",Mt.mode=ut;break}Mt.have=0,Mt.mode=19;case 19:for(;Mt.have<Mt.nlen+Mt.ndist;){for(;mr=(nr=Mt.lencode[Ft&(1<<Mt.lenbits)-1])>>>16&255,br=65535&nr,!((lr=nr>>>24)<=Wt);){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(br<16)Ft>>>=lr,Wt-=lr,Mt.lens[Mt.have++]=br;else{if(br===16){for(ar=lr+2;Wt<ar;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(Ft>>>=lr,Wt-=lr,Mt.have===0){kt.msg="invalid bit length repeat",Mt.mode=ut;break}Nt=Mt.lens[Mt.have-1],er=3+(3&Ft),Ft>>>=2,Wt-=2}else if(br===17){for(ar=lr+3;Wt<ar;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Wt-=lr,Nt=0,er=3+(7&(Ft>>>=lr)),Ft>>>=3,Wt-=3}else{for(ar=lr+7;Wt<ar;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Wt-=lr,Nt=0,er=11+(127&(Ft>>>=lr)),Ft>>>=7,Wt-=7}if(Mt.have+er>Mt.nlen+Mt.ndist){kt.msg="invalid bit length repeat",Mt.mode=ut;break}for(;er--;)Mt.lens[Mt.have++]=Nt}}if(Mt.mode===ut)break;if(Mt.lens[256]===0){kt.msg="invalid code -- missing end-of-block",Mt.mode=ut;break}if(Mt.lenbits=9,rr={bits:Mt.lenbits},pr=it(at,Mt.lens,0,Mt.nlen,Mt.lencode,0,Mt.work,rr),Mt.lenbits=rr.bits,pr){kt.msg="invalid literal/lengths set",Mt.mode=ut;break}if(Mt.distbits=6,Mt.distcode=Mt.distdyn,rr={bits:Mt.distbits},pr=it(st,Mt.lens,Mt.nlen,Mt.ndist,Mt.distcode,0,Mt.work,rr),Mt.distbits=rr.bits,pr){kt.msg="invalid distances set",Mt.mode=ut;break}if(Mt.mode=20,jt===6)break e;case 20:Mt.mode=21;case 21:if(Bt>=6&&Xt>=258){kt.next_out=qt,kt.avail_out=Xt,kt.next_in=Ht,kt.avail_in=Bt,Mt.hold=Ft,Mt.bits=Wt,nt(kt,zt),qt=kt.next_out,Qt=kt.output,Xt=kt.avail_out,Ht=kt.next_in,$t=kt.input,Bt=kt.avail_in,Ft=Mt.hold,Wt=Mt.bits,Mt.mode===dt&&(Mt.back=-1);break}for(Mt.back=0;mr=(nr=Mt.lencode[Ft&(1<<Mt.lenbits)-1])>>>16&255,br=65535&nr,!((lr=nr>>>24)<=Wt);){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(mr&&!(240&mr)){for(Sr=lr,Ir=mr,cr=br;mr=(nr=Mt.lencode[cr+((Ft&(1<<Sr+Ir)-1)>>Sr)])>>>16&255,br=65535&nr,!(Sr+(lr=nr>>>24)<=Wt);){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Ft>>>=Sr,Wt-=Sr,Mt.back+=Sr}if(Ft>>>=lr,Wt-=lr,Mt.back+=lr,Mt.length=br,mr===0){Mt.mode=26;break}if(32&mr){Mt.back=-1,Mt.mode=dt;break}if(64&mr){kt.msg="invalid literal/length code",Mt.mode=ut;break}Mt.extra=15&mr,Mt.mode=22;case 22:if(Mt.extra){for(ar=Mt.extra;Wt<ar;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Mt.length+=Ft&(1<<Mt.extra)-1,Ft>>>=Mt.extra,Wt-=Mt.extra,Mt.back+=Mt.extra}Mt.was=Mt.length,Mt.mode=23;case 23:for(;mr=(nr=Mt.distcode[Ft&(1<<Mt.distbits)-1])>>>16&255,br=65535&nr,!((lr=nr>>>24)<=Wt);){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(!(240&mr)){for(Sr=lr,Ir=mr,cr=br;mr=(nr=Mt.distcode[cr+((Ft&(1<<Sr+Ir)-1)>>Sr)])>>>16&255,br=65535&nr,!(Sr+(lr=nr>>>24)<=Wt);){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Ft>>>=Sr,Wt-=Sr,Mt.back+=Sr}if(Ft>>>=lr,Wt-=lr,Mt.back+=lr,64&mr){kt.msg="invalid distance code",Mt.mode=ut;break}Mt.offset=br,Mt.extra=15&mr,Mt.mode=24;case 24:if(Mt.extra){for(ar=Mt.extra;Wt<ar;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}Mt.offset+=Ft&(1<<Mt.extra)-1,Ft>>>=Mt.extra,Wt-=Mt.extra,Mt.back+=Mt.extra}if(Mt.offset>Mt.dmax){kt.msg="invalid distance too far back",Mt.mode=ut;break}Mt.mode=25;case 25:if(Xt===0)break e;if(er=zt-Xt,Mt.offset>er){if((er=Mt.offset-er)>Mt.whave&&Mt.sane){kt.msg="invalid distance too far back",Mt.mode=ut;break}er>Mt.wnext?(er-=Mt.wnext,dr=Mt.wsize-er):dr=Mt.wnext-er,er>Mt.length&&(er=Mt.length),fr=Mt.window}else fr=Qt,dr=qt-Mt.offset,er=Mt.length;er>Xt&&(er=Xt),Xt-=er,Mt.length-=er;do Qt[qt++]=fr[dr++];while(--er);Mt.length===0&&(Mt.mode=21);break;case 26:if(Xt===0)break e;Qt[qt++]=Mt.length,Xt--,Mt.mode=21;break;case 27:if(Mt.wrap){for(;Wt<32;){if(Bt===0)break e;Bt--,Ft|=$t[Ht++]<<Wt,Wt+=8}if(zt-=Xt,kt.total_out+=zt,Mt.total+=zt,zt&&(kt.adler=Mt.check=Mt.flags?rt(Mt.check,Qt,zt,qt-zt):et(Mt.check,Qt,zt,qt-zt)),zt=Xt,(Mt.flags?Ft:gt(Ft))!==Mt.check){kt.msg="incorrect data check",Mt.mode=ut;break}Ft=0,Wt=0}Mt.mode=28;case 28:if(Mt.wrap&&Mt.flags){for(;Wt<32;){if(Bt===0)break e;Bt--,Ft+=$t[Ht++]<<Wt,Wt+=8}if(Ft!==(4294967295&Mt.total)){kt.msg="incorrect length check",Mt.mode=ut;break}Ft=0,Wt=0}Mt.mode=29;case 29:pr=1;break e;case ut:pr=-3;break e;case 31:return-4;default:return lt}return kt.next_out=qt,kt.avail_out=Xt,kt.next_in=Ht,kt.avail_in=Bt,Mt.hold=Ft,Mt.bits=Wt,(Mt.wsize||zt!==kt.avail_out&&Mt.mode<ut&&(Mt.mode<27||jt!==4))&&Lt(kt,kt.output,kt.next_out,zt-kt.avail_out),Yt-=kt.avail_in,zt-=kt.avail_out,kt.total_in+=Yt,kt.total_out+=zt,Mt.total+=zt,Mt.wrap&&zt&&(kt.adler=Mt.check=Mt.flags?rt(Mt.check,Qt,zt,kt.next_out-zt):et(Mt.check,Qt,zt,kt.next_out-zt)),kt.data_type=Mt.bits+(Mt.last?64:0)+(Mt.mode===dt?128:0)+(Mt.mode===20||Mt.mode===15?256:0),(Yt===0&&zt===0||jt===4)&&pr===ot&&(pr=-5),pr},inflate.inflateEnd=function(kt){if(!kt||!kt.state)return lt;var jt=kt.state;return jt.window&&(jt.window=null),kt.state=null,ot},inflate.inflateGetHeader=function(kt,jt){var Mt;return kt&&kt.state&&2&(Mt=kt.state).wrap?(Mt.head=jt,jt.done=!1,ot):lt},inflate.inflateSetDictionary=function(kt,jt){var Mt,$t=jt.length;return kt&&kt.state?(Mt=kt.state).wrap!==0&&Mt.mode!==11?lt:Mt.mode===11&&et(1,jt,$t,0)!==Mt.check?-3:Lt(kt,jt,$t,$t)?(Mt.mode=31,-4):(Mt.havedict=1,ot):lt},inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}function requireConstants(){return hasRequiredConstants?constants:(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function requireGzheader(){return hasRequiredGzheader?gzheader:(hasRequiredGzheader=1,gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1})}function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;var tt=requireInflate$1(),et=requireCommon(),rt=requireStrings(),nt=requireConstants(),it=requireMessages(),at=requireZstream(),st=requireGzheader(),ot=Object.prototype.toString;function lt(dt){if(!(this instanceof lt))return new lt(dt);this.options=et.assign({chunkSize:16384,windowBits:0,to:""},dt||{});var ut=this.options;ut.raw&&ut.windowBits>=0&&ut.windowBits<16&&(ut.windowBits=-ut.windowBits,ut.windowBits===0&&(ut.windowBits=-15)),!(ut.windowBits>=0&&ut.windowBits<16)||dt&&dt.windowBits||(ut.windowBits+=32),ut.windowBits>15&&ut.windowBits<48&&(15&ut.windowBits||(ut.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new at,this.strm.avail_out=0;var ft=tt.inflateInit2(this.strm,ut.windowBits);if(ft!==nt.Z_OK)throw new Error(it[ft]);if(this.header=new st,tt.inflateGetHeader(this.strm,this.header),ut.dictionary&&(typeof ut.dictionary=="string"?ut.dictionary=rt.string2buf(ut.dictionary):ot.call(ut.dictionary)==="[object ArrayBuffer]"&&(ut.dictionary=new Uint8Array(ut.dictionary)),ut.raw&&(ft=tt.inflateSetDictionary(this.strm,ut.dictionary))!==nt.Z_OK))throw new Error(it[ft])}function ht(dt,ut){var ft=new lt(ut);if(ft.push(dt,!0),ft.err)throw ft.msg||it[ft.err];return ft.result}return lt.prototype.push=function(dt,ut){var ft,mt,gt,vt,xt,wt=this.strm,At=this.options.chunkSize,Tt=this.options.dictionary,Pt=!1;if(this.ended)return!1;mt=ut===~~ut?ut:ut===!0?nt.Z_FINISH:nt.Z_NO_FLUSH,typeof dt=="string"?wt.input=rt.binstring2buf(dt):ot.call(dt)==="[object ArrayBuffer]"?wt.input=new Uint8Array(dt):wt.input=dt,wt.next_in=0,wt.avail_in=wt.input.length;do{if(wt.avail_out===0&&(wt.output=new et.Buf8(At),wt.next_out=0,wt.avail_out=At),(ft=tt.inflate(wt,nt.Z_NO_FLUSH))===nt.Z_NEED_DICT&&Tt&&(ft=tt.inflateSetDictionary(this.strm,Tt)),ft===nt.Z_BUF_ERROR&&Pt===!0&&(ft=nt.Z_OK,Pt=!1),ft!==nt.Z_STREAM_END&&ft!==nt.Z_OK)return this.onEnd(ft),this.ended=!0,!1;wt.next_out&&(wt.avail_out!==0&&ft!==nt.Z_STREAM_END&&(wt.avail_in!==0||mt!==nt.Z_FINISH&&mt!==nt.Z_SYNC_FLUSH)||(this.options.to==="string"?(gt=rt.utf8border(wt.output,wt.next_out),vt=wt.next_out-gt,xt=rt.buf2string(wt.output,gt),wt.next_out=vt,wt.avail_out=At-vt,vt&&et.arraySet(wt.output,wt.output,gt,vt,0),this.onData(xt)):this.onData(et.shrinkBuf(wt.output,wt.next_out)))),wt.avail_in===0&&wt.avail_out===0&&(Pt=!0)}while((wt.avail_in>0||wt.avail_out===0)&&ft!==nt.Z_STREAM_END);return ft===nt.Z_STREAM_END&&(mt=nt.Z_FINISH),mt===nt.Z_FINISH?(ft=tt.inflateEnd(this.strm),this.onEnd(ft),this.ended=!0,ft===nt.Z_OK):mt!==nt.Z_SYNC_FLUSH||(this.onEnd(nt.Z_OK),wt.avail_out=0,!0)},lt.prototype.onData=function(dt){this.chunks.push(dt)},lt.prototype.onEnd=function(dt){dt===nt.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=dt,this.msg=this.strm.msg},inflate$1.Inflate=lt,inflate$1.inflate=ht,inflate$1.inflateRaw=function(dt,ut){return(ut=ut||{}).raw=!0,ht(dt,ut)},inflate$1.ungzip=ht,inflate$1}function requirePako(){if(hasRequiredPako)return pako_1;hasRequiredPako=1;var tt={};return(0,requireCommon().assign)(tt,requireDeflate(),requireInflate(),requireConstants()),pako_1=tt}(function(tt){(function(){var et={};function rt(){typeof process<"u"||console.log.apply(console,arguments)}tt.exports=et,(function(nt,it){(function(){var at=(function(){function lt(ht){this.message="JPEG error: "+ht}return lt.prototype=new Error,lt.prototype.name="JpegError",lt.constructor=lt,lt})(),st=(function(){var lt=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),ht=4017,dt=799,ut=3406,ft=2276,mt=1567,gt=3784,vt=5793,xt=2896;function wt(Lt){Lt==null&&(Lt={}),Lt.w==null&&(Lt.w=-1),this.V=Lt.n,this.N=Lt.w}function At(Lt,kt){for(var jt,Mt,$t,Qt=0,Ht=[],qt=16;qt>0&&!Lt[qt-1];)qt--;Ht.push({children:[],index:0});var Bt=Ht[0];for(jt=0;jt<qt;jt++){for(Mt=0;Mt<Lt[jt];Mt++){for((Bt=Ht.pop()).children[Bt.index]=kt[Qt];Bt.index>0;)Bt=Ht.pop();for(Bt.index++,Ht.push(Bt);Ht.length<=jt;)Ht.push($t={children:[],index:0}),Bt.children[Bt.index]=$t.children,Bt=$t;Qt++}jt+1<qt&&(Ht.push($t={children:[],index:0}),Bt.children[Bt.index]=$t.children,Bt=$t)}return Ht[0].children}function Tt(Lt,kt,jt){return 64*((Lt.P+1)*kt+jt)}function Pt(Lt,kt,jt,Mt,$t,Qt,Ht,qt,Bt,Xt){Xt==null&&(Xt=!1);var Ft,Wt,Yt,zt,er,dr,fr,lr,mr,br,Sr,Ir=jt.m,cr=jt.Z,Nt=kt,pr=0,rr=0,ar=0,nr=0,ur=0,Er=0;function Ut(){if(rr>0)return rr--,pr>>rr&1;if((pr=Lt[kt++])===255){var Mn=Lt[kt++];if(Mn){if(Mn===220&&Xt){var Kn=ot(Lt,kt+=2);if(kt+=2,Kn>0&&Kn!==jt.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",Kn)}else if(Mn===217){if(Xt){var Vn=8*ur;if(Vn>0&&Vn<jt.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",Vn)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new at("unexpected marker")}}return rr=7,pr>>>7}function Kt(Mn){for(var Kn=Mn;;){switch(typeof(Kn=Kn[Ut()])){case"number":return Kn;case"object":continue}throw new at("invalid huffman sequence")}}function or(Mn){for(var Kn=0;Mn>0;)Kn=Kn<<1|Ut(),Mn--;return Kn}function hr(Mn){if(Mn===1)return Ut()===1?1:-1;var Kn=or(Mn);return Kn>=1<<Mn-1?Kn:Kn+(-1<<Mn)+1}function kr(Mn,Kn,Vn,vi,mi){var _i=Vn%Ir;ur=(Vn/Ir|0)*Mn.A+vi;var Ri=_i*Mn.h+mi;Kn(Mn,Tt(Mn,ur,Ri))}function Br(Mn,Kn,Vn){ur=Vn/Mn.P|0;var vi=Vn%Mn.P;Kn(Mn,Tt(Mn,ur,vi))}var Gn=Mt.length;for(fr=cr?Qt===0?qt===0?function(Mn,Kn){var Vn=Kt(Mn.J),vi=Vn===0?0:hr(Vn)<<Bt;Mn.D[Kn]=Mn.Q+=vi}:function(Mn,Kn){Mn.D[Kn]|=Ut()<<Bt}:qt===0?function(Mn,Kn){if(ar>0)ar--;else for(var Vn=Qt,vi=Ht;Vn<=vi;){var mi=Kt(Mn.i),_i=15&mi,Ri=mi>>4;if(_i!==0){var pi=lt[Vn+=Ri];Mn.D[Kn+pi]=hr(_i)*(1<<Bt),Vn++}else{if(Ri<15){ar=or(Ri)+(1<<Ri)-1;break}Vn+=16}}}:function(Mn,Kn){for(var Vn,vi,mi=Qt,_i=Ht,Ri=0;mi<=_i;){var pi=Kn+lt[mi],Tr=Mn.D[pi]<0?-1:1;switch(nr){case 0:if(Ri=(vi=Kt(Mn.i))>>4,(Vn=15&vi)==0)Ri<15?(ar=or(Ri)+(1<<Ri),nr=4):(Ri=16,nr=1);else{if(Vn!==1)throw new at("invalid ACn encoding");Ft=hr(Vn),nr=Ri?2:3}continue;case 1:case 2:Mn.D[pi]?Mn.D[pi]+=Tr*(Ut()<<Bt):--Ri==0&&(nr=nr===2?3:0);break;case 3:Mn.D[pi]?Mn.D[pi]+=Tr*(Ut()<<Bt):(Mn.D[pi]=Ft<<Bt,nr=0);break;case 4:Mn.D[pi]&&(Mn.D[pi]+=Tr*(Ut()<<Bt))}mi++}nr===4&&--ar==0&&(nr=0)}:function(Mn,Kn){var Vn=Kt(Mn.J),vi=Vn===0?0:hr(Vn),mi=1;for(Mn.D[Kn]=Mn.Q+=vi;mi<64;){var _i=Kt(Mn.i),Ri=15&_i,pi=_i>>4;if(Ri!==0){var Tr=lt[mi+=pi];Mn.D[Kn+Tr]=hr(Ri),mi++}else{if(pi<15)break;mi+=16}}},mr=Gn===1?Mt[0].P*Mt[0].c:Ir*jt.R;Er<=mr;){var Xn=$t?Math.min(mr-Er,$t):mr;if(Xn>0){for(Yt=0;Yt<Gn;Yt++)Mt[Yt].Q=0;if(ar=0,Gn===1)for(Wt=Mt[0],dr=0;dr<Xn;dr++)Br(Wt,fr,Er),Er++;else for(dr=0;dr<Xn;dr++){for(Yt=0;Yt<Gn;Yt++)for(br=(Wt=Mt[Yt]).h,Sr=Wt.A,zt=0;zt<Sr;zt++)for(er=0;er<br;er++)kr(Wt,fr,Er,zt,er);Er++}}if(rr=0,!(lr=Et(Lt,kt))||(lr.u&&(kt=lr.offset),!(lr.M>=65488&&lr.M<=65495)))break;kt+=2}return kt-Nt}function Rt(Lt,kt,jt){var Mt,$t,Qt,Ht,qt,Bt,Xt,Ft,Wt,Yt,zt,er,dr,fr,lr,mr,br,Sr=Lt.$,Ir=Lt.D;if(!Sr)throw new at("missing required Quantization Table.");for(var cr=0;cr<64;cr+=8)Wt=Ir[kt+cr],Yt=Ir[kt+cr+1],zt=Ir[kt+cr+2],er=Ir[kt+cr+3],dr=Ir[kt+cr+4],fr=Ir[kt+cr+5],lr=Ir[kt+cr+6],mr=Ir[kt+cr+7],Wt*=Sr[cr],Yt|zt|er|dr|fr|lr|mr?(Yt*=Sr[cr+1],zt*=Sr[cr+2],er*=Sr[cr+3],dr*=Sr[cr+4],fr*=Sr[cr+5],lr*=Sr[cr+6],mr*=Sr[cr+7],$t=(Mt=(Mt=vt*Wt+128>>8)+($t=vt*dr+128>>8)+1>>1)-$t,br=(Qt=zt)*gt+(Ht=lr)*mt+128>>8,Qt=Qt*mt-Ht*gt+128>>8,Xt=(qt=(qt=xt*(Yt-mr)+128>>8)+(Xt=fr<<4)+1>>1)-Xt,Bt=(Ft=(Ft=xt*(Yt+mr)+128>>8)+(Bt=er<<4)+1>>1)-Bt,Ht=(Mt=Mt+(Ht=br)+1>>1)-Ht,Qt=($t=$t+Qt+1>>1)-Qt,br=qt*ft+Ft*ut+2048>>12,qt=qt*ut-Ft*ft+2048>>12,Ft=br,br=Bt*dt+Xt*ht+2048>>12,Bt=Bt*ht-Xt*dt+2048>>12,Xt=br,jt[cr]=Mt+Ft,jt[cr+7]=Mt-Ft,jt[cr+1]=$t+Xt,jt[cr+6]=$t-Xt,jt[cr+2]=Qt+Bt,jt[cr+5]=Qt-Bt,jt[cr+3]=Ht+qt,jt[cr+4]=Ht-qt):(br=vt*Wt+512>>10,jt[cr]=br,jt[cr+1]=br,jt[cr+2]=br,jt[cr+3]=br,jt[cr+4]=br,jt[cr+5]=br,jt[cr+6]=br,jt[cr+7]=br);for(var Nt=0;Nt<8;++Nt)Wt=jt[Nt],(Yt=jt[Nt+8])|(zt=jt[Nt+16])|(er=jt[Nt+24])|(dr=jt[Nt+32])|(fr=jt[Nt+40])|(lr=jt[Nt+48])|(mr=jt[Nt+56])?($t=(Mt=4112+((Mt=vt*Wt+2048>>12)+($t=vt*dr+2048>>12)+1>>1))-$t,br=(Qt=zt)*gt+(Ht=lr)*mt+2048>>12,Qt=Qt*mt-Ht*gt+2048>>12,Ht=br,Xt=(qt=(qt=xt*(Yt-mr)+2048>>12)+(Xt=fr)+1>>1)-Xt,Bt=(Ft=(Ft=xt*(Yt+mr)+2048>>12)+(Bt=er)+1>>1)-Bt,br=qt*ft+Ft*ut+2048>>12,qt=qt*ut-Ft*ft+2048>>12,Ft=br,br=Bt*dt+Xt*ht+2048>>12,Bt=Bt*ht-Xt*dt+2048>>12,(Wt=(Mt=Mt+Ht+1>>1)+Ft)<16?Wt=0:Wt>=4080?Wt=255:Wt>>=4,(Yt=($t=$t+Qt+1>>1)+(Xt=br))<16?Yt=0:Yt>=4080?Yt=255:Yt>>=4,(zt=(Qt=$t-Qt)+Bt)<16?zt=0:zt>=4080?zt=255:zt>>=4,(er=(Ht=Mt-Ht)+qt)<16?er=0:er>=4080?er=255:er>>=4,(dr=Ht-qt)<16?dr=0:dr>=4080?dr=255:dr>>=4,(fr=Qt-Bt)<16?fr=0:fr>=4080?fr=255:fr>>=4,(lr=$t-Xt)<16?lr=0:lr>=4080?lr=255:lr>>=4,(mr=Mt-Ft)<16?mr=0:mr>=4080?mr=255:mr>>=4,Ir[kt+Nt]=Wt,Ir[kt+Nt+8]=Yt,Ir[kt+Nt+16]=zt,Ir[kt+Nt+24]=er,Ir[kt+Nt+32]=dr,Ir[kt+Nt+40]=fr,Ir[kt+Nt+48]=lr,Ir[kt+Nt+56]=mr):(br=(br=vt*Wt+8192>>14)<-2040?0:br>=2024?255:br+2056>>4,Ir[kt+Nt]=br,Ir[kt+Nt+8]=br,Ir[kt+Nt+16]=br,Ir[kt+Nt+24]=br,Ir[kt+Nt+32]=br,Ir[kt+Nt+40]=br,Ir[kt+Nt+48]=br,Ir[kt+Nt+56]=br)}function Ot(Lt,kt){for(var jt=kt.P,Mt=kt.c,$t=new Int16Array(64),Qt=0;Qt<Mt;Qt++)for(var Ht=0;Ht<jt;Ht++)Rt(kt,Tt(kt,Qt,Ht),$t);return kt.D}function Et(Lt,kt,jt){jt==null&&(jt=kt);var Mt=Lt.length-1,$t=jt<kt?jt:kt;if(kt>=Mt)return null;var Qt=ot(Lt,kt);if(Qt>=65472&&Qt<=65534)return{u:null,M:Qt,offset:kt};for(var Ht=ot(Lt,$t);!(Ht>=65472&&Ht<=65534);){if(++$t>=Mt)return null;Ht=ot(Lt,$t)}return{u:Qt.toString(16),M:Ht,offset:$t}}return wt.prototype={parse(Lt,kt){kt==null&&(kt={});var jt,Mt,$t=kt.F,Qt=0,Ht=null,qt=null,Bt=0;function Xt(){var _r=ot(Lt,Qt),Rr=(Qt+=2)+_r-2,yr=Et(Lt,Rr,Qt);yr&&yr.u&&(Rr=yr.offset);var Kr=Lt.subarray(Qt,Rr);return Qt+=Kr.length,Kr}function Ft(_r){for(var Rr=Math.ceil(_r.o/8/_r.X),yr=Math.ceil(_r.s/8/_r.B),Kr=0;Kr<_r.W.length;Kr++){Br=_r.W[Kr];var Jr=Math.ceil(Math.ceil(_r.o/8)*Br.h/_r.X),Zt=Math.ceil(Math.ceil(_r.s/8)*Br.A/_r.B),Qr=Rr*Br.h,Dr=64*(yr*Br.A)*(Qr+1);Br.D=new Int16Array(Dr),Br.P=Jr,Br.c=Zt}_r.m=Rr,_r.R=yr}var Wt=[],Yt=[],zt=[],er=ot(Lt,Qt);if(Qt+=2,er!==65496)throw new at("SOI not found");er=ot(Lt,Qt),Qt+=2;e:for(;er!==65497;){var dr,fr,lr;switch(er){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var mr=Xt();er===65504&&mr[0]===74&&mr[1]===70&&mr[2]===73&&mr[3]===70&&mr[4]===0&&(Ht={version:{d:mr[5],T:mr[6]},K:mr[7],j:mr[8]<<8|mr[9],H:mr[10]<<8|mr[11],S:mr[12],I:mr[13],C:mr.subarray(14,14+3*mr[12]*mr[13])}),er===65518&&mr[0]===65&&mr[1]===100&&mr[2]===111&&mr[3]===98&&mr[4]===101&&(qt={version:mr[5]<<8|mr[6],k:mr[7]<<8|mr[8],q:mr[9]<<8|mr[10],a:mr[11]});break;case 65499:for(var br=ot(Lt,Qt)+(Qt+=2)-2;Qt<br;){var Sr=Lt[Qt++],Ir=new Uint16Array(64);if(Sr>>4){if(Sr>>4!=1)throw new at("DQT - invalid table spec");for(fr=0;fr<64;fr++)Ir[lt[fr]]=ot(Lt,Qt),Qt+=2}else for(fr=0;fr<64;fr++)Ir[lt[fr]]=Lt[Qt++];Wt[15&Sr]=Ir}break;case 65472:case 65473:case 65474:if(jt)throw new at("Only single frame JPEGs supported");Qt+=2,(jt={}).G=er===65473,jt.Z=er===65474,jt.precision=Lt[Qt++];var cr,Nt=ot(Lt,Qt),pr=0,rr=0;Qt+=2,jt.s=$t||Nt,jt.o=ot(Lt,Qt),Qt+=2,jt.W=[],jt._={};var ar=Lt[Qt++];for(dr=0;dr<ar;dr++){cr=Lt[Qt];var nr=Lt[Qt+1]>>4,ur=15&Lt[Qt+1];pr<nr&&(pr=nr),rr<ur&&(rr=ur);var Er=Lt[Qt+2];lr=jt.W.push({h:nr,A:ur,L:Er,$:null}),jt._[cr]=lr-1,Qt+=3}jt.X=pr,jt.B=rr,Ft(jt);break;case 65476:var Ut=ot(Lt,Qt);for(Qt+=2,dr=2;dr<Ut;){var Kt=Lt[Qt++],or=new Uint8Array(16),hr=0;for(fr=0;fr<16;fr++,Qt++)hr+=or[fr]=Lt[Qt];var kr=new Uint8Array(hr);for(fr=0;fr<hr;fr++,Qt++)kr[fr]=Lt[Qt];dr+=17+hr,(Kt>>4?Yt:zt)[15&Kt]=At(or,kr)}break;case 65501:Mt=ot(Lt,Qt+=2),Qt+=2;break;case 65498:var Br,Gn=++Bt==1&&!$t;Qt+=2;var Xn=Lt[Qt++],Mn=[];for(dr=0;dr<Xn;dr++){var Kn=Lt[Qt++],Vn=jt._[Kn];(Br=jt.W[Vn]).index=Kn;var vi=Lt[Qt++];Br.J=zt[vi>>4],Br.i=Yt[15&vi],Mn.push(Br)}var mi=Lt[Qt++],_i=Lt[Qt++],Ri=Lt[Qt++];try{var pi=Pt(Lt,Qt,jt,Mn,Mt,mi,_i,Ri>>4,15&Ri,Gn);Qt+=pi}catch(_r){if(_r instanceof DNLMarkerError)return this.parse(Lt,{F:_r.s});if(_r instanceof EOIMarkerError)break e;throw _r}break;case 65500:Qt+=4;break;case 65535:Lt[Qt]!==255&&Qt--;break;default:var Tr=Et(Lt,Qt-2,Qt-3);if(Tr&&Tr.u){Qt=Tr.offset;break}if(Qt>=Lt.length-1)break e;throw new at("JpegImage.parse - unknown marker: "+er.toString(16))}er=ot(Lt,Qt),Qt+=2}for(this.width=jt.o,this.height=jt.s,this.g=Ht,this.b=qt,this.W=[],dr=0;dr<jt.W.length;dr++){var qn=Wt[(Br=jt.W[dr]).L];qn&&(Br.$=qn),this.W.push({index:Br.index,e:Ot(0,Br),l:Br.h/jt.X,t:Br.A/jt.B,P:Br.P,c:Br.c})}this.p=this.W.length},Y(Lt,kt,jt){jt==null&&(jt=!1);var Mt,$t,Qt,Ht,qt,Bt,Xt,Ft,Wt,Yt,zt,er,dr=this.width/Lt,fr=this.height/kt,lr=0,mr=this.W.length,br=Lt*kt*mr,Sr=new Uint8ClampedArray(br),Ir=new Uint32Array(Lt),cr=4294967288;for(Xt=0;Xt<mr;Xt++){if($t=(Mt=this.W[Xt]).l*dr,Qt=Mt.t*fr,lr=Xt,zt=Mt.e,Ht=Mt.P+1<<3,$t!==er){for(qt=0;qt<Lt;qt++)Ft=0|qt*$t,Ir[qt]=(Ft&cr)<<3|7&Ft;er=$t}for(Bt=0;Bt<kt;Bt++)for(Yt=Ht*((Ft=0|Bt*Qt)&cr)|(7&Ft)<<3,qt=0;qt<Lt;qt++)Sr[lr]=zt[Yt+Ir[qt]],lr+=mr}var Nt=this.V;if(jt||mr!==4||Nt||(Nt=new Int32Array([-256,255,-256,255,-256,255,-256,255])),Nt)for(Xt=0;Xt<br;)for(Ft=0,Wt=0;Ft<mr;Ft++,Xt++,Wt+=2)Sr[Xt]=(Sr[Xt]*Nt[Wt]>>8)+Nt[Wt+1];return Sr},get f(){return this.b?!!this.b.a:this.p===3?this.N!==0&&(this.W[0].index!==82||this.W[1].index!==71||this.W[2].index!==66):this.N===1},z:function(Lt){for(var kt,jt,Mt,$t=0,Qt=Lt.length;$t<Qt;$t+=3)kt=Lt[$t],jt=Lt[$t+1],Mt=Lt[$t+2],Lt[$t]=kt-179.456+1.402*Mt,Lt[$t+1]=kt+135.459-.344*jt-.714*Mt,Lt[$t+2]=kt-226.816+1.772*jt;return Lt},O:function(Lt){for(var kt,jt,Mt,$t,Qt=0,Ht=0,qt=Lt.length;Ht<qt;Ht+=4)kt=Lt[Ht],jt=Lt[Ht+1],Mt=Lt[Ht+2],$t=Lt[Ht+3],Lt[Qt++]=jt*(-660635669420364e-19*jt+.000437130475926232*Mt-54080610064599e-18*kt+.00048449797120281*$t-.154362151871126)-122.67195406894+Mt*(-.000957964378445773*Mt+.000817076911346625*kt-.00477271405408747*$t+1.53380253221734)+kt*(.000961250184130688*kt-.00266257332283933*$t+.48357088451265)+$t*(-.000336197177618394*$t+.484791561490776),Lt[Qt++]=107.268039397724+jt*(219927104525741e-19*jt-.000640992018297945*Mt+.000659397001245577*kt+.000426105652938837*$t-.176491792462875)+Mt*(-.000778269941513683*Mt+.00130872261408275*kt+.000770482631801132*$t-.151051492775562)+kt*(.00126935368114843*kt-.00265090189010898*$t+.25802910206845)+$t*(-.000318913117588328*$t-.213742400323665),Lt[Qt++]=jt*(-.000570115196973677*jt-263409051004589e-19*Mt+.0020741088115012*kt-.00288260236853442*$t+.814272968359295)-20.810012546947+Mt*(-153496057440975e-19*Mt-.000132689043961446*kt+.000560833691242812*$t-.195152027534049)+kt*(.00174418132927582*kt-.00255243321439347*$t+.116935020465145)+$t*(-.000343531996510555*$t+.24165260232407);return Lt.subarray(0,Qt)},r:function(Lt){for(var kt,jt,Mt,$t=0,Qt=Lt.length;$t<Qt;$t+=4)kt=Lt[$t],jt=Lt[$t+1],Mt=Lt[$t+2],Lt[$t]=434.456-kt-1.402*Mt,Lt[$t+1]=119.541-kt+.344*jt+.714*Mt,Lt[$t+2]=481.816-kt-1.772*jt;return Lt},U:function(Lt){for(var kt,jt,Mt,$t,Qt=0,Ht=0,qt=Lt.length;Ht<qt;Ht+=4)kt=Lt[Ht],jt=Lt[Ht+1],Mt=Lt[Ht+2],$t=Lt[Ht+3],Lt[Qt++]=255+kt*(-6747147073602441e-20*kt+.0008379262121013727*jt+.0002894718188643294*Mt+.003264231057537806*$t-1.1185611867203937)+jt*(26374107616089405e-21*jt-8626949158638572e-20*Mt-.0002748769067499491*$t-.02155688794978967)+Mt*(-3878099212869363e-20*Mt-.0003267808279485286*$t+.0686742238595345)-$t*(.0003361971776183937*$t+.7430659151342254),Lt[Qt++]=255+kt*(.00013596372813588848*kt+.000924537132573585*jt+.00010567359618683593*Mt+.0004791864687436512*$t-.3109689587515875)+jt*(-.00023545346108370344*jt+.0002702845253534714*Mt+.0020200308977307156*$t-.7488052167015494)+Mt*(6834815998235662e-20*Mt+.00015168452363460973*$t-.09751927774728933)-$t*(.0003189131175883281*$t+.7364883807733168),Lt[Qt++]=255+kt*(13598650411385307e-21*kt+.00012423956175490851*jt+.0004751985097583589*Mt-36729317476630422e-22*$t-.05562186980264034)+jt*(.00016141380598724676*jt+.0009692239130725186*Mt+.0007782692450036253*$t-.44015232367526463)+Mt*(5068882914068769e-22*Mt+.0017778369011375071*$t-.7591454649749609)-$t*(.0003435319965105553*$t+.7063770186160144);return Lt.subarray(0,Qt)},getData:function(Lt){var kt=Lt.width,jt=Lt.height,Mt=Lt.forceRGB,$t=Lt.isSourcePDF;if(this.p>4)throw new at("Unsupported color mode");var Qt=this.Y(kt,jt,$t);if(this.p===1&&Mt){for(var Ht=Qt.length,qt=new Uint8ClampedArray(3*Ht),Bt=0,Xt=0;Xt<Ht;Xt++){var Ft=Qt[Xt];qt[Bt++]=Ft,qt[Bt++]=Ft,qt[Bt++]=Ft}return qt}if(this.p===3&&this.f)return this.z(Qt);if(this.p===4){if(this.f)return Mt?this.O(Qt):this.r(Qt);if(Mt)return this.U(Qt)}return Qt}},wt})();function ot(lt,ht){return lt[ht]<<8|lt[ht+1]}nt.JpegDecoder=st})(),nt.encodeImage=function(at,st,ot,lt){var ht={t256:[st],t257:[ot],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[ot],t279:[st*ot*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(lt)for(var dt in lt)ht[dt]=lt[dt];var ut=new Uint8Array(nt.encode([ht])),ft=new Uint8Array(at),mt=new Uint8Array(1e3+st*ot*4);for(dt=0;dt<ut.length;dt++)mt[dt]=ut[dt];for(dt=0;dt<ft.length;dt++)mt[1e3+dt]=ft[dt];return mt.buffer},nt.encode=function(at){var st=new Uint8Array(2e4),ot=4,lt=nt._binBE;st[0]=st[1]=77,lt.writeUshort(st,2,42);var ht=8;lt.writeUint(st,ot,ht),ot+=4;for(var dt=0;dt<at.length;dt++){var ut=nt._writeIFD(lt,nt._types.basic,st,ht,at[dt]);ht=ut[1],dt<at.length-1&&(3&ht&&(ht+=4-(3&ht)),lt.writeUint(st,ut[0],ht))}return st.slice(0,ht).buffer},nt.decode=function(at,st){st==null&&(st={parseMN:!0,debug:!1});var ot=new Uint8Array(at),lt=0,ht=nt._binBE.readASCII(ot,lt,2);lt+=2;var dt=ht=="II"?nt._binLE:nt._binBE;dt.readUshort(ot,lt),lt+=2;var ut=dt.readUint(ot,lt);lt+=4;for(var ft=[];;){var mt=dt.readUshort(ot,ut),gt=dt.readUshort(ot,ut+4);if(mt!=0&&(gt<1||13<gt)){rt("error in TIFF");break}if(nt._readIFD(dt,ot,ut,ft,0,st),(ut=dt.readUint(ot,ut+2+12*mt))==0)break}return ft},nt.decodeImage=function(at,st,ot){if(!st.data){var lt=new Uint8Array(at),ht=nt._binBE.readASCII(lt,0,2);if(st.t256!=null){st.isLE=ht=="II",st.width=st.t256[0],st.height=st.t257[0];var dt=st.t259?st.t259[0]:1,ut=st.t266?st.t266[0]:1;st.t284&&st.t284[0]==2&&rt("PlanarConfiguration 2 should not be used!"),dt==7&&st.t258&&st.t258.length>3&&(st.t258=st.t258.slice(0,3));var ft=st.t277?st.t277[0]:1,mt=(st.t258?st.t258[0]:1)*ft;dt==1&&st.t279!=null&&st.t278&&st.t262[0]==32803&&(mt=Math.round(8*st.t279[0]/(st.width*st.t278[0]))),st.t50885&&st.t50885[0]==4&&(mt=3*st.t258[0]);var gt=8*Math.ceil(st.width*mt/8),vt=st.t273;(vt==null||st.t322)&&(vt=st.t324);var xt=st.t279;dt==1&&vt.length==1&&(xt=[st.height*(gt>>>3)]),(xt==null||st.t322)&&(xt=st.t325);var wt=new Uint8Array(st.height*(gt>>>3)),At=0;if(st.t322!=null){var Tt=st.t322[0],Pt=st.t323[0],Rt=Math.floor((st.width+Tt-1)/Tt),Ot=Math.floor((st.height+Pt-1)/Pt),Et=new Uint8Array(0|Math.ceil(Tt*Pt*mt/8));console.log("====",Rt,Ot);for(var Lt=0;Lt<Ot;Lt++)for(var kt=0;kt<Rt;kt++){var jt=Lt*Rt+kt;Et.fill(0),nt.decode._decompress(st,ot,lt,vt[jt],xt[jt],dt,Et,0,ut,Tt,Pt),dt==6?wt=Et:nt._copyTile(Et,0|Math.ceil(Tt*mt/8),Pt,wt,0|Math.ceil(st.width*mt/8),st.height,0|Math.ceil(kt*Tt*mt/8),Lt*Pt)}At=8*wt.length}else{if(vt==null)return;var Mt=st.t278?st.t278[0]:st.height;for(Mt=Math.min(Mt,st.height),jt=0;jt<vt.length;jt++)nt.decode._decompress(st,ot,lt,vt[jt],xt[jt],dt,wt,0|Math.ceil(At/8),ut,st.width,Mt),At+=gt*Mt;At=Math.min(At,8*wt.length)}st.data=new Uint8Array(wt.buffer,0,0|Math.ceil(At/8))}}},nt.decode._decompress=function(at,st,ot,lt,ht,dt,ut,ft,mt,gt,vt){if(at.t271&&at.t271[0]=="Panasonic"&&at.t45&&at.t45[0]==6&&(dt=34316),dt==1)for(var xt=0;xt<ht;xt++)ut[ft+xt]=ot[lt+xt];else if(dt==2)nt.decode._decodeG2(ot,lt,ht,ut,ft,gt,mt);else if(dt==3)nt.decode._decodeG3(ot,lt,ht,ut,ft,gt,mt,!!at.t292&&!(1&~at.t292[0]));else if(dt==4)nt.decode._decodeG4(ot,lt,ht,ut,ft,gt,mt);else if(dt==5)nt.decode._decodeLZW(ot,lt,ht,ut,ft,8);else if(dt==6)nt.decode._decodeOldJPEG(at,ot,lt,ht,ut,ft);else if(dt==7||dt==34892)nt.decode._decodeNewJPEG(at,ot,lt,ht,ut,ft);else if(dt==8||dt==32946){var wt=new Uint8Array(ot.buffer,lt+2,ht-6),At=it.inflateRaw(wt);ft+At.length<=ut.length&&ut.set(At,ft)}else dt==9?nt.decode._decodeVC5(ot,lt,ht,ut,ft,at.t33422):dt==32767?nt.decode._decodeARW(at,ot,lt,ht,ut,ft):dt==32773?nt.decode._decodePackBits(ot,lt,ht,ut,ft):dt==32809?nt.decode._decodeThunder(ot,lt,ht,ut,ft):dt==34316?nt.decode._decodePanasonic(at,ot,lt,ht,ut,ft):dt==34713?nt.decode._decodeNikon(at,st,ot,lt,ht,ut,ft):dt==34676?nt.decode._decodeLogLuv32(at,ot,lt,ht,ut,ft):rt("Unknown compression",dt);var Tt=at.t258?Math.min(32,at.t258[0]):1,Pt=at.t277?at.t277[0]:1,Rt=Tt*Pt>>>3,Ot=Math.ceil(Tt*Pt*gt/8);if(Tt==16&&!at.isLE&&at.t33422==null)for(var Et=0;Et<vt;Et++)for(var Lt=ft+Et*Ot,kt=1;kt<Ot;kt+=2){var jt=ut[Lt+kt];ut[Lt+kt]=ut[Lt+kt-1],ut[Lt+kt-1]=jt}if(at.t317&&at.t317[0]==2)for(Et=0;Et<vt;Et++){var Mt=ft+Et*Ot;if(Tt==16)for(xt=Rt;xt<Ot;xt+=2){var $t=(ut[Mt+xt+1]<<8|ut[Mt+xt])+(ut[Mt+xt-Rt+1]<<8|ut[Mt+xt-Rt]);ut[Mt+xt]=255&$t,ut[Mt+xt+1]=$t>>>8&255}else if(Pt==3)for(xt=3;xt<Ot;xt+=3)ut[Mt+xt]=ut[Mt+xt]+ut[Mt+xt-3]&255,ut[Mt+xt+1]=ut[Mt+xt+1]+ut[Mt+xt-2]&255,ut[Mt+xt+2]=ut[Mt+xt+2]+ut[Mt+xt-1]&255;else for(xt=Rt;xt<Ot;xt++)ut[Mt+xt]=ut[Mt+xt]+ut[Mt+xt-Rt]&255}},nt.decode._decodePanasonic=function(at,st,ot,lt,ht,dt){var ut,ft,mt,gt,vt,xt,wt,At,Tt=st.buffer,Pt=at.t2[0],Rt=at.t3[0],Ot=at.t10[0],Et=at.t45[0],Lt=0,kt=0,jt=0,Mt=0,$t=Et==6?new Uint32Array(18):new Uint8Array(16),Qt=[0,0],Ht=[0,0],qt=0,Bt=new Uint8Array(16384),Xt=new Uint16Array(ht.buffer);function Ft(Er){if(jt==0){var Ut=new Uint8Array(Tt,ot+kt+8184,8200),Kt=new Uint8Array(Tt,ot+kt,8184);Bt.set(Ut),Bt.set(Kt,Ut.length),kt+=16384}if(Et!=5)return(Bt[Mt=(jt=jt-Er&131071)>>3^16368]|Bt[Mt+1]<<8)>>(7&jt)&~(-1<<Er);for(ut=0;ut<16;ut++)$t[ut]=Bt[jt++],jt&=16383}function Wt(Er){return Bt[jt+15-Er]}function Yt(){Qt[0]=0,Qt[1]=0,Ht[0]=0,Ht[1]=0}if(Et==7)throw Et;if(Et==6){var zt=Ot==12,er=zt?function(){$t[0]=Wt(0)<<4|Wt(1)>>4,$t[1]=4095&((15&Wt(1))<<8|Wt(2)),$t[2]=Wt(3)>>6&3,$t[3]=(63&Wt(3))<<2|Wt(4)>>6,$t[4]=(63&Wt(4))<<2|Wt(5)>>6,$t[5]=(63&Wt(5))<<2|Wt(6)>>6,$t[6]=Wt(6)>>4&3,$t[7]=(15&Wt(6))<<4|Wt(7)>>4,$t[8]=(15&Wt(7))<<4|Wt(8)>>4,$t[9]=(15&Wt(8))<<4|Wt(9)>>4,$t[10]=Wt(9)>>2&3,$t[11]=(3&Wt(9))<<6|Wt(10)>>2,$t[12]=(3&Wt(10))<<6|Wt(11)>>2,$t[13]=(3&Wt(11))<<6|Wt(12)>>2,$t[14]=3&Wt(12),$t[15]=Wt(13),$t[16]=Wt(14),$t[17]=Wt(15),jt+=16,Mt=0}:function(){$t[0]=Wt(0)<<6|Wt(1)>>2,$t[1]=16383&((3&Wt(1))<<12|Wt(2)<<4|Wt(3)>>4),$t[2]=Wt(3)>>2&3,$t[3]=(3&Wt(3))<<8|Wt(4),$t[4]=Wt(5)<<2|Wt(6)>>6,$t[5]=(63&Wt(6))<<4|Wt(7)>>4,$t[6]=Wt(7)>>2&3,$t[7]=(3&Wt(7))<<8|Wt(8),$t[8]=Wt(9)<<2&1020|Wt(10)>>6,$t[9]=1023&(Wt(10)<<4|Wt(11)>>4),$t[10]=Wt(11)>>2&3,$t[11]=(3&Wt(11))<<8|Wt(12),$t[12]=1023&(Wt(13)<<2&1020|Wt(14)>>6),$t[13]=1023&(Wt(14)<<4|Wt(15)>>4),jt+=16,Mt=0},dr=zt?14:11,fr=zt?128:512,lr=zt?2048:8192,mr=zt?16383:65535,br=zt?4095:16383,Sr=Pt/dr,Ir=16*Sr,cr=zt?18:14;for(xt=0;xt<Rt-15;xt+=16){var Nt=Math.min(16,Rt-xt),pr=Ir*Nt;for(Bt=new Uint8Array(Tt,ot+Lt,pr),jt=0,Lt+=pr,At=0,wt=0;At<Nt;At++,wt=0){qt=(xt+At)*Pt;for(var rr=0;rr<Sr;rr++)for(er(),Yt(),mt=0,vt=0,ut=0;ut<dr;ut++){if(gt=1&ut,ut%3==2){var ar=Mt<cr?$t[Mt++]:0;ar==3&&(ar=4),vt=fr<<ar,mt=1<<ar}var nr=Mt<cr?$t[Mt++]:0;Qt[gt]?(nr*=mt,vt<lr&&Ht[gt]>vt&&(nr+=Ht[gt]-vt),Ht[gt]=nr):(Qt[gt]=nr,nr?Ht[gt]=nr:nr=Ht[gt]),Xt[qt+wt++]=nr-15<=mr?nr-15&mr:nr+2147483633>>31&br}}}}else if(Et==5){var ur=Ot==12?10:9;for(xt=0;xt<Rt;xt++)for(wt=0;wt<Pt;wt+=ur)Ft(0),Ot==12?(Xt[qt++]=((15&$t[1])<<8)+$t[0],Xt[qt++]=16*$t[2]+($t[1]>>4),Xt[qt++]=((15&$t[4])<<8)+$t[3],Xt[qt++]=16*$t[5]+($t[4]>>4),Xt[qt++]=((15&$t[7])<<8)+$t[6],Xt[qt++]=16*$t[8]+($t[7]>>4),Xt[qt++]=((15&$t[10])<<8)+$t[9],Xt[qt++]=16*$t[11]+($t[10]>>4),Xt[qt++]=((15&$t[13])<<8)+$t[12],Xt[qt++]=16*$t[14]+($t[13]>>4)):Ot==14&&(Xt[qt++]=$t[0]+((63&$t[1])<<8),Xt[qt++]=($t[1]>>6)+4*$t[2]+((15&$t[3])<<10),Xt[qt++]=($t[3]>>4)+16*$t[4]+((3&$t[5])<<12),Xt[qt++]=((252&$t[5])>>2)+($t[6]<<6),Xt[qt++]=$t[7]+((63&$t[8])<<8),Xt[qt++]=($t[8]>>6)+4*$t[9]+((15&$t[10])<<10),Xt[qt++]=($t[10]>>4)+16*$t[11]+((3&$t[12])<<12),Xt[qt++]=((252&$t[12])>>2)+($t[13]<<6),Xt[qt++]=$t[14]+((63&$t[15])<<8))}else{if(Et!=4)throw Et;for(xt=0;xt<Rt;xt++)for(wt=0;wt<Pt;wt++)gt=1&(ut=wt%14),ut==0&&Yt(),ut%3==2&&(mt=4>>3-Ft(2)),Ht[gt]?(ft=Ft(8))!=0&&(Qt[gt]-=128<<mt,(Qt[gt]<0||mt==4)&&(Qt[gt]&=~(-1<<mt)),Qt[gt]+=ft<<mt):(Ht[gt]=Ft(8),(Ht[gt]||ut>11)&&(Qt[gt]=Ht[gt]<<4|Ft(4))),Xt[qt++]=Qt[1&wt]}},nt.decode._decodeVC5=(function(){var at,st,ot,lt=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],ht=[3,3,3,3,2,2,2,1,1,1];function dt(At){var Tt=At[1],Pt=At[0][Tt>>>3]>>>7-(7&Tt)&1;return At[1]++,Pt}function ut(At,Tt){if(at==null){at={};for(var Pt=0;Pt<lt.length;Pt+=4)at[lt[Pt+1]]=lt.slice(Pt,Pt+4)}for(var Rt=dt(At),Ot=at[Rt];Ot==null;)Rt=Rt<<1|dt(At),Ot=at[Rt];var Et=Ot[3];Et!=0&&(Et=dt(At)==0?Et:-Et),Tt[0]=Ot[2],Tt[1]=Et}function ft(At,Tt){for(var Pt=0;Pt<Tt;Pt++)1&~At||At++,At>>>=1;return At}function mt(At,Tt){return At>>Tt}function gt(At,Tt,Pt,Rt,Ot,Et){Tt[Pt]=mt(mt(11*At[Ot]-4*At[Ot+Et]+At[Ot+Et+Et]+4,3)+At[Rt],1),Tt[Pt+Et]=mt(mt(5*At[Ot]+4*At[Ot+Et]-At[Ot+Et+Et]+4,3)-At[Rt],1)}function vt(At,Tt,Pt,Rt,Ot,Et){var Lt=At[Ot-Et]-At[Ot+Et],kt=At[Ot],jt=At[Rt];Tt[Pt]=mt(mt(Lt+4,3)+kt+jt,1),Tt[Pt+Et]=mt(mt(4-Lt,3)+kt-jt,1)}function xt(At,Tt,Pt,Rt,Ot,Et){Tt[Pt]=mt(mt(5*At[Ot]+4*At[Ot-Et]-At[Ot-Et-Et]+4,3)+At[Rt],1),Tt[Pt+Et]=mt(mt(11*At[Ot]-4*At[Ot-Et]+At[Ot-Et-Et]+4,3)-At[Rt],1)}function wt(At){return At=ot[At=At<0?0:At>4095?4095:At]>>>2}return function(At,Tt,Pt,Rt,Ot,Et){Rt=new Uint16Array(Rt.buffer);var Lt,kt,jt,Mt,$t,Qt,Ht,qt,Bt=Date.now(),Xt=nt._binBE,Ft=Tt+Pt;Tt+=4;for(var Wt=Et[0]==1;Tt<Ft;){var Yt=Xt.readShort(At,Tt),zt=Xt.readUshort(At,Tt+2);if(Tt+=4,Yt==12)Sr=zt;else if(Yt==20)Lt=zt;else if(Yt==21)kt=zt;else if(Yt==48)jt=zt;else if(Yt==53)Mt=zt;else if(Yt!=35){if(Yt==62)$t=zt;else if(Yt!=101){if(Yt==109)Qt=zt;else if(Yt!=84){if(Yt!=106){if(Yt!=107){if(Yt!=108){if(Yt!=102){if(Yt==104)Vn=zt;else if(Yt!=105){var er=Yt<0?-Yt:Yt,dr=65280&er,fr=0;if(24576&er&&(8192&er?(fr=65535&zt,fr+=(255&er)<<16):fr=65535&zt),24576&~er){if(er==16388)Tt+=4*fr;else if(dr!=8192&&dr!=8448&&dr!=9216)throw er.toString(16)}else{if(Ht==null){Ht=[];for(var lr=0;lr<4;lr++)Ht[lr]=new Int16Array((Lt>>>1)*(kt>>>1));for(qt=new Int16Array((Lt>>>1)*(kt>>>1)),st=new Int16Array(1024),lr=0;lr<1024;lr++){var mr=lr-512,br=Math.abs(mr),Sr=Math.floor(768*br*br*br/16581375)+br;st[lr]=Math.sign(mr)*Sr}for(ot=new Uint16Array(4096),lr=0;lr<4096;lr++){var Ir=lr,cr=65535*(Math.pow(113,Ir/4095)-1)/112;ot[lr]=Math.min(cr,65535)}}var Nt=Ht[$t],pr=ft(Lt,1+ht[jt]),rr=ft(kt,1+ht[jt]);if(jt==0)for(var ar=0;ar<rr;ar++)for(var nr=0;nr<pr;nr++){var ur=Tt+2*(ar*pr+nr);Nt[ar*(Lt>>>1)+nr]=At[ur]<<8|At[ur+1]}else{var Er=[At,8*Tt],Ut=[],Kt=0,or=pr*rr,hr=[0,0],kr=0;for(zt=0;Kt<or;)for(ut(Er,hr),kr=hr[0],zt=hr[1];kr>0;)Ut[Kt++]=zt,kr--;var Br=(jt-1)%3,Gn=Br!=1?pr:0,Xn=Br!=0?rr:0;for(ar=0;ar<rr;ar++){var Mn=(ar+Xn)*(Lt>>>1)+Gn,Kn=ar*pr;for(nr=0;nr<pr;nr++)Nt[Mn+nr]=st[Ut[Kn+nr]+512]*Mt}if(Br==2){var Vn=Lt>>>1,vi=2*pr,mi=2*rr;for(ar=0;ar<rr;ar++)for(nr=0;nr<vi;nr++){lr=2*ar*Vn+nr;var _i=rr*Vn+(pi=ar*Vn+nr);ar==0?gt(Nt,qt,lr,_i,pi,Vn):ar==rr-1?xt(Nt,qt,lr,_i,pi,Vn):vt(Nt,qt,lr,_i,pi,Vn)}var Ri=Nt;for(Nt=qt,qt=Ri,ar=0;ar<mi;ar++)for(nr=0;nr<pr;nr++){var pi;lr=ar*Vn+2*nr,_i=pr+(pi=ar*Vn+nr),nr==0?gt(Nt,qt,lr,_i,pi,1):nr==pr-1?xt(Nt,qt,lr,_i,pi,1):vt(Nt,qt,lr,_i,pi,1)}Ri=Nt,Nt=qt,qt=Ri;for(var Tr=[],qn=2-~~((jt-1)/3),_r=0;_r<3;_r++)Tr[_r]=Qt>>14-2*_r&3;var Rr=Tr[qn];if(Rr!=0)for(ar=0;ar<mi;ar++)for(nr=0;nr<vi;nr++)Nt[lr=ar*Vn+nr]=Nt[lr]<<Rr}}if(jt==9&&$t==3){var yr=Ht[0],Kr=Ht[1],Jr=Ht[2],Zt=Ht[3];for(ar=0;ar<kt;ar+=2)for(nr=0;nr<Lt;nr+=2){var Qr=ar*Lt+nr,Dr=yr[ur=(ar>>>1)*(Lt>>>1)+(nr>>>1)],Pr=Kr[ur]-2048,Hr=Jr[ur]-2048,qr=Zt[ur]-2048,bi=(Pr<<1)+Dr,ri=(Hr<<1)+Dr,yi=Dr+qr,Li=Dr-qr;Wt?(Rt[Qr]=wt(yi),Rt[Qr+1]=wt(ri),Rt[Qr+Lt]=wt(bi),Rt[Qr+Lt+1]=wt(Li)):(Rt[Qr]=wt(bi),Rt[Qr+1]=wt(yi),Rt[Qr+Lt]=wt(Li),Rt[Qr+Lt+1]=wt(ri))}}Tt+=4*fr}}}}}}}}}}console.log(Date.now()-Bt)}})(),nt.decode._decodeLogLuv32=function(at,st,ot,lt,ht,dt){for(var ut=at.width,ft=4*ut,mt=0,gt=new Uint8Array(ft);mt<lt;){for(var vt=0;vt<ft;){var xt=st[ot+mt];if(mt++,xt<128){for(var wt=0;wt<xt;wt++)gt[vt+wt]=st[ot+mt+wt];vt+=xt,mt+=xt}else{for(xt-=126,wt=0;wt<xt;wt++)gt[vt+wt]=st[ot+mt];vt+=xt,mt++}}for(var At=0;At<ut;At++)ht[dt+0]=gt[At],ht[dt+1]=gt[At+ut],ht[dt+2]=gt[At+2*ut],ht[dt+4]=gt[At+3*ut],dt+=6}},nt.decode._ljpeg_diff=function(at,st,ot){var lt,ht,dt=nt.decode._getbithuff;return lt=dt(at,st,ot[0],ot),(ht=dt(at,st,lt,0))&1<<lt-1||(ht-=(1<<lt)-1),ht},nt.decode._decodeARW=function(at,st,ot,lt,ht,dt){var ut=at.t256[0],ft=at.t257[0],mt=at.t258[0],gt=at.isLE?nt._binLE:nt._binBE;if(ut*ft==lt||ut*ft*1.5==lt)if(ut*ft*1.5!=lt){var vt,xt,wt,At,Tt,Pt,Rt,Ot,Et=new Uint16Array(16),Lt=new Uint8Array(ut+1);for(Bt=0;Bt<ft;Bt++){for(var kt=0;kt<ut;kt++)Lt[kt]=st[ot++];for(Ot=0,qt=0;qt<ut-30;Ot+=16){for(xt=2047&(vt=gt.readUint(Lt,Ot)),wt=2047&vt>>>11,At=15&vt>>>22,Tt=15&vt>>>26,Pt=0;Pt<4&&128<<Pt<=xt-wt;Pt++);for(Rt=30,jt=0;jt<16;jt++)jt==At?Et[jt]=xt:jt==Tt?Et[jt]=wt:(Et[jt]=((gt.readUshort(Lt,Ot+(Rt>>3))>>>(7&Rt)&127)<<Pt)+wt,Et[jt]>2047&&(Et[jt]=2047),Rt+=7);for(jt=0;jt<16;jt++,qt+=2)fr=Et[jt]<<1,nt.decode._putsF(ht,(Bt*ut+qt)*mt,fr<<16-mt);qt-=1&qt?1:31}}}else for(var jt=0;jt<lt;jt+=3){var Mt=st[ot+jt+0],$t=st[ot+jt+1],Qt=st[ot+jt+2];ht[dt+jt]=$t<<4|Mt>>>4,ht[dt+jt+1]=Mt<<4|Qt>>>4,ht[dt+jt+2]=Qt<<4|$t>>>4}else{ft+=8;var Ht,qt,Bt,Xt=[ot,0,0,0],Ft=new Uint16Array(32770),Wt=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],Yt=0,zt=nt.decode._ljpeg_diff;for(Ft[0]=15,Ht=jt=0;jt<18;jt++)for(var er=32768>>>(Wt[jt]>>>8),dr=0;dr<er;dr++)Ft[++Ht]=Wt[jt];for(qt=ut;qt--;)for(Bt=0;Bt<ft+1;Bt+=2)if(Bt==ft&&(Bt=1),Yt+=zt(st,Xt,Ft),Bt<ft){var fr=4095&Yt;nt.decode._putsF(ht,(Bt*ut+qt)*mt,fr<<16-mt)}}},nt.decode._decodeNikon=function(at,st,ot,lt,ht,dt,ut){var ft=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],mt=at.t256[0],gt=at.t257[0],vt=at.t258[0],xt=0,wt=0,At=nt.decode._make_decoder,Tt=nt.decode._getbithuff,Pt=st[0].exifIFD.makerNote,Rt=Pt.t150?Pt.t150:Pt.t140,Ot=0,Et=Rt[Ot++],Lt=Rt[Ot++];Et!=73&&Lt!=88||(Ot+=2110),Et==70&&(xt=2),vt==14&&(xt+=3);for(var kt=[[0,0],[0,0]],jt=at.isLE?nt._binLE:nt._binBE,Mt=0;Mt<2;Mt++)for(var $t=0;$t<2;$t++)kt[Mt][$t]=jt.readShort(Rt,Ot),Ot+=2;var Qt,Ht,qt,Bt,Xt,Ft=1<<vt&32767,Wt=0,Yt=jt.readShort(Rt,Ot);Ot+=2,Yt>1&&(Wt=Math.floor(Ft/(Yt-1))),Et==68&&Lt==32&&Wt>0&&(wt=jt.readShort(Rt,562));var zt=[0,0],er=At(ft[xt]),dr=[lt,0,0,0];for(Qt=0;Qt<gt;Qt++)for(wt&&Qt==wt&&(er=At(ft[xt+1])),Ht=0;Ht<mt;Ht++){Mt=Tt(ot,dr,er[0],er),(Xt=1+(Tt(ot,dr,(qt=15&Mt)-(Bt=Mt>>>4),0)<<1)<<Bt>>>1)&1<<qt-1||(Xt-=(1<<qt)-(Bt==0?1:0)),Ht<2?zt[Ht]=kt[1&Qt][Ht]+=Xt:zt[1&Ht]+=Xt;var fr=Math.min(Math.max(zt[1&Ht],0),(1<<vt)-1),lr=(Qt*mt+Ht)*vt;nt.decode._putsF(dt,lr,fr<<16-vt)}},nt.decode._putsF=function(at,st,ot){ot<<=8-(7&st);var lt=st>>>3;at[lt]|=ot>>>16,at[lt+1]|=ot>>>8,at[lt+2]|=ot},nt.decode._getbithuff=function(at,st,ot,lt){var ht;nt.decode._get_byte;var dt=st[0],ut=st[1],ft=st[2],mt=st[3];if(ot==0||ft<0)return 0;for(;!mt&&ft<ot&&(ht=at[dt++])!=-1&&!(mt=0);)ut=(ut<<8)+ht,ft+=8;if(ht=ut<<32-ft>>>32-ot,lt?(ft-=lt[ht+1]>>>8,ht=255&lt[ht+1]):ft-=ot,ft<0)throw"e";return st[0]=dt,st[1]=ut,st[2]=ft,st[3]=mt,ht},nt.decode._make_decoder=function(at){var st,ot,lt,ht,dt,ut=[];for(st=16;st!=0&&!at[st];st--);var ft=17;for(ut[0]=st,lt=ot=1;ot<=st;ot++)for(ht=0;ht<at[ot];ht++,++ft)for(dt=0;dt<1<<st-ot;dt++)lt<=1<<st&&(ut[lt++]=ot<<8|at[ft]);return ut},nt.decode._decodeNewJPEG=function(at,st,ot,lt,ht,dt){lt=Math.min(lt,st.length-ot);var ut=at.t347,ft=ut?ut.length:0,mt=new Uint8Array(ft+lt);if(ut){for(var gt=0,vt=0;vt<ft-1&&(ut[vt]!=255||ut[vt+1]!=217);vt++)mt[gt++]=ut[vt];var xt=st[ot],wt=st[ot+1];for(xt==255&&wt==216||(mt[gt++]=xt,mt[gt++]=wt),vt=2;vt<lt;vt++)mt[gt++]=st[ot+vt]}else for(vt=0;vt<lt;vt++)mt[vt]=st[ot+vt];if(at.t262[0]==32803||at.t259[0]==7&&at.t262[0]==34892){var At=at.t258[0],Tt=nt.LosslessJpegDecode(mt),Pt=Tt.length;if(At==16)if(at.isLE)for(vt=0;vt<Pt;vt++)ht[dt+(vt<<1)]=255&Tt[vt],ht[dt+(vt<<1)+1]=Tt[vt]>>>8;else for(vt=0;vt<Pt;vt++)ht[dt+(vt<<1)]=Tt[vt]>>>8,ht[dt+(vt<<1)+1]=255&Tt[vt];else if(At==14||At==12||At==10){var Rt=16-At;for(vt=0;vt<Pt;vt++)nt.decode._putsF(ht,vt*At,Tt[vt]<<Rt)}else{if(At!=8)throw new Error("unsupported bit depth "+At);for(vt=0;vt<Pt;vt++)ht[dt+vt]=Tt[vt]}}else{var Ot=new nt.JpegDecoder;Ot.parse(mt);var Et=Ot.getData({width:Ot.width,height:Ot.height,forceRGB:!0,isSourcePDF:!1});for(vt=0;vt<Et.length;vt++)ht[dt+vt]=Et[vt]}at.t262[0]==6&&(at.t262[0]=2)},nt.decode._decodeOldJPEGInit=function(at,st,ot,lt){var ht,dt,ut,ft,mt,gt=216,vt=0,xt=0,wt=!1,At=at.t513,Tt=At?At[0]:0,Pt=at.t514,Rt=Pt?Pt[0]:0,Ot=at.t324||at.t273||At,Et=at.t530,Lt=0,kt=0,jt=at.t277?at.t277[0]:1,Mt=at.t515;if(Ot&&(xt=Ot[0],wt=Ot.length>1),!wt){if(st[ot]==255&&st[ot+1]==gt)return{jpegOffset:ot};if(At!=null&&(st[ot+Tt]==255&&st[ot+Tt+1]==gt?vt=ot+Tt:rt("JPEGInterchangeFormat does not point to SOI"),Pt==null?rt("JPEGInterchangeFormatLength field is missing"):(Tt>=xt||Tt+Rt<=xt)&&rt("JPEGInterchangeFormatLength field value is invalid"),vt!=null))return{jpegOffset:vt}}if(Et!=null&&(Lt=Et[0],kt=Et[1]),At!=null&&Pt!=null)if(Rt>=2&&Tt+Rt<=xt){for(ht=st[ot+Tt+Rt-2]==255&&st[ot+Tt+Rt-1]==gt?new Uint8Array(Rt-2):new Uint8Array(Rt),ut=0;ut<ht.length;ut++)ht[ut]=st[ot+Tt+ut];rt("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else rt("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(ht==null){var $t=0,Qt=[];Qt[$t++]=255,Qt[$t++]=gt;var Ht=at.t519;if(Ht==null)throw new Error("JPEGQTables tag is missing");for(ut=0;ut<Ht.length;ut++)for(Qt[$t++]=255,Qt[$t++]=219,Qt[$t++]=0,Qt[$t++]=67,Qt[$t++]=ut,ft=0;ft<64;ft++)Qt[$t++]=st[ot+Ht[ut]+ft];for(mt=0;mt<2;mt++){var qt=at[mt==0?"t520":"t521"];if(qt==null)throw new Error((mt==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(ut=0;ut<qt.length;ut++){Qt[$t++]=255,Qt[$t++]=196;var Bt=19;for(ft=0;ft<16;ft++)Bt+=st[ot+qt[ut]+ft];for(Qt[$t++]=Bt>>>8,Qt[$t++]=255&Bt,Qt[$t++]=ut|mt<<4,ft=0;ft<16;ft++)Qt[$t++]=st[ot+qt[ut]+ft];for(ft=0;ft<Bt;ft++)Qt[$t++]=st[ot+qt[ut]+16+ft]}}if(Qt[$t++]=255,Qt[$t++]=192,Qt[$t++]=0,Qt[$t++]=8+3*jt,Qt[$t++]=8,Qt[$t++]=at.height>>>8&255,Qt[$t++]=255&at.height,Qt[$t++]=at.width>>>8&255,Qt[$t++]=255&at.width,Qt[$t++]=jt,jt==1)Qt[$t++]=1,Qt[$t++]=17,Qt[$t++]=0;else for(ut=0;ut<3;ut++)Qt[$t++]=ut+1,Qt[$t++]=ut!=0?17:(15&Lt)<<4|15&kt,Qt[$t++]=ut;Mt!=null&&Mt[0]!=0&&(Qt[$t++]=255,Qt[$t++]=221,Qt[$t++]=0,Qt[$t++]=4,Qt[$t++]=Mt[0]>>>8&255,Qt[$t++]=255&Mt[0]),ht=new Uint8Array(Qt)}var Xt=-1;for(ut=0;ut<ht.length-1;){if(ht[ut]==255&&ht[ut+1]==192){Xt=ut;break}ut++}if(Xt==-1){var Ft=new Uint8Array(ht.length+10+3*jt);Ft.set(ht);var Wt=ht.length;if(Xt=ht.length,(ht=Ft)[Wt++]=255,ht[Wt++]=192,ht[Wt++]=0,ht[Wt++]=8+3*jt,ht[Wt++]=8,ht[Wt++]=at.height>>>8&255,ht[Wt++]=255&at.height,ht[Wt++]=at.width>>>8&255,ht[Wt++]=255&at.width,ht[Wt++]=jt,jt==1)ht[Wt++]=1,ht[Wt++]=17,ht[Wt++]=0;else for(ut=0;ut<3;ut++)ht[Wt++]=ut+1,ht[Wt++]=ut!=0?17:(15&Lt)<<4|15&kt,ht[Wt++]=ut}if(st[xt]==255&&st[xt+1]==218){var Yt=st[xt+2]<<8|st[xt+3];for((dt=new Uint8Array(Yt+2))[0]=st[xt],dt[1]=st[xt+1],dt[2]=st[xt+2],dt[3]=st[xt+3],ut=0;ut<Yt-2;ut++)dt[ut+4]=st[xt+ut+4]}else{var zt=0;if((dt=new Uint8Array(8+2*jt))[zt++]=255,dt[zt++]=218,dt[zt++]=0,dt[zt++]=6+2*jt,dt[zt++]=jt,jt==1)dt[zt++]=1,dt[zt++]=0;else for(ut=0;ut<3;ut++)dt[zt++]=ut+1,dt[zt++]=ut<<4|ut;dt[zt++]=0,dt[zt++]=63,dt[zt++]=0}return{jpegOffset:ot,tables:ht,sosMarker:dt,sofPosition:Xt}},nt.decode._decodeOldJPEG=function(at,st,ot,lt,ht,dt){var ut,ft,mt,gt,vt=nt.decode._decodeOldJPEGInit(at,st,ot,lt);if(vt.jpegOffset!=null)for(ut=ot+lt-vt.jpegOffset,mt=new Uint8Array(ut),At=0;At<ut;At++)mt[At]=st[vt.jpegOffset+At];else{for(ft=vt.tables.length,(mt=new Uint8Array(ft+vt.sosMarker.length+lt+2)).set(vt.tables),gt=ft,mt[vt.sofPosition+5]=at.height>>>8&255,mt[vt.sofPosition+6]=255&at.height,mt[vt.sofPosition+7]=at.width>>>8&255,mt[vt.sofPosition+8]=255&at.width,st[ot]==255&&st[ot+1]==SOS||(mt.set(vt.sosMarker,gt),gt+=sosMarker.length),At=0;At<lt;At++)mt[gt++]=st[ot+At];mt[gt++]=255,mt[gt++]=EOI}var xt=new nt.JpegDecoder;xt.parse(mt);for(var wt=xt.getData({width:xt.width,height:xt.height,forceRGB:!0,isSourcePDF:!1}),At=0;At<wt.length;At++)ht[dt+At]=wt[At];at.t262&&at.t262[0]==6&&(at.t262[0]=2)},nt.decode._decodePackBits=function(at,st,ot,lt,ht){for(var dt=new Int8Array(at.buffer),ut=new Int8Array(lt.buffer),ft=st+ot;st<ft;){var mt=dt[st];if(st++,mt>=0&&mt<128)for(var gt=0;gt<mt+1;gt++)ut[ht]=dt[st],ht++,st++;if(mt>=-127&&mt<0){for(gt=0;gt<1-mt;gt++)ut[ht]=dt[st],ht++;st++}}return ht},nt.decode._decodeThunder=function(at,st,ot,lt,ht){for(var dt=[0,1,0,-1],ut=[0,1,2,3,0,-3,-2,-1],ft=st+ot,mt=2*ht,gt=0;st<ft;){var vt=at[st],xt=vt>>>6,wt=63&vt;if(st++,xt==3&&(gt=15&wt,lt[mt>>>1]|=gt<<4*(1-mt&1),mt++),xt==0)for(var At=0;At<wt;At++)lt[mt>>>1]|=gt<<4*(1-mt&1),mt++;if(xt==2)for(At=0;At<2;At++)(Tt=wt>>>3*(1-At)&7)!=4&&(gt+=ut[Tt],lt[mt>>>1]|=gt<<4*(1-mt&1),mt++);if(xt==1)for(At=0;At<3;At++){var Tt;(Tt=wt>>>2*(2-At)&3)!=2&&(gt+=dt[Tt],lt[mt>>>1]|=gt<<4*(1-mt&1),mt++)}}},nt.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},nt.decode._lens=(function(){var at=function(mt,gt,vt,xt){for(var wt=0;wt<gt.length;wt++)mt[gt[wt]]=vt+wt*xt},st="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",ot="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",lt="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",ht="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",dt="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";st=st.split(","),ot=ot.split(","),lt=lt.split(","),ht=ht.split(","),dt=dt.split(",");var ut={},ft={};return at(ut,st,0,1),at(ut,lt,64,64),at(ut,dt,1792,64),at(ft,ot,0,1),at(ft,ht,64,64),at(ft,dt,1792,64),[ut,ft]})(),nt.decode._decodeG4=function(at,st,ot,lt,ht,dt,ut){for(var ft=nt.decode,mt=st<<3,gt=0,vt="",xt=[],wt=[],At=0;At<dt;At++)wt.push(0);wt=ft._makeDiff(wt);for(var Tt=0,Pt=0,Rt=0,Ot=0,Et=0,Lt=0,kt="",jt=0,Mt=8*Math.ceil(dt/8);mt>>>3<st+ot;){Rt=ft._findDiff(wt,Tt+(Tt==0?0:1),1-Et),Ot=ft._findDiff(wt,Rt,Et);var $t=0;if(ut==1&&($t=at[mt>>>3]>>>7-(7&mt)&1),ut==2&&($t=at[mt>>>3]>>>(7&mt)&1),mt++,vt+=$t,kt=="H"){if(ft._lens[Et][vt]!=null){var Qt=ft._lens[Et][vt];vt="",gt+=Qt,Qt<64&&(ft._addNtimes(xt,gt,Et),Tt+=gt,Et=1-Et,gt=0,--jt==0&&(kt=""))}}else vt=="0001"&&(vt="",ft._addNtimes(xt,Ot-Tt,Et),Tt=Ot),vt=="001"&&(vt="",kt="H",jt=2),ft._dmap[vt]!=null&&(Pt=Rt+ft._dmap[vt],ft._addNtimes(xt,Pt-Tt,Et),Tt=Pt,vt="",Et=1-Et);xt.length==dt&&kt==""&&(ft._writeBits(xt,lt,8*ht+Lt*Mt),Et=0,Lt++,Tt=0,wt=ft._makeDiff(xt),xt=[])}},nt.decode._findDiff=function(at,st,ot){for(var lt=0;lt<at.length;lt+=2)if(at[lt]>=st&&at[lt+1]==ot)return at[lt]},nt.decode._makeDiff=function(at){var st=[];at[0]==1&&st.push(0,1);for(var ot=1;ot<at.length;ot++)at[ot-1]!=at[ot]&&st.push(ot,at[ot]);return st.push(at.length,0,at.length,1),st},nt.decode._decodeG2=function(at,st,ot,lt,ht,dt,ut){for(var ft=nt.decode,mt=st<<3,gt=0,vt="",xt=[],wt=0,At=0,Tt=8*Math.ceil(dt/8);mt>>>3<st+ot;){var Pt=0;ut==1&&(Pt=at[mt>>>3]>>>7-(7&mt)&1),ut==2&&(Pt=at[mt>>>3]>>>(7&mt)&1),mt++,vt+=Pt,(gt=ft._lens[wt][vt])!=null&&(ft._addNtimes(xt,gt,wt),vt="",gt<64&&(wt=1-wt),xt.length==dt&&(ft._writeBits(xt,lt,8*ht+At*Tt),xt=[],At++,wt=0,7&mt&&(mt+=8-(7&mt)),gt>=64&&(mt+=8)))}},nt.decode._decodeG3=function(at,st,ot,lt,ht,dt,ut,ft){for(var mt=nt.decode,gt=st<<3,vt=0,xt="",wt=[],At=[],Tt=0;Tt<dt;Tt++)wt.push(0);for(var Pt=0,Rt=0,Ot=0,Et=0,Lt=0,kt=-1,jt="",Mt=0,$t=!0,Qt=8*Math.ceil(dt/8);gt>>>3<st+ot;){Ot=mt._findDiff(At,Pt+(Pt==0?0:1),1-Lt),Et=mt._findDiff(At,Ot,Lt);var Ht=0;if(ut==1&&(Ht=at[gt>>>3]>>>7-(7&gt)&1),ut==2&&(Ht=at[gt>>>3]>>>(7&gt)&1),gt++,xt+=Ht,$t){if(mt._lens[Lt][xt]!=null){var qt=mt._lens[Lt][xt];xt="",vt+=qt,qt<64&&(mt._addNtimes(wt,vt,Lt),Lt=1-Lt,vt=0)}}else jt=="H"?mt._lens[Lt][xt]!=null&&(qt=mt._lens[Lt][xt],xt="",vt+=qt,qt<64&&(mt._addNtimes(wt,vt,Lt),Pt+=vt,Lt=1-Lt,vt=0,--Mt==0&&(jt=""))):(xt=="0001"&&(xt="",mt._addNtimes(wt,Et-Pt,Lt),Pt=Et),xt=="001"&&(xt="",jt="H",Mt=2),mt._dmap[xt]!=null&&(Rt=Ot+mt._dmap[xt],mt._addNtimes(wt,Rt-Pt,Lt),Pt=Rt,xt="",Lt=1-Lt));xt.endsWith("000000000001")&&(kt>=0&&mt._writeBits(wt,lt,8*ht+kt*Qt),ft&&(ut==1&&($t=(at[gt>>>3]>>>7-(7&gt)&1)==1),ut==2&&($t=(at[gt>>>3]>>>(7&gt)&1)==1),gt++),xt="",Lt=0,kt++,Pt=0,At=mt._makeDiff(wt),wt=[])}wt.length==dt&&mt._writeBits(wt,lt,8*ht+kt*Qt)},nt.decode._addNtimes=function(at,st,ot){for(var lt=0;lt<st;lt++)at.push(ot)},nt.decode._writeBits=function(at,st,ot){for(var lt=0;lt<at.length;lt++)st[ot+lt>>>3]|=at[lt]<<7-(ot+lt&7)},nt.decode._decodeLZW=nt.decode._decodeLZW=(function(){var at,st,ot,lt,ht=0,dt=0,ut=0,ft=0,mt=function(){var Tt=at>>>3,Pt=(st[Tt]<<16|st[Tt+1]<<8|st[Tt+2])>>>24-(7&at)-dt&(1<<dt)-1;return at+=dt,Pt},gt=new Uint32Array(16384),vt=0,xt=function(Tt){dt=Tt+1,ht=ft+1},wt=function(Tt){for(var Pt=Tt<<2,Rt=gt[Pt+2],Ot=lt+Rt-1;Pt!=65535;)ot[Ot--]=gt[Pt],Pt=gt[Pt+1];lt+=Rt},At=function(Tt,Pt){var Rt=ht<<2,Ot=Tt<<2;gt[Rt]=gt[3+(Pt<<2)],gt[Rt+1]=Ot,gt[Rt+2]=gt[Ot+2]+1,gt[Rt+3]=gt[Ot+3],++ht+1==1<<dt&&dt!=12&&dt++};return function(Tt,Pt,Rt,Ot,Et,Lt){at=Pt<<3,st=Tt,ot=Ot,lt=Et;var kt=Pt+Rt<<3,jt=0,Mt=0;for((function($t){if($t!=vt){vt=$t,ft=1+(ut=1<<$t);for(var Qt=0;Qt<ft+1;Qt++)gt[4*Qt]=gt[4*Qt+3]=Qt,gt[4*Qt+1]=65535,gt[4*Qt+2]=1}})(Lt),xt(Lt);at<kt&&(jt=mt())!=ft;){if(jt==ut){if(xt(Lt),(jt=mt())==ft)break;wt(jt)}else jt<ht?(wt(jt),At(Mt,jt)):(At(Mt,Mt),wt(ht-1));Mt=jt}return lt}})(),nt.tags={},nt._types=(function(){var at=new Array(250);return at.fill(0),{basic:{main:at=at.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}})(),nt._readIFD=function(at,st,ot,lt,ht,dt){var ut=at.readUshort(st,ot);ot+=2;var ft={};dt.debug&&rt("   ".repeat(ht),lt.length-1,">>>----------------");for(var mt=0;mt<ut;mt++){var gt=at.readUshort(st,ot);ot+=2;var vt=at.readUshort(st,ot);ot+=2;var xt=at.readUint(st,ot);ot+=4;var wt=at.readUint(st,ot);ot+=4;var At=[];if(vt==1||vt==7){var Tt=xt<5?ot-4:wt;Tt+xt>st.buffer.byteLength&&(xt=st.buffer.byteLength-Tt),At=new Uint8Array(st.buffer,Tt,xt)}if(vt==2){var Pt=xt<5?ot-4:wt,Rt=st[Pt],Ot=Math.max(0,Math.min(xt-1,st.length-Pt));Rt<128||Ot==0?At.push(at.readASCII(st,Pt,Ot)):At=new Uint8Array(st.buffer,Pt,Ot)}if(vt==3)for(var Et=0;Et<xt;Et++)At.push(at.readUshort(st,(xt<3?ot-4:wt)+2*Et));if(vt==4||vt==13)for(Et=0;Et<xt;Et++)At.push(at.readUint(st,(xt<2?ot-4:wt)+4*Et));if(vt==5||vt==10){var Lt=vt==5?at.readUint:at.readInt;for(Et=0;Et<xt;Et++)At.push([Lt(st,wt+8*Et),Lt(st,wt+8*Et+4)])}if(vt==8)for(Et=0;Et<xt;Et++)At.push(at.readShort(st,(xt<3?ot-4:wt)+2*Et));if(vt==9)for(Et=0;Et<xt;Et++)At.push(at.readInt(st,(xt<2?ot-4:wt)+4*Et));if(vt==11)for(Et=0;Et<xt;Et++)At.push(at.readFloat(st,wt+4*Et));if(vt==12)for(Et=0;Et<xt;Et++)At.push(at.readDouble(st,wt+8*Et));if(xt==0||At.length!=0){if(dt.debug&&rt("   ".repeat(ht),gt,vt,nt.tags[gt],At),ft["t"+gt]=At,!(gt==330&&ft.t272&&ft.t272[0]=="DSLR-A100")){if(gt==330||gt==34665||gt==34853||gt==50740&&at.readUshort(st,at.readUint(At,0))<300||gt==61440){var kt=gt==50740?[at.readUint(At,0)]:At,jt=[];for(Et=0;Et<kt.length;Et++)nt._readIFD(at,st,kt[Et],jt,ht+1,dt);gt==330&&(ft.subIFD=jt),gt==34665&&(ft.exifIFD=jt[0]),gt==34853&&(ft.gpsiIFD=jt[0]),gt==50740&&(ft.dngPrvt=jt[0]),gt==61440&&(ft.fujiIFD=jt[0])}}if(gt==37500&&dt.parseMN){var Mt=At;if(at.readASCII(Mt,0,5)=="Nikon")ft.makerNote=nt.decode(Mt.slice(10).buffer)[0];else if(at.readASCII(Mt,0,5)=="OLYMP"||at.readASCII(Mt,0,9)=="OM SYSTEM"){var $t=[8208,8224,8240,8256,8272],Qt=[];nt._readIFD(at,Mt,Mt[1]==77?16:Mt[5]==85?12:8,Qt,ht+1,dt);var Ht=ft.makerNote=Qt.pop();for(Et=0;Et<$t.length;Et++){var qt="t"+$t[Et];Ht[qt]!=null&&(nt._readIFD(at,Mt,Ht[qt][0],Qt,ht+1,dt),Ht[qt]=Qt.pop())}Ht.t12288&&(nt._readIFD(at,Ht.t12288,0,Qt,ht+1,dt),Ht.t12288=Qt.pop())}else at.readUshort(st,wt)<300&&at.readUshort(st,wt+4)<=12&&(Qt=[],nt._readIFD(at,st,wt,Qt,ht+1,dt),ft.makerNote=Qt[0])}}else if(rt(gt,"unknown TIFF tag type: ",vt,"num:",xt),mt==0)return}return lt.push(ft),dt.debug&&rt("   ".repeat(ht),"<<<---------------"),ot},nt._writeIFD=function(at,st,ot,lt,ht){var dt=Object.keys(ht),ut=dt.length;ht.exifIFD&&ut--,ht.gpsiIFD&&ut--,at.writeUshort(ot,lt,ut);for(var ft=(lt+=2)+12*ut+4,mt=0;mt<dt.length;mt++){var gt=dt[mt];if(gt!="t34665"&&gt!="t34853"){gt=="exifIFD"&&(gt="t34665"),gt=="gpsiIFD"&&(gt="t34853");var vt=parseInt(gt.slice(1)),xt=st.main[vt];if(xt==null&&(xt=st.rest[vt]),xt==null||xt==0)throw new Error("unknown type of tag: "+vt);var wt=ht[gt];vt==34665&&(wt=[ft],ft=nt._writeIFD(at,st,ot,ft,ht.exifIFD)[1]),vt==34853&&(wt=[ft],ft=nt._writeIFD(at,nt._types.gps,ot,ft,ht.gpsiIFD)[1]),xt==2&&(wt=wt[0]+"\0");var At=wt.length;at.writeUshort(ot,lt,vt),lt+=2,at.writeUshort(ot,lt,xt),lt+=2,at.writeUint(ot,lt,At);var Tt=[-1,1,1,2,4,8,0,1,0,4,8,0,8][xt]*At,Pt=lt+=4;if(Tt>4&&(at.writeUint(ot,lt,ft),Pt=ft),xt==1||xt==7)for(var Rt=0;Rt<At;Rt++)ot[Pt+Rt]=wt[Rt];else if(xt==2)at.writeASCII(ot,Pt,wt);else if(xt==3)for(Rt=0;Rt<At;Rt++)at.writeUshort(ot,Pt+2*Rt,wt[Rt]);else if(xt==4)for(Rt=0;Rt<At;Rt++)at.writeUint(ot,Pt+4*Rt,wt[Rt]);else if(xt==5||xt==10){var Ot=xt==5?at.writeUint:at.writeInt;for(Rt=0;Rt<At;Rt++){var Et=wt[Rt],Lt=Et[0],kt=Et[1];if(Lt==null)throw"e";Ot(ot,Pt+8*Rt,Lt),Ot(ot,Pt+8*Rt+4,kt)}}else if(xt==9)for(Rt=0;Rt<At;Rt++)at.writeInt(ot,Pt+4*Rt,wt[Rt]);else{if(xt!=12)throw xt;for(Rt=0;Rt<At;Rt++)at.writeDouble(ot,Pt+8*Rt,wt[Rt])}Tt>4&&(ft+=Tt+=1&Tt),lt+=4}}return[lt,ft]},nt.toRGBA8=function(at,st){function ot(Gn){return Gn<.0031308?12.92*Gn:1.055*Math.pow(Gn,1/2.4)-.055}var lt=at.width,ht=at.height,dt=lt*ht,ut=at.data,ft=new Uint8Array(4*dt),mt=at.t262?at.t262[0]:2,gt=at.t258?Math.min(32,at.t258[0]):1;at.t262==null&&gt==1&&(mt=0);var vt=at.t277?at.t277[0]:at.t258?at.t258.length:[1,1,3,1,1,4,3][mt],xt=at.t339?at.t339[0]:null;if(mt==1&&gt==32&&xt!=3)throw"e";var wt=Math.ceil(vt*gt*lt/8);if(mt==0){st=1/256;for(var At=0;At<ht;At++){var Tt=At*wt,Pt=At*lt;if(gt==1)for(var Rt=0;Rt<lt;Rt++){var Ot=Pt+Rt<<2,Et=ut[Tt+(Rt>>3)]>>7-(7&Rt)&1;ft[Ot]=ft[Ot+1]=ft[Ot+2]=255*(1-Et),ft[Ot+3]=255}if(gt==4)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[Tt+(Rt>>1)]>>4-4*(1&Rt)&15,ft[Ot]=ft[Ot+1]=ft[Ot+2]=17*(15-Et),ft[Ot+3]=255;if(gt==8)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[Tt+Rt],ft[Ot]=ft[Ot+1]=ft[Ot+2]=255-Et,ft[Ot+3]=255;if(gt==16)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[(kt=Tt+2*Rt)+1]<<8|ut[kt],ft[Ot]=ft[Ot+1]=ft[Ot+2]=Math.min(255,255-~~(Et*st)),ft[Ot+3]=255}}else if(mt==1){st==null&&(st=1/256);var Lt=3&ut.length?null:new Float32Array(ut.buffer);for(At=0;At<ht;At++){if(Tt=At*wt,Pt=At*lt,gt==1)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[Tt+(Rt>>3)]>>7-(7&Rt)&1,ft[Ot]=ft[Ot+1]=ft[Ot+2]=255*Et,ft[Ot+3]=255;if(gt==2)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[Tt+(Rt>>2)]>>6-2*(3&Rt)&3,ft[Ot]=ft[Ot+1]=ft[Ot+2]=85*Et,ft[Ot+3]=255;if(gt==8)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[Tt+Rt*vt],ft[Ot]=ft[Ot+1]=ft[Ot+2]=Et,ft[Ot+3]=255;if(gt==16)for(Rt=0;Rt<lt;Rt++)Ot=Pt+Rt<<2,Et=ut[(kt=Tt+2*Rt)+1]<<8|ut[kt],ft[Ot]=ft[Ot+1]=ft[Ot+2]=Math.min(255,~~(Et*st)),ft[Ot+3]=255;if(gt==32)for(Rt=0;Rt<lt;Rt++){var kt;Ot=Pt+Rt<<2,Et=Lt[kt=(Tt>>>2)+Rt],ft[Ot]=ft[Ot+1]=ft[Ot+2]=~~(.5+255*Et),ft[Ot+3]=255}}}else if(mt==2)if(gt==8){if(vt==1)for(Rt=0;Rt<dt;Rt++)ft[4*Rt]=ft[4*Rt+1]=ft[4*Rt+2]=ut[Rt],ft[4*Rt+3]=255;if(vt==3)for(Rt=0;Rt<dt;Rt++){var jt=3*Rt;ft[Ot=Rt<<2]=ut[jt],ft[Ot+1]=ut[jt+1],ft[Ot+2]=ut[jt+2],ft[Ot+3]=255}if(vt>=4)for(Rt=0;Rt<dt;Rt++)jt=Rt*vt,ft[Ot=Rt<<2]=ut[jt],ft[Ot+1]=ut[jt+1],ft[Ot+2]=ut[jt+2],ft[Ot+3]=ut[jt+3]}else if(gt==16){if(vt==4)for(Rt=0;Rt<dt;Rt++)jt=8*Rt+1,ft[Ot=Rt<<2]=ut[jt],ft[Ot+1]=ut[jt+2],ft[Ot+2]=ut[jt+4],ft[Ot+3]=ut[jt+6];if(vt==3)for(Rt=0;Rt<dt;Rt++)jt=6*Rt+1,ft[Ot=Rt<<2]=ut[jt],ft[Ot+1]=ut[jt+2],ft[Ot+2]=ut[jt+4],ft[Ot+3]=255}else{if(gt!=32)throw gt;var Mt=new Float32Array(ut.buffer),$t=0;for(Rt=0;Rt<Mt.length;Rt++)$t=Math.min($t,Mt[Rt]);if($t<0)for(Rt=0;Rt<ut.length;Rt+=4){var Qt=ut[Rt];ut[Rt]=ut[Rt+3],ut[Rt+3]=Qt,Qt=ut[Rt+1],ut[Rt+1]=ut[Rt+2],ut[Rt+2]=Qt}var Ht=[];for(Rt=0;Rt<65536;Rt++)Ht.push(ot(Rt/65535));for(Rt=0;Rt<Mt.length;Rt++){var qt=Math.max(0,Math.min(1,Mt[Rt]));Mt[Rt]=Ht[~~(.5+65535*qt)]}if(vt==3)for(Rt=0;Rt<dt;Rt++)jt=3*Rt,ft[Ot=Rt<<2]=~~(.5+255*Mt[jt]),ft[Ot+1]=~~(.5+255*Mt[jt+1]),ft[Ot+2]=~~(.5+255*Mt[jt+2]),ft[Ot+3]=255;else{if(vt!=4)throw vt;for(Rt=0;Rt<dt;Rt++)jt=4*Rt,ft[Ot=Rt<<2]=~~(.5+255*Mt[jt]),ft[Ot+1]=~~(.5+255*Mt[jt+1]),ft[Ot+2]=~~(.5+255*Mt[jt+2]),ft[Ot+3]=~~(.5+255*Mt[jt+3])}}else if(mt==3){var Bt=at.t320,Xt=1<<gt,Ft=gt==8&&vt>1&&at.t338&&at.t338[0]!=0;for(At=0;At<ht;At++)for(var Wt=0;Wt<lt;Wt++){Ot=(Rt=At*lt+Wt)<<2;var Yt=0,zt=At*wt;if(gt==1)Yt=ut[zt+(Wt>>>3)]>>>7-(7&Wt)&1;else if(gt==2)Yt=ut[zt+(Wt>>>2)]>>>6-2*(3&Wt)&3;else if(gt==4)Yt=ut[zt+(Wt>>>1)]>>>4-4*(1&Wt)&15;else{if(gt!=8)throw gt;Yt=ut[zt+Wt*vt]}ft[Ot]=Bt[Yt]>>8,ft[Ot+1]=Bt[Xt+Yt]>>8,ft[Ot+2]=Bt[Xt+Xt+Yt]>>8,ft[Ot+3]=Ft?ut[zt+Wt*vt+1]:255}}else if(mt==5){var er=vt>4?1:0;for(Rt=0;Rt<dt;Rt++){Ot=Rt<<2;var dr=Rt*vt;if(window.UDOC){var fr=ut[dr],lr=ut[dr+1],mr=ut[dr+2],br=ut[dr+3],Sr=UDOC.C.cmykToRgb([fr*(1/255),lr*(1/255),mr*(1/255),br*(1/255)]);ft[Ot]=~~(.5+255*Sr[0]),ft[Ot+1]=~~(.5+255*Sr[1]),ft[Ot+2]=~~(.5+255*Sr[2])}else fr=255-ut[dr],lr=255-ut[dr+1],mr=255-ut[dr+2],br=(255-ut[dr+3])*(1/255),ft[Ot]=~~(fr*br+.5),ft[Ot+1]=~~(lr*br+.5),ft[Ot+2]=~~(mr*br+.5);ft[Ot+3]=255*(1-er)+ut[dr+4]*er}}else if(mt==6&&at.t278){var Ir=at.t278[0];for(At=0;At<ht;At+=Ir){Rt=At*lt;for(var cr=Ir*lt,Nt=0;Nt<cr;Nt++){Ot=4*(Rt+Nt),mr=ut[(dr=3*Rt+4*(Nt>>>1))+(1&Nt)];var pr=ut[dr+2]-128,rr=ut[dr+3]-128,ar=mr+((rr>>2)+(rr>>3)+(rr>>5)),nr=mr-((pr>>2)+(pr>>4)+(pr>>5))-((rr>>1)+(rr>>3)+(rr>>4)+(rr>>5)),ur=mr+(pr+(pr>>1)+(pr>>2)+(pr>>6));ft[Ot]=Math.max(0,Math.min(255,ar)),ft[Ot+1]=Math.max(0,Math.min(255,nr)),ft[Ot+2]=Math.max(0,Math.min(255,ur)),ft[Ot+3]=255}}}else if(mt==32845)for(At=0;At<ht;At++)for(Wt=0;Wt<lt;Wt++){Ot=4*(At*lt+Wt);var Er=ut[(dr=6*(At*lt+Wt))+1]<<8|ut[dr],Ut=(Er=Math.pow(2,(Er+.5)/256-64),(ut[dr+3]+.5)/410),Kt=(ut[dr+5]+.5)/410,or=9*Ut/(6*Ut-16*Kt+12),hr=4*Kt/(6*Ut-16*Kt+12),kr=or*Er/hr,Br=(1-or-hr)*Er/hr;ar=2.69*kr-1.276*(mr=Er)-.414*Br,nr=-1.022*kr+1.978*mr+.044*Br,ur=.061*kr-.224*mr+1.163*Br,ft[Ot]=255*ot(Math.min(ar,1)),ft[Ot+1]=255*ot(Math.min(nr,1)),ft[Ot+2]=255*ot(Math.min(ur,1)),ft[Ot+3]=255}else rt("Unknown Photometric interpretation: "+mt);return ft},nt.replaceIMG=function(at){at==null&&(at=document.getElementsByTagName("img"));for(var st=["tif","tiff","dng","cr2","nef"],ot=0;ot<at.length;ot++){var lt=at[ot],ht=lt.getAttribute("src");if(ht!=null){var dt=ht.split(".").pop().toLowerCase();if(st.indexOf(dt)!=-1){var ut=new XMLHttpRequest;nt._xhrs.push(ut),nt._imgs.push(lt),ut.open("GET",ht),ut.responseType="arraybuffer",ut.onload=nt._imgLoaded,ut.send()}}}},nt._xhrs=[],nt._imgs=[],nt._imgLoaded=function(at){var st=nt._xhrs.indexOf(at.target),ot=nt._imgs[st];nt._xhrs.splice(st,1),nt._imgs.splice(st,1),ot.setAttribute("src",nt.bufferToURI(at.target.response))},nt.bufferToURI=function(at){var st=nt.decode(at),ot=st,lt=0,ht=ot[0];st[0].subIFD&&(ot=ot.concat(st[0].subIFD));for(var dt=0;dt<ot.length;dt++){var ut=ot[dt];if(!(ut.t258==null||ut.t258.length<3)){var ft=ut.t256*ut.t257;ft>lt&&(lt=ft,ht=ut)}}nt.decodeImage(at,ht,st);var mt=nt.toRGBA8(ht),gt=ht.width,vt=ht.height,xt=document.createElement("canvas");xt.width=gt,xt.height=vt;var wt=xt.getContext("2d"),At=new ImageData(new Uint8ClampedArray(mt.buffer),gt,vt);return wt.putImageData(At,0,0),xt.toDataURL()},nt._binBE={nextZero:function(at,st){for(;at[st]!=0;)st++;return st},readUshort:function(at,st){return at[st]<<8|at[st+1]},readShort:function(at,st){var ot=nt._binBE.ui8;return ot[0]=at[st+1],ot[1]=at[st+0],nt._binBE.i16[0]},readInt:function(at,st){var ot=nt._binBE.ui8;return ot[0]=at[st+3],ot[1]=at[st+2],ot[2]=at[st+1],ot[3]=at[st+0],nt._binBE.i32[0]},readUint:function(at,st){var ot=nt._binBE.ui8;return ot[0]=at[st+3],ot[1]=at[st+2],ot[2]=at[st+1],ot[3]=at[st+0],nt._binBE.ui32[0]},readASCII:function(at,st,ot){for(var lt="",ht=0;ht<ot;ht++)lt+=String.fromCharCode(at[st+ht]);return lt},readFloat:function(at,st){for(var ot=nt._binBE.ui8,lt=0;lt<4;lt++)ot[lt]=at[st+3-lt];return nt._binBE.fl32[0]},readDouble:function(at,st){for(var ot=nt._binBE.ui8,lt=0;lt<8;lt++)ot[lt]=at[st+7-lt];return nt._binBE.fl64[0]},writeUshort:function(at,st,ot){at[st]=ot>>8&255,at[st+1]=255&ot},writeInt:function(at,st,ot){var lt=nt._binBE.ui8;nt._binBE.i32[0]=ot,at[st+3]=lt[0],at[st+2]=lt[1],at[st+1]=lt[2],at[st+0]=lt[3]},writeUint:function(at,st,ot){at[st]=ot>>24&255,at[st+1]=ot>>16&255,at[st+2]=ot>>8&255,at[st+3]=255&ot},writeASCII:function(at,st,ot){for(var lt=0;lt<ot.length;lt++)at[st+lt]=ot.charCodeAt(lt)},writeDouble:function(at,st,ot){nt._binBE.fl64[0]=ot;for(var lt=0;lt<8;lt++)at[st+lt]=nt._binBE.ui8[7-lt]}},nt._binBE.ui8=new Uint8Array(8),nt._binBE.i16=new Int16Array(nt._binBE.ui8.buffer),nt._binBE.i32=new Int32Array(nt._binBE.ui8.buffer),nt._binBE.ui32=new Uint32Array(nt._binBE.ui8.buffer),nt._binBE.fl32=new Float32Array(nt._binBE.ui8.buffer),nt._binBE.fl64=new Float64Array(nt._binBE.ui8.buffer),nt._binLE={nextZero:nt._binBE.nextZero,readUshort:function(at,st){return at[st+1]<<8|at[st]},readShort:function(at,st){var ot=nt._binBE.ui8;return ot[0]=at[st+0],ot[1]=at[st+1],nt._binBE.i16[0]},readInt:function(at,st){var ot=nt._binBE.ui8;return ot[0]=at[st+0],ot[1]=at[st+1],ot[2]=at[st+2],ot[3]=at[st+3],nt._binBE.i32[0]},readUint:function(at,st){var ot=nt._binBE.ui8;return ot[0]=at[st+0],ot[1]=at[st+1],ot[2]=at[st+2],ot[3]=at[st+3],nt._binBE.ui32[0]},readASCII:nt._binBE.readASCII,readFloat:function(at,st){for(var ot=nt._binBE.ui8,lt=0;lt<4;lt++)ot[lt]=at[st+lt];return nt._binBE.fl32[0]},readDouble:function(at,st){for(var ot=nt._binBE.ui8,lt=0;lt<8;lt++)ot[lt]=at[st+lt];return nt._binBE.fl64[0]},writeUshort:function(at,st,ot){at[st]=255&ot,at[st+1]=ot>>8&255},writeInt:function(at,st,ot){var lt=nt._binBE.ui8;nt._binBE.i32[0]=ot,at[st+0]=lt[0],at[st+1]=lt[1],at[st+2]=lt[2],at[st+3]=lt[3]},writeUint:function(at,st,ot){at[st]=ot>>>0&255,at[st+1]=ot>>>8&255,at[st+2]=ot>>>16&255,at[st+3]=ot>>>24&255},writeASCII:nt._binBE.writeASCII},nt._copyTile=function(at,st,ot,lt,ht,dt,ut,ft){for(var mt=Math.min(st,ht-ut),gt=Math.min(ot,dt-ft),vt=0;vt<gt;vt++)for(var xt=(ft+vt)*ht+ut,wt=vt*st,At=0;At<mt;At++)lt[xt+At]=at[wt+At]},nt.LosslessJpegDecode=(function(){var at,st;function ot(){return at[st++]}function lt(){return at[st++]<<8|at[st++]}function ht(Tt){for(var Pt=ot(),Rt=[0,0,0,255],Ot=[],Et=0;Et<16;Et++)Ot[Et]=ot();for(Et=0;Et<16;Et++)for(var Lt=0;Lt<Ot[Et];Lt++)Rt[dt(Rt,0,Et+1,1)+3]=ot();var kt=new Uint8Array(256);for(Tt[Pt]=[new Uint8Array(Rt),kt],Et=0;Et<256;Et++){for(var jt=8,Mt=Et,$t=0;Rt[$t+3]==255&&jt!=0;)$t=Rt[$t+(Mt>>--jt&1)];kt[Et]=$t}}function dt(Tt,Pt,Rt,Ot){if(Tt[Pt+3]!=255)return 0;if(Rt==0)return Pt;for(var Et=0;Et<2;Et++){Tt[Pt+Et]==0&&(Tt[Pt+Et]=Tt.length,Tt.push(0,0,Ot,255));var Lt=dt(Tt,Tt[Pt+Et],Rt-1,Ot+1);if(Lt!=0)return Lt}return 0}function ut(Tt){for(var Pt=Tt.b,Rt=Tt.f;Pt<25&&Tt.a<Tt.d;){var Ot=Tt.data[Tt.a++];Ot!=255||Tt.c||Tt.a++,Rt=Rt<<8|Ot,Pt+=8}if(Pt<0)throw"e";Tt.b=Pt,Tt.f=Rt}function ft(Tt,Pt){return Pt.b<Tt&&ut(Pt),Pt.f>>(Pt.b-=Tt)&65535>>16-Tt}function mt(Tt,Pt){var Rt=Tt[0],Ot=0,Et=255;Pt.b<16&&ut(Pt);var Lt=Pt.f>>Pt.b-8&255;for(Et=Rt[(Ot=Tt[1][Lt])+3],Pt.b-=Rt[Ot+2];Et==255;)Et=Rt[(Ot=Rt[Ot+(Pt.f>>--Pt.b&1)])+3];return Et}function gt(Tt,Pt){return Tt<32768>>16-Pt&&(Tt+=1-(1<<Pt)),Tt}function vt(Tt,Pt){var Rt=mt(Tt,Pt);return Rt==0?0:Rt==16?-32768:gt(ft(Rt,Pt),Rt)}function xt(Tt,Pt,Rt,Ot,Et,Lt){for(var kt=0,jt=0;jt<Lt;jt++){for(var Mt=jt*Pt,$t=0;$t<Pt;$t+=Et){kt++;for(var Qt=0;Qt<Et;Qt++)Tt[Mt+$t+Qt]=vt(Ot[Qt],Rt)}if(Rt.e!=0&&kt%Rt.e==0&&jt!=0){for(var Ht=Rt.a,qt=Rt.data;qt[Ht]!=255||!(208<=qt[Ht+1]&&qt[Ht+1]<=215);)Ht--;Rt.a=Ht+2,Rt.f=0,Rt.b=0}}}function wt(Tt,Pt){return gt(ft(Tt,Pt),Tt)}function At(Tt,Pt,Rt,Ot,Et,Lt,kt,jt){for(var Mt=Rt*kt,$t=Et;$t<Lt;$t++)Tt[$t]+=1<<jt-1;for(var Qt=kt;Qt<Mt;Qt+=kt)for($t=Et;$t<Lt;$t++)Tt[Qt+$t]+=Tt[Qt+$t-kt];for(var Ht=1;Ht<Ot;Ht++){var qt=Ht*Mt;for($t=Et;$t<Lt;$t++)Tt[qt+$t]+=Tt[qt+$t-Mt];for(Qt=kt;Qt<Mt;Qt+=kt)for($t=Et;$t<Lt;$t++){var Bt=qt+Qt+$t,Xt=Bt-Mt,Ft=Tt[Bt-kt],Wt=0;if(Pt==0)Wt=0;else if(Pt==1)Wt=Ft;else if(Pt==2)Wt=Tt[Xt];else if(Pt==3)Wt=Tt[Xt-kt];else if(Pt==4)Wt=Ft+(Tt[Xt]-Tt[Xt-kt]);else if(Pt==5)Wt=Ft+(Tt[Xt]-Tt[Xt-kt]>>>1);else if(Pt==6)Wt=Tt[Xt]+(Ft-Tt[Xt-kt]>>>1);else{if(Pt!=7)throw Pt;Wt=Ft+Tt[Xt]>>>1}Tt[Bt]+=Wt}}}return function(Tt){if(at=Tt,st=0,lt()!=65496)throw"e";for(var Pt=[],Rt=0,Ot=0,Et=0,Lt=[],kt=[],jt=[],Mt=0,$t=0,Qt=0;;){var Ht=lt();if(Ht!=65535){var qt=lt();if(Ht==65475){Ot=ot(),$t=lt(),Qt=lt(),Mt=ot();for(var Bt=0;Bt<Mt;Bt++){var Xt=ot(),Ft=ot();if(ot()!=0)throw"e";Pt[Xt]=[Bt,Ft>>4,15&Ft]}}else if(Ht==65476)for(var Wt=st+qt-2;st<Wt;)ht(kt);else{if(Ht==65498){for(st++,Bt=0;Bt<Mt;Bt++){var Yt=Pt[ot()];jt[Yt[0]]=kt[ot()>>>4],Lt[Yt[0]]=Yt.slice(1)}Rt=ot(),st+=2;break}Ht==65501?Et=lt():st+=qt-2}}else st--}var zt=new(Ot>8?Uint16Array:Uint8Array)($t*Qt*Mt),er={b:0,f:0,c:Rt==8,a:st,data:at,d:at.length,e:Et};if(er.c)(function(kr,Br,Gn,Xn,Mn){for(var Kn=at.length-st,Vn=0;Vn<Kn;Vn+=4){var vi=at[st+Vn];at[st+Vn]=at[st+Vn+3],at[st+Vn+3]=vi,vi=at[st+Vn+1],at[st+Vn+1]=at[st+Vn+2],at[st+Vn+2]=vi}for(var mi=0;mi<Mn;mi++)for(var _i=32768,Ri=32768,pi=0;pi<Br;pi+=2){var Tr=mt(Xn,Gn),qn=mt(Xn,Gn);Tr!=0&&(_i+=wt(Tr,Gn)),qn!=0&&(Ri+=wt(qn,Gn)),kr[mi*Br+pi]=65535&_i,kr[mi*Br+pi+1]=65535&Ri}})(zt,Qt*Mt,er,jt[0],$t);else{var dr=[],fr=0,lr=0;for(Bt=0;Bt<Mt;Bt++){var mr=Lt[Bt];(ur=mr[0])>fr&&(fr=ur),(nr=mr[1])>lr&&(lr=nr),dr.push(ur*nr)}if(fr!=1||lr!=1){if(Mt!=3||dr[1]!=1||dr[2]!=1||fr!=2||lr!=1&&lr!=2)throw"e";var br=[],Sr=0;for(Bt=0;Bt<Mt;Bt++){for(var Ir=0;Ir<dr[Bt];Ir++)br.push(jt[Bt]);Sr+=dr[Bt]}var cr=Qt/fr,Nt=$t/lr,pr=cr*Nt;xt(zt,cr*Sr,er,br,Sr,Nt),At(zt,Rt,cr,Nt,Sr-2,Sr,Sr,Ot);var rr=new Uint16Array(pr*dr[0]);if(fr==2&&lr==2){for(Bt=0;Bt<pr;Bt++)rr[4*Bt]=zt[6*Bt],rr[4*Bt+1]=zt[6*Bt+1],rr[4*Bt+2]=zt[6*Bt+2],rr[4*Bt+3]=zt[6*Bt+3];for(At(rr,Rt,4*cr,Nt,0,1,1,Ot),Bt=0;Bt<pr;Bt++)zt[6*Bt]=rr[4*Bt],zt[6*Bt+1]=rr[4*Bt+1],zt[6*Bt+2]=rr[4*Bt+2],zt[6*Bt+3]=rr[4*Bt+3]}if(fr==2&&lr==1){for(Bt=0;Bt<pr;Bt++)rr[2*Bt]=zt[4*Bt],rr[2*Bt+1]=zt[4*Bt+1];for(At(rr,Rt,2*cr,Nt,0,1,1,Ot),Bt=0;Bt<pr;Bt++)zt[4*Bt]=rr[2*Bt],zt[4*Bt+1]=rr[2*Bt+1]}for(var ar=zt.slice(0),nr=0;nr<$t;nr++)if(lr==2)for(var ur=0;ur<Qt;ur++){var Er=((nr>>>1)*cr+(ur>>>1))*Sr,Ut=2*(1&nr)+(1&ur);zt[Kt=(nr*Qt+ur)*Mt]=ar[Er+Ut],zt[Kt+1]=ar[Er+4],zt[Kt+2]=ar[Er+5]}else for(ur=0;ur<Qt;ur++){var Kt;Er=(nr*cr+(ur>>>1))*Sr,Ut=1&ur,zt[Kt=(nr*Qt+ur)*Mt]=ar[Er+Ut],zt[Kt+1]=ar[Er+2],zt[Kt+2]=ar[Er+3]}}else if(xt(zt,Qt*Mt,er,jt,Mt,$t),Et==0)At(zt,Rt,Qt,$t,0,Mt,Mt,Ot);else{var or=Math.floor(Et/Qt);for(nr=0;nr<$t;nr+=or){var hr=zt.slice(nr*Qt*Mt,(nr+or)*Qt*Mt);At(hr,Rt,Qt,or,0,Mt,Mt,Ot),zt.set(hr,nr*Qt*Mt)}}}return zt}})(),(function(){var at=2,st=4,ot=5,lt=6,ht=7,dt=12,ut=13,ft=14,mt=15,gt=17;function vt(Lt){var kt={c:new Int8Array(2<<Lt.u)};return(function(jt,Mt,$t){var Qt=[Mt,3*Mt+18,5*Mt+67,7*Mt+276,$t];jt.o=Mt,jt.w=(Qt[4]+2*Mt)/(2*Mt+1)+1|0,jt.v=Math.ceil(Math.log2(jt.w)),jt.t=9,(function(Ht,qt){for(var Bt=-qt[4],Xt=0;Bt<=qt[4];Xt++,Bt++)Ht[Xt]=Bt<=-276?-4:Bt<=-67?-3:Bt<=-18?-2:Bt<-0?-1:Bt<=qt[0]?0:Bt<qt[1]?1:Bt<qt[2]?2:Bt<qt[3]?3:4})(jt.c,Qt)})(kt,0,Lt.g),kt}function xt(Lt){for(var kt=[[],[],[]],jt=Math.max(2,Lt.w+32>>>6),Mt=0;Mt<3;Mt++)for(var $t=0;$t<41;$t++)kt[Mt][$t]=[jt,1];return kt}function wt(Lt,kt){var jt=0,Mt=8-Lt.a;if(Lt.j,Lt.a,kt){if(kt>=Mt)do jt<<=Mt,kt-=Mt,jt|=Lt[Lt.j]&(1<<Mt)-1,Lt.j++,Mt=8;while(kt>=8);kt&&(jt<<=kt,Mt-=kt,jt|=Lt[Lt.j]>>>Mt&(1<<kt)-1),Lt.a=8-Mt}return jt}function At(Lt,kt,jt,Mt,$t,Qt,Ht,qt){qt==null&&(qt=0);var Bt,Xt,Ft,Wt,Yt,zt,er=Qt+1,dr=er%2,fr=0,lr=Mt[$t],mr=Mt[$t-1],br=Mt[$t-2][er],Sr=mr[er-1],Ir=mr[er],cr=mr[er+1],Nt=lr[er-1],pr=lr[er+1],rr=Math.abs;if(dr&&(Ft=rr(cr-Ir),Wt=rr(br-Ir),Yt=rr(Sr-Ir)),dr){if(zt=(zt=Ft>Yt&&Wt<Ft?br+Sr:Ft<Yt&&Wt<Yt?br+cr:cr+Sr)+2*Ir>>>2,qt)return void(lr[er]=zt);Bt=kt.t*kt.c[Lt.g+Ir-br]+kt.c[Lt.g+Sr-Ir]}else zt=Ir>Sr&&Ir>cr||Ir<Sr&&Ir<cr?pr+Nt+2*Ir>>>2:Nt+pr>>>1,Bt=kt.t*kt.c[Lt.g+Ir-Sr]+kt.c[Lt.g+Sr-Nt];Xt=rr(Bt);var ar=(function(ur){for(var Er=-1,Ut=0;!Ut;Er++)Ut=ur[ur.j]>>>7-ur.a&1,ur.a++,ur.a&=7,ur.a||ur.j++;return Er})(jt);if(ar<Lt.n-kt.v-1){var nr=(function(ur,Er){var Ut=0;if(Er<ur)for(;Ut<=14&&Er<<++Ut<ur;);return Ut})(Ht[Xt][0],Ht[Xt][1]);fr=wt(jt,nr)+(ar<<nr)}else fr=wt(jt,kt.v)+1;fr=1&fr?-1-(fr>>>1):fr>>>1,Ht[Xt][0]+=rr(fr),Ht[Xt][1]==Lt.f&&(Ht[Xt][0]>>>=1,Ht[Xt][1]>>>=1),Ht[Xt][1]++,zt=Bt<0?zt-fr:zt+fr,Lt.i&&(zt<0?zt+=kt.w:zt>Lt.g&&(zt-=kt.w)),lr[er]=zt>=0?Math.min(zt,Lt.g):0}function Tt(Lt,kt,jt){for(var Mt=Lt[0].length,$t=kt;$t<=jt;$t++)Lt[$t][0]=Lt[$t-1][1],Lt[$t][Mt-1]=Lt[$t-1][Mt-2]}function Pt(Lt){Tt(Lt,ht,dt),Tt(Lt,at,st),Tt(Lt,mt,gt)}function Rt(Lt,kt,jt,Mt,$t,Qt,Ht,qt,Bt,Xt,Ft,Wt,Yt){for(var zt=0,er=1,dr=$t<ut&&$t>st;er<Lt.m;)zt<Lt.m&&(At(Lt,kt,jt,Mt,$t,zt,Ht[Bt],Lt.h&&(dr&&Xt||!dr&&(Ft||(zt&Wt)==Yt))),At(Lt,kt,jt,Mt,Qt,zt,Ht[Bt],Lt.h&&(!dr&&Xt||dr&&(Ft||(zt&Wt)==Yt))),zt+=2),zt>8&&(At(Lt,kt,jt,Mt,$t,er,qt[Bt]),At(Lt,kt,jt,Mt,Qt,er,qt[Bt]),er+=2);Pt(Mt)}function Ot(Lt,kt,jt,Mt,$t,Qt){Rt(Lt,kt,jt,Mt,at,ht,$t,Qt,0,0,1,0,8),Rt(Lt,kt,jt,Mt,8,mt,$t,Qt,1,0,1,0,8),Rt(Lt,kt,jt,Mt,3,9,$t,Qt,2,1,0,3,0),Rt(Lt,kt,jt,Mt,10,16,$t,Qt,0,0,0,3,2),Rt(Lt,kt,jt,Mt,st,11,$t,Qt,1,0,0,3,2),Rt(Lt,kt,jt,Mt,dt,gt,$t,Qt,2,1,0,3,0)}function Et(Lt,kt,jt,Mt,$t,Qt){var Ht=Qt.length,qt=Lt.l;$t+1==Lt.s&&(qt=Lt.e-$t*Lt.l);for(var Bt=6*Lt.e*Mt+$t*Lt.l,Xt=0;Xt<6;Xt++){for(var Ft=0;Ft<qt;Ft++){var Wt,Yt=Qt[Xt%Ht][Ft%Ht];Wt=Yt==0?at+(Xt>>>1):Yt==2?mt+(Xt>>>1):ht+Xt;var zt=Lt.h?(2*Ft/3&2147483646|Ft%3&1)+(Ft%3>>>1):Ft>>>1;kt[Bt+Ft]=jt[Wt][zt+1]}Bt+=Lt.e}}nt._decompressRAF=function(Lt,kt){var jt=(function(er){var dr=nt._binBE.readUshort,fr={b:dr(er,0),i:er[2],C:er[3],u:er[4],q:dr(er,5),k:dr(er,7),e:dr(er,9),l:dr(er,11),s:er[13],d:dr(er,14)};if(fr.b!=18771||fr.i>1||fr.q<6||fr.q%6||fr.e<768||fr.e%24||fr.l!=768||fr.k<fr.l||fr.k%fr.l||fr.k-fr.e>=fr.l||fr.s>16||fr.s!=fr.k/fr.l||fr.s!=Math.ceil(fr.e/fr.l)||fr.d!=fr.q/6||fr.u!=12&&fr.u!=14&&fr.u!=16||fr.C!=16&&fr.C!=0)throw"Invalid data";if(fr.i==0)throw"Not implemented. We need this file!";return fr.h=fr.C==16,fr.m=0|(fr.h?2*fr.l/3:fr.l>>>1),fr.A=fr.m+2,fr.f=64,fr.g=(1<<fr.u)-1,fr.n=4*fr.u,fr})(Lt),Mt=(function(er,dr){var fr=new Array(dr.s),lr=4*dr.s,mr=16+lr;12&lr&&(mr+=16-(12&lr));for(var br=0,Sr=16;br<dr.s;Sr+=4){var Ir=nt._binBE.readUint(er,Sr);fr[br]=er.slice(mr,mr+Ir),fr[br].j=0,fr[br].a=0,mr+=Ir,br++}if(mr!=er.length)throw"Invalid data";return fr})(Lt,jt),$t=vt(jt),Qt=new Int16Array(jt.e*jt.q);kt==null&&(kt=jt.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var Ht=[[0,3],[1,st],[ot,11],[lt,dt],[ut,16],[ft,gt]],qt=[],Bt=0;Bt<18;Bt++)qt[Bt]=new Uint16Array(jt.A);for(var Xt=0;Xt<jt.s;Xt++){var Ft=xt($t),Wt=xt($t);for(Bt=0;Bt<18;Bt++)for(var Yt=0;Yt<jt.A;Yt++)qt[Bt][Yt]=0;for(var zt=0;zt<jt.d;zt++){for(Ot(jt,$t,Mt[Xt],qt,Ft,Wt),Bt=0;Bt<6;Bt++)for(Yt=0;Yt<jt.A;Yt++)qt[Ht[Bt][0]][Yt]=qt[Ht[Bt][1]][Yt];for(Et(jt,Qt,qt,zt,Xt,kt),Bt=at;Bt<18;Bt++)if([ot,lt,ut,ft].indexOf(Bt)==-1)for(Yt=0;Yt<jt.A;Yt++)qt[Bt][Yt]=0;Pt(qt)}}return Qt}})()})(et,typeof commonjsRequire=="function"?requirePako():self.pako)})()})(UTIF);var UTIFExports=UTIF.exports,utif=getDefaultExportFromCjs(UTIFExports),util$1,objectUtil;function getDimensionValue(tt){return typeof tt=="number"?tt:tt instanceof Uint8Array?tt[0]:typeof tt[0]=="string"?parseInt(tt[0]):tt[0]}function tiff(){return{mime:"image/tiff",encode:tt=>{const et=utif.encodeImage(tt.data,tt.width,tt.height);return Buffer$1.from(et)},decode:tt=>{const et=utif.decode(tt),rt=et[0];if(!rt)throw new Error("No page found in TIFF");if(!rt.t256)throw new Error("No image width found in TIFF");if(!rt.t257)throw new Error("No image height found in TIFF");et.forEach((it=>{utif.decodeImage(tt,it)}));const nt=utif.toRGBA8(rt);return{data:Buffer$1.from(nt),width:getDimensionValue(rt.t256),height:getDimensionValue(rt.t257)}}}}(function(tt){tt.assertEqual=et=>et,tt.assertIs=function(et){},tt.assertNever=function(et){throw new Error},tt.arrayToEnum=et=>{const rt={};for(const nt of et)rt[nt]=nt;return rt},tt.getValidEnumValues=et=>{const rt=tt.objectKeys(et).filter((it=>typeof et[et[it]]!="number")),nt={};for(const it of rt)nt[it]=et[it];return tt.objectValues(nt)},tt.objectValues=et=>tt.objectKeys(et).map((function(rt){return et[rt]})),tt.objectKeys=typeof Object.keys=="function"?et=>Object.keys(et):et=>{const rt=[];for(const nt in et)Object.prototype.hasOwnProperty.call(et,nt)&&rt.push(nt);return rt},tt.find=(et,rt)=>{for(const nt of et)if(rt(nt))return nt},tt.isInteger=typeof Number.isInteger=="function"?et=>Number.isInteger(et):et=>typeof et=="number"&&isFinite(et)&&Math.floor(et)===et,tt.joinValues=function(et,rt=" | "){return et.map((nt=>typeof nt=="string"?`'${nt}'`:nt)).join(rt)},tt.jsonStringifyReplacer=(et,rt)=>typeof rt=="bigint"?rt.toString():rt})(util$1||(util$1={})),(function(tt){tt.mergeShapes=(et,rt)=>({...et,...rt})})(objectUtil||(objectUtil={}));const ZodParsedType=util$1.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=tt=>{switch(typeof tt){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(tt)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(tt)?ZodParsedType.array:tt===null?ZodParsedType.null:tt.then&&typeof tt.then=="function"&&tt.catch&&typeof tt.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&tt instanceof Map?ZodParsedType.map:typeof Set<"u"&&tt instanceof Set?ZodParsedType.set:typeof Date<"u"&&tt instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util$1.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=tt=>JSON.stringify(tt,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(et){super(),this.issues=[],this.addIssue=nt=>{this.issues=[...this.issues,nt]},this.addIssues=(nt=[])=>{this.issues=[...this.issues,...nt]};const rt=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,rt):this.__proto__=rt,this.name="ZodError",this.issues=et}get errors(){return this.issues}format(et){const rt=et||function(at){return at.message},nt={_errors:[]},it=at=>{for(const st of at.issues)if(st.code==="invalid_union")st.unionErrors.map(it);else if(st.code==="invalid_return_type")it(st.returnTypeError);else if(st.code==="invalid_arguments")it(st.argumentsError);else if(st.path.length===0)nt._errors.push(rt(st));else{let ot=nt,lt=0;for(;lt<st.path.length;){const ht=st.path[lt];lt===st.path.length-1?(ot[ht]=ot[ht]||{_errors:[]},ot[ht]._errors.push(rt(st))):ot[ht]=ot[ht]||{_errors:[]},ot=ot[ht],lt++}}};return it(this),nt}static assert(et){if(!(et instanceof ZodError))throw new Error(`Not a ZodError: ${et}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util$1.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(et=(rt=>rt.message)){const rt={},nt=[];for(const it of this.issues)it.path.length>0?(rt[it.path[0]]=rt[it.path[0]]||[],rt[it.path[0]].push(et(it))):nt.push(et(it));return{formErrors:nt,fieldErrors:rt}}get formErrors(){return this.flatten()}}ZodError.create=tt=>new ZodError(tt);const errorMap=(tt,et)=>{let rt;switch(tt.code){case ZodIssueCode.invalid_type:rt=tt.received===ZodParsedType.undefined?"Required":`Expected ${tt.expected}, received ${tt.received}`;break;case ZodIssueCode.invalid_literal:rt=`Invalid literal value, expected ${JSON.stringify(tt.expected,util$1.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:rt=`Unrecognized key(s) in object: ${util$1.joinValues(tt.keys,", ")}`;break;case ZodIssueCode.invalid_union:rt="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:rt=`Invalid discriminator value. Expected ${util$1.joinValues(tt.options)}`;break;case ZodIssueCode.invalid_enum_value:rt=`Invalid enum value. Expected ${util$1.joinValues(tt.options)}, received '${tt.received}'`;break;case ZodIssueCode.invalid_arguments:rt="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:rt="Invalid function return type";break;case ZodIssueCode.invalid_date:rt="Invalid date";break;case ZodIssueCode.invalid_string:typeof tt.validation=="object"?"includes"in tt.validation?(rt=`Invalid input: must include "${tt.validation.includes}"`,typeof tt.validation.position=="number"&&(rt=`${rt} at one or more positions greater than or equal to ${tt.validation.position}`)):"startsWith"in tt.validation?rt=`Invalid input: must start with "${tt.validation.startsWith}"`:"endsWith"in tt.validation?rt=`Invalid input: must end with "${tt.validation.endsWith}"`:util$1.assertNever(tt.validation):rt=tt.validation!=="regex"?`Invalid ${tt.validation}`:"Invalid";break;case ZodIssueCode.too_small:rt=tt.type==="array"?`Array must contain ${tt.exact?"exactly":tt.inclusive?"at least":"more than"} ${tt.minimum} element(s)`:tt.type==="string"?`String must contain ${tt.exact?"exactly":tt.inclusive?"at least":"over"} ${tt.minimum} character(s)`:tt.type==="number"?`Number must be ${tt.exact?"exactly equal to ":tt.inclusive?"greater than or equal to ":"greater than "}${tt.minimum}`:tt.type==="date"?`Date must be ${tt.exact?"exactly equal to ":tt.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(tt.minimum))}`:"Invalid input";break;case ZodIssueCode.too_big:rt=tt.type==="array"?`Array must contain ${tt.exact?"exactly":tt.inclusive?"at most":"less than"} ${tt.maximum} element(s)`:tt.type==="string"?`String must contain ${tt.exact?"exactly":tt.inclusive?"at most":"under"} ${tt.maximum} character(s)`:tt.type==="number"?`Number must be ${tt.exact?"exactly":tt.inclusive?"less than or equal to":"less than"} ${tt.maximum}`:tt.type==="bigint"?`BigInt must be ${tt.exact?"exactly":tt.inclusive?"less than or equal to":"less than"} ${tt.maximum}`:tt.type==="date"?`Date must be ${tt.exact?"exactly":tt.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(tt.maximum))}`:"Invalid input";break;case ZodIssueCode.custom:rt="Invalid input";break;case ZodIssueCode.invalid_intersection_types:rt="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:rt=`Number must be a multiple of ${tt.multipleOf}`;break;case ZodIssueCode.not_finite:rt="Number must be finite";break;default:rt=et.defaultError,util$1.assertNever(tt)}return{message:rt}};let overrideErrorMap=errorMap;function setErrorMap(tt){overrideErrorMap=tt}function getErrorMap(){return overrideErrorMap}const makeIssue=tt=>{const{data:et,path:rt,errorMaps:nt,issueData:it}=tt,at=[...rt,...it.path||[]],st={...it,path:at};if(it.message!==void 0)return{...it,path:at,message:it.message};let ot="";const lt=nt.filter((ht=>!!ht)).slice().reverse();for(const ht of lt)ot=ht(st,{data:et,defaultError:ot}).message;return{...it,path:at,message:ot}},EMPTY_PATH=[];function addIssueToContext(tt,et){const rt=getErrorMap(),nt=makeIssue({issueData:et,data:tt.data,path:tt.path,errorMaps:[tt.common.contextualErrorMap,tt.schemaErrorMap,rt,rt===errorMap?void 0:errorMap].filter((it=>!!it))});tt.common.issues.push(nt)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(et,rt){const nt=[];for(const it of rt){if(it.status==="aborted")return INVALID;it.status==="dirty"&&et.dirty(),nt.push(it.value)}return{status:et.value,value:nt}}static async mergeObjectAsync(et,rt){const nt=[];for(const it of rt){const at=await it.key,st=await it.value;nt.push({key:at,value:st})}return ParseStatus.mergeObjectSync(et,nt)}static mergeObjectSync(et,rt){const nt={};for(const it of rt){const{key:at,value:st}=it;if(at.status==="aborted"||st.status==="aborted")return INVALID;at.status==="dirty"&&et.dirty(),st.status==="dirty"&&et.dirty(),at.value==="__proto__"||st.value===void 0&&!it.alwaysSet||(nt[at.value]=st.value)}return{status:et.value,value:nt}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=tt=>({status:"dirty",value:tt}),OK=tt=>({status:"valid",value:tt}),isAborted=tt=>tt.status==="aborted",isDirty=tt=>tt.status==="dirty",isValid=tt=>tt.status==="valid",isAsync=tt=>typeof Promise<"u"&&tt instanceof Promise;function __classPrivateFieldGet(tt,et,rt,nt){if(typeof et=="function"?tt!==et||!0:!et.has(tt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return et.get(tt)}function __classPrivateFieldSet(tt,et,rt,nt,it){if(typeof et=="function"?tt!==et||!0:!et.has(tt))throw new TypeError("Cannot write private member to an object whose class did not declare it");return et.set(tt,rt),rt}var errorUtil,_ZodEnum_cache,_ZodNativeEnum_cache;typeof SuppressedError=="function"&&SuppressedError,(function(tt){tt.errToObj=et=>typeof et=="string"?{message:et}:et||{},tt.toString=et=>typeof et=="string"?et:et?.message})(errorUtil||(errorUtil={}));class ParseInputLazyPath{constructor(et,rt,nt,it){this._cachedPath=[],this.parent=et,this.data=rt,this._path=nt,this._key=it}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(tt,et)=>{if(isValid(et))return{success:!0,data:et.value};if(!tt.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const rt=new ZodError(tt.common.issues);return this._error=rt,this._error}}};function processCreateParams(tt){if(!tt)return{};const{errorMap:et,invalid_type_error:rt,required_error:nt,description:it}=tt;if(et&&(rt||nt))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return et?{errorMap:et,description:it}:{errorMap:(at,st)=>{var ot,lt;const{message:ht}=tt;return at.code==="invalid_enum_value"?{message:ht??st.defaultError}:st.data===void 0?{message:(ot=ht??nt)!==null&&ot!==void 0?ot:st.defaultError}:at.code!=="invalid_type"?{message:st.defaultError}:{message:(lt=ht??rt)!==null&&lt!==void 0?lt:st.defaultError}},description:it}}class ZodType{constructor(et){this.spa=this.safeParseAsync,this._def=et,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(et){return getParsedType(et.data)}_getOrReturnCtx(et,rt){return rt||{common:et.parent.common,data:et.data,parsedType:getParsedType(et.data),schemaErrorMap:this._def.errorMap,path:et.path,parent:et.parent}}_processInputParams(et){return{status:new ParseStatus,ctx:{common:et.parent.common,data:et.data,parsedType:getParsedType(et.data),schemaErrorMap:this._def.errorMap,path:et.path,parent:et.parent}}}_parseSync(et){const rt=this._parse(et);if(isAsync(rt))throw new Error("Synchronous parse encountered promise.");return rt}_parseAsync(et){const rt=this._parse(et);return Promise.resolve(rt)}parse(et,rt){const nt=this.safeParse(et,rt);if(nt.success)return nt.data;throw nt.error}safeParse(et,rt){var nt;const it={common:{issues:[],async:(nt=rt?.async)!==null&&nt!==void 0&&nt,contextualErrorMap:rt?.errorMap},path:rt?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:et,parsedType:getParsedType(et)},at=this._parseSync({data:et,path:it.path,parent:it});return handleResult(it,at)}async parseAsync(et,rt){const nt=await this.safeParseAsync(et,rt);if(nt.success)return nt.data;throw nt.error}async safeParseAsync(et,rt){const nt={common:{issues:[],contextualErrorMap:rt?.errorMap,async:!0},path:rt?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:et,parsedType:getParsedType(et)},it=this._parse({data:et,path:nt.path,parent:nt}),at=await(isAsync(it)?it:Promise.resolve(it));return handleResult(nt,at)}refine(et,rt){const nt=it=>typeof rt=="string"||rt===void 0?{message:rt}:typeof rt=="function"?rt(it):rt;return this._refinement(((it,at)=>{const st=et(it),ot=()=>at.addIssue({code:ZodIssueCode.custom,...nt(it)});return typeof Promise<"u"&&st instanceof Promise?st.then((lt=>!!lt||(ot(),!1))):!!st||(ot(),!1)}))}refinement(et,rt){return this._refinement(((nt,it)=>!!et(nt)||(it.addIssue(typeof rt=="function"?rt(nt,it):rt),!1)))}_refinement(et){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:et}})}superRefine(et){return this._refinement(et)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(et){return ZodUnion.create([this,et],this._def)}and(et){return ZodIntersection.create(this,et,this._def)}transform(et){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:et}})}default(et){const rt=typeof et=="function"?et:()=>et;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:rt,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(et){const rt=typeof et=="function"?et:()=>et;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:rt,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(et){return new this.constructor({...this._def,description:et})}pipe(et){return ZodPipeline.create(this,et)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6Regex=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(tt){let et="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return tt.precision?et=`${et}\\.\\d{${tt.precision}}`:tt.precision==null&&(et=`${et}(\\.\\d+)?`),et}function timeRegex(tt){return new RegExp(`^${timeRegexSource(tt)}$`)}function datetimeRegex(tt){let et=`${dateRegexSource}T${timeRegexSource(tt)}`;const rt=[];return rt.push(tt.local?"Z?":"Z"),tt.offset&&rt.push("([+-]\\d{2}:?\\d{2})"),et=`${et}(${rt.join("|")})`,new RegExp(`^${et}$`)}function isValidIP(tt,et){return!(et!=="v4"&&et||!ipv4Regex.test(tt))||!(et!=="v6"&&et||!ipv6Regex.test(tt))}class ZodString extends ZodType{_parse(et){if(this._def.coerce&&(et.data=String(et.data)),this._getType(et)!==ZodParsedType.string){const it=this._getOrReturnCtx(et);return addIssueToContext(it,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:it.parsedType}),INVALID}const rt=new ParseStatus;let nt;for(const it of this._def.checks)if(it.kind==="min")et.data.length<it.value&&(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.too_small,minimum:it.value,type:"string",inclusive:!0,exact:!1,message:it.message}),rt.dirty());else if(it.kind==="max")et.data.length>it.value&&(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.too_big,maximum:it.value,type:"string",inclusive:!0,exact:!1,message:it.message}),rt.dirty());else if(it.kind==="length"){const at=et.data.length>it.value,st=et.data.length<it.value;(at||st)&&(nt=this._getOrReturnCtx(et,nt),at?addIssueToContext(nt,{code:ZodIssueCode.too_big,maximum:it.value,type:"string",inclusive:!0,exact:!0,message:it.message}):st&&addIssueToContext(nt,{code:ZodIssueCode.too_small,minimum:it.value,type:"string",inclusive:!0,exact:!0,message:it.message}),rt.dirty())}else if(it.kind==="email")emailRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"email",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"emoji",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="uuid")uuidRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"uuid",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="nanoid")nanoidRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="cuid")cuidRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"cuid",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="cuid2")cuid2Regex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="ulid")ulidRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"ulid",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty());else if(it.kind==="url")try{new URL(et.data)}catch{nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"url",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty()}else it.kind==="regex"?(it.regex.lastIndex=0,it.regex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"regex",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty())):it.kind==="trim"?et.data=et.data.trim():it.kind==="includes"?et.data.includes(it.value,it.position)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.invalid_string,validation:{includes:it.value,position:it.position},message:it.message}),rt.dirty()):it.kind==="toLowerCase"?et.data=et.data.toLowerCase():it.kind==="toUpperCase"?et.data=et.data.toUpperCase():it.kind==="startsWith"?et.data.startsWith(it.value)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.invalid_string,validation:{startsWith:it.value},message:it.message}),rt.dirty()):it.kind==="endsWith"?et.data.endsWith(it.value)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.invalid_string,validation:{endsWith:it.value},message:it.message}),rt.dirty()):it.kind==="datetime"?datetimeRegex(it).test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.invalid_string,validation:"datetime",message:it.message}),rt.dirty()):it.kind==="date"?dateRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.invalid_string,validation:"date",message:it.message}),rt.dirty()):it.kind==="time"?timeRegex(it).test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.invalid_string,validation:"time",message:it.message}),rt.dirty()):it.kind==="duration"?durationRegex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"duration",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty()):it.kind==="ip"?isValidIP(et.data,it.version)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"ip",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty()):it.kind==="base64"?base64Regex.test(et.data)||(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{validation:"base64",code:ZodIssueCode.invalid_string,message:it.message}),rt.dirty()):util$1.assertNever(it);return{status:rt.value,value:et.data}}_regex(et,rt,nt){return this.refinement((it=>et.test(it)),{validation:rt,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(nt)})}_addCheck(et){return new ZodString({...this._def,checks:[...this._def.checks,et]})}email(et){return this._addCheck({kind:"email",...errorUtil.errToObj(et)})}url(et){return this._addCheck({kind:"url",...errorUtil.errToObj(et)})}emoji(et){return this._addCheck({kind:"emoji",...errorUtil.errToObj(et)})}uuid(et){return this._addCheck({kind:"uuid",...errorUtil.errToObj(et)})}nanoid(et){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(et)})}cuid(et){return this._addCheck({kind:"cuid",...errorUtil.errToObj(et)})}cuid2(et){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(et)})}ulid(et){return this._addCheck({kind:"ulid",...errorUtil.errToObj(et)})}base64(et){return this._addCheck({kind:"base64",...errorUtil.errToObj(et)})}ip(et){return this._addCheck({kind:"ip",...errorUtil.errToObj(et)})}datetime(et){var rt,nt;return typeof et=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:et}):this._addCheck({kind:"datetime",precision:et?.precision===void 0?null:et?.precision,offset:(rt=et?.offset)!==null&&rt!==void 0&&rt,local:(nt=et?.local)!==null&&nt!==void 0&&nt,...errorUtil.errToObj(et?.message)})}date(et){return this._addCheck({kind:"date",message:et})}time(et){return typeof et=="string"?this._addCheck({kind:"time",precision:null,message:et}):this._addCheck({kind:"time",precision:et?.precision===void 0?null:et?.precision,...errorUtil.errToObj(et?.message)})}duration(et){return this._addCheck({kind:"duration",...errorUtil.errToObj(et)})}regex(et,rt){return this._addCheck({kind:"regex",regex:et,...errorUtil.errToObj(rt)})}includes(et,rt){return this._addCheck({kind:"includes",value:et,position:rt?.position,...errorUtil.errToObj(rt?.message)})}startsWith(et,rt){return this._addCheck({kind:"startsWith",value:et,...errorUtil.errToObj(rt)})}endsWith(et,rt){return this._addCheck({kind:"endsWith",value:et,...errorUtil.errToObj(rt)})}min(et,rt){return this._addCheck({kind:"min",value:et,...errorUtil.errToObj(rt)})}max(et,rt){return this._addCheck({kind:"max",value:et,...errorUtil.errToObj(rt)})}length(et,rt){return this._addCheck({kind:"length",value:et,...errorUtil.errToObj(rt)})}nonempty(et){return this.min(1,errorUtil.errToObj(et))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((et=>et.kind==="datetime"))}get isDate(){return!!this._def.checks.find((et=>et.kind==="date"))}get isTime(){return!!this._def.checks.find((et=>et.kind==="time"))}get isDuration(){return!!this._def.checks.find((et=>et.kind==="duration"))}get isEmail(){return!!this._def.checks.find((et=>et.kind==="email"))}get isURL(){return!!this._def.checks.find((et=>et.kind==="url"))}get isEmoji(){return!!this._def.checks.find((et=>et.kind==="emoji"))}get isUUID(){return!!this._def.checks.find((et=>et.kind==="uuid"))}get isNANOID(){return!!this._def.checks.find((et=>et.kind==="nanoid"))}get isCUID(){return!!this._def.checks.find((et=>et.kind==="cuid"))}get isCUID2(){return!!this._def.checks.find((et=>et.kind==="cuid2"))}get isULID(){return!!this._def.checks.find((et=>et.kind==="ulid"))}get isIP(){return!!this._def.checks.find((et=>et.kind==="ip"))}get isBase64(){return!!this._def.checks.find((et=>et.kind==="base64"))}get minLength(){let et=null;for(const rt of this._def.checks)rt.kind==="min"&&(et===null||rt.value>et)&&(et=rt.value);return et}get maxLength(){let et=null;for(const rt of this._def.checks)rt.kind==="max"&&(et===null||rt.value<et)&&(et=rt.value);return et}}function floatSafeRemainder(tt,et){const rt=(tt.toString().split(".")[1]||"").length,nt=(et.toString().split(".")[1]||"").length,it=rt>nt?rt:nt;return parseInt(tt.toFixed(it).replace(".",""))%parseInt(et.toFixed(it).replace(".",""))/Math.pow(10,it)}ZodString.create=tt=>{var et;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(et=tt?.coerce)!==null&&et!==void 0&&et,...processCreateParams(tt)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(et){if(this._def.coerce&&(et.data=Number(et.data)),this._getType(et)!==ZodParsedType.number){const it=this._getOrReturnCtx(et);return addIssueToContext(it,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:it.parsedType}),INVALID}let rt;const nt=new ParseStatus;for(const it of this._def.checks)it.kind==="int"?util$1.isInteger(et.data)||(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:it.message}),nt.dirty()):it.kind==="min"?(it.inclusive?et.data<it.value:et.data<=it.value)&&(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.too_small,minimum:it.value,type:"number",inclusive:it.inclusive,exact:!1,message:it.message}),nt.dirty()):it.kind==="max"?(it.inclusive?et.data>it.value:et.data>=it.value)&&(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.too_big,maximum:it.value,type:"number",inclusive:it.inclusive,exact:!1,message:it.message}),nt.dirty()):it.kind==="multipleOf"?floatSafeRemainder(et.data,it.value)!==0&&(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.not_multiple_of,multipleOf:it.value,message:it.message}),nt.dirty()):it.kind==="finite"?Number.isFinite(et.data)||(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.not_finite,message:it.message}),nt.dirty()):util$1.assertNever(it);return{status:nt.value,value:et.data}}gte(et,rt){return this.setLimit("min",et,!0,errorUtil.toString(rt))}gt(et,rt){return this.setLimit("min",et,!1,errorUtil.toString(rt))}lte(et,rt){return this.setLimit("max",et,!0,errorUtil.toString(rt))}lt(et,rt){return this.setLimit("max",et,!1,errorUtil.toString(rt))}setLimit(et,rt,nt,it){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:et,value:rt,inclusive:nt,message:errorUtil.toString(it)}]})}_addCheck(et){return new ZodNumber({...this._def,checks:[...this._def.checks,et]})}int(et){return this._addCheck({kind:"int",message:errorUtil.toString(et)})}positive(et){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(et)})}negative(et){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(et)})}nonpositive(et){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(et)})}nonnegative(et){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(et)})}multipleOf(et,rt){return this._addCheck({kind:"multipleOf",value:et,message:errorUtil.toString(rt)})}finite(et){return this._addCheck({kind:"finite",message:errorUtil.toString(et)})}safe(et){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(et)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(et)})}get minValue(){let et=null;for(const rt of this._def.checks)rt.kind==="min"&&(et===null||rt.value>et)&&(et=rt.value);return et}get maxValue(){let et=null;for(const rt of this._def.checks)rt.kind==="max"&&(et===null||rt.value<et)&&(et=rt.value);return et}get isInt(){return!!this._def.checks.find((et=>et.kind==="int"||et.kind==="multipleOf"&&util$1.isInteger(et.value)))}get isFinite(){let et=null,rt=null;for(const nt of this._def.checks){if(nt.kind==="finite"||nt.kind==="int"||nt.kind==="multipleOf")return!0;nt.kind==="min"?(rt===null||nt.value>rt)&&(rt=nt.value):nt.kind==="max"&&(et===null||nt.value<et)&&(et=nt.value)}return Number.isFinite(rt)&&Number.isFinite(et)}}ZodNumber.create=tt=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:tt?.coerce||!1,...processCreateParams(tt)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(et){if(this._def.coerce&&(et.data=BigInt(et.data)),this._getType(et)!==ZodParsedType.bigint){const it=this._getOrReturnCtx(et);return addIssueToContext(it,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:it.parsedType}),INVALID}let rt;const nt=new ParseStatus;for(const it of this._def.checks)it.kind==="min"?(it.inclusive?et.data<it.value:et.data<=it.value)&&(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.too_small,type:"bigint",minimum:it.value,inclusive:it.inclusive,message:it.message}),nt.dirty()):it.kind==="max"?(it.inclusive?et.data>it.value:et.data>=it.value)&&(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.too_big,type:"bigint",maximum:it.value,inclusive:it.inclusive,message:it.message}),nt.dirty()):it.kind==="multipleOf"?et.data%it.value!==BigInt(0)&&(rt=this._getOrReturnCtx(et,rt),addIssueToContext(rt,{code:ZodIssueCode.not_multiple_of,multipleOf:it.value,message:it.message}),nt.dirty()):util$1.assertNever(it);return{status:nt.value,value:et.data}}gte(et,rt){return this.setLimit("min",et,!0,errorUtil.toString(rt))}gt(et,rt){return this.setLimit("min",et,!1,errorUtil.toString(rt))}lte(et,rt){return this.setLimit("max",et,!0,errorUtil.toString(rt))}lt(et,rt){return this.setLimit("max",et,!1,errorUtil.toString(rt))}setLimit(et,rt,nt,it){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:et,value:rt,inclusive:nt,message:errorUtil.toString(it)}]})}_addCheck(et){return new ZodBigInt({...this._def,checks:[...this._def.checks,et]})}positive(et){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(et)})}negative(et){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(et)})}nonpositive(et){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(et)})}nonnegative(et){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(et)})}multipleOf(et,rt){return this._addCheck({kind:"multipleOf",value:et,message:errorUtil.toString(rt)})}get minValue(){let et=null;for(const rt of this._def.checks)rt.kind==="min"&&(et===null||rt.value>et)&&(et=rt.value);return et}get maxValue(){let et=null;for(const rt of this._def.checks)rt.kind==="max"&&(et===null||rt.value<et)&&(et=rt.value);return et}}ZodBigInt.create=tt=>{var et;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(et=tt?.coerce)!==null&&et!==void 0&&et,...processCreateParams(tt)})};class ZodBoolean extends ZodType{_parse(et){if(this._def.coerce&&(et.data=!!et.data),this._getType(et)!==ZodParsedType.boolean){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:rt.parsedType}),INVALID}return OK(et.data)}}ZodBoolean.create=tt=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:tt?.coerce||!1,...processCreateParams(tt)});class ZodDate extends ZodType{_parse(et){if(this._def.coerce&&(et.data=new Date(et.data)),this._getType(et)!==ZodParsedType.date){const it=this._getOrReturnCtx(et);return addIssueToContext(it,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:it.parsedType}),INVALID}if(isNaN(et.data.getTime()))return addIssueToContext(this._getOrReturnCtx(et),{code:ZodIssueCode.invalid_date}),INVALID;const rt=new ParseStatus;let nt;for(const it of this._def.checks)it.kind==="min"?et.data.getTime()<it.value&&(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.too_small,message:it.message,inclusive:!0,exact:!1,minimum:it.value,type:"date"}),rt.dirty()):it.kind==="max"?et.data.getTime()>it.value&&(nt=this._getOrReturnCtx(et,nt),addIssueToContext(nt,{code:ZodIssueCode.too_big,message:it.message,inclusive:!0,exact:!1,maximum:it.value,type:"date"}),rt.dirty()):util$1.assertNever(it);return{status:rt.value,value:new Date(et.data.getTime())}}_addCheck(et){return new ZodDate({...this._def,checks:[...this._def.checks,et]})}min(et,rt){return this._addCheck({kind:"min",value:et.getTime(),message:errorUtil.toString(rt)})}max(et,rt){return this._addCheck({kind:"max",value:et.getTime(),message:errorUtil.toString(rt)})}get minDate(){let et=null;for(const rt of this._def.checks)rt.kind==="min"&&(et===null||rt.value>et)&&(et=rt.value);return et!=null?new Date(et):null}get maxDate(){let et=null;for(const rt of this._def.checks)rt.kind==="max"&&(et===null||rt.value<et)&&(et=rt.value);return et!=null?new Date(et):null}}ZodDate.create=tt=>new ZodDate({checks:[],coerce:tt?.coerce||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(tt)});class ZodSymbol extends ZodType{_parse(et){if(this._getType(et)!==ZodParsedType.symbol){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:rt.parsedType}),INVALID}return OK(et.data)}}ZodSymbol.create=tt=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(tt)});class ZodUndefined extends ZodType{_parse(et){if(this._getType(et)!==ZodParsedType.undefined){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:rt.parsedType}),INVALID}return OK(et.data)}}ZodUndefined.create=tt=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(tt)});class ZodNull extends ZodType{_parse(et){if(this._getType(et)!==ZodParsedType.null){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:rt.parsedType}),INVALID}return OK(et.data)}}ZodNull.create=tt=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(tt)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(et){return OK(et.data)}}ZodAny.create=tt=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(tt)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(et){return OK(et.data)}}ZodUnknown.create=tt=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(tt)});class ZodNever extends ZodType{_parse(et){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:rt.parsedType}),INVALID}}ZodNever.create=tt=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(tt)});class ZodVoid extends ZodType{_parse(et){if(this._getType(et)!==ZodParsedType.undefined){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:rt.parsedType}),INVALID}return OK(et.data)}}ZodVoid.create=tt=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(tt)});class ZodArray extends ZodType{_parse(et){const{ctx:rt,status:nt}=this._processInputParams(et),it=this._def;if(rt.parsedType!==ZodParsedType.array)return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:rt.parsedType}),INVALID;if(it.exactLength!==null){const st=rt.data.length>it.exactLength.value,ot=rt.data.length<it.exactLength.value;(st||ot)&&(addIssueToContext(rt,{code:st?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:ot?it.exactLength.value:void 0,maximum:st?it.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:it.exactLength.message}),nt.dirty())}if(it.minLength!==null&&rt.data.length<it.minLength.value&&(addIssueToContext(rt,{code:ZodIssueCode.too_small,minimum:it.minLength.value,type:"array",inclusive:!0,exact:!1,message:it.minLength.message}),nt.dirty()),it.maxLength!==null&&rt.data.length>it.maxLength.value&&(addIssueToContext(rt,{code:ZodIssueCode.too_big,maximum:it.maxLength.value,type:"array",inclusive:!0,exact:!1,message:it.maxLength.message}),nt.dirty()),rt.common.async)return Promise.all([...rt.data].map(((st,ot)=>it.type._parseAsync(new ParseInputLazyPath(rt,st,rt.path,ot))))).then((st=>ParseStatus.mergeArray(nt,st)));const at=[...rt.data].map(((st,ot)=>it.type._parseSync(new ParseInputLazyPath(rt,st,rt.path,ot))));return ParseStatus.mergeArray(nt,at)}get element(){return this._def.type}min(et,rt){return new ZodArray({...this._def,minLength:{value:et,message:errorUtil.toString(rt)}})}max(et,rt){return new ZodArray({...this._def,maxLength:{value:et,message:errorUtil.toString(rt)}})}length(et,rt){return new ZodArray({...this._def,exactLength:{value:et,message:errorUtil.toString(rt)}})}nonempty(et){return this.min(1,et)}}function deepPartialify(tt){if(tt instanceof ZodObject){const et={};for(const rt in tt.shape){const nt=tt.shape[rt];et[rt]=ZodOptional.create(deepPartialify(nt))}return new ZodObject({...tt._def,shape:()=>et})}return tt instanceof ZodArray?new ZodArray({...tt._def,type:deepPartialify(tt.element)}):tt instanceof ZodOptional?ZodOptional.create(deepPartialify(tt.unwrap())):tt instanceof ZodNullable?ZodNullable.create(deepPartialify(tt.unwrap())):tt instanceof ZodTuple?ZodTuple.create(tt.items.map((et=>deepPartialify(et)))):tt}ZodArray.create=(tt,et)=>new ZodArray({type:tt,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(et)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const et=this._def.shape(),rt=util$1.objectKeys(et);return this._cached={shape:et,keys:rt}}_parse(et){if(this._getType(et)!==ZodParsedType.object){const lt=this._getOrReturnCtx(et);return addIssueToContext(lt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:lt.parsedType}),INVALID}const{status:rt,ctx:nt}=this._processInputParams(et),{shape:it,keys:at}=this._getCached(),st=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const lt in nt.data)at.includes(lt)||st.push(lt);const ot=[];for(const lt of at){const ht=it[lt],dt=nt.data[lt];ot.push({key:{status:"valid",value:lt},value:ht._parse(new ParseInputLazyPath(nt,dt,nt.path,lt)),alwaysSet:lt in nt.data})}if(this._def.catchall instanceof ZodNever){const lt=this._def.unknownKeys;if(lt==="passthrough")for(const ht of st)ot.push({key:{status:"valid",value:ht},value:{status:"valid",value:nt.data[ht]}});else if(lt==="strict")st.length>0&&(addIssueToContext(nt,{code:ZodIssueCode.unrecognized_keys,keys:st}),rt.dirty());else if(lt!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const lt=this._def.catchall;for(const ht of st){const dt=nt.data[ht];ot.push({key:{status:"valid",value:ht},value:lt._parse(new ParseInputLazyPath(nt,dt,nt.path,ht)),alwaysSet:ht in nt.data})}}return nt.common.async?Promise.resolve().then((async()=>{const lt=[];for(const ht of ot){const dt=await ht.key,ut=await ht.value;lt.push({key:dt,value:ut,alwaysSet:ht.alwaysSet})}return lt})).then((lt=>ParseStatus.mergeObjectSync(rt,lt))):ParseStatus.mergeObjectSync(rt,ot)}get shape(){return this._def.shape()}strict(et){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...et!==void 0?{errorMap:(rt,nt)=>{var it,at,st,ot;const lt=(st=(at=(it=this._def).errorMap)===null||at===void 0?void 0:at.call(it,rt,nt).message)!==null&&st!==void 0?st:nt.defaultError;return rt.code==="unrecognized_keys"?{message:(ot=errorUtil.errToObj(et).message)!==null&&ot!==void 0?ot:lt}:{message:lt}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(et){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...et})})}merge(et){return new ZodObject({unknownKeys:et._def.unknownKeys,catchall:et._def.catchall,shape:()=>({...this._def.shape(),...et._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(et,rt){return this.augment({[et]:rt})}catchall(et){return new ZodObject({...this._def,catchall:et})}pick(et){const rt={};return util$1.objectKeys(et).forEach((nt=>{et[nt]&&this.shape[nt]&&(rt[nt]=this.shape[nt])})),new ZodObject({...this._def,shape:()=>rt})}omit(et){const rt={};return util$1.objectKeys(this.shape).forEach((nt=>{et[nt]||(rt[nt]=this.shape[nt])})),new ZodObject({...this._def,shape:()=>rt})}deepPartial(){return deepPartialify(this)}partial(et){const rt={};return util$1.objectKeys(this.shape).forEach((nt=>{const it=this.shape[nt];et&&!et[nt]?rt[nt]=it:rt[nt]=it.optional()})),new ZodObject({...this._def,shape:()=>rt})}required(et){const rt={};return util$1.objectKeys(this.shape).forEach((nt=>{if(et&&!et[nt])rt[nt]=this.shape[nt];else{let it=this.shape[nt];for(;it instanceof ZodOptional;)it=it._def.innerType;rt[nt]=it}})),new ZodObject({...this._def,shape:()=>rt})}keyof(){return createZodEnum(util$1.objectKeys(this.shape))}}ZodObject.create=(tt,et)=>new ZodObject({shape:()=>tt,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(et)}),ZodObject.strictCreate=(tt,et)=>new ZodObject({shape:()=>tt,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(et)}),ZodObject.lazycreate=(tt,et)=>new ZodObject({shape:tt,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(et)});class ZodUnion extends ZodType{_parse(et){const{ctx:rt}=this._processInputParams(et),nt=this._def.options;if(rt.common.async)return Promise.all(nt.map((async it=>{const at={...rt,common:{...rt.common,issues:[]},parent:null};return{result:await it._parseAsync({data:rt.data,path:rt.path,parent:at}),ctx:at}}))).then((function(it){for(const st of it)if(st.result.status==="valid")return st.result;for(const st of it)if(st.result.status==="dirty")return rt.common.issues.push(...st.ctx.common.issues),st.result;const at=it.map((st=>new ZodError(st.ctx.common.issues)));return addIssueToContext(rt,{code:ZodIssueCode.invalid_union,unionErrors:at}),INVALID}));{let it;const at=[];for(const ot of nt){const lt={...rt,common:{...rt.common,issues:[]},parent:null},ht=ot._parseSync({data:rt.data,path:rt.path,parent:lt});if(ht.status==="valid")return ht;ht.status!=="dirty"||it||(it={result:ht,ctx:lt}),lt.common.issues.length&&at.push(lt.common.issues)}if(it)return rt.common.issues.push(...it.ctx.common.issues),it.result;const st=at.map((ot=>new ZodError(ot)));return addIssueToContext(rt,{code:ZodIssueCode.invalid_union,unionErrors:st}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(tt,et)=>new ZodUnion({options:tt,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(et)});const getDiscriminator=tt=>tt instanceof ZodLazy?getDiscriminator(tt.schema):tt instanceof ZodEffects?getDiscriminator(tt.innerType()):tt instanceof ZodLiteral?[tt.value]:tt instanceof ZodEnum?tt.options:tt instanceof ZodNativeEnum?util$1.objectValues(tt.enum):tt instanceof ZodDefault?getDiscriminator(tt._def.innerType):tt instanceof ZodUndefined?[void 0]:tt instanceof ZodNull?[null]:tt instanceof ZodOptional?[void 0,...getDiscriminator(tt.unwrap())]:tt instanceof ZodNullable?[null,...getDiscriminator(tt.unwrap())]:tt instanceof ZodBranded||tt instanceof ZodReadonly?getDiscriminator(tt.unwrap()):tt instanceof ZodCatch?getDiscriminator(tt._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(et){const{ctx:rt}=this._processInputParams(et);if(rt.parsedType!==ZodParsedType.object)return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:rt.parsedType}),INVALID;const nt=this.discriminator,it=rt.data[nt],at=this.optionsMap.get(it);return at?rt.common.async?at._parseAsync({data:rt.data,path:rt.path,parent:rt}):at._parseSync({data:rt.data,path:rt.path,parent:rt}):(addIssueToContext(rt,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[nt]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(et,rt,nt){const it=new Map;for(const at of rt){const st=getDiscriminator(at.shape[et]);if(!st.length)throw new Error(`A discriminator value for key \`${et}\` could not be extracted from all schema options`);for(const ot of st){if(it.has(ot))throw new Error(`Discriminator property ${String(et)} has duplicate value ${String(ot)}`);it.set(ot,at)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:et,options:rt,optionsMap:it,...processCreateParams(nt)})}}function mergeValues(tt,et){const rt=getParsedType(tt),nt=getParsedType(et);if(tt===et)return{valid:!0,data:tt};if(rt===ZodParsedType.object&&nt===ZodParsedType.object){const it=util$1.objectKeys(et),at=util$1.objectKeys(tt).filter((ot=>it.indexOf(ot)!==-1)),st={...tt,...et};for(const ot of at){const lt=mergeValues(tt[ot],et[ot]);if(!lt.valid)return{valid:!1};st[ot]=lt.data}return{valid:!0,data:st}}if(rt===ZodParsedType.array&&nt===ZodParsedType.array){if(tt.length!==et.length)return{valid:!1};const it=[];for(let at=0;at<tt.length;at++){const st=mergeValues(tt[at],et[at]);if(!st.valid)return{valid:!1};it.push(st.data)}return{valid:!0,data:it}}return rt===ZodParsedType.date&&nt===ZodParsedType.date&&+tt==+et?{valid:!0,data:tt}:{valid:!1}}class ZodIntersection extends ZodType{_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et),it=(at,st)=>{if(isAborted(at)||isAborted(st))return INVALID;const ot=mergeValues(at.value,st.value);return ot.valid?((isDirty(at)||isDirty(st))&&rt.dirty(),{status:rt.value,value:ot.data}):(addIssueToContext(nt,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return nt.common.async?Promise.all([this._def.left._parseAsync({data:nt.data,path:nt.path,parent:nt}),this._def.right._parseAsync({data:nt.data,path:nt.path,parent:nt})]).then((([at,st])=>it(at,st))):it(this._def.left._parseSync({data:nt.data,path:nt.path,parent:nt}),this._def.right._parseSync({data:nt.data,path:nt.path,parent:nt}))}}ZodIntersection.create=(tt,et,rt)=>new ZodIntersection({left:tt,right:et,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(rt)});class ZodTuple extends ZodType{_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et);if(nt.parsedType!==ZodParsedType.array)return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:nt.parsedType}),INVALID;if(nt.data.length<this._def.items.length)return addIssueToContext(nt,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&nt.data.length>this._def.items.length&&(addIssueToContext(nt,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rt.dirty());const it=[...nt.data].map(((at,st)=>{const ot=this._def.items[st]||this._def.rest;return ot?ot._parse(new ParseInputLazyPath(nt,at,nt.path,st)):null})).filter((at=>!!at));return nt.common.async?Promise.all(it).then((at=>ParseStatus.mergeArray(rt,at))):ParseStatus.mergeArray(rt,it)}get items(){return this._def.items}rest(et){return new ZodTuple({...this._def,rest:et})}}ZodTuple.create=(tt,et)=>{if(!Array.isArray(tt))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:tt,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(et)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et);if(nt.parsedType!==ZodParsedType.object)return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:nt.parsedType}),INVALID;const it=[],at=this._def.keyType,st=this._def.valueType;for(const ot in nt.data)it.push({key:at._parse(new ParseInputLazyPath(nt,ot,nt.path,ot)),value:st._parse(new ParseInputLazyPath(nt,nt.data[ot],nt.path,ot)),alwaysSet:ot in nt.data});return nt.common.async?ParseStatus.mergeObjectAsync(rt,it):ParseStatus.mergeObjectSync(rt,it)}get element(){return this._def.valueType}static create(et,rt,nt){return new ZodRecord(rt instanceof ZodType?{keyType:et,valueType:rt,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(nt)}:{keyType:ZodString.create(),valueType:et,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(rt)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et);if(nt.parsedType!==ZodParsedType.map)return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:nt.parsedType}),INVALID;const it=this._def.keyType,at=this._def.valueType,st=[...nt.data.entries()].map((([ot,lt],ht)=>({key:it._parse(new ParseInputLazyPath(nt,ot,nt.path,[ht,"key"])),value:at._parse(new ParseInputLazyPath(nt,lt,nt.path,[ht,"value"]))})));if(nt.common.async){const ot=new Map;return Promise.resolve().then((async()=>{for(const lt of st){const ht=await lt.key,dt=await lt.value;if(ht.status==="aborted"||dt.status==="aborted")return INVALID;ht.status!=="dirty"&&dt.status!=="dirty"||rt.dirty(),ot.set(ht.value,dt.value)}return{status:rt.value,value:ot}}))}{const ot=new Map;for(const lt of st){const ht=lt.key,dt=lt.value;if(ht.status==="aborted"||dt.status==="aborted")return INVALID;ht.status!=="dirty"&&dt.status!=="dirty"||rt.dirty(),ot.set(ht.value,dt.value)}return{status:rt.value,value:ot}}}}ZodMap.create=(tt,et,rt)=>new ZodMap({valueType:et,keyType:tt,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(rt)});class ZodSet extends ZodType{_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et);if(nt.parsedType!==ZodParsedType.set)return addIssueToContext(nt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:nt.parsedType}),INVALID;const it=this._def;it.minSize!==null&&nt.data.size<it.minSize.value&&(addIssueToContext(nt,{code:ZodIssueCode.too_small,minimum:it.minSize.value,type:"set",inclusive:!0,exact:!1,message:it.minSize.message}),rt.dirty()),it.maxSize!==null&&nt.data.size>it.maxSize.value&&(addIssueToContext(nt,{code:ZodIssueCode.too_big,maximum:it.maxSize.value,type:"set",inclusive:!0,exact:!1,message:it.maxSize.message}),rt.dirty());const at=this._def.valueType;function st(lt){const ht=new Set;for(const dt of lt){if(dt.status==="aborted")return INVALID;dt.status==="dirty"&&rt.dirty(),ht.add(dt.value)}return{status:rt.value,value:ht}}const ot=[...nt.data.values()].map(((lt,ht)=>at._parse(new ParseInputLazyPath(nt,lt,nt.path,ht))));return nt.common.async?Promise.all(ot).then((lt=>st(lt))):st(ot)}min(et,rt){return new ZodSet({...this._def,minSize:{value:et,message:errorUtil.toString(rt)}})}max(et,rt){return new ZodSet({...this._def,maxSize:{value:et,message:errorUtil.toString(rt)}})}size(et,rt){return this.min(et,rt).max(et,rt)}nonempty(et){return this.min(1,et)}}ZodSet.create=(tt,et)=>new ZodSet({valueType:tt,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(et)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(et){const{ctx:rt}=this._processInputParams(et);if(rt.parsedType!==ZodParsedType.function)return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:rt.parsedType}),INVALID;function nt(ot,lt){return makeIssue({data:ot,path:rt.path,errorMaps:[rt.common.contextualErrorMap,rt.schemaErrorMap,getErrorMap(),errorMap].filter((ht=>!!ht)),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:lt}})}function it(ot,lt){return makeIssue({data:ot,path:rt.path,errorMaps:[rt.common.contextualErrorMap,rt.schemaErrorMap,getErrorMap(),errorMap].filter((ht=>!!ht)),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:lt}})}const at={errorMap:rt.common.contextualErrorMap},st=rt.data;if(this._def.returns instanceof ZodPromise){const ot=this;return OK((async function(...lt){const ht=new ZodError([]),dt=await ot._def.args.parseAsync(lt,at).catch((mt=>{throw ht.addIssue(nt(lt,mt)),ht})),ut=await Reflect.apply(st,this,dt);return await ot._def.returns._def.type.parseAsync(ut,at).catch((mt=>{throw ht.addIssue(it(ut,mt)),ht}))}))}{const ot=this;return OK((function(...lt){const ht=ot._def.args.safeParse(lt,at);if(!ht.success)throw new ZodError([nt(lt,ht.error)]);const dt=Reflect.apply(st,this,ht.data),ut=ot._def.returns.safeParse(dt,at);if(!ut.success)throw new ZodError([it(dt,ut.error)]);return ut.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...et){return new ZodFunction({...this._def,args:ZodTuple.create(et).rest(ZodUnknown.create())})}returns(et){return new ZodFunction({...this._def,returns:et})}implement(et){return this.parse(et)}strictImplement(et){return this.parse(et)}static create(et,rt,nt){return new ZodFunction({args:et||ZodTuple.create([]).rest(ZodUnknown.create()),returns:rt||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(nt)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(et){const{ctx:rt}=this._processInputParams(et);return this._def.getter()._parse({data:rt.data,path:rt.path,parent:rt})}}ZodLazy.create=(tt,et)=>new ZodLazy({getter:tt,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(et)});class ZodLiteral extends ZodType{_parse(et){if(et.data!==this._def.value){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{received:rt.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:et.data}}get value(){return this._def.value}}function createZodEnum(tt,et){return new ZodEnum({values:tt,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(et)})}ZodLiteral.create=(tt,et)=>new ZodLiteral({value:tt,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(et)});class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(et){if(typeof et.data!="string"){const rt=this._getOrReturnCtx(et),nt=this._def.values;return addIssueToContext(rt,{expected:util$1.joinValues(nt),received:rt.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(et.data)){const rt=this._getOrReturnCtx(et),nt=this._def.values;return addIssueToContext(rt,{received:rt.data,code:ZodIssueCode.invalid_enum_value,options:nt}),INVALID}return OK(et.data)}get options(){return this._def.values}get enum(){const et={};for(const rt of this._def.values)et[rt]=rt;return et}get Values(){const et={};for(const rt of this._def.values)et[rt]=rt;return et}get Enum(){const et={};for(const rt of this._def.values)et[rt]=rt;return et}extract(et,rt=this._def){return ZodEnum.create(et,{...this._def,...rt})}exclude(et,rt=this._def){return ZodEnum.create(this.options.filter((nt=>!et.includes(nt))),{...this._def,...rt})}}_ZodEnum_cache=new WeakMap,ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(et){const rt=util$1.getValidEnumValues(this._def.values),nt=this._getOrReturnCtx(et);if(nt.parsedType!==ZodParsedType.string&&nt.parsedType!==ZodParsedType.number){const it=util$1.objectValues(rt);return addIssueToContext(nt,{expected:util$1.joinValues(it),received:nt.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util$1.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(et.data)){const it=util$1.objectValues(rt);return addIssueToContext(nt,{received:nt.data,code:ZodIssueCode.invalid_enum_value,options:it}),INVALID}return OK(et.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap,ZodNativeEnum.create=(tt,et)=>new ZodNativeEnum({values:tt,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(et)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(et){const{ctx:rt}=this._processInputParams(et);if(rt.parsedType!==ZodParsedType.promise&&rt.common.async===!1)return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:rt.parsedType}),INVALID;const nt=rt.parsedType===ZodParsedType.promise?rt.data:Promise.resolve(rt.data);return OK(nt.then((it=>this._def.type.parseAsync(it,{path:rt.path,errorMap:rt.common.contextualErrorMap}))))}}ZodPromise.create=(tt,et)=>new ZodPromise({type:tt,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(et)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et),it=this._def.effect||null,at={addIssue:st=>{addIssueToContext(nt,st),st.fatal?rt.abort():rt.dirty()},get path(){return nt.path}};if(at.addIssue=at.addIssue.bind(at),it.type==="preprocess"){const st=it.transform(nt.data,at);if(nt.common.async)return Promise.resolve(st).then((async ot=>{if(rt.value==="aborted")return INVALID;const lt=await this._def.schema._parseAsync({data:ot,path:nt.path,parent:nt});return lt.status==="aborted"?INVALID:lt.status==="dirty"||rt.value==="dirty"?DIRTY(lt.value):lt}));{if(rt.value==="aborted")return INVALID;const ot=this._def.schema._parseSync({data:st,path:nt.path,parent:nt});return ot.status==="aborted"?INVALID:ot.status==="dirty"||rt.value==="dirty"?DIRTY(ot.value):ot}}if(it.type==="refinement"){const st=ot=>{const lt=it.refinement(ot,at);if(nt.common.async)return Promise.resolve(lt);if(lt instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return ot};if(nt.common.async===!1){const ot=this._def.schema._parseSync({data:nt.data,path:nt.path,parent:nt});return ot.status==="aborted"?INVALID:(ot.status==="dirty"&&rt.dirty(),st(ot.value),{status:rt.value,value:ot.value})}return this._def.schema._parseAsync({data:nt.data,path:nt.path,parent:nt}).then((ot=>ot.status==="aborted"?INVALID:(ot.status==="dirty"&&rt.dirty(),st(ot.value).then((()=>({status:rt.value,value:ot.value}))))))}if(it.type==="transform"){if(nt.common.async===!1){const st=this._def.schema._parseSync({data:nt.data,path:nt.path,parent:nt});if(!isValid(st))return st;const ot=it.transform(st.value,at);if(ot instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:rt.value,value:ot}}return this._def.schema._parseAsync({data:nt.data,path:nt.path,parent:nt}).then((st=>isValid(st)?Promise.resolve(it.transform(st.value,at)).then((ot=>({status:rt.value,value:ot}))):st))}util$1.assertNever(it)}}ZodEffects.create=(tt,et,rt)=>new ZodEffects({schema:tt,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:et,...processCreateParams(rt)}),ZodEffects.createWithPreprocess=(tt,et,rt)=>new ZodEffects({schema:et,effect:{type:"preprocess",transform:tt},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(rt)});class ZodOptional extends ZodType{_parse(et){return this._getType(et)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(et)}unwrap(){return this._def.innerType}}ZodOptional.create=(tt,et)=>new ZodOptional({innerType:tt,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(et)});class ZodNullable extends ZodType{_parse(et){return this._getType(et)===ZodParsedType.null?OK(null):this._def.innerType._parse(et)}unwrap(){return this._def.innerType}}ZodNullable.create=(tt,et)=>new ZodNullable({innerType:tt,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(et)});class ZodDefault extends ZodType{_parse(et){const{ctx:rt}=this._processInputParams(et);let nt=rt.data;return rt.parsedType===ZodParsedType.undefined&&(nt=this._def.defaultValue()),this._def.innerType._parse({data:nt,path:rt.path,parent:rt})}removeDefault(){return this._def.innerType}}ZodDefault.create=(tt,et)=>new ZodDefault({innerType:tt,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof et.default=="function"?et.default:()=>et.default,...processCreateParams(et)});class ZodCatch extends ZodType{_parse(et){const{ctx:rt}=this._processInputParams(et),nt={...rt,common:{...rt.common,issues:[]}},it=this._def.innerType._parse({data:nt.data,path:nt.path,parent:{...nt}});return isAsync(it)?it.then((at=>({status:"valid",value:at.status==="valid"?at.value:this._def.catchValue({get error(){return new ZodError(nt.common.issues)},input:nt.data})}))):{status:"valid",value:it.status==="valid"?it.value:this._def.catchValue({get error(){return new ZodError(nt.common.issues)},input:nt.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(tt,et)=>new ZodCatch({innerType:tt,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof et.catch=="function"?et.catch:()=>et.catch,...processCreateParams(et)});class ZodNaN extends ZodType{_parse(et){if(this._getType(et)!==ZodParsedType.nan){const rt=this._getOrReturnCtx(et);return addIssueToContext(rt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:rt.parsedType}),INVALID}return{status:"valid",value:et.data}}}ZodNaN.create=tt=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(tt)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(et){const{ctx:rt}=this._processInputParams(et),nt=rt.data;return this._def.type._parse({data:nt,path:rt.path,parent:rt})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(et){const{status:rt,ctx:nt}=this._processInputParams(et);if(nt.common.async)return(async()=>{const it=await this._def.in._parseAsync({data:nt.data,path:nt.path,parent:nt});return it.status==="aborted"?INVALID:it.status==="dirty"?(rt.dirty(),DIRTY(it.value)):this._def.out._parseAsync({data:it.value,path:nt.path,parent:nt})})();{const it=this._def.in._parseSync({data:nt.data,path:nt.path,parent:nt});return it.status==="aborted"?INVALID:it.status==="dirty"?(rt.dirty(),{status:"dirty",value:it.value}):this._def.out._parseSync({data:it.value,path:nt.path,parent:nt})}}static create(et,rt){return new ZodPipeline({in:et,out:rt,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(et){const rt=this._def.innerType._parse(et),nt=it=>(isValid(it)&&(it.value=Object.freeze(it.value)),it);return isAsync(rt)?rt.then((it=>nt(it))):nt(rt)}unwrap(){return this._def.innerType}}function custom(tt,et={},rt){return tt?ZodAny.create().superRefine(((nt,it)=>{var at,st;if(!tt(nt)){const ot=typeof et=="function"?et(nt):typeof et=="string"?{message:et}:et,lt=(st=(at=ot.fatal)!==null&&at!==void 0?at:rt)===null||st===void 0||st,ht=typeof ot=="string"?{message:ot}:ot;it.addIssue({code:"custom",...ht,fatal:lt})}})):ZodAny.create()}ZodReadonly.create=(tt,et)=>new ZodReadonly({innerType:tt,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(et)});const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(tt){tt.ZodString="ZodString",tt.ZodNumber="ZodNumber",tt.ZodNaN="ZodNaN",tt.ZodBigInt="ZodBigInt",tt.ZodBoolean="ZodBoolean",tt.ZodDate="ZodDate",tt.ZodSymbol="ZodSymbol",tt.ZodUndefined="ZodUndefined",tt.ZodNull="ZodNull",tt.ZodAny="ZodAny",tt.ZodUnknown="ZodUnknown",tt.ZodNever="ZodNever",tt.ZodVoid="ZodVoid",tt.ZodArray="ZodArray",tt.ZodObject="ZodObject",tt.ZodUnion="ZodUnion",tt.ZodDiscriminatedUnion="ZodDiscriminatedUnion",tt.ZodIntersection="ZodIntersection",tt.ZodTuple="ZodTuple",tt.ZodRecord="ZodRecord",tt.ZodMap="ZodMap",tt.ZodSet="ZodSet",tt.ZodFunction="ZodFunction",tt.ZodLazy="ZodLazy",tt.ZodLiteral="ZodLiteral",tt.ZodEnum="ZodEnum",tt.ZodEffects="ZodEffects",tt.ZodNativeEnum="ZodNativeEnum",tt.ZodOptional="ZodOptional",tt.ZodNullable="ZodNullable",tt.ZodDefault="ZodDefault",tt.ZodCatch="ZodCatch",tt.ZodPromise="ZodPromise",tt.ZodBranded="ZodBranded",tt.ZodPipeline="ZodPipeline",tt.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(tt,et={message:`Input not instance of ${tt.name}`})=>custom((rt=>rt instanceof tt),et),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:tt=>ZodString.create({...tt,coerce:!0}),number:tt=>ZodNumber.create({...tt,coerce:!0}),boolean:tt=>ZodBoolean.create({...tt,coerce:!0}),bigint:tt=>ZodBigInt.create({...tt,coerce:!0}),date:tt=>ZodDate.create({...tt,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util$1},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError}),Edge,Edge2;Edge2=Edge||(Edge={}),Edge2[Edge2.EXTEND=1]="EXTEND",Edge2[Edge2.WRAP=2]="WRAP",Edge2[Edge2.CROP=3]="CROP";const JimpClassSchema=z.object({bitmap:z.object({data:z.union([z.instanceof(Buffer$1),z.instanceof(Uint8Array)]),width:z.number(),height:z.number()})}),BlitOptionsSchemaComplex=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional(),srcX:z.number().optional(),srcY:z.number().optional(),srcW:z.number().optional(),srcH:z.number().optional()}),BlitOptionsSchema=z.union([JimpClassSchema,BlitOptionsSchemaComplex]),methods$h={blit(tt,et){const rt=BlitOptionsSchema.parse(et);let{src:nt,x:it=0,y:at=0,srcX:st=0,srcY:ot=0,srcW:lt=nt.bitmap.width,srcH:ht=nt.bitmap.height}="bitmap"in rt?{src:rt}:rt;if(!("bitmap"in nt))throw new Error("The source must be a Jimp image");if(typeof it!="number"||typeof at!="number")throw new Error("x and y must be numbers");it=Math.round(it),at=Math.round(at),st=Math.round(st),ot=Math.round(ot),lt=Math.round(lt),ht=Math.round(ht);const dt=tt.bitmap.width,ut=tt.bitmap.height;return scan(nt,st,ot,lt,ht,(function(ft,mt,gt){const vt=it+ft-st,xt=at+mt-ot;if(vt>=0&&xt>=0&&dt-vt>0&&ut-xt>0){const wt=tt.getPixelIndex(vt,xt),At={r:nt.bitmap.data[gt]||0,g:nt.bitmap.data[gt+1]||0,b:nt.bitmap.data[gt+2]||0,a:nt.bitmap.data[gt+3]||0},Tt={r:tt.bitmap.data[wt]||0,g:tt.bitmap.data[wt+1]||0,b:tt.bitmap.data[wt+2]||0,a:tt.bitmap.data[wt+3]||0};tt.bitmap.data[wt]=(At.a*(At.r-Tt.r)-Tt.r+255>>8)+Tt.r,tt.bitmap.data[wt+1]=(At.a*(At.g-Tt.g)-Tt.g+255>>8)+Tt.g,tt.bitmap.data[wt+2]=(At.a*(At.b-Tt.b)-Tt.b+255>>8)+Tt.b,tt.bitmap.data[wt+3]=limit255(Tt.a+At.a)}})),tt}},mulTable=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],shgTable=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18],methods$g={blur(tt,et){if(typeof et!="number")throw new Error("r must be a number");if(et<1)throw new Error("r must be greater than 0");let rt,nt,it,at,st,ot,lt,ht,dt,ut,ft,mt,gt;const vt=tt.bitmap.width-1,xt=tt.bitmap.height-1,wt=et+1,At=mulTable[et],Tt=shgTable[et],Pt=[],Rt=[],Ot=[],Et=[],Lt=[],kt=[];let jt=2;for(;jt-- >0;){for(mt=0,gt=0,ot=0;ot<tt.bitmap.height;ot++){for(rt=tt.bitmap.data[gt]*wt,nt=tt.bitmap.data[gt+1]*wt,it=tt.bitmap.data[gt+2]*wt,at=tt.bitmap.data[gt+3]*wt,lt=1;lt<=et;lt++)ht=gt+((lt>vt?vt:lt)<<2),rt+=tt.bitmap.data[ht++],nt+=tt.bitmap.data[ht++],it+=tt.bitmap.data[ht++],at+=tt.bitmap.data[ht];for(st=0;st<tt.bitmap.width;st++)Pt[mt]=rt,Rt[mt]=nt,Ot[mt]=it,Et[mt]=at,ot===0&&(Lt[st]=((ht=st+wt)<vt?ht:vt)<<2,kt[st]=(ht=st-et)>0?ht<<2:0),dt=gt+Lt[st],ut=gt+kt[st],rt+=tt.bitmap.data[dt++]-tt.bitmap.data[ut++],nt+=tt.bitmap.data[dt++]-tt.bitmap.data[ut++],it+=tt.bitmap.data[dt++]-tt.bitmap.data[ut++],at+=tt.bitmap.data[dt]-tt.bitmap.data[ut++],mt++;gt+=tt.bitmap.width<<2}for(st=0;st<tt.bitmap.width;st++){for(ft=st,rt=Pt[ft]*wt,nt=Rt[ft]*wt,it=Ot[ft]*wt,at=Et[ft]*wt,lt=1;lt<=et;lt++)ft+=lt>xt?0:tt.bitmap.width,rt+=Pt[ft],nt+=Rt[ft],it+=Ot[ft],at+=Et[ft];for(mt=st<<2,ot=0;ot<tt.bitmap.height;ot++)tt.bitmap.data[mt]=limit255(rt*At>>>Tt),tt.bitmap.data[mt+1]=limit255(nt*At>>>Tt),tt.bitmap.data[mt+2]=limit255(it*At>>>Tt),tt.bitmap.data[mt+3]=limit255(at*At>>>Tt),st===0&&(Lt[ot]=((ht=ot+wt)<xt?ht:xt)*tt.bitmap.width,kt[ot]=(ht=ot-et)>0?ht*tt.bitmap.width:0),dt=st+Lt[ot],ut=st+kt[ot],rt+=Pt[dt]-Pt[ut],nt+=Rt[dt]-Rt[ut],it+=Ot[dt]-Ot[ut],at+=Et[dt]-Et[ut],mt+=tt.bitmap.width<<2}}return tt},gaussian(tt,et){if(typeof et!="number")throw new Error("r must be a number");if(et<1)throw new Error("r must be greater than 0");const rt=Math.ceil(2.57*et),nt=2*rt+1,it=et*et*2,at=it*Math.PI,st=[];for(let ot=0;ot<nt;ot++){const lt=[];for(let ht=0;ht<nt;ht++){const dt=(ht-rt)**2+(ot-rt)**2;lt[ht]=Math.exp(-dt/it)/at}st.push(lt)}for(let ot=0;ot<tt.bitmap.height;ot++)for(let lt=0;lt<tt.bitmap.width;lt++){let ht=0,dt=0,ut=0,ft=0,mt=0;for(let gt=0;gt<nt;gt++){for(let xt=0;xt<nt;xt++){const wt=Math.min(tt.bitmap.width-1,Math.max(0,xt+lt-rt)),At=Math.min(tt.bitmap.height-1,Math.max(0,gt+ot-rt)),Tt=st[gt][xt],Pt=At*tt.bitmap.width+wt<<2;ht+=tt.bitmap.data[Pt]*Tt,dt+=tt.bitmap.data[Pt+1]*Tt,ut+=tt.bitmap.data[Pt+2]*Tt,ft+=tt.bitmap.data[Pt+3]*Tt,mt+=Tt}const vt=ot*tt.bitmap.width+lt<<2;tt.bitmap.data[vt]=Math.round(ht/mt),tt.bitmap.data[vt+1]=Math.round(dt/mt),tt.bitmap.data[vt+2]=Math.round(ut/mt),tt.bitmap.data[vt+3]=Math.round(ft/mt)}}return tt}},CircleOptionsSchema=z.object({x:z.number().optional(),y:z.number().optional(),radius:z.number().min(0).optional()}),methods$f={circle(tt,et={}){const rt=CircleOptionsSchema.parse(et),nt=rt.radius||(tt.bitmap.width>tt.bitmap.height?tt.bitmap.height:tt.bitmap.width)/2,it=typeof rt.x=="number"?rt.x:tt.bitmap.width/2,at=typeof rt.y=="number"?rt.y:tt.bitmap.height/2;return tt.scan(((st,ot,lt)=>{const ht=Math.sqrt(Math.pow(st-it,2)+Math.pow(ot-at,2));nt-ht<=0?tt.bitmap.data[lt+3]=0:nt-ht<1&&(tt.bitmap.data[lt+3]=255*(nt-ht))})),tt}},ConvolutionMatrixSchema=z.array(z.number()).min(1).array(),ConvolutionComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,edgeHandling:z.nativeEnum(Edge).optional()}),ConvolutionOptionsSchema=z.union([ConvolutionMatrixSchema,ConvolutionComplexOptionsSchema]),ConvoluteComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),ConvoluteOptionsSchema=z.union([ConvolutionMatrixSchema,ConvoluteComplexOptionsSchema]),PixelateSize=z.number().min(1).max(1/0),PixelateComplexOptionsSchema=z.object({size:PixelateSize,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),PixelateOptionsSchema=z.union([PixelateSize,PixelateComplexOptionsSchema]);function applyKernel(tt,et,rt,nt){const it=[0,0,0,0],at=(et.length-1)/2;for(let st=0;st<et.length;st+=1)for(let ot=0;ot<et[st].length;ot+=1){const lt=tt.getPixelIndex(rt+st-at,nt+ot-at);it[0]+=tt.bitmap.data[lt]*et[st][ot],it[1]+=tt.bitmap.data[lt+1]*et[st][ot],it[2]+=tt.bitmap.data[lt+2]*et[st][ot],it[3]+=tt.bitmap.data[lt+3]*et[st][ot]}return it}function mix(tt,et,rt=50){return{r:(et.r-tt.r)*(rt/100)+tt.r,g:(et.g-tt.g)*(rt/100)+tt.g,b:(et.b-tt.b)*(rt/100)+tt.b}}const HueActionSchema=z.object({apply:z.literal("hue"),params:z.tuple([z.number().min(-360).max(360)])}),SpinActionSchema=z.object({apply:z.literal("spin"),params:z.tuple([z.number().min(-360).max(360)])}),LightenActionSchema=z.object({apply:z.literal("lighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),RGBColorSchema=z.object({r:z.number().min(0).max(255),g:z.number().min(0).max(255),b:z.number().min(0).max(255)}),MixActionSchema=z.object({apply:z.literal("mix"),params:z.union([z.tuple([RGBColorSchema]),z.tuple([RGBColorSchema,z.number().min(0).max(100)])])}),TintActionSchema=z.object({apply:z.literal("tint"),params:z.tuple([z.number().min(0).max(100)]).optional()}),ShadeActionSchema=z.object({apply:z.literal("shade"),params:z.tuple([z.number().min(0).max(100)]).optional()}),XorActionSchema=z.object({apply:z.literal("xor"),params:z.tuple([RGBColorSchema])}),RedActionSchema=z.object({apply:z.literal("red"),params:z.tuple([z.number().min(-255).max(255)])}),GreenActionSchema=z.object({apply:z.literal("green"),params:z.tuple([z.number().min(-255).max(255)])}),BlueActionSchema=z.object({apply:z.literal("blue"),params:z.tuple([z.number().min(-255).max(255)])}),BrightenActionSchema=z.object({apply:z.literal("brighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DarkenActionSchema=z.object({apply:z.literal("darken"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DesaturateActionSchema=z.object({apply:z.literal("desaturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),SaturateActionSchema=z.object({apply:z.literal("saturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),GrayscaleActionSchema=z.object({apply:z.literal("greyscale"),params:z.tuple([]).optional()}),ColorActionNameSchema=z.union([HueActionSchema,SpinActionSchema,LightenActionSchema,MixActionSchema,TintActionSchema,ShadeActionSchema,XorActionSchema,RedActionSchema,GreenActionSchema,BlueActionSchema,BrightenActionSchema,DarkenActionSchema,DesaturateActionSchema,SaturateActionSchema,GrayscaleActionSchema]);function histogram(tt){const et={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return tt.scan(((rt,nt,it)=>{et.r[tt.bitmap.data[it+0]]++,et.g[tt.bitmap.data[it+1]]++,et.b[tt.bitmap.data[it+2]]++})),et}const normalizeValue=function(tt,et,rt){return 255*(tt-et)/(rt-et)},getBounds=function(tt){return[tt.findIndex((et=>et>0)),255-tt.slice().reverse().findIndex((et=>et>0))]},methods$e={normalize(tt){const et=histogram(tt),rt={r:getBounds(et.r),g:getBounds(et.g),b:getBounds(et.b)};return tt.scan(((nt,it,at)=>{const st=tt.bitmap.data[at+0],ot=tt.bitmap.data[at+1],lt=tt.bitmap.data[at+2];tt.bitmap.data[at+0]=normalizeValue(st,rt.r[0],rt.r[1]),tt.bitmap.data[at+1]=normalizeValue(ot,rt.g[0],rt.g[1]),tt.bitmap.data[at+2]=normalizeValue(lt,rt.b[0],rt.b[1])})),tt},invert:tt=>(tt.scan(((et,rt,nt)=>{tt.bitmap.data[nt]=255-tt.bitmap.data[nt],tt.bitmap.data[nt+1]=255-tt.bitmap.data[nt+1],tt.bitmap.data[nt+2]=255-tt.bitmap.data[nt+2]})),tt),brightness(tt,et){if(typeof et!="number")throw new Error("val must be numbers");return tt.scan(((rt,nt,it)=>{tt.bitmap.data[it]=limit255(tt.bitmap.data[it]*et),tt.bitmap.data[it+1]=limit255(tt.bitmap.data[it+1]*et),tt.bitmap.data[it+2]=limit255(tt.bitmap.data[it+2]*et)})),tt},contrast(tt,et){if(typeof et!="number")throw new Error("val must be numbers");if(et<-1||et>1)throw new Error("val must be a number between -1 and +1");const rt=(et+1)/(1-et);function nt(it){return(it=Math.floor(rt*(it-127)+127))<0?0:it>255?255:it}return tt.scan(((it,at,st)=>{tt.bitmap.data[st]=nt(tt.bitmap.data[st]),tt.bitmap.data[st+1]=nt(tt.bitmap.data[st+1]),tt.bitmap.data[st+2]=nt(tt.bitmap.data[st+2])})),tt},posterize(tt,et){if(typeof et!="number")throw new Error("n must be numbers");return et<2&&(et=2),tt.scan(((rt,nt,it)=>{const at=tt.bitmap.data[it],st=tt.bitmap.data[it+1],ot=tt.bitmap.data[it+2];tt.bitmap.data[it]=Math.floor(at/255*(et-1))/(et-1)*255,tt.bitmap.data[it+1]=Math.floor(st/255*(et-1))/(et-1)*255,tt.bitmap.data[it+2]=Math.floor(ot/255*(et-1))/(et-1)*255})),tt},greyscale:tt=>(tt.scan(((et,rt,nt)=>{const it=.2126*tt.bitmap.data[nt]+.7152*tt.bitmap.data[nt+1]+.0722*tt.bitmap.data[nt+2];tt.bitmap.data[nt]=it,tt.bitmap.data[nt+1]=it,tt.bitmap.data[nt+2]=it})),tt),opacity(tt,et){if(typeof et!="number")throw new Error("f must be a number");if(et<0||et>1)throw new Error("f must be a number from 0 to 1");return tt.scan(((rt,nt,it)=>{const at=tt.bitmap.data[it+3]*et;tt.bitmap.data[it+3]=at})),tt},sepia:tt=>(tt.scan(((et,rt,nt)=>{let it=tt.bitmap.data[nt],at=tt.bitmap.data[nt+1],st=tt.bitmap.data[nt+2];it=.393*it+.769*at+.189*st,at=.349*it+.686*at+.168*st,st=.272*it+.534*at+.131*st,tt.bitmap.data[nt]=it<255?it:255,tt.bitmap.data[nt+1]=at<255?at:255,tt.bitmap.data[nt+2]=st<255?st:255})),tt),fade(tt,et){if(typeof et!="number")throw new Error("f must be a number");if(et<0||et>1)throw new Error("f must be a number from 0 to 1");return this.opacity(tt,1-et)},convolution(tt,et){const rt=ConvolutionOptionsSchema.parse(et),{kernel:nt,edgeHandling:it=Edge.EXTEND}="kernel"in rt?rt:{kernel:rt,edgeHandling:void 0};if(!nt[0])throw new Error("kernel must be a matrix");const at=Buffer$1.from(tt.bitmap.data),st=nt.length,ot=nt[0].length,lt=Math.floor(st/2),ht=Math.floor(ot/2),dt=-lt,ut=-ht;let ft,mt,gt,vt,xt,wt,At,Tt,Pt,Rt;return tt.scan(((Ot,Et,Lt)=>{vt=0,gt=0,mt=0;for(let kt=dt;kt<=lt;kt++)for(let jt=ut;jt<=ht;jt++)Tt=Ot+jt,Pt=Et+kt,ft=nt[kt+lt][jt+ht],Rt=tt.getPixelIndex(Tt,Pt,it),Rt===-1?(At=0,wt=0,xt=0):(xt=tt.bitmap.data[Rt+0],wt=tt.bitmap.data[Rt+1],At=tt.bitmap.data[Rt+2]),mt+=ft*xt,gt+=ft*wt,vt+=ft*At;mt<0&&(mt=0),gt<0&&(gt=0),vt<0&&(vt=0),mt>255&&(mt=255),gt>255&&(gt=255),vt>255&&(vt=255),at[Lt+0]=mt,at[Lt+1]=gt,at[Lt+2]=vt})),tt.bitmap.data=at,tt},opaque:tt=>(tt.scan(((et,rt,nt)=>{tt.bitmap.data[nt+3]=255})),tt),pixelate(tt,et){const rt=PixelateOptionsSchema.parse(et),{size:nt,x:it=0,y:at=0,w:st=tt.bitmap.width-it,h:ot=tt.bitmap.height-at}=typeof rt=="number"?{size:rt}:rt,lt=[[1/16,2/16,1/16],[2/16,.25,2/16],[1/16,2/16,1/16]],ht=clone(tt);return scan(ht,it,at,st,ot,((dt,ut,ft)=>{dt=nt*Math.floor(dt/nt),ut=nt*Math.floor(ut/nt);const mt=applyKernel(ht,lt,dt,ut);tt.bitmap.data[ft]=mt[0],tt.bitmap.data[ft+1]=mt[1],tt.bitmap.data[ft+2]=mt[2],tt.bitmap.data[ft+3]=mt[3]})),tt},convolute(tt,et){const rt=ConvoluteOptionsSchema.parse(et),{kernel:nt,x:it=0,y:at=0,w:st=tt.bitmap.width-it,h:ot=tt.bitmap.height-at}="kernel"in rt?rt:{kernel:rt},lt=clone(tt);return scan(lt,it,at,st,ot,((ht,dt,ut)=>{const ft=applyKernel(lt,nt,ht,dt);tt.bitmap.data[ut]=limit255(ft[0]),tt.bitmap.data[ut+1]=limit255(ft[1]),tt.bitmap.data[ut+2]=limit255(ft[2]),tt.bitmap.data[ut+3]=limit255(ft[3])})),tt},color(tt,et){if(!et||!Array.isArray(et))throw new Error("actions must be an array");return et.forEach((rt=>ColorActionNameSchema.parse(rt))),et=et.map((rt=>(rt.apply!=="xor"&&rt.apply!=="mix"||(rt.params[0]=tinycolor(rt.params[0]).toRgb()),rt))),tt.scan(((rt,nt,it)=>{let at={r:tt.bitmap.data[it],g:tt.bitmap.data[it+1],b:tt.bitmap.data[it+2]};const st=(ot,lt)=>limit255(at[ot]+lt);et.forEach((ot=>{if(ot.apply==="mix")at=mix(at,ot.params[0],ot.params[1]);else if(ot.apply==="tint")at=mix(at,{r:255,g:255,b:255},ot.params?.[0]);else if(ot.apply==="shade")at=mix(at,{r:0,g:0,b:0},ot.params?.[0]);else if(ot.apply==="xor")at={r:at.r^ot.params[0].r,g:at.g^ot.params[0].g,b:at.b^ot.params[0].b};else if(ot.apply==="red")at.r=st("r",ot.params[0]);else if(ot.apply==="green")at.g=st("g",ot.params[0]);else if(ot.apply==="blue")at.b=st("b",ot.params[0]);else{ot.apply==="hue"&&(ot.apply="spin");const lt=tinycolor(at),ht=lt[ot.apply].bind(lt);if(!ht)throw new Error("action "+ot.apply+" not supported");at=ht(...ot.params||[]).toRgb()}})),tt.bitmap.data[it]=at.r,tt.bitmap.data[it+1]=at.g,tt.bitmap.data[it+2]=at.b})),tt}};var lib$1={},ieee754={read:function(tt,et,rt,nt,it){var at,st,ot=8*it-nt-1,lt=(1<<ot)-1,ht=lt>>1,dt=-7,ut=rt?it-1:0,ft=rt?-1:1,mt=tt[et+ut];for(ut+=ft,at=mt&(1<<-dt)-1,mt>>=-dt,dt+=ot;dt>0;at=256*at+tt[et+ut],ut+=ft,dt-=8);for(st=at&(1<<-dt)-1,at>>=-dt,dt+=nt;dt>0;st=256*st+tt[et+ut],ut+=ft,dt-=8);if(at===0)at=1-ht;else{if(at===lt)return st?NaN:1/0*(mt?-1:1);st+=Math.pow(2,nt),at-=ht}return(mt?-1:1)*st*Math.pow(2,at-nt)},write:function(tt,et,rt,nt,it,at){var st,ot,lt,ht=8*at-it-1,dt=(1<<ht)-1,ut=dt>>1,ft=it===23?Math.pow(2,-24)-Math.pow(2,-77):0,mt=nt?0:at-1,gt=nt?1:-1,vt=et<0||et===0&&1/et<0?1:0;for(et=Math.abs(et),isNaN(et)||et===1/0?(ot=isNaN(et)?1:0,st=dt):(st=Math.floor(Math.log(et)/Math.LN2),et*(lt=Math.pow(2,-st))<1&&(st--,lt*=2),(et+=st+ut>=1?ft/lt:ft*Math.pow(2,1-ut))*lt>=2&&(st++,lt/=2),st+ut>=dt?(ot=0,st=dt):st+ut>=1?(ot=(et*lt-1)*Math.pow(2,it),st+=ut):(ot=et*Math.pow(2,ut-1)*Math.pow(2,it),st=0));it>=8;tt[rt+mt]=255&ot,mt+=gt,ot/=256,it-=8);for(st=st<<it|ot,ht+=it;ht>0;tt[rt+mt]=255&st,mt+=gt,st/=256,ht-=8);tt[rt+mt-gt]|=128*vt}};(function(tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.AnsiStringType=tt.StringType=tt.BufferType=tt.Uint8ArrayType=tt.IgnoreType=tt.Float80_LE=tt.Float80_BE=tt.Float64_LE=tt.Float64_BE=tt.Float32_LE=tt.Float32_BE=tt.Float16_LE=tt.Float16_BE=tt.INT64_BE=tt.UINT64_BE=tt.INT64_LE=tt.UINT64_LE=tt.INT32_LE=tt.INT32_BE=tt.INT24_BE=tt.INT24_LE=tt.INT16_LE=tt.INT16_BE=tt.INT8=tt.UINT32_BE=tt.UINT32_LE=tt.UINT24_BE=tt.UINT24_LE=tt.UINT16_BE=tt.UINT16_LE=tt.UINT8=void 0;const et=ieee754;function rt(it){return new DataView(it.buffer,it.byteOffset)}tt.UINT8={len:1,get:(it,at)=>rt(it).getUint8(at),put:(it,at,st)=>(rt(it).setUint8(at,st),at+1)},tt.UINT16_LE={len:2,get:(it,at)=>rt(it).getUint16(at,!0),put:(it,at,st)=>(rt(it).setUint16(at,st,!0),at+2)},tt.UINT16_BE={len:2,get:(it,at)=>rt(it).getUint16(at),put:(it,at,st)=>(rt(it).setUint16(at,st),at+2)},tt.UINT24_LE={len:3,get(it,at){const st=rt(it);return st.getUint8(at)+(st.getUint16(at+1,!0)<<8)},put(it,at,st){const ot=rt(it);return ot.setUint8(at,255&st),ot.setUint16(at+1,st>>8,!0),at+3}},tt.UINT24_BE={len:3,get(it,at){const st=rt(it);return(st.getUint16(at)<<8)+st.getUint8(at+2)},put(it,at,st){const ot=rt(it);return ot.setUint16(at,st>>8),ot.setUint8(at+2,255&st),at+3}},tt.UINT32_LE={len:4,get:(it,at)=>rt(it).getUint32(at,!0),put:(it,at,st)=>(rt(it).setUint32(at,st,!0),at+4)},tt.UINT32_BE={len:4,get:(it,at)=>rt(it).getUint32(at),put:(it,at,st)=>(rt(it).setUint32(at,st),at+4)},tt.INT8={len:1,get:(it,at)=>rt(it).getInt8(at),put:(it,at,st)=>(rt(it).setInt8(at,st),at+1)},tt.INT16_BE={len:2,get:(it,at)=>rt(it).getInt16(at),put:(it,at,st)=>(rt(it).setInt16(at,st),at+2)},tt.INT16_LE={len:2,get:(it,at)=>rt(it).getInt16(at,!0),put:(it,at,st)=>(rt(it).setInt16(at,st,!0),at+2)},tt.INT24_LE={len:3,get(it,at){const st=tt.UINT24_LE.get(it,at);return st>8388607?st-16777216:st},put(it,at,st){const ot=rt(it);return ot.setUint8(at,255&st),ot.setUint16(at+1,st>>8,!0),at+3}},tt.INT24_BE={len:3,get(it,at){const st=tt.UINT24_BE.get(it,at);return st>8388607?st-16777216:st},put(it,at,st){const ot=rt(it);return ot.setUint16(at,st>>8),ot.setUint8(at+2,255&st),at+3}},tt.INT32_BE={len:4,get:(it,at)=>rt(it).getInt32(at),put:(it,at,st)=>(rt(it).setInt32(at,st),at+4)},tt.INT32_LE={len:4,get:(it,at)=>rt(it).getInt32(at,!0),put:(it,at,st)=>(rt(it).setInt32(at,st,!0),at+4)},tt.UINT64_LE={len:8,get:(it,at)=>rt(it).getBigUint64(at,!0),put:(it,at,st)=>(rt(it).setBigUint64(at,st,!0),at+8)},tt.INT64_LE={len:8,get:(it,at)=>rt(it).getBigInt64(at,!0),put:(it,at,st)=>(rt(it).setBigInt64(at,st,!0),at+8)},tt.UINT64_BE={len:8,get:(it,at)=>rt(it).getBigUint64(at),put:(it,at,st)=>(rt(it).setBigUint64(at,st),at+8)},tt.INT64_BE={len:8,get:(it,at)=>rt(it).getBigInt64(at),put:(it,at,st)=>(rt(it).setBigInt64(at,st),at+8)},tt.Float16_BE={len:2,get(it,at){return et.read(it,at,!1,10,this.len)},put(it,at,st){return et.write(it,st,at,!1,10,this.len),at+this.len}},tt.Float16_LE={len:2,get(it,at){return et.read(it,at,!0,10,this.len)},put(it,at,st){return et.write(it,st,at,!0,10,this.len),at+this.len}},tt.Float32_BE={len:4,get:(it,at)=>rt(it).getFloat32(at),put:(it,at,st)=>(rt(it).setFloat32(at,st),at+4)},tt.Float32_LE={len:4,get:(it,at)=>rt(it).getFloat32(at,!0),put:(it,at,st)=>(rt(it).setFloat32(at,st,!0),at+4)},tt.Float64_BE={len:8,get:(it,at)=>rt(it).getFloat64(at),put:(it,at,st)=>(rt(it).setFloat64(at,st),at+8)},tt.Float64_LE={len:8,get:(it,at)=>rt(it).getFloat64(at,!0),put:(it,at,st)=>(rt(it).setFloat64(at,st,!0),at+8)},tt.Float80_BE={len:10,get(it,at){return et.read(it,at,!1,63,this.len)},put(it,at,st){return et.write(it,st,at,!1,63,this.len),at+this.len}},tt.Float80_LE={len:10,get(it,at){return et.read(it,at,!0,63,this.len)},put(it,at,st){return et.write(it,st,at,!0,63,this.len),at+this.len}},tt.IgnoreType=class{constructor(it){this.len=it}get(it,at){}},tt.Uint8ArrayType=class{constructor(it){this.len=it}get(it,at){return it.subarray(at,at+this.len)}},tt.BufferType=class{constructor(it){this.len=it}get(it,at){return Buffer$1.from(it.subarray(at,at+this.len))}},tt.StringType=class{constructor(it,at){this.len=it,this.encoding=at}get(it,at){return Buffer$1.from(it).toString(this.encoding,at,at+this.len)}};class nt{constructor(at){this.len=at}static decode(at,st,ot){let lt="";for(let ht=st;ht<ot;++ht)lt+=nt.codePointToString(nt.singleByteDecoder(at[ht]));return lt}static inRange(at,st,ot){return st<=at&&at<=ot}static codePointToString(at){return at<=65535?String.fromCharCode(at):(at-=65536,String.fromCharCode(55296+(at>>10),56320+(1023&at)))}static singleByteDecoder(at){if(nt.inRange(at,0,127))return at;const st=nt.windows1252[at-128];if(st===null)throw Error("invaliding encoding");return st}get(at,st=0){return nt.decode(at,st,st+this.len)}}tt.AnsiStringType=nt,nt.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]})(lib$1);var core$1={},ReadStreamTokenizer$1={},AbstractTokenizer$1={},lib={},EndOfFileStream={};(function(tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.EndOfStreamError=tt.defaultMessages=void 0,tt.defaultMessages="End-Of-Stream";class et extends Error{constructor(){super(tt.defaultMessages)}}tt.EndOfStreamError=et})(EndOfFileStream);var StreamReader={},Deferred$1={};Object.defineProperty(Deferred$1,"__esModule",{value:!0}),Deferred$1.Deferred=void 0;class Deferred{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((et,rt)=>{this.reject=rt,this.resolve=et}))}}Deferred$1.Deferred=Deferred,(function(tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.StreamReader=tt.EndOfStreamError=void 0;const et=EndOfFileStream,rt=Deferred$1;var nt=EndOfFileStream;Object.defineProperty(tt,"EndOfStreamError",{enumerable:!0,get:function(){return nt.EndOfStreamError}}),tt.StreamReader=class{constructor(it){if(this.s=it,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!it.read||!it.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new et.EndOfStreamError))),this.s.once("error",(at=>this.reject(at))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(it,at,st){const ot=await this.read(it,at,st);return this.peekQueue.push(it.subarray(at,at+ot)),ot}async read(it,at,st){if(st===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new et.EndOfStreamError;let ot=st,lt=0;for(;this.peekQueue.length>0&&ot>0;){const ht=this.peekQueue.pop();if(!ht)throw new Error("peekData should be defined");const dt=Math.min(ht.length,ot);it.set(ht.subarray(0,dt),at+lt),lt+=dt,ot-=dt,dt<ht.length&&this.peekQueue.push(ht.subarray(dt))}for(;ot>0&&!this.endOfStream;){const ht=Math.min(ot,1048576),dt=await this.readFromStream(it,at+lt,ht);if(lt+=dt,dt<ht)break;ot-=dt}return lt}async readFromStream(it,at,st){const ot=this.s.read(st);if(ot)return it.set(ot,at),ot.length;{const lt={buffer:it,offset:at,length:st,deferred:new rt.Deferred};return this.deferred=lt.deferred,this.s.once("readable",(()=>{this.readDeferred(lt)})),lt.deferred.promise}}readDeferred(it){const at=this.s.read(it.length);at?(it.buffer.set(at,it.offset),it.deferred.resolve(at.length),this.deferred=null):this.s.once("readable",(()=>{this.readDeferred(it)}))}reject(it){this.endOfStream=!0,this.deferred&&(this.deferred.reject(it),this.deferred=null)}}})(StreamReader),(function(tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.StreamReader=tt.EndOfStreamError=void 0;var et=EndOfFileStream;Object.defineProperty(tt,"EndOfStreamError",{enumerable:!0,get:function(){return et.EndOfStreamError}});var rt=StreamReader;Object.defineProperty(tt,"StreamReader",{enumerable:!0,get:function(){return rt.StreamReader}})})(lib),Object.defineProperty(AbstractTokenizer$1,"__esModule",{value:!0}),AbstractTokenizer$1.AbstractTokenizer=void 0;const peek_readable_1$2=lib;class AbstractTokenizer{constructor(et){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=et||{}}async readToken(et,rt=this.position){const nt=Buffer$1.alloc(et.len);if(await this.readBuffer(nt,{position:rt})<et.len)throw new peek_readable_1$2.EndOfStreamError;return et.get(nt,0)}async peekToken(et,rt=this.position){const nt=Buffer$1.alloc(et.len);if(await this.peekBuffer(nt,{position:rt})<et.len)throw new peek_readable_1$2.EndOfStreamError;return et.get(nt,0)}async readNumber(et){if(await this.readBuffer(this.numBuffer,{length:et.len})<et.len)throw new peek_readable_1$2.EndOfStreamError;return et.get(this.numBuffer,0)}async peekNumber(et){if(await this.peekBuffer(this.numBuffer,{length:et.len})<et.len)throw new peek_readable_1$2.EndOfStreamError;return et.get(this.numBuffer,0)}async ignore(et){if(this.fileInfo.size!==void 0){const rt=this.fileInfo.size-this.position;if(et>rt)return this.position+=rt,rt}return this.position+=et,et}async close(){}normalizeOptions(et,rt){if(rt&&rt.position!==void 0&&rt.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return rt?{mayBeLess:rt.mayBeLess===!0,offset:rt.offset?rt.offset:0,length:rt.length?rt.length:et.length-(rt.offset?rt.offset:0),position:rt.position?rt.position:this.position}:{mayBeLess:!1,offset:0,length:et.length,position:this.position}}}AbstractTokenizer$1.AbstractTokenizer=AbstractTokenizer,Object.defineProperty(ReadStreamTokenizer$1,"__esModule",{value:!0}),ReadStreamTokenizer$1.ReadStreamTokenizer=void 0;const AbstractTokenizer_1$1=AbstractTokenizer$1,peek_readable_1$1=lib,maxBufferSize=256e3;class ReadStreamTokenizer extends AbstractTokenizer_1$1.AbstractTokenizer{constructor(et,rt){super(rt),this.streamReader=new peek_readable_1$1.StreamReader(et)}async getFileInfo(){return this.fileInfo}async readBuffer(et,rt){const nt=this.normalizeOptions(et,rt),it=nt.position-this.position;if(it>0)return await this.ignore(it),this.readBuffer(et,rt);if(it<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(nt.length===0)return 0;const at=await this.streamReader.read(et,nt.offset,nt.length);if(this.position+=at,(!rt||!rt.mayBeLess)&&at<nt.length)throw new peek_readable_1$1.EndOfStreamError;return at}async peekBuffer(et,rt){const nt=this.normalizeOptions(et,rt);let it=0;if(nt.position){const at=nt.position-this.position;if(at>0){const st=new Uint8Array(nt.length+at);return it=await this.peekBuffer(st,{mayBeLess:nt.mayBeLess}),et.set(st.subarray(at),nt.offset),it-at}if(at<0)throw new Error("Cannot peek from a negative offset in a stream")}if(nt.length>0){try{it=await this.streamReader.peek(et,nt.offset,nt.length)}catch(at){if(rt&&rt.mayBeLess&&at instanceof peek_readable_1$1.EndOfStreamError)return 0;throw at}if(!nt.mayBeLess&&it<nt.length)throw new peek_readable_1$1.EndOfStreamError}return it}async ignore(et){const rt=Math.min(maxBufferSize,et),nt=new Uint8Array(rt);let it=0;for(;it<et;){const at=et-it,st=await this.readBuffer(nt,{length:Math.min(rt,at)});if(st<0)return st;it+=st}return it}}ReadStreamTokenizer$1.ReadStreamTokenizer=ReadStreamTokenizer;var BufferTokenizer$1={};Object.defineProperty(BufferTokenizer$1,"__esModule",{value:!0}),BufferTokenizer$1.BufferTokenizer=void 0;const peek_readable_1=lib,AbstractTokenizer_1=AbstractTokenizer$1;class BufferTokenizer extends AbstractTokenizer_1.AbstractTokenizer{constructor(et,rt){super(rt),this.uint8Array=et,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:et.length}async readBuffer(et,rt){if(rt&&rt.position){if(rt.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=rt.position}const nt=await this.peekBuffer(et,rt);return this.position+=nt,nt}async peekBuffer(et,rt){const nt=this.normalizeOptions(et,rt),it=Math.min(this.uint8Array.length-nt.position,nt.length);if(!nt.mayBeLess&&it<nt.length)throw new peek_readable_1.EndOfStreamError;return et.set(this.uint8Array.subarray(nt.position,nt.position+it),nt.offset),it}async close(){}}BufferTokenizer$1.BufferTokenizer=BufferTokenizer,(function(tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.fromBuffer=tt.fromStream=tt.EndOfStreamError=void 0;const et=ReadStreamTokenizer$1,rt=BufferTokenizer$1;var nt=lib;Object.defineProperty(tt,"EndOfStreamError",{enumerable:!0,get:function(){return nt.EndOfStreamError}}),tt.fromStream=function(it,at){return at=at||{},new et.ReadStreamTokenizer(it,at)},tt.fromBuffer=function(it,at){return new rt.BufferTokenizer(it,at)}})(core$1);var util={stringToBytes:tt=>[...tt].map((et=>et.charCodeAt(0))),tarHeaderChecksumMatches:(tt,et=0)=>{const rt=parseInt(tt.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(rt))return!1;let nt=256;for(let it=et;it<et+148;it++)nt+=tt[it];for(let it=et+156;it<et+512;it++)nt+=tt[it];return rt===nt},uint32SyncSafeToken:{get:(tt,et)=>127&tt[et+3]|tt[et+2]<<7|tt[et+1]<<14|tt[et]<<21,len:4}},supported$1={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]};const Token=lib$1,strtok3=core$1,{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=util,supported=supported$1,minimumBytes=4100;async function fromStream(tt){const et=await strtok3.fromStream(tt);try{return await fromTokenizer(et)}finally{await et.close()}}async function fromBuffer(tt){if(!(tt instanceof Uint8Array||tt instanceof ArrayBuffer||Buffer$1.isBuffer(tt)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof tt}\``);const et=tt instanceof Buffer$1?tt:Buffer$1.from(tt);if(et&&et.length>1)return fromTokenizer(strtok3.fromBuffer(et))}function _check(tt,et,rt){rt={offset:0,...rt};for(const[nt,it]of et.entries())if(rt.mask){if(it!==(rt.mask[nt]&tt[nt+rt.offset]))return!1}else if(it!==tt[nt+rt.offset])return!1;return!0}async function fromTokenizer(tt){try{return _fromTokenizer(tt)}catch(et){if(!(et instanceof strtok3.EndOfStreamError))throw et}}async function _fromTokenizer(tt){let et=Buffer$1.alloc(minimumBytes);const rt=(it,at)=>_check(et,it,at),nt=(it,at)=>rt(stringToBytes(it),at);if(tt.fileInfo.size||(tt.fileInfo.size=Number.MAX_SAFE_INTEGER),await tt.peekBuffer(et,{length:12,mayBeLess:!0}),rt([66,77]))return{ext:"bmp",mime:"image/bmp"};if(rt([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(rt([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(rt([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(rt([37,33]))return await tt.peekBuffer(et,{length:24,mayBeLess:!0}),nt("PS-Adobe-",{offset:2})&&nt(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(rt([31,160])||rt([31,157]))return{ext:"Z",mime:"application/x-compress"};if(rt([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(rt([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(rt([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(rt([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(nt("ID3")){await tt.ignore(6);const it=await tt.readToken(uint32SyncSafeToken);return tt.position+it>tt.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await tt.ignore(it),fromTokenizer(tt))}if(nt("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((et[0]===67||et[0]===70)&&rt([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(rt([71,73,70]))return{ext:"gif",mime:"image/gif"};if(nt("FLIF"))return{ext:"flif",mime:"image/flif"};if(nt("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(nt("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(nt("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(nt("FORM"))return{ext:"aif",mime:"audio/aiff"};if(nt("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(rt([80,75,3,4])){try{for(;tt.position+30<tt.fileInfo.size;){await tt.readBuffer(et,{length:30});const it={compressedSize:et.readUInt32LE(18),uncompressedSize:et.readUInt32LE(22),filenameLength:et.readUInt16LE(26),extraFieldLength:et.readUInt16LE(28)};if(it.filename=await tt.readToken(new Token.StringType(it.filenameLength,"utf-8")),await tt.ignore(it.extraFieldLength),it.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(it.filename.endsWith(".rels")||it.filename.endsWith(".xml"))switch(it.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(it.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(it.filename.startsWith("3D/")&&it.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(it.filename==="mimetype"&&it.compressedSize===it.uncompressedSize)switch(await tt.readToken(new Token.StringType(it.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(it.compressedSize===0){let at=-1;for(;at<0&&tt.position<tt.fileInfo.size;)await tt.peekBuffer(et,{mayBeLess:!0}),at=et.indexOf("504B0304",0,"hex"),await tt.ignore(at>=0?at:et.length)}else await tt.ignore(it.compressedSize)}}catch(it){if(!(it instanceof strtok3.EndOfStreamError))throw it}return{ext:"zip",mime:"application/zip"}}if(nt("OggS")){await tt.ignore(28);const it=Buffer$1.alloc(8);return await tt.readBuffer(it),_check(it,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(it,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(it,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(it,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(it,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(it,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(rt([80,75])&&(et[2]===3||et[2]===5||et[2]===7)&&(et[3]===4||et[3]===6||et[3]===8))return{ext:"zip",mime:"application/zip"};if(nt("ftyp",{offset:4})&&96&et[8]){const it=et.toString("binary",8,12).replace("\0"," ").trim();switch(it){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return it.startsWith("3g")?it.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(nt("MThd"))return{ext:"mid",mime:"audio/midi"};if(nt("wOFF")&&(rt([0,1,0,0],{offset:4})||nt("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(nt("wOF2")&&(rt([0,1,0,0],{offset:4})||nt("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(rt([212,195,178,161])||rt([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(nt("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(nt("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(nt("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(rt([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(nt("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(nt("%PDF")){await tt.ignore(1350);const it=10485760,at=Buffer$1.alloc(Math.min(it,tt.fileInfo.size));return await tt.readBuffer(at,{mayBeLess:!0}),at.includes(Buffer$1.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(rt([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(rt([73,73,42,0]))return nt("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:rt([28,0,254,0],{offset:8})||rt([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:rt([8,0,0,0],{offset:4})&&(rt([45,0,254,0],{offset:8})||rt([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(et=Buffer$1.alloc(24),await tt.peekBuffer(et),(rt([16,251,134,1],{offset:4})||rt([8,0,0,0],{offset:4}))&&rt([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(rt([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(nt("MAC "))return{ext:"ape",mime:"audio/ape"};if(rt([26,69,223,163])){async function it(){const lt=await tt.peekNumber(Token.UINT8);let ht=128,dt=0;for(;!(lt&ht)&&ht!==0;)++dt,ht>>=1;const ut=Buffer$1.alloc(dt+1);return await tt.readBuffer(ut),ut}async function at(){const lt=await it(),ht=await it();ht[0]^=128>>ht.length-1;const dt=Math.min(6,ht.length);return{id:lt.readUIntBE(0,lt.length),len:ht.readUIntBE(ht.length-dt,dt)}}async function st(lt,ht){for(;ht>0;){const dt=await at();if(dt.id===17026)return tt.readToken(new Token.StringType(dt.len,"utf-8"));await tt.ignore(dt.len),--ht}}const ot=await at();switch(await st(0,ot.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(rt([82,73,70,70])){if(rt([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(rt([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(rt([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(nt("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(rt([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(nt("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(nt("MSCF")||nt("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(rt([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(rt([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(rt([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(rt([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(nt("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(nt("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(rt([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(nt("IMPM"))return{ext:"it",mime:"audio/x-it"};if(nt("-lh0-",{offset:2})||nt("-lh1-",{offset:2})||nt("-lh2-",{offset:2})||nt("-lh3-",{offset:2})||nt("-lh4-",{offset:2})||nt("-lh5-",{offset:2})||nt("-lh6-",{offset:2})||nt("-lh7-",{offset:2})||nt("-lzs-",{offset:2})||nt("-lz4-",{offset:2})||nt("-lz5-",{offset:2})||nt("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(rt([0,0,1,186])){if(rt([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(rt([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(nt("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(rt([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(nt("<?xml "))return{ext:"xml",mime:"application/xml"};if(rt([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(rt([82,97,114,33,26,7])&&(et[6]===0||et[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(nt("solid "))return{ext:"stl",mime:"model/stl"};if(nt("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(nt("!<arch>"))return await tt.ignore(8),await tt.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(rt([137,80,78,71,13,10,26,10])){async function it(){return{length:await tt.readToken(Token.INT32_BE),type:await tt.readToken(new Token.StringType(4,"binary"))}}await tt.ignore(8);do{const at=await it();if(at.length<0)return;switch(at.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await tt.ignore(at.length+4)}}while(tt.position+8<tt.fileInfo.size);return{ext:"png",mime:"image/png"}}if(rt([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(rt([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(rt([102,114,101,101],{offset:4})||rt([109,100,97,116],{offset:4})||rt([109,111,111,118],{offset:4})||rt([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(rt([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(nt("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(rt([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(rt([48,38,178,117,142,102,207,17,166,217])){async function it(){const at=Buffer$1.alloc(16);return await tt.readBuffer(at),{id:at,size:Number(await tt.readToken(Token.UINT64_LE))}}for(await tt.ignore(30);tt.position+24<tt.fileInfo.size;){const at=await it();let st=at.size-24;if(_check(at.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const ot=Buffer$1.alloc(16);if(st-=await tt.readBuffer(ot),_check(ot,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(ot,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await tt.ignore(st)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(rt([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((rt([126,16,4])||rt([126,24,4]))&&rt([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(rt([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(rt([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await tt.ignore(20),await tt.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(rt([255,10])||rt([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(rt([0,0,1,186])||rt([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(rt([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(rt([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(rt([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(rt([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await tt.peekBuffer(et,{length:Math.min(256,tt.fileInfo.size),mayBeLess:!0}),nt("BEGIN:")){if(nt("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(nt("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(nt("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(nt("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(nt("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(rt([4,0,0,0])&&et.length>=16){const it=et.readUInt32LE(12);if(it>12&&et.length>=it+16)try{const at=et.slice(16,it+16).toString();if(JSON.parse(at).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(rt([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(nt("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(rt([71],{offset:4})&&(rt([71],{offset:192})||rt([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(rt([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(rt([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(rt([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(rt([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(rt([76,80],{offset:34})&&(rt([0,0,1],{offset:8})||rt([1,0,2],{offset:8})||rt([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(rt([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await tt.peekBuffer(et,{length:Math.min(512,tt.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(et))return{ext:"tar",mime:"application/x-tar"};if(rt([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(nt("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(et.length>=2&&rt([255,224],{offset:0,mask:[255,224]})){if(rt([16],{offset:1,mask:[22]}))return rt([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(rt([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(rt([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(rt([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const tt=new stream.PassThrough;let et;et=stream.pipeline?stream.pipeline(readableStream,tt,(()=>{})):readableStream.pipe(tt);const rt=readableStream.read(minimumBytes)||readableStream.read()||Buffer$1.alloc(0);try{const nt=await fromBuffer(rt);tt.fileType=nt}catch(nt){reject(nt)}resolve(et)}))})),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)});var core=fileType,fileType$1=getDefaultExportFromCjs(core);function to(tt,et){return tt.then((function(rt){return[null,rt]})).catch((function(rt){return[rt,void 0]}))}const writeFile=async()=>{throw new Error("Not supported")};function Mime$1(){this._types=Object.create(null),this._extensions=Object.create(null);for(let tt=0;tt<arguments.length;tt++)this.define(arguments[tt]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime$1.prototype.define=function(tt,et){for(let rt in tt){let nt=tt[rt].map((function(it){return it.toLowerCase()}));rt=rt.toLowerCase();for(let it=0;it<nt.length;it++){const at=nt[it];if(at[0]!=="*"){if(!et&&at in this._types)throw new Error('Attempt to change mapping for "'+at+'" extension from "'+this._types[at]+'" to "'+rt+'". Pass `force=true` to allow this, otherwise remove "'+at+'" from the list of extensions for "'+rt+'".');this._types[at]=rt}}if(et||!this._extensions[rt]){const it=nt[0];this._extensions[rt]=it[0]!=="*"?it:it.substr(1)}}},Mime$1.prototype.getType=function(tt){let et=(tt=String(tt)).replace(/^.*[/\\]/,"").toLowerCase(),rt=et.replace(/^.*\./,"").toLowerCase(),nt=et.length<tt.length;return(rt.length<et.length-1||!nt)&&this._types[rt]||null},Mime$1.prototype.getExtension=function(tt){return(tt=/^\s*([^;\s]*)/.test(tt)&&RegExp.$1)&&this._extensions[tt.toLowerCase()]||null};var Mime_1=Mime$1,standard={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let Mime=Mime_1;var lite=new Mime(standard),mime=getDefaultExportFromCjs(lite),HorizontalAlign,HorizontalAlign2,VerticalAlign,VerticalAlign2,BlendMode,BlendMode2;function srcOver(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a;return{r:(tt.r*tt.a+et.r*et.a*(1-tt.a))/nt,g:(tt.g*tt.a+et.g*et.a*(1-tt.a))/nt,b:(tt.b*tt.a+et.b*et.a*(1-tt.a))/nt,a:nt}}function dstOver(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a;return{r:(et.r*et.a+tt.r*tt.a*(1-et.a))/nt,g:(et.g*et.a+tt.g*tt.a*(1-et.a))/nt,b:(et.b*et.a+tt.b*tt.a*(1-et.a))/nt,a:nt}}function multiply(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(it*ot+it*(1-et.a)+ot*(1-tt.a))/nt,g:(at*lt+at*(1-et.a)+lt*(1-tt.a))/nt,b:(st*ht+st*(1-et.a)+ht*(1-tt.a))/nt,a:nt}}function add(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a;return{r:(it+et.r*et.a)/nt,g:(at+et.g*et.a)/nt,b:(st+et.b*et.a)/nt,a:nt}}function screen(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(it*et.a+ot*tt.a-it*ot+it*(1-et.a)+ot*(1-tt.a))/nt,g:(at*et.a+lt*tt.a-at*lt+at*(1-et.a)+lt*(1-tt.a))/nt,b:(st*et.a+ht*tt.a-st*ht+st*(1-et.a)+ht*(1-tt.a))/nt,a:nt}}function overlay(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(2*ot<=et.a?2*it*ot+it*(1-et.a)+ot*(1-tt.a):it*(1+et.a)+ot*(1+tt.a)-2*ot*it-et.a*tt.a)/nt,g:(2*lt<=et.a?2*at*lt+at*(1-et.a)+lt*(1-tt.a):at*(1+et.a)+lt*(1+tt.a)-2*lt*at-et.a*tt.a)/nt,b:(2*ht<=et.a?2*st*ht+st*(1-et.a)+ht*(1-tt.a):st*(1+et.a)+ht*(1+tt.a)-2*ht*st-et.a*tt.a)/nt,a:nt}}function darken(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(Math.min(it*et.a,ot*tt.a)+it*(1-et.a)+ot*(1-tt.a))/nt,g:(Math.min(at*et.a,lt*tt.a)+at*(1-et.a)+lt*(1-tt.a))/nt,b:(Math.min(st*et.a,ht*tt.a)+st*(1-et.a)+ht*(1-tt.a))/nt,a:nt}}function lighten(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(Math.max(it*et.a,ot*tt.a)+it*(1-et.a)+ot*(1-tt.a))/nt,g:(Math.max(at*et.a,lt*tt.a)+at*(1-et.a)+lt*(1-tt.a))/nt,b:(Math.max(st*et.a,ht*tt.a)+st*(1-et.a)+ht*(1-tt.a))/nt,a:nt}}function hardLight(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(2*it<=tt.a?2*it*ot+it*(1-et.a)+ot*(1-tt.a):it*(1+et.a)+ot*(1+tt.a)-2*ot*it-et.a*tt.a)/nt,g:(2*at<=tt.a?2*at*lt+at*(1-et.a)+lt*(1-tt.a):at*(1+et.a)+lt*(1+tt.a)-2*lt*at-et.a*tt.a)/nt,b:(2*st<=tt.a?2*st*ht+st*(1-et.a)+ht*(1-tt.a):st*(1+et.a)+ht*(1+tt.a)-2*ht*st-et.a*tt.a)/nt,a:nt}}function difference(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(it+ot-2*Math.min(it*et.a,ot*tt.a))/nt,g:(at+lt-2*Math.min(at*et.a,lt*tt.a))/nt,b:(st+ht-2*Math.min(st*et.a,ht*tt.a))/nt,a:nt}}function exclusion(tt,et,rt=1){tt.a*=rt;const nt=et.a+tt.a-et.a*tt.a,it=tt.r*tt.a,at=tt.g*tt.a,st=tt.b*tt.a,ot=et.r*et.a,lt=et.g*et.a,ht=et.b*et.a;return{r:(it*et.a+ot*tt.a-2*it*ot+it*(1-et.a)+ot*(1-tt.a))/nt,g:(at*et.a+lt*tt.a-2*at*lt+at*(1-et.a)+lt*(1-tt.a))/nt,b:(st*et.a+ht*tt.a-2*st*ht+st*(1-et.a)+ht*(1-tt.a))/nt,a:nt}}HorizontalAlign2=HorizontalAlign||(HorizontalAlign={}),HorizontalAlign2[HorizontalAlign2.LEFT=1]="LEFT",HorizontalAlign2[HorizontalAlign2.CENTER=2]="CENTER",HorizontalAlign2[HorizontalAlign2.RIGHT=4]="RIGHT",VerticalAlign2=VerticalAlign||(VerticalAlign={}),VerticalAlign2[VerticalAlign2.TOP=8]="TOP",VerticalAlign2[VerticalAlign2.MIDDLE=16]="MIDDLE",VerticalAlign2[VerticalAlign2.BOTTOM=32]="BOTTOM",BlendMode2=BlendMode||(BlendMode={}),BlendMode2.SRC_OVER="srcOver",BlendMode2.DST_OVER="dstOver",BlendMode2.MULTIPLY="multiply",BlendMode2.ADD="add",BlendMode2.SCREEN="screen",BlendMode2.OVERLAY="overlay",BlendMode2.DARKEN="darken",BlendMode2.LIGHTEN="lighten",BlendMode2.HARD_LIGHT="hardLight",BlendMode2.DIFFERENCE="difference",BlendMode2.EXCLUSION="exclusion";const names=[srcOver,dstOver,multiply,add,screen,overlay,darken,lighten,hardLight,difference,exclusion];var compositeModes=Object.freeze({__proto__:null,add,darken,difference,dstOver,exclusion,hardLight,lighten,multiply,names,overlay,screen,srcOver});function composite(tt,et,rt=0,nt=0,it={}){if(!(et instanceof tt.constructor))throw new Error("The source must be a Jimp image");if(typeof rt!="number"||typeof nt!="number")throw new Error("x and y must be numbers");const{mode:at=BlendMode.SRC_OVER}=it;let{opacitySource:st=1,opacityDest:ot=1}=it;(typeof st!="number"||st<0||st>1)&&(st=1),(typeof ot!="number"||ot<0||ot>1)&&(ot=1);const lt=compositeModes[at];return rt=Math.round(rt),nt=Math.round(nt),ot!==1&&tt.scan(((ht,dt,ut)=>{const ft=tt.bitmap.data[ut+3]*ot;tt.bitmap.data[ut+3]=ft})),et.scan(((ht,dt,ut)=>{const ft=tt.getPixelIndex(rt+ht,nt+dt,Edge.CROP);if(ft===-1)return;const mt=lt({r:et.bitmap.data[ut+0]/255,g:et.bitmap.data[ut+1]/255,b:et.bitmap.data[ut+2]/255,a:et.bitmap.data[ut+3]/255},{r:tt.bitmap.data[ft+0]/255,g:tt.bitmap.data[ft+1]/255,b:tt.bitmap.data[ft+2]/255,a:tt.bitmap.data[ft+3]/255},st);tt.bitmap.data[ft+0]=limit255(255*mt.r),tt.bitmap.data[ft+1]=limit255(255*mt.g),tt.bitmap.data[ft+2]=limit255(255*mt.b),tt.bitmap.data[ft+3]=limit255(255*mt.a)})),tt}var jpeg$1={parseSections:function(tt,et){var rt,nt;for(tt.setBigEndian(!0);tt.remainingLength()>0&&nt!==218;){if(tt.nextUInt8()!==255)throw new Error("Invalid JPEG section offset");rt=(nt=tt.nextUInt8())>=208&&nt<=217||nt===218?0:tt.nextUInt16()-2,et(nt,tt.branch(0,rt)),tt.skip(rt)}},getSizeFromSOFSection:function(tt){return tt.skip(1),{height:tt.nextUInt16(),width:tt.nextUInt16()}},getSectionName:function(tt){var et,rt;switch(tt){case 216:et="SOI";break;case 196:et="DHT";break;case 219:et="DQT";break;case 221:et="DRI";break;case 218:et="SOS";break;case 254:et="COM";break;case 217:et="EOI";break;default:tt>=224&&tt<=239?(et="APP",rt=tt-224):tt>=192&&tt<=207&&tt!==196&&tt!==200&&tt!==204?(et="SOF",rt=tt-192):tt>=208&&tt<=215&&(et="RST",rt=tt-208)}var nt={name:et};return typeof rt=="number"&&(nt.index=rt),nt}};function readExifValue(tt,et){switch(tt){case 1:return et.nextUInt8();case 3:case 8:return et.nextUInt16();case 4:case 9:return et.nextUInt32();case 5:return[et.nextUInt32(),et.nextUInt32()];case 6:return et.nextInt8();case 10:return[et.nextInt32(),et.nextInt32()];case 11:return et.nextFloat();case 12:return et.nextDouble();default:throw new Error("Invalid format while decoding: "+tt)}}function getBytesPerComponent(tt){switch(tt){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function readExifTag(tt,et){var rt,nt,it=et.nextUInt16(),at=et.nextUInt16(),st=getBytesPerComponent(at),ot=et.nextUInt32(),lt=st*ot;if(lt>4&&(et=tt.openWithOffset(et.nextUInt32())),at===2){var ht=(rt=et.nextString(ot)).indexOf("\0");ht!==-1&&(rt=rt.substr(0,ht))}else if(at===7)rt=et.nextBuffer(ot);else if(at!==0)for(rt=[],nt=0;nt<ot;++nt)rt.push(readExifValue(at,et));return lt<4&&et.skip(4-lt),[it,rt,at]}function readIFDSection(tt,et,rt){var nt,it,at=et.nextUInt16();for(it=0;it<at;++it)rt((nt=readExifTag(tt,et))[0],nt[1],nt[2])}function readHeader(tt){if(tt.nextString(6)!=="Exif\0\0")throw new Error("Invalid EXIF header");var et=tt.mark(),rt=tt.nextUInt16();if(rt===18761)tt.setBigEndian(!1);else{if(rt!==19789)throw new Error("Invalid TIFF header");tt.setBigEndian(!0)}if(tt.nextUInt16()!==42)throw new Error("Invalid TIFF data");return et}var exif$2={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(tt,et){var rt,nt,it,at;try{rt=readHeader(tt)}catch{return!1}var st=rt.openWithOffset(tt.nextUInt32()),ot=this.IFD0;readIFDSection(rt,st,(function(gt,vt,xt){switch(gt){case 34853:it=vt[0];break;case 34665:nt=vt[0];break;default:et(ot,gt,vt,xt)}}));var lt=st.nextUInt32();if(lt!==0){var ht=rt.openWithOffset(lt);readIFDSection(rt,ht,et.bind(null,this.IFD1))}if(it){var dt=rt.openWithOffset(it);readIFDSection(rt,dt,et.bind(null,this.GPSIFD))}if(nt){var ut=rt.openWithOffset(nt),ft=this.InteropIFD;readIFDSection(rt,ut,(function(gt,vt,xt){gt===40965?at=vt[0]:et(ft,gt,vt,xt)}))}if(at){var mt=rt.openWithOffset(at);readIFDSection(rt,mt,et.bind(null,this.InteropIFD))}return!0}};function parseNumber(tt){return parseInt(tt,10)}var hours=3600,minutes=60;function parseDateTimeParts(tt,et){tt=tt.map(parseNumber),et=et.map(parseNumber);var rt=tt[0],nt=tt[1]-1,it=tt[2],at=et[0],st=et[1],ot=et[2];return Date.UTC(rt,nt,it,at,st,ot,0)/1e3}function parseDateWithTimezoneFormat(tt){var et=tt.substr(0,10).split("-"),rt=tt.substr(11,8).split(":"),nt=tt.substr(19,6).split(":").map(parseNumber),it=nt[0]*hours+nt[1]*minutes,at=parseDateTimeParts(et,rt);if(typeof(at-=it)=="number"&&!isNaN(at))return at}function parseDateWithSpecFormat(tt){var et=tt.split(" "),rt=parseDateTimeParts(et[0].split(":"),et[1].split(":"));if(typeof rt=="number"&&!isNaN(rt))return rt}function parseExifDate(tt){var et=tt.length===19&&tt.charAt(4)===":";return tt.length===25&&tt.charAt(10)==="T"?parseDateWithTimezoneFormat(tt):et?parseDateWithSpecFormat(tt):void 0}var date$1={parseDateWithSpecFormat,parseDateWithTimezoneFormat,parseExifDate},exif$1=exif$2,date=date$1,degreeTags=[{section:exif$1.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:exif$1.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],dateTags=[{section:exif$1.SubIFD,type:306,name:"ModifyDate"},{section:exif$1.SubIFD,type:36867,name:"DateTimeOriginal"},{section:exif$1.SubIFD,type:36868,name:"CreateDate"},{section:exif$1.SubIFD,type:306,name:"ModifyDate"}],simplify$1={castDegreeValues:function(tt,et){degreeTags.forEach((function(rt){var nt=tt(rt);if(nt){var it=tt({section:rt.section,type:rt.refType,name:rt.refName})===rt.posVal?1:-1,at=(nt[0]+nt[1]/60+nt[2]/3600)*it;et(rt,at)}}))},castDateValues:function(tt,et){dateTags.forEach((function(rt){var nt=tt(rt);if(nt){var it=date.parseExifDate(nt);it!==void 0&&et(rt,it)}}))},simplifyValue:function(tt,et){return Array.isArray(tt)&&(tt=tt.map((function(rt){return et===10||et===5?rt[0]/rt[1]:rt}))).length===1&&(tt=tt[0]),tt}},exifTags,hasRequiredExifTags;function requireExifTags(){return hasRequiredExifTags?exifTags:(hasRequiredExifTags=1,exifTags={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}})}var jpeg=jpeg$1,exif=exif$2,simplify=simplify$1;function ExifResult(tt,et,rt,nt,it,at,st){this.startMarker=tt,this.tags=et,this.imageSize=rt,this.thumbnailOffset=nt,this.thumbnailLength=it,this.thumbnailType=at,this.app1Offset=st}function Parser$1(tt){this.stream=tt,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}ExifResult.prototype={hasThumbnail:function(tt){return!(!this.thumbnailOffset||!this.thumbnailLength)&&(typeof tt!="string"||(tt.toLowerCase().trim()==="image/jpeg"?this.thumbnailType===6:tt.toLowerCase().trim()==="image/tiff"&&this.thumbnailType===1))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var tt,et=this._getThumbnailStream();return jpeg.parseSections(et,(function(rt,nt){jpeg.getSectionName(rt).name==="SOF"&&(tt=jpeg.getSizeFromSOFSection(nt))})),tt}},Parser$1.prototype={enableBinaryFields:function(tt){return this.flags.readBinaryTags=!!tt,this},enablePointers:function(tt){return this.flags.hidePointers=!tt,this},enableTagNames:function(tt){return this.flags.resolveTagNames=!!tt,this},enableImageSize:function(tt){return this.flags.imageSize=!!tt,this},enableReturnTags:function(tt){return this.flags.returnTags=!!tt,this},enableSimpleValues:function(tt){return this.flags.simplifyValues=!!tt,this},parse:function(){var tt,et,rt,nt,it,at,st,ot,lt,ht=this.stream.mark(),dt=ht.openWithOffset(0),ut=this.flags;return ut.resolveTagNames&&(st=requireExifTags()),ut.resolveTagNames?(tt={},ot=function(ft){return tt[ft.name]},lt=function(ft,mt){tt[ft.name]=mt}):(tt=[],ot=function(ft){var mt;for(mt=0;mt<tt.length;++mt)if(tt[mt].type===ft.type&&tt[mt].section===ft.section)return tt.value},lt=function(ft,mt){var gt;for(gt=0;gt<tt.length;++gt)if(tt[gt].type===ft.type&&tt[gt].section===ft.section)return void(tt.value=mt)}),jpeg.parseSections(dt,(function(ft,mt){var gt=mt.offsetFrom(ht);ft===225?exif.parseTags(mt,(function(vt,xt,wt,At){if(ut.readBinaryTags||At!==7){if(xt===513){if(rt=wt[0],ut.hidePointers)return}else if(xt===514){if(nt=wt[0],ut.hidePointers)return}else if(xt===259&&(it=wt[0],ut.hidePointers))return;if(ut.returnTags)if(ut.simplifyValues&&(wt=simplify.simplifyValue(wt,At)),ut.resolveTagNames){var Tt=(vt===exif.GPSIFD?st.gps:st.exif)[xt];Tt||(Tt=st.exif[xt]),tt.hasOwnProperty(Tt)||(tt[Tt]=wt)}else tt.push({section:vt,type:xt,value:wt})}}))&&(at=gt):ut.imageSize&&jpeg.getSectionName(ft).name==="SOF"&&(et=jpeg.getSizeFromSOFSection(mt))})),ut.simplifyValues&&(simplify.castDegreeValues(ot,lt),simplify.castDateValues(ot,lt)),new ExifResult(ht,tt,et,rt,nt,it,at)}};var parser=Parser$1,domBufferstream,hasRequiredDomBufferstream,bufferstream,hasRequiredBufferstream;function requireDomBufferstream(){if(hasRequiredDomBufferstream)return domBufferstream;function tt(et,rt,nt,it,at,st){this.global=at,rt=rt||0,nt=nt||et.byteLength-rt,this.arrayBuffer=et.slice(rt,rt+nt),this.view=new at.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(it),this.offset=0,this.parentOffset=(st||0)+rt}return hasRequiredDomBufferstream=1,tt.prototype={setBigEndian:function(et){this.littleEndian=!et},nextUInt8:function(){var et=this.view.getUint8(this.offset);return this.offset+=1,et},nextInt8:function(){var et=this.view.getInt8(this.offset);return this.offset+=1,et},nextUInt16:function(){var et=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,et},nextUInt32:function(){var et=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,et},nextInt16:function(){var et=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,et},nextInt32:function(){var et=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,et},nextFloat:function(){var et=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,et},nextDouble:function(){var et=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,et},nextBuffer:function(et){var rt=this.arrayBuffer.slice(this.offset,this.offset+et);return this.offset+=et,rt},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(et){var rt=this.arrayBuffer.slice(this.offset,this.offset+et);return rt=String.fromCharCode.apply(null,new this.global.Uint8Array(rt)),this.offset+=et,rt},mark:function(){var et=this;return{openWithOffset:function(rt){return rt=(rt||0)+this.offset,new tt(et.arrayBuffer,rt,et.arrayBuffer.byteLength-rt,!et.littleEndian,et.global,et.parentOffset)},offset:this.offset,getParentOffset:function(){return et.parentOffset}}},offsetFrom:function(et){return this.parentOffset+this.offset-(et.offset+et.getParentOffset())},skip:function(et){this.offset+=et},branch:function(et,rt){return rt=typeof rt=="number"?rt:this.arrayBuffer.byteLength-(this.offset+et),new tt(this.arrayBuffer,this.offset+et,rt,!this.littleEndian,this.global,this.parentOffset)}},domBufferstream=tt}function requireBufferstream(){if(hasRequiredBufferstream)return bufferstream;function tt(et,rt,nt,it){this.buffer=et,this.offset=rt||0,nt=typeof nt=="number"?nt:et.length,this.endPosition=this.offset+nt,this.setBigEndian(it)}return hasRequiredBufferstream=1,tt.prototype={setBigEndian:function(et){this.bigEndian=!!et},nextUInt8:function(){var et=this.buffer.readUInt8(this.offset);return this.offset+=1,et},nextInt8:function(){var et=this.buffer.readInt8(this.offset);return this.offset+=1,et},nextUInt16:function(){var et=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,et},nextUInt32:function(){var et=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,et},nextInt16:function(){var et=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,et},nextInt32:function(){var et=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,et},nextFloat:function(){var et=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,et},nextDouble:function(){var et=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,et},nextBuffer:function(et){var rt=this.buffer.slice(this.offset,this.offset+et);return this.offset+=et,rt},remainingLength:function(){return this.endPosition-this.offset},nextString:function(et){var rt=this.buffer.toString("utf8",this.offset,this.offset+et);return this.offset+=et,rt},mark:function(){var et=this;return{openWithOffset:function(rt){return rt=(rt||0)+this.offset,new tt(et.buffer,rt,et.endPosition-rt,et.bigEndian)},offset:this.offset}},offsetFrom:function(et){return this.offset-et.offset},skip:function(et){this.offset+=et},branch:function(et,rt){return rt=typeof rt=="number"?rt:this.endPosition-(this.offset+et),new tt(this.buffer,this.offset+et,rt,this.bigEndian)}},bufferstream=tt}var Parser=parser;function getGlobal(){return(0,eval)("this")}var exifParser={create:function(tt,et){if(tt instanceof(et=et||getGlobal()).ArrayBuffer){var rt=requireDomBufferstream();return new Parser(new rt(tt,0,tt.byteLength,!0,et))}var nt=requireBufferstream();return new Parser(new nt(tt,0,tt.length,!0))}},EXIFParser=getDefaultExportFromCjs(exifParser);function getExifOrientation(tt){const et=tt._exif;return et&&et.tags&&et.tags.Orientation||1}function getExifOrientationTransformation(tt){const et=tt.bitmap.width,rt=tt.bitmap.height;switch(getExifOrientation(tt)){case 1:default:return null;case 2:return function(nt,it){return[et-nt-1,it]};case 3:return function(nt,it){return[et-nt-1,rt-it-1]};case 4:return function(nt,it){return[nt,rt-it-1]};case 5:return function(nt,it){return[it,nt]};case 6:return function(nt,it){return[it,rt-nt-1]};case 7:return function(nt,it){return[et-it-1,rt-nt-1]};case 8:return function(nt,it){return[et-it-1,nt]}}}function transformBitmap(tt,et,rt,nt){const it=tt.bitmap.data,at=tt.bitmap.width,st=Buffer$1.alloc(it.length);for(let ot=0;ot<et;ot++)for(let lt=0;lt<rt;lt++){const[ht,dt]=nt(ot,lt),ut=et*lt+ot<<2,ft=at*dt+ht<<2,mt=it.readUInt32BE(ft);st.writeUInt32BE(mt,ut)}tt.bitmap.data=st,tt.bitmap.width=et,tt.bitmap.height=rt,tt._exif.tags.Orientation=1}function exifRotate(tt){if(getExifOrientation(tt)<2)return;const et=getExifOrientationTransformation(tt),rt=getExifOrientation(tt)>4,nt=rt?tt.bitmap.height:tt.bitmap.width,it=rt?tt.bitmap.width:tt.bitmap.height;et&&transformBitmap(tt,nt,it,et)}async function attemptExifRotate(tt,et){try{tt._exif=EXIFParser.create(et).parse(),exifRotate(tt)}catch{}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(tt,et,rt)=>et in tt?__defProp$2(tt,et,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[et]=rt,__publicField$2=(tt,et,rt)=>__defNormalProp$2(tt,typeof et!="symbol"?et+"":et,rt);const emptyBitmap={data:Buffer$1.alloc(0),width:0,height:0};function bufferFromArrayBuffer(tt){const et=Buffer$1.alloc(tt.byteLength),rt=new Uint8Array(tt);for(let nt=0;nt<et.length;++nt)et[nt]=rt[nt];return et}function createJimp({plugins:tt,formats:et}={}){const rt=tt||[],nt=(et||[]).map((at=>at())),it=class{constructor(at=emptyBitmap){if(__publicField$2(this,"bitmap",emptyBitmap),__publicField$2(this,"background",0),__publicField$2(this,"formats",[]),__publicField$2(this,"mime"),this.formats=nt,"data"in at)this.bitmap=at;else if(this.bitmap={data:Buffer$1.alloc(at.width*at.height*4),width:at.width,height:at.height},at.color){this.background=typeof at.color=="string"?cssColorToHex(at.color):at.color;for(let st=0;st<this.bitmap.data.length;st+=4)this.bitmap.data.writeUInt32BE(this.background,st)}for(const st of rt)for(const ot in st)this[ot]=(...lt)=>{const ht=st[ot]?.(this,...lt);return typeof ht=="object"&&"bitmap"in ht?(this.bitmap=ht.bitmap,this):ht}}static async read(at,st){if(Buffer$1.isBuffer(at)||at instanceof ArrayBuffer)return this.fromBuffer(at);const[ot,lt]=await to(fetch(at));if(ot)throw new Error(`Could not load Buffer from URL: ${at}`);if(!lt.ok)throw new Error(`HTTP Status ${lt.status} for url ${at}`);const[ht,dt]=await to(lt.arrayBuffer());if(ht)throw new Error(`Could not load Buffer from ${at}`);const ut=bufferFromArrayBuffer(dt);return this.fromBuffer(ut,st)}static fromBitmap(at){let st;if(at.data instanceof Buffer$1&&(st=Buffer$1.from(at.data)),(at.data instanceof Uint8Array||at.data instanceof Uint8ClampedArray)&&(st=Buffer$1.from(at.data.buffer)),Array.isArray(at.data)&&(st=Buffer$1.concat(at.data.map((ot=>Buffer$1.from(ot.toString(16).padStart(8,"0"),"hex"))))),!st)throw new Error("data must be a Buffer");if(typeof at.height!="number"||typeof at.width!="number")throw new Error("bitmap must have width and height");return new it({height:at.height,width:at.width,data:st})}static async fromBuffer(at,st){const ot=at instanceof ArrayBuffer?bufferFromArrayBuffer(at):at,lt=await fileType$1.fromBuffer(ot);if(!lt||!lt.mime)throw new Error("Could not find MIME for Buffer");const ht=nt.find((ut=>ut.mime===lt.mime));if(!ht||!ht.decode)throw new Error(`Mime type ${lt.mime} does not support decoding`);const dt=new it(await ht.decode(ot,st?.[ht.mime]));return dt.mime=lt.mime,attemptExifRotate(dt,ot),dt}inspect(){return"<Jimp "+(this.bitmap===emptyBitmap?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}toString(){return"[object Jimp]"}get width(){return this.bitmap.width}get height(){return this.bitmap.height}async getBuffer(at,st){const ot=this.formats.find((ht=>ht.mime===at));if(!ot||!ot.encode)throw new Error(`Unsupported MIME type: ${at}`);let lt;return ot.hasAlpha?lt=this:(lt=new it({width:this.bitmap.width,height:this.bitmap.height,color:this.background}),composite(lt,this)),ot.encode(lt.bitmap,st)}async getBase64(at,st){return"data:"+at+";base64,"+(await this.getBuffer(at,st)).toString("base64")}async write(at,st){const ot=mime.getType(at);await writeFile(at,await this.getBuffer(ot,st))}clone(){return new it({...this.bitmap,data:Buffer$1.from(this.bitmap.data)})}getPixelIndex(at,st,ot){let lt,ht;if(ot||(ot=Edge.EXTEND),typeof at!="number"||typeof st!="number")throw new Error("x and y must be numbers");lt=at=Math.round(at),ht=st=Math.round(st),ot===Edge.EXTEND&&(at<0&&(lt=0),at>=this.bitmap.width&&(lt=this.bitmap.width-1),st<0&&(ht=0),st>=this.bitmap.height&&(ht=this.bitmap.height-1)),ot===Edge.WRAP&&(at<0&&(lt=this.bitmap.width+at),at>=this.bitmap.width&&(lt=at%this.bitmap.width),st<0&&(ht=this.bitmap.height+st),st>=this.bitmap.height&&(ht=st%this.bitmap.height));let dt=this.bitmap.width*ht+lt<<2;return(lt<0||lt>=this.bitmap.width)&&(dt=-1),(ht<0||ht>=this.bitmap.height)&&(dt=-1),dt}getPixelColor(at,st){if(typeof at!="number"||typeof st!="number")throw new Error("x and y must be numbers");const ot=this.getPixelIndex(at,st);return this.bitmap.data.readUInt32BE(ot)}setPixelColor(at,st,ot){if(typeof at!="number"||typeof st!="number"||typeof ot!="number")throw new Error("hex, x and y must be numbers");const lt=this.getPixelIndex(st,ot);return this.bitmap.data.writeUInt32BE(at,lt),this}hasAlpha(){const{width:at,height:st,data:ot}=this.bitmap,lt=at*st<<2;for(let ht=3;ht<lt;ht+=4)if(ot[ht]!==255)return!0;return!1}composite(at,st=0,ot=0,lt={}){return composite(this,at,st,ot,lt)}scan(at,st,ot,lt,ht){return scan(this,at,st,ot,lt,ht)}scanIterator(at=0,st=0,ot=this.bitmap.width,lt=this.bitmap.height){if(typeof at!="number"||typeof st!="number")throw new Error("x and y must be numbers");if(typeof ot!="number"||typeof lt!="number")throw new Error("w and h must be numbers");return scanIterator(this,at,st,ot,lt)}};return it}var ResizeStrategy,ResizeStrategy2;function Resize(tt,et,rt,nt,it,at,st){this.widthOriginal=Math.abs(Math.floor(tt)||0),this.heightOriginal=Math.abs(Math.floor(et)||0),this.targetWidth=Math.abs(Math.floor(rt)||0),this.targetHeight=Math.abs(Math.floor(nt)||0),this.colorChannels=it?4:3,this.interpolationPass=!!at,this.resizeCallback=typeof st=="function"?st:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}ResizeStrategy2=ResizeStrategy||(ResizeStrategy={}),ResizeStrategy2.NEAREST_NEIGHBOR="nearestNeighbor",ResizeStrategy2.BILINEAR="bilinearInterpolation",ResizeStrategy2.BICUBIC="bicubicInterpolation",ResizeStrategy2.HERMITE="hermiteInterpolation",ResizeStrategy2.BEZIER="bezierInterpolation",Resize.prototype.initialize=function(){if(!(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0))throw console.log(this),new Error("Invalid settings specified for the resizer.");this.configurePasses()},Resize.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB))},Resize.prototype._resizeWidthInterpolatedRGBChannels=function(tt,et){const rt=et?4:3,nt=this.ratioWeightWidthPass,it=this.widthBuffer;let at,st,ot=0,lt=0,ht=0,dt=0,ut=0;for(at=0;ot<1/3;at+=rt,ot+=nt)for(lt=at,ht=0;lt<this.widthPassResultSize;ht+=this.originalWidthMultipliedByChannels,lt+=this.targetWidthMultipliedByChannels)it[lt]=tt[ht],it[lt+1]=tt[ht+1],it[lt+2]=tt[ht+2],et&&(it[lt+3]=tt[ht+3]);for(ot-=1/3,st=this.widthOriginal-1;ot<st;at+=rt,ot+=nt)for(ut=ot%1,dt=1-ut,lt=at,ht=Math.floor(ot)*rt;lt<this.widthPassResultSize;ht+=this.originalWidthMultipliedByChannels,lt+=this.targetWidthMultipliedByChannels)it[lt+0]=tt[ht+0]*dt+tt[ht+rt+0]*ut,it[lt+1]=tt[ht+1]*dt+tt[ht+rt+1]*ut,it[lt+2]=tt[ht+2]*dt+tt[ht+rt+2]*ut,et&&(it[lt+3]=tt[ht+3]*dt+tt[ht+rt+3]*ut);for(st=this.originalWidthMultipliedByChannels-rt;at<this.targetWidthMultipliedByChannels;at+=rt)for(lt=at,ht=st;lt<this.widthPassResultSize;ht+=this.originalWidthMultipliedByChannels,lt+=this.targetWidthMultipliedByChannels)it[lt]=tt[ht],it[lt+1]=tt[ht+1],it[lt+2]=tt[ht+2],et&&(it[lt+3]=tt[ht+3]);return it},Resize.prototype._resizeWidthRGBChannels=function(tt,et){const rt=et?4:3,nt=this.ratioWeightWidthPass,it=1/nt,at=this.originalWidthMultipliedByChannels-rt+1,st=this.targetWidthMultipliedByChannels-rt+1,ot=this.outputWidthWorkBench,lt=this.widthBuffer,ht=this.outputWidthWorkBenchOpaquePixelsCount;let dt=0,ut=0,ft=0,mt=0,gt=0,vt=0,xt=0,wt=1,At=0,Tt=0,Pt=0,Rt=0;do{for(gt=0;gt<this.originalHeightMultipliedByChannels;)ot[gt++]=0,ot[gt++]=0,ot[gt++]=0,et&&(ot[gt++]=0,ht[gt/rt-1]=0);dt=nt;do{for(ut=1+ft-mt,wt=Math.min(dt,ut),gt=0,vt=ft;gt<this.originalHeightMultipliedByChannels;vt+=at)At=tt[vt],Tt=tt[++vt],Pt=tt[++vt],Rt=et?tt[++vt]:255,ot[gt++]+=(Rt?At:0)*wt,ot[gt++]+=(Rt?Tt:0)*wt,ot[gt++]+=(Rt?Pt:0)*wt,et&&(ot[gt++]+=Rt*wt,ht[gt/rt-1]+=Rt?wt:0);if(!(dt>=ut)){mt+=dt;break}ft+=rt,mt=ft,dt-=ut}while(dt>0&&ft<this.originalWidthMultipliedByChannels);for(gt=0,vt=xt;gt<this.originalHeightMultipliedByChannels;vt+=st)dt=et?ht[gt/rt]:1,wt=et?dt?1/dt:0:it,lt[vt]=ot[gt++]*wt,lt[++vt]=ot[gt++]*wt,lt[++vt]=ot[gt++]*wt,et&&(lt[++vt]=ot[gt++]*it);xt+=rt}while(xt<this.targetWidthMultipliedByChannels);return lt},Resize.prototype._resizeHeightRGBChannels=function(tt,et){const rt=this.ratioWeightHeightPass,nt=1/rt,it=this.outputHeightWorkBench,at=this.heightBuffer,st=this.outputHeightWorkBenchOpaquePixelsCount;let ot=0,lt=0,ht=0,dt=0,ut=0,ft=0,mt=0,gt=1,vt=0,xt=0,wt=0,At=0;do{for(ut=0;ut<this.targetWidthMultipliedByChannels;)it[ut++]=0,it[ut++]=0,it[ut++]=0,et&&(it[ut++]=0,st[ut/4-1]=0);ot=rt;do{for(lt=1+ht-dt,gt=Math.min(ot,lt),mt=ht,ut=0;ut<this.targetWidthMultipliedByChannels;)vt=tt[mt++],xt=tt[mt++],wt=tt[mt++],At=et?tt[mt++]:255,it[ut++]+=(At?vt:0)*gt,it[ut++]+=(At?xt:0)*gt,it[ut++]+=(At?wt:0)*gt,et&&(it[ut++]+=At*gt,st[ut/4-1]+=At?gt:0);if(!(ot>=lt)){dt+=ot;break}ht=mt,dt=ht,ot-=lt}while(ot>0&&ht<this.widthPassResultSize);for(ut=0;ut<this.targetWidthMultipliedByChannels;)ot=et?st[ut/4]:1,gt=et?ot?1/ot:0:nt,at[ft++]=Math.round(it[ut++]*gt),at[ft++]=Math.round(it[ut++]*gt),at[ft++]=Math.round(it[ut++]*gt),et&&(at[ft++]=Math.round(it[ut++]*nt))}while(ft<this.finalResultSize);return at},Resize.prototype.resizeWidthInterpolatedRGB=function(tt){return this._resizeWidthInterpolatedRGBChannels(tt,!1)},Resize.prototype.resizeWidthInterpolatedRGBA=function(tt){return this._resizeWidthInterpolatedRGBChannels(tt,!0)},Resize.prototype.resizeWidthRGB=function(tt){return this._resizeWidthRGBChannels(tt,!1)},Resize.prototype.resizeWidthRGBA=function(tt){return this._resizeWidthRGBChannels(tt,!0)},Resize.prototype.resizeHeightInterpolated=function(tt){const et=this.ratioWeightHeightPass,rt=this.heightBuffer;let nt,it=0,at=0,st=0,ot=0,lt=0,ht=0,dt=0;for(;it<1/3;it+=et)for(st=0;st<this.targetWidthMultipliedByChannels;)rt[at++]=Math.round(tt[st++]);for(it-=1/3,nt=this.heightOriginal-1;it<nt;it+=et)for(dt=it%1,ht=1-dt,ot=Math.floor(it)*this.targetWidthMultipliedByChannels,lt=ot+this.targetWidthMultipliedByChannels,st=0;st<this.targetWidthMultipliedByChannels;++st)rt[at++]=Math.round(tt[ot++]*ht+tt[lt++]*dt);for(;at<this.finalResultSize;)for(st=0,ot=nt*this.targetWidthMultipliedByChannels;st<this.targetWidthMultipliedByChannels;++st)rt[at++]=Math.round(tt[ot++]);return rt},Resize.prototype.resizeHeightRGB=function(tt){return this._resizeHeightRGBChannels(tt,!1)},Resize.prototype.resizeHeightRGBA=function(tt){return this._resizeHeightRGBChannels(tt,!0)},Resize.prototype.resize=function(tt){this.resizeCallback(this.resizeHeight(this.resizeWidth(tt)))},Resize.prototype.bypassResizer=function(tt){return tt},Resize.prototype.initializeFirstPassBuffers=function(tt){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),tt||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},Resize.prototype.initializeSecondPassBuffers=function(tt){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),tt||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},Resize.prototype.generateFloatBuffer=function(tt){try{return new Float32Array(tt)}catch(et){return console.error(et),[]}},Resize.prototype.generateFloat64Buffer=function(tt){try{return new Float64Array(tt)}catch(et){return console.error(et),[]}},Resize.prototype.generateUint8Buffer=function(tt){try{return new Uint8Array(tt)}catch(et){return console.error(et),[]}};const operations={nearestNeighbor(tt,et){const rt=tt.width,nt=tt.height,it=et.width,at=et.height,st=tt.data,ot=et.data;for(let lt=0;lt<at;lt++)for(let ht=0;ht<it;ht++){let dt=4*(lt*it+ht),ut=4*(Math.floor(lt*nt/at)*rt+Math.floor(ht*rt/it));ot[dt++]=st[ut++],ot[dt++]=st[ut++],ot[dt++]=st[ut++],ot[dt++]=st[ut++]}},bilinearInterpolation(tt,et){const rt=tt.width,nt=tt.height,it=et.width,at=et.height,st=tt.data,ot=et.data,lt=function(dt,ut,ft,mt,gt){return ut===mt?ft:Math.round((dt-ut)*gt+(mt-dt)*ft)},ht=function(dt,ut,ft,mt,gt,vt,xt,wt){let At=4*(xt*rt+mt)+ut,Tt=4*(xt*rt+gt)+ut;const Pt=lt(ft,mt,st[At],gt,st[Tt]);if(wt===xt)ot[dt+ut]=Pt;else{At=4*(wt*rt+mt)+ut,Tt=4*(wt*rt+gt)+ut;const Rt=lt(ft,mt,st[At],gt,st[Tt]);ot[dt+ut]=lt(vt,xt,Pt,wt,Rt)}};for(let dt=0;dt<at;dt++)for(let ut=0;ut<it;ut++){const ft=4*(dt*it+ut),mt=ut*rt/it,gt=Math.floor(mt),vt=Math.min(Math.ceil(mt),rt-1),xt=dt*nt/at,wt=Math.floor(xt),At=Math.min(Math.ceil(xt),nt-1);ht(ft,0,mt,gt,vt,xt,wt,At),ht(ft,1,mt,gt,vt,xt,wt,At),ht(ft,2,mt,gt,vt,xt,wt,At),ht(ft,3,mt,gt,vt,xt,wt,At)}},_interpolate2D(tt,et,rt,nt){const it=tt.data,at=et.data,st=tt.width,ot=tt.height,lt=et.width,ht=et.height,dt=Math.max(1,Math.floor(st/lt)),ut=lt*dt,ft=Math.max(1,Math.floor(ot/ht)),mt=ht*ft,gt=Buffer$1.alloc(ut*ot*4);for(let wt=0;wt<ot;wt++)for(let At=0;At<ut;At++){const Tt=At*(st-1)/ut,Pt=Math.floor(Tt),Rt=Tt-Pt,Ot=4*(wt*st+Pt),Et=4*(wt*ut+At);for(let Lt=0;Lt<4;Lt++){const kt=Ot+Lt,jt=Pt>0?it[kt-4]:2*it[kt]-it[kt+4],Mt=it[kt],$t=it[kt+4],Qt=Pt<st-2?it[kt+8]:2*it[kt+4]-it[kt];gt[Et+Lt]=nt(jt,Mt,$t,Qt,Rt)}}const vt=Buffer$1.alloc(ut*mt*4);for(let wt=0;wt<mt;wt++)for(let At=0;At<ut;At++){const Tt=wt*(ot-1)/mt,Pt=Math.floor(Tt),Rt=Tt-Pt,Ot=4*(Pt*ut+At),Et=4*(wt*ut+At);for(let Lt=0;Lt<4;Lt++){const kt=Ot+Lt,jt=Pt>0?gt[kt-4*ut]:2*gt[kt]-gt[kt+4*ut],Mt=gt[kt],$t=gt[kt+4*ut],Qt=Pt<ot-2?gt[kt+8*ut]:2*gt[kt+4*ut]-gt[kt];vt[Et+Lt]=nt(jt,Mt,$t,Qt,Rt)}}const xt=dt*ft;if(xt>1)for(let wt=0;wt<ht;wt++)for(let At=0;At<lt;At++){let Tt=0,Pt=0,Rt=0,Ot=0,Et=0;for(let kt=0;kt<ft;kt++){const jt=wt*ft+kt;for(let Mt=0;Mt<dt;Mt++){const $t=4*(jt*ut+(At*dt+Mt)),Qt=vt[$t+3];Qt&&(Tt+=vt[$t],Pt+=vt[$t+1],Rt+=vt[$t+2],Et++),Ot+=Qt}}const Lt=4*(wt*lt+At);at[Lt]=Et?Math.round(Tt/Et):0,at[Lt+1]=Et?Math.round(Pt/Et):0,at[Lt+2]=Et?Math.round(Rt/Et):0,at[Lt+3]=Math.round(Ot/xt)}else et.data=vt},bicubicInterpolation(tt,et,rt){return this._interpolate2D(tt,et,rt,(function(nt,it,at,st,ot){const lt=st-at-nt+it,ht=nt-it-lt,dt=at-nt,ut=it;return Math.max(0,Math.min(255,lt*(ot*ot*ot)+ht*(ot*ot)+dt*ot+ut))}))},hermiteInterpolation(tt,et,rt){return this._interpolate2D(tt,et,rt,(function(nt,it,at,st,ot){const lt=it,ht=.5*(at-nt),dt=nt-2.5*it+2*at-.5*st,ut=.5*(st-nt)+1.5*(it-at);return Math.max(0,Math.min(255,Math.round(((ut*ot+dt)*ot+ht)*ot+lt)))}))},bezierInterpolation(tt,et,rt){return this._interpolate2D(tt,et,rt,(function(nt,it,at,st,ot){const lt=1-ot,ht=it*lt*lt*lt,dt=3*(it+(at-nt)/4)*lt*lt*ot,ut=3*(at-(st-it)/4)*lt*ot*ot,ft=at*ot*ot*ot;return Math.max(0,Math.min(255,Math.round(ht+dt+ut+ft)))}))}},ResizeOptionsSchema=z.union([z.object({w:z.number().min(0),h:z.number().min(0).optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),z.object({w:z.number().min(0).optional(),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()})]),ScaleToFitOptionsSchema=z.object({w:z.number().min(0),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),ScaleComplexOptionsSchema=z.object({f:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$d={resize(tt,et){const{mode:rt}=ResizeOptionsSchema.parse(et);let nt,it;if(typeof et.w=="number")nt=et.w,it=et.h??tt.bitmap.height*(nt/tt.bitmap.width);else{if(typeof et.h!="number")throw new Error("w must be a number");it=et.h,nt=et.w??tt.bitmap.width*(it/tt.bitmap.height)}if(nt=Math.round(nt)||1,it=Math.round(it)||1,rt&&typeof operations[rt]=="function"){const at={data:Buffer$1.alloc(nt*it*4),width:nt,height:it};operations[rt](tt.bitmap,at),tt.bitmap=at}else new Resize(tt.bitmap.width,tt.bitmap.height,nt,it,!0,!0,(at=>{tt.bitmap.data=Buffer$1.from(at),tt.bitmap.width=nt,tt.bitmap.height=it})).resize(tt.bitmap.data);return tt},scale(tt,et){const{f:rt,mode:nt}=typeof et=="number"?{f:et}:ScaleComplexOptionsSchema.parse(et),it=tt.bitmap.width*rt,at=tt.bitmap.height*rt;return this.resize(tt,{w:it,h:at,mode:nt})},scaleToFit(tt,et){const{h:rt,w:nt,mode:it}=ScaleToFitOptionsSchema.parse(et),at=nt/rt>tt.bitmap.width/tt.bitmap.height?rt/tt.bitmap.height:nt/tt.bitmap.width;return this.scale(tt,{f:at,mode:it})}},ContainOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$c={contain(tt,et){const{w:rt,h:nt,align:it=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:at}=ContainOptionsSchema.parse(et),st=7&it,ot=it>>3;if((st===0||st&st-1)&&(ot===0||ot&ot-1))throw new Error("only use one flag per alignment direction");const lt=st>>1,ht=ot>>1,dt=rt/nt>tt.bitmap.width/tt.bitmap.height?nt/tt.bitmap.height:rt/tt.bitmap.width,ut=methods$d.scale(clone(tt),{f:dt,mode:at});return(tt=methods$d.resize(tt,{w:rt,h:nt,mode:at})).scan(((ft,mt,gt)=>{tt.bitmap.data.writeUInt32BE(tt.background,gt)})),tt=methods$h.blit(tt,{src:ut,x:(tt.bitmap.width-ut.bitmap.width)/2*lt,y:(tt.bitmap.height-ut.bitmap.height)/2*ht})}},CropOptionsSchema=z.object({x:z.number(),y:z.number(),w:z.number(),h:z.number()}),AutocropComplexOptionsSchema=z.object({tolerance:z.number().min(0).max(1).optional(),cropOnlyFrames:z.boolean().optional(),cropSymmetric:z.boolean().optional(),leaveBorder:z.number().optional(),ignoreSides:z.object({north:z.boolean().optional(),south:z.boolean().optional(),east:z.boolean().optional(),west:z.boolean().optional()}).optional()}),methods$b={crop(tt,et){let{x:rt,y:nt,w:it,h:at}=CropOptionsSchema.parse(et);if(rt=Math.round(rt),nt=Math.round(nt),it=Math.round(it),at=Math.round(at),rt===0&&it===tt.bitmap.width){const st=it*nt+rt<<2,ot=st+(at*it<<2);tt.bitmap.data=tt.bitmap.data.slice(st,ot)}else{const st=Buffer$1.allocUnsafe(it*at*4);let ot=0;scan(tt,rt,nt,it,at,(function(lt,ht,dt){const ut=tt.bitmap.data.readUInt32BE(dt);st.writeUInt32BE(ut,ot),ot+=4})),tt.bitmap.data=st}return tt.bitmap.width=it,tt.bitmap.height=at,tt},autocrop(tt,et={}){const{tolerance:rt=2e-4,cropOnlyFrames:nt=!0,cropSymmetric:it=!1,leaveBorder:at=0,ignoreSides:st}=typeof et=="number"?{tolerance:et}:AutocropComplexOptionsSchema.parse(et),ot=tt.bitmap.width,lt=tt.bitmap.height,ht={north:!1,south:!1,east:!1,west:!1,...st};let dt=tt.getPixelColor(0,0);const ut=intToRGBA$1(dt);let ft=0,mt=0,gt=0,vt=0;if(dt=tt.getPixelColor(0,0),!ht.north)e:for(let Tt=0;Tt<lt-1;Tt++){for(let Pt=0;Pt<ot;Pt++)if(colorDiff(ut,intToRGBA$1(tt.getPixelColor(Pt,Tt)))>rt)break e;ft++}if(dt=tt.getPixelColor(ot,0),!ht.west)e:for(let Tt=0;Tt<ot-1;Tt++){for(let Pt=0+ft;Pt<lt;Pt++)if(colorDiff(ut,intToRGBA$1(tt.getPixelColor(Tt,Pt)))>rt)break e;vt++}if(dt=tt.getPixelColor(0,lt),!ht.south)e:for(let Tt=lt-1;Tt>=ft+1;Tt--){for(let Pt=ot-mt-1;Pt>=0;Pt--)if(colorDiff(ut,intToRGBA$1(tt.getPixelColor(Pt,Tt)))>rt)break e;gt++}if(dt=tt.getPixelColor(ot,lt),!ht.east)e:for(let Tt=ot-1;Tt>=0+vt+1;Tt--){for(let Pt=lt-1;Pt>=0+ft;Pt--)if(colorDiff(ut,intToRGBA$1(tt.getPixelColor(Tt,Pt)))>rt)break e;mt++}let xt=!1;if(vt-=at,mt-=at,ft-=at,gt-=at,it){const Tt=Math.min(mt,vt),Pt=Math.min(ft,gt);vt=Tt,mt=Tt,ft=Pt,gt=Pt}vt=vt>=0?vt:0,mt=mt>=0?mt:0,ft=ft>=0?ft:0,gt=gt>=0?gt:0;const wt=ot-(vt+mt),At=lt-(gt+ft);return xt=nt?mt!==0&&ft!==0&&vt!==0&&gt!==0:mt!==0||ft!==0||vt!==0||gt!==0,xt&&this.crop(tt,{x:vt,y:ft,w:wt,h:At}),tt}},CoverOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$a={cover(tt,et){const{w:rt,h:nt,align:it=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:at}=CoverOptionsSchema.parse(et),st=7&it,ot=it>>3;if((st===0||st&st-1)&&(ot===0||ot&ot-1))throw new Error("only use one flag per alignment direction");const lt=st>>1,ht=ot>>1,dt=rt/nt>tt.bitmap.width/tt.bitmap.height?rt/tt.bitmap.width:nt/tt.bitmap.height;return tt=methods$d.scale(tt,{f:dt,mode:at}),tt=methods$b.crop(tt,{x:(tt.bitmap.width-rt)/2*lt,y:(tt.bitmap.height-nt)/2*ht,w:rt,h:nt})}},DisplaceOptionsSchema=z.object({map:JimpClassSchema,offset:z.number()}),methods$9={displace(tt,et){const{map:rt,offset:nt}=DisplaceOptionsSchema.parse(et),it=clone(tt);return tt.scan(((at,st,ot)=>{let lt=rt.bitmap.data[ot]/256*nt;lt=Math.round(lt);const ht=tt.getPixelIndex(at+lt,st);tt.bitmap.data[ht]=it.bitmap.data[ot],tt.bitmap.data[ht+1]=it.bitmap.data[ot+1],tt.bitmap.data[ht+2]=it.bitmap.data[ot+2]})),tt}},methods$8={dither(tt){const et=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return tt.scan(((rt,nt,it)=>{const at=et[((3&nt)<<2)+rt%4];tt.bitmap.data[it]=Math.min(tt.bitmap.data[it]+at,255),tt.bitmap.data[it+1]=Math.min(tt.bitmap.data[it+1]+at,255),tt.bitmap.data[it+2]=Math.min(tt.bitmap.data[it+2]+at,255)})),tt}},FisheyeOptionsSchema=z.object({radius:z.number().min(0).optional()}),methods$7={fisheye(tt,et={}){const{radius:rt=2.5}=FisheyeOptionsSchema.parse(et),nt=clone(tt),{width:it,height:at}=nt.bitmap;return nt.scan(((st,ot)=>{const lt=st/it,ht=ot/at,dt=Math.sqrt(Math.pow(lt-.5,2)+Math.pow(ht-.5,2)),ut=2*Math.pow(dt,rt),ft=(lt-.5)/dt,mt=(ht-.5)/dt,gt=Math.round((ut*ft+.5)*it),vt=Math.round((ut*mt+.5)*at),xt=nt.getPixelColor(gt,vt);tt.setPixelColor(xt,st,ot)})),tt.setPixelColor(nt.getPixelColor(it/2,at/2),it/2,at/2),tt}},FlipOptionsSchema=z.object({horizontal:z.boolean().optional(),vertical:z.boolean().optional()}),methods$6={flip(tt,et){const{horizontal:rt,vertical:nt}=FlipOptionsSchema.parse(et),it=Buffer$1.alloc(tt.bitmap.data.length);return tt.scan(((at,st,ot)=>{const lt=rt?tt.bitmap.width-1-at:at,ht=nt?tt.bitmap.height-1-st:st,dt=tt.bitmap.width*ht+lt<<2,ut=tt.bitmap.data.readUInt32BE(ot);it.writeUInt32BE(ut,dt)})),tt.bitmap.data=Buffer$1.from(it),tt}};function Converter$1(tt,et){if(!(tt&&et&&tt.length&&et.length))throw new Error("Bad alphabet");this.srcAlphabet=tt,this.dstAlphabet=et}Converter$1.prototype.convert=function(tt){var et,rt,nt,it={},at=this.srcAlphabet.length,st=this.dstAlphabet.length,ot=tt.length,lt=typeof tt=="string"?"":[];if(!this.isValid(tt))throw new Error('Number "'+tt+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return tt;for(et=0;et<ot;et++)it[et]=this.srcAlphabet.indexOf(tt[et]);do{for(rt=0,nt=0,et=0;et<ot;et++)(rt=rt*at+it[et])>=st?(it[nt++]=parseInt(rt/st,10),rt%=st):nt>0&&(it[nt++]=0);ot=nt,lt=this.dstAlphabet.slice(rt,rt+1).concat(lt)}while(nt!==0);return lt},Converter$1.prototype.isValid=function(tt){for(var et=0;et<tt.length;++et)if(this.srcAlphabet.indexOf(tt[et])===-1)return!1;return!0};var converter=Converter$1,Converter=converter;function anyBase(tt,et){var rt=new Converter(tt,et);return function(nt){return rt.convert(nt)}}anyBase.BIN="01",anyBase.OCT="01234567",anyBase.DEC="0123456789",anyBase.HEX="0123456789abcdef";var anyBase_1=anyBase,anyBase$1=getDefaultExportFromCjs(anyBase_1),__defProp$1=Object.defineProperty,__defNormalProp$1=(tt,et,rt)=>et in tt?__defProp$1(tt,et,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[et]=rt,__publicField$1=(tt,et,rt)=>__defNormalProp$1(tt,typeof et!="symbol"?et+"":et,rt);class ImagePHash{constructor(et,rt){__publicField$1(this,"size"),__publicField$1(this,"smallerSize"),this.size=et||32,this.smallerSize=rt||8,initCoefficients(this.size)}distance(et,rt){let nt=0;for(let it=0;it<et.length;it++)et[it]!==rt[it]&&nt++;return nt/et.length}getHash(et){et=methods$d.resize(clone(et),{w:this.size,h:this.size}),et=methods$e.greyscale(et);const rt=[];for(let ot=0;ot<et.bitmap.width;ot++){const lt=[];for(let ht=0;ht<et.bitmap.height;ht++)lt[ht]=intToRGBA(et.getPixelColor(ot,ht)).b;rt[ot]=lt}const nt=applyDCT(rt,this.size);let it=0;for(let ot=0;ot<this.smallerSize;ot++)for(let lt=0;lt<this.smallerSize;lt++)it+=nt[ot][lt];const at=it/(this.smallerSize*this.smallerSize);let st="";for(let ot=0;ot<this.smallerSize;ot++)for(let lt=0;lt<this.smallerSize;lt++)st+=nt[ot][lt]>at?"1":"0";return st}}function intToRGBA(tt){const et=255&tt,rt=255&(tt>>>=8),nt=255&(tt>>>=8);return{r:255&(tt>>>=8),g:nt,b:rt,a:et}}const c$1=[];function initCoefficients(tt){for(let et=1;et<tt;et++)c$1[et]=1;c$1[0]=1/Math.sqrt(2)}function applyDCT(tt,et){const rt=et,nt=[];for(let it=0;it<rt;it++){const at=[];for(let st=0;st<rt;st++){let ot=0;for(let lt=0;lt<rt;lt++)for(let ht=0;ht<rt;ht++)ot+=Math.cos((2*lt+1)/(2*rt)*it*Math.PI)*Math.cos((2*ht+1)/(2*rt)*st*Math.PI)*tt[lt][ht];ot*=c$1[it]*c$1[st]/4,at[st]=ot,nt[it]=at}}return nt}const alphabet="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",maxHashLength=[NaN,NaN];for(let tt=2;tt<65;tt++){const et=anyBase$1(anyBase$1.BIN,alphabet.slice(0,tt))(new Array(65).join("1"));maxHashLength.push(et.length)}const methods$5={pHash:tt=>new ImagePHash().getHash(tt),hash(tt,et=64){if(et<2||et>64)throw new Error("base must be a number between 2 and 64");const rt=alphabet.slice(0,et),nt=this.pHash(tt),it=maxHashLength[et];return anyBase$1(anyBase$1.BIN,rt)(nt).padStart(it,"0")},distanceFromHash(tt,et){const rt=new ImagePHash,nt=rt.getHash(tt);return rt.distance(nt,et)}},MaskOptionsObjectSchema=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional()}),MaskOptionsSchema=z.union([JimpClassSchema,MaskOptionsObjectSchema]),methods$4={mask(tt,et){let rt,nt,it;MaskOptionsSchema.parse(et),"bitmap"in et?(rt=et,nt=0,it=0):(rt=et.src,nt=et.x??0,it=et.y??0),nt=Math.round(nt),it=Math.round(it);const at=tt.bitmap.width,st=tt.bitmap.height;return rt.scan((function(ot,lt,ht){const dt=nt+ot,ut=it+lt;if(dt>=0&&ut>=0&&dt<at&&ut<st){const ft=tt.getPixelIndex(dt,ut),{data:mt}=rt.bitmap,gt=(mt[ht+0]+mt[ht+1]+mt[ht+2])/3;tt.bitmap.data[ft+3]*=gt/255}})),tt}};function measureText(tt,et){let rt=0;for(let nt=0;nt<et.length;nt++){const it=et[nt],at=tt.chars[it];if(at){const st=tt.kernings[it],ot=et[nt+1],lt=st&&ot&&st[ot]&&st[ot]||0;rt+=(at.xadvance||0)+lt}}return rt}function splitLines(tt,et,rt){const nt=et.replace(/[\r\n]+/g,` 
`).split(" "),it=[];let at=[],st=0;return nt.forEach((ot=>{if(measureText(tt,ot+(nt.length>1?" ":""))>rt){const dt=ot[Symbol.iterator]();let ut="";for(const ft of dt){const mt=[...at,ut+ft].join(" "),gt=measureText(tt,mt);gt<rt?ut+=ft:gt>rt?(it.push([...at,ut]),at=[],ut=ft):(it.push([...at,ut+ft]),at=[],ut="")}return}const lt=[...at,ot].join(" "),ht=measureText(tt,lt);ht<=rt&&!ot.includes(`
`)?(ht>st&&(st=ht),at.push(ot)):(it.push(at),at=[ot.replace(`
`,"")])})),it.push(at),{lines:it,longestLine:st}}function measureTextHeight(tt,et,rt){const{lines:nt}=splitLines(tt,et,rt);return nt.length*tt.common.lineHeight}const PrintOptionsSchema=z.object({x:z.number(),y:z.number(),text:z.union([z.union([z.string(),z.number()]),z.object({text:z.union([z.string(),z.number()]),alignmentX:z.nativeEnum(HorizontalAlign).optional(),alignmentY:z.nativeEnum(VerticalAlign).optional()})]),maxWidth:z.number().optional(),maxHeight:z.number().optional(),cb:z.function(z.tuple([z.object({x:z.number(),y:z.number()})])).optional()});function xOffsetBasedOnAlignment(tt,et,rt,nt){return nt===HorizontalAlign.LEFT?0:nt===HorizontalAlign.CENTER?(rt-measureText(tt,et))/2:rt-measureText(tt,et)}function drawCharacter(tt,et,rt,nt,it){if(it.width>0&&it.height>0){const at=et.pages[it.page];at&&(tt=methods$h.blit(tt,{src:at,x:rt+it.xoffset,y:nt+it.yoffset,srcX:it.x,srcY:it.y,srcW:it.width,srcH:it.height}))}return tt}function printText(tt,et,rt,nt,it,at){for(let st=0;st<it.length;st++){const ot=it[st];let lt;lt=et.chars[ot]?ot:/\s/.test(ot)?"":"?";const ht=et.chars[lt]||{xadvance:void 0},dt=et.kernings[lt];ht&&drawCharacter(tt,et,rt,nt,ht);const ut=it[st+1];rt+=(dt&&ut&&dt[ut]&&dt[ut]||0)+(ht.xadvance||at)}}const methods$3={print(tt,{font:et,...rt}){let nt,it,{x:at,y:st,text:ot,maxWidth:lt=1/0,maxHeight:ht=1/0,cb:dt=(()=>{})}=PrintOptionsSchema.parse(rt);typeof ot=="object"&&ot.text!==null&&ot.text!==void 0?(nt=ot.alignmentX||HorizontalAlign.LEFT,it=ot.alignmentY||VerticalAlign.TOP,{text:ot}=ot):(nt=HorizontalAlign.LEFT,it=VerticalAlign.TOP,ot=ot.toString()),typeof ot=="number"&&(ot=ot.toString()),ht!==1/0&&it===VerticalAlign.BOTTOM?st+=ht-measureTextHeight(et,ot,lt):ht!==1/0&&it===VerticalAlign.MIDDLE&&(st+=ht/2-measureTextHeight(et,ot,lt)/2);const ut=Object.entries(et.chars).find((gt=>gt[1].xadvance))?.[1].xadvance;if(typeof ut!="number")throw new Error("Could not find default character width");const{lines:ft,longestLine:mt}=splitLines(et,ot,lt);return ft.forEach((gt=>{const vt=gt.join(" "),xt=xOffsetBasedOnAlignment(et,vt,lt,nt);printText(tt,et,at+xt,st,vt,ut),st+=et.common.lineHeight})),dt.bind(tt)({x:at+mt,y:st}),tt}},RotateOptionsSchema=z.union([z.number(),z.object({deg:z.number(),mode:z.union([z.boolean(),z.nativeEnum(ResizeStrategy)]).optional()})]);function createIdxTranslationFunction(tt){return function(et,rt){return rt*tt+et<<2}}function matrixRotate(tt,et){if(Math.abs(et)%90!=0)throw new Error("Unsupported matrix rotation degree");const rt=tt.bitmap.width,nt=tt.bitmap.height;let it;switch(et){case 90:case-270:it=90;break;case 180:case-180:it=180;break;case 270:case-90:it=-90;break;default:throw new Error("Unsupported matrix rotation degree")}const at=it===180?rt:nt,st=it===180?nt:rt,ot=Buffer$1.alloc(tt.bitmap.data.length),lt=createIdxTranslationFunction(rt),ht=createIdxTranslationFunction(at);for(let dt=0;dt<rt;dt++)for(let ut=0;ut<nt;ut++){const ft=lt(dt,ut),mt=tt.bitmap.data.readUInt32BE(ft);let gt;switch(it){case 90:gt=ht(ut,rt-dt-1);break;case-90:gt=ht(nt-ut-1,dt);break;case 180:gt=ht(rt-dt-1,nt-ut-1);break;default:throw new Error("Unsupported matrix rotation angle")}ot.writeUInt32BE(mt,gt)}tt.bitmap.data=ot,tt.bitmap.width=at,tt.bitmap.height=st}function createTranslationFunction(tt,et){return function(rt,nt){return{x:rt+tt,y:nt+et}}}function advancedRotate(tt,et,rt){const nt=et*Math.PI/180,it=Math.cos(nt),at=Math.sin(nt);let st=tt.bitmap.width,ot=tt.bitmap.height;if(rt===!0||typeof rt=="string"){st=Math.ceil(Math.abs(tt.bitmap.width*it)+Math.abs(tt.bitmap.height*at))+1,ot=Math.ceil(Math.abs(tt.bitmap.width*at)+Math.abs(tt.bitmap.height*it))+1,st%2!=0&&st++,ot%2!=0&&ot++;const mt=clone(tt);tt.scan(((vt,xt,wt)=>{tt.bitmap.data.writeUInt32BE(tt.background,wt)}));const gt=Math.max(st,ot,tt.bitmap.width,tt.bitmap.height);tt=composite(tt=methods$d.resize(tt,{h:gt,w:gt,mode:rt===!0?void 0:rt}),mt,tt.bitmap.width/2-mt.bitmap.width/2,tt.bitmap.height/2-mt.bitmap.height/2)}const lt=tt.bitmap.width,ht=tt.bitmap.height,dt=Buffer$1.alloc(tt.bitmap.data.length),ut=createTranslationFunction(-lt/2,-ht/2),ft=createTranslationFunction(lt/2+.5,ht/2+.5);for(let mt=1;mt<=ht;mt++)for(let gt=1;gt<=lt;gt++){const vt=ut(gt,mt),xt=ft(it*vt.x-at*vt.y,it*vt.y+at*vt.x),wt=lt*(mt-1)+gt-1<<2;if(xt.x>=0&&xt.x<lt&&xt.y>=0&&xt.y<ht){const At=lt*(0|xt.y)+xt.x<<2,Tt=tt.bitmap.data.readUInt32BE(At);dt.writeUInt32BE(Tt,wt)}else dt.writeUInt32BE(tt.background,wt)}if(tt.bitmap.data=dt,rt===!0||typeof rt=="string"){const mt=Math.max(lt/2-st/2,0),gt=Math.max(ht/2-ot/2,0);tt=methods$b.crop(tt,{x:mt,y:gt,w:st,h:ot})}}const methods$2={rotate(tt,et){const rt=RotateOptionsSchema.parse(et),nt=typeof rt=="number"?{deg:rt}:rt,{mode:it=!0}=nt;let{deg:at}=nt;return at%=360,at%360==0||(at%90==0&&(it||tt.bitmap.width===tt.bitmap.height||at%180==0)?matrixRotate(tt,at):advancedRotate(tt,at,it)),tt}},ThresholdOptionsSchema=z.object({max:z.number().min(0).max(255),replace:z.number().min(0).max(255).optional(),autoGreyscale:z.boolean().optional()}),methods$1={threshold(tt,et){let{max:rt,replace:nt=255,autoGreyscale:it=!0}=ThresholdOptionsSchema.parse(et);return rt=limit255(rt),nt=limit255(nt),it&&methods$e.greyscale(tt),tt.scan(((at,st,ot)=>{const lt=tt.bitmap.data[ot]<rt?tt.bitmap.data[ot]:nt;tt.bitmap.data[ot]=lt,tt.bitmap.data[ot+1]=lt,tt.bitmap.data[ot+2]=lt})),tt}};var __defProp=Object.defineProperty,__defNormalProp=(tt,et,rt)=>et in tt?__defProp(tt,et,{enumerable:!0,configurable:!0,writable:!0,value:rt}):tt[et]=rt,__export=(tt,et)=>{for(var rt in et)__defProp(tt,rt,{get:et[rt],enumerable:!0})},__publicField=(tt,et,rt)=>(__defNormalProp(tt,typeof et!="symbol"?et+"":et,rt),rt),constants_exports={};__export(constants_exports,{bt709:()=>bt709_exports});var bt709_exports={};__export(bt709_exports,{Y:()=>Y,x:()=>x$1,y:()=>y$1});var Y=(tt=>(tt[tt.RED=.2126]="RED",tt[tt.GREEN=.7152]="GREEN",tt[tt.BLUE=.0722]="BLUE",tt[tt.WHITE=1]="WHITE",tt))(Y||{}),x$1=(tt=>(tt[tt.RED=.64]="RED",tt[tt.GREEN=.3]="GREEN",tt[tt.BLUE=.15]="BLUE",tt[tt.WHITE=.3127]="WHITE",tt))(x$1||{}),y$1=(tt=>(tt[tt.RED=.33]="RED",tt[tt.GREEN=.6]="GREEN",tt[tt.BLUE=.06]="BLUE",tt[tt.WHITE=.329]="WHITE",tt))(y$1||{}),conversion_exports={};function correctGamma(tt){return tt>.04045?((tt+.055)/1.055)**2.4:tt/12.92}function rgb2xyz(tt,et,rt){return{x:.4124*(tt=correctGamma(tt/255))+.3576*(et=correctGamma(et/255))+.1805*(rt=correctGamma(rt/255)),y:.2126*tt+.7152*et+.0722*rt,z:.0193*tt+.1192*et+.9505*rt}}__export(conversion_exports,{lab2rgb:()=>lab2rgb,lab2xyz:()=>lab2xyz,rgb2hsl:()=>rgb2hsl,rgb2lab:()=>rgb2lab,rgb2xyz:()=>rgb2xyz,xyz2lab:()=>xyz2lab,xyz2rgb:()=>xyz2rgb});var arithmetic_exports={};function degrees2radians(tt){return tt*(Math.PI/180)}function max3(tt,et,rt){let nt=tt;return nt<et&&(nt=et),nt<rt&&(nt=rt),nt}function min3(tt,et,rt){let nt=tt;return nt>et&&(nt=et),nt>rt&&(nt=rt),nt}function intInRange(tt,et,rt){return tt>rt&&(tt=rt),tt<et&&(tt=et),0|tt}function inRange0to255Rounded(tt){return(tt=Math.round(tt))>255?tt=255:tt<0&&(tt=0),tt}function inRange0to255(tt){return tt>255?tt=255:tt<0&&(tt=0),tt}function stableSort(tt,et){const rt=typeof tt[0];let nt;if(rt==="number"||rt==="string"){const it=Object.create(null);for(let at=0,st=tt.length;at<st;at++){const ot=tt[at];it[ot]||it[ot]===0||(it[ot]=at)}nt=tt.sort(((at,st)=>et(at,st)||it[at]-it[st]))}else{const it=tt.slice(0);nt=tt.sort(((at,st)=>et(at,st)||it.indexOf(at)-it.indexOf(st)))}return nt}function rgb2hsl(tt,et,rt){const nt=min3(tt,et,rt),it=max3(tt,et,rt),at=it-nt,st=(nt+it)/510;let ot=0;st>0&&st<1&&(ot=at/(st<.5?it+nt:510-it-nt));let lt=0;return at>0&&(lt=it===tt?(et-rt)/at:it===et?2+(rt-tt)/at:4+(tt-et)/at,lt*=60,lt<0&&(lt+=360)),{h:lt,s:ot,l:st}}__export(arithmetic_exports,{degrees2radians:()=>degrees2radians,inRange0to255:()=>inRange0to255,inRange0to255Rounded:()=>inRange0to255Rounded,intInRange:()=>intInRange,max3:()=>max3,min3:()=>min3,stableSort:()=>stableSort});var refX=.95047,refY=1,refZ=1.08883;function pivot(tt){return tt>.008856?tt**(1/3):7.787*tt+16/116}function xyz2lab(tt,et,rt){if(tt=pivot(tt/refX),et=pivot(et/refY),rt=pivot(rt/refZ),116*et-16<0)throw new Error("xxx");return{L:Math.max(0,116*et-16),a:500*(tt-et),b:200*(et-rt)}}function rgb2lab(tt,et,rt){const nt=rgb2xyz(tt,et,rt);return xyz2lab(nt.x,nt.y,nt.z)}var refX2=.95047,refY2=1,refZ2=1.08883;function pivot2(tt){return tt>.206893034?tt**3:(tt-16/116)/7.787}function lab2xyz(tt,et,rt){const nt=(tt+16)/116,it=nt-rt/200;return{x:refX2*pivot2(et/500+nt),y:refY2*pivot2(nt),z:refZ2*pivot2(it)}}function correctGamma2(tt){return tt>.0031308?1.055*tt**(1/2.4)-.055:12.92*tt}function xyz2rgb(tt,et,rt){const nt=correctGamma2(3.2406*tt+-1.5372*et+-.4986*rt),it=correctGamma2(-.9689*tt+1.8758*et+.0415*rt),at=correctGamma2(.0557*tt+-.204*et+1.057*rt);return{r:inRange0to255Rounded(255*nt),g:inRange0to255Rounded(255*it),b:inRange0to255Rounded(255*at)}}function lab2rgb(tt,et,rt){const nt=lab2xyz(tt,et,rt);return xyz2rgb(nt.x,nt.y,nt.z)}var distance_exports={};__export(distance_exports,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator,AbstractEuclidean:()=>AbstractEuclidean,AbstractManhattan:()=>AbstractManhattan,CIE94GraphicArts:()=>CIE94GraphicArts,CIE94Textiles:()=>CIE94Textiles,CIEDE2000:()=>CIEDE2000,CMetric:()=>CMetric,Euclidean:()=>Euclidean,EuclideanBT709:()=>EuclideanBT709,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha,Manhattan:()=>Manhattan,ManhattanBT709:()=>ManhattanBT709,ManhattanNommyde:()=>ManhattanNommyde,PNGQuant:()=>PNGQuant});var AbstractDistanceCalculator=class{constructor(){__publicField(this,"_maxDistance"),__publicField(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(tt,et,rt,nt){this._whitePoint={r:tt>0?255/tt:0,g:et>0?255/et:0,b:rt>0?255/rt:0,a:nt>0?255/nt:0},this._maxDistance=this.calculateRaw(tt,et,rt,nt,0,0,0,0)}calculateNormalized(tt,et){return this.calculateRaw(tt.r,tt.g,tt.b,tt.a,et.r,et.g,et.b,et.a)/this._maxDistance}},AbstractCIE94=class extends AbstractDistanceCalculator{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=rgb2lab(inRange0to255(tt*this._whitePoint.r),inRange0to255(et*this._whitePoint.g),inRange0to255(rt*this._whitePoint.b)),ht=rgb2lab(inRange0to255(it*this._whitePoint.r),inRange0to255(at*this._whitePoint.g),inRange0to255(st*this._whitePoint.b)),dt=lt.L-ht.L,ut=lt.a-ht.a,ft=lt.b-ht.b,mt=Math.sqrt(lt.a*lt.a+lt.b*lt.b),gt=mt-Math.sqrt(ht.a*ht.a+ht.b*ht.b);let vt=ut*ut+ft*ft-gt*gt;vt=vt<0?0:Math.sqrt(vt);const xt=(ot-nt)*this._whitePoint.a*this._kA;return Math.sqrt((dt/this._Kl)**2+(gt/(1+this._K1*mt))**2+(vt/(1+this._K2*mt))**2+xt**2)}},CIE94Textiles=class extends AbstractCIE94{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts=class extends AbstractCIE94{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000=class extends AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(tt,et){const rt=Math.atan2(tt,et);return rt>=0?rt:rt+_CIEDE2000._deg360InRad}static _calculateRT(tt,et){const rt=et**7,nt=2*Math.sqrt(rt/(rt+_CIEDE2000._pow25to7)),it=_CIEDE2000._deg30InRad*Math.exp(-(((tt-_CIEDE2000._deg275InRad)/_CIEDE2000._deg25InRad)**2));return-Math.sin(2*it)*nt}static _calculateT(tt){return 1-.17*Math.cos(tt-_CIEDE2000._deg30InRad)+.24*Math.cos(2*tt)+.32*Math.cos(3*tt+_CIEDE2000._deg6InRad)-.2*Math.cos(4*tt-_CIEDE2000._deg63InRad)}static _calculate_ahp(tt,et,rt,nt){const it=rt+nt;return tt===0?it:et<=_CIEDE2000._deg180InRad?it/2:it<_CIEDE2000._deg360InRad?(it+_CIEDE2000._deg360InRad)/2:(it-_CIEDE2000._deg360InRad)/2}static _calculate_dHp(tt,et,rt,nt){let it;return it=tt===0?0:et<=_CIEDE2000._deg180InRad?rt-nt:rt<=nt?rt-nt+_CIEDE2000._deg360InRad:rt-nt-_CIEDE2000._deg360InRad,2*Math.sqrt(tt)*Math.sin(it/2)}calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=rgb2lab(inRange0to255(tt*this._whitePoint.r),inRange0to255(et*this._whitePoint.g),inRange0to255(rt*this._whitePoint.b)),ht=rgb2lab(inRange0to255(it*this._whitePoint.r),inRange0to255(at*this._whitePoint.g),inRange0to255(st*this._whitePoint.b)),dt=(ot-nt)*this._whitePoint.a*_CIEDE2000._kA,ut=this.calculateRawInLab(lt,ht);return Math.sqrt(ut+dt*dt)}calculateRawInLab(tt,et){const rt=tt.L,nt=tt.a,it=tt.b,at=et.L,st=et.a,ot=et.b,lt=((Math.sqrt(nt*nt+it*it)+Math.sqrt(st*st+ot*ot))/2)**7,ht=.5*(1-Math.sqrt(lt/(lt+_CIEDE2000._pow25to7))),dt=(1+ht)*nt,ut=(1+ht)*st,ft=Math.sqrt(dt*dt+it*it),mt=Math.sqrt(ut*ut+ot*ot),gt=ft*mt,vt=_CIEDE2000._calculatehp(it,dt),xt=_CIEDE2000._calculatehp(ot,ut),wt=Math.abs(vt-xt),At=at-rt,Tt=mt-ft,Pt=_CIEDE2000._calculate_dHp(gt,wt,xt,vt),Rt=_CIEDE2000._calculate_ahp(gt,wt,vt,xt),Ot=(ft+mt)/2,Et=((rt+at)/2-50)**2,Lt=Tt/(1+.045*Ot),kt=Pt/(1+.015*_CIEDE2000._calculateT(Rt)*Ot);return(At/(1+.015*Et/Math.sqrt(20+Et)))**2+Lt**2+kt**2+_CIEDE2000._calculateRT(Rt,Ot)*Lt*kt}},CIEDE2000=_CIEDE2000;__publicField(CIEDE2000,"_kA",25/255),__publicField(CIEDE2000,"_pow25to7",25**7),__publicField(CIEDE2000,"_deg360InRad",degrees2radians(360)),__publicField(CIEDE2000,"_deg180InRad",degrees2radians(180)),__publicField(CIEDE2000,"_deg30InRad",degrees2radians(30)),__publicField(CIEDE2000,"_deg6InRad",degrees2radians(6)),__publicField(CIEDE2000,"_deg63InRad",degrees2radians(63)),__publicField(CIEDE2000,"_deg275InRad",degrees2radians(275)),__publicField(CIEDE2000,"_deg25InRad",degrees2radians(25));var CMetric=class extends AbstractDistanceCalculator{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=(tt+it)/2*this._whitePoint.r,ht=(tt-it)*this._whitePoint.r,dt=(et-at)*this._whitePoint.g,ut=(rt-st)*this._whitePoint.b,ft=((512+lt)*ht*ht>>8)+4*dt*dt+((767-lt)*ut*ut>>8),mt=(ot-nt)*this._whitePoint.a;return Math.sqrt(ft+mt*mt)}_setDefaults(){}},AbstractEuclidean=class extends AbstractDistanceCalculator{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=it-tt,ht=at-et,dt=st-rt,ut=ot-nt;return Math.sqrt(this._kR*lt*lt+this._kG*ht*ht+this._kB*dt*dt+this._kA*ut*ut)}},Euclidean=class extends AbstractEuclidean{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan=class extends AbstractDistanceCalculator{calculateRaw(tt,et,rt,nt,it,at,st,ot){let lt=it-tt,ht=at-et,dt=st-rt,ut=ot-nt;return lt<0&&(lt=0-lt),ht<0&&(ht=0-ht),dt<0&&(dt=0-dt),ut<0&&(ut=0-ut),this._kR*lt+this._kG*ht+this._kB*dt+this._kA*ut}},Manhattan=class extends AbstractManhattan{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde=class extends AbstractManhattan{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709=class extends AbstractManhattan{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant=class extends AbstractDistanceCalculator{calculateRaw(tt,et,rt,nt,it,at,st,ot){const lt=(ot-nt)*this._whitePoint.a;return this._colordifferenceCh(tt*this._whitePoint.r,it*this._whitePoint.r,lt)+this._colordifferenceCh(et*this._whitePoint.g,at*this._whitePoint.g,lt)+this._colordifferenceCh(rt*this._whitePoint.b,st*this._whitePoint.b,lt)}_colordifferenceCh(tt,et,rt){const nt=tt-et,it=nt+rt;return nt*nt+it*it}_setDefaults(){}},palette_exports={};__export(palette_exports,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer,ColorHistogram:()=>ColorHistogram,NeuQuant:()=>NeuQuant,NeuQuantFloat:()=>NeuQuantFloat,RGBQuant:()=>RGBQuant,WuColorCube:()=>WuColorCube,WuQuant:()=>WuQuant});var AbstractPaletteQuantizer=class{quantizeSync(){for(const tt of this.quantize())if(tt.palette)return tt.palette;throw new Error("unreachable")}},Point=class{constructor(){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),__publicField(this,"uint32"),__publicField(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(tt){const et=new Point;return et.r=0|tt[0],et.g=0|tt[1],et.b=0|tt[2],et.a=0|tt[3],et._loadUINT32(),et._loadQuadruplet(),et}static createByRGBA(tt,et,rt,nt){const it=new Point;return it.r=0|tt,it.g=0|et,it.b=0|rt,it.a=0|nt,it._loadUINT32(),it._loadQuadruplet(),it}static createByUint32(tt){const et=new Point;return et.uint32=tt>>>0,et._loadRGBA(),et._loadQuadruplet(),et}from(tt){this.r=tt.r,this.g=tt.g,this.b=tt.b,this.a=tt.a,this.uint32=tt.uint32,this.rgba[0]=tt.r,this.rgba[1]=tt.g,this.rgba[2]=tt.b,this.rgba[3]=tt.a}getLuminosity(tt){let et=this.r,rt=this.g,nt=this.b;return tt&&(et=Math.min(255,255-this.a+this.a*et/255),rt=Math.min(255,255-this.a+this.a*rt/255),nt=Math.min(255,255-this.a+this.a*nt/255)),.2126*et+.7152*rt+.0722*nt}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer=class{constructor(){__publicField(this,"_pointArray"),__publicField(this,"_width"),__publicField(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(tt){this._width=tt}setHeight(tt){this._height=tt}getPointArray(){return this._pointArray}clone(){const tt=new PointContainer;tt._width=this._width,tt._height=this._height;for(let et=0,rt=this._pointArray.length;et<rt;et++)tt._pointArray[et]=Point.createByUint32(0|this._pointArray[et].uint32);return tt}toUint32Array(){const tt=this._pointArray.length,et=new Uint32Array(tt);for(let rt=0;rt<tt;rt++)et[rt]=this._pointArray[rt].uint32;return et}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(tt){const et=tt.naturalWidth,rt=tt.naturalHeight,nt=document.createElement("canvas");return nt.width=et,nt.height=rt,nt.getContext("2d").drawImage(tt,0,0,et,rt,0,0,et,rt),PointContainer.fromHTMLCanvasElement(nt)}static fromHTMLCanvasElement(tt){const et=tt.width,rt=tt.height,nt=tt.getContext("2d").getImageData(0,0,et,rt);return PointContainer.fromImageData(nt)}static fromImageData(tt){const et=tt.width,rt=tt.height;return PointContainer.fromUint8Array(tt.data,et,rt)}static fromUint8Array(tt,et,rt){switch(Object.prototype.toString.call(tt)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:tt=new Uint8Array(tt)}const nt=new Uint32Array(tt.buffer);return PointContainer.fromUint32Array(nt,et,rt)}static fromUint32Array(tt,et,rt){const nt=new PointContainer;nt._width=et,nt._height=rt;for(let it=0,at=tt.length;it<at;it++)nt._pointArray[it]=Point.createByUint32(0|tt[it]);return nt}static fromBuffer(tt,et,rt){const nt=new Uint32Array(tt.buffer,tt.byteOffset,tt.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer.fromUint32Array(nt,et,rt)}},hueGroups=10;function hueGroup(tt,et){const rt=360/et;for(let nt=1,it=rt-rt/2;nt<et;nt++,it+=rt)if(tt>=it&&tt<it+rt)return nt;return 0}var Palette=class{constructor(){__publicField(this,"_pointContainer"),__publicField(this,"_pointArray",[]),__publicField(this,"_i32idx",{}),this._pointContainer=new PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(tt){this._pointArray.push(tt),this._pointContainer.setWidth(this._pointArray.length)}has(tt){for(let et=this._pointArray.length-1;et>=0;et--)if(tt.uint32===this._pointArray[et].uint32)return!0;return!1}getNearestColor(tt,et){return this._pointArray[0|this._getNearestIndex(tt,et)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(tt){return typeof this._i32idx[tt]=="number"?this._i32idx[tt]:-1}_getNearestIndex(tt,et){let rt=this._nearestPointFromCache(""+et.uint32);if(rt>=0)return rt;let nt=Number.MAX_VALUE;rt=0;for(let it=0,at=this._pointArray.length;it<at;it++){const st=this._pointArray[it],ot=tt.calculateRaw(et.r,et.g,et.b,et.a,st.r,st.g,st.b,st.a);ot<nt&&(nt=ot,rt=it)}return this._i32idx[et.uint32]=rt,rt}sort(){this._i32idx={},this._pointArray.sort(((tt,et)=>{const rt=rgb2hsl(tt.r,tt.g,tt.b),nt=rgb2hsl(et.r,et.g,et.b),it=tt.r===tt.g&&tt.g===tt.b?0:1+hueGroup(rt.h,hueGroups),at=(et.r===et.g&&et.g===et.b?0:1+hueGroup(nt.h,hueGroups))-it;if(at)return-at;const st=tt.getLuminosity(!0),ot=et.getLuminosity(!0);if(ot-st!=0)return ot-st;const lt=(100*nt.s|0)-(100*rt.s|0);return lt?-lt:0}))}},utils_exports={};__export(utils_exports,{HueStatistics:()=>HueStatistics,Palette:()=>Palette,Point:()=>Point,PointContainer:()=>PointContainer,ProgressTracker:()=>ProgressTracker,arithmetic:()=>arithmetic_exports});var HueGroup=class{constructor(){__publicField(this,"num",0),__publicField(this,"cols",[])}},HueStatistics=class{constructor(tt,et){__publicField(this,"_numGroups"),__publicField(this,"_minCols"),__publicField(this,"_stats"),__publicField(this,"_groupsFull"),this._numGroups=tt,this._minCols=et,this._stats=[];for(let rt=0;rt<=tt;rt++)this._stats[rt]=new HueGroup;this._groupsFull=0}check(tt){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const et=255&tt,rt=tt>>>8&255,nt=tt>>>16&255,it=et===rt&&rt===nt?0:1+hueGroup(rgb2hsl(et,rt,nt).h,this._numGroups),at=this._stats[it],st=this._minCols;at.num++,at.num>st||(at.num===st&&this._groupsFull++,at.num<=st&&this._stats[it].cols.push(tt))}injectIntoDictionary(tt){for(let et=0;et<=this._numGroups;et++)this._stats[et].num<=this._minCols&&this._stats[et].cols.forEach((rt=>{tt[rt]?tt[rt]++:tt[rt]=1}))}injectIntoArray(tt){for(let et=0;et<=this._numGroups;et++)this._stats[et].num<=this._minCols&&this._stats[et].cols.forEach((rt=>{tt.indexOf(rt)===-1&&tt.push(rt)}))}},_ProgressTracker=class{constructor(tt,et){__publicField(this,"progress"),__publicField(this,"_step"),__publicField(this,"_range"),__publicField(this,"_last"),__publicField(this,"_progressRange"),this._range=tt,this._progressRange=et,this._step=Math.max(1,this._range/(_ProgressTracker.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(tt){return tt-this._last>=this._step&&(this._last=tt,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker=_ProgressTracker;__publicField(ProgressTracker,"steps",100);var networkBiasShift=3,Neuron=class{constructor(tt){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=tt}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift,this.g>>networkBiasShift,this.b>>networkBiasShift,this.a>>networkBiasShift)}subtract(tt,et,rt,nt){this.r-=0|tt,this.g-=0|et,this.b-=0|rt,this.a-=0|nt}},_NeuQuant=class extends AbstractPaletteQuantizer{constructor(tt,et=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=tt,this._pointArray=[],this._sampleFactor=1,this._networkSize=et,this._distance.setWhitePoint(255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift)}sample(tt){this._pointArray=this._pointArray.concat(tt.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let tt=0;tt<this._networkSize;tt++)this._network[tt]=new Neuron((tt<<networkBiasShift+8)/this._networkSize|0),this._freq[tt]=_NeuQuant._initialBias/this._networkSize|0,this._bias[tt]=0}*_learn(){let tt=this._sampleFactor;const et=this._pointArray.length;et<_NeuQuant._minpicturebytes&&(tt=1);const rt=30+(tt-1)/3|0,nt=et/tt|0;let it,at=nt/_NeuQuant._nCycles|0,st=_NeuQuant._initAlpha,ot=(this._networkSize>>3)*_NeuQuant._radiusBias,lt=ot>>_NeuQuant._radiusBiasShift;lt<=1&&(lt=0);for(let dt=0;dt<lt;dt++)this._radPower[dt]=st*((lt*lt-dt*dt)*_NeuQuant._radBias/(lt*lt))>>>0;it=et<_NeuQuant._minpicturebytes?1:et%_NeuQuant._prime1!=0?_NeuQuant._prime1:et%_NeuQuant._prime2!=0?_NeuQuant._prime2:et%_NeuQuant._prime3!=0?_NeuQuant._prime3:_NeuQuant._prime4;const ht=new ProgressTracker(nt,99);for(let dt=0,ut=0;dt<nt;){ht.shouldNotify(dt)&&(yield{progress:ht.progress});const ft=this._pointArray[ut],mt=ft.b<<networkBiasShift,gt=ft.g<<networkBiasShift,vt=ft.r<<networkBiasShift,xt=ft.a<<networkBiasShift,wt=this._contest(mt,gt,vt,xt);if(this._alterSingle(st,wt,mt,gt,vt,xt),lt!==0&&this._alterNeighbour(lt,wt,mt,gt,vt,xt),ut+=it,ut>=et&&(ut-=et),dt++,at===0&&(at=1),dt%at==0){st-=st/rt|0,ot-=ot/_NeuQuant._radiusDecrease|0,lt=ot>>_NeuQuant._radiusBiasShift,lt<=1&&(lt=0);for(let At=0;At<lt;At++)this._radPower[At]=st*((lt*lt-At*At)*_NeuQuant._radBias/(lt*lt))>>>0}}}_buildPalette(){const tt=new Palette;return this._network.forEach((et=>{tt.add(et.toPoint())})),tt.sort(),tt}_alterNeighbour(tt,et,rt,nt,it,at){let st=et-tt;st<-1&&(st=-1);let ot=et+tt;ot>this._networkSize&&(ot=this._networkSize);let lt=et+1,ht=et-1,dt=1;for(;lt<ot||ht>st;){const ut=this._radPower[dt++]/_NeuQuant._alphaRadBias;if(lt<ot){const ft=this._network[lt++];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}if(ht>st){const ft=this._network[ht--];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}}}_alterSingle(tt,et,rt,nt,it,at){tt/=_NeuQuant._initAlpha;const st=this._network[et];st.subtract(tt*(st.r-it),tt*(st.g-nt),tt*(st.b-rt),tt*(st.a-at))}_contest(tt,et,rt,nt){const it=1020<<networkBiasShift;let at=2147483647,st=at,ot=-1,lt=ot;for(let ht=0;ht<this._networkSize;ht++){const dt=this._network[ht],ut=this._distance.calculateNormalized(dt,{r:rt,g:et,b:tt,a:nt})*it|0;ut<at&&(at=ut,ot=ht);const ft=ut-(this._bias[ht]>>_NeuQuant._initialBiasShift-networkBiasShift);ft<st&&(st=ft,lt=ht);const mt=this._freq[ht]>>_NeuQuant._betaShift;this._freq[ht]-=mt,this._bias[ht]+=mt<<_NeuQuant._gammaShift}return this._freq[ot]+=_NeuQuant._beta,this._bias[ot]-=_NeuQuant._betaGamma,lt}},NeuQuant=_NeuQuant;__publicField(NeuQuant,"_prime1",499),__publicField(NeuQuant,"_prime2",491),__publicField(NeuQuant,"_prime3",487),__publicField(NeuQuant,"_prime4",503),__publicField(NeuQuant,"_minpicturebytes",_NeuQuant._prime4),__publicField(NeuQuant,"_nCycles",100),__publicField(NeuQuant,"_initialBiasShift",16),__publicField(NeuQuant,"_initialBias",1<<_NeuQuant._initialBiasShift),__publicField(NeuQuant,"_gammaShift",10),__publicField(NeuQuant,"_betaShift",10),__publicField(NeuQuant,"_beta",_NeuQuant._initialBias>>_NeuQuant._betaShift),__publicField(NeuQuant,"_betaGamma",_NeuQuant._initialBias<<_NeuQuant._gammaShift-_NeuQuant._betaShift),__publicField(NeuQuant,"_radiusBiasShift",6),__publicField(NeuQuant,"_radiusBias",1<<_NeuQuant._radiusBiasShift),__publicField(NeuQuant,"_radiusDecrease",30),__publicField(NeuQuant,"_alphaBiasShift",10),__publicField(NeuQuant,"_initAlpha",1<<_NeuQuant._alphaBiasShift),__publicField(NeuQuant,"_radBiasShift",8),__publicField(NeuQuant,"_radBias",1<<_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBiasShift",_NeuQuant._alphaBiasShift+_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBias",1<<_NeuQuant._alphaRadBiasShift);var networkBiasShift2=3,NeuronFloat=class{constructor(tt){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=tt}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift2,this.g>>networkBiasShift2,this.b>>networkBiasShift2,this.a>>networkBiasShift2)}subtract(tt,et,rt,nt){this.r-=tt,this.g-=et,this.b-=rt,this.a-=nt}},_NeuQuantFloat=class extends AbstractPaletteQuantizer{constructor(tt,et=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=tt,this._pointArray=[],this._sampleFactor=1,this._networkSize=et,this._distance.setWhitePoint(255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2)}sample(tt){this._pointArray=this._pointArray.concat(tt.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let tt=0;tt<this._networkSize;tt++)this._network[tt]=new NeuronFloat((tt<<networkBiasShift2+8)/this._networkSize),this._freq[tt]=_NeuQuantFloat._initialBias/this._networkSize,this._bias[tt]=0}*_learn(){let tt=this._sampleFactor;const et=this._pointArray.length;et<_NeuQuantFloat._minpicturebytes&&(tt=1);const rt=30+(tt-1)/3,nt=et/tt;let it,at=nt/_NeuQuantFloat._nCycles|0,st=_NeuQuantFloat._initAlpha,ot=(this._networkSize>>3)*_NeuQuantFloat._radiusBias,lt=ot>>_NeuQuantFloat._radiusBiasShift;lt<=1&&(lt=0);for(let dt=0;dt<lt;dt++)this._radPower[dt]=st*((lt*lt-dt*dt)*_NeuQuantFloat._radBias/(lt*lt));it=et<_NeuQuantFloat._minpicturebytes?1:et%_NeuQuantFloat._prime1!=0?_NeuQuantFloat._prime1:et%_NeuQuantFloat._prime2!=0?_NeuQuantFloat._prime2:et%_NeuQuantFloat._prime3!=0?_NeuQuantFloat._prime3:_NeuQuantFloat._prime4;const ht=new ProgressTracker(nt,99);for(let dt=0,ut=0;dt<nt;){ht.shouldNotify(dt)&&(yield{progress:ht.progress});const ft=this._pointArray[ut],mt=ft.b<<networkBiasShift2,gt=ft.g<<networkBiasShift2,vt=ft.r<<networkBiasShift2,xt=ft.a<<networkBiasShift2,wt=this._contest(mt,gt,vt,xt);if(this._alterSingle(st,wt,mt,gt,vt,xt),lt!==0&&this._alterNeighbour(lt,wt,mt,gt,vt,xt),ut+=it,ut>=et&&(ut-=et),dt++,at===0&&(at=1),dt%at==0){st-=st/rt,ot-=ot/_NeuQuantFloat._radiusDecrease,lt=ot>>_NeuQuantFloat._radiusBiasShift,lt<=1&&(lt=0);for(let At=0;At<lt;At++)this._radPower[At]=st*((lt*lt-At*At)*_NeuQuantFloat._radBias/(lt*lt))}}}_buildPalette(){const tt=new Palette;return this._network.forEach((et=>{tt.add(et.toPoint())})),tt.sort(),tt}_alterNeighbour(tt,et,rt,nt,it,at){let st=et-tt;st<-1&&(st=-1);let ot=et+tt;ot>this._networkSize&&(ot=this._networkSize);let lt=et+1,ht=et-1,dt=1;for(;lt<ot||ht>st;){const ut=this._radPower[dt++]/_NeuQuantFloat._alphaRadBias;if(lt<ot){const ft=this._network[lt++];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}if(ht>st){const ft=this._network[ht--];ft.subtract(ut*(ft.r-it),ut*(ft.g-nt),ut*(ft.b-rt),ut*(ft.a-at))}}}_alterSingle(tt,et,rt,nt,it,at){tt/=_NeuQuantFloat._initAlpha;const st=this._network[et];st.subtract(tt*(st.r-it),tt*(st.g-nt),tt*(st.b-rt),tt*(st.a-at))}_contest(tt,et,rt,nt){const it=1020<<networkBiasShift2;let at=2147483647,st=at,ot=-1,lt=ot;for(let ht=0;ht<this._networkSize;ht++){const dt=this._network[ht],ut=this._distance.calculateNormalized(dt,{r:rt,g:et,b:tt,a:nt})*it;ut<at&&(at=ut,ot=ht);const ft=ut-(this._bias[ht]>>_NeuQuantFloat._initialBiasShift-networkBiasShift2);ft<st&&(st=ft,lt=ht);const mt=this._freq[ht]>>_NeuQuantFloat._betaShift;this._freq[ht]-=mt,this._bias[ht]+=mt<<_NeuQuantFloat._gammaShift}return this._freq[ot]+=_NeuQuantFloat._beta,this._bias[ot]-=_NeuQuantFloat._betaGamma,lt}},NeuQuantFloat=_NeuQuantFloat;__publicField(NeuQuantFloat,"_prime1",499),__publicField(NeuQuantFloat,"_prime2",491),__publicField(NeuQuantFloat,"_prime3",487),__publicField(NeuQuantFloat,"_prime4",503),__publicField(NeuQuantFloat,"_minpicturebytes",_NeuQuantFloat._prime4),__publicField(NeuQuantFloat,"_nCycles",100),__publicField(NeuQuantFloat,"_initialBiasShift",16),__publicField(NeuQuantFloat,"_initialBias",1<<_NeuQuantFloat._initialBiasShift),__publicField(NeuQuantFloat,"_gammaShift",10),__publicField(NeuQuantFloat,"_betaShift",10),__publicField(NeuQuantFloat,"_beta",_NeuQuantFloat._initialBias>>_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_betaGamma",_NeuQuantFloat._initialBias<<_NeuQuantFloat._gammaShift-_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_radiusBiasShift",6),__publicField(NeuQuantFloat,"_radiusBias",1<<_NeuQuantFloat._radiusBiasShift),__publicField(NeuQuantFloat,"_radiusDecrease",30),__publicField(NeuQuantFloat,"_alphaBiasShift",10),__publicField(NeuQuantFloat,"_initAlpha",1<<_NeuQuantFloat._alphaBiasShift),__publicField(NeuQuantFloat,"_radBiasShift",8),__publicField(NeuQuantFloat,"_radBias",1<<_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBiasShift",_NeuQuantFloat._alphaBiasShift+_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBias",1<<_NeuQuantFloat._alphaRadBiasShift);var _ColorHistogram=class{constructor(tt,et){__publicField(this,"_method"),__publicField(this,"_hueStats"),__publicField(this,"_histogram"),__publicField(this,"_initColors"),__publicField(this,"_minHueCols"),this._method=tt,this._minHueCols=et<<2,this._initColors=et<<2,this._hueStats=new HueStatistics(_ColorHistogram._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(tt){switch(this._method){case 1:this._colorStats1D(tt);break;case 2:this._colorStats2D(tt)}}getImportanceSortedColorsIDXI32(){const tt=stableSort(Object.keys(this._histogram),((rt,nt)=>this._histogram[nt]-this._histogram[rt]));if(tt.length===0)return[];let et;switch(this._method){case 1:const rt=Math.min(tt.length,this._initColors),nt=tt[rt-1],it=this._histogram[nt];et=tt.slice(0,rt);let at=rt;const st=tt.length;for(;at<st&&this._histogram[tt[at]]===it;)et.push(tt[at++]);this._hueStats.injectIntoArray(et);break;case 2:et=tt;break;default:throw new Error("Incorrect method")}return et.map((rt=>+rt))}_colorStats1D(tt){const et=this._histogram,rt=tt.getPointArray(),nt=rt.length;for(let it=0;it<nt;it++){const at=rt[it].uint32;this._hueStats.check(at),at in et?et[at]++:et[at]=1}}_colorStats2D(tt){const et=tt.getWidth(),rt=tt.getHeight(),nt=tt.getPointArray(),it=_ColorHistogram._boxSize[0],at=_ColorHistogram._boxSize[1],st=it*at,ot=this._makeBoxes(et,rt,it,at),lt=this._histogram;ot.forEach((ht=>{let dt=Math.round(ht.w*ht.h/st)*_ColorHistogram._boxPixels;dt<2&&(dt=2);const ut={};this._iterateBox(ht,et,(ft=>{const mt=nt[ft].uint32;this._hueStats.check(mt),mt in lt?lt[mt]++:mt in ut?++ut[mt]>=dt&&(lt[mt]=ut[mt]):ut[mt]=1}))})),this._hueStats.injectIntoDictionary(lt)}_iterateBox(tt,et,rt){const nt=tt,it=nt.y*et+nt.x,at=(nt.y+nt.h-1)*et+(nt.x+nt.w-1),st=et-nt.w+1;let ot=0,lt=it;do rt.call(this,lt),lt+=++ot%nt.w==0?st:1;while(lt<=at)}_makeBoxes(tt,et,rt,nt){const it=tt%rt,at=et%nt,st=tt-it,ot=et-at,lt=[];for(let ht=0;ht<et;ht+=nt)for(let dt=0;dt<tt;dt+=rt)lt.push({x:dt,y:ht,w:dt===st?it:rt,h:ht===ot?at:nt});return lt}},ColorHistogram=_ColorHistogram;__publicField(ColorHistogram,"_boxSize",[64,64]),__publicField(ColorHistogram,"_boxPixels",2),__publicField(ColorHistogram,"_hueGroups",10);var RemovedColor=class{constructor(tt,et,rt){__publicField(this,"index"),__publicField(this,"color"),__publicField(this,"distance"),this.index=tt,this.color=et,this.distance=rt}},RGBQuant=class extends AbstractPaletteQuantizer{constructor(tt,et=256,rt=2){super(),__publicField(this,"_colors"),__publicField(this,"_initialDistance"),__publicField(this,"_distanceIncrement"),__publicField(this,"_histogram"),__publicField(this,"_distance"),this._distance=tt,this._colors=et,this._histogram=new ColorHistogram(rt,et),this._initialDistance=.01,this._distanceIncrement=.005}sample(tt){this._histogram.sample(tt)}*quantize(){const tt=this._histogram.getImportanceSortedColorsIDXI32();if(tt.length===0)throw new Error("No colors in image");yield*this._buildPalette(tt)}*_buildPalette(tt){const et=new Palette,rt=et.getPointContainer().getPointArray(),nt=new Array(tt.length);for(let dt=0;dt<tt.length;dt++)rt.push(Point.createByUint32(tt[dt])),nt[dt]=1;const it=rt.length,at=[];let st=it,ot=this._initialDistance;const lt=new ProgressTracker(st-this._colors,99);for(;st>this._colors;){at.length=0;for(let dt=0;dt<it;dt++){if(lt.shouldNotify(it-st)&&(yield{progress:lt.progress}),nt[dt]===0)continue;const ut=rt[dt];for(let ft=dt+1;ft<it;ft++){if(nt[ft]===0)continue;const mt=rt[ft],gt=this._distance.calculateNormalized(ut,mt);gt<ot&&(at.push(new RemovedColor(ft,mt,gt)),nt[ft]=0,st--)}}ot+=st>3*this._colors?this._initialDistance:this._distanceIncrement}if(st<this._colors){stableSort(at,((ut,ft)=>ft.distance-ut.distance));let dt=0;for(;st<this._colors&&dt<at.length;)nt[at[dt].index]=1,st++,dt++}let ht=rt.length;for(let dt=ht-1;dt>=0;dt--)nt[dt]===0&&(dt!==ht-1&&(rt[dt]=rt[ht-1]),--ht);rt.length=ht,et.sort(),yield{palette:et,progress:100}}};function createArray1D(tt){const et=[];for(let rt=0;rt<tt;rt++)et[rt]=0;return et}function createArray4D(tt,et,rt,nt){const it=new Array(tt);for(let at=0;at<tt;at++){it[at]=new Array(et);for(let st=0;st<et;st++){it[at][st]=new Array(rt);for(let ot=0;ot<rt;ot++){it[at][st][ot]=new Array(nt);for(let lt=0;lt<nt;lt++)it[at][st][ot][lt]=0}}}return it}function createArray3D(tt,et,rt){const nt=new Array(tt);for(let it=0;it<tt;it++){nt[it]=new Array(et);for(let at=0;at<et;at++){nt[it][at]=new Array(rt);for(let st=0;st<rt;st++)nt[it][at][st]=0}}return nt}function fillArray3D(tt,et,rt,nt,it){for(let at=0;at<et;at++){tt[at]=[];for(let st=0;st<rt;st++){tt[at][st]=[];for(let ot=0;ot<nt;ot++)tt[at][st][ot]=it}}}function fillArray1D(tt,et,rt){for(let nt=0;nt<et;nt++)tt[nt]=rt}var WuColorCube=class{constructor(){__publicField(this,"redMinimum"),__publicField(this,"redMaximum"),__publicField(this,"greenMinimum"),__publicField(this,"greenMaximum"),__publicField(this,"blueMinimum"),__publicField(this,"blueMaximum"),__publicField(this,"volume"),__publicField(this,"alphaMinimum"),__publicField(this,"alphaMaximum")}},_WuQuant=class extends AbstractPaletteQuantizer{constructor(tt,et=256,rt=5){super(),__publicField(this,"_reds"),__publicField(this,"_greens"),__publicField(this,"_blues"),__publicField(this,"_alphas"),__publicField(this,"_sums"),__publicField(this,"_weights"),__publicField(this,"_momentsRed"),__publicField(this,"_momentsGreen"),__publicField(this,"_momentsBlue"),__publicField(this,"_momentsAlpha"),__publicField(this,"_moments"),__publicField(this,"_table"),__publicField(this,"_pixels"),__publicField(this,"_cubes"),__publicField(this,"_colors"),__publicField(this,"_significantBitsPerChannel"),__publicField(this,"_maxSideIndex"),__publicField(this,"_alphaMaxSideIndex"),__publicField(this,"_sideSize"),__publicField(this,"_alphaSideSize"),__publicField(this,"_distance"),this._distance=tt,this._setQuality(rt),this._initialize(et)}sample(tt){const et=tt.getPointArray();for(let rt=0,nt=et.length;rt<nt;rt++)this._addColor(et[rt]);this._pixels=this._pixels.concat(et)}*quantize(){yield*this._preparePalette();const tt=new Palette;for(let et=0;et<this._colors;et++)if(this._sums[et]>0){const rt=this._sums[et],nt=this._reds[et]/rt,it=this._greens[et]/rt,at=this._blues[et]/rt,st=this._alphas[et]/rt,ot=Point.createByRGBA(0|nt,0|it,0|at,0|st);tt.add(ot)}tt.sort(),yield{palette:tt,progress:100}}*_preparePalette(){yield*this._calculateMoments();let tt=0;const et=createArray1D(this._colors);for(let st=1;st<this._colors;++st){this._cut(this._cubes[tt],this._cubes[st])?(et[tt]=this._cubes[tt].volume>1?this._calculateVariance(this._cubes[tt]):0,et[st]=this._cubes[st].volume>1?this._calculateVariance(this._cubes[st]):0):(et[tt]=0,st--),tt=0;let ot=et[0];for(let lt=1;lt<=st;++lt)et[lt]>ot&&(ot=et[lt],tt=lt);if(ot<=0){this._colors=st+1;break}}const rt=[],nt=[],it=[],at=[];for(let st=0;st<this._colors;++st){const ot=_WuQuant._volume(this._cubes[st],this._weights);ot>0?(rt[st]=_WuQuant._volume(this._cubes[st],this._momentsRed)/ot|0,nt[st]=_WuQuant._volume(this._cubes[st],this._momentsGreen)/ot|0,it[st]=_WuQuant._volume(this._cubes[st],this._momentsBlue)/ot|0,at[st]=_WuQuant._volume(this._cubes[st],this._momentsAlpha)/ot|0):(rt[st]=0,nt[st]=0,it[st]=0,at[st]=0)}this._reds=createArray1D(this._colors+1),this._greens=createArray1D(this._colors+1),this._blues=createArray1D(this._colors+1),this._alphas=createArray1D(this._colors+1),this._sums=createArray1D(this._colors+1);for(let st=0,ot=this._pixels.length;st<ot;st++){const lt=this._pixels[st];let ht=-1,dt=Number.MAX_VALUE;for(let ut=0;ut<this._colors;ut++){const ft=rt[ut],mt=nt[ut],gt=it[ut],vt=at[ut],xt=this._distance.calculateRaw(ft,mt,gt,vt,lt.r,lt.g,lt.b,lt.a);xt<dt&&(dt=xt,ht=ut)}this._reds[ht]+=lt.r,this._greens[ht]+=lt.g,this._blues[ht]+=lt.b,this._alphas[ht]+=lt.a,this._sums[ht]++}}_addColor(tt){const et=8-this._significantBitsPerChannel,rt=1+(tt.r>>et),nt=1+(tt.g>>et),it=1+(tt.b>>et),at=1+(tt.a>>et);this._weights[at][rt][nt][it]++,this._momentsRed[at][rt][nt][it]+=tt.r,this._momentsGreen[at][rt][nt][it]+=tt.g,this._momentsBlue[at][rt][nt][it]+=tt.b,this._momentsAlpha[at][rt][nt][it]+=tt.a,this._moments[at][rt][nt][it]+=this._table[tt.r]+this._table[tt.g]+this._table[tt.b]+this._table[tt.a]}*_calculateMoments(){const tt=[],et=[],rt=[],nt=[],it=[],at=[],st=createArray3D(this._sideSize,this._sideSize,this._sideSize),ot=createArray3D(this._sideSize,this._sideSize,this._sideSize),lt=createArray3D(this._sideSize,this._sideSize,this._sideSize),ht=createArray3D(this._sideSize,this._sideSize,this._sideSize),dt=createArray3D(this._sideSize,this._sideSize,this._sideSize),ut=createArray3D(this._sideSize,this._sideSize,this._sideSize);let ft=0;const mt=new ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let gt=1;gt<=this._alphaMaxSideIndex;++gt){fillArray3D(st,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(ot,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(lt,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(ht,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(dt,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(ut,this._sideSize,this._sideSize,this._sideSize,0);for(let vt=1;vt<=this._maxSideIndex;++vt,++ft){mt.shouldNotify(ft)&&(yield{progress:mt.progress}),fillArray1D(tt,this._sideSize,0),fillArray1D(et,this._sideSize,0),fillArray1D(rt,this._sideSize,0),fillArray1D(nt,this._sideSize,0),fillArray1D(it,this._sideSize,0),fillArray1D(at,this._sideSize,0);for(let xt=1;xt<=this._maxSideIndex;++xt){let wt=0,At=0,Tt=0,Pt=0,Rt=0,Ot=0;for(let Et=1;Et<=this._maxSideIndex;++Et)wt+=this._weights[gt][vt][xt][Et],At+=this._momentsRed[gt][vt][xt][Et],Tt+=this._momentsGreen[gt][vt][xt][Et],Pt+=this._momentsBlue[gt][vt][xt][Et],Rt+=this._momentsAlpha[gt][vt][xt][Et],Ot+=this._moments[gt][vt][xt][Et],tt[Et]+=wt,et[Et]+=At,rt[Et]+=Tt,nt[Et]+=Pt,it[Et]+=Rt,at[Et]+=Ot,st[vt][xt][Et]=st[vt-1][xt][Et]+tt[Et],ot[vt][xt][Et]=ot[vt-1][xt][Et]+et[Et],lt[vt][xt][Et]=lt[vt-1][xt][Et]+rt[Et],ht[vt][xt][Et]=ht[vt-1][xt][Et]+nt[Et],dt[vt][xt][Et]=dt[vt-1][xt][Et]+it[Et],ut[vt][xt][Et]=ut[vt-1][xt][Et]+at[Et],this._weights[gt][vt][xt][Et]=this._weights[gt-1][vt][xt][Et]+st[vt][xt][Et],this._momentsRed[gt][vt][xt][Et]=this._momentsRed[gt-1][vt][xt][Et]+ot[vt][xt][Et],this._momentsGreen[gt][vt][xt][Et]=this._momentsGreen[gt-1][vt][xt][Et]+lt[vt][xt][Et],this._momentsBlue[gt][vt][xt][Et]=this._momentsBlue[gt-1][vt][xt][Et]+ht[vt][xt][Et],this._momentsAlpha[gt][vt][xt][Et]=this._momentsAlpha[gt-1][vt][xt][Et]+dt[vt][xt][Et],this._moments[gt][vt][xt][Et]=this._moments[gt-1][vt][xt][Et]+ut[vt][xt][Et]}}}}static _volumeFloat(tt,et){return et[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]-et[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]-et[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]+et[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-et[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]+et[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]+et[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]-et[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(et[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]-et[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]-et[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+et[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]-et[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+et[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+et[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]-et[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum])}static _volume(tt,et){return 0|_WuQuant._volumeFloat(tt,et)}static _top(tt,et,rt,nt){let it;switch(et){case _WuQuant._alpha:it=nt[rt][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]-nt[rt][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]-nt[rt][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]+nt[rt][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(nt[rt][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]-nt[rt][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]-nt[rt][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+nt[rt][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);break;case _WuQuant._red:it=nt[tt.alphaMaximum][rt][tt.greenMaximum][tt.blueMaximum]-nt[tt.alphaMaximum][rt][tt.greenMinimum][tt.blueMaximum]-nt[tt.alphaMinimum][rt][tt.greenMaximum][tt.blueMaximum]+nt[tt.alphaMinimum][rt][tt.greenMinimum][tt.blueMaximum]-(nt[tt.alphaMaximum][rt][tt.greenMaximum][tt.blueMinimum]-nt[tt.alphaMaximum][rt][tt.greenMinimum][tt.blueMinimum]-nt[tt.alphaMinimum][rt][tt.greenMaximum][tt.blueMinimum]+nt[tt.alphaMinimum][rt][tt.greenMinimum][tt.blueMinimum]);break;case _WuQuant._green:it=nt[tt.alphaMaximum][tt.redMaximum][rt][tt.blueMaximum]-nt[tt.alphaMaximum][tt.redMinimum][rt][tt.blueMaximum]-nt[tt.alphaMinimum][tt.redMaximum][rt][tt.blueMaximum]+nt[tt.alphaMinimum][tt.redMinimum][rt][tt.blueMaximum]-(nt[tt.alphaMaximum][tt.redMaximum][rt][tt.blueMinimum]-nt[tt.alphaMaximum][tt.redMinimum][rt][tt.blueMinimum]-nt[tt.alphaMinimum][tt.redMaximum][rt][tt.blueMinimum]+nt[tt.alphaMinimum][tt.redMinimum][rt][tt.blueMinimum]);break;case _WuQuant._blue:it=nt[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][rt]-nt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][rt]-nt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][rt]+nt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][rt]-(nt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][rt]-nt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][rt]-nt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][rt]+nt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][rt]);break;default:throw new Error("impossible")}return 0|it}static _bottom(tt,et,rt){switch(et){case _WuQuant._alpha:return-rt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(-rt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);case _WuQuant._red:return-rt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMaximum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(-rt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);case _WuQuant._green:return-rt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMaximum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMaximum]-(-rt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);case _WuQuant._blue:return-rt[tt.alphaMaximum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMaximum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMaximum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]-(-rt[tt.alphaMinimum][tt.redMaximum][tt.greenMaximum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMaximum][tt.greenMinimum][tt.blueMinimum]+rt[tt.alphaMinimum][tt.redMinimum][tt.greenMaximum][tt.blueMinimum]-rt[tt.alphaMinimum][tt.redMinimum][tt.greenMinimum][tt.blueMinimum]);default:return 0}}_calculateVariance(tt){const et=_WuQuant._volume(tt,this._momentsRed),rt=_WuQuant._volume(tt,this._momentsGreen),nt=_WuQuant._volume(tt,this._momentsBlue),it=_WuQuant._volume(tt,this._momentsAlpha);return _WuQuant._volumeFloat(tt,this._moments)-(et*et+rt*rt+nt*nt+it*it)/_WuQuant._volume(tt,this._weights)}_maximize(tt,et,rt,nt,it,at,st,ot,lt){const ht=0|_WuQuant._bottom(tt,et,this._momentsRed),dt=0|_WuQuant._bottom(tt,et,this._momentsGreen),ut=0|_WuQuant._bottom(tt,et,this._momentsBlue),ft=0|_WuQuant._bottom(tt,et,this._momentsAlpha),mt=0|_WuQuant._bottom(tt,et,this._weights);let gt=0,vt=-1;for(let xt=rt;xt<nt;++xt){let wt=ht+_WuQuant._top(tt,et,xt,this._momentsRed),At=dt+_WuQuant._top(tt,et,xt,this._momentsGreen),Tt=ut+_WuQuant._top(tt,et,xt,this._momentsBlue),Pt=ft+_WuQuant._top(tt,et,xt,this._momentsAlpha),Rt=mt+_WuQuant._top(tt,et,xt,this._weights);if(Rt!==0){let Ot=wt*wt+At*At+Tt*Tt+Pt*Pt,Et=Ot/Rt;wt=it-wt,At=at-At,Tt=st-Tt,Pt=ot-Pt,Rt=lt-Rt,Rt!==0&&(Ot=wt*wt+At*At+Tt*Tt+Pt*Pt,Et+=Ot/Rt,Et>gt&&(gt=Et,vt=xt))}}return{max:gt,position:vt}}_cut(tt,et){let rt;const nt=_WuQuant._volume(tt,this._momentsRed),it=_WuQuant._volume(tt,this._momentsGreen),at=_WuQuant._volume(tt,this._momentsBlue),st=_WuQuant._volume(tt,this._momentsAlpha),ot=_WuQuant._volume(tt,this._weights),lt=this._maximize(tt,_WuQuant._red,tt.redMinimum+1,tt.redMaximum,nt,it,at,st,ot),ht=this._maximize(tt,_WuQuant._green,tt.greenMinimum+1,tt.greenMaximum,nt,it,at,st,ot),dt=this._maximize(tt,_WuQuant._blue,tt.blueMinimum+1,tt.blueMaximum,nt,it,at,st,ot),ut=this._maximize(tt,_WuQuant._alpha,tt.alphaMinimum+1,tt.alphaMaximum,nt,it,at,st,ot);if(ut.max>=lt.max&&ut.max>=ht.max&&ut.max>=dt.max){if(rt=_WuQuant._alpha,ut.position<0)return!1}else rt=lt.max>=ut.max&&lt.max>=ht.max&&lt.max>=dt.max?_WuQuant._red:ht.max>=ut.max&&ht.max>=lt.max&&ht.max>=dt.max?_WuQuant._green:_WuQuant._blue;switch(et.redMaximum=tt.redMaximum,et.greenMaximum=tt.greenMaximum,et.blueMaximum=tt.blueMaximum,et.alphaMaximum=tt.alphaMaximum,rt){case _WuQuant._red:et.redMinimum=tt.redMaximum=lt.position,et.greenMinimum=tt.greenMinimum,et.blueMinimum=tt.blueMinimum,et.alphaMinimum=tt.alphaMinimum;break;case _WuQuant._green:et.greenMinimum=tt.greenMaximum=ht.position,et.redMinimum=tt.redMinimum,et.blueMinimum=tt.blueMinimum,et.alphaMinimum=tt.alphaMinimum;break;case _WuQuant._blue:et.blueMinimum=tt.blueMaximum=dt.position,et.redMinimum=tt.redMinimum,et.greenMinimum=tt.greenMinimum,et.alphaMinimum=tt.alphaMinimum;break;case _WuQuant._alpha:et.alphaMinimum=tt.alphaMaximum=ut.position,et.blueMinimum=tt.blueMinimum,et.redMinimum=tt.redMinimum,et.greenMinimum=tt.greenMinimum}return tt.volume=(tt.redMaximum-tt.redMinimum)*(tt.greenMaximum-tt.greenMinimum)*(tt.blueMaximum-tt.blueMinimum)*(tt.alphaMaximum-tt.alphaMinimum),et.volume=(et.redMaximum-et.redMinimum)*(et.greenMaximum-et.greenMinimum)*(et.blueMaximum-et.blueMinimum)*(et.alphaMaximum-et.alphaMinimum),!0}_initialize(tt){this._colors=tt,this._cubes=[];for(let et=0;et<tt;et++)this._cubes[et]=new WuColorCube;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let et=0;et<256;++et)this._table[et]=et*et;this._pixels=[]}_setQuality(tt=5){this._significantBitsPerChannel=tt,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant=_WuQuant;__publicField(WuQuant,"_alpha",3),__publicField(WuQuant,"_red",2),__publicField(WuQuant,"_green",1),__publicField(WuQuant,"_blue",0);var image_exports={};__export(image_exports,{AbstractImageQuantizer:()=>AbstractImageQuantizer,ErrorDiffusionArray:()=>ErrorDiffusionArray,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma,NearestColor:()=>NearestColor});var AbstractImageQuantizer=class{quantizeSync(tt,et){for(const rt of this.quantize(tt,et))if(rt.pointContainer)return rt.pointContainer;throw new Error("unreachable")}},NearestColor=class extends AbstractImageQuantizer{constructor(tt){super(),__publicField(this,"_distance"),this._distance=tt}*quantize(tt,et){const rt=tt.getPointArray(),nt=tt.getWidth(),it=tt.getHeight(),at=new ProgressTracker(it,99);for(let st=0;st<it;st++){at.shouldNotify(st)&&(yield{progress:at.progress});for(let ot=0,lt=st*nt;ot<nt;ot++,lt++){const ht=rt[lt];ht.from(et.getNearestColor(this._distance,ht))}}yield{pointContainer:tt,progress:100}}},ErrorDiffusionArrayKernel=(tt=>(tt[tt.FloydSteinberg=0]="FloydSteinberg",tt[tt.FalseFloydSteinberg=1]="FalseFloydSteinberg",tt[tt.Stucki=2]="Stucki",tt[tt.Atkinson=3]="Atkinson",tt[tt.Jarvis=4]="Jarvis",tt[tt.Burkes=5]="Burkes",tt[tt.Sierra=6]="Sierra",tt[tt.TwoSierra=7]="TwoSierra",tt[tt.SierraLite=8]="SierraLite",tt))(ErrorDiffusionArrayKernel||{}),ErrorDiffusionArray=class extends AbstractImageQuantizer{constructor(tt,et,rt=!0,nt=0,it=!1){super(),__publicField(this,"_minColorDistance"),__publicField(this,"_serpentine"),__publicField(this,"_kernel"),__publicField(this,"_calculateErrorLikeGIMP"),__publicField(this,"_distance"),this._setKernel(et),this._distance=tt,this._minColorDistance=nt,this._serpentine=rt,this._calculateErrorLikeGIMP=it}*quantize(tt,et){const rt=tt.getPointArray(),nt=new Point,it=tt.getWidth(),at=tt.getHeight(),st=[];let ot=1,lt=1;for(const dt of this._kernel){const ut=dt[2]+1;lt<ut&&(lt=ut)}for(let dt=0;dt<lt;dt++)this._fillErrorLine(st[dt]=[],it);const ht=new ProgressTracker(at,99);for(let dt=0;dt<at;dt++){ht.shouldNotify(dt)&&(yield{progress:ht.progress}),this._serpentine&&(ot*=-1);const ut=dt*it,ft=ot===1?0:it-1,mt=ot===1?it:-1;this._fillErrorLine(st[0],it),st.push(st.shift());const gt=st[0];for(let vt=ft,xt=ut+ft;vt!==mt;vt+=ot,xt+=ot){const wt=rt[xt],At=gt[vt];nt.from(wt);const Tt=Point.createByRGBA(inRange0to255Rounded(wt.r+At[0]),inRange0to255Rounded(wt.g+At[1]),inRange0to255Rounded(wt.b+At[2]),inRange0to255Rounded(wt.a+At[3])),Pt=et.getNearestColor(this._distance,Tt);if(wt.from(Pt),this._minColorDistance&&this._distance.calculateNormalized(nt,Pt)<this._minColorDistance)continue;let Rt,Ot,Et,Lt;this._calculateErrorLikeGIMP?(Rt=Tt.r-Pt.r,Ot=Tt.g-Pt.g,Et=Tt.b-Pt.b,Lt=Tt.a-Pt.a):(Rt=nt.r-Pt.r,Ot=nt.g-Pt.g,Et=nt.b-Pt.b,Lt=nt.a-Pt.a);const kt=ot===1?0:this._kernel.length-1,jt=ot===1?this._kernel.length:-1;for(let Mt=kt;Mt!==jt;Mt+=ot){const $t=this._kernel[Mt][1]*ot,Qt=this._kernel[Mt][2];if($t+vt>=0&&$t+vt<it&&Qt+dt>=0&&Qt+dt<at){const Ht=this._kernel[Mt][0],qt=st[Qt][$t+vt];qt[0]+=Rt*Ht,qt[1]+=Ot*Ht,qt[2]+=Et*Ht,qt[3]+=Lt*Ht}}}}yield{pointContainer:tt,progress:100}}_fillErrorLine(tt,et){tt.length>et&&(tt.length=et);const rt=tt.length;for(let nt=0;nt<rt;nt++){const it=tt[nt];it[0]=it[1]=it[2]=it[3]=0}for(let nt=rt;nt<et;nt++)tt[nt]=[0,0,0,0]}_setKernel(tt){switch(tt){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${tt}`)}}};function*hilbertCurve(tt,et,rt){const nt=Math.max(tt,et),it={width:tt,height:et,level:Math.floor(Math.log(nt)/Math.log(2)+1),callback:rt,tracker:new ProgressTracker(tt*et,99),index:0,x:0,y:0};yield*walkHilbert(it,1),visit(it,0)}function*walkHilbert(tt,et){if(!(tt.level<1)){switch(tt.tracker.shouldNotify(tt.index)&&(yield{progress:tt.tracker.progress}),tt.level--,et){case 2:yield*walkHilbert(tt,1),visit(tt,3),yield*walkHilbert(tt,2),visit(tt,4),yield*walkHilbert(tt,2),visit(tt,2),yield*walkHilbert(tt,4);break;case 3:yield*walkHilbert(tt,4),visit(tt,2),yield*walkHilbert(tt,3),visit(tt,1),yield*walkHilbert(tt,3),visit(tt,3),yield*walkHilbert(tt,1);break;case 1:yield*walkHilbert(tt,2),visit(tt,4),yield*walkHilbert(tt,1),visit(tt,3),yield*walkHilbert(tt,1),visit(tt,1),yield*walkHilbert(tt,3);break;case 4:yield*walkHilbert(tt,3),visit(tt,1),yield*walkHilbert(tt,4),visit(tt,2),yield*walkHilbert(tt,4),visit(tt,4),yield*walkHilbert(tt,2)}tt.level++}}function visit(tt,et){switch(tt.x>=0&&tt.x<tt.width&&tt.y>=0&&tt.y<tt.height&&(tt.callback(tt.x,tt.y),tt.index++),et){case 2:tt.x--;break;case 3:tt.x++;break;case 1:tt.y--;break;case 4:tt.y++}}var ErrorDiffusionRiemersma=class extends AbstractImageQuantizer{constructor(tt,et=16,rt=1){super(),__publicField(this,"_distance"),__publicField(this,"_weights"),__publicField(this,"_errorQueueSize"),this._distance=tt,this._errorQueueSize=et,this._weights=ErrorDiffusionRiemersma._createWeights(rt,et)}*quantize(tt,et){const rt=tt.getPointArray(),nt=tt.getWidth(),it=tt.getHeight(),at=[];let st=0;for(let ot=0;ot<this._errorQueueSize;ot++)at[ot]={r:0,g:0,b:0,a:0};yield*hilbertCurve(nt,it,((ot,lt)=>{const ht=rt[ot+lt*nt];let{r:dt,g:ut,b:ft,a:mt}=ht;for(let wt=0;wt<this._errorQueueSize;wt++){const At=this._weights[wt],Tt=at[(wt+st)%this._errorQueueSize];dt+=Tt.r*At,ut+=Tt.g*At,ft+=Tt.b*At,mt+=Tt.a*At}const gt=Point.createByRGBA(inRange0to255Rounded(dt),inRange0to255Rounded(ut),inRange0to255Rounded(ft),inRange0to255Rounded(mt)),vt=et.getNearestColor(this._distance,gt);st=(st+1)%this._errorQueueSize;const xt=(st+this._errorQueueSize-1)%this._errorQueueSize;at[xt].r=ht.r-vt.r,at[xt].g=ht.g-vt.g,at[xt].b=ht.b-vt.b,at[xt].a=ht.a-vt.a,ht.from(vt)})),yield{pointContainer:tt,progress:100}}static _createWeights(tt,et){const rt=[],nt=Math.exp(Math.log(et)/(et-1));for(let it=0,at=1;it<et;it++)rt[it]=(at+.5|0)/et*tt,at*=nt;return rt}},quality_exports={};__export(quality_exports,{ssim:()=>ssim});var K1=.01,K2=.03;function ssim(tt,et){if(tt.getHeight()!==et.getHeight()||tt.getWidth()!==et.getWidth())throw new Error("Images have different sizes!");const rt=(255*K1)**2,nt=(255*K2)**2;let it=0,at=0;return iterate(tt,et,((st,ot,lt,ht)=>{let dt=0,ut=0,ft=0;for(let gt=0;gt<st.length;gt++)ut+=(st[gt]-lt)**2,ft+=(ot[gt]-ht)**2,dt+=(st[gt]-lt)*(ot[gt]-ht);const mt=st.length-1;ut/=mt,ft/=mt,dt/=mt,at+=(2*lt*ht+rt)*(2*dt+nt)/((lt**2+ht**2+rt)*(ut+ft+nt)),it++})),at/it}function iterate(tt,et,rt){const nt=tt.getWidth(),it=tt.getHeight();for(let at=0;at<it;at+=8)for(let st=0;st<nt;st+=8){const ot=Math.min(8,nt-st),lt=Math.min(8,it-at),ht=calculateLumaValuesForWindow(tt,st,at,ot,lt),dt=calculateLumaValuesForWindow(et,st,at,ot,lt);rt(ht,dt,calculateAverageLuma(ht),calculateAverageLuma(dt))}}function calculateLumaValuesForWindow(tt,et,rt,nt,it){const at=tt.getPointArray(),st=[];let ot=0;for(let lt=rt;lt<rt+it;lt++){const ht=lt*tt.getWidth();for(let dt=et;dt<et+nt;dt++){const ut=at[ht+dt];st[ot]=.2126*ut.r+.7152*ut.g+.0722*ut.b,ot++}}return st}function calculateAverageLuma(tt){let et=0;for(const rt of tt)et+=rt;return et/tt.length}function buildPaletteSync(tt,{colorDistanceFormula:et,paletteQuantization:rt,colors:nt}={}){const it=paletteQuantizationToPaletteQuantizer(colorDistanceFormulaToColorDistance(et),rt,nt);return tt.forEach((at=>it.sample(at))),it.quantizeSync()}function applyPaletteSync(tt,et,{colorDistanceFormula:rt,imageQuantization:nt}={}){return imageQuantizationToImageQuantizer(colorDistanceFormulaToColorDistance(rt),nt).quantizeSync(tt,et)}function colorDistanceFormulaToColorDistance(tt="euclidean-bt709"){switch(tt){case"cie94-graphic-arts":return new CIE94GraphicArts;case"cie94-textiles":return new CIE94Textiles;case"ciede2000":return new CIEDE2000;case"color-metric":return new CMetric;case"euclidean":return new Euclidean;case"euclidean-bt709":return new EuclideanBT709;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha;case"manhattan":return new Manhattan;case"manhattan-bt709":return new ManhattanBT709;case"manhattan-nommyde":return new ManhattanNommyde;case"pngquant":return new PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${tt}`)}}function imageQuantizationToImageQuantizer(tt,et="floyd-steinberg"){switch(et){case"nearest":return new NearestColor(tt);case"riemersma":return new ErrorDiffusionRiemersma(tt);case"floyd-steinberg":return new ErrorDiffusionArray(tt,0);case"false-floyd-steinberg":return new ErrorDiffusionArray(tt,1);case"stucki":return new ErrorDiffusionArray(tt,2);case"atkinson":return new ErrorDiffusionArray(tt,3);case"jarvis":return new ErrorDiffusionArray(tt,4);case"burkes":return new ErrorDiffusionArray(tt,5);case"sierra":return new ErrorDiffusionArray(tt,6);case"two-sierra":return new ErrorDiffusionArray(tt,7);case"sierra-lite":return new ErrorDiffusionArray(tt,8);default:throw new Error(`Unknown imageQuantization ${et}`)}}function paletteQuantizationToPaletteQuantizer(tt,et="wuquant",rt=256){switch(et){case"neuquant":return new NeuQuant(tt,rt);case"rgbquant":return new RGBQuant(tt,rt);case"wuquant":return new WuQuant(tt,rt);case"neuquant-float":return new NeuQuantFloat(tt,rt);default:throw new Error(`Unknown paletteQuantization ${et}`)}}typeof setImmediate=="function"?setImmediate:typeof process<"u"&&process?.nextTick;const QuantizeOptionsSchema=z.object({colors:z.number().optional(),colorDistanceFormula:z.union([z.literal("cie94-textiles"),z.literal("cie94-graphic-arts"),z.literal("ciede2000"),z.literal("color-metric"),z.literal("euclidean"),z.literal("euclidean-bt709-noalpha"),z.literal("euclidean-bt709"),z.literal("manhattan"),z.literal("manhattan-bt709"),z.literal("manhattan-nommyde"),z.literal("pngquant")]).optional(),paletteQuantization:z.union([z.literal("neuquant"),z.literal("neuquant-float"),z.literal("rgbquant"),z.literal("wuquant")]).optional(),imageQuantization:z.union([z.literal("nearest"),z.literal("riemersma"),z.literal("floyd-steinberg"),z.literal("false-floyd-steinberg"),z.literal("stucki"),z.literal("atkinson"),z.literal("jarvis"),z.literal("burkes"),z.literal("sierra"),z.literal("two-sierra"),z.literal("sierra-lite")]).optional()}),methods={quantize(tt,et){const{colors:rt,colorDistanceFormula:nt,paletteQuantization:it,imageQuantization:at}=QuantizeOptionsSchema.parse(et),st=utils_exports.PointContainer.fromUint8Array(tt.bitmap.data,tt.bitmap.width,tt.bitmap.height),ot=applyPaletteSync(st,buildPaletteSync([st],{colors:rt,colorDistanceFormula:nt,paletteQuantization:it}),{colorDistanceFormula:nt,imageQuantization:at});return tt.bitmap.data=Buffer$1.from(ot.toUint8Array()),tt}};var parseBmfontAscii=function(tt){if(!tt)throw new Error("no data provided");var et={pages:[],chars:[],kernings:[]},rt=(tt=tt.toString().trim()).split(/\r\n?|\n/g);if(rt.length===0)throw new Error("no data in BMFont file");for(var nt=0;nt<rt.length;nt++){var it=splitLine(rt[nt],nt);if(it)if(it.key==="page"){if(typeof it.data.id!="number")throw new Error("malformed file at line "+nt+" -- needs page id=N");if(typeof it.data.file!="string")throw new Error("malformed file at line "+nt+' -- needs page file="path"');et.pages[it.data.id]=it.data.file}else it.key==="chars"||it.key==="kernings"||(it.key==="char"?et.chars.push(it.data):it.key==="kerning"?et.kernings.push(it.data):et[it.key]=it.data)}return et};function splitLine(tt,et){if(!(tt=tt.replace(/\t+/g," ").trim()))return null;var rt=tt.indexOf(" ");if(rt===-1)throw new Error("no named row at line "+et);var nt=tt.substring(0,rt);tt=(tt=(tt=(tt=tt.substring(rt+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map((function(lt){return lt.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}));for(var it=[],at=0;at<tt.length;at++){var st=tt[at];at===0?it.push({key:st[0],data:""}):at===tt.length-1?it[it.length-1].data=parseData(st[0]):(it[it.length-1].data=parseData(st[0]),it.push({key:st[1],data:""}))}var ot={key:nt,data:{}};return it.forEach((function(lt){ot.data[lt.key]=lt.data})),ot}function parseData(tt){return tt&&tt.length!==0?tt.indexOf('"')===0||tt.indexOf("'")===0?tt.substring(1,tt.length-1):tt.indexOf(",")!==-1?parseIntList$1(tt):parseInt(tt,10):""}function parseIntList$1(tt){return tt.split(",").map((function(et){return parseInt(et,10)}))}getDefaultExportFromCjs(parseBmfontAscii);var GLYPH_DESIGNER_ERROR="chasrset",parseAttribs=function(tt){for(var et in tt=Object.assign({},tt),GLYPH_DESIGNER_ERROR in tt&&(tt.charset=tt[GLYPH_DESIGNER_ERROR],delete tt[GLYPH_DESIGNER_ERROR]),tt)et!=="face"&&et!=="charset"&&(tt[et]=et==="padding"||et==="spacing"?parseIntList(tt[et]):parseInt(tt[et],10));return tt};function parseIntList(tt){return tt.split(",").map((function(et){return parseInt(et,10)}))}var xmlParseFromString=self.DOMParser!==void 0?function(tt){return new self.DOMParser().parseFromString(tt,"application/xml")}:self.ActiveXObject!==void 0&&new self.ActiveXObject("Microsoft.XMLDOM")?function(tt){var et=new self.ActiveXObject("Microsoft.XMLDOM");return et.async="false",et.loadXML(tt),et}:function(tt){var et=document.createElement("div");return et.innerHTML=tt,et},parseAttributes=parseAttribs,parseFromString=xmlParseFromString,NAME_MAP={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"},browser=function(tt){tt=tt.toString();var et=parseFromString(tt),rt={pages:[],chars:[],kernings:[]};["info","common"].forEach((function(ht){var dt=et.getElementsByTagName(ht)[0];dt&&(rt[ht]=parseAttributes(getAttribs(dt)))}));var nt=et.getElementsByTagName("pages")[0];if(!nt)throw new Error("malformed file -- no <pages> element");for(var it=nt.getElementsByTagName("page"),at=0;at<it.length;at++){var st=it[at],ot=parseInt(st.getAttribute("id"),10),lt=st.getAttribute("file");if(isNaN(ot))throw new Error('malformed file -- page "id" attribute is NaN');if(!lt)throw new Error('malformed file -- needs page "file" attribute');rt.pages[parseInt(ot,10)]=lt}return["chars","kernings"].forEach((function(ht){var dt=et.getElementsByTagName(ht)[0];if(dt)for(var ut=ht.substring(0,ht.length-1),ft=dt.getElementsByTagName(ut),mt=0;mt<ft.length;mt++){var gt=ft[mt];rt[ht].push(parseAttributes(getAttribs(gt)))}})),rt};function getAttribs(tt){return getAttribList(tt).reduce((function(et,rt){return et[mapName(rt.nodeName)]=rt.nodeValue,et}),{})}function getAttribList(tt){for(var et=[],rt=0;rt<tt.attributes.length;rt++)et.push(tt.attributes[rt]);return et}function mapName(tt){return NAME_MAP[tt.toLowerCase()]||tt}getDefaultExportFromCjs(browser);var HEADER$1=[66,77,70],parseBmfontBinary=function(tt){if(tt.length<6)throw new Error("invalid buffer length for BMFont");var et=HEADER$1.every((function(at,st){return tt.readUInt8(st)===at}));if(!et)throw new Error("BMFont missing BMF byte header");var rt=3;if(tt.readUInt8(rt++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var nt={kernings:[],chars:[]},it=0;it<5;it++)rt+=readBlock(nt,tt,rt);return nt};function readBlock(tt,et,rt){if(rt>et.length-1)return 0;var nt=et.readUInt8(rt++),it=et.readInt32LE(rt);switch(rt+=4,nt){case 1:tt.info=readInfo(et,rt);break;case 2:tt.common=readCommon(et,rt);break;case 3:tt.pages=readPages(et,rt,it);break;case 4:tt.chars=readChars(et,rt,it);break;case 5:tt.kernings=readKernings(et,rt,it)}return 5+it}function readInfo(tt,et){var rt={};rt.size=tt.readInt16LE(et);var nt=tt.readUInt8(et+2);return rt.smooth=nt>>7&1,rt.unicode=nt>>6&1,rt.italic=nt>>5&1,rt.bold=nt>>4&1,nt>>3&1&&(rt.fixedHeight=1),rt.charset=tt.readUInt8(et+3)||"",rt.stretchH=tt.readUInt16LE(et+4),rt.aa=tt.readUInt8(et+6),rt.padding=[tt.readInt8(et+7),tt.readInt8(et+8),tt.readInt8(et+9),tt.readInt8(et+10)],rt.spacing=[tt.readInt8(et+11),tt.readInt8(et+12)],rt.outline=tt.readUInt8(et+13),rt.face=readStringNT(tt,et+14),rt}function readCommon(tt,et){var rt={};return rt.lineHeight=tt.readUInt16LE(et),rt.base=tt.readUInt16LE(et+2),rt.scaleW=tt.readUInt16LE(et+4),rt.scaleH=tt.readUInt16LE(et+6),rt.pages=tt.readUInt16LE(et+8),tt.readUInt8(et+10),rt.packed=0,rt.alphaChnl=tt.readUInt8(et+11),rt.redChnl=tt.readUInt8(et+12),rt.greenChnl=tt.readUInt8(et+13),rt.blueChnl=tt.readUInt8(et+14),rt}function readPages(tt,et,rt){for(var nt=[],it=readNameNT(tt,et),at=it.length+1,st=rt/at,ot=0;ot<st;ot++)nt[ot]=tt.slice(et,et+it.length).toString("utf8"),et+=at;return nt}function readChars(tt,et,rt){for(var nt=[],it=rt/20,at=0;at<it;at++){var st={},ot=20*at;st.id=tt.readUInt32LE(et+0+ot),st.x=tt.readUInt16LE(et+4+ot),st.y=tt.readUInt16LE(et+6+ot),st.width=tt.readUInt16LE(et+8+ot),st.height=tt.readUInt16LE(et+10+ot),st.xoffset=tt.readInt16LE(et+12+ot),st.yoffset=tt.readInt16LE(et+14+ot),st.xadvance=tt.readInt16LE(et+16+ot),st.page=tt.readUInt8(et+18+ot),st.chnl=tt.readUInt8(et+19+ot),nt[at]=st}return nt}function readKernings(tt,et,rt){for(var nt=[],it=rt/10,at=0;at<it;at++){var st={},ot=10*at;st.first=tt.readUInt32LE(et+0+ot),st.second=tt.readUInt32LE(et+4+ot),st.amount=tt.readInt16LE(et+8+ot),nt[at]=st}return nt}function readNameNT(tt,et){for(var rt=et;rt<tt.length&&tt[rt]!==0;rt++);return tt.slice(et,rt)}function readStringNT(tt,et){return readNameNT(tt,et).toString("utf8")}getDefaultExportFromCjs(parseBmfontBinary);function e(tt){return tt&&tt.__esModule&&Object.prototype.hasOwnProperty.call(tt,"default")?tt.default:tt}const t=tt=>{if(!tt)return null;const et={};switch(tt.type){case"ELEMENT":{let rt={};const nt=E(tt.value.attributes),it=t(tt.value.children);if(nt&&(rt=Object.assign(rt,nt)),it){const at=r(tt.value.children);rt=Object.assign(rt,at)}et[tt.value.type]=rt;break}case"ATTRIBUTE":{const rt=tt.value;et[rt.name]=rt.value;break}case"CONTENT":return{content:tt.value}}return et},r=tt=>tt&&Array.isArray(tt)&&tt.length!==0?n(tt)?{content:tt[0].value}:{children:tt.map(t)}:null,n=tt=>tt&&Array.isArray(tt)&&tt.length===1&&tt[0].type==="CONTENT",E=tt=>tt&&Array.isArray(tt)?tt.map(t).reduce(((et,rt)=>Object.assign(et,rt)),{}):null;var s={convert:tt=>t(tt.value.children[0])},a={Token:(tt,et)=>({type:tt,value:et}),TOKEN_TYPE:{OPEN_BRACKET:"OPEN_BRACKET",ELEMENT_TYPE:"ELEMENT_TYPE",CLOSE_ELEMENT:"CLOSE_ELEMENT",ATTRIB_NAME:"ATTRIB_NAME",ATTRIB_VALUE:"ATTRIB_VALUE",ASSIGN:"ASSIGN",CLOSE_BRACKET:"CLOSE_BRACKET",CONTENT:"CONTENT",EOF:"EOF"}};const{Token:T,TOKEN_TYPE:u}=a,c=T("EOF"),l=tt=>tt===" "||tt===`
`||tt==="\r"||tt==="	",o=tt=>tt.replace(/'/g,'"');var N={createLexer:function(tt){let et=null,rt=(ut=>{let ft=0;for(;ft<ut.length&&l(ut[ft]);)ft++;return((mt,gt)=>{if(mt.startsWith("<?xml",gt)){const vt=mt.length;for(;gt<vt;)if(mt[gt]!=="?")gt++;else{if(mt[gt+1]===">")return gt+2;gt++}}return gt})(ut,ft)})(tt),nt=[];const it=()=>tt[rt],at=()=>et!==c&&rt<tt.length,st=ut=>ut==='"'||ut==="'",ot=()=>{for(;at()&&l(tt[rt]);)rt++},lt=ut=>{if(at()){if(tt[rt]==="<"){let ft="<";return rt++,at()&&tt[rt]==="/"?(rt++,ft="</"):at()&&tt[rt]==="!"&&tt[rt+1]==="-"&&tt[rt+2]==="-"&&(rt++,rt++,rt++,ft="<!--"),ft}if(it()==="/"){let ft="/";return rt++,at()&&it()===">"&&(rt++,ft="/>"),ft}if(tt[rt]==="="||tt[rt]===">"){const ft=tt[rt];return rt++,ft}}return ht(!!ut)},ht=ut=>{const ft=ut?/[^>=<]/u:/[a-zA-Z0-9_:-]/;let mt=rt;for(;at()&&tt[rt].match(ft);)rt++;return o(tt.substring(mt,rt))},dt=()=>{const ut=rt;ot();const ft=rt-ut;if(at())if(et&&et.type===u.OPEN_BRACKET){ot();const mt=lt(!1);et=T(u.ELEMENT_TYPE,mt),nt.push(mt)}else if(et&&et.type===u.ASSIGN){at()&&st(it())&&rt++;let mt=rt;for(;at()&&!st(it());)rt++;const gt=o(tt.substring(mt,rt));rt++,et=T(u.ATTRIB_VALUE,gt)}else{ot();let mt=lt(!0);switch(mt){case"=":et=et.type===u.ATTRIB_NAME?T(u.ASSIGN):T(u.CONTENT,mt);break;case"</":{const gt=rt;for(;tt[rt]!==">";)rt++;et=T(u.CLOSE_ELEMENT,tt.substring(gt,rt)),rt++,nt.pop();break}case"/>":{const gt=nt.pop();et=T(u.CLOSE_ELEMENT,gt);break}case"<!--":{const gt=["!","-","-"];for(;at()&&(gt[2]!==">"||gt[1]!=="-"||gt[0]!=="-");)gt.shift(),gt.push(tt[rt]),rt++;return dt()}case">":et=T(u.CLOSE_BRACKET);break;case"<":et=T(u.OPEN_BRACKET);break;default:if(mt&&mt.length>0){if(et.type===u.CLOSE_BRACKET){let gt="";it()!=="<"&&(gt=ht(!0)),et=T(u.CONTENT,mt+gt)}else if(et.type!==u.ATTRIB_NAME&&et.type!==u.CONTENT)et.type===u.CLOSE_ELEMENT?(mt=" ".repeat(ft)+mt,et=T(u.CONTENT,mt)):et=T(u.ATTRIB_NAME,mt);else{const gt=" ".repeat(ft)+mt;et=T(u.CONTENT,gt)}break}{const gt='Unknown Syntax : "'+tt[rt]+'"';throw new Error(gt)}}}else et=c;return et};return{peek:it,next:dt,hasNext:at}}};const{createLexer:i}=N,{Token:p,TOKEN_TYPE:O}=a,[A,f,C,h]=["ROOT","ELEMENT","ATTRIBUTE","CONTENT"],_=(tt,et)=>({type:tt,value:et}),L=tt=>_(h,tt),y=(tt,et,rt)=>_(f,{type:tt,attributes:et,children:rt}),v=(tt,et)=>_(C,{name:tt,value:et}),S=(tt,et)=>{const rt=[];for(;tt.hasNext();){const nt=tt.next();switch(nt.type){case O.OPEN_BRACKET:{const it=tt.next(),[at,st]=R(tt);let ot=[];st.type!==O.CLOSE_ELEMENT&&(ot=S(tt,it)),ot&&ot.length>0&&ot[0].type===O.CONTENT&&(ot=b(ot)),rt.push(y(it.value,at,ot));break}case O.CLOSE_ELEMENT:if(nt.value===et.value)return rt;break;case O.CONTENT:rt.push(L(nt.value));break;case O.EOF:return rt;default:throw new Error(`Unknown Lexem type: ${nt.type} "${nt.value}, scoping element: ${et.value}"`)}}return rt},R=tt=>{const et=[];let rt=tt.peek();if(!tt.hasNext()||rt&&rt.type===O.CLOSE_BRACKET||rt&&rt.type===O.CLOSE_ELEMENT)return[et,rt];for(rt=tt.next();tt.hasNext()&&rt&&rt.type!==O.CLOSE_BRACKET&&rt.type!==O.CLOSE_ELEMENT;){const nt=rt;tt.next();const it=tt.next(),at=v(nt.value,it.value);et.push(at),rt=tt.next()}return[et,rt]};function b(tt){let et=[],rt="";return tt.forEach((nt=>{nt.type===O.CONTENT?rt+=nt.value:(rt.length&&(et.push(L(rt)),rt=""),et.push(nt))})),rt.length&&et.push(L(rt)),et}var B={transpile:function(tt,et){const rt=(nt=>_(A,{children:S(nt,p(A,"ROOT"))}))(i(tt));return et?et.convert(rt):rt}};const M=s,{transpile:x}=B;var k=e({convertXML:function(tt,et){return x(tt,et||M)},createAST:function(tt){return x(tt)}}),simpleXmlToJson_min=k,xmlPackage=getDefaultExportFromCjs(simpleXmlToJson_min);const{convertXML}=xmlPackage;createJimp({formats:[png]});Buffer$1.from([66,77,70,3]);var pixelmatch_1=pixelmatch;const defaultOptions={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function pixelmatch(tt,et,rt,nt,it,at){if(!isPixelData(tt)||!isPixelData(et)||rt&&!isPixelData(rt))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(tt.length!==et.length||rt&&rt.length!==tt.length)throw new Error("Image sizes do not match.");if(tt.length!==nt*it*4)throw new Error("Image data size does not match width/height.");at=Object.assign({},defaultOptions,at);const st=nt*it,ot=new Uint32Array(tt.buffer,tt.byteOffset,st),lt=new Uint32Array(et.buffer,et.byteOffset,st);let ht=!0;for(let ft=0;ft<st;ft++)if(ot[ft]!==lt[ft]){ht=!1;break}if(ht){if(rt&&!at.diffMask)for(let ft=0;ft<st;ft++)drawGrayPixel(tt,4*ft,at.alpha,rt);return 0}const dt=35215*at.threshold*at.threshold;let ut=0;for(let ft=0;ft<it;ft++)for(let mt=0;mt<nt;mt++){const gt=4*(ft*nt+mt),vt=colorDelta(tt,et,gt,gt);Math.abs(vt)>dt?at.includeAA||!antialiased(tt,mt,ft,nt,it,et)&&!antialiased(et,mt,ft,nt,it,tt)?(rt&&drawPixel(rt,gt,...vt<0&&at.diffColorAlt||at.diffColor),ut++):rt&&!at.diffMask&&drawPixel(rt,gt,...at.aaColor):rt&&(at.diffMask||drawGrayPixel(tt,gt,at.alpha,rt))}return ut}function isPixelData(tt){return ArrayBuffer.isView(tt)&&tt.constructor.BYTES_PER_ELEMENT===1}function antialiased(tt,et,rt,nt,it,at){const st=Math.max(et-1,0),ot=Math.max(rt-1,0),lt=Math.min(et+1,nt-1),ht=Math.min(rt+1,it-1),dt=4*(rt*nt+et);let ut,ft,mt,gt,vt=et===st||et===lt||rt===ot||rt===ht?1:0,xt=0,wt=0;for(let At=st;At<=lt;At++)for(let Tt=ot;Tt<=ht;Tt++){if(At===et&&Tt===rt)continue;const Pt=colorDelta(tt,tt,dt,4*(Tt*nt+At),!0);if(Pt===0){if(vt++,vt>2)return!1}else Pt<xt?(xt=Pt,ut=At,ft=Tt):Pt>wt&&(wt=Pt,mt=At,gt=Tt)}return xt!==0&&wt!==0&&(hasManySiblings(tt,ut,ft,nt,it)&&hasManySiblings(at,ut,ft,nt,it)||hasManySiblings(tt,mt,gt,nt,it)&&hasManySiblings(at,mt,gt,nt,it))}function hasManySiblings(tt,et,rt,nt,it){const at=Math.max(et-1,0),st=Math.max(rt-1,0),ot=Math.min(et+1,nt-1),lt=Math.min(rt+1,it-1),ht=4*(rt*nt+et);let dt=et===at||et===ot||rt===st||rt===lt?1:0;for(let ut=at;ut<=ot;ut++)for(let ft=st;ft<=lt;ft++){if(ut===et&&ft===rt)continue;const mt=4*(ft*nt+ut);if(tt[ht]===tt[mt]&&tt[ht+1]===tt[mt+1]&&tt[ht+2]===tt[mt+2]&&tt[ht+3]===tt[mt+3]&&dt++,dt>2)return!0}return!1}function colorDelta(tt,et,rt,nt,it){let at=tt[rt+0],st=tt[rt+1],ot=tt[rt+2],lt=tt[rt+3],ht=et[nt+0],dt=et[nt+1],ut=et[nt+2],ft=et[nt+3];if(lt===ft&&at===ht&&st===dt&&ot===ut)return 0;lt<255&&(lt/=255,at=blend(at,lt),st=blend(st,lt),ot=blend(ot,lt)),ft<255&&(ft/=255,ht=blend(ht,ft),dt=blend(dt,ft),ut=blend(ut,ft));const mt=rgb2y(at,st,ot),gt=rgb2y(ht,dt,ut),vt=mt-gt;if(it)return vt;const xt=rgb2i(at,st,ot)-rgb2i(ht,dt,ut),wt=rgb2q(at,st,ot)-rgb2q(ht,dt,ut),At=.5053*vt*vt+.299*xt*xt+.1957*wt*wt;return mt>gt?-At:At}function rgb2y(tt,et,rt){return .29889531*tt+.58662247*et+.11448223*rt}function rgb2i(tt,et,rt){return .59597799*tt-.2741761*et-.32180189*rt}function rgb2q(tt,et,rt){return .21147017*tt-.52261711*et+.31114694*rt}function blend(tt,et){return 255+(tt-255)*et}function drawPixel(tt,et,rt,nt,it){tt[et+0]=rt,tt[et+1]=nt,tt[et+2]=it,tt[et+3]=255}function drawGrayPixel(tt,et,rt,nt){const it=blend(rgb2y(tt[et+0],tt[et+1],tt[et+2]),rt*tt[et+3]/255);drawPixel(nt,et,it,it,it)}getDefaultExportFromCjs(pixelmatch_1);const defaultPlugins=[methods$h,methods$g,methods$f,methods$e,methods$c,methods$a,methods$b,methods$9,methods$8,methods$7,methods$6,methods$5,methods$4,methods$3,methods$d,methods$2,methods$1,methods],defaultFormats=[bmp,msBmp,gif,jpeg$2,png,tiff];bmp().mime,gif().mime,jpeg$2().mime,png().mime,tiff().mime;const Jimp=createJimp({formats:defaultFormats,plugins:defaultPlugins});class MapParser{static COLOR_FLOOR=rgbaToInt(89,103,161,255);static COLOR_PLATFORM=rgbaToInt(74,169,8,255);static COLOR_PLAYER=rgbaToInt(214,159,96,255);static COLOR_EXIT=rgbaToInt(255,0,0,255);static COLOR_WALL=rgbaToInt(128,0,128,255);static COLOR_WALL_ALT=rgbaToInt(71,13,191,255);static COLOR_SPIKE=rgbaToInt(13,191,184,255);static COLOR_PORTAL=rgbaToInt(28,0,255,255);static COLOR_VOID=rgbaToInt(0,0,0,255);static async parseMap(et,rt=1){console.log(`[MapParser] Parsing: ${et}`);try{let nt;try{nt=await Jimp.read(et)}catch(ht){if(ht.message?.includes("unrecognised content at end of stream")){console.warn(`[MapParser] ${et} has trailing bytes. Attempting to sanitize...`);const ut=require("fs").readFileSync(et),ft=ut.lastIndexOf(Buffer.from("IEND","ascii"));if(ft!==-1){const mt=ut.slice(0,ft+8);nt=await Jimp.read(mt)}else throw ht}else throw ht}const it=nt.bitmap.width,at=nt.bitmap.height,st=[];let ot;for(let ht=0;ht<at;ht++){let dt=null;for(let ut=0;ut<it;ut++){const ft=nt.getPixelColor(ut,ht);if((ft&255)<128){dt=null;continue}if(this.isColorMatch(ft,this.COLOR_FLOOR)||this.isColorMatch(ft,this.COLOR_PLATFORM)||this.isColorMatch(ft,this.COLOR_WALL)||this.isColorMatch(ft,this.COLOR_WALL_ALT)||this.isColorMatch(ft,this.COLOR_SPIKE)||this.isColorMatch(ft,this.COLOR_PORTAL)||this.isColorMatch(ft,this.COLOR_VOID)||this.isColorMatch(ft,this.COLOR_EXIT)){const mt=this.isColorMatch(ft,this.COLOR_FLOOR),gt=this.isColorMatch(ft,this.COLOR_WALL)||this.isColorMatch(ft,this.COLOR_WALL_ALT),vt=this.isColorMatch(ft,this.COLOR_SPIKE),xt=this.isColorMatch(ft,this.COLOR_PORTAL),wt=this.isColorMatch(ft,this.COLOR_VOID),At=this.isColorMatch(ft,this.COLOR_EXIT);dt&&dt.isFloor===mt&&dt.isWall===gt&&dt.isSpike===vt&&dt.isPortal===xt&&dt.isVoid===wt&&dt.isExit===At?dt.width+=1*rt:(dt={x:ut*rt,y:ht*rt,width:1*rt,height:1*rt,isFloor:mt,isWall:gt,isSpike:vt,isPortal:xt,isVoid:wt,isExit:At,assetKey:gt?"Platform Length":mt?"Platform Floor":At?"Exit Door":"Platform Length"},st.push(dt))}else dt=null,this.isColorMatch(ft,this.COLOR_PLAYER)&&(ot={x:ut*rt,y:ht*rt,width:1*rt,height:1*rt})}}return ot||(console.warn("[MapParser] No player start found. Using default."),ot={x:5,y:5,width:1,height:1}),{platforms:this.mergeVertically(st),playerStart:ot}}catch(nt){throw console.error(`[MapParser] Failed to parse map ${et}:`,nt),nt}}static mergeVertically(et){const rt=[],nt=new Set;for(let it=0;it<et.length;it++){const at=et[it];if(nt.has(at))continue;nt.add(at);let st=at,ot=!0;for(;ot;){ot=!1;for(let lt=0;lt<et.length;lt++){const ht=et[lt];if(!nt.has(ht)&&ht.x===st.x&&ht.width===st.width&&ht.y===st.y+st.height&&ht.isFloor===st.isFloor&&ht.isWall===st.isWall&&ht.isSpike===st.isSpike&&ht.isPortal===st.isPortal&&ht.isVoid===st.isVoid&&ht.isExit===st.isExit&&ht.assetKey===st.assetKey){st.height+=ht.height,nt.add(ht),ot=!0;break}}}rt.push(st)}return rt}static isColorMatch(et,rt){const nt=et>>24&255,it=et>>16&255,at=et>>8&255,st=rt>>24&255,ot=rt>>16&255,lt=rt>>8&255,ht=15;return Math.abs(nt-st)<ht&&Math.abs(it-ot)<ht&&Math.abs(at-lt)<ht}}class MapGenerator{static generateDefaultMap(){const et=[];for(let ht=-20;ht<60;ht++)et.push({x:ht,y:20,width:1,height:1,isFloor:!0,assetKey:"Platform Floor"});const rt=(ht,dt,ut)=>{for(let ft=ht;ft<ht+ut;ft++)et.push({x:ft,y:dt,width:1,height:1,isFloor:!1,assetKey:"Platform Length"})},nt=(ht,dt,ut)=>{for(let ft=dt;ft<dt+ut;ft++)et.push({x:ht,y:ft,width:1,height:1,isFloor:!1,isWall:!0,assetKey:"Platform Length"})},it=(ht,dt,ut)=>{for(let ft=ht;ft<ht+ut;ft++)et.push({x:ft,y:dt,width:1,height:1,isFloor:!1,isSpike:!0,assetKey:"Platform Length"})},at=(ht,dt)=>{et.push({x:ht,y:dt,width:1,height:1,isFloor:!1,isPortal:!0,assetKey:"Platform Length"})},st=(ht,dt,ut)=>{for(let ft=ht;ft<ht+ut;ft++)et.push({x:ft,y:dt,width:1,height:1,isFloor:!1,isVoid:!0,assetKey:"Platform Length"})},ot=(ht,dt,ut,ft)=>{for(let mt=0;mt<ft;mt++)for(let gt=0;gt<ut;gt++)et.push({x:ht+gt,y:dt+mt,width:1,height:1,isFloor:!1,isExit:!0,assetKey:"Exit Door"})};return rt(10,15,5),rt(20,10,5),rt(5,5,3),nt(15,10,10),nt(25,5,15),it(30,19,5),at(5,19),at(45,19),st(-10,25,80),ot(55,18,2,2),{platforms:MapParser.mergeVertically(et),playerStart:{x:0,y:19,width:1,height:1}}}static generateProcedural(et){return this.generateDefaultMap()}}class Game3Controller extends BaseController{currentLevel=Game3Level.Level1;constructor(et){super(et,StateId.GAME_3)}onWorkerEvent(et,rt){}onKeyDown(et){InputManager.getInstance().isKeyAction(et.key,"PAUSE")&&this.openPauseMenu()}async initialize(et,rt=Game3Level.Level1){this.currentLevel=rt,InputManager.getInstance().refreshBindings("Game3");try{this.send("INITIALIZE",et);let nt;if(et.mapPath)try{nt=await MapParser.parseMap(et.mapPath,et.mapScale??1),console.log("[Game3Controller] Map parsed successfully.")}catch(it){console.error("[Game3Controller] Map parsing failed, using generator fallback:",it),nt=MapGenerator.generateDefaultMap()}else console.log("[Game3Controller] No mapPath provided, generating default world."),nt=MapGenerator.generateDefaultMap();this.send("SET_MAP_DATA",nt),this.vm.mapData=nt,console.log("[Game3Controller] Map data sent to worker.")}catch(nt){console.error("[Game3Controller] Critical initialization failure:",nt)}}modifyHP(et){this.send("MOD_HP",{amount:et})}async loadLevel(et){const{Game3State:rt}=await __vitePreload(async()=>{const{Game3State:nt}=await Promise.resolve().then(()=>Game3State$1);return{Game3State:nt}},void 0);StateManager.getInstance().replace(new rt(!1,et))}async resetLevel(){await SaveManager.getInstance().performLoad(this.QUICK_SAVE_KEY);const et=this.vm.currentLevel||Game3Level.Level1,rt=StateRegistry.create(StateId.GAME_1,{reset:!1,level:et});await StateManager.getInstance().replace(rt)}async openPauseMenu(){const et=StateManager.getInstance();et.getCurrentStateName()===this.stateName&&await et.push(StateRegistry.create(StateId.PAUSE_MENU))}}class Game3State extends BaseGameState{constructor(et=!1,rt=Game3Level.Level1){super(et),this.currentLevel=rt}name=StateId.GAME_3;logicSchema=Game3LogicSchema;viewSchema=Game3ViewSchema;viewComponent=Game3View;getConfig(){return getGame3Config(this.currentLevel)}getSessionOverrides(){return{}}initMVC(){this.vm=new Game3Presenter,this.controller=new Game3Controller(this.vm)}async init(){await super.init();const et=this.getConfig();this.controller&&et.mapPath&&await this.controller.initialize(et,this.currentLevel)}}const Game3State$1=Object.freeze(Object.defineProperty({__proto__:null,Game3State},Symbol.toStringTag,{value:"Module"})),initializeStateRegistry=()=>{StateRegistry.register({id:StateId.GAME_1,displayName:"Operation: Descent",type:"GAME",factory:tt=>new Game1State(tt?.reset??!1,tt?.level??Game1Level.Level1),presets:[{label:"LVL 1",params:{level:Game1Level.Level1}},{label:"LVL 2",params:{level:Game1Level.Level2}},{label:"LVL 3",params:{level:Game1Level.Level3}}]}),StateRegistry.register({id:StateId.GAME_2,displayName:"Supply Run",type:"GAME",factory:tt=>new Game2State(tt?.reset??!1,tt?.level??Game2Level.Level1),presets:[{label:"LVL 1",params:{level:Game2Level.Level1}},{label:"LVL 2",params:{level:Game2Level.Level2}},{label:"LVL 3",params:{level:Game2Level.Level3}}]}),StateRegistry.register({id:StateId.GAME_3,displayName:"G3 Code Run",type:"GAME",factory:tt=>new Game3State(tt?.reset??!1,tt?.level??Game3Level.Level1),presets:[{label:"LVL 1",params:{level:Game3Level.Level1}},{label:"LVL 2",params:{level:Game3Level.Level2}},{label:"LVL 3",params:{level:Game3Level.Level3}},{label:"LVL 4",params:{level:Game3Level.Level4}}]}),StateRegistry.register({id:StateId.BH_GAME,displayName:"Example",type:"GAME",factory:tt=>new BHState(tt?.reset??!1,tt?.level??BHLevel.Level1),presets:[{label:"LVL 1",params:{level:BHLevel.Level1}},{label:"LVL 2",params:{level:BHLevel.Level2}},{label:"LVL 3",params:{level:BHLevel.Level3}}]}),StateRegistry.register({id:StateId.DEV_MENU,displayName:"Switchboard",type:"MENU",factory:()=>new DevMenuState}),StateRegistry.register({id:StateId.PAUSE_MENU,displayName:"Paused",type:"MENU",factory:()=>new PauseMenuState}),StateRegistry.register({id:StateId.SAVE_MENU,displayName:"Storage",type:"MENU",factory:()=>new SaveMenuState}),StateRegistry.register({id:StateId.SETTINGS_MENU,displayName:"System Config",type:"MENU",factory:tt=>new SettingsMenuState(tt)}),StateRegistry.register({id:StateId.CONTINUE,displayName:"Continue",type:"UTILITY",factory:()=>new ContinueState}),StateRegistry.register({id:StateId.GAME_OVER,displayName:"Game Over",type:"UTILITY",factory:()=>new GameOverState})},DemoLoadingView=({isFinished:tt,onTransitionComplete:et})=>{const[rt,nt]=reactExports.useState(1),[it,at]=reactExports.useState("");return reactExports.useEffect(()=>{if(tt)return;const st=setInterval(()=>{at(ot=>ot.length>=3?"":ot+".")},400);return()=>clearInterval(st)},[tt]),reactExports.useEffect(()=>{if(tt){const st=setTimeout(()=>{nt(0)},600);return()=>clearTimeout(st)}},[tt]),reactExports.useEffect(()=>{if(rt===0){const st=setTimeout(et,500);return()=>clearTimeout(st)}},[rt,et]),jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,background:"#000",display:"flex",alignItems:"center",justifyContent:"center"},children:jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"100%",maxWidth:"calc(100vh * (16 / 9))",maxHeight:"calc(100vw * (9 / 16))",aspectRatio:"16 / 9",backgroundColor:"#000",opacity:rt,transition:"opacity 0.5s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center",color:"#00ff00",fontFamily:"monospace",textTransform:"uppercase"},children:jsxRuntimeExports.jsx("div",{style:{fontSize:"1.5cqw",letterSpacing:"0.2cqw",textAlign:"center"},children:tt?jsxRuntimeExports.jsx("span",{style:{color:"#fff"},children:"Loaded"}):jsxRuntimeExports.jsxs("span",{children:["Loading",it]})})})})},LoreLoadingView=({message:tt,isFinished:et,onTransitionComplete:rt})=>jsxRuntimeExports.jsxs("div",{style:{width:"100%",height:"100%",background:"#111",color:"#ccc",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"monospace",padding:"20px",boxSizing:"border-box"},children:[jsxRuntimeExports.jsx("h1",{style:{color:"#e74c3c",letterSpacing:"4px",marginBottom:"30px"},children:"MISSION BRIEFING"}),jsxRuntimeExports.jsx("div",{style:{maxWidth:"600px",textAlign:"center",lineHeight:"1.8",fontSize:"1.2rem",borderLeft:"2px solid #e74c3c",paddingLeft:"20px"},children:tt}),jsxRuntimeExports.jsx("div",{style:{marginTop:"40px",height:"50px"},children:et?jsxRuntimeExports.jsx("button",{onClick:rt,style:{padding:"12px 40px",background:"#e74c3c",border:"none",color:"white",cursor:"pointer",fontWeight:"bold",fontSize:"1rem",boxShadow:"0 0 15px rgba(231, 76, 60, 0.4)"},children:"DEPLOY UNIT"}):jsxRuntimeExports.jsx("div",{style:{color:"#666",fontStyle:"italic"},children:"ESTABLISHING UPLINK..."})})]}),StoryCampaign=[{name:"Prologue: The Awakening",factory:tt=>StateRegistry.create(StateId.GAME_1,{level:tt}),config:"Level 1",loadingConfig:{view:LoreLoadingView,props:{message:"System initializing. Hostiles detected in Sector 7. Engage immediately."}}},{name:"Chapter 1: The Descent",factory:tt=>StateRegistry.create(StateId.GAME_1,{level:tt}),config:"Level 2",loadingConfig:{view:LoreLoadingView,props:{message:"Surface cleared. Descending into the sub-levels. Energy signatures rising."}}},{name:"Intermission: Resupply",factory:tt=>StateRegistry.create(StateId.GAME_2,{level:tt}),config:"Level 1",loadingConfig:{view:DemoLoadingView,props:{message:"Returning to Base..."}}}],ArcadeCampaign=[{name:"Stage 1",factory:tt=>StateRegistry.create(StateId.GAME_2,{level:tt}),config:"Level 1",loadingConfig:{view:DemoLoadingView,props:{message:"Arcade Mode: Stage 1"}}},{name:"Stage 2",factory:tt=>StateRegistry.create(StateId.GAME_1,{level:tt}),config:"Level 3",loadingConfig:{view:DemoLoadingView,props:{message:"Arcade Mode: Stage 2"}}}],initializeCampaigns=()=>{CampaignRegistry.register({id:"story_mode",steps:StoryCampaign,failFactory:()=>StateRegistry.create(StateId.CONTINUE)}),CampaignRegistry.register({id:"arcade_mode",steps:ArcadeCampaign,failFactory:()=>StateRegistry.create(StateId.GAME_OVER)})},App=()=>{const[tt,et]=reactExports.useState([]),[rt,nt]=reactExports.useState(!1),[it,at]=reactExports.useState("fit"),[st,ot]=reactExports.useState(1),[lt,ht]=reactExports.useState(window.devicePixelRatio||1),dt=reactExports.useRef(!1);reactExports.useEffect(()=>{const ft=StateManager.getInstance(),mt=At=>et([...At]),gt=()=>ht(window.devicePixelRatio||1),vt=window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);vt.addEventListener("change",gt);const xt=At=>{At.key==="F3"&&(At.preventDefault(),nt(Tt=>!Tt))};window.addEventListener("keydown",xt);const wt=ft.subscribe(mt);return dt.current||(initializeStateRegistry(),initializeCampaigns(),ft.replace(StateRegistry.create(StateId.DEV_MENU)),dt.current=!0),()=>{window.removeEventListener("keydown",xt),vt.removeEventListener("change",gt),wt()}},[]),reactExports.useEffect(()=>{let ft=document.querySelector("link[rel~='icon']");ft||(ft=document.createElement("link"),ft.rel="icon",document.head.appendChild(ft)),ft.href="res/sprite/icon/icon.png"},[]);const ut=reactExports.useMemo(()=>{switch(it){case"540p":return{w:960,h:540};case"720p":return{w:1280,h:720};case"1080p":return{w:1920,h:1080};case"1440p":return{w:2560,h:1440};case"4k":return{w:3840,h:2160};default:return null}},[it]);return jsxRuntimeExports.jsx("div",{className:"engine-wrapper",style:{width:"100vw",height:"100vh",backgroundColor:"#000",display:"flex",alignItems:"center",justifyContent:"center",overflow:"auto"},children:jsxRuntimeExports.jsxs("div",{className:"engine-root",style:{width:ut?`${ut.w/lt}px`:"100%",height:ut?`${ut.h/lt}px`:"auto",maxWidth:it==="fit"?"100vw":"none",maxHeight:it==="fit"?"100vh":"none",aspectRatio:"16 / 9",position:"relative",backgroundColor:"#111",imageRendering:"pixelated",containerType:"size",flexShrink:0,margin:"auto"},children:[tt.map((ft,mt)=>jsxRuntimeExports.jsx("div",{style:{position:"absolute",inset:0,zIndex:mt,pointerEvents:mt===tt.length-1?"auto":"none"},children:reactExports.cloneElement(ft,{width:ut?.w||960,height:ut?.h||540,res:it,setRes:at,uiScale:st,setUiScale:ot})},mt)),rt&&jsxRuntimeExports.jsx(DebugOverlay,{})]})})},rootElement=document.getElementById("root");if(!rootElement)throw new Error("Failed to find the root element.");Engine.getInstance().start();ReactDOM.createRoot(rootElement).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
